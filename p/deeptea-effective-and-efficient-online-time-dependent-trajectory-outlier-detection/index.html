<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="PVLDB 2022. [DeepTEA: Effective and Efficient Online Time-dependent Trajectory Outlier  Detection](https://www.vldb.org/pvldb/vol15/p1493-han.pdf)"><title>DeepTEA: Effective and Efficient Online Time-dependent Trajectory Outlier Detection</title><link rel=canonical href=https://davidham3.github.io/blog/p/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/><link rel=stylesheet href=/blog/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="DeepTEA: Effective and Efficient Online Time-dependent Trajectory Outlier Detection"><meta property='og:description' content="PVLDB 2022. [DeepTEA: Effective and Efficient Online Time-dependent Trajectory Outlier  Detection](https://www.vldb.org/pvldb/vol15/p1493-han.pdf)"><meta property='og:url' content='https://davidham3.github.io/blog/p/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/'><meta property='og:site_name' content='Davidhamçš„åšå®¢'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='deep learning'><meta property='article:tag' content='trajectory'><meta property='article:published_time' content='2022-09-09T14:24:04+00:00'><meta property='article:modified_time' content='2022-09-09T14:24:04+00:00'><meta name=twitter:title content="DeepTEA: Effective and Efficient Online Time-dependent Trajectory Outlier Detection"><meta name=twitter:description content="PVLDB 2022. [DeepTEA: Effective and Efficient Online Time-dependent Trajectory Outlier  Detection](https://www.vldb.org/pvldb/vol15/p1493-han.pdf)"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/blog/><img src=/blog/img/avatar_hu_a95981f1fc190aef.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸš€</span></figure><div class=site-meta><h1 class=site-name><a href=/blog>Davidhamçš„åšå®¢</a></h1><h2 class=site-description>éšä¾¿å†™å†™</h2></div></header><ol class=menu-social><li><a href=https://github.com/Davidham3 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/blog/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/blog/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/blog/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/blog/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#31-framework>3.1 Framework</a></li><li><a href=#32-latent-traffic-pattern-inference>3.2 Latent Traffic Pattern Inference</a><ol><li><a href=#321-challenges>3.2.1 Challenges</a></li><li><a href=#322-design>3.2.2 Design</a></li></ol></li><li><a href=#33-latent-time-dependent-route-inference>3.3 Latent Time-dependent Route Inference</a><ol><li><a href=#331-challenges>3.3.1 Challenges</a></li><li><a href=#332-design>3.3.2 Design</a></li></ol></li><li><a href=#34-trajectory-observation-generation>3.4 Trajectory Observation Generation</a></li><li><a href=#35-optimization>3.5 Optimization</a></li><li><a href=#36-complexity-analysis>3.6 Complexity Analysis</a></li></ol><ol><li><a href=#41-online-detection-by-generation>4.1 Online Detection by Generation</a></li><li><a href=#42-complexity-analysis>4.2 Complexity Analysis</a></li></ol><ol><li><a href=#51-approximation-algorithm>5.1 Approximation Algorithm</a><ol><li><a href=#511-challenge>5.1.1 Challenge</a></li><li><a href=#512-design>5.1.2 Design</a></li></ol></li><li><a href=#52-complexity-analysis>5.2 Complexity Analysis</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/blog/p/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/>DeepTEA: Effective and Efficient Online Time-dependent Trajectory Outlier Detection</a></h2><h3 class=article-subtitle>PVLDB 2022. [DeepTEA: Effective and Efficient Online Time-dependent Trajectory Outlier Detection](https://www.vldb.org/pvldb/vol15/p1493-han.pdf)</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Sep 09, 2022</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 12 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p>PVLDB 2022. <a class=link href=https://www.vldb.org/pvldb/vol15/p1493-han.pdf target=_blank rel=noopener>DeepTEA: Effective and Efficient Online Time-dependent Trajectory Outlier<br>Detection</a></p><h1 id=abstract>Abstract</h1><p>ç ”ç©¶å¼‚å¸¸è½¨è¿¹æ£€æµ‹ï¼Œç›®çš„æ˜¯æå–é“è·¯ä¸­è½¦è¾†çš„å¼‚å¸¸ç§»åŠ¨ã€‚å¯ä»¥å¸®åŠ©ç†è§£äº¤é€šè¡Œä¸ºï¼Œè¯†åˆ«å‡ºç§Ÿè½¦æ¬ºè¯ˆã€‚ç”±äºäº¤é€šçŠ¶å†µåœ¨ä¸åŒæ—¶é—´ä¸åŒåœ°ç‚¹ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥è¿™ä¸ªé—®é¢˜å…·æœ‰æŒ‘æˆ˜ã€‚æœ¬æ–‡æå‡ºäº†Deep-probabilistic-based time-dependent anomaly detection algorithm (DeepTEA)ã€‚ä½¿ç”¨æ·±åº¦å­¦ä¹ æ–¹æ³•ä»å¤§é‡è½¨è¿¹é‡Œé¢è·å¾—time-dependent outlinersï¼Œå¯ä»¥å¤„ç†å¤æ‚çš„äº¤é€šçŠ¶å†µï¼Œå¹¶ç²¾ç¡®åœ°æ£€æµ‹å¼‚å¸¸ç°è±¡ã€‚æœ¬æ–‡è¿˜æå‡ºäº†ä¸€ä¸ªå¿«é€Ÿçš„è¿‘ä¼¼æ–¹æ³•ï¼Œä¸ºäº†åœ¨å®æ—¶ç¯å¢ƒä¸‹æ•è·åˆ°å¼‚å¸¸è¡Œä¸ºã€‚ç›¸æ¯”SOTAæ–¹æ³•ï¼Œæœ¬æ–‡æ–¹æ³•æå‡äº†17.52%ï¼Œå¹¶ä¸”å¯ä»¥å¤„ç†ç™¾ä¸‡è®¡çš„è½¨è¿¹æ•°æ®ã€‚</p><h1 id=2-problem-definition>2. Problem Definition</h1><p>Definition 1(Trajectory). è½¨è¿¹ç‚¹$p_{t_i}$æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„$(t_i, x, y)$ï¼Œåˆ†åˆ«æ˜¯æ—¶é—´æˆ³ã€çº¬åº¦ã€ç»åº¦ã€‚è½¨è¿¹$T$æ˜¯ä¸€ä¸ªè½¨è¿¹ç‚¹çš„æœ‰åºåºåˆ—ï¼Œå…¶ä¸­$t_1 &lt; \dots &lt; t_i &lt; \dots &lt; t_n$ã€‚</p><p>è½¨è¿¹å¼‚å¸¸æ£€æµ‹åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯åªè€ƒè™‘ä¸æ­£å¸¸è·¯çº¿ä¸åŒçš„å¼‚å¸¸è½¨è¿¹ã€‚å¦ä¸€ç§æ˜¯è€ƒè™‘ä¸time-dependentçš„æ­£å¸¸è·¯çº¿ä¸åŒçš„å¼‚å¸¸è½¨è¿¹ã€‚</p><p>Definition 2(Time-dependent Trajectory Outlier)ã€‚ç»™ä¸€æ¡è½¨è¿¹$T$ï¼Œèµ·ç‚¹$S_T$ï¼Œç»ˆç‚¹æ˜¯$D_T$ï¼Œè¿˜æœ‰travelæ—¶é—´ï¼Œä¸€ä¸ªtime-dependentè½¨è¿¹å¼‚å¸¸å®šä¹‰ä¸ºï¼šç›¸åŒçš„$S_T$å’Œ$D_T$ä»¥åŠç›¸åŒçš„å‡ºå‘ã€åˆ°è¾¾æ—¶é—´ä¸‹çš„è½¨è¿¹é‡Œé¢ï¼Œä¸€ä¸ªå¾ˆç¨€æœ‰çš„ã€ä¸åŒäºå…¶ä»–è½¨è¿¹çš„è½¨è¿¹ã€‚</p><p><img src=/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Fig1.jpg loading=lazy alt=Figure1></p><p>ä¸¾ä¾‹ï¼Œå¦‚æœä¸€ä¸ªè½¨è¿¹åœ¨2016å¹´10æœˆ1æ—¥çš„ä¸Šåˆ10ç‚¹å‡ºå‘ï¼Œ11ç‚¹åˆ°è¾¾ï¼Œé‚£ä¹ˆä¸€æ¡ç¨€æœ‰çš„è½¨è¿¹ä¸”å’Œç›¸åŒæ—¶é—´ç›¸åŒODçš„è½¨è¿¹ä¸åŒçš„è½¨è¿¹å°±æ˜¯è¿™ä¸ªTime-dependent Trajectory Outlier.</p><p>Problem 1(Online Time-dependent Trajectory Outlier Detection)ã€‚ç»™å®šä¸€æ¡æ­£åœ¨å‰è¿›çš„è½¨è¿¹$T$ï¼Œå®æ—¶è®¡ç®—å¹¶æ›´æ–°è¿™æ¡è½¨è¿¹æ˜¯æ—¶é—´ä¾èµ–çš„å¼‚å¸¸è½¨è¿¹çš„æ¦‚ç‡ã€‚</p><h1 id=3-the-deeptea-model>3. The DeepTEA Model</h1><h2 id=31-framework>3.1 Framework</h2><p><img src=/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Fig2.jpg loading=lazy alt=Figure2></p><p>ç»™å®šè½¨è¿¹$T$ï¼Œåœ¨æ—…è¡Œè¿‡ç¨‹ä¸­æ¨ç®—latent traffic pattern $q(z \mid T)$ã€‚è½¨è¿¹è§‚æµ‹å€¼ $\tau$ åæ˜ æ—¶é—´ä¾èµ–çš„è½¨è¿¹è½¬ç§»ï¼Œå¯ä»¥åœ¨ inference network é‡Œé¢ç”¨æ¥å»ºæ¨¡latent time-dependent route $r$ã€‚ä¹‹åï¼Œtime-dependent route $r$ç”¨æ¥ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼$\tau$ã€‚</p><h2 id=32-latent-traffic-pattern-inference>3.2 Latent Traffic Pattern Inference</h2><p>latent traffic pattern $z$ï¼Œè¡¨ç¤ºæ—…é€”è¿‡ç¨‹ä¸­çš„åŠ¨æ€äº¤é€šçŠ¶å†µï¼Œæ¯”å¦‚ ${\text{smooth} \rightarrow \text{congested} \rightarrow \text{smooth} }$ï¼Œæˆ–è€…${\text{congested} \rightarrow \text{smooth} }$ã€‚</p><h3 id=321-challenges>3.2.1 Challenges</h3><p>ç»™å®šè½¨è¿¹ $T$ï¼Œæˆ‘ä»¬æƒ³åŸºäº $T$ çš„ç©ºé—´è½¬ç§»ï¼Œæ¨ç®—å‡º latent traffic pattern $q(z \mid T)$ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªè¿œè·ç¦»çš„ç§»åŠ¨è¡¨æ˜å½“æ—¶çš„äº¤é€šçŠ¶å†µæ˜¯é€šç•…çš„ã€‚ä½†æ˜¯ä¸€ä¸ªè½¨è¿¹ $T$ å¯èƒ½è¡¨ç¤ºä¸€äº›éšæœºè¡Œä¸ºï¼Œæ¯”å¦‚åœè½¦ä¼‘æ¯ï¼Œè¿™ç§è¡Œä¸ºä¸èƒ½è¡¨æ˜å½“æ—¶çš„äº¤é€šçŠ¶å†µã€‚è¿™æ˜¯åœ¨è¡¨ç¤ºå®é™…äº¤é€šæ¨¡å¼æ—¶çš„ç¬¬ä¸€ä¸ªæŒ‘æˆ˜ã€‚ç¬¬äºŒä¸ªæŒ‘æˆ˜æ˜¯äº¤é€šçŠ¶æ€åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œä¸åŒçš„æ—¶é—´æ˜¯ä¸åŒçš„ï¼ŒåŠ¨æ€çš„ã€‚åŒä¸€æ—¶é—´ï¼Œä¸åŒODä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚è€Œä¸”åœ¨æ•´ä¸ªæ—…é€”ä¸­çš„äº¤é€šçŠ¶æ€å˜åŒ–ä¹Ÿæ˜¯å‰§çƒˆçš„ã€‚å¯èƒ½å¼€å§‹çš„æ—¶å€™é¡ºç•…ï¼Œç»“æŸçš„æ—¶å€™æ‹¥å µã€‚æ•è·äº¤é€šçŠ¶æ€å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå¯¹æ—¶é—´ä¾èµ–çš„æ­£å¸¸è·¯å¾„å½±å“å¾ˆå¤§ã€‚</p><h3 id=322-design>3.2.2 Design</h3><p>ä¸ºäº†è§£å†³ç¬¬ä¸€ä¸ªæŒ‘æˆ˜ï¼Œæˆ‘ä»¬ä»æ—¶é—´ $t_i$ çš„ä¸€ç»„è½¨è¿¹ ${ T_{t_i} }$ é‡Œé¢å­¦ä¹ latent traffic pattern $z$ï¼Œè€Œä¸æ˜¯å•æ¡è½¨è¿¹ $T$ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨ time point series è¡¨ç¤ºæ—…è¡Œæ—¶é—´ã€‚ä¸ºäº†ä» ${ T_{t_i} }$ é‡Œé¢å¾ˆå¥½åœ°ç»„ç»‡äº¤é€šä¿¡æ¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª map grid matrix $Z_{t_i}$ï¼Œè¿™é‡Œé¢æ¯ä¸ªå•å…ƒè¡¨ç¤ºå¹³å‡é€Ÿåº¦ï¼Œç”¨è¿™ä¸ªå¯¹ $t_i$ çš„äº¤é€šçŠ¶æ€å»ºæ¨¡ã€‚ä»å›¾2å¯ä»¥çœ‹å‡ºï¼Œçº¢è‰²è¡¨ç¤ºé€Ÿåº¦ä½ï¼Œè¡¨ç¤ºæ‹¥å µã€‚ç»¿è‰²è¡¨ç¤ºç•…é€šã€‚é»„è‰²è¡¨ç¤ºå³å°†æ‹¥å µï¼Œå¹³å‡é€Ÿåº¦ä»‹äºçº¢ç»¿ä¹‹é—´ã€‚ä¸ºäº†è§£å†³åŒä¸€æ—¶é—´ä¸åŒä½ç½®äº¤é€šçŠ¶æ€çš„å¤šæ ·æ€§ï¼Œæˆ‘ä»¬ç”¨CNNå»ºæ¨¡ã€‚å¯¹äºæ²¡æœ‰è½¦è¾†çš„åŒºåŸŸï¼ŒCNNå¯ä»¥ä»æœ‰è½¦è¾†çš„å•å…ƒå­¦åˆ°ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å°†ä»–ä»¬è¡¨ç¤ºä¸ºç¼ºå¤±å€¼ã€‚å› ä¸ºå®æ—¶çŠ¶æ€ä¸‹äº¤é€šçŠ¶å†µå˜å¾—å¾ˆé¢‘ç¹ï¼Œæˆ‘ä»¬ç”¨RNNæ•è·è¿™ç§ä¸æ–­å˜åŒ–çš„åŠ¨æ€æ€§ï¼Œè§£å†³ç¬¬äºŒä¸ªæŒ‘æˆ˜ã€‚äº¤é€šçŠ¶æ€çš„å˜åŒ–å¯ä»¥é€šè¿‡RNNå¾ˆå¥½çš„å»ºæ¨¡ã€‚ç„¶åæˆ‘ä»¬ç”¨ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒå’ŒRNNçš„éšè—çŠ¶æ€ï¼Œæ¨ç®— latent traffic pattern $z$ã€‚CNN+RNNé€‰ç”¨äº† Convolutional LSTMã€‚</p><p>æˆ‘ä»¬ç”¨ä¸Šé¢çš„éšæ—¶é—´å˜åŒ–çš„åŠ¨æ€äº¤é€šçŠ¶æ€æ¥æ¨ç®—latent traffic pattern $z$ã€‚è¿™é‡Œçš„æƒ³æ³•æ˜¯äº¤é€šçŠ¶æ€ä¼šå› ä¸ºå¤æ‚çš„å®æ—¶ç‰¹å¾å‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚ä¿¡å·ç¯ã€äº‹æ•…ã€æ—©æ™šé«˜å³°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨DeepTEAé‡Œé¢ä¼šéšæ—¶é—´å˜åŒ–æ›´æ–°$Z$ï¼Œè¡¨ç¤ºä¸º$Z_{t_i}$ï¼Œè¡¨ç¤ºè½¨è¿¹ç‚¹$p_{t_i}$åœ¨æ—¶é—´$t_i$çš„äº¤é€šçŠ¶æ€ã€‚æˆ‘ä»¬ä¼šä»å®é™…äº¤é€šçŠ¶å†µ$Z = { Z_{t_i}, Z_{t_{i+1}}, \dots, Z_{t_{i+n}} }$é‡Œé¢æ¨ç®—latent traffic pattern $z$ã€‚è¿™é‡Œé¢çš„äº¤é€šçŠ¶å†µå¯¹åº”çš„æ—¶é—´åˆ†åˆ«æ˜¯å¯¹åº”è½¨è¿¹ç‚¹${ p_t, p_{t+1}, \dots, p_{t_{i+n}} }$çš„æ—¶é—´ã€‚å¯¹äºçœŸå®äº¤é€šçŠ¶å†µ$Z$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è½¨è¿¹$T$ç»è¿‡çš„æ—¶é—´çš„å¹³å‡é€Ÿåº¦ã€‚æ¢å¥è¯è¯´å°±æ˜¯ï¼ŒçœŸå®äº¤é€šçŠ¶å†µ$Z_{t_i}$æ˜¯ä¸€ä¸ªå¹³å‡é€Ÿåº¦çŸ©é˜µï¼Œå®ƒåŒ…å«äº†æ•´ä¸ªåŸå¸‚åœ¨$t_i$çš„ç§»åŠ¨çŠ¶æ€ã€‚å¦‚æœä¸¤ä¸ªè½¨è¿¹ç‚¹ä¹‹é—´çš„æ—¶é—´å·®å¾ˆå°ï¼Œé‚£ä¹ˆ$Z_{t_i}$å’Œ$Z_{t_{i+1}}$å¯èƒ½ä¼šå¾ˆç›¸ä¼¼ã€‚è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦æŠŠé€Ÿåº¦æŒ‰æ—¶æ®µæå‰èšåˆèµ·æ¥ï¼Œå°±å–å¹³å‡é€Ÿåº¦ï¼Œæ¯”å¦‚10åˆ†é’Ÿçš„æ—¶æ®µï¼Œè€Œä¸å†ä½¿ç”¨æ—¶é—´ç‚¹ã€‚ä¸ºäº†å‡è½»ç¨€ç–çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨CNNå°†æœ‰è½¦è¾†çš„ä½ç½®çš„ä¿¡æ¯ä¼ æ’­åˆ°æ²¡æœ‰è½¦è¾†æ²¡æ•°æ®çš„ä½ç½®ä¸Šã€‚ä¸ºäº†æ•è·ä¸åŒæ—¶æ®µçš„åŠ¨æ€å˜åŒ–ï¼Œæˆ‘ä»¬ç”¨RNNå»ºæ¨¡æ—¶é—´ç»´åº¦çš„äº¤é€šè½¬ç§»ã€‚è¿™æ ·ï¼Œspatial traffic correlationå’Œtemporal transitioné€šè¿‡$f_1(Z)$æ¥æ•è·ï¼š</p>$$
\tag{1} f\_1(Z) = \text{RNN}(\text{CNN}(Z)),
$$<p>è¿™é‡Œå‡½æ•°$f_1(\cdot)$æ˜¯ä¸€ä¸ªCNN+RNNï¼ŒCNNå¯¹æ¯ä¸ª$Z_i$éƒ½ä½¿ç”¨ï¼Œç„¶åç”¨RNNå¯¹ä»–ä»¬å»ºæ¨¡ï¼Œæ•è·traffic transitionã€‚</p><p>ä¸ºäº†è®©æ¨¡å‹å…·æœ‰ç”Ÿæˆèƒ½åŠ›ï¼Œå¹¶ä¸”å¯¹äº¤é€šçŠ¶æ€çš„ä¸ç¡®å®šæ€§å»ºæ¨¡ï¼Œåœ¨ç»™å®šå®é™…äº¤é€šçŠ¶æ€$Z$çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç”¨é«˜æ–¯åˆ†å¸ƒå¯¹latent traffic pattern $z$å»ºæ¨¡ï¼Œå¯ä»¥ç”¨æ¥åœ¨ç»™å®šè½¨è¿¹$T$æ—¶è¿‘ä¼¼latent traffic pattern $z$çš„åˆ†å¸ƒï¼Œå¦‚å…¬å¼2æ‰€ç¤ºã€‚æˆ‘ä»¬å°†å‚æ•°è®°ä¸º$\phi$ï¼Œ</p>$$
\tag{2} q\_\phi(z \mid T) \coloneqq q\_\phi(z \mid Z) = \mathcal{N}(\mu\_Z, \text{diag}(\sigma^2\_Z)),
$$<p>å‡å€¼$\mu_Z$å’Œæ ‡å‡†å·®$\sigma_Z$é€šè¿‡MLPå‡½æ•° $g_1(f_1(Z))$å¾—åˆ°ï¼Œå‚æ•°æ˜¯$\phi = { f_1(\cdot), g_1(\cdot) }$ã€‚</p><p>è¿™ç§æ–¹å¼åœ¨ç»™å®šè½¨è¿¹$T$çš„æ—¶å€™å¯ä»¥å¾ˆå¥½çš„æ¨æ–­å‡ºlatent traffic pattern $z$ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œå‚æ•°$\phi$å¯ä»¥å­¦åˆ°å¦‚ä½•æ•è·latent traffic pattern $z$ï¼Œè€Œä¸”èƒ½è¡¨ç¤ºäº¤é€šçŠ¶æ€çš„å¤šæ ·æ€§å’ŒåŠ¨æ€æ€§ã€‚</p><h2 id=33-latent-time-dependent-route-inference>3.3 Latent Time-dependent Route Inference</h2><h3 id=331-challenges>3.3.1 Challenges</h3><p>è½¨è¿¹$T$ä¸ä»…å¯ä»¥è¡¨ç¤ºä½ç½®ä¿¡æ¯ï¼Œè¿˜å¯ä»¥è¡¨ç¤ºä¸¤ä¸ªè½¨è¿¹ç‚¹ä¹‹é—´è½¬ç§»çš„latent traffic pattern $z$ã€‚ç›¸æ¯”åªæœ€å¤§åŒ–ä½ç½®ä¿¡æ¯çš„ä¼¼ç„¶ï¼Œå¯¹ä½ç½®å’Œlatent traffic pattern $z$åŒæ—¶åšæ›´informativeï¼Œå› ä¸ºå®ƒå¯ä»¥åæ˜ åœ¨æ—¶é—´ä¾èµ–çš„äº¤é€šçŠ¶æ€ä¸‹çš„è½¨è¿¹è½¬ç§»ã€‚</p><h3 id=332-design>3.3.2 Design</h3><p>ä¸€æ¡è½¨è¿¹ $T$ ä¸ä»…èƒ½åæ˜ ä½ç½® $p_{t_i}$ï¼Œè¿˜èƒ½åŸºäºä¸¤ä¸ªè¿ç»­è½¨è¿¹ç‚¹ $p_{t_{i-1}}$ å’Œ $p_{t_i}$ ä¹‹é—´çš„è½¬ç§»ï¼Œä¼ é€’å‡º latent traffic pattern $z$ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨ $o(p_{t_i}, z)$ è¡¨ç¤ºè½¨è¿¹ $T$ èƒŒåçš„è§‚æµ‹å€¼ $\tau_i$ã€‚è¿™é‡Œå¸Œæœ›ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œå¤„ç†è§‚æµ‹å€¼ $p_{t_i}$ å’Œ $z$ï¼š</p>$$
\tag{3} \tau\_i = o(p\_{t\_i}, z) = f\_2(p\_{t\_i}, z) = \text{NN}(p\_{t\_i}, z),
$$<p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œå­¦ä¹  latent traffic pattern $z$ çš„è§‚æµ‹å€¼ $p_{t_i}$ï¼š</p>$$
\tag{4} \text{NN}(p\_{t\_i}, z) = W p\_{t\_i} + Q z,
$$<p>$\text{NN}$çš„å‚æ•°æ˜¯$W$å’Œ$Q$ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å­¦ä¹ ä¸€æ¡è½¨è¿¹ $T$ ç»è¿‡çš„ latent time-dependent route $r$ã€‚æˆ‘ä»¬è§£é‡Šè¿‡ï¼Œè½¨è¿¹ $T$ ä¸ä»…èƒ½è¡¨ç¤ºè½¨è¿¹ç‚¹ $p_{t_i}$ çš„ä½ç½®ä¿¡æ¯ï¼Œè¿˜èƒ½æŒ‡æ˜ä¸¤ä¸ªè½¨è¿¹ç‚¹ä¹‹é—´è½¬ç§»çš„ latent traffic pattern $z$ã€‚latent time-dependent route $r$ çš„å«ä¹‰å¯ä»¥è§£é‡Šä¸ºï¼šé«˜å³°æ—¶é—´æ®µåŸå¸‚è·¯æ®µçš„äº¤é€šçŠ¶æ€æ˜¯æ‹¥å µçš„ï¼Œé©¾é©¶å‘˜é€šå¸¸ä¼šä¸Šé«˜é€Ÿï¼Œå› ä¸ºé‚£é‡Œä¼šç•…é€šã€‚</p><p>è½¨è¿¹ $T$ ç»è¿‡çš„ latent time-dependent route $r$ çš„è¡¨ç¤ºä¸ºï¼š</p>$$
\tag{5} r\_T \sim q\_\gamma (r \mid T),
$$<p>$\gamma$ æ˜¯æ¨æµ‹ latent time-dependent route $r$ æ—¶çš„å‚æ•°ã€‚</p><p>åŸºäºä¹‹å‰çš„è½¨è¿¹ç‚¹å’Œ latent traffic pattern $z$ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨RNNè·å¾—è½¨è¿¹è§‚æµ‹å€¼ä¹‹é—´çš„è½¬ç§»ï¼ŒRNNè®°ä¸º $f_3$ï¼Œè¿™é‡Œä½¿ç”¨GRUï¼š</p>$$
\tag{6} h\_i = f\_3 (h\_{i-1}, \tau\_i),
$$<p>$h_{i-1}$ æ˜¯ä¹‹å‰è§‚æµ‹å€¼ $\tau_{i-1}$ çš„éšè—çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è½¨è¿¹ç‚¹ $p_{t_{i-1}}$ å¸¦ç€ latent traffic pattern $z$ã€‚</p><p>å¯¹äºè½¨è¿¹è§‚æµ‹å€¼çš„ä¸ç¡®å®šæ€§ï¼Œæˆ‘ä»¬é€šè¿‡é«˜æ–¯åˆ†å¸ƒå»ºæ¨¡ $q_\gamma (r \mid T)$ï¼š</p>$$
\tag{7} q\_\gamma (r \mid T) = \mathcal{N} (\mu\_T, \text{diag}(\sigma^2\_T)),
$$<p>æˆ‘ä»¬ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œ $g_3(h_n)$ æ¥å­¦ä¹ å‡å€¼å’Œæ ‡å‡†å·®ã€‚</p><p>ä¸ºäº†åœ¨ latent traffic pattern é‡Œé¢åŒºåˆ†æ­£å¸¸çš„è½¨è¿¹è½¬ç§»å’Œå¼‚å¸¸çš„è½¨è¿¹è½¬ç§»ï¼Œéœ€è¦è®¾è®¡ä¸€ä¸ªæ¨¡å—å¯¹è½¨è¿¹é‡Œ latent time-dependent normal routeå»ºæ¨¡ï¼Œè¿™é‡Œ $z$ ä¼šæä¾› time-dependent traffic ä¿¡æ¯ã€‚ä½¿ç”¨é«˜æ–¯åˆ†å¸ƒï¼š</p>$$
\tag{8} p\_\gamma (r \mid k, z) = \mathcal{N}(\mu\_r, \text{diag}(\sigma^2\_r)),
$$<p>$k$ è¡¨ç¤º latent time-dependent route çš„ç±»å‹ï¼Œæœä»å¤šé¡¹å¼åˆ†å¸ƒï¼š</p>$$
\tag{9} p\_\gamma (k) = \text{Mult} (\pi),
$$<p>$\pi$ æ˜¯å¤šé¡¹å¼åˆ†å¸ƒçš„å‚æ•°ã€‚ç„¶åï¼Œè¶‹è¿‘ $q_\gamma (r \mid T)$ çš„å‡å€¼çš„ latent time-dependent route æ˜¯time-dependent normal routeã€‚</p><p>ç„¶åï¼Œæ¨æ–­ç½‘ç»œå¯ä»¥ä»ç»™å®šçš„è½¨è¿¹ $T$ é‡Œé¢æ¨ç®— latent time-dependent route $r$ï¼Œlatent time-dependent route type $k$ï¼Œè¿˜æœ‰ latent traffic pattern $z$ ä¸º $q_{\gamma,\phi}(r, k, z \mid T)$ã€‚é€šè¿‡ä½¿ç”¨ mean-field approximationï¼Œå¯ä»¥åˆ†è§£ä¸ºï¼š</p>$$
\tag{10} q\_{\gamma,\phi}(r, k, z \mid T) = q\_\gamma(r \mid T) \ q\_\phi(z \mid T) \ q\_\gamma (k \mid T),
$$<p>$q_\gamma (k \mid T)$ å¯ä»¥è½¬æ¢ä¸ºåœ¨ç»™å®š è½¨è¿¹ $T$ ç»è¿‡ latent time-dependent route $r$ çš„æ¡ä»¶ä¸‹ï¼Œroute type $k$ çš„åˆ†å¸ƒï¼š</p>$$
\tag{11} q\_\gamma (k \mid T) \coloneqq p\_\gamma (k \mid r\_T) = \frac{p\_\gamma (k) p\_\gamma (r\_T \mid k)}{\sum^K\_{i=1} p\_\gamma (k\_i) p\_\gamma (r\_T \mid k\_i)},
$$<p>$K$ æ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼Œè¡¨ç¤º route ç±»å‹çš„ä¸ªæ•°ã€‚</p><p>å› æ­¤ï¼Œæ¨æ–­ç½‘ç»œå¯ä»¥ä»è½¨è¿¹ $T$ çš„è§‚æµ‹å€¼ $o(p_{t_i}, z)$ æ¨æ–­å‡º latent time-dependent route $r$ã€‚$\gamma = { f_2(\cdot), f_3(\cdot), g_3(\cdot), \pi, \mu_r, \sigma_r }$ è¿™äº›éƒ½æ˜¯å‚æ•°ã€‚</p><h2 id=34-trajectory-observation-generation>3.4 Trajectory Observation Generation</h2><p>ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼çš„ç›®æ ‡æ˜¯ç»™å®š latent time-dependent route $r$ï¼Œtime-dependent route type $k$ å’Œ latent traffic pattern $z$ æ—¶ï¼Œæœ€å¤§åŒ–ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ çš„æ¦‚ç‡ï¼Œä¹Ÿå°±æ˜¯ $o(p_{t_i}, z)$ã€‚è¿™ä¸ªæ¦‚ç‡è®°ä¸º $p_\theta (T \mid r, z, k)$ï¼Œ$\theta$ è¡¨ç¤ºç”¨äºç”Ÿæˆè¿‡ç¨‹çš„å‚æ•°ã€‚ä»å¯¹ç§°çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬ç”¨RNNæ¥ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ï¼Œä¹Ÿå°±æ˜¯ $o(p_{t_i}, z)$ï¼š</p>$$
\tag{12} \begin{align} \eta\_i &= f\_4 (\tau\_i, \eta\_{i-1}) \\ &= f\_4(o(p\_{t\_i}, z), \eta\_{i-1}) \\ &= \text{RNN} (o(p\_{t\_i}, z), \eta\_{i-1}), i = 1, 2, \dots, n, \ and \ \eta\_o = r, \end{align}
$$<p>RNNçš„èµ·å§‹è¾“å…¥æ˜¯ $\eta_0$ã€‚ä» $\eta_1$ å¼€å§‹ï¼Œè¾“å…¥å˜æˆä¸Šä¸€ä¸ªéšè—çŠ¶æ€ $\eta_{i-1}$ å’Œè½¨è¿¹è§‚æµ‹å€¼ $o(p_{t_i}, z)$ã€‚å› æ­¤ï¼Œè§‚æµ‹å€¼ $\tau_i$ï¼Œä¹Ÿå°±æ˜¯ $p_{t_i}$ åœ¨ latent traffic pattern $z$ çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å…¬å¼ç”Ÿæˆï¼š</p>$$
\tag{13} \begin{align} \tau\_i &= o(p\_{t\_i}, z) \sim p\_\theta (o(p\_{t\_i}, z) \mid o(p\_{1:i-1}, z), r) \\ &= p\_\theta(\tau \mid \eta\_{i-1}) \\ &= \text{Mult}(\text{softmax}(g\_4 (\eta\_{i-1}))), \end{align}
$$<p>$g_4(\cdot)$æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠè¾“å‡ºæ˜ å°„åˆ°ç½‘æ ¼çš„ä¸ªæ•°ã€‚softmax ç”¨æ¥æŠŠæ¦‚ç‡çš„å’Œå˜æˆ1ã€‚ç„¶åè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ å¯ä»¥é€šè¿‡å¤šé¡¹å¼åˆ†å¸ƒç”Ÿæˆã€‚</p><p>å› æ­¤ï¼Œè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ï¼Œä¹Ÿå°±æ˜¯ $o(p_{t_i}, z)$ï¼Œå¯ä»¥åŸºäº latent time-dependent route $r$ï¼Œroute type $k$ å’Œ latent traffic pattern $z$ ç”Ÿæˆã€‚æˆ‘ä»¬ç»™ç”Ÿæˆç”¨çš„å‚æ•°è®°ä¸º $\theta = { f_4(\cdot), g_4(\cdot) }$ã€‚è¿™äº›å‚æ•°ä¼šåœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­å­¦åˆ°ã€‚</p><h2 id=35-optimization>3.5 Optimization</h2><p>æˆ‘ä»¬ä¸Šé¢è®²äº†ï¼Œè½¨è¿¹è§‚æµ‹å€¼ä¸ä»…èƒ½åæ˜ ä½ç½®ä¿¡æ¯ï¼Œè¿˜èƒ½åŸºäºä¸¤ä¸ªè¿ç»­çš„è½¨è¿¹ç‚¹çš„è½¬ç§»ä¼ é€’å‡º latent traffic patternã€‚å› æ­¤ï¼Œç›®æ ‡å‡½æ•°æ˜¯æœ€å¤§åŒ–è§‚æµ‹åˆ°çš„è½¨è¿¹çš„è¾¹ç¼˜å¯¹æ•°ä¼¼ç„¶ï¼š</p>$$
\tag{14} \log p\_\theta(T^{(1)}, T^{(2)}, \dots, T^{(N)}) \coloneqq \log p\_\theta (\tau^{(1)}, \tau^{(2)}, \dots, \tau^{(N)}).
$$<p>æˆ‘ä»¬é€šè¿‡æœ€å¤§åŒ–ELBOæ¥ä¼˜åŒ–ä¸Šé¢çš„è¾¹ç¼˜å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š</p>$$
\tag{15} \log p\_\theta (T) \geq \text{ELBO} = \mathcal{L}(\phi, \gamma, \theta; T).
$$<p>è½¨è¿¹ $T$ çš„è¾¹ç¼˜å¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„ ELBO é€šè¿‡ä¸‹é¢çš„å…¬å¼è®¡ç®—ï¼š</p>$$
\tag{16} \begin{align} \mathcal{L}(\phi, \gamma, \theta; T) &= \mathbb{E}\_{q\_{\gamma, \phi}(r, k, z \mid T)}[ \log \frac{p\_{\phi, \gamma, \theta}(r, k, z, T)}{q\_{\gamma, \theta}(r, k, z \mid T)}] \\ &= - \mathbb{E}\_{q\_\gamma(r \mid T)} D\_{KL} (q\_\gamma (k \mid T) \Vert p\_\gamma (k)) \\ & - \mathbb{E}\_{q\_\gamma (k \mid T)} D\_{KL} ( q\_\gamma (r \mid T) \Vert p\_\gamma (r \mid k, z)) \\ & - D\_{KL} (q\_\phi (z \mid T) \Vert p\_\phi(z)) + \mathbb{E}\_{q\_{\gamma, \phi}(r, k, z \mid T)} \log p\_\theta (T \mid r, z, k), \end{align}
$$<p>å…¶ä¸­ï¼Œ$p_\theta(z)$ æ˜¯ latent traffic pattern $z$ çš„å…ˆéªŒæ¦‚ç‡ã€‚ç”Ÿæˆç½‘ç»œ $\log p_\theta(T \mid r, z, k)$ å¯ä»¥é€šè¿‡ä¸‹é¢å…¬å¼è®¡ç®—ï¼š</p>$$
\tag{17} \log p\_\theta (T \mid r, z, k) = \sum^n\_{i=1} \log p\_\theta (\tau\_i \mid \tau\_{1: i-1}, r, z, k)
$$<p>æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹çš„ç®—æ³•å¦‚ç®—æ³•1æ‰€ç¤ºã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹å‚æ•°é€šè¿‡ä¼˜åŒ–è½¨è¿¹ $T$ çš„ ELBO æ¥å­¦ä¹ ã€‚ç„¶åè¿™äº›å­¦åˆ°çš„å‚æ•°ä¼šç”¨äº online anomaly detectionï¼Œåé¢ä¼šä»‹ç»ã€‚</p><p><img src=/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Algo1.jpg loading=lazy alt=Algo1></p><h2 id=36-complexity-analysis>3.6 Complexity Analysis</h2><p>è®­ç»ƒ DeepTEA çš„å¤æ‚åº¦æ˜¯ $O(N \cdot (d_{Z_1} d_{Z_2} \bar{V} + \bar{n}))$ï¼Œ$N$ æ˜¯è½¨è¿¹æ•°ï¼Œ$d_{Z_1}$ å’Œ $d_{Z_2}$ æ˜¯ $Z$ çš„å¤§å°ï¼Œ$\bar{V}$ æ˜¯æ—¶é—´é—´éš”çš„å¹³å‡ä¸ªæ•°ï¼Œ$\bar{n}$ æ˜¯è½¨è¿¹çš„å¹³å‡é•¿åº¦ã€‚</p><h1 id=online-trajectory-outlier-detection-by-deeptea>Online Trajectory Outlier Detection by DeepTEA</h1><p>åŸºäºç®—æ³•1å­¦ä¹ å¾—åˆ°çš„å‚æ•°ï¼Œå½“ä¸‹ä¸€ä¸ªè½¨è¿¹è§‚æµ‹å€¼ $\tau_{i+1}$ å®æ—¶è¿‡æ¥çš„æ—¶å€™ï¼Œå¼‚å¸¸åˆ†æ•°ä¼šå®æ—¶æ›´æ–°ã€‚è¿™ä¸ªè¿‡ç¨‹è¦å¿«ã€‚è€Œä¸”ç›´åˆ°è½¨è¿¹å®Œæˆï¼Œè¿™ä¸ªå¼‚å¸¸åˆ†æ•°éƒ½è¦æ›´æ–°ã€‚</p><h2 id=41-online-detection-by-generation>4.1 Online Detection by Generation</h2><p>å›¾3å±•ç¤ºäº†åœ¨çº¿å¼‚å¸¸è½¨è¿¹æ£€æµ‹çš„æ­¥éª¤ã€‚</p><p><img src=/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Fig3.jpg loading=lazy alt=Figure3></p><p>æˆ‘ä»¬é€šè¿‡å­¦åˆ°çš„ç½‘ç»œç”Ÿæˆè§‚æµ‹åˆ°çš„è½¨è¿¹æ¥æ£€æµ‹å¼‚å¸¸ã€‚latent time-dependent route çš„åˆ†å¸ƒ $q_\gamma (r \mid T)$ å¯ä»¥é€šè¿‡å‚æ•° $\gamma$ æ¥è®¡ç®—ã€‚latent traffic pattern $z$ å¯ä»¥é€šè¿‡å‚æ•° $\phi$ å’Œ $Z$ è·å¾—ã€‚ç»™å®š $q_\gamma (r \mid T)$ é‡Œé¢ç¬¬ $k$ ä¸ªå‡å€¼ $u_k$ï¼Œæˆ‘ä»¬ç”¨ RNN ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼ï¼š</p>$$
\tag{18} \eta\_i = f\_4(\tau\_i, \eta\_{i-1}) = \text{RNN} (\tau\_i, \eta\_{i - 1}), i = 1, 2, \dots, n, \text{and} \ \eta\_0 = u\_k,
$$<p>RNNçš„èµ·å§‹è¾“å…¥æ˜¯ $\eta_0$ï¼Œè¿™é‡Œè®¾ç½®ä¸º $u_k$ã€‚ä» $\eta_1$ å¼€å§‹ï¼Œè¾“å…¥æ ‡ç§°éšè—çŠ¶æ€ $\eta_{i-1}$ å’Œè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ï¼Œå³ $o(p_{t_i}, z)$ã€‚å› æ­¤ $\tau_{i+1}$ å¯ä»¥ç”¨ä¸‹é¢çš„å…¬å¼ç”Ÿæˆï¼š</p>$$
\tag{19} p\_\theta (\tau\_{i+1} \mid \tau\_{i:i}, u\_k) = \text{softmax}(g\_4 (\eta\_{i-1})),
$$<p>$g_4(\cdot)$ æ˜¯ç”¨æ¥æŠŠè¾“å‡ºæ˜ å°„åˆ°ç½‘æ ¼æ•°çš„å‡½æ•°ã€‚</p><p>ç»™å®šå­¦åˆ°çš„ $q_\gamma (r \mid T)$ å’Œ latent traffic pattern $z$ï¼Œè½¨è¿¹ $T$ çš„å®æ—¶å¼‚å¸¸åˆ†æ•° $s_a(\tau_{i:i})$ å¯ä»¥è®¡ç®—ä¸º 1 - ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼ $\tau_{i:i}$ çš„ä¼¼ç„¶ï¼Œå³ ${ \tau_1 \rightarrow \tau_2 \rightarrow \dots \tau_i }$ï¼š</p>$$
\tag{20} s\_a(\tau\_{i:i}) = 1 - \arg \max\_k \exp [\frac{\sum^n\_{i=1} \log p\_\theta (\tau\_i \mid \tau\_{1:i-1}, u\_k)}{n}]
$$<p>åœ¨çº¿ä¸Šåœºæ™¯ä¸‹ï¼Œç»™å®šä¹‹å‰çš„è½¨è¿¹è§‚æµ‹å€¼ $\tau_{i:i}$ï¼Œä¸‹ä¸€ä¸ªè½¨è¿¹è§‚æµ‹å€¼çš„å¼‚å¸¸åˆ†æ•°å¯ä»¥é€šè¿‡ä¹‹å‰è¿™ä¸ªæ•°æ¥è®¡ç®—ï¼š</p>$$
\tag{21} s\_a(\tau\_{i:i+1}) = 1 - \arg \max\_k \exp [\frac{\log p\_\theta (\tau\_{1:i} \mid u\_k) p\_\theta(\tau\_{i+1} \mid \tau\_{1:i}, u\_k)}{i + 1}]
$$<p><img src=/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Algo2.jpg loading=lazy alt=Algo2></p><p>ç®—æ³•2æ˜¯åœ¨çº¿æ£€æµ‹çš„è¿‡ç¨‹ã€‚è¾“å…¥æ˜¯è½¨è¿¹ $T$ï¼Œå‚æ•°æ˜¯ä»ç®—æ³•1å­¦åˆ°çš„ã€‚å¯¹äºæ–°æ¥çš„è½¨è¿¹è§‚æµ‹å€¼ $\tau_{i+1}$ï¼Œå¦‚æœ latent traffic pattern $z$ å˜äº†ï¼Œé‚£æˆ‘ä»¬å°±æ›´æ–° $z$ã€‚ç„¶ååŸºäº $\tau_{1:i}$ è®¡ç®— $\tau_{1:i+1}$ã€‚æœ€åè¿”å›å¼‚å¸¸åˆ†æ•°ã€‚</p><h2 id=42-complexity-analysis>4.2 Complexity Analysis</h2><p>æ•´ä¸ªæ£€æµ‹çš„å¤æ‚åº¦æ˜¯ $\mathcal{O}(d_{Z_1} d_{Z_2})$ï¼Œ$d_{Z_1}$ å’Œ $d_{Z_2}$ æ˜¯ $Z$ çš„å¤§å°ã€‚</p><h1 id=5-the-deeptea-a-model-approximate-online-detection>5 The DeepTEA-A Model: Approximate Online Detection</h1><h2 id=51-approximation-algorithm>5.1 Approximation Algorithm</h2><h3 id=511-challenge>5.1.1 Challenge</h3><p>åŸºäº $\tau_{1:i}$ çš„å¼‚å¸¸åˆ†æ•°æ›´æ–°ä¾èµ– $t_{i+1}$ çš„äº¤é€šçŠ¶æ€çŸ©é˜µ $Z$ï¼Œå¦‚æœè·¯ç½‘å¾ˆå¤§ï¼Œè¿™é‡Œè€—æ—¶ä¼šé•¿ã€‚</p><h3 id=512-design>5.1.2 Design</h3><p>å— GM-VSAE çš„å¯å‘ï¼Œæœ¬æ–‡æå‡ºäº†è¿‘ä¼¼ç®—æ³•ã€‚ä½¿ç”¨ $\tau_1$ çš„æ—¶æ®µçš„äº¤é€šçŠ¶æ€çŸ©é˜µ $Z$ ä½œä¸ºæ•´ä¸ª trip è¿‡ç¨‹çš„äº¤é€šçŠ¶å†µçš„è¿‘ä¼¼ã€‚è¿™æ ·ï¼Œ$Z$ åªè¦åœ¨ç¬¬ä¸€ä¸ªè½¨è¿¹è§‚æµ‹å€¼ $\tau_1$ çš„æ—¶å€™ç®—ä¸€ä¸‹å°±å¥½äº†ã€‚online æ›´æ–°çš„æ—¶å€™å°±ä¸éœ€è¦å†ç®—è¿™ä¸ªäº†ã€‚</p><p>ç»™å®šä¸€ä¸ªèµ·ç‚¹ $S_T$ å’Œç»ˆç‚¹ $D_T$ï¼Œä» $q(k \mid S_T, D_T, z_{S_T})$ è¿™é‡Œé¢å–å‡ºæœ€ä¼˜çš„ latent route type $k$ æ¥è¿‘ä¼¼æœ€æœ‰ latent route pattern $u_k$ï¼Œè¿™éœ€è¦ä» $q_\gamma (r \mid T)$ çš„ $k$ ä¸ªå‡å€¼é‡Œé¢æ‰¾ï¼Œ$Z_{S_T}$ æ˜¯ trip å¼€å§‹æ—¶çš„äº¤é€šçŠ¶å†µã€‚è¿™æ ·ï¼Œæœ€ä¼˜çš„ latent route type $k$ åœ¨ trip ä¸€å¼€å§‹çš„æ—¶å€™å°±èƒ½æ‹¿åˆ°ã€‚ä»ç¬¬äºŒä¸ªè½¨è¿¹è§‚æµ‹å€¼å¼€å§‹ï¼Œè¿™ä¸ª $k$ å°±ä¸éœ€è¦å†ç®—äº†ã€‚</p><p>å¯¹äºèµ·ç‚¹ $S_T$ï¼Œäº¤é€šçŠ¶å†µ $Z_{S_T}$ çš„éšè—çŠ¶æ€å¯ä»¥é€šè¿‡ä¸‹é¢å…¬å¼è®¡ç®—ï¼š</p>$$
\tag{22} f\_1(Z\_{S\_T}) = \text{CNN} (Z\_{S\_T}),
$$<p>ç„¶å $z_{S_T}$ å¯ä»¥ä» $q_\phi (z_{S_T} \mid Z_{S_T})$ é‡Œé¢é‡‡æ ·å¾—åˆ°ï¼š</p>$$
\tag{23} q\_\phi (z\_{S\_T} \mid Z\_{S\_T}) = \mathcal{N}(\mu\_{Z\_{S\_T}}, diag(\sigma^2\_{Z\_{S\_T}})),
$$<p>ç„¶åï¼Œ$\tau_{S_T}$ å¯ä»¥é€šè¿‡ $f_2(\cdot)$ å¾—åˆ°ï¼š</p>$$
\tag{24} \tau\_{S\_T} = f\_2(S\_T, z\_{S\_T}) = \text{NN}(S\_T, z\_{S\_T}) = W S\_T + Q z\_{S\_T},
$$<p>åŒç†ï¼Œ$\tau_{D_T}$ æŒ‰åŒæ ·çš„æ–¹å¼è®¡ç®—ã€‚</p><p>ç„¶å $q(k \mid S_T, D_T, z_{S_T})$ é€šè¿‡ MLP è®¡ç®—ï¼š</p>$$
\tag{25} q(k \mid S\_T, D\_T, z\_{S\_T}) = \text{softmax}(f\_t(\tau\_{S\_T}, \tau\_{D\_T})),
$$<p>$f_5$ å°±æ˜¯ MLPã€‚å‚æ•°è®°ä¸º $\delta = { f_5 (\cdot) }$ã€‚</p><p>å…¬å¼20é‡Œé¢ï¼Œä¸ºäº†è·å¾—æœ€ä¼˜çš„ $k$ï¼Œéœ€è¦è·‘ $k$ æ¬¡ã€‚ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯é€šè¿‡ $q_\gamma (k \mid T)$ ä»è½¨è¿¹ $T$ é‡Œé¢æ‰¾åˆ°æœ€ä¼˜çš„ $k$ã€‚å› æ­¤ $q(k \mid S_T, D_T, z_{S_T})$ å’Œ $q_\gamma (k \mid T)$ è¦å°½å¯èƒ½çš„ç›¸è¿‘ã€‚æˆ‘ä»¬ç”¨äº¤å‰ç†µæœ€å°åŒ–ä¸¤ä¸ªåˆ†å¸ƒçš„å·®åˆ«ï¼š</p>$$
\tag{26} l\_k = - \sum^K\_{k=1} q\_\gamma (k \mid T) \log q(k \mid S\_T, D\_T, z\_{S\_T}),
$$<p>è¿™ä¸ªäº¤å‰ç†µ $l_k$ ä¼šå’Œå…¬å¼ 16 çš„ELBOåŒæ—¶è®­ç»ƒã€‚ç„¶ååœ¨çº¿æ£€æµ‹é˜¶æ®µçš„æ—¶å€™ï¼Œæœ€ä¼˜çš„ $k$ æ˜¯ $q(k \mid S_T, D_T, z_{S_T})$ é‡Œé¢æœ€é«˜æ¦‚ç‡çš„é‚£ä¸ªã€‚ç„¶åç›´æ¥å°±èƒ½æ‹¿åˆ°æœ€ä¼˜ latent time-dependent route $u_k$ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿‘ä¼¼ç®—æ³•çš„è®­ç»ƒè¿‡ç¨‹å’Œç®—æ³•1ä¸ä¸€æ ·ã€‚é¦–å…ˆï¼Œäº¤é€šçŠ¶å†µçš„ä½¿ç”¨ä¸ä¸€æ ·ï¼Œè¿‘ä¼¼ç®—æ³•åªç”¨äº† $Z_{S_T}$ã€‚ç¬¬äºŒï¼Œå…¬å¼26ï¼Œæ˜¯ä¸€ä¸ª co-training è¿‡ç¨‹ï¼Œä¸ºäº†è¿‘ä¼¼ä¸¤ä¸ªåˆ†å¸ƒã€‚è®­ç»ƒåå¾—åˆ°æ¨¡å‹å‚æ•° $\phi, \gamma, \theta, \delta$ã€‚æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹å¦‚ç®—æ³•3æ‰€ç¤ºã€‚å…ˆä» $Z_{S_T}$ é‡Œé¢è·å¾— $z_{S_T}$ã€‚ç„¶åè·å¾—æœ€ä¼˜çš„ latent time-dependent route $u_k$ï¼Œè¿™ä¸ªæ•°åªè¦åœ¨è½¨è¿¹å¼€å§‹çš„æ—¶å€™ç®—ä¸€ä¸‹å°±å¥½äº†ã€‚ç„¶ååŸºäº $p_\theta(\tau_{1:i} \mid u_k)$ æ›´æ–°å¼‚å¸¸åˆ†æ•°å°±å¥½äº†ã€‚</p><h2 id=52-complexity-analysis>5.2 Complexity Analysis</h2><p>åœ¨çº¿æ£€æµ‹çš„å¤æ‚åº¦ $\mathcal{O}(d_{h_t}(d_{h_t} + d_{\tau_i}))$ã€‚è¿™é¡¹æ˜¯æ–°çš„è½¨è¿¹è§‚æµ‹å€¼ $\tau_{i+1}$ åˆ°æ¥çš„æ—¶å€™ RNN çš„å˜æ¢è¿‡ç¨‹çš„å¤æ‚åº¦ã€‚å› ä¸º $d_{h_t}, d_{\tau_i}$ æ˜¯å¸¸æ•°ï¼Œæ‰€ä»¥è¿‘ä¼¼ç®—æ³•çš„å¤æ‚åº¦æ˜¯ $\mathcal{O}(1)$</p></section><footer class=article-footer><section class=article-tags><a href=/blog/tags/deep-learning/>Deep Learning</a>
<a href=/blog/tags/trajectory/>Trajectory</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under Apache License 2.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-article");renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/blog/p/trajdl/><div class=article-image><img src=https://trajdl.readthedocs.io/en/latest/_static/wide-logo.svg loading=lazy data-key data-hash=https://trajdl.readthedocs.io/en/latest/_static/wide-logo.svg></div><div class=article-details><h2 class=article-title>TrajDL</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2020 -
2026 Davidhamçš„åšå®¢</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/blog/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>