<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="ICLR 2018ï¼ŒDCRNNï¼Œæ¨¡å‹å€Ÿé‰´äº†[Structured Sequence Modeling With Graph Convolutional Recurrent Networks (ICLR 2017 reject)](https://davidham3.github.io/blog/2018/07/23/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/)é‡Œé¢çš„DCRNNï¼Œå°†è¯¥æ¨¡å‹åº”ç”¨äºäº†äº¤é€šé¢„æµ‹ä¸Šã€‚è€Œä¸”åè€…çš„è®ºæ–‡ä½¿ç”¨çš„å·ç§¯æ˜¯Defferrardæå‡ºçš„å›¾å·ç§¯ï¼Œè¿™ç¯‡è®ºæ–‡ä¸­ä½¿ç”¨çš„æ˜¯æ‰©æ•£å·ç§¯ï¼Œè¿™ç§æ‰©æ•£å·ç§¯ä½¿ç”¨çš„æ˜¯éšæœºæ¸¸èµ°ï¼Œä¸[Diffusion-Convolutional Neural Networks (NIPS 2016)](https://davidham3.github.io/blog/2018/07/19/diffusion-convolutional-neural-networks/ )çš„æ‰©æ•£å·ç§¯è¿˜ä¸ä¸€æ ·ã€‚æ„é€ å‡ºæ¥çš„DCRNNä½¿ç”¨äº†[Structured Sequence Modeling With Graph Convolutional Recurrent Networks (ICLR 2017 reject)](https://davidham3.github.io/blog/2018/07/23/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/)ä¸¤ç§å½¢å¼ä¸­çš„æ¨¡å‹2ï¼Œå³ä½¿ç”¨æ‰©æ•£å·ç§¯å­¦ä¹ å‡ºç©ºé—´è¡¨ç¤ºåï¼Œæ”¾å…¥GRUä¸­è¿›è¡Œæ—¶é—´ä¸Šçš„å»ºæ¨¡ã€‚åŸæ–‡é“¾æ¥ï¼š[Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting](http://arxiv.org/abs/1707.01926)"><title>Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting</title><link rel=canonical href=https://davidham3.github.io/blog/p/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/><link rel=stylesheet href=/blog/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting"><meta property='og:description' content="ICLR 2018ï¼ŒDCRNNï¼Œæ¨¡å‹å€Ÿé‰´äº†[Structured Sequence Modeling With Graph Convolutional Recurrent Networks (ICLR 2017 reject)](https://davidham3.github.io/blog/2018/07/23/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/)é‡Œé¢çš„DCRNNï¼Œå°†è¯¥æ¨¡å‹åº”ç”¨äºäº†äº¤é€šé¢„æµ‹ä¸Šã€‚è€Œä¸”åè€…çš„è®ºæ–‡ä½¿ç”¨çš„å·ç§¯æ˜¯Defferrardæå‡ºçš„å›¾å·ç§¯ï¼Œè¿™ç¯‡è®ºæ–‡ä¸­ä½¿ç”¨çš„æ˜¯æ‰©æ•£å·ç§¯ï¼Œè¿™ç§æ‰©æ•£å·ç§¯ä½¿ç”¨çš„æ˜¯éšæœºæ¸¸èµ°ï¼Œä¸[Diffusion-Convolutional Neural Networks (NIPS 2016)](https://davidham3.github.io/blog/2018/07/19/diffusion-convolutional-neural-networks/ )çš„æ‰©æ•£å·ç§¯è¿˜ä¸ä¸€æ ·ã€‚æ„é€ å‡ºæ¥çš„DCRNNä½¿ç”¨äº†[Structured Sequence Modeling With Graph Convolutional Recurrent Networks (ICLR 2017 reject)](https://davidham3.github.io/blog/2018/07/23/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/)ä¸¤ç§å½¢å¼ä¸­çš„æ¨¡å‹2ï¼Œå³ä½¿ç”¨æ‰©æ•£å·ç§¯å­¦ä¹ å‡ºç©ºé—´è¡¨ç¤ºåï¼Œæ”¾å…¥GRUä¸­è¿›è¡Œæ—¶é—´ä¸Šçš„å»ºæ¨¡ã€‚åŸæ–‡é“¾æ¥ï¼š[Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting](http://arxiv.org/abs/1707.01926)"><meta property='og:url' content='https://davidham3.github.io/blog/p/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/'><meta property='og:site_name' content='Davidhamçš„åšå®¢'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='deep learning'><meta property='article:tag' content='Graph'><meta property='article:tag' content='graph convolutional network'><meta property='article:published_time' content='2018-07-31T14:37:10+00:00'><meta property='article:modified_time' content='2018-07-31T14:37:10+00:00'><meta name=twitter:title content="Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting"><meta name=twitter:description content="ICLR 2018ï¼ŒDCRNNï¼Œæ¨¡å‹å€Ÿé‰´äº†[Structured Sequence Modeling With Graph Convolutional Recurrent Networks (ICLR 2017 reject)](https://davidham3.github.io/blog/2018/07/23/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/)é‡Œé¢çš„DCRNNï¼Œå°†è¯¥æ¨¡å‹åº”ç”¨äºäº†äº¤é€šé¢„æµ‹ä¸Šã€‚è€Œä¸”åè€…çš„è®ºæ–‡ä½¿ç”¨çš„å·ç§¯æ˜¯Defferrardæå‡ºçš„å›¾å·ç§¯ï¼Œè¿™ç¯‡è®ºæ–‡ä¸­ä½¿ç”¨çš„æ˜¯æ‰©æ•£å·ç§¯ï¼Œè¿™ç§æ‰©æ•£å·ç§¯ä½¿ç”¨çš„æ˜¯éšæœºæ¸¸èµ°ï¼Œä¸[Diffusion-Convolutional Neural Networks (NIPS 2016)](https://davidham3.github.io/blog/2018/07/19/diffusion-convolutional-neural-networks/ )çš„æ‰©æ•£å·ç§¯è¿˜ä¸ä¸€æ ·ã€‚æ„é€ å‡ºæ¥çš„DCRNNä½¿ç”¨äº†[Structured Sequence Modeling With Graph Convolutional Recurrent Networks (ICLR 2017 reject)](https://davidham3.github.io/blog/2018/07/23/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/)ä¸¤ç§å½¢å¼ä¸­çš„æ¨¡å‹2ï¼Œå³ä½¿ç”¨æ‰©æ•£å·ç§¯å­¦ä¹ å‡ºç©ºé—´è¡¨ç¤ºåï¼Œæ”¾å…¥GRUä¸­è¿›è¡Œæ—¶é—´ä¸Šçš„å»ºæ¨¡ã€‚åŸæ–‡é“¾æ¥ï¼š[Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting](http://arxiv.org/abs/1707.01926)"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/blog/><img src=/blog/img/avatar_hu_a95981f1fc190aef.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸš€</span></figure><div class=site-meta><h1 class=site-name><a href=/blog>Davidhamçš„åšå®¢</a></h1><h2 class=site-description>éšä¾¿å†™å†™</h2></div></header><ol class=menu-social><li><a href=https://github.com/Davidham3 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/blog/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/blog/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/blog/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/blog/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#21-traffic-forecasting-problem>2.1 Traffic Forecasting Problem</a></li><li><a href=#22-spatial-dependency-modeling>2.2 Spatial Dependency Modeling</a></li><li><a href=#23-temporal-dynamics-modeling>2.3 Temporal Dynamics Modeling</a></li></ol><ol><li><a href=#41-experimental-settings>4.1 Experimental Settings</a></li><li><a href=#42-traffic-forecasting-performance-comparison>4.2 Traffic Forecasting Performance Comparison</a></li><li><a href=#43-effect-of-spatial-dependency-modeling>4.3 Effect of Spatial Dependency Modeling</a></li><li><a href=#44-effect-of-temporal-dependency-modeling>4.4 Effect of Temporal Dependency Modeling</a></li><li><a href=#45-æ¨¡å‹çš„è§£é‡Šæ€§>4.5 æ¨¡å‹çš„è§£é‡Šæ€§</a></li></ol><ol><li><a href=#b-efficient-calculation-of-equation>B Efficient Calculation Of Equation</a></li><li><a href=#c-relation-with-spectral-graph-convolution>C Relation With Spectral Graph Convolution</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/blog/categories/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/>è®ºæ–‡é˜…è¯»ç¬”è®°</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/blog/p/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/>Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting</a></h2><h3 class=article-subtitle>ICLR 2018ï¼ŒDCRNNï¼Œæ¨¡å‹å€Ÿé‰´äº†[Structured Sequence Modeling With Graph Convolutional Recurrent Networks (ICLR 2017 reject)](https://davidham3.github.io/blog/2018/07/23/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/)é‡Œé¢çš„DCRNNï¼Œå°†è¯¥æ¨¡å‹åº”ç”¨äºäº†äº¤é€šé¢„æµ‹ä¸Šã€‚è€Œä¸”åè€…çš„è®ºæ–‡ä½¿ç”¨çš„å·ç§¯æ˜¯Defferrardæå‡ºçš„å›¾å·ç§¯ï¼Œè¿™ç¯‡è®ºæ–‡ä¸­ä½¿ç”¨çš„æ˜¯æ‰©æ•£å·ç§¯ï¼Œè¿™ç§æ‰©æ•£å·ç§¯ä½¿ç”¨çš„æ˜¯éšæœºæ¸¸èµ°ï¼Œä¸[Diffusion-Convolutional Neural Networks (NIPS 2016)](https://davidham3.github.io/blog/2018/07/19/diffusion-convolutional-neural-networks/ )çš„æ‰©æ•£å·ç§¯è¿˜ä¸ä¸€æ ·ã€‚æ„é€ å‡ºæ¥çš„DCRNNä½¿ç”¨äº†[Structured Sequence Modeling With Graph Convolutional Recurrent Networks (ICLR 2017 reject)](https://davidham3.github.io/blog/2018/07/23/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/)ä¸¤ç§å½¢å¼ä¸­çš„æ¨¡å‹2ï¼Œå³ä½¿ç”¨æ‰©æ•£å·ç§¯å­¦ä¹ å‡ºç©ºé—´è¡¨ç¤ºåï¼Œæ”¾å…¥GRUä¸­è¿›è¡Œæ—¶é—´ä¸Šçš„å»ºæ¨¡ã€‚åŸæ–‡é“¾æ¥ï¼š[Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting](http://arxiv.org/abs/1707.01926)</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jul 31, 2018</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 15 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p>ICLR 2018ï¼ŒDCRNNï¼Œæ¨¡å‹å€Ÿé‰´äº†<a class=link href=https://davidham3.github.io/blog/2018/07/23/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/ target=_blank rel=noopener>Structured Sequence Modeling With Graph Convolutional Recurrent Networks (ICLR 2017 reject)</a>é‡Œé¢çš„DCRNNï¼Œå°†è¯¥æ¨¡å‹åº”ç”¨äºäº†äº¤é€šé¢„æµ‹ä¸Šã€‚è€Œä¸”åè€…çš„è®ºæ–‡ä½¿ç”¨çš„å·ç§¯æ˜¯Defferrardæå‡ºçš„å›¾å·ç§¯ï¼Œè¿™ç¯‡è®ºæ–‡ä¸­ä½¿ç”¨çš„æ˜¯æ‰©æ•£å·ç§¯ï¼Œè¿™ç§æ‰©æ•£å·ç§¯ä½¿ç”¨çš„æ˜¯éšæœºæ¸¸èµ°ï¼Œä¸<a class=link href=https://davidham3.github.io/blog/2018/07/19/diffusion-convolutional-neural-networks/ target=_blank rel=noopener>Diffusion-Convolutional Neural Networks (NIPS 2016)</a>çš„æ‰©æ•£å·ç§¯è¿˜ä¸ä¸€æ ·ã€‚æ„é€ å‡ºæ¥çš„DCRNNä½¿ç”¨äº†<a class=link href=https://davidham3.github.io/blog/2018/07/23/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/ target=_blank rel=noopener>Structured Sequence Modeling With Graph Convolutional Recurrent Networks (ICLR 2017 reject)</a>ä¸¤ç§å½¢å¼ä¸­çš„æ¨¡å‹2ï¼Œå³ä½¿ç”¨æ‰©æ•£å·ç§¯å­¦ä¹ å‡ºç©ºé—´è¡¨ç¤ºåï¼Œæ”¾å…¥GRUä¸­è¿›è¡Œæ—¶é—´ä¸Šçš„å»ºæ¨¡ã€‚åŸæ–‡é“¾æ¥ï¼š<a class=link href=http://arxiv.org/abs/1707.01926 target=_blank rel=noopener>Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting</a></p><h1 id=æ‘˜è¦>æ‘˜è¦</h1><p>äº¤é€šé¢„æµ‹çš„æŒ‘æˆ˜ï¼š1. å¯¹è·¯ç½‘å¤æ‚çš„ç©ºé—´ä¾èµ–å…³ç³»ï¼Œ 2. è·¯å†µå˜æ¢ä¸éçº¿æ€§çš„æ—¶é—´åŠ¨æ€æ€§ï¼Œ 3. é•¿æœŸé¢„æµ‹çš„å›°éš¾æ€§ã€‚æˆ‘ä»¬æå‡ºäº†åœ¨æœ‰å‘å›¾ä¸Šå¯¹äº¤é€šæµä»¥æ‰©æ•£å½¢å¼è¿›è¡Œå»ºæ¨¡çš„æ–¹æ³•ï¼Œä»‹ç»äº† <em>Diffusion Convolutional Recurrent Neural Network</em> (DCRNN)ï¼Œç”¨äºäº¤é€šé¢„æµ‹çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ŒåŒæ—¶é›†æˆäº†äº¤é€šæµä¸­çš„ç©ºé—´ä¸æ—¶é—´ä¾èµ–ã€‚DCRNN ä½¿ç”¨å›¾ä¸Šçš„åŒå‘éšæœºæ¸¸èµ°æ•è·äº†ç©ºé—´ä¾èµ–ï¼Œä½¿ç”¨ç¼–ç è§£ç æ¡†æ¶ä»¥åŠ scheduled sampling æ•è·æ—¶é—´ä¾èµ–ã€‚æˆ‘ä»¬åœ¨ä¸¤ä¸ªçœŸå®çš„äº¤é€šæ•°æ®é›†ä¸Šè¯„ä¼°äº†æ¨¡å‹ï¼Œæ¯” state-of-the-art å¼ºäº†12%-15%ã€‚</p><h1 id=1-å¼•è¨€>1 å¼•è¨€</h1><p>å¯¹ä¸€ä¸ªåœ¨åŠ¨æ€ç³»ç»Ÿä¸­è¿è¡Œçš„å­¦ä¹ ç³»ç»Ÿæ¥è¯´ï¼Œæ—¶ç©ºé¢„æµ‹æ˜¯ä¸€ä¸ªå¾ˆå…³é”®çš„ä»»åŠ¡ã€‚è‡ªåŠ¨é©¾é©¶ã€ç”µç½‘ä¼˜åŒ–ã€ä¾›åº”é“¾ç®¡ç†ç­‰éƒ½æ˜¯å®ƒçš„åº”ç”¨ã€‚æˆ‘ä»¬ç ”ç©¶äº†ä¸€ä¸ªé‡è¦çš„ä»»åŠ¡ï¼šè·¯ç½‘ä¸Šçš„äº¤é€šé¢„æµ‹ï¼Œè¿™æ˜¯æ™ºèƒ½äº¤é€šç³»ç»Ÿä¸­çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚ç›®æ ‡æ˜¯ç»™å®šå†å²è½¦é€Ÿä¸è·¯ç½‘æ•°æ®ï¼Œé¢„æµ‹æœªæ¥çš„è½¦é€Ÿã€‚</p><p>ä»»åŠ¡æœ‰æŒ‘æˆ˜æ€§çš„åŸå› æ˜¯å¤æ‚çš„æ—¶ç©ºä¾èµ–å…³ç³»ä»¥åŠé•¿æœŸé¢„æµ‹çš„ä¸Šçš„éš¾åº¦ã€‚ä¸€æ–¹é¢ï¼Œäº¤é€šæ•°æ®åºåˆ—è¡¨ç°å‡ºäº†å¼ºçƒˆçš„æ—¶é—´åŠ¨æ€æ€§(temporal dynamics)ã€‚åå¤çš„äº‹ä»¶å¦‚é«˜å³°æœŸæˆ–äº¤é€šäº‹æ•…å¯¼è‡´äº†æ•°æ®çš„éå¹³ç¨³æ€§ï¼Œä½¿å¾—é•¿æœŸé¢„æµ‹å¾ˆå›°éš¾ã€‚å¦ä¸€æ–¹é¢ï¼Œè·¯ç½‘ä¸Šçš„ç›‘æµ‹å™¨åŒ…å«äº†å¤æ‚ä½†æ˜¯å”¯ä¸€çš„ç©ºé—´è”ç³»(spatial correlations)ã€‚å›¾1å±•ç¤ºäº†ä¸€ä¸ªä¾‹å­ã€‚è·¯1å’Œè·¯2æ˜¯ç›¸å…³è”çš„ï¼Œä½†æ˜¯è·¯1å’Œè·¯3æ²¡æœ‰å…³è”ã€‚å°½ç®¡è·¯1å’Œè·¯3åœ¨æ¬§æ°ç©ºé—´ä¸­å¾ˆè¿‘ï¼Œä½†æ˜¯ä»–ä»¬è¡¨ç°å‡ºäº†ä¸åŒçš„å½¢å¼ã€‚æ­¤å¤–ï¼Œæœªæ¥çš„è½¦é€Ÿæ›´å®¹æ˜“å—åˆ°ä¸‹æ¸¸äº¤é€šçš„å½±å“ï¼Œè€Œéä¸Šæ¸¸ã€‚è¿™å°±æ„å‘³ç€äº¤é€šä¸Šçš„ç©ºé—´ç»“æ„ä¸æ˜¯æ¬§æ°ç©ºé—´çš„ï¼Œè€Œæ˜¯æœ‰å‘çš„ã€‚</p><div align=center>![Figure1](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig1.JPG)<p>äº¤é€šé¢„æµ‹å·²ç»ç ”ç©¶äº†å‡ åå¹´ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦ç±»åˆ«ï¼šçŸ¥è¯†é©±åŠ¨çš„æ–¹æ³•å’Œæ•°æ®é©±åŠ¨çš„æ–¹æ³•ã€‚åœ¨è¿è¾“å’Œæ“ä½œç ”ç©¶ä¸­ï¼ŒçŸ¥è¯†é©±åŠ¨çš„æ–¹æ³•ç»å¸¸ä½¿ç”¨æ’é˜Ÿè®ºï¼Œæ¨¡æ‹Ÿäº¤é€šä¸­çš„ç”¨æˆ·è¡Œä¸º(Cascetta, 2013)ã€‚æ—¶é—´åºåˆ—ç¤¾åŒºä¸­ï¼Œæ•°æ®é©±åŠ¨çš„æ–¹æ³•å¦‚ Auto-Regressive Integrated Moving Average(ARIMA) æ¨¡å‹ï¼ŒKalman filtering è¿˜æ˜¯å¾ˆæµè¡Œçš„(Liu et al., 2011; Lippi et al., 2013)ã€‚ç„¶è€Œï¼Œç®€å•çš„æ—¶é—´åºåˆ—æ¨¡å‹é€šå¸¸ä¾èµ–å¹³ç¨³å‡è®¾ï¼Œè¿™ç»å¸¸ä¸å®é™…äº¤é€šæ•°æ®ä¸ç¬¦ã€‚æœ€è¿‘å¼€å§‹åœ¨äº¤é€šé¢„æµ‹ä¸Šåº”ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹ (Lv et al., 2015; Yu et al., 2017b) ï¼Œä½†æ˜¯æ²¡æœ‰è€ƒè™‘ç©ºé—´ç»“æ„ã€‚Wu & Tan 2016å’ŒMa et al. 2017 ä½¿ç”¨ CNN å¯¹ç©ºé—´å…³ç³»è¿›è¡Œå»ºæ¨¡ï¼Œä½†æ˜¯åœ¨æ¬§æ°ç©ºé—´ä¸­çš„ã€‚Bruna et al. 2014ï¼ŒDefferrard et al. 2016 ç ”ç©¶äº†å›¾å·ç§¯ï¼Œä½†æ˜¯åªèƒ½å¤„ç†æ— å‘å›¾ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæœ‰å‘å›¾æ¥è¡¨ç¤º pair-wise spatial correlationsã€‚å›¾çš„é¡¶ç‚¹æ˜¯sensorsï¼Œè¾¹æ˜¯æƒé‡ï¼Œé€šè¿‡è·¯ç½‘ä¸Š sensor ä¹‹é—´çš„è·ç¦»å¾—åˆ°ã€‚æˆ‘ä»¬ä½¿ç”¨æ‰©æ•£å·ç§¯ (diffusion convolution) æ“ä½œæ¥æ•è·ç©ºé—´ä¾èµ–å…³ç³»ï¼Œä»¥æ‰©æ•£æ€§æ˜¯å¯¹äº¤é€šæµçš„åŠ¨æ€æ€§å»ºæ¨¡ã€‚æå‡ºäº† <em>Diffusion Convolutional Recurrent Neural Network</em> (DCRNN)ï¼Œæ•´åˆäº† <em>diffusion convolution</em> å’Œ <em>sequence to sequence</em> æ¶æ„ä»¥åŠ <em>scheduled sampling</em> æŠ€æœ¯ã€‚åœ¨çœŸå®æ•°æ®é›†ä¸Šè¡¡é‡æ¨¡å‹æ—¶ï¼ŒDCRNN æ¯”state-of-the-artå¥½å¾ˆå¤šã€‚
Â· æˆ‘ä»¬ç ”ç©¶äº†äº¤é€šé¢„æµ‹é—®é¢˜ï¼Œåœ¨æœ‰å‘å›¾ä¸Šå¯¹äº¤é€šçš„ç©ºé—´ä¾èµ–ä»¥æ‰©æ•£å½¢å¼å»ºæ¨¡ã€‚æå‡ºäº† <em>diffusion convolution</em>ï¼Œæœ‰ç€ç›´è§‚çš„è§£é‡Šä»¥åŠé«˜æ•ˆçš„è®¡ç®—ã€‚
Â· æˆ‘ä»¬æå‡ºäº† <em>Diffusion Convolutional Recurrent Neural Network</em> (DCRNN)ï¼Œä½¿ç”¨ <em>diffusion convolution</em>ï¼Œ<em>sequence to sequence</em>ï¼Œ<em>scheduled sampling</em> åŒæ—¶å¯¹æ—¶é—´å’Œç©ºé—´ä¾èµ–å…³ç³»è¿›è¡Œæ•è·çš„æ–¹æ³•ã€‚DCRNN ä¸é™äºè¿è¾“é¢†åŸŸï¼Œå¯ä»¥åº”ç”¨åˆ°å…¶ä»–çš„æ—¶ç©ºé¢„æµ‹é—®é¢˜ä¸Šã€‚
Â· åšäº†å¾ˆå¤šå®éªŒï¼Œæ•ˆæœå¾ˆå¥½ã€‚</p><h1 id=2-methodology>2 Methodology</h1><h2 id=21-traffic-forecasting-problem>2.1 Traffic Forecasting Problem</h2><p>$N$ ä¸ªsensorsã€‚æ£€æµ‹å™¨ç½‘ç»œè¡¨ç¤ºæˆå¸¦æƒæœ‰å‘å›¾ $\mathcal{G} = (\mathcal{V}, \mathcal{E}, \boldsymbol{W})$ï¼Œ$\mathcal{V}$ æ˜¯é¡¶ç‚¹é›†ï¼Œ$\vert \mathcal{V} \vert = N$ï¼Œ$\mathcal{E}$ æ˜¯è¾¹é›†ï¼Œ$\boldsymbol{W} \in \mathbb{R}^{N \times N}$ æ˜¯å¸¦æƒé‚»æ¥çŸ©é˜µï¼Œè¡¨ç¤ºé¡¶ç‚¹ç›¸ä¼¼æ€§ï¼ˆå¦‚è·¯ç½‘è·ç¦»çš„ä¸€ä¸ªå‡½æ•°ï¼‰ã€‚å›¾ä¿¡å·çŸ©é˜µ$\boldsymbol{X} \in \mathbb{R}^{N \times P}$ï¼Œ$P$ æ˜¯æ¯ä¸ªé¡¶ç‚¹çš„ç‰¹å¾æ•°ã€‚$\boldsymbol{X}^{(t)}$ è¡¨ç¤ºæ—¶é—´ $t$ è§‚æµ‹åˆ°çš„å›¾ä¿¡å·ï¼Œäº¤é€šé¢„æµ‹é—®é¢˜ç›®çš„æ˜¯å­¦ä¹ ä¸€ä¸ªå‡½æ•° $h(\cdot)$ï¼Œå°† $T&rsquo;$ ä¸ªå†å²çš„å›¾ä¿¡å·æ˜ å°„åˆ°æœªæ¥çš„ $T$ ä¸ªå›¾ä¿¡å·ä¸Šï¼Œç»™å®šå›¾ $\mathcal{G}$:</p>$$[\boldsymbol{X}^{(t-T'+1)}, ..., \boldsymbol{X}^{(t)}; \mathcal{G}] \xrightarrow{h(\cdot)} [\boldsymbol{X}^{(t+1)}, ..., \boldsymbol{X}^{(t+T)}]$$<h2 id=22-spatial-dependency-modeling>2.2 Spatial Dependency Modeling</h2><p>æ‰©æ•£å½¢å¼ä»¥ $\mathcal{G}$ ä¸Šçš„éšæœºæ¸¸èµ°æ¥åˆ»ç”»ï¼Œé‡å¯æ¦‚ç‡ $\alpha \in [0, 1]$ï¼ŒçŠ¶æ€è½¬ç§»çŸ©é˜µ $\boldsymbol{D}^{-1}_O \boldsymbol{W}$ã€‚è¿™é‡Œï¼Œ$\boldsymbol{D}_{\boldsymbol{O}} = \mathrm{diag}(\boldsymbol{W1})$ æ˜¯å‡ºåº¦çš„å¯¹è§’çŸ©é˜µï¼Œ$\mathbf{1} \in \mathbb{R}^N$ è¡¨ç¤ºæ‰€æœ‰éƒ½ä¸º1çš„å‘é‡ã€‚å¤šä¸ªæ—¶é—´æ­¥ä¹‹åï¼ŒMarkov process ä¼šæ”¶æ•›åˆ°å¹³ç¨³åˆ†å¸ƒ $\mathcal{P} \in \mathbb{R}^{N \times N}$ä¸Šï¼Œç¬¬ $i$ è¡Œ $\mathcal{P}_{i,:} \in \mathbb{R}^N$ è¡¨ç¤ºä»é¡¶ç‚¹ $v_i \in \mathcal{V}$ æ‰©æ•£çš„å¯èƒ½æ€§ï¼Œä¹Ÿå°±æ˜¯å¯¹é¡¶ç‚¹ $v_i$ çš„ proximityã€‚ä¸‹é¢çš„å¼•ç†æ˜¯å¹³ç¨³åˆ†å¸ƒçš„é—­å¼è§£ã€‚</p><p><strong>Lemma 2.1</strong> (Teng et al., 2016) æ‰©æ•£è¿‡ç¨‹çš„å¹³ç¨³åˆ†å¸ƒå¯ä»¥è¡¨ç¤ºä¸ºå›¾ä¸Šçš„æ— é™éšæœºæ¸¸èµ°çš„å¸¦æƒç»„åˆï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å¼å­è®¡ç®—ï¼š</p>$$\tag{1}
\mathcal{P} = \sum^\infty\_{k=0} \alpha(1 - \alpha)^k (\boldsymbol{D}^{-1}\_O \boldsymbol{W})^k
$$<p>å…¶ä¸­ $k$ æ˜¯diffusion stepã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨æœ‰é™çš„ $K$ é˜¶æ‰©æ•£è¿‡ç¨‹ï¼Œç»™æ¯ä¸€æ­¥åˆ†é…ä¸€ä¸ªå¯è®­ç»ƒçš„æƒé‡ã€‚æˆ‘ä»¬ä¹Ÿèå…¥åå‘æ‰©æ•£è¿‡ç¨‹ï¼Œå› ä¸ºåŒå‘æ‰©æ•£å¯ä»¥è®©æ¨¡å‹æ›´çµæ´»åœ°å»æ•è·ä¸Šæ¸¸å’Œä¸‹æ¸¸äº¤é€šå¸¦æ¥çš„å½±å“ã€‚</p><p><strong>Diffusion Convolution</strong> å›¾ä¿¡å· $\boldsymbol{X} \in \mathbb{R}^{N \times P}$ å’Œæ»¤æ³¢å™¨ $f_\theta$ çš„æ‰©æ•£å·ç§¯æ“ä½œçš„ç»“æœæ˜¯ï¼š</p>$$\tag{2}
\boldsymbol{X}\_{:,p} \star\_{\mathcal{G}} f\_\theta = \sum^{K-1}\_{k=0} (\theta\_{k,1} (\boldsymbol{D}^{-1}\_O \boldsymbol{W})^k + \theta\_{k,2}(\boldsymbol{D}^{-1}\_I \boldsymbol{W}^T)^k) \boldsymbol{X}\_{:,p} \ \ \ \ \mathrm{for} \ \ p \in \lbrace 1, ..., P \rbrace
$$<p>å…¶ä¸­ $\theta \in \mathbb{R}^{K \times 2}$ è¡¨ç¤ºå·ç§¯æ ¸å‚æ•°ï¼Œ$\boldsymbol{D}^{-1}_O \boldsymbol{W}$ å’Œ $\boldsymbol{D}^{-1}_I \boldsymbol{W}^T$ è¡¨ç¤ºæ‰©æ•£è¿‡ç¨‹å’Œåå‘æ‰©æ•£çš„è½¬ç§»æ¦‚ç‡çŸ©é˜µã€‚ä¸€èˆ¬ï¼Œè®¡ç®—å·ç§¯æ˜¯å¾ˆè€—æ—¶çš„ã€‚ç„¶è€Œï¼Œå¦‚æœ $\mathcal{G}$ æ˜¯ç¨€ç–çš„ï¼Œå¼2å¯ä»¥é€šè¿‡é€’å½’çš„å¤æ‚åº¦ä¸º $O(K)$ çš„sparse-denseçŸ©é˜µä¹˜æ³•é«˜æ•ˆçš„è®¡ç®—ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ä¸º $O(K \vert \mathcal{E} \vert) \ll O(N^2)$ã€‚é™„å½•Bæœ‰è¯¦ç»†çš„æè¿°ã€‚</p><p><strong>Diffusion Convolutional Layer</strong> å¼2å®šä¹‰çš„å·ç§¯æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªæ‰©æ•£å·ç§¯å±‚ï¼Œå°† $P$ ç»´ç‰¹å¾æ˜ å°„åˆ° $Q$ ç»´è¾“å‡ºä¸Šã€‚å°†å‚æ•°è¡¨ç¤ºä¸º $\mathbf{\Theta} \in \mathbb{R}^{Q \times P \times K \times 2} = [ \boldsymbol{\theta} ]_{q, p}$ï¼Œå…¶ä¸­ $\mathbf{\Theta}_{q,p,:,:} \in \mathbb{R}^{K \times 2}$ æ˜¯ç¬¬ $p$ ä¸ªè¾“å…¥å’Œ $q$ ä¸ªè¾“å‡ºçš„å‚æ•°ã€‚æ‰©æ•£å·ç§¯å±‚ä¸ºï¼š</p>$$\tag{3}
\boldsymbol{H}\_{:,q} = \boldsymbol{a}(\sum^P\_{p=1} \boldsymbol{X}\_{:,p} \star\_{\mathcal{G}} f\_{\mathbf{\Theta}\_{q,p,:,:}}) \ \ \ \ \mathrm{for} \ q \in \lbrace 1, ..., Q \rbrace
$$<p>å…¶ä¸­ï¼Œ$\boldsymbol{X} \in \mathbb{R}^{N \times P}$ æ˜¯è¾“å…¥ï¼Œ$\boldsymbol{H} \in \mathbb{R}^{N \times Q}$ æ˜¯è¾“å‡ºï¼Œ$\lbrace f_{\mathbf{\Theta}_{q,p,:,:}} \rbrace $ æ˜¯æ»¤æ³¢å™¨ï¼Œ$a$ æ˜¯æ¿€æ´»å‡½æ•°ã€‚æ‰©æ•£å·ç§¯å±‚å­¦ä¹ å›¾ç»“æ„æ•°æ®çš„è¡¨ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŸºäºéšæœºæ¢¯åº¦çš„æ–¹æ³•è®­ç»ƒå®ƒã€‚</p><p><strong>Relation with Spectral Graph Convolution:</strong> æ‰©æ•£å·ç§¯æ˜¯å®šä¹‰åœ¨æœ‰å‘å’Œæ— å‘å›¾ä¸Šçš„ã€‚å½“ä½¿ç”¨åœ¨æ— å‘å›¾ä¸Šæ—¶ï¼Œæˆ‘ä»¬å‘ç°å¾ˆå¤šç°å­˜çš„å›¾ç»“æ„å·ç§¯æ“ä½œï¼ŒåŒ…æ‹¬æµè¡Œçš„æ™®å›¾å·ç§¯ï¼ŒChebNetï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ‰©æ•£å·ç§¯çš„ç‰¹ä¾‹ã€‚ä»¤ $\boldsymbol{D}$ è¡¨ç¤ºåº¦çŸ©é˜µï¼Œ$\boldsymbol{L} = \boldsymbol{D}^{-\frac{1}{2}}(\boldsymbol{D} - \boldsymbol{W}) \boldsymbol{D}^{-\frac{1}{2}}$ æ˜¯å›¾å½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼Œæ¥ä¸‹æ¥çš„Propositionè§£é‡Šäº†è¿æ¥ã€‚</p><p><strong>Proposition 2.2.</strong> è°±å›¾å·ç§¯çš„å®šä¹‰ï¼š</p>$$
\boldsymbol{X}\_{:,p} \star\_{\mathcal{G}} f\_\boldsymbol{\theta} = \Phi F(\boldsymbol{\theta}) \Phi^T \boldsymbol{X}\_{:,p}
$$<p>ç‰¹å¾å€¼åˆ†è§£ $\boldsymbol{L} = \Phi \Lambda \Phi^T$ï¼Œå½“å›¾ $\mathcal{G}$æ˜¯æ— å‘å›¾æ—¶ï¼Œ$F(\boldsymbol{\theta}) = \sum^{K-1}_0 \theta_k \Lambda^k$ï¼Œç­‰ä»·äºå›¾çš„æ‰©æ•£å·ç§¯ã€‚
è¯æ˜è§åè®°Cã€‚</p><h2 id=23-temporal-dynamics-modeling>2.3 Temporal Dynamics Modeling</h2><p>æˆ‘ä»¬åˆ©ç”¨ RNN å¯¹æ—¶é—´ä¾èµ–å»ºæ¨¡ã€‚æˆ‘ä»¬ä½¿ç”¨ GRUï¼Œç®€å•æœ‰æ•ˆçš„ RNN å˜ä½“ã€‚æˆ‘ä»¬å°† GRU ä¸­çš„çŸ©é˜µä¹˜æ³•æ¢æˆäº†æ‰©æ•£å·ç§¯ï¼Œå¾—åˆ°äº†æˆ‘ä»¬çš„æ‰©æ•£å·ç§¯é—¨æ§å¾ªç¯å•å…ƒ <em>Diffusion Convolutional Gated Recurrent Unit(DCGRU)</em>.</p>$$
\boldsymbol{r}^{(t)} = \sigma(\mathbf{\Theta}\_r \star\_\mathcal{G} [\boldsymbol{X}^{(t)}, \boldsymbol{H}^{(t-1)}] + \boldsymbol{b}\_r) \\
\boldsymbol{u}^{(t)} = \sigma( \mathbf{\Theta}\_u \star\_\mathcal{G} [\boldsymbol{X}, \boldsymbol{H}^{(t-1)}] + \boldsymbol{b}\_u) \\
\boldsymbol{C}^{(t)} = \mathrm{tanh}(\mathbf{\Theta}\_C \star\_\mathcal{G} [\boldsymbol{X}^{(t)}, (\boldsymbol{r}^{(t)} \odot \boldsymbol{H}^{(t-1)})] + \boldsymbol{b}\_c) \\
\boldsymbol{H}^{(t)} = \boldsymbol{u}^{(t)} \odot \boldsymbol{H}^{(t-1)} + (1 - \boldsymbol{u}^{(t)}) \odot \boldsymbol{C}^{(t)}
$$<p>å…¶ä¸­ $\boldsymbol{X}^{(t)}, \boldsymbol{H}^{(t)}$ è¡¨ç¤ºæ—¶é—´ $t$ çš„è¾“å…¥å’Œè¾“å‡ºï¼Œ$\boldsymbol{r}^{(t)}, \boldsymbol{u}^{(t)}$ è¡¨ç¤ºæ—¶é—´ $t$ çš„reset gateå’Œ update gateã€‚$\star_\mathcal{G}$ è¡¨ç¤ºå¼2ä¸­å®šä¹‰çš„æ··åˆå·ç§¯ï¼Œ$\mathbf{\Theta}_r, \mathbf{\Theta}_u, \mathbf{\Theta}_C$ è¡¨ç¤ºå¯¹åº”çš„æ»¤æ³¢å™¨çš„å‚æ•°ã€‚ç±»ä¼¼ GRUï¼ŒDCGRU å¯ä»¥ç”¨æ¥æ„å»ºå¾ªç¯ç¥ç»ç½‘ç»œå±‚ï¼Œä½¿ç”¨ BPTT è®­ç»ƒã€‚</p><div align=center>![Figure2](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig2.JPG)<p>åœ¨å¤šæ­¥é¢„æµ‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <em>Sequence to Sequence</em> æ¶æ„ã€‚ç¼–ç è§£ç å™¨éƒ½æ˜¯ DCGRUã€‚è®­ç»ƒæ—¶ï¼Œæˆ‘ä»¬æŠŠå†å²çš„æ—¶é—´åºåˆ—æ”¾åˆ°ç¼–ç å™¨ï¼Œä½¿ç”¨æœ€ç»ˆçŠ¶æ€åˆå§‹åŒ–è§£ç å™¨ã€‚è§£ç å™¨ç”Ÿæˆé¢„æµ‹ç»“æœã€‚æµ‹è¯•æ—¶ï¼Œground truth æ›¿æ¢æˆæ¨¡å‹æœ¬èº«ç”Ÿæˆçš„é¢„æµ‹ç»“æœã€‚è®­ç»ƒå’Œæµ‹è¯•è¾“å…¥çš„åˆ†å¸ƒçš„å·®å¼‚ä¼šå¯¼è‡´æ€§èƒ½çš„ä¸‹é™ã€‚ä¸ºäº†å‡è½»è¿™ä¸ªé—®é¢˜çš„å½±å“ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <em>scheduled sampling</em> (Bengio et al., 2015)ï¼Œåœ¨è®­ç»ƒçš„ç¬¬ $i$ è½®æ—¶ï¼Œæ¨¡å‹çš„è¾“å…¥è¦ä¹ˆæ˜¯æ¦‚ç‡ä¸º $\epsilon_i$ çš„ ground truthï¼Œè¦ä¹ˆæ˜¯æ¦‚ç‡ä¸º $1 - \epsilon_i$ çš„é¢„æµ‹ç»“æœã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œ$\epsilon_i$ é€æ¸çš„å‡å°ä¸º0ï¼Œä½¿å¾—æ¨¡å‹å¯ä»¥å­¦ä¹ åˆ°æµ‹è¯•é›†çš„åˆ†å¸ƒã€‚</p><p>å›¾2å±•ç¤ºäº† DCRNN çš„æ¶æ„ã€‚æ•´ä¸ªç½‘ç»œé€šè¿‡ BPTT å¾ªç¯ç”Ÿæˆç›®æ ‡æ—¶é—´åºåˆ—çš„æœ€å¤§ä¼¼ç„¶å¾—åˆ°ã€‚DCRNN å¯ä»¥æ•è·æ—¶ç©ºä¾èµ–å…³ç³»ï¼Œåº”ç”¨åˆ°å¤šç§æ—¶ç©ºé¢„æµ‹é—®é¢˜ä¸Šã€‚</p><h1 id=3-related-work>3 Related Work</h1><p>è¿è¾“é¢†åŸŸå’Œè¿ç­¹å­¦ä¸­äº¤é€šé¢„æµ‹æ˜¯ä¼ ç»Ÿé—®é¢˜ï¼Œä¸»è¦ä¾èµ–äºæ’é˜Ÿè®ºå’Œä»¿çœŸ(Drew, 1968)ã€‚æ•°æ®é©±åŠ¨çš„äº¤é€šé¢„æµ‹æ–¹æ³•æœ€è¿‘å—åˆ°äº†å¾ˆå¤šçš„å…³æ³¨ï¼Œè¯¦æƒ…å¯ä»¥çœ‹è¿‘äº›å¹´çš„ paper (Vlahogianni et al., 2014)ã€‚ç„¶è€Œï¼Œç°å­˜çš„æœºå™¨å­¦ä¹ æ¨¡å‹è¦ä¹ˆæœ‰ç€å¾ˆå¼ºçš„å‡è®¾ï¼ˆå¦‚ auto-regressive model ï¼‰è¦ä¹ˆä¸èƒ½è€ƒè™‘éçº¿æ€§çš„æ—¶é—´ä¾èµ–ï¼ˆå¦‚ latent space model Yu et al. 2016; Deng et al. 2016ï¼‰ã€‚æ·±åº¦å­¦ä¹ æ¨¡å‹ä¸ºè§£å†³æ—¶é—´åºåˆ—é¢„æµ‹é—®é¢˜æä¾›äº†æ–°çš„æ–¹æ³•ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ Yu et al. 2017b; Laptev et al. 2017 çš„å·¥ä½œä¸­ï¼Œä½œè€…ä½¿ç”¨æ·±åº¦å¾ªç¯ç¥ç»ç½‘ç»œç ”ç©¶æ—¶é—´åºåˆ—é¢„æµ‹é—®é¢˜ã€‚å·ç§¯ç¥ç»ç½‘ç»œå·²ç»è¢«åº”ç”¨åˆ°äº¤é€šé¢„æµ‹ä¸Šã€‚Zhang et al. 2016; 2017 å°†è·¯ç½‘è½¬æ¢æˆäº† 2D ç½‘æ ¼ï¼Œä½¿ç”¨ä¼ ç»Ÿçš„ CNN é¢„æµ‹äººæµã€‚Cheng et al. 2017 æå‡ºäº†DeepTransportï¼Œé€šè¿‡å¯¹æ¯æ¡è·¯æ”¶é›†ä¸Šä¸‹æ¸¸é‚»å±…è·¯æ®µå¯¹ç©ºé—´ä¾èµ–å»ºæ¨¡ï¼Œåœ¨è¿™äº›é‚»å±…ä¸Šåˆ†åˆ«ä½¿ç”¨å·ç§¯æ“ä½œã€‚</p><p>æœ€è¿‘ï¼ŒCNN åŸºäºè°±å›¾ç†è®ºå·²ç»æ³›åŒ–åˆ°ä»»æ„çš„å›¾ç»“æ„ä¸Šã€‚å›¾å·ç§¯ç¥ç»ç½‘ç»œç”± Bruna et al. 2014 é¦–æ¬¡æå‡ºï¼Œåœ¨æ·±åº¦ç¥ç»ç½‘ç»œå’Œè°±å›¾ç†è®ºä¹‹é—´å»ºç«‹äº†æ¡¥æ¢ã€‚Defferrard et al. 2016 æå‡ºäº† ChebNetï¼Œä½¿ç”¨å¿«é€Ÿå±€éƒ¨å·ç§¯æ»¤æ³¢å™¨æå‡äº† GCNã€‚Kipf & Welling 2017 ç®€åŒ–äº† ChebNetï¼Œåœ¨åŠç›‘ç£åˆ†ç±»ä»»åŠ¡ä¸Šè·å¾—äº† state-of-the-art çš„è¡¨ç°ã€‚Seo et al. 2016 èåˆäº† ChebNet å’Œ RNN ç”¨äºç»“æ„åºåˆ—å»ºæ¨¡ã€‚Yu et al. 2017a å¯¹æ£€æµ‹å™¨ç½‘ç»œä»¥æ— å‘å›¾çš„å½¢å¼ï¼Œä½¿ç”¨ Chebnet å’Œå·ç§¯åºåˆ—æ¨¡å‹ (Gehring et al. 2017) è¿›è¡Œå»ºæ¨¡åšé¢„æµ‹ã€‚è¿™äº›æåŠçš„åŸºäºè°±çš„ç†è®ºçš„é™åˆ¶ä¹‹ä¸€æ˜¯ï¼Œä»–ä»¬éœ€è¦å›¾æ˜¯æ— å‘çš„ï¼Œæ¥è®¡ç®—æœ‰æ„ä¹‰çš„è°±åˆ†è§£ã€‚ä»è°±åŸŸåˆ°é¡¶ç‚¹åŸŸï¼ŒAtwood & Towsley 2016 æå‡ºäº†æ‰©æ•£å·ç§¯ç¥ç»ç½‘ç»œ (DCNN)ï¼Œä»¥å›¾ç»“æ„ä¸­æ¯ä¸ªé¡¶ç‚¹çš„æ‰©æ•£è¿‡ç¨‹å®šä¹‰äº†å·ç§¯ã€‚Hechtlinger et al. 2017 æå‡ºäº† GraphCNN å¯¹æ¯ä¸ªé¡¶ç‚¹çš„ $p$ ä¸ªæœ€è¿‘é‚»é‚»å±…è¿›è¡Œå·ç§¯ï¼Œå°†å·ç§¯æ³›åŒ–åˆ°å›¾ä¸Šã€‚ç„¶è€Œï¼Œè¿™äº›æ–¹æ³•æ²¡æœ‰è€ƒè™‘æ—¶é—´çš„åŠ¨æ€æ€§ï¼Œä¸»è¦å¤„ç†çš„æ˜¯é™æ€å›¾ã€‚</p><p>æˆ‘ä»¬çš„æ–¹æ³•ä¸åŒäºè¿™äº›æ–¹æ³•ï¼Œå› ä¸ºé—®é¢˜çš„è®¾å®šä¸ä¸€æ ·ï¼Œè€Œä¸”å›¾å·ç§¯çš„å…¬å¼ä¸åŒã€‚æˆ‘ä»¬å°† sensor network å»ºç«‹æˆä¸€ä¸ªå¸¦æƒæœ‰å‘å›¾ï¼Œæ¯”ç½‘æ ¼å’Œæ— å‘å›¾æ›´çœŸå®ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æå‡ºçš„å·ç§¯æ“ä½œä½¿ç”¨åŒå‘å›¾éšæœºæ¸¸èµ°æ¥å®šä¹‰ï¼Œé›†æˆäº†åºåˆ—åˆ°åºåˆ—æ¨¡å‹ä»¥åŠ scheduled sampling ï¼Œå¯¹é•¿æ—¶é—´çš„æ—¶é—´ä¾èµ–å»ºæ¨¡ã€‚</p><h1 id=4-experiments>4 Experiments</h1><p>æˆ‘ä»¬åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šåšäº†å®éªŒï¼šï¼ˆ1ï¼‰<strong>METR-LA</strong> è¿™ä¸ªäº¤é€šæ•°æ®é›†åŒ…å«äº†æ´›æ‰çŸ¶é«˜é€Ÿå…¬è·¯çº¿åœˆæ”¶é›†çš„æ•°æ® (Jagadish et al., 2014)ã€‚æˆ‘ä»¬é€‰æ‹©äº†207ä¸ªæ£€æµ‹å™¨ï¼Œæ”¶é›†äº†ä»2012å¹´3æœˆ1æ—¥åˆ°2012å¹´6æœˆ30æ—¥4ä¸ªæœˆçš„æ•°æ®ç”¨äºå®éªŒã€‚ï¼ˆ2ï¼‰<strong>PEMS_BAY</strong> è¿™ä¸ªäº¤é€šæ•°æ®é›†ç”± California Transportation Agencies(CalTrans)Performance Measurement System (PeMS) æ”¶é›†ã€‚æˆ‘ä»¬é€‰äº† Bay Area çš„325ä¸ªæ£€æµ‹å™¨ï¼Œæ”¶é›†äº†ä»2017å¹´1æœˆ1æ—¥åˆ°2017å¹´5æœˆ31æ—¥6ä¸ªæœˆçš„æ•°æ®ç”¨äºå®éªŒã€‚ä¸¤ä¸ªæ•°æ®é›†ç›‘æµ‹å™¨çš„åˆ†å¸ƒå¦‚å›¾8æ‰€ç¤ºã€‚</p><p>è¿™ä¸¤ä¸ªæ•°æ®é›†ï¼Œæˆ‘ä»¬å°†è½¦é€Ÿèšåˆåˆ°äº†5åˆ†é’Ÿçš„çª—å£å†…ï¼Œä½¿ç”¨äº† Z-Score normalizationã€‚70%çš„æ•°ç”¨äºè®­ç»ƒï¼Œ20%ç”¨äºæµ‹è¯•ï¼Œ10%ç”¨äºéªŒè¯ã€‚ä¸ºäº†æ„å»ºæ£€æµ‹å™¨ç½‘ç»œï¼Œæˆ‘ä»¬è®¡ç®—äº†ä»»æ„ä¸¤ä¸ª sensor çš„è·ç¦»ï¼Œä½¿ç”¨äº† thresholded Gaussian kernel æ¥æ„å»ºé‚»æ¥çŸ©é˜µ(Shuman et al., 2013)ã€‚$W_{ij} = \exp{(-\frac{\mathrm{dist}(v_i, v_j)^2}{\sigma^2})} \ \text{if} \ \text{dist}(v_i, v_j) \leq \mathcal{\kappa}, \mathrm{otherwise} \ 0$ï¼Œå…¶ä¸­ $W_{ij}$ è¡¨ç¤ºäº†æ£€æµ‹å™¨ $v_i$ å’Œ $v_j$ ä¹‹é—´çš„æƒé‡ï¼Œ$\mathrm{dist}(v_i, v_j)$ è¡¨ç¤ºæ£€æµ‹å™¨ $v_i$ åˆ° $v_j$ ä¹‹é—´çš„è·ç¦»ã€‚$\sigma$ è¡¨ç¤ºè·ç¦»çš„æ ‡å‡†å·®ï¼Œ$\kappa$ è¡¨ç¤ºé˜ˆå€¼ã€‚</p><div align=center>![Figure8](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig8.JPG)<div align=center>![Table](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Table1.JPG)<h2 id=41-experimental-settings>4.1 Experimental Settings</h2><p>Baselines 1. $\rm{HA}$ï¼šå†å²å‡å€¼ï¼Œå°†äº¤é€šæµå»ºæ¨¡æˆå‘¨æœŸæ€§è¿‡ç¨‹ï¼Œä½¿ç”¨ä¹‹å‰çš„å‘¨æœŸçš„åŠ æƒå¹³å‡ä½œä¸ºé¢„æµ‹ã€‚2. $\mathrm{ARIMA}_{kal}$ï¼šAuto-Regressive Integrated Moving Average model with Kalman filterï¼Œå¹¿æ³›åœ°åº”ç”¨äºæ—¶é—´åºåˆ—é¢„æµ‹ä¸Šã€‚3. $\rm{VAR}$: Vector Auto-Regression(Hamilton, 1994)ã€‚4. $\rm{SVR}$ï¼šSupport Vector Regressionï¼Œä½¿ç”¨çº¿æ€§æ”¯æŒå‘é‡æœºç”¨äºå›å½’ä»»åŠ¡ã€‚5. Feed forward Neural network (FNN)ï¼šå‰å‘ä¼ æ’­ç¥ç»ç½‘ç»œï¼Œä¸¤ä¸ªéšè—å±‚ï¼ŒL2æ­£åˆ™åŒ–ã€‚6. Recurrent Neural Network with fully connected LSTM hidden units (FC-LSTM)(Sutskever et al., 2014).</p><p>æ‰€æœ‰çš„ç¥ç»ç½‘ç»œæ–¹æ³•éƒ½æ˜¯ç”¨ Tensorflow å®ç°ï¼Œä½¿ç”¨ Adam ä¼˜åŒ–å™¨ï¼Œå­¦ä¹ ç‡è¡°å‡ã€‚ä½¿ç”¨ Tree-structured Parzen Estimator(TPE)(Bergstra et al., 2011) åœ¨éªŒè¯é›†ä¸Šé€‰æ‹©æœ€å¥½çš„è¶…å‚æ•°ã€‚DCRNN çš„è¯¦ç»†å‚æ•°è®¾ç½®å’Œ baselines çš„è¶…å‚æ•°è®¾ç½®è§é™„å½•Eã€‚</p><h2 id=42-traffic-forecasting-performance-comparison>4.2 Traffic Forecasting Performance Comparison</h2><p>è¡¨1å±•ç¤ºäº†ä¸åŒçš„æ–¹æ³•åœ¨15åˆ†é’Ÿï¼Œ30åˆ†é’Ÿï¼Œ1å°æ—¶åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šé¢„æµ‹çš„å¯¹æ¯”ã€‚è¿™äº›æ–¹æ³•åœ¨ä¸‰ç§å¸¸ç”¨çš„ metrics ä¸Šè¿›è¡Œäº†è¯„ä¼°ï¼ŒåŒ…æ‹¬1. MAEï¼Œ 2. MAPEï¼ˆMean Absolute Percentage Errorï¼‰ï¼Œ 3. RMSEã€‚è¿™äº› metrics ä¸­çš„ç¼ºå¤±å€¼è¢«æ’é™¤å‡ºå»ã€‚è¿™äº›å…¬å¼åœ¨åè®°E.2ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°è¿™ä¸¤ä¸ªæ•°æ®é›†ä¸Šæœ‰ä»¥ä¸‹ç°è±¡ï¼š1. RNN-based methodsï¼ŒåŒ…æ‹¬FC-LSTMå’ŒDCRNNï¼Œä¸€èˆ¬æ¯”å…¶ä»–çš„æ–¹æ³•è¡¨ç°å¾—å¥½ï¼Œè¿™å¼ºè°ƒå¯¹æ—¶é—´ä¾èµ–çš„å»ºæ¨¡çš„é‡è¦æ€§ã€‚2. DCRNNåœ¨æ‰€æœ‰çš„ forecasting horizons ä¸­çš„æ‰€æœ‰ metrics ä¸Šéƒ½è·å¾—äº†æœ€å¥½çš„è¡¨ç°ï¼Œè¿™è¯´æ˜å¯¹ç©ºé—´ä¾èµ–å»ºæ¨¡çš„æœ‰æ•ˆæ€§ã€‚3. æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ŒåŒ…æ‹¬ FNNï¼ŒFC-LSTMï¼ŒDCRNN åœ¨é•¿æœŸé¢„æµ‹ä¸Šï¼Œå€¾å‘äºæ¯”çº¿æ€§çš„ baseline æœ‰æ›´å¥½çš„ç»“æœã€‚æ¯”å¦‚ï¼Œ1å°æ—¶ã€‚è¿™æ˜¯å› ä¸ºéšç€ horizon çš„å¢é•¿ï¼Œæ—¶é—´ä¾èµ–å˜å¾—æ›´åŠ éçº¿æ€§ã€‚æ­¤å¤–ï¼Œéšç€å†å²å‡å€¼ä¸ä¾èµ–çŸ­æœŸæ•°æ®ï¼Œå®ƒçš„è¡¨ç°å¯¹äº forecasting horizon çš„å°å¢é•¿æ˜¯ä¸å˜çš„ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒMETR-LAï¼ˆLos Angelesï¼Œæœ‰å¾ˆå¤æ‚çš„äº¤é€šç¯å¢ƒï¼‰æ•°æ®æ¯” PEMS-BAY æ›´æœ‰æŒ‘æˆ˜æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬å°† METR-LA çš„æ•°æ®ä½œä¸ºä»¥ä¸‹å®éªŒçš„é»˜è®¤æ•°æ®é›†ã€‚</p><h2 id=43-effect-of-spatial-dependency-modeling>4.3 Effect of Spatial Dependency Modeling</h2><p>ä¸ºäº†ç»§ç»­æ·±å…¥å¯¹ç©ºé—´ä¾èµ–å»ºæ¨¡çš„å½±å“ï¼Œæˆ‘ä»¬å¯¹æ¯”äº† DCRNN å’Œä»¥ä¸‹å˜ä½“ï¼š 1. DCRNN-NoConvï¼Œè¿™ä¸ªé€šè¿‡ä½¿ç”¨å•ä½é˜µæ›¿æ¢æ‰©æ•£å·ç§¯ï¼ˆå¼2ï¼‰ä¸­çš„è½¬ç§»çŸ©é˜µï¼Œå¿½ç•¥äº†ç©ºé—´ä¾èµ–ã€‚è¿™å°±æ„å‘³ç€é¢„æµ‹åªèƒ½é€šè¿‡å†å²å€¼é¢„æµ‹ã€‚ 2. DCRNN-UniConvï¼Œæ‰©æ•£å·ç§¯ä¸­åªä½¿ç”¨å‰å‘éšæœºæ¸¸èµ°ï¼›å›¾3å±•ç¤ºäº†è¿™ä¸‰ä¸ªæ¨¡å‹ä½¿ç”¨å¤§ä½“ç›¸åŒæ•°é‡çš„å‚æ•°æ—¶çš„å­¦ä¹ æ›²çº¿ã€‚æ²¡æœ‰æ‰©æ•£å·ç§¯ï¼ŒDCRNN-NoConv æœ‰ç€æ›´å¤§çš„ validation errorã€‚æ­¤å¤–ï¼ŒDCRNNè·å¾—äº†æœ€ä½çš„ validation errorï¼Œè¯´æ˜äº†ä½¿ç”¨åŒå‘éšæœºæ¸¸èµ°çš„æœ‰æ•ˆæ€§ã€‚è¿™ä¸ªå‘Šè¯‰æˆ‘ä»¬åŒå‘éšæœºæ¸¸èµ°èµ‹äºˆäº†æ¨¡å‹æ•è·ä¸Šä¸‹æ¸¸äº¤é€šå½±å“çš„èƒ½åŠ›ä¸çµæ´»æ€§ã€‚</p><div align=center>![Figure3](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig3.JPG)<p>ä¸ºäº†ç ”ç©¶å›¾çš„æ„å»ºæ–¹æ³•çš„å½±å“ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªæ— å‘å›¾ï¼Œ$\widehat{W}_{ij} = \widehat{W}_{ji} = \max(W_{ij}, W_{ji})$ï¼Œå…¶ä¸­ $\widehat{\boldsymbol{W}}$ æ˜¯æ–°çš„å¯¹ç§°æƒé‡çŸ©é˜µã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨äº† DCRNN çš„ä¸€ä¸ªå˜ä½“ï¼Œè¡¨ç¤ºæˆ GCRNNï¼Œä½¿ç”¨ <em>ChebNet</em> å·ç§¯çš„åºåˆ—åˆ°åºåˆ—å­¦ä¹ ï¼Œå¹¶ç”¨å¤§ä½“ç›¸åŒçš„å‚æ•°æ•°é‡ã€‚è¡¨2å±•ç¤ºäº† DCRNN å’Œ GCRNN åœ¨ METR-LA æ•°æ®é›†ä¸Šçš„å¯¹æ¯”ã€‚DCRNN éƒ½æ¯” GCRNN å¥½ã€‚è¿™è¯´æ˜æœ‰å‘å›¾èƒ½æ›´å¥½çš„æ•è·äº¤é€šæ£€æµ‹å™¨ä¹‹é—´çš„éå¯¹ç§°å…³ç³»ã€‚å›¾4å±•ç¤ºäº†ä¸åŒå‚æ•°çš„å½±å“ã€‚$K$ å¤§ä½“å¯¹åº”äº†å·ç§¯æ ¸æ„Ÿå—é‡çš„å¤§å°ï¼Œå•å…ƒæ•°å¯¹åº”äº†å·ç§¯æ ¸æ•°ã€‚è¶Šå¤§çš„ $K$ è¶Šèƒ½ä½¿æ¨¡å‹æ•è·æ›´å®½çš„ç©ºé—´ä¾èµ–ï¼Œä»£ä»·æ˜¯å¢åŠ äº†å­¦ä¹ çš„å¤æ‚åº¦ã€‚æˆ‘ä»¬è§‚æµ‹åˆ°éšç€ $K$ çš„å¢åŠ ï¼ŒéªŒè¯é›†ä¸Šçš„è¯¯å·®å…ˆæ˜¯å¿«é€Ÿä¸‹é™ï¼Œç„¶åå¾®å¾®ä¸Šå‡ã€‚æ”¹å˜ä¸åŒæ•°é‡çš„å•å…ƒä¹Ÿä¼šæœ‰ç›¸ä¼¼çš„æƒ…å†µã€‚</p><div align=center>![Table2](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Table2.JPG)<div align=center>![Figure4](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig4.JPG)<h2 id=44-effect-of-temporal-dependency-modeling>4.4 Effect of Temporal Dependency Modeling</h2><p>ä¸ºäº†è¡¡é‡æ—¶é—´å»ºæ¨¡çš„å½±å“ï¼ŒåŒ…æ‹¬åºåˆ—åˆ°åºåˆ—æ¡†æ¶ä»¥åŠ scheduled sampling æŠ€æœ¯ï¼Œæˆ‘ä»¬è®¾è®¡ DCRNN çš„ä¸‰ç§å˜ä½“ï¼š1. DCNNï¼šæˆ‘ä»¬æ‹¼æ¥å†å²çš„è§‚æµ‹å€¼ä¸ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„å‘é‡ï¼Œå°†å®ƒæ”¾åˆ°å †å çš„æ‰©æ•£å·ç§¯å±‚ä¸­ï¼Œé¢„æµ‹æœªæ¥çš„æ—¶é—´åºåˆ—ã€‚æˆ‘ä»¬è®­ç»ƒä¸€ä¸ªæ¨¡å‹åªé¢„æµ‹ä¸€æ­¥ï¼Œå°†ä¹‹å‰çš„é¢„æµ‹ç»“æœæ”¾åˆ°æ¨¡å‹ä¸­ä½œä¸ºè¾“å…¥ï¼Œä½¿ç”¨å¤šæ­¥å‰å‘é¢„æµ‹ã€‚2. DCRNN-SEQï¼šä½¿ç”¨ç¼–ç è§£ç åºåˆ—åˆ°åºåˆ—å­¦ä¹ æ¡†æ¶åšå¤šæ­¥é¢„æµ‹ã€‚3. DCRNNï¼šç±»ä¼¼ DCRNN-SEQ ï¼Œé™¤äº†å¢åŠ äº† scheduled samplingã€‚</p><p>å›¾5å±•ç¤ºäº†è¿™å››ç§æ–¹æ³•é’ˆå¯¹ MAE çš„å¯¹æ¯”ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼š1. DCRNN-SEQ æ¯” DCNN å¥½å¾ˆå¤šï¼Œç¬¦åˆäº†å¯¹æ—¶é—´å»ºæ¨¡çš„é‡è¦æ€§ã€‚2. DCRNN è¾¾åˆ°äº†æœ€å¥½çš„æ•ˆæœï¼Œéšç€é¢„æµ‹ horizon çš„å¢åŠ ï¼Œå®ƒçš„å…ˆè¿›æ€§å˜å¾—è¶Šæ¥è¶Šæ˜æ˜¾ã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºæ¨¡å‹åœ¨è®­ç»ƒçš„æ—¶å€™å°±åœ¨å¤„ç†å¤šæ­¥é¢„æµ‹æ—¶å‡ºç°çš„è¯¯å·®ï¼Œå› æ­¤ä¼šå¾ˆå°‘çš„å—åˆ°è¯¯å·®åå‘ä¼ æ’­çš„å½±å“ã€‚æˆ‘ä»¬ä¹Ÿè®­ç»ƒäº†ä¸€ä¸ªæ€»æ˜¯å°†è¾“å‡ºä½œä¸ºè¾“å…¥æ‰”åˆ°æ¨¡å‹ä¸­çš„æ¨¡å‹ã€‚ä½†æ˜¯å®ƒçš„è¡¨ç°æ¯”è¿™ä¸‰ç§å˜ä½“éƒ½å·®ï¼Œè¿™å°±å¼ºè°ƒäº† scheduled sampling çš„é‡è¦æ€§ã€‚</p><div align=center>![Figure5](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig5.JPG)<h2 id=45-æ¨¡å‹çš„è§£é‡Šæ€§>4.5 æ¨¡å‹çš„è§£é‡Šæ€§</h2><p>ä¸ºäº†æ›´å¥½çš„ç†è§£æ¨¡å‹ï¼Œæˆ‘ä»¬å¯¹é¢„æµ‹ç»“æœå’Œå­¦ä¹ åˆ°çš„æ»¤æ³¢å™¨è¿›è¡Œæ€§äº†å¯è§†åŒ–ã€‚å›¾6å±•ç¤ºäº†é¢„æµ‹1å°æ—¶çš„æ•ˆæœã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°äº†ä»¥ä¸‹æƒ…å†µï¼š1. DCRNN åœ¨äº¤é€šæµé€Ÿåº¦ä¸­å­˜åœ¨å°çš„éœ‡è¡æ—¶ï¼Œç”¨å‡å€¼ç”Ÿæˆäº†å¹³æ»‘çš„é¢„æµ‹ç»“æœï¼ˆå›¾6aï¼‰ã€‚è¿™åæ˜ äº†æ¨¡å‹çš„é²æ£’æ€§ã€‚2. DCRNN æ¯” baseline æ–¹æ³•ï¼ˆå¦‚FC-LSTMï¼‰æ›´å€¾å‘äºç²¾ç¡®çš„é¢„æµ‹å‡ºçªå˜ã€‚å›¾6bå±•ç¤ºäº† DCRNN é¢„æµ‹äº†é«˜å³°æ—¶æ®µçš„èµ·å§‹å’Œç»ˆæ­¢ã€‚è¿™æ˜¯å› ä¸º DCRNN æ•è·äº†ç©ºé—´ä¾èµ–ï¼Œèƒ½å¤Ÿåˆ©ç”¨é‚»å±…æ£€æµ‹å™¨é€Ÿåº¦çš„å˜æ¢æ¥ç²¾ç¡®é¢„æµ‹ã€‚å›¾7å±•ç¤ºäº†ä»¥ä¸åŒé¡¶ç‚¹ä¸ºä¸­å¿ƒå­¦ä¹ åˆ°çš„æ»¤æ³¢å™¨çš„æ ·ä¾‹ã€‚æ˜Ÿè¡¨ç¤ºä¸­å¿ƒï¼Œé¢œè‰²è¡¨ç¤ºæƒé‡ã€‚æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°æƒé‡æ›´å¥½çš„åœ¨ä¸­å¿ƒå‘¨å›´å±€éƒ¨åŒ–ï¼Œè€Œä¸”æƒé‡åŸºäºè·¯ç½‘è·ç¦»è¿›è¡Œæ‰©æ•£ã€‚æ›´å¤šçš„å¯è§†åŒ–åœ¨é™„å½•Fã€‚</p><div align=center>![Figure6](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig6.JPG)<div align=center>![Figure7](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig7.JPG)<h1 id=5-conclusion>5 Conclusion</h1><p>æˆ‘ä»¬å¯¹è·¯ç½‘ä¸Šçš„äº¤é€šé¢„æµ‹åšäº†æ—¶ç©ºä¸Šçš„å»ºæ¨¡ï¼Œæå‡ºäº† <em>diffusion convolutional recurrent neural network</em>ï¼Œå¯ä»¥æ•è·æ—¶ç©ºä¾èµ–ã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬ä½¿ç”¨åŒå‘éšæœºæ¸¸èµ°ï¼Œå¯¹ç©ºé—´ä¾èµ–å»ºæ¨¡ï¼Œä½¿ç”¨å¾ªç¯ç¥ç»ç½‘ç»œæ•è·æ—¶é—´çš„åŠ¨æ€æ€§ã€‚è¿˜ç»§æ‰¿äº†ç¼–ç è§£ç æ¶æ„å’Œ scheduled sampling æŠ€æœ¯æ¥æå‡é•¿æœŸé¢„æµ‹çš„æ€§èƒ½ã€‚åœ¨ä¸¤ä¸ªçœŸå®çš„æ•°æ®é›†ä¸Šè¯„ä¼°äº†æ€§èƒ½ï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ¯” baselines å¥½å¾ˆå¤šã€‚æœªæ¥çš„å·¥ä½œï¼Œ1. ä½¿ç”¨æå‡ºçš„ç½‘ç»œè§£å†³å…¶ä»–çš„æ—¶ç©ºé¢„æµ‹é—®é¢˜ï¼›2. å¯¹ä¸æ–­æ¼”åŒ–çš„å›¾ç»“æ„çš„æ—¶ç©ºä¾èµ–å…³ç³»å»ºæ¨¡ã€‚</p><h1 id=appendix>Appendix</h1><h2 id=b-efficient-calculation-of-equation>B Efficient Calculation Of Equation</h2><p>å¼2å¯ä»¥åˆ†è§£æˆä¸¤ä¸ªæœ‰ç›¸åŒæ—¶é—´å¤æ‚åº¦çš„éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯ $\boldsymbol{D}^{-1}_O \boldsymbol{W}$ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯ $\boldsymbol{D}^{-1}_I \boldsymbol{W}^T$ã€‚å› æ­¤æˆ‘ä»¬åªç ”ç©¶ç¬¬ä¸€éƒ¨åˆ†çš„æ—¶é—´å¤æ‚åº¦ã€‚</p><p>ä»¤ $T_k(x) = (\boldsymbol{D}^{-1}_O \boldsymbol{W})^k \boldsymbol{x}$ï¼Œå¼2çš„ç¬¬ä¸€éƒ¨åˆ†å¯ä»¥é‡å†™ä¸ºï¼š</p>$$\tag{4}
\sum^{K-1}\_{k=0} \theta\_k T\_k (X\_{:,p})
$$<p>å› ä¸º $T_{k+1}(x) = \boldsymbol{D}^{-1}_O \boldsymbol{W} T_k(\boldsymbol{x})$ å’Œ $\boldsymbol{D}^{-1}_O \boldsymbol{W}$ æ˜¯ç¨€ç–çš„ï¼Œå¯ä»¥å¾ˆå®¹æ˜“çœ‹å‡ºå¼4å¯ä»¥é€šè¿‡ $O(K)$ çš„é€’å½’ç¨€ç–-ç¨ å¯†çŸ©é˜µä¹˜æ³•ï¼Œæ¯æ¬¡æ—¶é—´å¤æ‚åº¦ä¸º $O(\vert \varepsilon \vert)$ å¾—åˆ°ã€‚ç„¶åï¼Œå¼2å’Œå¼4çš„æ—¶é—´å¤æ‚åº¦éƒ½ä¸º $O(K\vert \varepsilon \vert)$ã€‚å¯¹äºç¨ å¯†å›¾ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ spectral sparsification(Cheng et al., 2015) ä½¿å…¶ç¨€ç–ã€‚</p><h2 id=c-relation-with-spectral-graph-convolution>C Relation With Spectral Graph Convolution</h2><p><em>Proof.</em> è°±å›¾å·ç§¯åˆ©ç”¨å½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ $\boldsymbol{L = D^{-\frac{1}{2}}(D - W)D^{\frac{1}{2}}} = \mathbf{\Phi \Lambda \Phi^T}$ã€‚ChebNet ä½¿ $f_\theta$ å‚æ•°åŒ–ä¸ºä¸€ä¸ª $\Lambda$ çš„ $K$ é˜¶å¤šé¡¹å¼ï¼Œä½¿ç”¨ç¨³å®šçš„åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼åŸºè®¡ç®—è¿™ä¸ªå€¼ã€‚</p>$$\tag{5}
\boldsymbol{X}\_{:,p} \star\_\mathcal{G} f\_\theta = \mathbf{\Phi} (\sum^{K-1}\_{k=0} \theta\_k \mathbf{\Lambda}^k) \mathbf{\Phi^T X}\_{:,p} = \sum^{K-1}\_{k=0} \theta\_k \boldsymbol{L}^k \boldsymbol{X}\_{:,p} = \sum^{K-1}\_{k=0} \tilde{\theta}\_k T\_k(\tilde{\boldsymbol{L}})\boldsymbol{X}\_{:,p}
$$<p>å…¶ä¸­ $T_0(x)=1, T_1(x)=x, T_k(x) = xT_{k-1}(x) - T_{k-2}(x)$ æ˜¯åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼çš„åŸºã€‚ä»¤ $\lambda_{\mathrm{max}}$ è¡¨ç¤º $\boldsymbol{L}$ æœ€å¤§çš„ç‰¹å¾å€¼ï¼Œ$\tilde{\boldsymbol{L}} = \frac{2}{\lambda_{\text{max}}} \boldsymbol{L - I}$ è¡¨ç¤ºå°†æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç¼©æ”¾ï¼Œå°†ç‰¹å¾å€¼ä» $[0, \lambda_{\text{max}}]$ æ˜ å°„åˆ° $[-1, 1]$ï¼Œå› ä¸ºåˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼ç”Ÿæˆäº†ä¸€ä¸ªåœ¨ $[-1, 1]$ å†…æ­£äº¤çš„åŸºã€‚å¼5å¯ä»¥çœ‹æˆä¸€ä¸ªå…³äº $\tilde{\boldsymbol{L}}$ çš„å¤šé¡¹å¼ï¼Œæˆ‘ä»¬ä¸€ä¼šå„¿å¯ä»¥çœ‹åˆ°ï¼ŒChebNet å·ç§¯çš„è¾“å‡ºå’Œæ‰©æ•£å·ç§¯åˆ°å¸¸æ•°ç¼©æ”¾å› å­çš„è¾“å‡ºç›¸ä¼¼ã€‚å‡è®¾ $\lambda_{\text{max}} = 2$ï¼Œæ— å‘å›¾ $\boldsymbol{D}_I = \boldsymbol{D}_O = \boldsymbol{D}$ã€‚</p>$$\tag{6}
\tilde{\boldsymbol{L}} = \boldsymbol{D}^{-\frac{1}{2}}(\boldsymbol{D} - \boldsymbol{W}) \boldsymbol{D}^{-\frac{1}{2}} - \boldsymbol{I} = - \boldsymbol{D}^{-\frac{1}{2}} \boldsymbol{W} \boldsymbol{D}^{-\frac{1}{2}} \sim - \boldsymbol{D}^{-1} \boldsymbol{W}
$$<p>$\tilde{\boldsymbol{L}}$ å’Œè´Ÿçš„éšæœºæ¸¸èµ°è½¬ç§»çŸ©é˜µç›¸ä¼¼ï¼Œå› æ­¤å¼5çš„è¾“å‡ºä¹Ÿå’Œå¼2ç›´åˆ°å¸¸æ•°ç¼©æ”¾å› å­çš„è¾“å‡ºç›¸ä¼¼ã€‚</p></section><footer class=article-footer><section class=article-tags><a href=/blog/tags/deep-learning/>Deep Learning</a>
<a href=/blog/tags/graph/>Graph</a>
<a href=/blog/tags/graph-convolutional-network/>Graph Convolutional Network</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under Apache License 2.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-article");renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/blog/p/stg2seq-spatial-temporal-graph-to-sequence-model-for-multi-step-passenger-demand-forecasting/><div class=article-details><h2 class=article-title>STG2Seq: Spatial-temporal Graph to Sequence Model for Multi-step Passenger Demand Forecasting</h2></div></a></article><article><a href=/blog/p/self-attention-graph-pooling/><div class=article-details><h2 class=article-title>Self-Attention Graph Pooling</h2></div></a></article><article><a href=/blog/p/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/><div class=article-details><h2 class=article-title>DeepSTN+: Context-aware Spatial-Temporal Neural Network for Crowd Flow Prediction in Metropolis</h2></div></a></article><article><a href=/blog/p/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/><div class=article-details><h2 class=article-title>Flow Prediction in Spatio-Temporal Networks Based on Multitask Deep Learning</h2></div></a></article><article><a href=/blog/p/revisiting-spatial-temporal-similarity-a-deep-learning-framework-for-traffic-prediction/><div class=article-details><h2 class=article-title>Revisiting Spatial-Temporal Similarity: A Deep Learning Framework for Traffic Prediction</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2020 -
2026 Davidhamçš„åšå®¢</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/blog/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>