<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="[Individual Mobility Prediction via Attentive Marked Temporal Point Processes](https://arxiv.org/pdf/2109.02715.pdf)ã€‚ä»£ç ï¼š[https://github.com/Kaimaoge/AMTPP\\_for\\_Mobility](https://github.com/Kaimaoge/AMTPP_for_Mobility)ã€‚ç»“åˆæ·±åº¦å­¦ä¹ çš„TPPï¼Œç”¨æ³¨æ„åŠ›æœºåˆ¶å¢å¼ºå¯¹äº‹ä»¶çš„è¡¨ç¤ºï¼Œä½¿ç”¨æ··åˆALLåˆ†å¸ƒå¯¹äº‹ä»¶é—´çš„æ—¶é—´é—´éš”å»ºæ¨¡ï¼Œé€šè¿‡å­¦ä¹ ODè½¬ç§»æ¦‚ç‡çŸ©é˜µç»™å®šOé¢„æµ‹Dã€‚"><title>Individual Mobility Prediction via Attentive Marked Temporal Point Processes</title><link rel=canonical href=https://davidham3.github.io/blog/p/individual-mobility-prediction-via-attentive-marked-temporal-point-processes/><link rel=stylesheet href=/blog/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="Individual Mobility Prediction via Attentive Marked Temporal Point Processes"><meta property='og:description' content="[Individual Mobility Prediction via Attentive Marked Temporal Point Processes](https://arxiv.org/pdf/2109.02715.pdf)ã€‚ä»£ç ï¼š[https://github.com/Kaimaoge/AMTPP\\_for\\_Mobility](https://github.com/Kaimaoge/AMTPP_for_Mobility)ã€‚ç»“åˆæ·±åº¦å­¦ä¹ çš„TPPï¼Œç”¨æ³¨æ„åŠ›æœºåˆ¶å¢å¼ºå¯¹äº‹ä»¶çš„è¡¨ç¤ºï¼Œä½¿ç”¨æ··åˆALLåˆ†å¸ƒå¯¹äº‹ä»¶é—´çš„æ—¶é—´é—´éš”å»ºæ¨¡ï¼Œé€šè¿‡å­¦ä¹ ODè½¬ç§»æ¦‚ç‡çŸ©é˜µç»™å®šOé¢„æµ‹Dã€‚"><meta property='og:url' content='https://davidham3.github.io/blog/p/individual-mobility-prediction-via-attentive-marked-temporal-point-processes/'><meta property='og:site_name' content='Davidhamçš„åšå®¢'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='deep learning'><meta property='article:tag' content='point process'><meta property='article:published_time' content='2022-05-20T15:35:04+00:00'><meta property='article:modified_time' content='2022-05-20T15:35:04+00:00'><meta name=twitter:title content="Individual Mobility Prediction via Attentive Marked Temporal Point Processes"><meta name=twitter:description content="[Individual Mobility Prediction via Attentive Marked Temporal Point Processes](https://arxiv.org/pdf/2109.02715.pdf)ã€‚ä»£ç ï¼š[https://github.com/Kaimaoge/AMTPP\\_for\\_Mobility](https://github.com/Kaimaoge/AMTPP_for_Mobility)ã€‚ç»“åˆæ·±åº¦å­¦ä¹ çš„TPPï¼Œç”¨æ³¨æ„åŠ›æœºåˆ¶å¢å¼ºå¯¹äº‹ä»¶çš„è¡¨ç¤ºï¼Œä½¿ç”¨æ··åˆALLåˆ†å¸ƒå¯¹äº‹ä»¶é—´çš„æ—¶é—´é—´éš”å»ºæ¨¡ï¼Œé€šè¿‡å­¦ä¹ ODè½¬ç§»æ¦‚ç‡çŸ©é˜µç»™å®šOé¢„æµ‹Dã€‚"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/blog/><img src=/blog/img/avatar_hu_a95981f1fc190aef.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸš€</span></figure><div class=site-meta><h1 class=site-name><a href=/blog>Davidhamçš„åšå®¢</a></h1><h2 class=site-description>éšä¾¿å†™å†™</h2></div></header><ol class=menu-social><li><a href=https://github.com/Davidham3 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/blog/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/blog/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/blog/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/blog/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#41-self-attention-encoder>4.1 Self-attention Encoder</a></li><li><a href=#42-asymmetrical-log-laplace-mixture-for-inter-trip-time>4.2 Asymmetrical Log-Laplace Mixture for Inter-trip Time</a></li><li><a href=#43-od-matrix-learning>4.3 OD Matrix Learning</a></li><li><a href=#44-model-training>4.4 Model Training</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/blog/p/individual-mobility-prediction-via-attentive-marked-temporal-point-processes/>Individual Mobility Prediction via Attentive Marked Temporal Point Processes</a></h2><h3 class=article-subtitle>[Individual Mobility Prediction via Attentive Marked Temporal Point Processes](https://arxiv.org/pdf/2109.02715.pdf)ã€‚ä»£ç ï¼š[https://github.com/Kaimaoge/AMTPP\_for\_Mobility](https://github.com/Kaimaoge/AMTPP_for_Mobility)ã€‚ç»“åˆæ·±åº¦å­¦ä¹ çš„TPPï¼Œç”¨æ³¨æ„åŠ›æœºåˆ¶å¢å¼ºå¯¹äº‹ä»¶çš„è¡¨ç¤ºï¼Œä½¿ç”¨æ··åˆALLåˆ†å¸ƒå¯¹äº‹ä»¶é—´çš„æ—¶é—´é—´éš”å»ºæ¨¡ï¼Œé€šè¿‡å­¦ä¹ ODè½¬ç§»æ¦‚ç‡çŸ©é˜µç»™å®šOé¢„æµ‹Dã€‚</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>May 20, 2022</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 8 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p><a class=link href=https://arxiv.org/pdf/2109.02715.pdf target=_blank rel=noopener>Individual Mobility Prediction via Attentive Marked Temporal Point Processes</a>ã€‚ä»£ç ï¼š<a class=link href=https://github.com/Kaimaoge/AMTPP_for_Mobility target=_blank rel=noopener>https://github.com/Kaimaoge/AMTPP_for_Mobility</a>ã€‚ç»“åˆæ·±åº¦å­¦ä¹ çš„TPPï¼Œç”¨æ³¨æ„åŠ›æœºåˆ¶å¢å¼ºå¯¹äº‹ä»¶çš„è¡¨ç¤ºï¼Œä½¿ç”¨æ··åˆALLåˆ†å¸ƒå¯¹äº‹ä»¶é—´çš„æ—¶é—´é—´éš”å»ºæ¨¡ï¼Œé€šè¿‡å­¦ä¹ ODè½¬ç§»æ¦‚ç‡çŸ©é˜µç»™å®šOé¢„æµ‹Dã€‚</p><p>é¢„æµ‹ç”¨æˆ·ä¸‹ä¸€ä¸ªtripçš„å¼€å§‹æ—¶é—´$t$ï¼Œèµ·ç‚¹$o$ï¼Œç›®çš„åœ°$d$ã€‚AMTPPæ¨¡å‹ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶æ•è·ç”¨æˆ·travel behaviorå†…çš„å‘¨æœŸæ€§å’Œregularityã€‚ä½¿ç”¨éå¯¹ç§°çš„log-Laplace mixture distributionå»ºæ¨¡èµ·å§‹æ—¶é—´$t$çš„åˆ†å¸ƒã€‚æ­¤å¤–ï¼Œè¿˜å¼€å‘äº†ä¸€ä¸ªODçŸ©é˜µå­¦ä¹ æ¨¡å—ã€‚</p><h1 id=1-introduction>1 Introduction</h1><p>æœ¬è´¨ä¸Šï¼Œç”¨æˆ·çš„ç§»åŠ¨æ•°æ®åˆ†ä¸ºä¸¤ç±»ï¼šå¸¦æ—¶é—´æˆ³çš„ä½ç½®åºåˆ—${ (t_i, l_i) }^n_{i=1}$ï¼Œè¡¨ç¤ºæ—¶é—´$t_i$çš„ä½ç½®$l_i$ï¼›trip/activity sequence ${(t_i, o_i, d_i)}^n_{i=1}$ï¼Œæ—¶é—´$t_i$çš„ä»$o_i$å‡ºå‘ï¼Œç›®çš„åœ°æ˜¯$d_i$ã€‚é¢„æµ‹ä¸‹ä¸€ä½ç½®çš„ç ”ç©¶æ¯”è¾ƒå¤šï¼Œä½†æ˜¯é¢„æµ‹ä¸‹ä¸€ä¸ªtripçš„å·¥ä½œæ¯”è¾ƒå°‘ã€‚ç›¸æ¯”å‰è€…ï¼Œåè€…çš„ä¿¡æ¯é‡æ›´å¤§ï¼Œæ—¶ç©ºå…³è”æ›´å¤æ‚ã€‚è€Œä¸”tripè®°å½•æ¯”è½¨è¿¹åº”ç”¨çš„åœºæ™¯æ›´å¤šã€‚ä½†æ˜¯å¯¹ODå»ºæ¨¡ï¼Œå‡è®¾æœ‰$S$ä¸ªä½ç½®ï¼Œé‚£å°±è¦$S \times S$è¿™ä¸ªæ•°é‡çº§ï¼Œè€ƒè™‘åˆ°æ—¶é—´å’Œtravelçš„æ–¹å¼ï¼Œæ¯”å¦‚car, bike, busã€æ—…è¡Œçš„ç›®çš„ï¼Œwork, school, leisureï¼Œè¿™ä¸ªæ•°é‡çº§å°±æ›´å¤§äº†ã€‚</p><p><img src=/blog/images/individual-mobility-prediction-via-attentive-marked-temporal-point-processes/Fig1.jpg loading=lazy alt=Figure1></p><p>æœ¬æ–‡çš„ç›®çš„æ˜¯ç»™å®šå†å²çš„è½¨è¿¹${t_i, o_i, d_i}^n_{i=1}$ï¼Œé¢„æµ‹$t_{n+1}, o_{n+1}, d_{n+1}$ã€‚å¦‚æœæŠŠæ—¶é—´$t$çœ‹ä½œæ˜¯è¿ç»­å˜é‡ï¼Œ$o, d$çœ‹ä½œæ˜¯ç¦»æ•£å˜é‡ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªtripçš„æœç´¢ç©ºé—´æ˜¯$[t_n, +\infty) \times {1, \dots, S} \times {1, \dots, S}$ã€‚ç°åœ¨å¤„ç†äº‹ä»¶åºåˆ—çš„æ–¹æ³•æœ‰ä¸¤ç±»ï¼š</p><ol><li>HMMï¼Œéšé©¬å°”å¯å¤«æ¨¡å‹</li><li>marked temporal point processesã€‚</li></ol><p>HMMçš„ç¼ºç‚¹æ˜¯æ—¶é—´æ˜¯ç¦»æ•£çš„ï¼Œä¸æ˜¯è¿ç»­çš„ã€‚TPPç›¸æ¯”HMMï¼Œæ›´é€šç”¨ã€‚</p><p>æœ€è¿‘çš„å·¥ä½œæŠŠæ·±åº¦å­¦ä¹ å’ŒTPPç»“åˆåœ¨ä¸€èµ·ã€‚ä½†æ˜¯è¿™äº›æ–¹æ³•åœ¨å»ºæ¨¡ç”¨æˆ·ç§»åŠ¨æˆ–æ—…è¡Œæ•°æ®ä¸Šæœ‰ä¸€äº›æŒ‘æˆ˜ã€‚</p><ol><li>ODæ•°æ®ä¹‹é—´çš„æ—¶ç©ºå…³ç³»å¤ªå¤æ‚äº†ã€‚è€Œä¸”$S \times S$è¿™ä¸ªæ•°é‡çº§å¤ªå¤§ã€‚æœ‰äº›å·¥ä½œå‡è®¾timeå’Œmarkerä¹‹é—´çš„å…³ç³»æ˜¯é™æ€çš„ã€‚å½“markerçš„ç»´æ•°æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œå‚æ•°ä¼šå˜å¾—å¾ˆå¤šã€‚</li><li>å¾ˆå¤šTPPæ–¹æ³•æ˜¯ç”¨Hawkesè¿‡ç¨‹æ¥å»ºæ¨¡çš„ï¼Œè¿™ç§è¿‡ç¨‹æ²¡æ³•æç°travelä¸­çš„å‘¨æœŸæ€§ã€‚</li></ol><p>æœ¬æ–‡æå‡ºçš„AMTPPè§£å†³äº†ä¸Šè¿°çš„æŒ‘æˆ˜ã€‚ç”¨è‡ªæ³¨æ„åŠ›è®¡ç®—è¿‡å»çš„tripå¯¹æœªæ¥tripçš„å½±å“ã€‚å¹¶ä¸”è®¾è®¡äº†ä¸€ä¸ªæ–°çš„position embeddingæ¥æ•è·æ—¶é—´ä¿¡æ¯ã€‚ä½¿ç”¨asymmetric Log-Laplace mixture distributionå»ºæ¨¡äº‹ä»¶é—´çš„æ—¶é—´ã€‚ALLåˆ†å¸ƒå¯ä»¥åˆ»ç”»travel behaviorçš„rhythmså’Œregularityã€‚ODçŸ©é˜µå­¦ä¹ æ¨¡å—ï¼Œå¯ä»¥ä»æ•°æ®ä¸­å­¦ä¹ åˆ°ä¸€ä¸ªåŠ¨æ€çš„ODå…³ç³»çŸ©é˜µã€‚</p><h1 id=problem-description>Problem Description</h1><p>ä¸€ä¸ªç”¨æˆ·$u$ç›´åˆ°æ—¶é—´$t$çš„trip sequenceï¼š</p>$$
\tag{1} \mathcal{H}^u\_t = \{(t^u\_1, o^u\_1, d^u\_1), \dots, (t^u\_{n\_u}, o^u\_{n\_u}, d^u\_{n\_u}): t^u\_{n\_u} \leq t \},
$$<p>$n_u$è¡¨ç¤ºåºåˆ—ä¸­çš„tripä¸ªæ•°ã€‚$t^u_i, o^u_i, d^u_i$è¡¨ç¤ºç¬¬$i$ä¸ªtripçš„å‡ºå‘æ—¶é—´ã€èµ·ç‚¹å’Œç›®çš„åœ°ã€‚æ—¶é—´æ˜¯è¿ç»­å˜é‡ï¼ŒODæ˜¯ç¦»æ•£å˜é‡ã€‚åé¢å¿½ç•¥$u$ã€‚$t_i$å¯ä»¥è¡¨ç¤ºä¸ºäº‹ä»¶é—´çš„æ—¶é—´é—´éš”$\tau_i = t_i - t_{i - 1} \in \mathbb{R}^+$ã€‚$\tau$å¯ä»¥çœ‹ä½œæ˜¯äº‹ä»¶çš„æ´»åŠ¨æ—¶é—´ã€‚è¿™ä¿©è¡¨ç¤ºæ˜¯ä¸€æ ·çš„ã€‚</p><p>ç›®æ ‡ï¼š</p>$$
\tag{2} p^\ast(\tau\_{n+1}, o\_{n+1}, d\_{n+1}) = p(\tau\_{n+1}, o\_{n+1}, d\_{n+1} \mid \mathcal{H}\_{t\_n}),
$$<p>$\ast$è¡¨ç¤ºæ¡ä»¶æ¦‚ç‡ã€‚æœ¬æ–‡è®¤ä¸º$o_{n+1} = d_n$ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€ä¸ªtripçš„ç›®çš„åœ°ç­‰äºä¸‹ä¸€ä¸ªtripçš„èµ·ç‚¹ï¼Œè¿™æ ·çš„è¯ï¼Œtripçš„TPPå°±å˜æˆæ™®é€šçš„TPPäº†ã€‚</p><h1 id=4-methodology>4 Methodology</h1><p><img src=/blog/images/individual-mobility-prediction-via-attentive-marked-temporal-point-processes/Fig2.jpg loading=lazy alt=Figure2></p><p>å›¾2æ˜¯AMTPPçš„æ¶æ„ã€‚</p><h2 id=41-self-attention-encoder>4.1 Self-attention Encoder</h2><p>ç¬¬ä¸€æ­¥æ˜¯è·å¾—$t_n, o_n, d_n$çš„åµŒå…¥è¡¨ç¤ºï¼š</p>$$
\tag{3} e\_n = \text{concat}(emb^t\_n, emb^o\_n, emb^d\_n),
$$<p>ä¸ºäº†è€ƒè™‘å‘¨æœŸå’ŒéŸµå¾‹ï¼Œå¼•å…¥ä½ç½®ç¼–ç ï¼š</p>$$
\tag{4} \begin{align} pe^n\_n(pos\_n, 2i) &= \text{sin}(pos\_n / L^{2i/J}\_{pos}),\\ pe^h\_n(pos\_n, 2i+1) &= \text{cos}(pos\_n / L^{2i/J}\_{pos}), \end{align},
$$<p>$pos_n \in {0, 1, \dots, 23 }$æ˜¯ç¬¬$n$ä¸ªtripçš„å°æ—¶ï¼Œ$J$æ˜¯åµŒå…¥çš„ç»´æ•°ï¼Œ$i \in {1, \dots, \lfloor J/2 \rfloor }$, $L_{pos}$æ˜¯ç¼©æ”¾å› å­ã€‚å¾ˆå¤šæ–¹æ³•æŠŠ$L_{pos}$è®¾ç½®æˆä¸€ä¸ªå®šå€¼ï¼Œæ¯”å¦‚10000ï¼Œä½†æ˜¯æœ¬æ–‡æŠŠå®ƒè®¾å®šä¸ºä¸€ä¸ªå‚æ•°ã€‚æ­¤å¤–ï¼Œè¿˜å¼•å…¥äº†day of weekä½œä¸ºä½ç½®ç¼–ç $pe^w_n$ã€‚åŠ ä¸Š$\tau_n$ï¼Œæœ€åçš„äº‹ä»¶åµŒå…¥è¡¨ç¤ºï¼š</p>$$
\tag{5} emb^t\_n = \text{concat}(pe^w\_n, pe^h\_n, \tau\_n).
$$<p>ODåµŒå…¥ï¼š</p>$$
\tag{6} \begin{align} emb^o\_n &= \text{concat}(W^o\_{em} \hat{o}\_n + b^o\_{em}, p^o\_n),\\ emb^d\_n &= \text{concat}(W^d\_{em} \hat{d}\_n + b^d\_{em}, p^d\_n), \end{align}
$$<p>$W^o_{em} \in \mathbb{R}^{J_o \times S}, W^d_{em} \in \mathbb{R}^{J_d \times S}, b^o_{em} \in \mathbb{R}^{J_o}, b^d_{em} \in \mathbb{R}^{J_d}$æ˜¯å‚æ•°ï¼Œ$J_o, J_d$æ˜¯ODåµŒå…¥å‘é‡çš„ç»´æ•°ï¼Œ$S$æ˜¯ä½ç½®çš„æ•°é‡ï¼Œ$p^o_n, p^d_n$æ˜¯ODçš„å…¶ä»–ä¿¡æ¯ï¼Œæ¯”å¦‚POIä»€ä¹ˆçš„ã€‚</p><p>ç»™å®šå†å²äº‹ä»¶åºåˆ—çš„åµŒå…¥$E_n = [e_1, e_2, \dots, e_n]^\top \in \mathbb{R}^{n \times J}$ï¼Œç”¨å¤šå¤´è‡ªæ³¨æ„åŠ›è®¡ç®—ç¬¬$n$ä¸ªtripçš„éšè—çŠ¶æ€ã€‚æ³¨æ„åŠ›çš„å‚æ•°çŸ©é˜µ$Q_l = EW^Q_l, K_l = E W^K_l, V_l = E W^V_l, l = 1, 2, \dots, L$ã€‚$W^Q_l, W^K_l \in \mathbb{R}^{J \times c_k}, W^V_l \in \mathbb{R}^{J \times C_v}$ã€‚</p><p>æ³¨æ„åŠ›ï¼š</p>$$
\tag{7} \text{Att}(Q\_l, K\_l, V\_l) = \text{softmax}(\frac{Q\_l K^\top\_l}{\sqrt{d\_k}} \cdot M) V\_l,
$$<p>$M \in \mathbb{R}^{n \times n}$æ˜¯maskçŸ©é˜µï¼Œä¸Šä¸‰è§’éƒ¨åˆ†è®¾ä¸º$-\infty$ï¼Œé˜²æ­¢ä¿¡æ¯æ³„éœ²ã€‚</p><p>å¤šå¤´æ³¨æ„åŠ›ï¼š</p>$$
\tag{8} \begin{align} H &= \text{gelu}(\text{concat}(\text{head}\_1, \dots, \text{head}\_L) W^O),\\ \text{head}\_l &= \text{Att}(EW^Q\_l, EW^K\_l, EW^V\_l), \end{align}
$$<p>$W_O \in \mathbb{R}^{L \cdot c_v \times C_{\text{model}}}$, $c_{\text{model}}$æ˜¯è¾“å‡ºçš„ç‰¹å¾æ•°ã€‚$\text{gelu}$è¡¨ç¤ºGaussian Error Linear Unitï¼Œéçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œ$H_n = [h_1, h_2, \dots, h_n]^\top \in \mathbb{R}^{n \times c_{\text{model}}}$æ˜¯è¾“å‡ºã€‚å› ä¸ºç”¨äº†maskï¼Œæ‰€ä»¥$h_i$åªæ˜¯åŸºäºå†å²ç”Ÿæˆçš„ã€‚</p><h2 id=42-asymmetrical-log-laplace-mixture-for-inter-trip-time>4.2 Asymmetrical Log-Laplace Mixture for Inter-trip Time</h2><p>è¿™ä¸ªéƒ¨åˆ†æ˜¯å¯¹äº‹ä»¶é—´çš„æ—¶é—´é—´éš”çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $p_\theta(\tau_{n+1} \mid h_n)$ å»ºæ¨¡ï¼Œä½¿ç”¨å‚æ•°ä¸º$\theta$çš„æ·±åº¦ç¥ç»ç½‘ç»œå»ºæ¨¡ã€‚ã€ŠIntensity-Free Learning of Temporal Point Processesã€‹è¿™ç¯‡è®ºæ–‡è®¤ä¸ºç›¸æ¯”å¯¹å¼ºåº¦å‡½æ•°å»ºæ¨¡ï¼Œç›´æ¥å¯¹æ—¶é—´é—´éš”å»ºæ¨¡æ›´æ–¹ä¾¿ã€‚è¿™ç¯‡è®ºæ–‡ç”¨log-normal mixture modelå¯¹TPPçš„æ¡ä»¶æ¦‚ç‡å¯†åº¦$p_\theta(\tau_{n+1} \mid h_n)$å»ºæ¨¡ã€‚ä½†æ˜¯è¿™ä¸ªåˆ†å¸ƒå¯¹tripä¹‹é—´çš„intervalä¸é€‚ç”¨ï¼Œå› ä¸ºtripä¹‹é—´çš„intervalè¡¨ç¤ºäº†äº‹ä»¶çš„æŒç»­æ—¶é—´ï¼Œè€Œä¸”æ¡ä»¶åˆ†å¸ƒé€šå¸¸æœ‰ä¸€äº›æ˜æ˜¾çš„å³°ã€‚ä¸ºäº†æ›´å¥½çš„åˆ»ç”»tripé—´çš„æ—¶é—´é—´éš”ï¼Œæœ¬æ–‡ç”¨Aysmmetric Log-Laplaceåˆ†å¸ƒã€‚è¿™ä¸ªåˆ†å¸ƒç»å¸¸ç”¨äºå¯¹éå¸¸åã€æœ‰å³°å’Œé•¿å°¾çš„æ•°æ®å»ºæ¨¡ã€‚ALLåˆ†å¸ƒæœ‰ä¸‰ä¸ªå‚æ•°ï¼š</p>$$
ALL(\tau; \beta, \lambda, \gamma) = \frac{\lambda \gamma}{\tau(\lambda + \gamma)} \begin{cases} (\frac{\tau}{\beta})^\lambda & \text{if} \ 0 < \tau < \beta,\\ (\frac{\beta}{\tau})^\gamma & \text{if} \ \tau \geq \beta, \end{cases}
$$<p>$\beta$æ§åˆ¶æ¨¡å¼ï¼Œ$\lambda$å’Œ$\gamma$åˆ†åˆ«æ˜¯å·¦å³é•¿å°¾çš„æ­£é•¿å°¾å‚æ•°ã€‚</p><p>ç†æƒ³çš„$p_\theta(\tau \mid h)$åˆ†å¸ƒèƒ½è¶‹è¿‘ä»»æ„åˆ†å¸ƒã€‚å› ä¸ºæ··åˆæ¨¡å‹æœ‰è¶‹è¿‘$\mathbb{R}$ä¸Šä»»æ„æ¦‚ç‡åˆ†å¸ƒçš„æ€§è´¨ï¼šuniversal approximation(UA)ï¼Œæˆ‘ä»¬ä½¿ç”¨$\mathcal{D}$ï¼Œä½œä¸ºALLçš„æ··åˆåˆ†å¸ƒï¼Œæ¥è¶‹è¿‘$p_\theta(\tau \mid h)$ï¼š</p>$$
\tag{9} \mathcal{D}(\tau; w, \beta, \lambda, \gamma) = \sum^K\_{k=1} w\_k ALL(\tau; \beta\_k, \lambda\_k, \gamma\_k),
$$<p>$w$æ˜¯æ··åˆæƒé‡ã€‚é€šè¿‡è¿™ä¸ªæ··åˆæ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥è¿‘ä¼¼ä¸€ä¸ªç”¨æˆ·çš„å¤šæ¨¡æ€æ—…è¡Œæ¨¡å¼ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä¸€ä¸ªæ—…è¡Œè€…åªæœ‰æ—©ä¸Šçš„é€šå‹¤æ•°æ®ï¼Œæˆ‘ä»¬åœ¨24å°æ—¶å†…åªèƒ½çœ‹åˆ°ä¸€ä¸ªå³°ã€‚ä½†æ˜¯å¯¹äºæ¥å›é€šå‹¤çš„äººï¼Œæˆ‘ä»¬å¸Œæœ›çœ‹åˆ°çš„æ˜¯æ—©ä¸Šä¸€ä¸ªå³°ï¼Œæ™šä¸Šä¸€ä¸ªå³°ã€‚è¿™ç§æ··åˆæ¨¡å‹å¯ä»¥è¡¨ç¤ºå¤šä¸ªå³°ã€‚</p><p>ALLæ··åˆåˆ†å¸ƒä¸‹çš„å˜é‡çš„å¯¹æ•°æœä»$\text{ALMixture}(w,\hat{\beta}, \hat{\lambda}, \hat{\gamma})$ï¼Œæ¯ä¸ªéƒ¨åˆ†æ˜¯ï¼š</p>$$
\tag{10} AL(y) = \frac{\hat{\lambda}\_k}{\hat{\gamma}\_k + \frac{1}{\hat{\gamma}\_k}} \begin{cases} \exp (\frac{\hat{\lambda}\_k}{\hat{\gamma}\_k} (y - \hat{\beta}\_k)) & \ \text{if} \ 0 < y < \hat{\beta}\_k,\\ \exp(- \hat{\lambda}\_k \hat{\gamma}\_k (y - \hat{\beta}\_k)) & \ \text{if} \ y \geq \hat{\beta}\_k, \end{cases}
$$<p>$\hat{\beta}_k = \log(\beta_k), \hat{\gamma}_k = \sqrt{\frac{\lambda_k}{\gamma_k}}, \hat{\lambda}_k = \sqrt{\lambda_k \gamma_k}$ã€‚</p><p>å…¬å¼10é‡Œé¢çš„å¯¹æ•°ä¼¼ç„¶æ¯”å…¬å¼9ä¸­çš„åŸå§‹ALLæ›´å®¹æ˜“å­¦ä¹ ã€‚æˆ‘ä»¬ç”¨MDNç½‘ç»œå­¦ä¹ ALMixtureé‡Œé¢çš„å‚æ•°ï¼š</p>$$
\tag{11} \begin{align} w\_n &= \text{softmax}(\Phi\_w h\_n + b\_w),\\ \hat{\beta}\_n &= \exp(\Phi\_\beta h\_n + b\_\beta),\\ \hat{\lambda}\_n &= \exp(\Phi\_\lambda h\_n + b\_\lambda),\\ \hat{\gamma}\_n &= \exp(\Phi\_\gamma h\_n + b\_\gamma), \end{align}
$$<p>softmaxå’Œexpç”¨æ¥çº¦æŸåˆ†å¸ƒçš„å‚æ•°ï¼Œ$\Phi, b$éƒ½æ˜¯learnable parametersã€‚</p><h2 id=43-od-matrix-learning>4.3 OD Matrix Learning</h2><p>æ˜¾ç„¶ODå’Œ$t$æ˜¯æœ‰å…³çš„ï¼Œå³$p^\ast(o_{n+1} \mid \tau_{n+1})$ï¼Œè¿™é‡Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥å¯¹æ—¶é—´$\tau$å»ºæ¨¡ï¼Œè€Œæ˜¯å¯¹$\tau$ä¸Šé¢çš„å‚æ•°${w_n, \beta_n, \lambda_n, \gamma_n }$å»ºæ¨¡ï¼Œè¿™æ ·å°±ä¸ç”¨ä»åˆ†å¸ƒä¸­é‡‡æ ·äº†ã€‚å› ä¸ºALLæ··åˆåˆ†å¸ƒä¸­çš„å‚æ•°æ˜¯æœ‰ç‰©ç†æ„ä¹‰çš„ï¼Œä»å­¦ä¹ åˆ°çš„æ¨¡å‹ä¸­æ¨¡æ‹Ÿtripä¹Ÿå¾ˆå®¹æ˜“ã€‚é€šè¿‡è°ƒæ•´å‚æ•°å°±å¯ä»¥çœ‹åˆ°ODåˆ†å¸ƒçš„å˜åŒ–ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡å°å³°å‚æ•°$\beta$æ¥è§‚å¯ŸODåˆ†å¸ƒçš„å˜åŒ–ï¼Œå¯ä»¥ç†è§£æˆä¸€ä¸ªäººçš„å‡ºå‘æ—¶é—´æå‰ä¹‹åä»–çš„tripä¼šæœ‰ä»€ä¹ˆå˜åŒ–ã€‚</p>$$
\tag{12} \begin{align} \hat{h}\_n &= \text{concat}(h\_n, w\_n, \hat{\beta}\_n, \hat{\lambda}\_n, \hat{\gamma}\_n),\\ \hat{o}\_{n+1} &= \text{softmax}(\Phi\_o \hat{h}\_n + b\_o), \end{align}
$$<p>ä¸‹ä¸€ä¸ªä½ç½®$\hat{o}_{n+1}$çš„åˆ†å¸ƒä¾èµ–æ‹¼æ¥å‘é‡$\hat{h}_n$ï¼Œè¿™ä¸ªå‘é‡ç”±å†å²ç¼–ç $h_n$å’Œtripçš„æ—¶é—´å‚æ•°ç»„æˆã€‚</p><p>$p^\ast(d_{n+1})$é€šè¿‡æŠŠ$\hat{o}_{n+1}$ä¹˜ä»¥ä¸€ä¸ªODçŸ©é˜µ$OD_{n+1}$å¾—åˆ°ï¼Œè¿™ä¸ªçŸ©é˜µçš„æ¯ä¸€åˆ—åŒ…å«äº†ä»ä¸€ä¸ªOè½¬ç§»åˆ°æ‰€æœ‰Dçš„è½¬ç§»æ¦‚ç‡ã€‚è¿™ä¸ªODçŸ©é˜µå¾ˆæœ‰ç”¨ï¼Œæœ‰äº†è¿™ä¸ªODçŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“åœ°é“çº¿è·¯é‡Œé¢å“ªä¸ªç»“ç‚¹çš„äººæ¯”è¾ƒå¤šã€‚ä½†æ˜¯$S \times S$å¤ªå¤§äº†ï¼Œå­¦ä¸€ä¸ªå®æ—¶çš„ODçŸ©é˜µå¤ªéš¾äº†ã€‚æˆ‘ä»¬ç”¨ä¸‹é¢çš„æ–¹æ³•å­¦ä¹ $OD_{n+1}$é‡Œé¢çš„å‚æ•°ï¼š</p>$$
\tag{13}
\begin{align}
D^1\_{n+1} &= \text{reshape}(\Phi^1\_m \hat{h}\_n),\\
D^2\_{n+1} &= \text{reshape}(\Phi^2\_m \hat{h}\_n),\\
OD\_{n+1} &= D^1\_{n+1}{D^2\_{n+1}}^\top \cdot M\_{od},\\
OD\_{n+1} &= \text{softmax}(OD\_{n+1}).\\
\hat{d}\_{n+1} &= OD\_{n+1} \hat{o}\_{n+1}
\end{align}
$$<p>$D^1_{n+1}, D^2_{n+1} \in \mathbb{R}^{S \times r}$, $r \ll S$ã€‚$\Phi$æ˜¯learnable parametersã€‚$M_{od} \in \mathbb{R}^{S \times S}$ç”¨æ¥è¿‡æ»¤æ‰ä¸å¯èƒ½çš„OD pairï¼Œæ–¹æ³•å°±æ˜¯æŠŠè¿™äº›ä½ç½®è®¾ç½®æˆ $- \infty$ï¼ŒåŒ…æ‹¬çŸ©é˜µçš„å¯¹è§’çº¿ã€‚softmaxç”¨æ¥çº¦æŸçŸ©é˜µçš„æ¯ä¸€åˆ—çš„å’Œéƒ½ä¸º1ã€‚è¿™ä¸ªçŸ©é˜µæ˜¯æ ¹æ®æ—¶é—´ç¼–ç $\hat{h}_n$åŠ¨æ€å˜åŒ–çš„ã€‚è¾“å‡ºçš„$\hat{d}_{n+1}$å’Œè¾“å…¥çš„$\hat{o}_{n+1}$ä¸å‚æ•°å…³è”åœ¨ä¸€èµ·ï¼Œè®©ç½‘ç»œè®­ç»ƒèµ·æ¥æ›´å®¹æ˜“ã€‚</p><h2 id=44-model-training>4.4 Model Training</h2><p>è´Ÿå¯¹æ•°ä¼¼ç„¶ã€‚éšæœºæ¢¯åº¦ä¸‹é™ã€‚çŸ­çš„åºåˆ—è¦åŠ padã€‚padéƒ¨åˆ†ä¼šè¢«maskæ‰ã€‚æŸå¤±å‡½æ•°ï¼š</p>$$
\tag{14} \mathcal{L} = - \sum^U\_{u=1} \sum^{n\_u}\_{n=1} \log p^\ast\_\Theta(\tau^u\_n) + \log p^\ast\_\Theta(o^u\_n) + \log p^\ast\_\Theta(d^u\_n),
$$<p>$U$æ˜¯ç”¨æˆ·æ•°ï¼Œ$n_u$æ˜¯ç”¨æˆ·$u$çš„tripçš„ä¸ªæ•°ã€‚å¯¹äº$\tau$çš„å¯¹æ•°ä¼¼ç„¶ï¼Œåœ¨$\tau$ä¸Šé¢åŠ ä¸€ä¸ªå¯¹æ•°å˜æ¢ï¼Œå¾—åˆ°éå¯¹ç§°Laplaceåˆ†å¸ƒï¼š$y = \log(\tau)$ï¼Œæœ€ç»ˆå¾—åˆ°ï¼š</p>$$
\tag{15} \begin{align} \log p^\ast\_\Theta(\tau) &= \log p^\ast\_\Theta(y) - \log(\tau), \ \ \ \ y = \log(\tau),\\ p^\ast\_\Theta(y) &= \text{ALMixture}(w, \hat{\beta}, \hat{\lambda}, \hat{\gamma}). \end{align}
$$</section><footer class=article-footer><section class=article-tags><a href=/blog/tags/deep-learning/>Deep Learning</a>
<a href=/blog/tags/point-process/>Point Process</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under Apache License 2.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-article");renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/blog/p/semi-supervised-learning-for-marked-temporal-point-processes/><div class=article-details><h2 class=article-title>Semi-supervised Learning for Marked Temporal Point Processes</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2020 -
2026 Davidhamçš„åšå®¢</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/blog/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>