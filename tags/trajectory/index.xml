<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Trajectory on Davidhamçš„åšå®¢</title><link>https://davidham3.github.io/blog/tags/trajectory/</link><description>Recent content in Trajectory on Davidhamçš„åšå®¢</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 24 Feb 2026 00:00:00 +0000</lastBuildDate><atom:link href="https://davidham3.github.io/blog/tags/trajectory/index.xml" rel="self" type="application/rss+xml"/><item><title>ä»130å€æ€§èƒ½æå‡çœ‹Pythonçš„æ‰¹é‡è®¡ç®—å’Œå¹¶è¡ŒåŒ–ç­–ç•¥ï¼štraj-dist-rsçš„å¹¶è¡Œç­–ç•¥å®ç°</title><link>https://davidham3.github.io/blog/p/%E4%BB%8E130%E5%80%8D%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87%E7%9C%8Bpython%E7%9A%84%E6%89%B9%E9%87%8F%E8%AE%A1%E7%AE%97%E5%92%8C%E5%B9%B6%E8%A1%8C%E5%8C%96%E7%AD%96%E7%95%A5traj-dist-rs%E7%9A%84%E5%B9%B6%E8%A1%8C%E7%AD%96%E7%95%A5%E5%AE%9E%E7%8E%B0/</link><pubDate>Tue, 24 Feb 2026 00:00:00 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E4%BB%8E130%E5%80%8D%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87%E7%9C%8Bpython%E7%9A%84%E6%89%B9%E9%87%8F%E8%AE%A1%E7%AE%97%E5%92%8C%E5%B9%B6%E8%A1%8C%E5%8C%96%E7%AD%96%E7%95%A5traj-dist-rs%E7%9A%84%E5%B9%B6%E8%A1%8C%E7%AD%96%E7%95%A5%E5%AE%9E%E7%8E%B0/</guid><description>&lt;p&gt;åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘åˆ†äº«äº†å¦‚ä½•ç”¨ Rust é‡å†™ &lt;code&gt;traj-dist&lt;/code&gt;ï¼Œå®ç°äº†å•æ¬¡è·ç¦»è®¡ç®—çš„æ€§èƒ½æå‡ã€‚ä½†æ˜¯ï¼Œå½“é¢å¯¹å¤§è§„æ¨¡è½¨è¿¹æ•°æ®é›†æ—¶ï¼Œå•æ¬¡è°ƒç”¨å¹¶ä¸æ˜¯æœ€ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬è¦åšè½¨è¿¹åºåˆ—çš„èšç±»ï¼Œé‚£ä¹ˆå°±ä¸€å®šè¦è®¡ç®—ä»»æ„ä¸¤æ¡è½¨è¿¹ä¹‹é—´çš„è·ç¦»ã€‚ä»¥åŠ¨æ€è§„åˆ’ç±»ç®—æ³•ä¸ºä¾‹ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯&lt;code&gt;O(NM)&lt;/code&gt;ã€‚å‡å¦‚æœ‰ 1000 æ¡è½¨è¿¹ï¼Œéœ€è¦è®¡ç®—å®ƒä»¬ä¹‹é—´çš„æ‰€æœ‰è·ç¦»å¯¹ã€‚é‚£å°±æ˜¯ $1000 \times 1000 \times MN$ï¼Œå‡è®¾è½¨è¿¹å¹³å‡é•¿åº¦æ˜¯1000ï¼Œé‚£è‡³å°‘æœ‰1000^4çš„å¤æ‚åº¦ã€‚é‚£å¦‚æœè¦ç®—10ä¸‡æ¡è½¨è¿¹ä¹‹é—´çš„è·ç¦»å‘¢ï¼Ÿ1000ä¸‡å‘¢ï¼Ÿè¿™å°†æ˜¯éå¸¸å¤§çš„è®¡ç®—é‡ï¼ˆè‚¯å®šè¦ä¸Šåˆ†å¸ƒå¼äº†ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¼šåˆ†äº« &lt;code&gt;traj-dist-rs&lt;/code&gt; çš„æ‰¹é‡è®¡ç®—æ¥å£å’Œå¹¶è¡ŒåŒ–ç­–ç•¥ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡æ­£ç¡®çš„æŠ€æœ¯è·¯çº¿å®ç°è¶…è¿‡&lt;strong&gt;130å€&lt;/strong&gt;çš„æ€§èƒ½æå‡ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè½¨è¿¹åºåˆ—èšç±»ã€knnç­‰ç®—æ³•ï¼Œéœ€è¦è®¡ç®—æ‰€æœ‰è½¨è¿¹ä¹‹é—´çš„è·ç¦»ã€‚&lt;/p&gt;
&lt;p&gt;é—®é¢˜å®šä¹‰ï¼š&lt;/p&gt;
&lt;p&gt;ç»™å®šKæ¡è½¨è¿¹ï¼ˆ&lt;code&gt;List[np.ndarray]&lt;/code&gt;ï¼‰ï¼Œè®¡ç®—å®ƒä»¬ä¸¤ä¸¤ä¹‹é—´çš„è·ç¦»ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ª&lt;code&gt;(K, K)&lt;/code&gt;çš„è·ç¦»çŸ©é˜µã€‚ä¸ºé¿å…å†—ä½™è®¡ç®—ï¼Œæˆ‘ä»¬åªè®¡ç®—çŸ©é˜µçš„ä¸Šä¸‰è§’éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜æ˜¯ä»¥&lt;code&gt;traj-dist&lt;/code&gt;ä½œä¸ºæˆ‘ä»¬å®éªŒçš„åŸºçº¿ã€‚&lt;/p&gt;
&lt;h2 id="ä¸€åŸºå‡†æµ‹è¯•ä¼ ç»Ÿæ–¹æ¡ˆçš„æ€§èƒ½ç“¶é¢ˆ"&gt;ä¸€ã€åŸºå‡†æµ‹è¯•ï¼šä¼ ç»Ÿæ–¹æ¡ˆçš„æ€§èƒ½ç“¶é¢ˆ
&lt;/h2&gt;&lt;p&gt;ç»™å®š20æ¡è½¨è¿¹ï¼Œæ¯æ¡è½¨è¿¹çš„é•¿åº¦ä¸º1000ï¼Œè®¡ç®—è·ç¦»çŸ©é˜µçš„ä¸Šä¸‰è§’éƒ¨åˆ†ï¼Œè·ç¦»ä½¿ç”¨DTWã€‚å› æ­¤ä¸€å…±éœ€è¦è®¡ç®—190æ¬¡ï¼ˆå¯¹è§’çº¿ä¸è®¡ç®—ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰3ç§ç®€å•çš„è§£å†³æ€è·¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨åŒé‡forå¾ªç¯ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;traj-dist&lt;/code&gt;æä¾›çš„pdistå‡½æ•°ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨åŒé‡forå¾ªç¯+joblibã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;span class="lnt"&gt;44
&lt;/span&gt;&lt;span class="lnt"&gt;45
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;joblib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Parallel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delayed&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tqdm&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;trange&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;traj_dist.distance&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;tdist&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;NUM_TRAJECTORIES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;TRAJS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;NUM_TRAJECTORIES&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;WARMUP_RUNS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_runs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# Warmup&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;WARMUP_RUNS&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# Measure time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;times&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;trange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_runs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;perf_counter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;perf_counter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;times&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;times&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test1&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;NUM_TRAJECTORIES&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;NUM_TRAJECTORIES&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tdist&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dtw&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TRAJS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;TRAJS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test2&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tdist&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pdist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TRAJS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;metric&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;dtw&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;type_d&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test3&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Parallel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n_jobs&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;delayed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;tdist&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dtw&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;))(&lt;/span&gt;&lt;span class="n"&gt;TRAJS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;TRAJS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;NUM_TRAJECTORIES&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;NUM_TRAJECTORIES&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è·‘å‡ºæ¥çš„è€—æ—¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;tool&lt;/th&gt;
&lt;th&gt;technique&lt;/th&gt;
&lt;th&gt;running time(s)&lt;/th&gt;
&lt;th&gt;speedup&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 1&lt;/strong&gt;: double for-loop&lt;/td&gt;
&lt;td&gt;10.103s&lt;/td&gt;
&lt;td&gt;1x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 2&lt;/strong&gt;: traj-dist pdist&lt;/td&gt;
&lt;td&gt;10.088s&lt;/td&gt;
&lt;td&gt;1.001x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 3&lt;/strong&gt;: joblib parallel&lt;/td&gt;
&lt;td&gt;1.364s&lt;/td&gt;
&lt;td&gt;7.407x&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;code&gt;traj-dist&lt;/code&gt;çš„ç»“æœè¿˜æ˜¯æœ‰ç‚¹è®©äººæƒŠè®¶çš„ï¼Œå› ä¸ºpdistç›¸è¾ƒäºåŒé‡forå¾ªç¯å‡ ä¹æ²¡æœ‰ä»»ä½•æå‡ï¼Œè¯´æ˜pdistæ²¡æœ‰æ¶ˆé™¤pythonè§£é‡Šå™¨å¸¦æ¥çš„ä¸åˆ©ã€‚èµ¶ç´§å»çœ‹äº†ä¸€ä¸‹æºç ï¼Œæ‰å‘ç°pdistå±…ç„¶æ˜¯åœ¨pythoné‡Œé¢é€šè¿‡åŒé‡forå¾ªç¯å®ç°çš„ï¼Œæ²¡æœ‰ç”¨cythonåŠ é€ŸğŸ˜‚ã€‚é‚£æˆ‘ä»¬åç»­éƒ½ä¸ç”¨è€ƒè™‘è¿™ä¸ªå‡½æ•°äº†ã€‚&lt;/p&gt;
&lt;p&gt;joblibå¹¶è¡Œæœ‰æ¯”è¾ƒæ˜æ˜¾çš„æå‡ï¼Œå› ä¸ºjoblibé»˜è®¤ä½¿ç”¨lokyä½œä¸ºåç«¯å¯åŠ¨å¤šè¿›ç¨‹ï¼Œå¤šä¸ªè¿›ç¨‹åŒæ—¶è®¡ç®—ï¼Œæˆ‘æµ‹è¯•ç”¨çš„æœºå™¨æ˜¯20ä¸ªCPUæ ¸å¿ƒï¼Œjoblibåœ¨è®¾ç½®&lt;code&gt;n_jobs=-1&lt;/code&gt;çš„æ—¶å€™ï¼Œä¼šå¯åŠ¨å’ŒCPUç›¸åŒæ•°é‡çš„è¿›ç¨‹æ•°ã€‚&lt;/p&gt;
&lt;h2 id="äºŒç¬¬ä¸€å±‚åŠ é€Ÿé›¶æ‹·è´ä¸rustçš„é™ç»´æ‰“å‡»"&gt;äºŒã€ç¬¬ä¸€å±‚åŠ é€Ÿï¼šé›¶æ‹·è´ä¸Rustçš„é™ç»´æ‰“å‡»
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;å®Œæˆç›¸åŒçš„å®éªŒï¼Œçœ‹çœ‹æ•ˆæœï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;tool&lt;/th&gt;
&lt;th&gt;technique&lt;/th&gt;
&lt;th&gt;running time(s)&lt;/th&gt;
&lt;th&gt;speedup&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 1&lt;/strong&gt;: double for-loop&lt;/td&gt;
&lt;td&gt;0.631s&lt;/td&gt;
&lt;td&gt;16.011x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 3&lt;/strong&gt;: joblib parallel&lt;/td&gt;
&lt;td&gt;0.105s&lt;/td&gt;
&lt;td&gt;96.219x&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼ŒåŒé‡forå¾ªç¯çš„æ–¹æ¡ˆæ¯”&lt;code&gt;traj-dist&lt;/code&gt;å¿«äº†16.011å€ï¼Œå¦‚æœä½¿ç”¨Joblibï¼Œè¾¾åˆ°äº†96.219å€ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªç»“æœè¿˜æ˜¯æ¯”è¾ƒæƒŠäººçš„ï¼Œåœ¨ä¸Šä¸€ç¯‡æ–‡ç« é‡Œé¢æˆ‘ä»¬è®²äº†ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„æ ¸å¿ƒæå‡åœ¨äºå¼•å…¥é›¶æ‹·è´ï¼Œè®©rustç›´æ¥è¯»å–pythonä¸­numpy.ndarrayçš„åº•å±‚æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;è¿™è¯´æ˜å½“å‰&lt;code&gt;traj-dist-rs&lt;/code&gt;ä½¿ç”¨çš„é›¶æ‹·è´è®¾è®¡é…åˆrustçš„é«˜æ€§èƒ½å¯ä»¥è½»æ¾è¶…è¶Š&lt;code&gt;traj-dist&lt;/code&gt;ä½¿ç”¨cythonç¼–å†™çš„åŠ é€Ÿä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;è¿˜æ²¡æœ‰å®ç°&lt;code&gt;pdist&lt;/code&gt;å‡½æ•°ï¼Œè€ƒè™‘åˆ°pythonç”¨æˆ·ä¸ºäº†åŠ é€Ÿä¸€å®šä¼šä½¿ç”¨å¤šè¿›ç¨‹åŠ é€Ÿï¼Œé‚£ä¹ˆ&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„&lt;code&gt;pdist&lt;/code&gt;å‡½æ•°åœ¨è®¾è®¡ä¸Šå°±ä¸€å®šè¦è€ƒè™‘åˆ°å¹¶è¡Œèƒ½åŠ›ã€‚&lt;/p&gt;
&lt;h2 id="ä¸‰å¹¶è¡Œæ–¹æ¡ˆæ„æƒ³"&gt;ä¸‰ã€å¹¶è¡Œæ–¹æ¡ˆæ„æƒ³
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬åˆ†åˆ«è®¨è®ºpythonçš„å¤šè¿›ç¨‹å¹¶è¡Œä¸rustçš„rayonå¹¶è¡Œã€‚&lt;/p&gt;
&lt;h3 id="31-pythonå¤šè¿›ç¨‹å¹¶è¡Œ"&gt;3.1 Pythonå¤šè¿›ç¨‹å¹¶è¡Œ
&lt;/h3&gt;&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ï¼ŒGILé™åˆ¶äº†Pythonçš„å¹¶è¡Œæ•ˆç‡ï¼Œåªèƒ½é€šè¿‡å¤šè¿›ç¨‹å®ç°å¹¶è¡ŒåŠ é€Ÿè®¡ç®—ï¼Œå¯ä»¥ä½¿ç”¨pythonè‡ªå¸¦çš„å¤šè¿›ç¨‹åº“ï¼Œå¦‚multiprocessingï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼joblibè¿™æ ·çš„åº“ã€‚æœ¬è´¨ä¸Šéƒ½æ˜¯é€šè¿‡å¤šè¿›ç¨‹å®ç°å¹¶è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œä¸è®ºæ˜¯å“ªç§å¹¶è¡Œï¼Œä¸€å®šä¼šé‡åˆ°ä¸‹é¢çš„3ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;h4 id="1-åˆå§‹åŒ–å¼€é”€"&gt;1. åˆå§‹åŒ–å¼€é”€
&lt;/h4&gt;&lt;p&gt;æœ¬è´¨æ˜¯pythonä¸»è¿›ç¨‹ä¼šå¯åŠ¨å¤šä¸ªå­è¿›ç¨‹ï¼Œè¿™äº›å­è¿›ç¨‹çš„å¯åŠ¨æ˜¯æœ‰ä¸€å®šçš„å¼€é”€çš„ã€‚å½“è®¡ç®—é‡å˜å¤§çš„æ—¶å€™ï¼Œè¿™ä¸ªå¼€é”€å°±å¯ä»¥å¿½ç•¥ï¼Œä½†æ˜¯è®¡ç®—é‡å°çš„æ—¶å€™ï¼Œè¿›ç¨‹çš„åˆå§‹åŒ–åè€Œä¼šæˆä¸ºç“¶é¢ˆã€‚&lt;/p&gt;
&lt;h4 id="2-é€šä¿¡å¼€é”€"&gt;2. é€šä¿¡å¼€é”€
&lt;/h4&gt;&lt;p&gt;è¿›ç¨‹ä¹‹é—´çš„æ•°æ®æ˜¯éš”ç¦»çš„ï¼Œä¸èƒ½å…±äº«ï¼Œä½¿ç”¨å¤šè¿›ç¨‹çš„æ—¶å€™ï¼Œå¤§æ¦‚ä¼šç»å†ä¸‹é¢çš„æ­¥éª¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å‚æ•°å’Œå‡½æ•°ä¼šä»¥pickleçš„å½¢å¼åºåˆ—åŒ–ï¼Œç”±ä¸»è¿›ç¨‹ä¼ é€’åˆ°å¦ä¸€ä¸ªpythonè¿›ç¨‹ï¼ˆå­è¿›ç¨‹ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;å­è¿›ç¨‹ååºåˆ—åŒ–ï¼Œè¿›è¡Œè¿ç®—ï¼Œè¿ç®—ç»“æœé€šè¿‡pickleåºåˆ—åŒ–ä¼ é€’åˆ°ä¸»è¿›ç¨‹ï¼›&lt;/li&gt;
&lt;li&gt;ä¸»è¿›ç¨‹ååºåˆ—åŒ–æ‹¿åˆ°æœ€ç»ˆç»“æœï¼Œæ”¶é›†æ‰€æœ‰å­è¿›ç¨‹çš„ç»“æœã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ä¸€å…±æ˜¯2æ¬¡ä¿¡æ¯ä¼ é€’ã€2æ¬¡åºåˆ—åŒ–ã€2æ¬¡ååºåˆ—åŒ–ã€‚æ•°æ®é‡è¶Šå¤§ï¼Œè¿™ä¸ªå¼€é”€è¶Šå¤§ï¼Œå½“ç„¶ä¹Ÿæ˜¯æœ‰é¿å¼€çš„æ–¹æ¡ˆçš„ï¼Œæ¯”å¦‚ä½¿ç”¨å…±äº«å†…å­˜ï¼šæå‰å°†æ•°æ®å†™å…¥å…±äº«å†…å­˜ï¼Œå­è¿›ç¨‹ä»å…±äº«å†…å­˜è¯»å–è¿™éƒ¨åˆ†æ•°æ®ã€‚æœ¬æ–‡å…ˆä¸è®¨è®ºè¿™ä¸ªæ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h4 id="3-è°ƒåº¦ä¸è´Ÿè½½å‡è¡¡å¼€é”€"&gt;3. è°ƒåº¦ä¸è´Ÿè½½å‡è¡¡å¼€é”€
&lt;/h4&gt;&lt;p&gt;ä¸»è¦æœ‰2ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è´Ÿè½½ä¸å‡ï¼šå¦‚æœ1ä¸ªè¿›ç¨‹æ‰§è¡Œçš„éƒ½æ˜¯ä¸€äº›è®¡ç®—é‡æ¯”è¾ƒå¤§çš„å·¥ä½œï¼Œå…¶ä»–è¿›ç¨‹éƒ½æ˜¯è½»é‡çš„å·¥ä½œï¼Œé‚£ä¹ˆå…¶ä»–è¿›ç¨‹å®Œæˆä»»åŠ¡åå°±ä¼šé—²ç½®ï¼Œå°±åƒæœ¨æ¡¶åŸç†ä¸€æ ·ã€‚&lt;/li&gt;
&lt;li&gt;ä»»åŠ¡è°ƒåº¦å¼€é”€ï¼šä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªé˜Ÿåˆ—ç»´æŠ¤ä»»åŠ¡ï¼Œæ¯ä¸ªè¿›ç¨‹ä»é˜Ÿåˆ—é‡Œé¢æ‹‰å–ä»»åŠ¡è¿›è¡Œæ¶ˆè´¹ï¼Œä½†æ˜¯å•ä¸ªä»»åŠ¡çš„ä»»åŠ¡é‡éœ€è¦è®¾ä¸ºå¤šå¤§ï¼Ÿå¦‚æœè®¾ç½®çš„å°äº†ï¼Œå­è¿›ç¨‹ä¼šé¢‘ç¹æ‹‰å–ï¼Œæ¯æ¬¡æ‹‰å–éƒ½æœ‰å›ºå®šå¼€é”€ï¼Œé€ æˆæ€»å¼€é”€å˜å¤§ï¼›è®¾ç½®çš„å¤§äº†å¯¹å†…å­˜å‹åŠ›åˆæ¯”è¾ƒå¤§ï¼Œè€Œä¸”åˆæœ‰å¯èƒ½é€ æˆè´Ÿè½½ä¸å‡çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½†æ˜¯è¯´äº†è¿™ä¹ˆå¤šï¼ŒPythoné‡Œé¢ä¸ºäº†åŠ é€Ÿè¿ç®—ï¼Œå¤šè¿›ç¨‹å¹¶è¡Œä¸€å®šæ˜¯é¿ä¸å¼€çš„ä¸€ä¸ªæ–¹æ¡ˆï¼Œæˆ‘ä¸ªäººè¿˜æ˜¯å–œæ¬¢å…±äº«å†…å­˜çš„æ–¹æ¡ˆï¼Œå°¤å…¶æ˜¯ç»“åˆpyarrowã€‚&lt;/p&gt;
&lt;p&gt;å›åˆ°ä¸Šé¢çš„å®éªŒï¼Œå¯ä»¥çœ‹åˆ°joblibç¡®å®å¯ä»¥æ˜¾è‘—æå‡æ€§èƒ½ï¼Œå› æ­¤å¯¹äºå¤§éƒ¨åˆ†åœºæ™¯æ¥è¯´ï¼Œä½¿ç”¨joblibåªéœ€è¦å‡ è¡Œä»£ç å°±å¯ä»¥å¿«é€Ÿæå‡æ€§èƒ½ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„æ–¹æ¡ˆï¼Œç›¸å½“äº1è¡Œä»£ç æ¢å–æˆå€æå‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡è¿™é‡Œä¹Ÿéœ€è¦å¤šè®²ä¸€å¥ï¼Œjoblibçš„ä¸€å¤§ä¼˜åŠ¿æ˜¯ä¸ºpythonç”¨æˆ·æä¾›äº†éå¸¸Pythonicçš„å¹¶è¡Œæ¥å£ï¼Œé€šè¿‡ç®€å•çš„&lt;code&gt;Parallel(n_jobs=-1)(delayed(...))&lt;/code&gt;å®ç°å¤šè¿›ç¨‹ä»£ç å®ç°ï¼Œè¿™æ˜¯éå¸¸ä¼˜é›…çš„ã€‚&lt;/p&gt;
&lt;h3 id="32-rustrayonçš„å¹¶è¡ŒåŠ é€Ÿæ–¹æ¡ˆ"&gt;3.2 Rust+Rayonçš„å¹¶è¡ŒåŠ é€Ÿæ–¹æ¡ˆ
&lt;/h3&gt;&lt;p&gt;rusté‡Œé¢åšå¹¶è¡Œï¼Œè‚¯å®šé¿ä¸å¼€ä½¿ç”¨Rayonï¼ŒRayonå·²ç»æˆä¸ºrustç”Ÿæ€ä¸­æ•°æ®å¹¶è¡Œçš„äº‹å®æ ‡å‡†ã€‚&lt;/p&gt;
&lt;p&gt;Rayonè‡ªèº«çš„ä¼˜åŠ¿æœ‰å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æè‡´çš„æ˜“ç”¨æ€§ï¼šåƒjoblibä¸€æ ·æä¾›äº†éå¸¸å‚»ç“œçš„ä½¿ç”¨æ–¹å¼ï¼Œæ”¹é€ æˆæœ¬æä½ã€‚&lt;/li&gt;
&lt;li&gt;æ— ç•å¹¶å‘ï¼šç¼–è¯‘æ—¶å°±å¯ä»¥ä¿è¯å®‰å…¨ï¼Œå¤§éƒ¨åˆ†æƒ…å†µæ— éœ€åŠ é”ã€‚&lt;/li&gt;
&lt;li&gt;å·¥ä½œçªƒå–ï¼šæŸä¸ªçº¿ç¨‹å®Œæˆè‡ªå·±æ‰€æœ‰ä»»åŠ¡ä¹‹åä¼šå»å…¶ä»–ç¹å¿™çº¿ç¨‹ä¸­çªƒå–ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç›¸æ¯”ä¸Šé¢çš„pythonå¤šè¿›ç¨‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆå§‹åŒ–å¼€é”€ï¼šrayonç”¨çº¿ç¨‹ï¼Œå¼€é”€æ›´ä½ã€‚&lt;/li&gt;
&lt;li&gt;é€šä¿¡å¼€é”€ï¼šæ•°æ®è·¨çº¿ç¨‹å…±äº«ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒåº¦ä¸è´Ÿè½½å‡è¡¡å¼€é”€ï¼šå·¥ä½œçªƒå–ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å› æ­¤ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„&lt;code&gt;pdist&lt;/code&gt;ä¸€å®šä¼šä½¿ç”¨Rayonå®Œæˆå¹¶è¡Œè®¡ç®—çš„å·¥ä½œï¼Œä»¥å®ç°æœ€ä½³æ€§èƒ½ã€‚&lt;/p&gt;
&lt;h2 id="å››å·…å³°å¯¹å†³130å€æ€§èƒ½æå‡"&gt;å››ã€å·…å³°å¯¹å†³ï¼š130å€æ€§èƒ½æå‡
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ç›´æ¥çœ‹é€šè¿‡rayonåŠ é€Ÿåçš„pdistçš„æ€§èƒ½å§ï¼Œåé¢å†çœ‹å…·ä½“å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ç¬¬ä¸€èŠ‚çš„å®éªŒé‡Œé¢ç»™å‡ºäº†3ç§è·¯çº¿ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨åŒé‡forå¾ªç¯ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;traj-dist&lt;/code&gt;æä¾›çš„pdistå‡½æ•°ã€‚ï¼ˆå®é™…ä¸Šè¿™ä¸ªå’Œç¬¬ä¸€ä¸ªä¸€æ ·ï¼‰&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨åŒé‡forå¾ªç¯+joblibã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;traj-dist-rs&lt;/code&gt;æä¾›çš„pdistå‡½æ•°æ”¯æŒäº†ä¸²è¡Œå’Œå¹¶è¡Œçš„é€‰é¡¹å¯ä»¥é€‰æ‹©ï¼Œå› æ­¤å°±å½¢æˆäº†4æ¡è·¯çº¿ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨åŒé‡forå¾ªç¯ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;æä¾›çš„pdistå‡½æ•°ï¼ˆä¸²è¡Œï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨åŒé‡forå¾ªç¯+joblibã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;æä¾›çš„pdistå‡½æ•°ï¼ˆå¹¶è¡Œï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™é‡Œè®²ä¸€ä¸‹ä¸Šé¢çš„4æ¡æŠ€æœ¯è·¯çº¿ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æŠ€æœ¯è·¯çº¿&lt;/th&gt;
&lt;th&gt;ç‰¹ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Route1: åŒé‡forå¾ªç¯&lt;/td&gt;
&lt;td&gt;è¿™ä¸ªæ–¹æ¡ˆè°ƒç”¨çš„dtwæ˜¯traj-dist-rsä¼˜åŒ–è¿‡çš„ï¼Œt1ä¸t2ä»pythonè½¬ç§»åˆ°rustçš„æ—¶å€™æ˜¯é›¶æ‹·è´ï¼Œæ€§èƒ½å¾ˆå¥½ã€‚ä½†æ˜¯åŒé‡forå¾ªç¯åœ¨pythoné‡Œé¢ä¼šæ¯”è¾ƒæ…¢ï¼Œå› ä¸ºcpythonçš„è§£é‡Šæ“ä½œä¼šæ‹–ç´¯è¿™é‡Œçš„æ€§èƒ½ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Route2: rustä¸²è¡Œ&lt;/td&gt;
&lt;td&gt;rustå¯ä»¥é€šè¿‡é›¶æ‹·è´ç›´æ¥è¯»å–TRAJSé‡Œé¢çš„æ•°æ®ï¼Œå†…éƒ¨ä¹Ÿæ˜¯é€šè¿‡åŒé‡forå¾ªç¯è°ƒç”¨dtwå‡½æ•°è¿›è¡Œè®¡ç®—ï¼Œä½†æ˜¯è¿™ä¸ªforå¾ªç¯ä¼šæ¯”cpythonå¿«å¤šäº†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Route3: joblibå¹¶è¡Œ&lt;/td&gt;
&lt;td&gt;é€šè¿‡joblibå®ç°å¤šè¿›ç¨‹å¹¶è¡Œï¼ˆé»˜è®¤æ˜¯lokyåç«¯ï¼‰ï¼Œè™½ç„¶è°ƒç”¨çš„æ˜¯traj-dist-rsçš„dtwï¼Œä½†æ˜¯t1å’Œt2è¦ä»ä¸»è¿›ç¨‹è½¬ç§»åˆ°å­è¿›ç¨‹ï¼Œè¿™é‡Œä¼šå‘ç”Ÿæ•°æ®åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼Œå°±ç›¸å½“äºè¾“å…¥æ•°æ®å¤åˆ¶äº†ä¸¤æ¬¡ï¼›è€Œè¿”å›å€¼ä¹Ÿæ˜¯è¦åšä¸€æ¬¡åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå› æ­¤ä¹Ÿæ˜¯ä¸¤æ¬¡ã€‚ä½†æ˜¯å¯¹äºpythonæ¥è¯´ï¼Œæ˜¯ä¸ªä¸é”™çš„å¹¶è¡Œæ–¹æ¡ˆã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Route4: rayonå¹¶è¡Œ&lt;/td&gt;
&lt;td&gt;rusté€šè¿‡é›¶æ‹·è´è¯»å–TRAJSé‡Œé¢çš„æ•°æ®ï¼Œrayoné€šè¿‡å¤šçº¿ç¨‹æ‰§è¡Œdtwï¼Œä¸ä¸Šé¢çš„joblibç±»ä¼¼ï¼Œä¸è¿‡æ²¡æœ‰è·¨è¿›ç¨‹æ•°æ®ä¼ è¾“ã€è¿›ç¨‹ç»´æŠ¤å¼€é”€ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä¸‹é¢æœ‰ä¸¤ä¸ªæµ‹è¯•ç»“æœï¼Œä»ç„¶å–20æ¡è½¨è¿¹ï¼Œæ¯æ¬¡éƒ½æ˜¯å–5æ¬¡æµ‹é‡çš„ä¸­ä½æ•°ã€‚&lt;/p&gt;
&lt;h3 id="41-é«˜è®¡ç®—è´Ÿè½½è½¨è¿¹é•¿åº¦1000"&gt;4.1 é«˜è®¡ç®—è´Ÿè½½ï¼šè½¨è¿¹é•¿åº¦=1000
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;tool&lt;/th&gt;
&lt;th&gt;technique&lt;/th&gt;
&lt;th&gt;running time(s)&lt;/th&gt;
&lt;th&gt;speedup&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 1&lt;/strong&gt;: double for-loop&lt;/td&gt;
&lt;td&gt;10.103s&lt;/td&gt;
&lt;td&gt;1x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 3&lt;/strong&gt;: joblib parallel&lt;/td&gt;
&lt;td&gt;1.364s&lt;/td&gt;
&lt;td&gt;7.407x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 1&lt;/strong&gt;: double for-loop&lt;/td&gt;
&lt;td&gt;0.631s&lt;/td&gt;
&lt;td&gt;16.011x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 2&lt;/strong&gt;: rust serial (pdist)&lt;/td&gt;
&lt;td&gt;0.628s&lt;/td&gt;
&lt;td&gt;16.088x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 3&lt;/strong&gt;: joblib parallel&lt;/td&gt;
&lt;td&gt;0.105s&lt;/td&gt;
&lt;td&gt;96.219x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 4&lt;/strong&gt;: rayon parallel (pdist)&lt;/td&gt;
&lt;td&gt;0.078s&lt;/td&gt;
&lt;td&gt;129.526x&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ç»“æœåˆ†æï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Pythonå¾ªç¯å¼€é”€ vs Rustå¾ªç¯å¼€é”€ï¼š&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„Pythonå¾ªç¯ï¼ˆ0.631sï¼‰å’ŒRustä¸²è¡Œpdistï¼ˆ0.628sï¼‰è€—æ—¶å‡ ä¹ç›¸åŒã€‚è¿™è¯´æ˜åœ¨é«˜è®¡ç®—è´Ÿè½½ä¸‹ï¼ŒDTWç®—æ³•æœ¬èº«çš„è€—æ—¶å æ®ä¸»å¯¼ï¼ŒPythonå¾ªç¯çš„å¼€é”€æ˜¾å¾—ä¸é‚£ä¹ˆé‡è¦ã€‚&lt;/li&gt;
&lt;li&gt;å¤šè¿›ç¨‹ vs å¤šçº¿ç¨‹ï¼šRayonå¹¶è¡Œï¼ˆ0.078sï¼‰æ˜æ˜¾ä¼˜äºJoblibï¼ˆ0.105sï¼‰ï¼Œè¿™å¾—ç›Šäºå…¶æ›´ä½çš„å¼€é”€å’Œæ›´é«˜æ•ˆçš„çº¿ç¨‹é—´åä½œã€‚&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆçš„èƒœåˆ©ï¼š&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„åŸç”Ÿå¹¶è¡Œ pdist æ¥å£ï¼Œç›¸è¾ƒäºæœ€åˆçš„&lt;code&gt;traj-dist&lt;/code&gt;åŸºå‡†ï¼Œå®ç°äº†è¿‘&lt;strong&gt;130å€&lt;/strong&gt;çš„æ€§èƒ½é£è·ƒï¼è¿™æ­£æ˜¯æˆ‘ä»¬è¿½æ±‚çš„æ›´é«˜æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="42-ä½è®¡ç®—è´Ÿè½½è½¨è¿¹é•¿åº¦10"&gt;4.2 ä½è®¡ç®—è´Ÿè½½ï¼šè½¨è¿¹é•¿åº¦=10
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;tool&lt;/th&gt;
&lt;th&gt;technique&lt;/th&gt;
&lt;th&gt;running time(s)&lt;/th&gt;
&lt;th&gt;speedup&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 1&lt;/strong&gt;: double for-loop&lt;/td&gt;
&lt;td&gt;0.00186s&lt;/td&gt;
&lt;td&gt;1x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 3&lt;/strong&gt;: joblib parallel&lt;/td&gt;
&lt;td&gt;0.0653s&lt;/td&gt;
&lt;td&gt;0.028x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 1&lt;/strong&gt;: double for-loop&lt;/td&gt;
&lt;td&gt;0.000139s&lt;/td&gt;
&lt;td&gt;13.381x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 2&lt;/strong&gt;: rust serial (pdist)&lt;/td&gt;
&lt;td&gt;0.0000711s&lt;/td&gt;
&lt;td&gt;26.160x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 3&lt;/strong&gt;: joblib parallel&lt;/td&gt;
&lt;td&gt;0.0545s&lt;/td&gt;
&lt;td&gt;0.034x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 4&lt;/strong&gt;: rayon parallel (pdist)&lt;/td&gt;
&lt;td&gt;0.00201s&lt;/td&gt;
&lt;td&gt;0.925x&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ç»“æœåˆ†æï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¹¶è¡ŒåŒ–çš„ä»£ä»·ï¼šæ‰€æœ‰å¹¶è¡Œæ–¹æ¡ˆï¼ˆJoblibå’ŒRayonï¼‰çš„æ€§èƒ½éƒ½ä¸å¦‚ä¸²è¡Œã€‚Joblibçš„è¿›ç¨‹å¯åŠ¨å’Œæ•°æ®åºåˆ—åŒ–å¼€é”€å°¤ä¸ºå·¨å¤§ï¼Œå¯¼è‡´æ€§èƒ½ä¸‹é™äº†ä¸¤ä¸ªæ•°é‡çº§ã€‚Rayonè™½ç„¶å¼€é”€å°å¾—å¤šï¼Œä½†ä¾ç„¶ä¸æ•Œæœ€å¿«çš„ä¸²è¡Œå®ç°ã€‚&lt;/li&gt;
&lt;li&gt;è§£é‡Šå™¨å¼€é”€çš„å‡¸æ˜¾ï¼šåœ¨ä½è®¡ç®—è´Ÿè½½ä¸‹ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„Rustä¸²è¡Œpdistæ¯”å…¶Pythonå¾ªç¯å¿«äº†è¿‘2å€ã€‚è¿™è¯´æ˜å½“æ ¸å¿ƒè®¡ç®—éå¸¸å¿«æ—¶ï¼ŒPythonè§£é‡Šå™¨æœ¬èº«é‚£å¾®ä¸è¶³é“çš„å¾ªç¯å¼€é”€å°±æˆäº†ä¸»è¦ç“¶é¢ˆã€‚&lt;/li&gt;
&lt;li&gt;æœ€ä½³ç­–ç•¥ï¼šåœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œæœ€å¿«çš„æ–¹æ¡ˆæ˜¯è°ƒç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„ä¸²è¡Œ pdist å‡½æ•°ã€‚å®ƒæ—¢é¿å…äº†Pythonçš„å¾ªç¯å¼€é”€ï¼Œä¹Ÿé¿å…äº†å¹¶è¡Œçš„ç®¡ç†å¼€é”€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="äº”å…·ä½“å®ç°traj-dist-rsçš„æ€§èƒ½é­”æ³•"&gt;äº”ã€å…·ä½“å®ç°ï¼štraj-dist-rsçš„æ€§èƒ½é­”æ³•
&lt;/h2&gt;&lt;p&gt;è¯´äº†è¿™ä¹ˆå¤šï¼Œæ ¸å¿ƒè¿˜æ˜¯è¦è®²&lt;code&gt;traj-dist-rs&lt;/code&gt;ä¸ºäº†æ‰¹é‡è¿ç®—ï¼Œåšäº†å“ªäº›å·¥ä½œã€‚&lt;/p&gt;
&lt;h3 id="51-rayonä¸€è¡Œä»£ç è§£é”å¹¶è¡Œ"&gt;5.1 Rayonï¼šä¸€è¡Œä»£ç è§£é”å¹¶è¡Œ
&lt;/h3&gt;&lt;p&gt;æœ€æ ¸å¿ƒçš„åœ°æ–¹å°±åœ¨äºrayonã€‚å› ä¸º&lt;code&gt;traj-dist-rs&lt;/code&gt;å·²ç»æ”¯æŒäº†é›¶æ‹·è´è¯»å–pythonä¸­çš„numpy.ndarrayï¼Œé‚£ä¹ˆåªéœ€è¦å¾ˆç®€å•çš„ä½¿ç”¨rayonåšå¹¶è¡Œè®¡ç®—å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;compute_pdist_parallel&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;D&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trajectories&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;calculator&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;D&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Vec&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;where&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;: &lt;span class="nc"&gt;CoordSequence&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Sync&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;D&lt;/span&gt;: &lt;span class="nc"&gt;Distance&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;trajectories&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Create index pairs for all unique pairs (i, j) where i &amp;lt; j
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pairs&lt;/span&gt;: &lt;span class="nb"&gt;Vec&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;..&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flat_map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;..&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;move&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;collect&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Compute distances in parallel using Rayon&amp;#39;s global thread pool
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;into_par_iter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;calculator&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;distance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;trajectories&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;trajectories&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;collect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å°±è¿™ä¹ˆç®€å•ï¼Œæ ¸å¿ƒå°±æ˜¯å¼•å…¥&lt;code&gt;into_par_iter&lt;/code&gt;ï¼Œç„¶åå°±è‡ªåŠ¨å¹¶è¡Œäº†ã€‚è¿™é‡Œçš„&lt;code&gt;Distance&lt;/code&gt;æä¾›äº†ä¸€ä¸ªå«distanceçš„æ–¹æ³•ï¼Œç”¨äºè®¡ç®—ä¸¤æ¡è½¨è¿¹ä¹‹é—´çš„è·ç¦»ï¼Œæ¯”å¦‚dtwï¼Œedrç­‰ç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä»pythoné‡Œé¢ä¼ é€’ç»™rustçš„æ˜¯ä¸€ä¸ª&lt;code&gt;List[np.ndarray]&lt;/code&gt;ï¼Œrustæ‹¿åˆ°ä¹‹åå°†å…¶è½¬æ¢ä¸º&lt;code&gt;&amp;amp;[CoordSequence]&lt;/code&gt;å¯¹åº”çš„å…·ä½“ç±»å‹ï¼Œå°±å¯ä»¥å¤ç”¨è¿™ä¸ªå¹¶è¡Œè®¡ç®—çš„pdistå‡½æ•°äº†ã€‚è‡³äº&lt;code&gt;np.ndarray&lt;/code&gt;å¦‚ä½•è½¬&lt;code&gt;CoordSequence&lt;/code&gt;ï¼Œè¿™ä¸ªå°±æ˜¯ä¸Šæ¬¡è®²çš„ï¼Œé€šè¿‡PyO3å–å‡º&lt;code&gt;ndarray&lt;/code&gt;åº•å±‚çš„åˆ‡ç‰‡ï¼Œç„¶åå°è£…åˆ°ä¸€ä¸ªå®ç°äº†&lt;code&gt;CoordSequence&lt;/code&gt;è¿™ä¸ªtraitçš„structé‡Œé¢å°±å¯ä»¥äº†ã€‚é‚£&lt;code&gt;List&lt;/code&gt;å¦‚ä½•è½¬&lt;code&gt;&amp;amp;[]&lt;/code&gt;ï¼Œè¿™ä¸ªå°±ä¸ç”¨è¯´äº†ã€‚&lt;/p&gt;
&lt;h3 id="52-bincodeä¸ºpickleåºåˆ—åŒ–åŠ é€Ÿ"&gt;5.2 Bincodeï¼šä¸ºPickleåºåˆ—åŒ–åŠ é€Ÿ
&lt;/h3&gt;&lt;p&gt;å› ä¸º&lt;code&gt;traj-dist-rs&lt;/code&gt;æ”¯æŒpythonï¼Œæ‰€ä»¥ä¸€å®šè¦è€ƒè™‘ç±»ä¼¼ä¸Šé¢é€šè¿‡multiprocessingæˆ–è€…joblibå®ç°å¤šè¿›ç¨‹å¹¶è¡Œçš„æ–¹æ¡ˆã€‚é‚£ä¹ˆå¯¹äºç”¨æˆ·æ¥è¯´ï¼Œpickleåºåˆ—åŒ–çš„æ€§èƒ½å°±å¾ˆå…³é”®ã€‚è€ƒè™‘åˆ°&lt;code&gt;traj-dist-rs&lt;/code&gt;é‡Œé¢çš„åŠ¨æ€è§„åˆ’ç®—æ³•è¿”å›çš„ç±»å‹éƒ½æ˜¯ä¸€ä¸ªRustå®šä¹‰çš„&lt;code&gt;PyDpResult&lt;/code&gt;ï¼Œé‚£ä¹ˆå¯¹è¿™ä¸ªç±»å‹çš„åºåˆ—åŒ–æ€§èƒ½åšæå‡å°±å¾ˆé‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆè¯´ä¸€ä¸‹è¿™é‡Œæ˜¯æ€ä¹ˆè®¾è®¡çš„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è€ƒè™‘åˆ°åŠ¨æ€è§„åˆ’ç®—æ³•çš„è¿”å›å€¼æœ‰ä¸€ä¸ªç»“æœï¼Œè¿˜å¯èƒ½æœ‰å®Œæ•´çš„åŠ¨æ€è§„åˆ’çŸ©é˜µç”¨äºå›æº¯è·¯å¾„ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;å®šä¹‰äº†ä¸€ä¸ª&lt;code&gt;DpResult&lt;/code&gt;çš„structå°è£…äº†è¿™ä¸¤ä¸ªå€¼ã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘åˆ°&lt;code&gt;traj-dist-rs&lt;/code&gt;æ˜¯åŒæ—¶æ”¯æŒRustå’ŒPythonä¸¤ç§è¯­è¨€çš„ï¼Œå¹¶ä¸”æä¾›äº†&lt;code&gt;python-binding&lt;/code&gt;è¿™ä¸ªfeatureï¼Œç”¨äºé¢å¤–ç¼–è¯‘é€‚é…Pythonçš„å‡½æ•°å’Œç±»å‹ã€‚å› æ­¤ç›´æ¥å°†&lt;code&gt;DpResult&lt;/code&gt;æš´éœ²ç»™Pythonç¯å¢ƒä¸åˆç†ï¼Œå› æ­¤éœ€è¦å†å®šä¹‰ä¸€ä¸ª&lt;code&gt;PyDpResult&lt;/code&gt;çš„structæš´éœ²ç»™pythonï¼Œè€Œå®ƒåªæœ‰ä¸€ä¸ªå«innerçš„å±æ€§ï¼Œç±»å‹æ˜¯&lt;code&gt;DpResult&lt;/code&gt;ï¼Œè¿™æ ·Rustç”¨æˆ·ç”¨çš„æ˜¯&lt;code&gt;DpResult&lt;/code&gt;ï¼Œè€Œpythonç”¨æˆ·ç”¨çš„æ˜¯&lt;code&gt;PyDpResult&lt;/code&gt;ï¼Œä¸¤è€…äº’ä¸å¹²æ‰°ï¼Œå……åˆ†è§£è€¦ã€‚&lt;/li&gt;
&lt;li&gt;é‚£ä¹ˆç”¨æˆ·åœ¨pythonå¤šè¿›ç¨‹ç¯å¢ƒä¸­è¿è¡ŒåŠ¨æ€è§„åˆ’ç±»ç®—æ³•çš„æ—¶å€™ï¼Œå°±ä¼šé¢ä¸´è¿”å›å€¼åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯&lt;code&gt;PyDpResult&lt;/code&gt;çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œè¿™é‡Œå¾ˆç®€å•ï¼Œå®ç°&lt;code&gt;__reduce__&lt;/code&gt;æ¥å£å³å¯ï¼Œé‚£è¦æŠŠä»€ä¹ˆä¸œè¥¿è¿”å›ç»™pythonå‘¢ï¼Œå…¶å®å°±æ˜¯æŠŠ&lt;code&gt;DpResult&lt;/code&gt;è¿™ä¸ªstructåºåˆ—åŒ–ä¸ºå­—èŠ‚ï¼Œä¼ é€’ç»™pythonï¼Œpythonæ‹¿åˆ°å­—èŠ‚å†ååºåˆ—åŒ–ä¸º&lt;code&gt;DpResult&lt;/code&gt;ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª&lt;code&gt;PyDpResult&lt;/code&gt;å°†å…¶å°è£…å³å¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å› æ­¤è¿™é‡Œæœ€å¤§çš„å¼€é”€å°±æ˜¯å¯¹&lt;code&gt;DpResult&lt;/code&gt;çš„åºåˆ—åŒ–ï¼Œè¿™é‡Œä½¿ç”¨bincodeï¼Œå°†å…¶åºåˆ—åŒ–ä¸ºå­—èŠ‚ï¼Œè¿™æ˜¯æˆ‘æ‰¾åˆ°çš„æœ€å¿«çš„æ–¹æ¡ˆï¼Œç›¸æ¯”serde_jsonè‚¯å®šæ˜¯å¿«å¾ˆå¤šçš„ã€‚å¦‚æœå¤§å®¶æœ‰å…¶ä»–æ–¹æ¡ˆä¹Ÿå¯ä»¥å’Œæˆ‘äº¤æµã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„æºç æ˜¯&lt;code&gt;PyDpResult&lt;/code&gt;çš„ä»£ç ï¼Œçœç•¥äº†ä¸€äº›ä¸æœ¬æ–‡æ— å…³çš„å†…å®¹ï¼Œå±•ç¤ºäº†å¦‚ä½•è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;span class="lnt"&gt;44
&lt;/span&gt;&lt;span class="lnt"&gt;45
&lt;/span&gt;&lt;span class="lnt"&gt;46
&lt;/span&gt;&lt;span class="lnt"&gt;47
&lt;/span&gt;&lt;span class="lnt"&gt;48
&lt;/span&gt;&lt;span class="lnt"&gt;49
&lt;/span&gt;&lt;span class="lnt"&gt;50
&lt;/span&gt;&lt;span class="lnt"&gt;51
&lt;/span&gt;&lt;span class="lnt"&gt;52
&lt;/span&gt;&lt;span class="lnt"&gt;53
&lt;/span&gt;&lt;span class="lnt"&gt;54
&lt;/span&gt;&lt;span class="lnt"&gt;55
&lt;/span&gt;&lt;span class="lnt"&gt;56
&lt;/span&gt;&lt;span class="lnt"&gt;57
&lt;/span&gt;&lt;span class="lnt"&gt;58
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;/// Python wrapper for the Rust DpResult struct
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;/// This class wraps the Rust DpResult and provides Python-friendly access
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;/// to the distance and optional matrix.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[cfg(feature = &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;python-binding&amp;#34;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[gen_stub_pyclass]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[pyclass(name = &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;DpResult&amp;#34;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;PyDpResult&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// The inner Rust DpResult
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inner&lt;/span&gt;: &lt;span class="nc"&gt;crate&lt;/span&gt;::&lt;span class="n"&gt;distance&lt;/span&gt;::&lt;span class="n"&gt;DpResult&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[cfg(feature = &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;python-binding&amp;#34;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[gen_stub_pymethods]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[pymethods]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyDpResult&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Pickle serialization support using __reduce__
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Uses bincode to serialize the entire DpResult::inner as bytes for better performance.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Returns a tuple (callable, args) that pickle can use to reconstruct the object.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;__reduce__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;: &lt;span class="nc"&gt;Python&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;PyResult&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Py&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;PyAny&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Py&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;PyAny&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Py&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;PyAny&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pyo3&lt;/span&gt;::&lt;span class="n"&gt;prelude&lt;/span&gt;::&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pyo3&lt;/span&gt;::&lt;span class="n"&gt;types&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;PyBytes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyTuple&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Import the module and get the helper function
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;module&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;import&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;traj_dist_rs&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;helper_func&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;module&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;__dp_result_from_pickle&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Serialize the entire DpResult using bincode
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;serialized&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bincode&lt;/span&gt;::&lt;span class="n"&gt;encode_to_vec&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;inner&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bincode&lt;/span&gt;::&lt;span class="n"&gt;config&lt;/span&gt;::&lt;span class="n"&gt;standard&lt;/span&gt;&lt;span class="p"&gt;()).&lt;/span&gt;&lt;span class="n"&gt;map_err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pyo3&lt;/span&gt;::&lt;span class="n"&gt;exceptions&lt;/span&gt;::&lt;span class="n"&gt;PyRuntimeError&lt;/span&gt;::&lt;span class="n"&gt;new_err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="fm"&gt;format!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Serialization failed: &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Create args tuple containing the serialized bytes
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bytes_py&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyBytes&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;serialized&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args_tuple&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyTuple&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;bytes_py&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_any&lt;/span&gt;&lt;span class="p"&gt;()])&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Return (helper_func, args, state) where state is None
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;helper_func&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unbind&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args_tuple&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unbind&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nb"&gt;None&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;/// Helper function to create DpResult from pickle data
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;/// Deserializes the DpResult from bincode-encoded bytes.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[cfg(feature = &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;python-binding&amp;#34;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[gen_stub_pyfunction]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[pyfunction]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;__dp_result_from_pickle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="cp"&gt;#[gen_stub(override_type(type_repr = &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;bytes&amp;#34;&lt;/span&gt;&lt;span class="cp"&gt;))]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;u8&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;PyResult&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;PyDpResult&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bincode&lt;/span&gt;::&lt;span class="n"&gt;decode_from_slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bincode&lt;/span&gt;::&lt;span class="n"&gt;config&lt;/span&gt;::&lt;span class="n"&gt;standard&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dp_result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyDpResult&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inner&lt;/span&gt;: &lt;span class="nc"&gt;dp_result&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map_err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pyo3&lt;/span&gt;::&lt;span class="n"&gt;exceptions&lt;/span&gt;::&lt;span class="n"&gt;PyRuntimeError&lt;/span&gt;::&lt;span class="n"&gt;new_err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="fm"&gt;format!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Deserialization failed: &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™æ ·å®ç°çš„åºåˆ—åŒ–æ¥å£ï¼Œå°±å¯ä»¥ä½¿&lt;code&gt;PyDpResult&lt;/code&gt;è¾¾åˆ°ä¸€ä¸ªæ¯”è¾ƒå¥½çš„åºåˆ—åŒ–æ€§èƒ½äº†ï¼Œè¿™æ ·ä¹Ÿå°±å¯ä»¥å¸®åŠ©Pythonå¤šè¿›ç¨‹ç¯å¢ƒä¸‹çš„æ€§èƒ½æå‡äº†ã€‚&lt;/p&gt;
&lt;h2 id="å…­å®æˆ˜traj-dist-rsæå‡trajclçš„æ•°æ®é¢„å¤„ç†æ€§èƒ½"&gt;å…­ã€å®æˆ˜ï¼š&lt;code&gt;traj-dist-rs&lt;/code&gt;æå‡&lt;code&gt;TrajCL&lt;/code&gt;çš„æ•°æ®é¢„å¤„ç†æ€§èƒ½
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;TrajCL&lt;/code&gt;æ˜¯ä¸€ä¸ªç”¨äºä½¿ç”¨æ·±åº¦å­¦ä¹ ç®—æ³•è¿‘ä¼¼è½¨è¿¹ç›¸ä¼¼åº¦çš„æ–¹æ³•ï¼š&amp;ldquo;TrajCL: Contrastive Trajectory Similarity Learning with Dual-Feature Attention&amp;rdquo;ã€‚åœ¨è®ºæ–‡ä½œè€…çš„&lt;a class="link" href="https://github.com/changyanchuan/TrajCL/blob/master/utils/preprocessing_porto.py" target="_blank" rel="noopener"
&gt;å¼€æºä»£ç &lt;/a&gt;é‡Œé¢ï¼Œæä¾›äº†å¯¹portoæ•°æ®é›†ä¸­è½¨è¿¹ç›¸ä¼¼åº¦çš„è®¡ç®—ï¼Œä½¿ç”¨&lt;code&gt;traj-dist&lt;/code&gt;+pythonå¤šè¿›ç¨‹å®Œæˆã€‚æˆ‘ä»¬è¿™é‡Œå°†ä½œè€…çš„æºä»£ç å–å‡ºå¹¶ä½œè½»é‡ä¼˜åŒ–ï¼Œä¸æˆ‘ä»¬çš„&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„&lt;code&gt;pdist&lt;/code&gt;å¹¶è¡Œç‰ˆåšæ€§èƒ½å¯¹æ¯”ã€‚&lt;/p&gt;
&lt;p&gt;ä½œè€…ä»portoæ•°æ®é›†ä¸­æŒ‘é€‰äº†è½¨è¿¹é•¿åº¦åœ¨20åˆ°200ä¹‹é—´çš„åºåˆ—ï¼Œé€‰å‡º7000æ¡ä½œä¸ºè®­ç»ƒé›†ï¼Œè®¡ç®—è¿™7000æ¡çŸ©é˜µä¹‹é—´çš„è·ç¦»ï¼ˆä¸Šä¸‰è§’ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘åˆ›å»ºäº†ä¸€ä¸ª4æ ¸8Gçš„podï¼Œå¯¹è¿™7000æ¡è½¨è¿¹è¿›è¡Œdtwè®¡ç®—ï¼Œæµ‹è¯•ä¸‹æ¥çš„æ•ˆæœå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;tool&lt;/th&gt;
&lt;th&gt;running time(s)&lt;/th&gt;
&lt;th&gt;speedup&lt;/th&gt;
&lt;th&gt;Peak Memory (MB)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;2932.84s&lt;/td&gt;
&lt;td&gt;1x&lt;/td&gt;
&lt;td&gt;1061.68 MB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;92.21s&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;31.81x&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;642.11 MB&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„&lt;code&gt;pdist&lt;/code&gt;å‡½æ•°ï¼Œå¯ä»¥è®©ä¹‹å‰çš„æ•°æ®é¢„å¤„ç†éƒ¨åˆ†æ€§èƒ½æå‡31.8å€ï¼Œæ•ˆæœæå‡å¾ˆæ˜æ˜¾ï¼Œè€Œä¸”å†…å­˜ç”¨é‡æ˜æ˜¾æ›´å°‘ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯&lt;code&gt;traj-dist-rs&lt;/code&gt;æµ‹è¯•ç”¨çš„æºç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;polars&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pl&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;traj_dist_rs&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Metric&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pdist&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_trajs&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_parquet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;trajcl_samples.parquet&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;start_idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;trajs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;seq&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_numpy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;start_idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_idx&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;trajs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_trajs&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pdist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;metric&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Metric&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dtw&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;parallel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸‹é¢è¿™æ˜¯ä»è®ºæ–‡ä½œè€…ä»£ç ä¸­æˆªå–å‡ºæ¥ï¼Œå¹¶åšäº†ä¸€äº›æ€§èƒ½ä¼˜åŒ–çš„ä»£ç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;span class="lnt"&gt;44
&lt;/span&gt;&lt;span class="lnt"&gt;45
&lt;/span&gt;&lt;span class="lnt"&gt;46
&lt;/span&gt;&lt;span class="lnt"&gt;47
&lt;/span&gt;&lt;span class="lnt"&gt;48
&lt;/span&gt;&lt;span class="lnt"&gt;49
&lt;/span&gt;&lt;span class="lnt"&gt;50
&lt;/span&gt;&lt;span class="lnt"&gt;51
&lt;/span&gt;&lt;span class="lnt"&gt;52
&lt;/span&gt;&lt;span class="lnt"&gt;53
&lt;/span&gt;&lt;span class="lnt"&gt;54
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;math&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;multiprocessing&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;mp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;typing&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;polars&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pl&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;traj_dist.distance&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;tdist&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# ä¼˜åŒ– 1ï¼šç›´æ¥æ¥æ”¶ List[np.ndarray]ï¼ŒæŠ›å¼ƒ Pandas DataFrame&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_simi_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ndarray&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;]]:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tasks&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ceil&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ceil&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# ä¼˜åŒ– 2ï¼šæŠŠåŸæœ¬ä¼  DataFrame æ”¹ä¸ºä¼  trajs åˆ—è¡¨&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)))))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;num_cores&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cpu_count&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pool&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pool&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_cores&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;lst_simi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pool&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;starmap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_simi_comp_operator&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pool&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;lst_simi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_simi_comp_operator&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ndarray&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;sub_idx&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;simi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sub_idx&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t_i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;_i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# ä¼˜åŒ– 3ï¼šç›´æ¥ List ç´¢å¼•ï¼ŒO(1) ä¸”æå¿«ï¼Œå¹²æ‰ .iloc&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;simi_row&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t_j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;_j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# åŒä¸Š&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;simi_row&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t_i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t_j&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;simi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;simi_row&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;simi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_trajs&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# ç»Ÿä¸€ä½¿ç”¨ polars è¯»å–ï¼Œä¿è¯æ•°æ®å‡†å¤‡é˜¶æ®µç»å¯¹å…¬å¹³&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_parquet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;trajcl_samples.parquet&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;start_idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;trajs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;seq&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_numpy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;start_idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_idx&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;trajs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_trajs&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;# è®¡æ—¶å¼€å§‹ï¼ˆä¸åŒ…å«æ•°æ®è¯»å–éƒ¨åˆ†ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;_simi_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tdist&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dtw&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;Optimized Baseline Time: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;s&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id="ä¸ƒæ€»ç»“"&gt;ä¸ƒã€æ€»ç»“
&lt;/h2&gt;&lt;p&gt;è¿™æ¬¡æ‰¹é‡è®¡ç®—çš„æ€§èƒ½ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œæœ‰å‡ ä¸ªå®è´µçš„ç»éªŒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç“¶é¢ˆè½¬ç§»ï¼šä¼˜åŒ–å®Œæ ¸å¿ƒç®—æ³•ï¼ˆRust/Cythonï¼‰åï¼Œç“¶é¢ˆä¼šè½¬ç§»åˆ°Pythonçš„è°ƒç”¨å±‚ï¼ˆå¾ªç¯ã€GILã€æ•°æ®å¤åˆ¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;â€œæ‰¹å¤„ç†â€ä¸‹æ²‰ï¼šå¯¹äºæ‰¹é‡è®¡ç®—ä»»åŠ¡ï¼Œæœ€å¥½çš„æ–¹å¼æ˜¯è®¾è®¡ä¸€ä¸ªèƒ½æ¥æ”¶æ•´ä¸ªæ•°æ®é›†çš„åº•å±‚å‡½æ•°ï¼Œå°†å¾ªç¯å’Œè°ƒåº¦å®Œå…¨ä¸‹æ²‰åˆ°é«˜æ€§èƒ½è¯­è¨€ï¼ˆRust/C++ï¼‰ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;å¹¶è¡Œæ¨¡å‹çš„é€‰æ‹©ï¼šåœ¨Rustä¸­ï¼ŒåŸºäºå…±äº«å†…å­˜çš„å¤šçº¿ç¨‹å¹¶è¡Œé€šå¸¸æ›´ä¼˜äºPythonä¸­åŸºäºåºåˆ—åŒ–çš„å¤šè¿›ç¨‹å¹¶è¡Œï¼Œå°¤å…¶æ˜¯åœ¨æ•°æ®é‡å¤§æ—¶ã€‚&lt;/li&gt;
&lt;li&gt;å¹¶è¡ŒåŒ–ä¸æ˜¯ä¸‡é‡‘æ²¹ï¼šå¹¶è¡ŒåŒ–æœ‰å…¶è‡ªèº«å¼€é”€ã€‚å¯¹äºè®¡ç®—é‡æå°çš„ä»»åŠ¡ï¼Œä¸²è¡Œå°±æ˜¯æœ€å¥½çš„æ–¹æ¡ˆã€‚åœ¨è®¾è®¡çš„æ—¶å€™å°±åº”è¯¥ç»™ç”¨æˆ·æä¾›ä¸²è¡Œå’Œå¹¶è¡Œçš„æ¥å£ï¼Œè®©ç”¨æˆ·è‡ªå·±é€‰æ‹©ã€‚&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>æ€§èƒ½æå‡10å€ï¼æˆ‘ç”¨Rusté‡å†™Pythonè½¨è¿¹è·ç¦»è®¡ç®—åº“çš„å®è·µåˆ†äº«</title><link>https://davidham3.github.io/blog/p/%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%8710%E5%80%8D%E6%88%91%E7%94%A8rust%E9%87%8D%E5%86%99python%E8%BD%A8%E8%BF%B9%E8%B7%9D%E7%A6%BB%E8%AE%A1%E7%AE%97%E5%BA%93%E7%9A%84%E5%AE%9E%E8%B7%B5%E5%88%86%E4%BA%AB/</link><pubDate>Sun, 08 Feb 2026 23:18:49 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%8710%E5%80%8D%E6%88%91%E7%94%A8rust%E9%87%8D%E5%86%99python%E8%BD%A8%E8%BF%B9%E8%B7%9D%E7%A6%BB%E8%AE%A1%E7%AE%97%E5%BA%93%E7%9A%84%E5%AE%9E%E8%B7%B5%E5%88%86%E4%BA%AB/</guid><description>&lt;p&gt;æœ€è¿‘åœ¨åšè½¨è¿¹æ•°æ®åˆ†æç›¸å…³çš„é¡¹ç›®ï¼Œéœ€è¦è®¡ç®—è½¨è¿¹ä¹‹é—´çš„è·ç¦»ã€‚ä¸€å¼€å§‹ç”¨çš„æ˜¯ &lt;code&gt;traj-dist&lt;/code&gt; è¿™ä¸ª Python åŒ…ï¼Œå®ƒæä¾›äº†å¤šç§è½¨è¿¹è·ç¦»ç®—æ³•çš„å®ç°ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œå› ä¸ºæ˜¯é€šè¿‡CythonåŠ é€Ÿçš„ã€‚ä½†æ˜¯è¿™ä¸ªåŒ…æœ‰ç‚¹å¤ªè€äº†ï¼Œå®‰è£…èµ·æ¥å¾ˆéº»çƒ¦ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘æƒ³ç€èƒ½ä¸èƒ½ç”¨ Rust é‡å†™ä¸€éï¼Œä¸€æ˜¯ä¸ºäº†é€‚é…æ›´æ–°çš„pythonç‰ˆæœ¬ï¼ŒäºŒæ˜¯ä¸ºäº†å°è¯•â€œç”¨rusté‡å†™ä¸€åˆ‡â€ã€‚&lt;/p&gt;
&lt;p&gt;å®ç°å®Œäº†ä¹‹åæµ‹è¯•äº†ä¸€ä¸‹æ€§èƒ½ï¼Œå“äº†ä¸€è·³ï¼šç›¸æ¯” &lt;code&gt;traj-dist&lt;/code&gt; çš„ Python å®ç°ï¼Œæ€§èƒ½æå‡äº† 389 å€ï¼Œç›¸æ¯” Cython å®ç°ä¹Ÿæå‡äº† 10 å€ã€‚æœ¬æ–‡æˆ‘ä¼šåˆ†äº«ä¸€ä¸‹è¿™ä¸ªé¡¹ç›®çš„ä¸€äº›ç»éªŒå’Œè¸©è¿‡çš„å‘ã€‚&lt;/p&gt;
&lt;h2 id="ä¸€ä¸ºä»€ä¹ˆè¦é‡å†™"&gt;ä¸€ã€ä¸ºä»€ä¹ˆè¦é‡å†™
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;traj-dist&lt;/code&gt; æ˜¯ä¸€ä¸ªæŒºä¸é”™çš„åŒ…ï¼Œæä¾›äº†å¤šç§ä¸»æµçš„è½¨è¿¹è·ç¦»ç®—æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SSPDï¼ˆå¯¹ç§°æ®µè·¯å¾„è·ç¦»ï¼‰&lt;/li&gt;
&lt;li&gt;DTWï¼ˆåŠ¨æ€æ—¶é—´è§„æ•´ï¼‰&lt;/li&gt;
&lt;li&gt;Hausdorff è·ç¦»&lt;/li&gt;
&lt;li&gt;LCSSï¼ˆæœ€é•¿å…¬å…±å­åºåˆ—ï¼‰&lt;/li&gt;
&lt;li&gt;EDRï¼ˆå®æ•°åºåˆ—ç¼–è¾‘è·ç¦»ï¼‰&lt;/li&gt;
&lt;li&gt;ERPï¼ˆå¸¦å®æ•°æƒ©ç½šçš„ç¼–è¾‘è·ç¦»ï¼‰&lt;/li&gt;
&lt;li&gt;Discret FrÃ©chet è·ç¦»&lt;/li&gt;
&lt;li&gt;è¿˜æœ‰å¾ˆå¤šï¼Œæˆ‘è¿˜æ²¡æœ‰é‡å†™&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ”¯æŒæ¬§å‡ é‡Œå¾—è·ç¦»å’Œçƒé¢è·ç¦»ï¼ˆHaversineï¼‰ï¼ŒAPI è®¾è®¡å¾—å¾ˆç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œæ ¸å¿ƒç—›ç‚¹æ˜¯è¿™ä¸ªåŒ…çš„å®‰è£…æ¯”è¾ƒéº»çƒ¦ï¼Œæˆ‘å°è¯•è¿‡åœ¨python3.12ä¸Šå®‰è£…ï¼Œä½†æ˜¯å‘ç°å®ƒçš„ä¾èµ–å¤ªè€ã€‚è€Œä¸”æ¯æ¬¡å®‰è£…éƒ½éœ€è¦ç¼–è¯‘Cythonä»£ç ã€‚ä¸ºæ­¤æˆ‘å¸Œæœ›æœ‰ä¸€ä¸ªå®‰è£…ç®€å•ï¼Œè€Œä¸”ä¾èµ–æ¯”è¾ƒå°‘çš„åŒ…å‡ºç°ã€‚&lt;/p&gt;
&lt;h2 id="äºŒé‡å†™æ€è·¯"&gt;äºŒã€é‡å†™æ€è·¯
&lt;/h2&gt;&lt;p&gt;æˆ‘å…ˆè¯´ä¸€ä¸‹æˆ‘çš„é‡å†™æ€è·¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¡®å®šéœ€è¦é‡å†™çš„ç®—æ³•ï¼šé¦–å…ˆæˆ‘åœ¨&lt;code&gt;traj-dist&lt;/code&gt;é‡Œé¢æŒ‘é€‰äº†ä¸€äº›ç®€å•çš„ç®—æ³•ï¼š
&lt;ul&gt;
&lt;li&gt;LCSSã€DTWã€discrete frechetã€EDRã€ERPï¼Œè¿™äº›éƒ½æ˜¯åŠ¨æ€è§„åˆ’ç®—æ³•&lt;/li&gt;
&lt;li&gt;hausdorffï¼Œsspdï¼Œè¿™ä¸¤ä¸ªç®—æ³•æ˜¯éåŠ¨æ€è§„åˆ’çš„ç®—æ³•ï¼Œå®ç°èµ·æ¥ç›¸å¯¹ç®€å•&lt;/li&gt;
&lt;li&gt;å…¶ä»–ç®—æ³•çš„å®ç°ç¨å¾®å¤æ‚äº†ä¸€äº›ï¼Œå°±ç•™åœ¨åé¢çš„ç‰ˆæœ¬äº†&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä»¥&lt;code&gt;traj-dist&lt;/code&gt;ä¸ºground truthï¼šæˆ‘å‘ç°ä½œè€…åœ¨ä»£ç ä»“åº“é‡Œé¢æä¾›äº†ä¸€ä¸ªå¾ˆå°çš„è½¨è¿¹æ•°æ®é›†ï¼Œå¹¶ä¸”ä½œè€…è‡ªå·±åœ¨ä¸Šé¢è¿›è¡Œäº†æ€§èƒ½æµ‹è¯•ï¼Œé‚£æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ•°æ®é›†ï¼Œä½¿ç”¨&lt;code&gt;traj-dist&lt;/code&gt;åœ¨ä¸Šé¢å®Œæˆä¸Šé¢7ä¸ªç®—æ³•çš„è®¡ç®—ï¼Œè®°å½•ç»“æœä¸è€—æ—¶ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨rusté‡å†™ä¸Šè¿°7ä¸ªç®—æ³•ï¼Œrusté‡Œé¢ä½¿ç”¨traitè¡¨ç¤ºç»çº¬åº¦ç‚¹å’Œè½¨è¿¹ï¼Œä¸ºå…¶ä»–äººä½¿ç”¨è¿™ä¸ªåŒ…æä¾›æ‰©å±•æ€§ã€‚åŒæ—¶ä¸ºrustç¼–å†™å•å…ƒæµ‹è¯•ç”¨ä¾‹ï¼Œä¿è¯å…¶APIéƒ½æ˜¯å¯ç”¨çš„ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºrustçš„ç®—æ³•å’Œtraitå®šä¹‰pythonç›¸å…³çš„ç±»å‹å’Œç®—æ³•ï¼Œæš´éœ²ç»™pythonã€‚åŒæ—¶ä¸ºpythonéƒ¨åˆ†ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œä¸€æ–¹é¢ä¿è¯APIå¯ç”¨ï¼Œå¦ä¸€æ–¹é¢ä¸ä¸Šé¢çš„ground truthåšå¯¹æ¯”ï¼Œç¡®ä¿æ¯ä¸ªç®—æ³•çš„è®¡ç®—ç»“æœä¸ground truthçš„ç»“æœåå·®å€¼åœ¨1e-8ä»¥å†…ã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºground truthé‡Œé¢å¸¦äº†&lt;code&gt;traj-dist&lt;/code&gt;çš„æ€§èƒ½ï¼Œå› æ­¤&lt;code&gt;traj-dist-rs&lt;/code&gt;ä¹Ÿå¯ä»¥å¾ˆè½»æ¾åœ°åšå‡ºæ€§èƒ½å¯¹æ¯”ï¼Œå¾—åˆ°rustç›¸å¯¹äºpythonå’Œcythonçš„æ€§èƒ½æå‡æ¯”ä¾‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="ä¸‰æ€§èƒ½æµ‹è¯•ç»“æœ"&gt;ä¸‰ã€æ€§èƒ½æµ‹è¯•ç»“æœ
&lt;/h2&gt;&lt;p&gt;æ€§èƒ½æµ‹è¯•è¿™é‡Œï¼Œé¦–å…ˆéšæœºé€‰1000ä¸ªè½¨è¿¹pairï¼Œæ¯ä¸ªæ ·æœ¬é¢„çƒ­10æ¬¡ï¼Œæ­£å¼æµ‹é‡50æ¬¡ï¼Œè®°å½•è¿™50æ¬¡çš„æ˜ç»†æ—¶é—´ï¼Œå¹¶ç»Ÿè®¡ä¸­ä½æ•°ã€Coefficient of Variationç­‰å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ä¼šç”¨&lt;code&gt;traj-dist&lt;/code&gt;çš„pythonç‰ˆæœ¬ã€cythonç‰ˆæœ¬ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„pythonç‰ˆæœ¬è¿è¡Œç›¸åŒçš„æµ‹è¯•ç”¨ä¾‹ï¼Œè®°å½•å‡å€¼ã€æ ‡å‡†å·®ã€CVå€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯å…·ä½“çš„æå‡æ•ˆæœï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;EUCLIDEAN è·ç¦»&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Rust vs Cython&lt;/strong&gt;: å¹³å‡æå‡ 9.99x (èŒƒå›´: 6.06x - 16.13x)&lt;/li&gt;
&lt;li&gt;Rust vs Python: å¹³å‡æå‡ 389.07x (èŒƒå›´: 187.20x - 594.74x)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½³æ€§èƒ½æå‡ç®—æ³•&lt;/strong&gt;: sspd (16.13x)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;SPHERICAL è·ç¦»&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Rust vs Cython&lt;/strong&gt;: å¹³å‡æå‡ 2.66x (èŒƒå›´: 1.62x - 5.24x)&lt;/li&gt;
&lt;li&gt;Rust vs Python: å¹³å‡æå‡ 75.67x (èŒƒå›´: 41.13x - 167.14x)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½³æ€§èƒ½æå‡ç®—æ³•&lt;/strong&gt;: erp (5.24x)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸ªç»“æœæ¯”æˆ‘é¢„æœŸçš„è¦å¥½å¾ˆå¤šã€‚ç›¸æ¯” Python å®ç°æå‡ 389 å€ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸º Rust æ²¡æœ‰è§£é‡Šå™¨å¼€é”€ï¼ŒåƒåŠ¨æ€è§„åˆ’ç®—æ³•è¿™ç§éœ€è¦åŒé‡forå¾ªç¯çš„ç®—æ³•ï¼Œpythonä¸€å®šæ˜¯éå¸¸æ…¢çš„ï¼Œè€Œä¸”rustçš„ç¼–è¯‘å™¨èƒ½åšå¾ˆå¤šä¼˜åŒ–ã€‚ç›¸æ¯” Cython å®ç°æå‡ 10 å€ï¼Œè¿™éƒ¨åˆ†ä¸»è¦æ˜¯æ•°æ®æ‹·è´å¸¦æ¥çš„ï¼Œrustçš„å®ç°ä¸­ä½¿ç”¨äº†numpy+é›¶æ‹·è´çš„æ–¹æ¡ˆï¼Œé¿å…äº†æ•°æ®å¤åˆ¶ï¼Œè®ºè®¡ç®—æ€§èƒ½æ¥è¯´ï¼Œrustå’Œcythonç”Ÿæˆçš„cä»£ç ï¼Œæœ¬è´¨ä¸Šåº”è¯¥ä¸ä¼šæœ‰å¤ªå¤§åŒºåˆ«ã€‚&lt;/p&gt;
&lt;p&gt;è‡³äºæ¬§æ°è·ç¦»ä¸Šçš„æ€§èƒ½æå‡è¿œå¤§äºçƒé¢è·ç¦»çš„æå‡ï¼Œè¿™æ˜¯å› ä¸ºæ¬§æ°è·ç¦»çš„è®¡ç®—å¤ªç®€å•ï¼Œ&amp;ldquo;è¯­è¨€æ•ˆç‡&amp;quot;æˆä¸ºç“¶é¢ˆï¼ŒRust ä¼˜åŠ¿æ˜æ˜¾ï¼›çƒé¢è·ç¦»çš„è®¡ç®—å¤ªå¤æ‚ï¼Œ&amp;ldquo;æ•°å­¦è®¡ç®—&amp;quot;æˆä¸ºç“¶é¢ˆï¼ŒRust ä¼˜åŠ¿è¢«ç¨€é‡Šã€‚&lt;/p&gt;
&lt;h2 id="å››æ¶æ„è®¾è®¡"&gt;å››ã€æ¶æ„è®¾è®¡
&lt;/h2&gt;&lt;p&gt;æ¥ä¸‹æ¥è¯´ä¸€ä¸‹æ¶æ„çš„è®¾è®¡ï¼Œæ ¸å¿ƒæœ‰å‡ ä¸ªå†…å®¹å§ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;rustæ¥å£è®¾è®¡&lt;/li&gt;
&lt;li&gt;åŠ¨æ€è§„åˆ’ç®—æ³•ä¼˜åŒ–&lt;/li&gt;
&lt;li&gt;rustä¸pythonçš„åŒæ¥å£è®¾è®¡&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="41-rustæ¥å£è®¾è®¡"&gt;4.1 rustæ¥å£è®¾è®¡
&lt;/h3&gt;&lt;p&gt;rustè®¾è®¡äº†å‡ ä¸ªå…³é”®çš„Traitï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;trait&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AsCoord&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Get the x-coordinate (longitude or easting)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Returns the x-coordinate value of the point.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Get the y-coordinate (latitude or northing)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Returns the y-coordinate value of the point.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;y&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸ªAsCoordç”¨æ¥è¡¨ç¤ºä¸€ä¸ªç»çº¬åº¦ç‚¹ï¼Œå› ä¸ºè‚¯å®šè¦è®¡ç®—ç»çº¬åº¦ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œé‚£ä¹ˆç”¨è¿™æ ·ä¸€ä¸ªtraitæŠ½è±¡ï¼Œä¸è®ºç”¨æˆ·æ˜¯ç”¨&lt;code&gt;&amp;amp;[f64]&lt;/code&gt;è¿˜æ˜¯&lt;code&gt;vec&lt;/code&gt;ï¼Œéƒ½å¯ä»¥è½»æ¾æ”¯æŒï¼Œå¹¶ä¸”ä¿è¯å¾ˆå¥½çš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;trait&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CoordSequence&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// The type of coordinate in this sequence
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="nc"&gt;Coord&lt;/span&gt;: &lt;span class="nc"&gt;AsCoord&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Get the number of coordinates in the sequence
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Returns the total number of coordinate points in the sequence.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Check if the sequence is empty
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Returns `true` if the sequence contains no coordinates, `false` otherwise.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// This is implemented as `self.len() == 0` by default.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;is_empty&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Get the i-th coordinate in the sequence
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Returns a copy of the coordinate at the specified index.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// # Panics
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// This method may panic if the index is out of bounds.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;: &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Coord&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸ªtraitè¡¨ç¤ºè½¨è¿¹ï¼Œä¹Ÿå°±æ˜¯ç»çº¬åº¦åºåˆ—ã€‚å› æ­¤åªè¦ç”¨æˆ·å°†è‡ªå·±çš„æ•°æ®ç±»å‹å®ç°è¿™ä¸ªtraitçš„æ¥å£ï¼Œå°±å¯ä»¥è°ƒç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;é‡Œé¢çš„è·ç¦»è®¡ç®—å‡½æ•°äº†ã€‚&lt;/p&gt;
&lt;h3 id="42-åŠ¨æ€è§„åˆ’ç®—æ³•ä¼˜åŒ–"&gt;4.2 åŠ¨æ€è§„åˆ’ç®—æ³•ä¼˜åŒ–
&lt;/h3&gt;&lt;h4 id="421-åŠ¨æ€è§„åˆ’ç®—æ³•çš„ç±»å‹æŠ½è±¡"&gt;4.2.1 åŠ¨æ€è§„åˆ’ç®—æ³•çš„ç±»å‹æŠ½è±¡
&lt;/h4&gt;&lt;p&gt;å¯¹äºåŠ¨æ€è§„åˆ’ç®—æ³•æ¥è¯´ï¼Œä¸€èˆ¬åªéœ€è¦è®¡ç®—ä»»æ„ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ã€‚è€ƒè™‘åˆ°ç”¨æˆ·éœ€è¦ä½¿ç”¨çš„è·ç¦»è®¡ç®—æ–¹æ³•&lt;code&gt;traj-dist-rs&lt;/code&gt;ä¸æ”¯æŒï¼Œæ¯”å¦‚å¯¼èˆªè·ç¦»ã€‚å› æ­¤éœ€è¦ç»™ç”¨æˆ·æä¾›ä¸€ä¸ªç±»ä¼¼scikit-learnçš„æ–¹æ¡ˆï¼šç”¨æˆ·å¯ç”¨é¢„å…ˆè®¡ç®—å¥½ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œç„¶åä¼ å…¥è¿™ä¸ªâ€œé¢„è®¡ç®—è·ç¦»çŸ©é˜µâ€ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤å¯¹äºåŠ¨æ€è§„åˆ’ç±»çš„ç®—æ³•ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;æä¾›ä¸¤ç§æ¥å£å½¢å¼ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç”¨æˆ·å¯ç”¨ä¼ å…¥2æ¡åŸå§‹çš„ç»çº¬åº¦åºåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·æä¾›ä¸€ä¸ªé¢„è®¡ç®—è·ç¦»çŸ©é˜µã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é’ˆå¯¹è¿™ä¸¤ç§ç±»å‹ï¼Œæˆ‘å®šä¹‰äº†ä¸€ä¸ªå«&lt;code&gt;DistanceCalculator&lt;/code&gt;çš„traitã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;trait&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DistanceCalculator&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Calculate the distance between corresponding elements in two sequences
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;dis_between&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;seq_a_idx&lt;/span&gt;: &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;seq_b_idx&lt;/span&gt;: &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Calculate the distance between a point in a sequence and an external &amp;#34;anchor&amp;#34; point
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;compute_dis_for_extra_point&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;: &lt;span class="nc"&gt;AsCoord&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;seq_id&lt;/span&gt;: &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;point_idx&lt;/span&gt;: &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;anchor&lt;/span&gt;: &lt;span class="nb"&gt;Option&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Length of sequence 1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;len_seq1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Length of sequence 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;len_seq2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åŠ¨æ€è§„åˆ’ç®—æ³•å®Œå…¨å¯ä»¥é€šè¿‡è¿™ä¸ªtraitçš„æ³›å‹ï¼Œå–å‡ºä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œå®ŒæˆåŠ¨æ€è§„åˆ’ç®—æ³•çš„è®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;é‡Œé¢æä¾›äº†ä¸¤ä¸ªå…·ä½“çš„ç±»å‹å®ç°äº†è¿™ä¸ªtraitã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;TrajectoryCalculator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;U&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;where&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;: &lt;span class="nc"&gt;CoordSequence&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;U&lt;/span&gt;: &lt;span class="nc"&gt;CoordSequence&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt; &lt;span class="nc"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;traj2&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt; &lt;span class="nc"&gt;U&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;metric&lt;/span&gt;: &lt;span class="nc"&gt;DistanceType&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;PrecomputedDistanceCalculator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;distance_matrix&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt; &lt;span class="nb"&gt;Vec&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nb"&gt;Vec&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;seq1_extra_dists&lt;/span&gt;: &lt;span class="nb"&gt;Option&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Vec&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;seq2_extra_dists&lt;/span&gt;: &lt;span class="nb"&gt;Option&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Vec&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ol&gt;
&lt;li&gt;&lt;code&gt;TrajectoryCalculator&lt;/code&gt;ï¼šç›´æ¥è®¿é—®è½¨è¿¹æ•°æ®ï¼ŒæŒ‰éœ€è®¡ç®—è·ç¦»&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PrecomputedDistanceCalculator&lt;/code&gt;ï¼šä½¿ç”¨é¢„è®¡ç®—çš„è·ç¦»çŸ©é˜µ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™æ ·çš„å¥½å¤„æ˜¯ç®—æ³•é€»è¾‘å’Œè·ç¦»è®¡ç®—é€»è¾‘è§£è€¦ï¼Œå¦‚æœå°†æ¥è¦æ”¯æŒå…¶ä»–è·ç¦»è®¡ç®—æ–¹å¼ï¼Œåªéœ€è¦å®ç°æ–°çš„ Calculator å°±å¯ä»¥äº†ã€‚æ¯”å¦‚ç”¨æˆ·éœ€è¦å®æ—¶è°ƒç”¨æ¥å£è·å–ä¸¤ç‚¹ä¹‹é—´çš„å¯¼èˆªè·ç¦»ï¼Œé‚£ä¹ˆç”¨æˆ·è‡ªå·±å®ç°è¿™ä¸ªtraitå°±å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’ç®—æ³•äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ä»£ç æ˜¯ä½¿ç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;æä¾›çš„&lt;code&gt;TrajectoryCalculator&lt;/code&gt;è°ƒç”¨åŠ¨æ€è§„åˆ’ç®—æ³•çš„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;traj_dist_rs&lt;/span&gt;::&lt;span class="n"&gt;distance&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt;::&lt;span class="n"&gt;TrajectoryCalculator&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;distance_type&lt;/span&gt;::&lt;span class="n"&gt;DistanceType&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="fm"&gt;vec!&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;]];&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;traj2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="fm"&gt;vec!&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]];&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;calculator&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TrajectoryCalculator&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;traj2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DistanceType&lt;/span&gt;::&lt;span class="n"&gt;Euclidean&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dist&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;distance&lt;/span&gt;::&lt;span class="n"&gt;dtw&lt;/span&gt;::&lt;span class="n"&gt;dtw&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;calculator&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id="422-åŠ¨æ€è§„åˆ’ç®—æ³•å†…å­˜ä¼˜åŒ–"&gt;4.2.2 åŠ¨æ€è§„åˆ’ç®—æ³•å†…å­˜ä¼˜åŒ–
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;traj-dist-rs&lt;/code&gt;é’ˆå¯¹åŠ¨æ€è§„åˆ’ç®—æ³•è¿˜åšäº†ä¸€ä¸ªå†…å­˜ä¸Šçš„ä¼˜åŒ–ï¼šå¯¹äºå¤§éƒ¨åˆ†åŠ¨æ€è§„åˆ’ç®—æ³•ï¼Œå½“æˆ‘ä»¬ä¸éœ€è¦å›æº¯åŠ¨æ€è§„åˆ’ç®—æ³•çš„è·¯å¾„çš„æ—¶å€™ï¼Œå…¶ç©ºé—´å¤æ‚åº¦å¯ä»¥ç¼©å‡åˆ°&lt;code&gt;O(MN) -&amp;gt; O(min{M, N})&lt;/code&gt;ï¼Œè¿™é‡Œçš„Må’ŒNæ˜¯2æ¡åºåˆ—çš„é•¿åº¦ã€‚&lt;code&gt;traj-dist-rs&lt;/code&gt;ä¼šé»˜è®¤ä½¿ç”¨è¿™ç§ç®—æ³•è®°å½•åŠ¨æ€è§„åˆ’ç®—æ³•çš„ä¸­é—´å€¼ï¼Œå®ç°å†…å­˜ä½¿ç”¨çš„ä¸‹é™ã€‚&lt;/p&gt;
&lt;h3 id="43-åŒæ¥å£æ”¯æŒ"&gt;4.3 åŒæ¥å£æ”¯æŒ
&lt;/h3&gt;&lt;p&gt;è¿™ä¸ªé¡¹ç›®åŒæ—¶æä¾›äº† Rust API å’Œ Python ç»‘å®šã€‚å› ä¸ºæ®æˆ‘äº†è§£è®¡ç®—è½¨è¿¹è·ç¦»ï¼Œå¤§å®¶åŸºæœ¬éƒ½æ˜¯pythonå®ç°ï¼Œè€Œä¸”å­¦æœ¯ç•Œç”¨å¾—æ›´å¤šï¼Œå› ä¸ºè½¨è¿¹è¡¨ç¤ºå­¦ä¹ ä¹‹åçš„åº¦é‡æ–¹å¼ï¼Œå¾ˆå¤šè®ºæ–‡ä¼šä½¿ç”¨æ›´ä¼ ç»Ÿçš„metricsï¼Œæ¯”å¦‚DTWï¼Œfrechetç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤å¦‚æœè¦ç”¨pythonåšçš„è¯ï¼Œcythonè¿™ä¸ªåŠ é€Ÿæ–¹æ¡ˆæœ‰ç‚¹è€äº†ï¼Œè€Œä¸”éœ€è¦å­¦ä¹ cythonä»£ç ï¼›pybind11ä¸c++çš„æ–¹æ¡ˆä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯ä¸å¦‚pyo3+rustçš„æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ˜¯è¿™æ ·ï¼Œæˆ‘è¿˜ä¸å¸Œæœ›è¿™ä¸ªåŒ…åªæœåŠ¡pythonç”¨æˆ·ï¼Œåº”è¯¥ä¹Ÿèƒ½æœåŠ¡rustç”¨æˆ·ã€‚è¿™æ ·å°±è¦æ±‚rustçš„ä»£ç åº”è¯¥æ›´ç®€å•ã€æŠ½è±¡ã€å†…èšï¼Œåœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ pythonçš„bindingã€‚&lt;/p&gt;
&lt;p&gt;Python ç»‘å®šé€šè¿‡ PyO3 å®ç°ï¼ŒAPI è®¾è®¡å°½é‡ä¿æŒå’Œ traj-dist ä¸€è‡´ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;traj_dist_rs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;traj1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;traj2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# ä½¿ç”¨æ–¹å¼å‡ ä¹å’Œ traj-dist ä¸€æ ·&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dist&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;traj_dist_rs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dtw&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;traj2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dist&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;traj_dist_rs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lcss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;traj2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;eps&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# ERP æœ‰ä¸¤ä¸ªç‰ˆæœ¬&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dist_standard&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;traj_dist_rs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;erp_standard&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;traj2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dist_compat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;traj_dist_rs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;erp_compat_traj_dist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;traj2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è€ƒè™‘åˆ°å¤§éƒ¨åˆ†æ•°æ®éƒ½æ˜¯åœ¨pythonä¸­è¯»å–çš„ï¼Œé‚£ä¹ˆå¦‚ä½•è®©rusté€šè¿‡é›¶æ‹·è´çš„æ–¹å¼è¯»å–æ˜¯æå‡æ€§èƒ½çš„ä¸€ä¸ªå…³é”®ã€‚å› ä¸ºä¼ ç»Ÿæ–¹å¼é‡Œé¢ï¼Œå½“ Python è°ƒç”¨ C/C++/Cython æ¨¡å—æ—¶ï¼Œå¾€å¾€éœ€è¦å…ˆæŠŠè¿™ç®±è´§ç‰©â€œå¸ä¸‹â€ï¼ˆä»Pythonå†…å­˜ï¼‰ï¼Œå†â€œæ¬è¿â€å¹¶â€œé‡æ–°æ‰“åŒ…â€ï¼ˆå¤åˆ¶åˆ°C/C++/Cythonèƒ½ç†è§£çš„å†…å­˜ç»“æ„ä¸­ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯æœ‰å¼€é”€çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è¿™é‡Œåˆ©ç”¨äº†numpyçš„c-contiguousç‰¹æ€§ï¼Œå½“numpy.ndarrayçš„æ•°æ®åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­å­˜å‚¨çš„æ—¶å€™ï¼Œå¯ä»¥ä¸éœ€è¦â€œæ¬è¿â€å’Œâ€œæ‰“åŒ…â€æ“ä½œï¼Œç›´æ¥åœ¨åŸåœ°æ‰“å¼€è´§ç‰©ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šrustå¯ä»¥ç›´æ¥è¯»å–pythonä¸­çš„numpy.ndarrayçš„æ•°æ®ï¼Œè€Œä¸æ˜¯å¤åˆ¶ä¸€ä»½ã€‚è¿™é‡Œrustæ‹¿åˆ°çš„æ˜¯ä¸€ä¸ª&lt;code&gt;&amp;amp;[f64]&lt;/code&gt;çš„åˆ‡ç‰‡ã€‚æ¥ä¸‹æ¥åªè¦æŠŠè¿™ä¸ªåˆ‡ç‰‡å®ç°ä¸Šé¢ä»‹ç»çš„&lt;code&gt;CoordSequence&lt;/code&gt;æ¥å£ï¼Œå°±å¯ä»¥é€‚é…å„ä¸ªç®—æ³•äº†ã€‚rustçš„é›¶æˆæœ¬æŠ½è±¡å¯ä»¥ç›´æ¥è®©å„ä¸ªç®—æ³•æ“ä½œè¿™å—å†…å­˜ä¸­çš„æ•°æ®ï¼Œä»¥æ­¤å®ç°æ€§èƒ½æå‡ï¼ŒåŒæ—¶ä¹Ÿé¿å…äº†æ•°æ®çš„æ‹·è´ï¼Œè¿™ä¹Ÿæ˜¯rustæ€§èƒ½è¶…è¶Šcythonçš„æ ¸å¿ƒåŸå› ã€‚&lt;/p&gt;
&lt;h2 id="äº”è¸©è¿‡çš„å‘"&gt;äº”ã€è¸©è¿‡çš„å‘
&lt;/h2&gt;&lt;p&gt;åšè¿™ä¸ªé¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿå‘ç°äº†ä¸€äº›é—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id="51-çƒé¢è·ç¦»çš„ç²¾åº¦é—®é¢˜"&gt;5.1 çƒé¢è·ç¦»çš„ç²¾åº¦é—®é¢˜
&lt;/h3&gt;&lt;p&gt;ä¸€å¼€å§‹æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘å‘ç°çƒé¢è·ç¦»è®¡ç®—çš„ç»“æœå’Œ &lt;code&gt;traj-dist&lt;/code&gt; çš„ç»“æœå¯¹ä¸ä¸Šã€‚æ’æŸ¥äº†å¾ˆä¹…ï¼Œæœ€åå‘ç°é—®é¢˜å‡ºåœ¨ &lt;code&gt;traj-dist&lt;/code&gt; çš„ Cython å®ç°ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;traj-dist çš„ Cython ä»£ç ä¸­ï¼Œçƒé¢è·ç¦»è®¡ç®—ä½¿ç”¨çš„æ˜¯ &lt;code&gt;float&lt;/code&gt;ï¼ˆ32 ä½æµ®ç‚¹æ•°ï¼‰ï¼Œè€Œä¸” PI å€¼æ˜¯ç¡¬ç¼–ç çš„æˆªæ–­å€¼ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cython" data-lang="cython"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;cdef&lt;/span&gt; &lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="nf"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;3.14159265&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸ªç²¾åº¦æ˜¾ç„¶ä¸å¤Ÿã€‚ä¸ºäº†å’Œ &lt;code&gt;traj-dist&lt;/code&gt; çš„ç»“æœå¯¹æ¯”ï¼Œæˆ‘forkå¹¶ä¿®æ”¹äº†&lt;code&gt;traj-dist&lt;/code&gt;çš„æºç ï¼ŒæŠŠ &lt;code&gt;float&lt;/code&gt; æ”¹æˆ &lt;code&gt;double&lt;/code&gt;ï¼Œä½¿ç”¨ &lt;code&gt;M_PI&lt;/code&gt; å¸¸é‡ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cython" data-lang="cython"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;cdef&lt;/span&gt; &lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="nf"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;M_PI&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¿®å¤åï¼ŒRust å®ç°å’Œ traj-dist çš„ç»“æœå°±å¯¹ä¸Šäº†ã€‚&lt;/p&gt;
&lt;h3 id="52-erp-ç®—æ³•çš„å®ç°é—®é¢˜"&gt;5.2 ERP ç®—æ³•çš„å®ç°é—®é¢˜
&lt;/h3&gt;&lt;p&gt;åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç° traj-dist çš„ ERP ç®—æ³•å®ç°æœ‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ERPç®—æ³•æ˜¯å…¸å‹çš„åŠ¨æ€è§„åˆ’ç®—æ³•ï¼Œåœ¨åˆå§‹åŒ–åŠ¨æ€è§„åˆ’çŸ©é˜µçš„è¾¹ç•Œå€¼çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯&lt;code&gt;C[0,:]&lt;/code&gt;å’Œ&lt;code&gt;C[:,0]&lt;/code&gt;ï¼Œ&lt;code&gt;traj-dist&lt;/code&gt;ä½¿ç”¨äº†é”™è¯¯çš„æ–¹æ³•ï¼Œç»™æ¯ä¸ªå€¼éƒ½åˆå§‹åŒ–æˆäº†ç›¸åŒçš„å€¼ï¼Œè¿™é‡Œçš„æ­£ç¡®å®ç°åº”è¯¥æ˜¯ä¸åŒçš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘çº ç»“äº†åŠå¤©ï¼Œè€ƒè™‘åˆ°è¿™ä¸ªåŒ…å·²ç»è¢«å¾ˆå¤šäººç”¨äº†ï¼Œç›´æ¥ä¿®æ”¹ API ä¼šç ´åå…¼å®¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘æƒ³äº†ä¸ªæŠ˜ä¸­çš„æ–¹æ¡ˆï¼šæä¾›ä¸¤ä¸ªç‰ˆæœ¬&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;erp_standard&lt;/code&gt;ï¼šæŒ‰ç…§æ­£ç¡®çš„ç®—æ³•å®ç°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;erp_compat_traj_dist&lt;/code&gt;ï¼šæŒ‰ç…§ &lt;code&gt;traj-dist&lt;/code&gt; çš„é—®é¢˜ç‰ˆæœ¬å®ç°ï¼Œä¿æŒå…¼å®¹æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™æ ·ï¼Œæ–°ç”¨æˆ·å¯ä»¥ç”¨æ­£ç¡®çš„å®ç°ï¼Œè€ç”¨æˆ·å¦‚æœéœ€è¦å’ŒåŸæ¥ä¿æŒä¸€è‡´ï¼Œä¹Ÿå¯ä»¥ç”¨å…¼å®¹ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;h2 id="å…­ç²¾åº¦ä¿è¯"&gt;å…­ã€ç²¾åº¦ä¿è¯
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„å®ç°ï¼Œä»¥&lt;code&gt;traj-dist&lt;/code&gt;ä¸ºåŸºå‡†ï¼Œå› æ­¤éœ€è¦ä¸¤è€…è·‘å‡ºæ¥çš„ç»“æœå°½å¯èƒ½ä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘åšäº†ä¸¤ä»¶äº‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆä¿®æ”¹&lt;code&gt;traj-dist&lt;/code&gt;çš„çƒé¢è·ç¦»è®¡ç®—ä»£ç ï¼Œå°†æ‰€æœ‰çš„floatéƒ¨åˆ†æ›¿æ¢ä¸ºdoubleï¼Œå¹¶ä¸”ä¿®æ”¹PIçš„å€¼ä¸ºM_PIï¼Œä»¥è·å¾—æ›´é«˜çš„ç²¾åº¦ã€‚&lt;/li&gt;
&lt;li&gt;å› ä¸º&lt;code&gt;traj-dist&lt;/code&gt;çš„erpç®—æ³•å®ç°æœ‰è¯¯ï¼Œä¸ºäº†ä¿è¯ç»“æœçš„ä¸€è‡´æ€§ï¼Œæˆ‘è¿™é‡Œæµ‹é‡çš„æ˜¯&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„&lt;code&gt;erp_compat_traj_dist&lt;/code&gt;ä¸&lt;code&gt;traj-dist&lt;/code&gt;çš„erpç®—æ³•ä¹‹é—´çš„è¯¯å·®ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æµ‹ç®—ä¸‹æ¥è¯¯å·®è¿œè¿œå°äºæˆ‘æœŸæœ›çš„1e-8çš„é˜ˆå€¼ï¼Œè¯´æ˜&lt;code&gt;traj-dist-rs&lt;/code&gt;å®ç°äº†ç®—æ³•çš„æ­£ç¡®å®ç°ã€‚&lt;/p&gt;
&lt;h2 id="ä¸ƒæ€»ç»“"&gt;ä¸ƒã€æ€»ç»“
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„å®ç°æˆ‘è§‰å¾—æœ‰å‡ ä¸ªäº®ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨rusté‡å†™&lt;/li&gt;
&lt;li&gt;ä¸pythonçš„ç»‘å®šä¸­è€ƒè™‘äº†é›¶æ‹·è´çš„é—®é¢˜&lt;/li&gt;
&lt;li&gt;rustå±‚é¢åšäº†æ¯”è¾ƒå¥½çš„æŠ½è±¡ï¼Œä¸è®ºæ˜¯&lt;code&gt;CoordSequence&lt;/code&gt;è¿˜æ˜¯&lt;code&gt;DistanceCalculator&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰åŠ¨æ€è§„åˆ’ç®—æ³•æä¾›äº†èŠ‚çœå†…å­˜çš„å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;ç¡®å®å®ç°äº†æ€§èƒ½çš„æ˜¾è‘—æå‡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœä½ ä¹Ÿåœ¨åšè½¨è¿¹æ•°æ®åˆ†æï¼Œæˆ–è€…å¯¹ Rust æ€§èƒ½ä¼˜åŒ–æ„Ÿå…´è¶£ï¼Œæ¬¢è¿è¯•è¯• &lt;code&gt;traj-dist-rs&lt;/code&gt;ã€‚é¡¹ç›®åœ°å€åœ¨ï¼š&lt;a class="link" href="https://github.com/Davidham3/traj-dist-rs" target="_blank" rel="noopener"
&gt;traj-dist-rs&lt;/a&gt;ã€‚ç›®å‰alphaç‰ˆæœ¬å·²ç»å‘å¸ƒåœ¨crates.ioå’Œpypiï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒcontext7ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿äº¤æµï¼&lt;/p&gt;
&lt;h2 id="é™„å½•"&gt;é™„å½•
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;ä¿®å¤çƒé¢è·ç¦»ç²¾åº¦çš„ï¼š&lt;a class="link" href="https://github.com/Davidham3/traj-dist" target="_blank" rel="noopener"
&gt;traj-dist&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®Œæ•´çš„æ€§èƒ½æµ‹è¯•è®°å½•ï¼š&lt;a class="link" href="https://github.com/Davidham3/traj-dist-rs/blob/v0.1.0-alpha.3/docs/performance.md" target="_blank" rel="noopener"
&gt;performance.md&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>TrajDL</title><link>https://davidham3.github.io/blog/p/trajdl/</link><pubDate>Mon, 06 Jan 2025 12:41:49 +0000</pubDate><guid>https://davidham3.github.io/blog/p/trajdl/</guid><description>&lt;img src="https://trajdl.readthedocs.io/en/latest/_static/wide-logo.svg" alt="Featured image of post TrajDL" /&gt;&lt;p&gt;è®°å½•ä¸€ä¸‹å…³äºTrajDLçš„ä¿¡æ¯ã€‚TrajDLæ˜¯æˆ‘ç¼–å†™çš„ç¬¬ä¸€ä¸ªä½“ç³»å®Œæ•´çš„pythonå·¥å…·åŒ…ï¼Œé¢å‘è½¨è¿¹æ·±åº¦å­¦ä¹ ï¼Œç›®çš„æ˜¯æ”¯æŒå¾ˆå¤šè½¨è¿¹æ·±åº¦å­¦ä¹ ç®—æ³•ï¼ŒåŒ…æ‹¬è½¨è¿¹è¡¨ç¤ºå­¦ä¹ ã€è½¨è¿¹åˆ†ç±»ã€ä¸‹ä¸€ä½ç½®é¢„æµ‹ç­‰æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰å·²ç»åœ¨GitHubä¸Šå¼€æºï¼Œé¡¹ç›®ä¸»é¡µæ˜¯ï¼š&lt;a class="link" href="https://github.com/Spatial-Temporal-Data-Mining/TrajDL" target="_blank" rel="noopener"
&gt;https://github.com/Spatial-Temporal-Data-Mining/TrajDL&lt;/a&gt;ï¼Œå·²ç»å‘å¸ƒäº†0.1.0ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨pypiä¸Šä¸‹è½½ï¼Œå®˜æ–¹æ–‡æ¡£æ˜¯ï¼š&lt;a class="link" href="https://trajdl.readthedocs.io/en/latest/" target="_blank" rel="noopener"
&gt;https://trajdl.readthedocs.io/en/latest/&lt;/a&gt;ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ–‡æ¡£æŸ¥é˜…å®ƒçš„ä½¿ç”¨æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰0.1.0ç‰ˆæœ¬åªæ”¯æŒäº†TULERã€t2vecã€GMVSAEã€ST-LSTM 4ä¸ªç®—æ³•ï¼Œå½“ç„¶è¿˜å¼€å‘äº†æ¯”å¦‚CTLEã€HIERè¿™æ ·çš„ç®—æ³•ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å¼€å‘å®Œã€‚&lt;/p&gt;
&lt;p&gt;TrajDLçš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºå¸®ç”¨æˆ·ç®¡ç†äº†æ•°æ®é›†ï¼Œç”¨æˆ·å¯ä»¥å¿«é€Ÿä¸‹è½½å…¬å¼€æ•°æ®é›†ï¼Œå¹¶ä¸”é€šè¿‡TrajDLè®¾è®¡çš„dataseté«˜æ•ˆåœ°å®Œæˆå®éªŒï¼Œä¸€äº›å…³é”®ç®—å­é€šè¿‡C++å®ç°ï¼Œæ•°æ®é›†åŸºäºArrowæ„å»ºï¼Œæ‰€ä»¥æ•´ä¸ªæ¡†æ¶åœ¨æ€§èƒ½ã€å†…å­˜ä½¿ç”¨ä¸Šéƒ½æœ‰æ¯”è¾ƒå¥½çš„æ•ˆæœã€‚æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹æ„å»ºåœ¨lightningä¸Šï¼Œæ‰€ä»¥å³æ”¯æŒAPIå¼€å‘è®­ç»ƒä»£ç ï¼Œåˆæ”¯æŒé€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œè®­ç»ƒã€‚&lt;/p&gt;
&lt;p&gt;0.2.0ç‰ˆæœ¬ä¸»è¦ä¼šåœ¨è½¨è¿¹ç›¸ä¼¼åº¦è®¡ç®—ä¸Šé¢å®ç°ä¸€äº›ç®—æ³•ï¼Œç›®å‰è¿˜åœ¨å¼€å‘ä¸­ã€‚&lt;/p&gt;</description></item><item><title>NEUTRAJ</title><link>https://davidham3.github.io/blog/p/neutraj/</link><pubDate>Tue, 24 Dec 2024 07:17:09 +0000</pubDate><guid>https://davidham3.github.io/blog/p/neutraj/</guid><description>&lt;p&gt;&lt;a class="link" href="https://ieeexplore.ieee.org/abstract/document/8731427" target="_blank" rel="noopener"
&gt;ICDE 2019ï¼šComputing Trajectory Similarity in Linear Time: A Generic Seed-Guided Neural Metric Learning Approach&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;æå‡ºçš„æ–¹æ³•å«NEUTRAJï¼Œä¸»è¦è§£å†³è½¨è¿¹ç›¸ä¼¼åº¦è®¡ç®—æ—¶çš„æ€§èƒ½é—®é¢˜ï¼Œåœ¨çº¿æ€§æ—¶é—´å†…è®¡ç®—å®Œæ¯•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯è¦ç”¨æˆ·æå‰é€‰æ‹©ä¸€ç§éå­¦ä¹ çš„åº¦é‡æ–¹å¼ï¼Œç„¶åè¿™ä¸ªæ¡†æ¶å¯ä»¥å»æ‹Ÿåˆè¿™ä¸ªåº¦é‡æ–¹å¼çš„å€¼ï¼Œå› æ­¤è¿™ä¸ªæ¡†æ¶å¯ä»¥æ”¯æŒå¾ˆå¤šåº¦é‡æ–¹å¼ï¼Œæ¯”å¦‚DTWï¼ŒFrechetç­‰ã€‚æ¨¡å‹å±‚é¢æœ‰ä¸¤ä¸ªåˆ›æ–°ï¼Œåœ¨RNNä¸Šå¢åŠ äº†å¸¦æœ‰è®°å¿†æ¨¡å—çš„attentionæœºåˆ¶ï¼›å¦å¤–æ˜¯åœ¨æŸå¤±çš„æ—¶å€™å¢åŠ äº†æ’åºä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h1 id="definition"&gt;Definition
&lt;/h1&gt;&lt;p&gt;æ–‡ç« é‡Œé¢çš„è½¨è¿¹ä½¿ç”¨$T$è¡¨ç¤ºï¼Œ$f(T_i, T_j)$ è¡¨ç¤ºç›¸ä¼¼åº¦ï¼Œè¿™ä¸ªç›¸ä¼¼åº¦å¯ä»¥ä½¿ç”¨DTWï¼ŒFrechetï¼Œå¯ä»¥ä½¿ç”¨å„ç§éå­¦ä¹ çš„åº¦é‡æ–¹å¼ã€‚ä½†æ˜¯å¾ˆå¤šè¿™æ ·çš„åº¦é‡æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦éƒ½è¾¾åˆ°äº†å¹³æ–¹çº§ï¼Œæœ¬æ–‡çš„ä¸€ä¸ªç›®æ ‡å°±æ˜¯å­¦ä¹ ä¸€ä¸ª $g(\cdot, \cdot)$ï¼Œè¿™ä¸ªå‡½æ•°çš„æ—¶é—´å¤æ‚åº¦è¦è¾¾åˆ° $O(n)$ï¼Œè®­ç»ƒæ–¹å¼å°±æ˜¯å°† $\vert f(T_i, T_j) - g(T_i, T_j) \vert$ æœ€å°åŒ–ã€‚&lt;/p&gt;
&lt;h1 id="overview"&gt;Overview
&lt;/h1&gt;&lt;p&gt;$\mathfrak{S}$ æ˜¯ä»æ‰€æœ‰è½¨è¿¹é‡Œé¢éšæœºå–å‡ºçš„ $N$ æ¡è½¨è¿¹ï¼Œè¿™æ‰¹è½¨è¿¹ç§°ä¸ºç§å­ã€‚ç„¶åé€šè¿‡ $f$ è®¡ç®—ä¸€ä¸ªçŸ©é˜µ $\mathbf{D} \in \mathbb{R}^{N \times N}$ å‡ºæ¥ï¼Œç„¶ååšä¸€ä¸ªnormalizationï¼Œå¾—åˆ° $\mathbf{S}$ã€‚å¯¹äºä»»æ„ä¸¤æ¡è½¨è¿¹ï¼ŒNEUTRAJä¼šç”Ÿæˆä¸¤ä¸ª $d$ ç»´å‘é‡ $\mathbf{E_i}, \mathbf{E_j}$ï¼Œä½¿å¾— $f(T_i, T_j) \approx g(T_i, T_j)$ã€‚&lt;/p&gt;
&lt;h2 id="é¢„å¤„ç†"&gt;é¢„å¤„ç†
&lt;/h2&gt;&lt;p&gt;å°†ç©ºé—´åˆ’åˆ†æˆç½‘æ ¼ï¼Œå°†è½¨è¿¹åºåˆ—è½¬æ¢æˆä½ç½®åºåˆ—ï¼Œä½ç½®å°±æ˜¯ç½‘æ ¼çš„idã€‚å‡è®¾ç½‘æ ¼çš„å¤§å°æ˜¯ $P \times Q$ï¼Œé‚£ä¹ˆå®šä¹‰ä¸€ä¸ªmemory tensor $\mathbf{M} \in \mathbb{R}^{P \times Q \times d}$ï¼Œè®­ç»ƒå‰å…¨éƒ½ç½®ä¸º0ã€‚è¿™ä¸ªtensorä¼šå’ŒRNNä¸€èµ·è®­ç»ƒã€‚&lt;/p&gt;
&lt;h2 id="å¸¦æœ‰è®°å¿†æ¨¡å—çš„rnn"&gt;å¸¦æœ‰è®°å¿†æ¨¡å—çš„RNN
&lt;/h2&gt;$$
(\mathbf{f_t, i_t, s_t, o_t}) = \sigma (\mathbf{W_g} \cdot X^c_t + \mathbf{U_g \cdot h_{t-1} + b_g})
$$$$
\mathbf{\tilde{c_t}} = \tanh (\mathbf{W_c} \cdot X^c_t + \mathbf{U_c \cdot h_{t-1} + b_c})
$$$$
\mathbf{\hat{c_t} = f_t \cdot c_{t-1} + i_t \cdot \tilde{c_t}}
$$$$
\mathbf{c_t} = \mathbf{\hat{c_t} + s_t} \cdot \text{read}(\mathbf{\hat{c_t}}, X^g_t, \mathbf{M})
$$$$
\text{write}(\mathbf{c_t, s_t}, X^g_t, \mathbf{M})
$$$$
\mathbf{h_t} = \mathbf{o_t} \cdot \tanh(\mathbf{c_t})
$$&lt;p&gt;where $\mathbf{W_g} \in \mathbb{R}^{4d \times 2}, \mathbf{U_g} \in \mathbb{R}^{4d \times d}, \mathbf{W_c} \in \mathbb{R}^{d \times 2}, \mathbf{U_c} \in \mathbb{R}^{d \times d}$ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ $X^c_t, X^g_t$ åˆ†åˆ«è¡¨ç¤ºè½¨è¿¹çš„ç»çº¬åº¦ç‚¹å’Œç»çº¬åº¦ç‚¹æ‰€åœ¨çš„ç½‘æ ¼ã€‚è¯»å†™æ“ä½œå°±æ˜¯å¯¹ $\mathbf{M}$ è¿›è¡Œè¯»å–å’Œå†™å…¥ã€‚&lt;/p&gt;
&lt;p&gt;è¯»æ“ä½œä½¿ç”¨ä¸¤ä¸ªè¾“å…¥ï¼Œä¸€ä¸ªæ˜¯ç½‘æ ¼è¾“å…¥ $X^g_t$ï¼Œå¦ä¸€ä¸ªæ˜¯ä¸­é—´ç»†èƒçŠ¶æ€ $\mathbf{\hat{c_t}}$ï¼Œç„¶åä¼šè¾“å‡ºä¸€ä¸ªå‘é‡ $\mathbf{c^{his}_t}$ï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥å¢å¼º $\mathbf{\hat{c_t}}$ çš„ã€‚å¤§ä½“åŸç†å°±æ˜¯é€šè¿‡å½“å‰çš„è¿™ä¸ªç½‘æ ¼ä½ç½®ï¼Œä»¥å®ƒä¸ºçŸ©å½¢ä¸­å¿ƒï¼Œå»è¯»å–å‘¨å›´ä¸€ä¸ªæ­£æ–¹å½¢åŒºåŸŸå†…è¿™äº›ç½‘æ ¼çš„memoryï¼Œç„¶åé€šè¿‡ä¸€ä¸ªæ³¨æ„åŠ›æœºåˆ¶å°†å…¶å˜æˆä¸€ä¸ª $d$ ç»´å‘é‡ã€‚å‡è®¾æ­£æ–¹å½¢åŒºåŸŸçš„è¾¹é•¿æ˜¯5ä¸ªæ ¼å­çš„é•¿åº¦ï¼Œé‚£ä¹ˆå°±ä¼šæ‰«æä¸€ä¸ª $5 \times 5$ çš„åŒºåŸŸï¼Œè·å¾—è¿™äº›memoryã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åŠ›æœºåˆ¶çš„è®¡ç®—å…¬å¼ï¼š&lt;/p&gt;
$$
\mathbf{A} = \text{softmax}(\mathbf{G_t \cdot \hat{c_t}})
$$$$
\mathbf{mix = G^T_t \cdot A}
$$$$
\mathbf{c^{cat}_t = [\hat{c_t}, mix]}
$$$$
\mathbf{c_{t}^{his}} = \tanh ( \mathbf{W_{his} \cdot c_{t}^{his} + b_{his}})
$$&lt;p&gt;è¿™é‡Œçš„ $G_t \in \mathbb{R}^{(2w + 1)^2 \times d}$ã€‚&lt;/p&gt;
&lt;p&gt;å†™å…¥æ“ä½œï¼š&lt;/p&gt;
$$
\mathbf{M}(X_g)_{new} = \sigma(\mathbf{s_t}) \cdot \mathbf{c_t} + (1 - \sigma(\mathbf{s_t})) \cdot \mathbf{M}(X_g)\_{old}
$$&lt;h2 id="metric-learning-procedures"&gt;Metric Learning Procedures
&lt;/h2&gt;&lt;p&gt;RNNæœ€åçš„éšè—çŠ¶æ€ä½œä¸ºè½¨è¿¹è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;ä½œè€…è¯´ç›´æ¥å»æ‹Ÿåˆ $\mathbf{S}$ ä¼šè¿‡æ‹Ÿåˆï¼Œæ‰€ä»¥è¦ç»™MSEåŠ æƒã€‚å…·ä½“åšæ³•æ˜¯ä»ç§å­é‡Œé¢é€‰å‡ºä¸€ä¸ªanchorè½¨è¿¹ï¼Œç„¶åçœ‹è¿™æ¡è½¨è¿¹åœ¨ $\mathbf{S}$ é‡Œé¢çš„å“ªä¸€è¡Œï¼Œå–å‡ºè¿™ä¸€è¡Œ $\mathbf{I_a}$ï¼Œç„¶åè¿›è¡Œé‡‡æ ·ã€‚é¦–å…ˆç”¨è¿™ä¸ªå‘é‡çš„æƒé‡é‡‡æ ·æ­£æ ·æœ¬ $n$ ä¸ªï¼Œç„¶åç”¨ $1 - \mathbf{I_a}$ é‡‡ $n$ ä¸ªè´Ÿæ ·æœ¬ã€‚ç„¶åç»™ä»–ä»¬æŒ‰ç›¸ä¼¼å’Œä¸ç›¸ä¼¼åˆ†åˆ«æ’å¥½åºï¼Œç»™ä»–ä»¬èµ‹äºˆæƒé‡ï¼Œæƒé‡æ˜¯ $\mathbf{r} = (1, 1/2, \dots, 1/l, \dots, 1/n)$ï¼Œç„¶åå†é™¤ä»¥ $\sum^n_{l=1} r_l$ è¿›è¡Œå½’ä¸€åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå®šä¹‰æ­£æ ·æœ¬æŸå¤±å‡½æ•°ä¸º&lt;/p&gt;
$$
L^s_a = \sum^n_{l=1} r_l \cdot (g(T_a, T^s_l)- f(T_a, T^s_l))^2
$$&lt;p&gt;è´Ÿæ ·æœ¬æŸå¤±ï¼š&lt;/p&gt;
$$
L^d_a = \sum^n_{l=1} r_l \cdot [\text{ReLU}(g(T_a, T^d_l) - f(T_a, T^d_l))]^2
$$&lt;p&gt;æˆ‘è§‰å¾—ä¸ç›¸ä¼¼æ ·æœ¬çš„æŸå¤±å‡½æ•°è®¾è®¡çš„ä¸å¯¹ï¼Œå¦‚æœ $f$ æ˜¯DTWè¿™ç±»ç®—æ³•ï¼ŒDTWå€¼è¶Šå°è¯´æ˜ä¸¤æ¡è½¨è¿¹è¶Šç›¸ä¼¼ã€‚é‚£ä¹ˆå¦‚æœ $g &amp;gt; f$ï¼Œé‚£å°±è¯´æ˜æ¨¡å‹è®¤ä¸ºä¸¤æ¡è½¨è¿¹çš„è·ç¦»æ¯”çœŸå®è·ç¦»å¤§ã€‚å½“å‰è¿™äº›æ ·æœ¬æœ¬èº«å°±æ˜¯ä¸ç›¸ä¼¼çš„ï¼Œæ‰€ä»¥ $f$ åº”è¯¥ä¼šéå¸¸å¤§ï¼Œè€Œå¦‚æœ $g &amp;gt; f$ ï¼Œè¯´æ˜æ¨¡å‹è®¤ä¸ºä»–ä»¬æ›´ä¸ç›¸ä¼¼ï¼Œæ­¤æ—¶æ˜¯åˆç†çš„ï¼Œå¦‚æœ $g &amp;lt; f$ï¼Œè¯´æ˜æ¨¡å‹è®¤ä¸ºè¿™äº›æ ·æœ¬æ˜¯ç›¸ä¼¼çš„ï¼Œæ­¤æ—¶åº”è¯¥ä¼˜åŒ–ã€‚å› æ­¤å¦‚æœ $ g &amp;lt; f$ï¼Œå³ $ g - f &amp;lt; 0$ï¼Œé‚£ä¹ˆæ­¤æ—¶åº”è¯¥è®©æ¨¡å‹å»ä¼˜åŒ–å‚æ•°ï¼Œå¦‚æœ $g - f &amp;gt; 0$ï¼Œå°±ä¸ç”¨ä¼˜åŒ–äº†ï¼Œå› æ­¤è¿™é‡Œçš„æŸå¤±å‡½æ•°é‡Œé¢ç¼ºå°‘äº†ä¸€ä¸ªè´Ÿå·ã€‚é€šè¿‡é˜…è¯»æºç ï¼Œå‘ç°ä½œè€…ä½¿ç”¨æ˜¯ $ f - g $ï¼Œå› æ­¤è¿™é‡Œå¯ä»¥è®¤ä¸ºæ˜¯è®ºæ–‡æ’°å†™é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæŠŠä¸¤ä¸ªæŸå¤±ç›¸åŠ ï¼Œå¾—åˆ°æœ€ç»ˆçš„loss&lt;/p&gt;
$$
L_{\mathfrak{S}} = \sum_{a \in [1, \dots, N]} (L^s_a + L^d_a)
$$&lt;h1 id="experiments"&gt;Experiments
&lt;/h1&gt;&lt;p&gt;å®éªŒæ˜¯åœ¨Geolifeå’ŒPortoä¸Šé¢åšçš„ã€‚åšäº†ä¸€ä¸ªtop-kæœç´¢ï¼Œè¿˜åšäº†ä¸€ä¸ªèšç±»ã€‚&lt;/p&gt;</description></item><item><title>DeepTEA: Effective and Efficient Online Time-dependent Trajectory Outlier Detection</title><link>https://davidham3.github.io/blog/p/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/</link><pubDate>Fri, 09 Sep 2022 14:24:04 +0000</pubDate><guid>https://davidham3.github.io/blog/p/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/</guid><description>&lt;p&gt;PVLDB 2022. &lt;a class="link" href="https://www.vldb.org/pvldb/vol15/p1493-han.pdf" target="_blank" rel="noopener"
&gt;DeepTEA: Effective and Efficient Online Time-dependent Trajectory Outlier&lt;br&gt;
Detection&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;ç ”ç©¶å¼‚å¸¸è½¨è¿¹æ£€æµ‹ï¼Œç›®çš„æ˜¯æå–é“è·¯ä¸­è½¦è¾†çš„å¼‚å¸¸ç§»åŠ¨ã€‚å¯ä»¥å¸®åŠ©ç†è§£äº¤é€šè¡Œä¸ºï¼Œè¯†åˆ«å‡ºç§Ÿè½¦æ¬ºè¯ˆã€‚ç”±äºäº¤é€šçŠ¶å†µåœ¨ä¸åŒæ—¶é—´ä¸åŒåœ°ç‚¹ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥è¿™ä¸ªé—®é¢˜å…·æœ‰æŒ‘æˆ˜ã€‚æœ¬æ–‡æå‡ºäº†Deep-probabilistic-based time-dependent anomaly detection algorithm (DeepTEA)ã€‚ä½¿ç”¨æ·±åº¦å­¦ä¹ æ–¹æ³•ä»å¤§é‡è½¨è¿¹é‡Œé¢è·å¾—time-dependent outlinersï¼Œå¯ä»¥å¤„ç†å¤æ‚çš„äº¤é€šçŠ¶å†µï¼Œå¹¶ç²¾ç¡®åœ°æ£€æµ‹å¼‚å¸¸ç°è±¡ã€‚æœ¬æ–‡è¿˜æå‡ºäº†ä¸€ä¸ªå¿«é€Ÿçš„è¿‘ä¼¼æ–¹æ³•ï¼Œä¸ºäº†åœ¨å®æ—¶ç¯å¢ƒä¸‹æ•è·åˆ°å¼‚å¸¸è¡Œä¸ºã€‚ç›¸æ¯”SOTAæ–¹æ³•ï¼Œæœ¬æ–‡æ–¹æ³•æå‡äº†17.52%ï¼Œå¹¶ä¸”å¯ä»¥å¤„ç†ç™¾ä¸‡è®¡çš„è½¨è¿¹æ•°æ®ã€‚&lt;/p&gt;
&lt;h1 id="2-problem-definition"&gt;2. Problem Definition
&lt;/h1&gt;&lt;p&gt;Definition 1(Trajectory). è½¨è¿¹ç‚¹$p_{t_i}$æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„$(t_i, x, y)$ï¼Œåˆ†åˆ«æ˜¯æ—¶é—´æˆ³ã€çº¬åº¦ã€ç»åº¦ã€‚è½¨è¿¹$T$æ˜¯ä¸€ä¸ªè½¨è¿¹ç‚¹çš„æœ‰åºåºåˆ—ï¼Œå…¶ä¸­$t_1 &amp;lt; \dots &amp;lt; t_i &amp;lt; \dots &amp;lt; t_n$ã€‚&lt;/p&gt;
&lt;p&gt;è½¨è¿¹å¼‚å¸¸æ£€æµ‹åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯åªè€ƒè™‘ä¸æ­£å¸¸è·¯çº¿ä¸åŒçš„å¼‚å¸¸è½¨è¿¹ã€‚å¦ä¸€ç§æ˜¯è€ƒè™‘ä¸time-dependentçš„æ­£å¸¸è·¯çº¿ä¸åŒçš„å¼‚å¸¸è½¨è¿¹ã€‚&lt;/p&gt;
&lt;p&gt;Definition 2(Time-dependent Trajectory Outlier)ã€‚ç»™ä¸€æ¡è½¨è¿¹$T$ï¼Œèµ·ç‚¹$S_T$ï¼Œç»ˆç‚¹æ˜¯$D_T$ï¼Œè¿˜æœ‰travelæ—¶é—´ï¼Œä¸€ä¸ªtime-dependentè½¨è¿¹å¼‚å¸¸å®šä¹‰ä¸ºï¼šç›¸åŒçš„$S_T$å’Œ$D_T$ä»¥åŠç›¸åŒçš„å‡ºå‘ã€åˆ°è¾¾æ—¶é—´ä¸‹çš„è½¨è¿¹é‡Œé¢ï¼Œä¸€ä¸ªå¾ˆç¨€æœ‰çš„ã€ä¸åŒäºå…¶ä»–è½¨è¿¹çš„è½¨è¿¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Fig1.jpg"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸¾ä¾‹ï¼Œå¦‚æœä¸€ä¸ªè½¨è¿¹åœ¨2016å¹´10æœˆ1æ—¥çš„ä¸Šåˆ10ç‚¹å‡ºå‘ï¼Œ11ç‚¹åˆ°è¾¾ï¼Œé‚£ä¹ˆä¸€æ¡ç¨€æœ‰çš„è½¨è¿¹ä¸”å’Œç›¸åŒæ—¶é—´ç›¸åŒODçš„è½¨è¿¹ä¸åŒçš„è½¨è¿¹å°±æ˜¯è¿™ä¸ªTime-dependent Trajectory Outlier.&lt;/p&gt;
&lt;p&gt;Problem 1(Online Time-dependent Trajectory Outlier Detection)ã€‚ç»™å®šä¸€æ¡æ­£åœ¨å‰è¿›çš„è½¨è¿¹$T$ï¼Œå®æ—¶è®¡ç®—å¹¶æ›´æ–°è¿™æ¡è½¨è¿¹æ˜¯æ—¶é—´ä¾èµ–çš„å¼‚å¸¸è½¨è¿¹çš„æ¦‚ç‡ã€‚&lt;/p&gt;
&lt;h1 id="3-the-deeptea-model"&gt;3. The DeepTEA Model
&lt;/h1&gt;&lt;h2 id="31-framework"&gt;3.1 Framework
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Fig2.jpg"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®šè½¨è¿¹$T$ï¼Œåœ¨æ—…è¡Œè¿‡ç¨‹ä¸­æ¨ç®—latent traffic pattern $q(z \mid T)$ã€‚è½¨è¿¹è§‚æµ‹å€¼ $\tau$ åæ˜ æ—¶é—´ä¾èµ–çš„è½¨è¿¹è½¬ç§»ï¼Œå¯ä»¥åœ¨ inference network é‡Œé¢ç”¨æ¥å»ºæ¨¡latent time-dependent route $r$ã€‚ä¹‹åï¼Œtime-dependent route $r$ç”¨æ¥ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼$\tau$ã€‚&lt;/p&gt;
&lt;h2 id="32-latent-traffic-pattern-inference"&gt;3.2 Latent Traffic Pattern Inference
&lt;/h2&gt;&lt;p&gt;latent traffic pattern $z$ï¼Œè¡¨ç¤ºæ—…é€”è¿‡ç¨‹ä¸­çš„åŠ¨æ€äº¤é€šçŠ¶å†µï¼Œæ¯”å¦‚ ${\text{smooth} \rightarrow \text{congested} \rightarrow \text{smooth} }$ï¼Œæˆ–è€…${\text{congested} \rightarrow \text{smooth} }$ã€‚&lt;/p&gt;
&lt;h3 id="321-challenges"&gt;3.2.1 Challenges
&lt;/h3&gt;&lt;p&gt;ç»™å®šè½¨è¿¹ $T$ï¼Œæˆ‘ä»¬æƒ³åŸºäº $T$ çš„ç©ºé—´è½¬ç§»ï¼Œæ¨ç®—å‡º latent traffic pattern $q(z \mid T)$ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªè¿œè·ç¦»çš„ç§»åŠ¨è¡¨æ˜å½“æ—¶çš„äº¤é€šçŠ¶å†µæ˜¯é€šç•…çš„ã€‚ä½†æ˜¯ä¸€ä¸ªè½¨è¿¹ $T$ å¯èƒ½è¡¨ç¤ºä¸€äº›éšæœºè¡Œä¸ºï¼Œæ¯”å¦‚åœè½¦ä¼‘æ¯ï¼Œè¿™ç§è¡Œä¸ºä¸èƒ½è¡¨æ˜å½“æ—¶çš„äº¤é€šçŠ¶å†µã€‚è¿™æ˜¯åœ¨è¡¨ç¤ºå®é™…äº¤é€šæ¨¡å¼æ—¶çš„ç¬¬ä¸€ä¸ªæŒ‘æˆ˜ã€‚ç¬¬äºŒä¸ªæŒ‘æˆ˜æ˜¯äº¤é€šçŠ¶æ€åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œä¸åŒçš„æ—¶é—´æ˜¯ä¸åŒçš„ï¼ŒåŠ¨æ€çš„ã€‚åŒä¸€æ—¶é—´ï¼Œä¸åŒODä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚è€Œä¸”åœ¨æ•´ä¸ªæ—…é€”ä¸­çš„äº¤é€šçŠ¶æ€å˜åŒ–ä¹Ÿæ˜¯å‰§çƒˆçš„ã€‚å¯èƒ½å¼€å§‹çš„æ—¶å€™é¡ºç•…ï¼Œç»“æŸçš„æ—¶å€™æ‹¥å µã€‚æ•è·äº¤é€šçŠ¶æ€å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå¯¹æ—¶é—´ä¾èµ–çš„æ­£å¸¸è·¯å¾„å½±å“å¾ˆå¤§ã€‚&lt;/p&gt;
&lt;h3 id="322-design"&gt;3.2.2 Design
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†è§£å†³ç¬¬ä¸€ä¸ªæŒ‘æˆ˜ï¼Œæˆ‘ä»¬ä»æ—¶é—´ $t_i$ çš„ä¸€ç»„è½¨è¿¹ ${ T_{t_i} }$ é‡Œé¢å­¦ä¹ latent traffic pattern $z$ï¼Œè€Œä¸æ˜¯å•æ¡è½¨è¿¹ $T$ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨ time point series è¡¨ç¤ºæ—…è¡Œæ—¶é—´ã€‚ä¸ºäº†ä» ${ T_{t_i} }$ é‡Œé¢å¾ˆå¥½åœ°ç»„ç»‡äº¤é€šä¿¡æ¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª map grid matrix $Z_{t_i}$ï¼Œè¿™é‡Œé¢æ¯ä¸ªå•å…ƒè¡¨ç¤ºå¹³å‡é€Ÿåº¦ï¼Œç”¨è¿™ä¸ªå¯¹ $t_i$ çš„äº¤é€šçŠ¶æ€å»ºæ¨¡ã€‚ä»å›¾2å¯ä»¥çœ‹å‡ºï¼Œçº¢è‰²è¡¨ç¤ºé€Ÿåº¦ä½ï¼Œè¡¨ç¤ºæ‹¥å µã€‚ç»¿è‰²è¡¨ç¤ºç•…é€šã€‚é»„è‰²è¡¨ç¤ºå³å°†æ‹¥å µï¼Œå¹³å‡é€Ÿåº¦ä»‹äºçº¢ç»¿ä¹‹é—´ã€‚ä¸ºäº†è§£å†³åŒä¸€æ—¶é—´ä¸åŒä½ç½®äº¤é€šçŠ¶æ€çš„å¤šæ ·æ€§ï¼Œæˆ‘ä»¬ç”¨CNNå»ºæ¨¡ã€‚å¯¹äºæ²¡æœ‰è½¦è¾†çš„åŒºåŸŸï¼ŒCNNå¯ä»¥ä»æœ‰è½¦è¾†çš„å•å…ƒå­¦åˆ°ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å°†ä»–ä»¬è¡¨ç¤ºä¸ºç¼ºå¤±å€¼ã€‚å› ä¸ºå®æ—¶çŠ¶æ€ä¸‹äº¤é€šçŠ¶å†µå˜å¾—å¾ˆé¢‘ç¹ï¼Œæˆ‘ä»¬ç”¨RNNæ•è·è¿™ç§ä¸æ–­å˜åŒ–çš„åŠ¨æ€æ€§ï¼Œè§£å†³ç¬¬äºŒä¸ªæŒ‘æˆ˜ã€‚äº¤é€šçŠ¶æ€çš„å˜åŒ–å¯ä»¥é€šè¿‡RNNå¾ˆå¥½çš„å»ºæ¨¡ã€‚ç„¶åæˆ‘ä»¬ç”¨ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒå’ŒRNNçš„éšè—çŠ¶æ€ï¼Œæ¨ç®— latent traffic pattern $z$ã€‚CNN+RNNé€‰ç”¨äº† Convolutional LSTMã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç”¨ä¸Šé¢çš„éšæ—¶é—´å˜åŒ–çš„åŠ¨æ€äº¤é€šçŠ¶æ€æ¥æ¨ç®—latent traffic pattern $z$ã€‚è¿™é‡Œçš„æƒ³æ³•æ˜¯äº¤é€šçŠ¶æ€ä¼šå› ä¸ºå¤æ‚çš„å®æ—¶ç‰¹å¾å‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚ä¿¡å·ç¯ã€äº‹æ•…ã€æ—©æ™šé«˜å³°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨DeepTEAé‡Œé¢ä¼šéšæ—¶é—´å˜åŒ–æ›´æ–°$Z$ï¼Œè¡¨ç¤ºä¸º$Z_{t_i}$ï¼Œè¡¨ç¤ºè½¨è¿¹ç‚¹$p_{t_i}$åœ¨æ—¶é—´$t_i$çš„äº¤é€šçŠ¶æ€ã€‚æˆ‘ä»¬ä¼šä»å®é™…äº¤é€šçŠ¶å†µ$Z = { Z_{t_i}, Z_{t_{i+1}}, \dots, Z_{t_{i+n}} }$é‡Œé¢æ¨ç®—latent traffic pattern $z$ã€‚è¿™é‡Œé¢çš„äº¤é€šçŠ¶å†µå¯¹åº”çš„æ—¶é—´åˆ†åˆ«æ˜¯å¯¹åº”è½¨è¿¹ç‚¹${ p_t, p_{t+1}, \dots, p_{t_{i+n}} }$çš„æ—¶é—´ã€‚å¯¹äºçœŸå®äº¤é€šçŠ¶å†µ$Z$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è½¨è¿¹$T$ç»è¿‡çš„æ—¶é—´çš„å¹³å‡é€Ÿåº¦ã€‚æ¢å¥è¯è¯´å°±æ˜¯ï¼ŒçœŸå®äº¤é€šçŠ¶å†µ$Z_{t_i}$æ˜¯ä¸€ä¸ªå¹³å‡é€Ÿåº¦çŸ©é˜µï¼Œå®ƒåŒ…å«äº†æ•´ä¸ªåŸå¸‚åœ¨$t_i$çš„ç§»åŠ¨çŠ¶æ€ã€‚å¦‚æœä¸¤ä¸ªè½¨è¿¹ç‚¹ä¹‹é—´çš„æ—¶é—´å·®å¾ˆå°ï¼Œé‚£ä¹ˆ$Z_{t_i}$å’Œ$Z_{t_{i+1}}$å¯èƒ½ä¼šå¾ˆç›¸ä¼¼ã€‚è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦æŠŠé€Ÿåº¦æŒ‰æ—¶æ®µæå‰èšåˆèµ·æ¥ï¼Œå°±å–å¹³å‡é€Ÿåº¦ï¼Œæ¯”å¦‚10åˆ†é’Ÿçš„æ—¶æ®µï¼Œè€Œä¸å†ä½¿ç”¨æ—¶é—´ç‚¹ã€‚ä¸ºäº†å‡è½»ç¨€ç–çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨CNNå°†æœ‰è½¦è¾†çš„ä½ç½®çš„ä¿¡æ¯ä¼ æ’­åˆ°æ²¡æœ‰è½¦è¾†æ²¡æ•°æ®çš„ä½ç½®ä¸Šã€‚ä¸ºäº†æ•è·ä¸åŒæ—¶æ®µçš„åŠ¨æ€å˜åŒ–ï¼Œæˆ‘ä»¬ç”¨RNNå»ºæ¨¡æ—¶é—´ç»´åº¦çš„äº¤é€šè½¬ç§»ã€‚è¿™æ ·ï¼Œspatial traffic correlationå’Œtemporal transitioné€šè¿‡$f_1(Z)$æ¥æ•è·ï¼š&lt;/p&gt;
$$
\tag{1} f\_1(Z) = \text{RNN}(\text{CNN}(Z)),
$$&lt;p&gt;è¿™é‡Œå‡½æ•°$f_1(\cdot)$æ˜¯ä¸€ä¸ªCNN+RNNï¼ŒCNNå¯¹æ¯ä¸ª$Z_i$éƒ½ä½¿ç”¨ï¼Œç„¶åç”¨RNNå¯¹ä»–ä»¬å»ºæ¨¡ï¼Œæ•è·traffic transitionã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©æ¨¡å‹å…·æœ‰ç”Ÿæˆèƒ½åŠ›ï¼Œå¹¶ä¸”å¯¹äº¤é€šçŠ¶æ€çš„ä¸ç¡®å®šæ€§å»ºæ¨¡ï¼Œåœ¨ç»™å®šå®é™…äº¤é€šçŠ¶æ€$Z$çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç”¨é«˜æ–¯åˆ†å¸ƒå¯¹latent traffic pattern $z$å»ºæ¨¡ï¼Œå¯ä»¥ç”¨æ¥åœ¨ç»™å®šè½¨è¿¹$T$æ—¶è¿‘ä¼¼latent traffic pattern $z$çš„åˆ†å¸ƒï¼Œå¦‚å…¬å¼2æ‰€ç¤ºã€‚æˆ‘ä»¬å°†å‚æ•°è®°ä¸º$\phi$ï¼Œ&lt;/p&gt;
$$
\tag{2} q\_\phi(z \mid T) \coloneqq q\_\phi(z \mid Z) = \mathcal{N}(\mu\_Z, \text{diag}(\sigma^2\_Z)),
$$&lt;p&gt;å‡å€¼$\mu_Z$å’Œæ ‡å‡†å·®$\sigma_Z$é€šè¿‡MLPå‡½æ•° $g_1(f_1(Z))$å¾—åˆ°ï¼Œå‚æ•°æ˜¯$\phi = { f_1(\cdot), g_1(\cdot) }$ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§æ–¹å¼åœ¨ç»™å®šè½¨è¿¹$T$çš„æ—¶å€™å¯ä»¥å¾ˆå¥½çš„æ¨æ–­å‡ºlatent traffic pattern $z$ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œå‚æ•°$\phi$å¯ä»¥å­¦åˆ°å¦‚ä½•æ•è·latent traffic pattern $z$ï¼Œè€Œä¸”èƒ½è¡¨ç¤ºäº¤é€šçŠ¶æ€çš„å¤šæ ·æ€§å’ŒåŠ¨æ€æ€§ã€‚&lt;/p&gt;
&lt;h2 id="33-latent-time-dependent-route-inference"&gt;3.3 Latent Time-dependent Route Inference
&lt;/h2&gt;&lt;h3 id="331-challenges"&gt;3.3.1 Challenges
&lt;/h3&gt;&lt;p&gt;è½¨è¿¹$T$ä¸ä»…å¯ä»¥è¡¨ç¤ºä½ç½®ä¿¡æ¯ï¼Œè¿˜å¯ä»¥è¡¨ç¤ºä¸¤ä¸ªè½¨è¿¹ç‚¹ä¹‹é—´è½¬ç§»çš„latent traffic pattern $z$ã€‚ç›¸æ¯”åªæœ€å¤§åŒ–ä½ç½®ä¿¡æ¯çš„ä¼¼ç„¶ï¼Œå¯¹ä½ç½®å’Œlatent traffic pattern $z$åŒæ—¶åšæ›´informativeï¼Œå› ä¸ºå®ƒå¯ä»¥åæ˜ åœ¨æ—¶é—´ä¾èµ–çš„äº¤é€šçŠ¶æ€ä¸‹çš„è½¨è¿¹è½¬ç§»ã€‚&lt;/p&gt;
&lt;h3 id="332-design"&gt;3.3.2 Design
&lt;/h3&gt;&lt;p&gt;ä¸€æ¡è½¨è¿¹ $T$ ä¸ä»…èƒ½åæ˜ ä½ç½® $p_{t_i}$ï¼Œè¿˜èƒ½åŸºäºä¸¤ä¸ªè¿ç»­è½¨è¿¹ç‚¹ $p_{t_{i-1}}$ å’Œ $p_{t_i}$ ä¹‹é—´çš„è½¬ç§»ï¼Œä¼ é€’å‡º latent traffic pattern $z$ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨ $o(p_{t_i}, z)$ è¡¨ç¤ºè½¨è¿¹ $T$ èƒŒåçš„è§‚æµ‹å€¼ $\tau_i$ã€‚è¿™é‡Œå¸Œæœ›ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œå¤„ç†è§‚æµ‹å€¼ $p_{t_i}$ å’Œ $z$ï¼š&lt;/p&gt;
$$
\tag{3} \tau\_i = o(p\_{t\_i}, z) = f\_2(p\_{t\_i}, z) = \text{NN}(p\_{t\_i}, z),
$$&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œå­¦ä¹  latent traffic pattern $z$ çš„è§‚æµ‹å€¼ $p_{t_i}$ï¼š&lt;/p&gt;
$$
\tag{4} \text{NN}(p\_{t\_i}, z) = W p\_{t\_i} + Q z,
$$&lt;p&gt;$\text{NN}$çš„å‚æ•°æ˜¯$W$å’Œ$Q$ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬å­¦ä¹ ä¸€æ¡è½¨è¿¹ $T$ ç»è¿‡çš„ latent time-dependent route $r$ã€‚æˆ‘ä»¬è§£é‡Šè¿‡ï¼Œè½¨è¿¹ $T$ ä¸ä»…èƒ½è¡¨ç¤ºè½¨è¿¹ç‚¹ $p_{t_i}$ çš„ä½ç½®ä¿¡æ¯ï¼Œè¿˜èƒ½æŒ‡æ˜ä¸¤ä¸ªè½¨è¿¹ç‚¹ä¹‹é—´è½¬ç§»çš„ latent traffic pattern $z$ã€‚latent time-dependent route $r$ çš„å«ä¹‰å¯ä»¥è§£é‡Šä¸ºï¼šé«˜å³°æ—¶é—´æ®µåŸå¸‚è·¯æ®µçš„äº¤é€šçŠ¶æ€æ˜¯æ‹¥å µçš„ï¼Œé©¾é©¶å‘˜é€šå¸¸ä¼šä¸Šé«˜é€Ÿï¼Œå› ä¸ºé‚£é‡Œä¼šç•…é€šã€‚&lt;/p&gt;
&lt;p&gt;è½¨è¿¹ $T$ ç»è¿‡çš„ latent time-dependent route $r$ çš„è¡¨ç¤ºä¸ºï¼š&lt;/p&gt;
$$
\tag{5} r\_T \sim q\_\gamma (r \mid T),
$$&lt;p&gt;$\gamma$ æ˜¯æ¨æµ‹ latent time-dependent route $r$ æ—¶çš„å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;åŸºäºä¹‹å‰çš„è½¨è¿¹ç‚¹å’Œ latent traffic pattern $z$ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨RNNè·å¾—è½¨è¿¹è§‚æµ‹å€¼ä¹‹é—´çš„è½¬ç§»ï¼ŒRNNè®°ä¸º $f_3$ï¼Œè¿™é‡Œä½¿ç”¨GRUï¼š&lt;/p&gt;
$$
\tag{6} h\_i = f\_3 (h\_{i-1}, \tau\_i),
$$&lt;p&gt;$h_{i-1}$ æ˜¯ä¹‹å‰è§‚æµ‹å€¼ $\tau_{i-1}$ çš„éšè—çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è½¨è¿¹ç‚¹ $p_{t_{i-1}}$ å¸¦ç€ latent traffic pattern $z$ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè½¨è¿¹è§‚æµ‹å€¼çš„ä¸ç¡®å®šæ€§ï¼Œæˆ‘ä»¬é€šè¿‡é«˜æ–¯åˆ†å¸ƒå»ºæ¨¡ $q_\gamma (r \mid T)$ï¼š&lt;/p&gt;
$$
\tag{7} q\_\gamma (r \mid T) = \mathcal{N} (\mu\_T, \text{diag}(\sigma^2\_T)),
$$&lt;p&gt;æˆ‘ä»¬ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œ $g_3(h_n)$ æ¥å­¦ä¹ å‡å€¼å’Œæ ‡å‡†å·®ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†åœ¨ latent traffic pattern é‡Œé¢åŒºåˆ†æ­£å¸¸çš„è½¨è¿¹è½¬ç§»å’Œå¼‚å¸¸çš„è½¨è¿¹è½¬ç§»ï¼Œéœ€è¦è®¾è®¡ä¸€ä¸ªæ¨¡å—å¯¹è½¨è¿¹é‡Œ latent time-dependent normal routeå»ºæ¨¡ï¼Œè¿™é‡Œ $z$ ä¼šæä¾› time-dependent traffic ä¿¡æ¯ã€‚ä½¿ç”¨é«˜æ–¯åˆ†å¸ƒï¼š&lt;/p&gt;
$$
\tag{8} p\_\gamma (r \mid k, z) = \mathcal{N}(\mu\_r, \text{diag}(\sigma^2\_r)),
$$&lt;p&gt;$k$ è¡¨ç¤º latent time-dependent route çš„ç±»å‹ï¼Œæœä»å¤šé¡¹å¼åˆ†å¸ƒï¼š&lt;/p&gt;
$$
\tag{9} p\_\gamma (k) = \text{Mult} (\pi),
$$&lt;p&gt;$\pi$ æ˜¯å¤šé¡¹å¼åˆ†å¸ƒçš„å‚æ•°ã€‚ç„¶åï¼Œè¶‹è¿‘ $q_\gamma (r \mid T)$ çš„å‡å€¼çš„ latent time-dependent route æ˜¯time-dependent normal routeã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œæ¨æ–­ç½‘ç»œå¯ä»¥ä»ç»™å®šçš„è½¨è¿¹ $T$ é‡Œé¢æ¨ç®— latent time-dependent route $r$ï¼Œlatent time-dependent route type $k$ï¼Œè¿˜æœ‰ latent traffic pattern $z$ ä¸º $q_{\gamma,\phi}(r, k, z \mid T)$ã€‚é€šè¿‡ä½¿ç”¨ mean-field approximationï¼Œå¯ä»¥åˆ†è§£ä¸ºï¼š&lt;/p&gt;
$$
\tag{10} q\_{\gamma,\phi}(r, k, z \mid T) = q\_\gamma(r \mid T) \ q\_\phi(z \mid T) \ q\_\gamma (k \mid T),
$$&lt;p&gt;$q_\gamma (k \mid T)$ å¯ä»¥è½¬æ¢ä¸ºåœ¨ç»™å®š è½¨è¿¹ $T$ ç»è¿‡ latent time-dependent route $r$ çš„æ¡ä»¶ä¸‹ï¼Œroute type $k$ çš„åˆ†å¸ƒï¼š&lt;/p&gt;
$$
\tag{11} q\_\gamma (k \mid T) \coloneqq p\_\gamma (k \mid r\_T) = \frac{p\_\gamma (k) p\_\gamma (r\_T \mid k)}{\sum^K\_{i=1} p\_\gamma (k\_i) p\_\gamma (r\_T \mid k\_i)},
$$&lt;p&gt;$K$ æ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼Œè¡¨ç¤º route ç±»å‹çš„ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œæ¨æ–­ç½‘ç»œå¯ä»¥ä»è½¨è¿¹ $T$ çš„è§‚æµ‹å€¼ $o(p_{t_i}, z)$ æ¨æ–­å‡º latent time-dependent route $r$ã€‚$\gamma = { f_2(\cdot), f_3(\cdot), g_3(\cdot), \pi, \mu_r, \sigma_r }$ è¿™äº›éƒ½æ˜¯å‚æ•°ã€‚&lt;/p&gt;
&lt;h2 id="34-trajectory-observation-generation"&gt;3.4 Trajectory Observation Generation
&lt;/h2&gt;&lt;p&gt;ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼çš„ç›®æ ‡æ˜¯ç»™å®š latent time-dependent route $r$ï¼Œtime-dependent route type $k$ å’Œ latent traffic pattern $z$ æ—¶ï¼Œæœ€å¤§åŒ–ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ çš„æ¦‚ç‡ï¼Œä¹Ÿå°±æ˜¯ $o(p_{t_i}, z)$ã€‚è¿™ä¸ªæ¦‚ç‡è®°ä¸º $p_\theta (T \mid r, z, k)$ï¼Œ$\theta$ è¡¨ç¤ºç”¨äºç”Ÿæˆè¿‡ç¨‹çš„å‚æ•°ã€‚ä»å¯¹ç§°çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬ç”¨RNNæ¥ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ï¼Œä¹Ÿå°±æ˜¯ $o(p_{t_i}, z)$ï¼š&lt;/p&gt;
$$
\tag{12} \begin{align} \eta\_i &amp;= f\_4 (\tau\_i, \eta\_{i-1}) \\ &amp;= f\_4(o(p\_{t\_i}, z), \eta\_{i-1}) \\ &amp;= \text{RNN} (o(p\_{t\_i}, z), \eta\_{i-1}), i = 1, 2, \dots, n, \ and \ \eta\_o = r, \end{align}
$$&lt;p&gt;RNNçš„èµ·å§‹è¾“å…¥æ˜¯ $\eta_0$ã€‚ä» $\eta_1$ å¼€å§‹ï¼Œè¾“å…¥å˜æˆä¸Šä¸€ä¸ªéšè—çŠ¶æ€ $\eta_{i-1}$ å’Œè½¨è¿¹è§‚æµ‹å€¼ $o(p_{t_i}, z)$ã€‚å› æ­¤ï¼Œè§‚æµ‹å€¼ $\tau_i$ï¼Œä¹Ÿå°±æ˜¯ $p_{t_i}$ åœ¨ latent traffic pattern $z$ çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å…¬å¼ç”Ÿæˆï¼š&lt;/p&gt;
$$
\tag{13} \begin{align} \tau\_i &amp;= o(p\_{t\_i}, z) \sim p\_\theta (o(p\_{t\_i}, z) \mid o(p\_{1:i-1}, z), r) \\ &amp;= p\_\theta(\tau \mid \eta\_{i-1}) \\ &amp;= \text{Mult}(\text{softmax}(g\_4 (\eta\_{i-1}))), \end{align}
$$&lt;p&gt;$g_4(\cdot)$æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠè¾“å‡ºæ˜ å°„åˆ°ç½‘æ ¼çš„ä¸ªæ•°ã€‚softmax ç”¨æ¥æŠŠæ¦‚ç‡çš„å’Œå˜æˆ1ã€‚ç„¶åè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ å¯ä»¥é€šè¿‡å¤šé¡¹å¼åˆ†å¸ƒç”Ÿæˆã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ï¼Œä¹Ÿå°±æ˜¯ $o(p_{t_i}, z)$ï¼Œå¯ä»¥åŸºäº latent time-dependent route $r$ï¼Œroute type $k$ å’Œ latent traffic pattern $z$ ç”Ÿæˆã€‚æˆ‘ä»¬ç»™ç”Ÿæˆç”¨çš„å‚æ•°è®°ä¸º $\theta = { f_4(\cdot), g_4(\cdot) }$ã€‚è¿™äº›å‚æ•°ä¼šåœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­å­¦åˆ°ã€‚&lt;/p&gt;
&lt;h2 id="35-optimization"&gt;3.5 Optimization
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ä¸Šé¢è®²äº†ï¼Œè½¨è¿¹è§‚æµ‹å€¼ä¸ä»…èƒ½åæ˜ ä½ç½®ä¿¡æ¯ï¼Œè¿˜èƒ½åŸºäºä¸¤ä¸ªè¿ç»­çš„è½¨è¿¹ç‚¹çš„è½¬ç§»ä¼ é€’å‡º latent traffic patternã€‚å› æ­¤ï¼Œç›®æ ‡å‡½æ•°æ˜¯æœ€å¤§åŒ–è§‚æµ‹åˆ°çš„è½¨è¿¹çš„è¾¹ç¼˜å¯¹æ•°ä¼¼ç„¶ï¼š&lt;/p&gt;
$$
\tag{14} \log p\_\theta(T^{(1)}, T^{(2)}, \dots, T^{(N)}) \coloneqq \log p\_\theta (\tau^{(1)}, \tau^{(2)}, \dots, \tau^{(N)}).
$$&lt;p&gt;æˆ‘ä»¬é€šè¿‡æœ€å¤§åŒ–ELBOæ¥ä¼˜åŒ–ä¸Šé¢çš„è¾¹ç¼˜å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š&lt;/p&gt;
$$
\tag{15} \log p\_\theta (T) \geq \text{ELBO} = \mathcal{L}(\phi, \gamma, \theta; T).
$$&lt;p&gt;è½¨è¿¹ $T$ çš„è¾¹ç¼˜å¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„ ELBO é€šè¿‡ä¸‹é¢çš„å…¬å¼è®¡ç®—ï¼š&lt;/p&gt;
$$
\tag{16} \begin{align} \mathcal{L}(\phi, \gamma, \theta; T) &amp;= \mathbb{E}\_{q\_{\gamma, \phi}(r, k, z \mid T)}[ \log \frac{p\_{\phi, \gamma, \theta}(r, k, z, T)}{q\_{\gamma, \theta}(r, k, z \mid T)}] \\ &amp;= - \mathbb{E}\_{q\_\gamma(r \mid T)} D\_{KL} (q\_\gamma (k \mid T) \Vert p\_\gamma (k)) \\ &amp; - \mathbb{E}\_{q\_\gamma (k \mid T)} D\_{KL} ( q\_\gamma (r \mid T) \Vert p\_\gamma (r \mid k, z)) \\ &amp; - D\_{KL} (q\_\phi (z \mid T) \Vert p\_\phi(z)) + \mathbb{E}\_{q\_{\gamma, \phi}(r, k, z \mid T)} \log p\_\theta (T \mid r, z, k), \end{align}
$$&lt;p&gt;å…¶ä¸­ï¼Œ$p_\theta(z)$ æ˜¯ latent traffic pattern $z$ çš„å…ˆéªŒæ¦‚ç‡ã€‚ç”Ÿæˆç½‘ç»œ $\log p_\theta(T \mid r, z, k)$ å¯ä»¥é€šè¿‡ä¸‹é¢å…¬å¼è®¡ç®—ï¼š&lt;/p&gt;
$$
\tag{17} \log p\_\theta (T \mid r, z, k) = \sum^n\_{i=1} \log p\_\theta (\tau\_i \mid \tau\_{1: i-1}, r, z, k)
$$&lt;p&gt;æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹çš„ç®—æ³•å¦‚ç®—æ³•1æ‰€ç¤ºã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹å‚æ•°é€šè¿‡ä¼˜åŒ–è½¨è¿¹ $T$ çš„ ELBO æ¥å­¦ä¹ ã€‚ç„¶åè¿™äº›å­¦åˆ°çš„å‚æ•°ä¼šç”¨äº online anomaly detectionï¼Œåé¢ä¼šä»‹ç»ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Algo1.jpg"
loading="lazy"
alt="Algo1"
&gt;&lt;/p&gt;
&lt;h2 id="36-complexity-analysis"&gt;3.6 Complexity Analysis
&lt;/h2&gt;&lt;p&gt;è®­ç»ƒ DeepTEA çš„å¤æ‚åº¦æ˜¯ $O(N \cdot (d_{Z_1} d_{Z_2} \bar{V} + \bar{n}))$ï¼Œ$N$ æ˜¯è½¨è¿¹æ•°ï¼Œ$d_{Z_1}$ å’Œ $d_{Z_2}$ æ˜¯ $Z$ çš„å¤§å°ï¼Œ$\bar{V}$ æ˜¯æ—¶é—´é—´éš”çš„å¹³å‡ä¸ªæ•°ï¼Œ$\bar{n}$ æ˜¯è½¨è¿¹çš„å¹³å‡é•¿åº¦ã€‚&lt;/p&gt;
&lt;h1 id="online-trajectory-outlier-detection-by-deeptea"&gt;Online Trajectory Outlier Detection by DeepTEA
&lt;/h1&gt;&lt;p&gt;åŸºäºç®—æ³•1å­¦ä¹ å¾—åˆ°çš„å‚æ•°ï¼Œå½“ä¸‹ä¸€ä¸ªè½¨è¿¹è§‚æµ‹å€¼ $\tau_{i+1}$ å®æ—¶è¿‡æ¥çš„æ—¶å€™ï¼Œå¼‚å¸¸åˆ†æ•°ä¼šå®æ—¶æ›´æ–°ã€‚è¿™ä¸ªè¿‡ç¨‹è¦å¿«ã€‚è€Œä¸”ç›´åˆ°è½¨è¿¹å®Œæˆï¼Œè¿™ä¸ªå¼‚å¸¸åˆ†æ•°éƒ½è¦æ›´æ–°ã€‚&lt;/p&gt;
&lt;h2 id="41-online-detection-by-generation"&gt;4.1 Online Detection by Generation
&lt;/h2&gt;&lt;p&gt;å›¾3å±•ç¤ºäº†åœ¨çº¿å¼‚å¸¸è½¨è¿¹æ£€æµ‹çš„æ­¥éª¤ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Fig3.jpg"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬é€šè¿‡å­¦åˆ°çš„ç½‘ç»œç”Ÿæˆè§‚æµ‹åˆ°çš„è½¨è¿¹æ¥æ£€æµ‹å¼‚å¸¸ã€‚latent time-dependent route çš„åˆ†å¸ƒ $q_\gamma (r \mid T)$ å¯ä»¥é€šè¿‡å‚æ•° $\gamma$ æ¥è®¡ç®—ã€‚latent traffic pattern $z$ å¯ä»¥é€šè¿‡å‚æ•° $\phi$ å’Œ $Z$ è·å¾—ã€‚ç»™å®š $q_\gamma (r \mid T)$ é‡Œé¢ç¬¬ $k$ ä¸ªå‡å€¼ $u_k$ï¼Œæˆ‘ä»¬ç”¨ RNN ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼ï¼š&lt;/p&gt;
$$
\tag{18} \eta\_i = f\_4(\tau\_i, \eta\_{i-1}) = \text{RNN} (\tau\_i, \eta\_{i - 1}), i = 1, 2, \dots, n, \text{and} \ \eta\_0 = u\_k,
$$&lt;p&gt;RNNçš„èµ·å§‹è¾“å…¥æ˜¯ $\eta_0$ï¼Œè¿™é‡Œè®¾ç½®ä¸º $u_k$ã€‚ä» $\eta_1$ å¼€å§‹ï¼Œè¾“å…¥æ ‡ç§°éšè—çŠ¶æ€ $\eta_{i-1}$ å’Œè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ï¼Œå³ $o(p_{t_i}, z)$ã€‚å› æ­¤ $\tau_{i+1}$ å¯ä»¥ç”¨ä¸‹é¢çš„å…¬å¼ç”Ÿæˆï¼š&lt;/p&gt;
$$
\tag{19} p\_\theta (\tau\_{i+1} \mid \tau\_{i:i}, u\_k) = \text{softmax}(g\_4 (\eta\_{i-1})),
$$&lt;p&gt;$g_4(\cdot)$ æ˜¯ç”¨æ¥æŠŠè¾“å‡ºæ˜ å°„åˆ°ç½‘æ ¼æ•°çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®šå­¦åˆ°çš„ $q_\gamma (r \mid T)$ å’Œ latent traffic pattern $z$ï¼Œè½¨è¿¹ $T$ çš„å®æ—¶å¼‚å¸¸åˆ†æ•° $s_a(\tau_{i:i})$ å¯ä»¥è®¡ç®—ä¸º 1 - ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼ $\tau_{i:i}$ çš„ä¼¼ç„¶ï¼Œå³ ${ \tau_1 \rightarrow \tau_2 \rightarrow \dots \tau_i }$ï¼š&lt;/p&gt;
$$
\tag{20} s\_a(\tau\_{i:i}) = 1 - \arg \max\_k \exp [\frac{\sum^n\_{i=1} \log p\_\theta (\tau\_i \mid \tau\_{1:i-1}, u\_k)}{n}]
$$&lt;p&gt;åœ¨çº¿ä¸Šåœºæ™¯ä¸‹ï¼Œç»™å®šä¹‹å‰çš„è½¨è¿¹è§‚æµ‹å€¼ $\tau_{i:i}$ï¼Œä¸‹ä¸€ä¸ªè½¨è¿¹è§‚æµ‹å€¼çš„å¼‚å¸¸åˆ†æ•°å¯ä»¥é€šè¿‡ä¹‹å‰è¿™ä¸ªæ•°æ¥è®¡ç®—ï¼š&lt;/p&gt;
$$
\tag{21} s\_a(\tau\_{i:i+1}) = 1 - \arg \max\_k \exp [\frac{\log p\_\theta (\tau\_{1:i} \mid u\_k) p\_\theta(\tau\_{i+1} \mid \tau\_{1:i}, u\_k)}{i + 1}]
$$&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Algo2.jpg"
loading="lazy"
alt="Algo2"
&gt;&lt;/p&gt;
&lt;p&gt;ç®—æ³•2æ˜¯åœ¨çº¿æ£€æµ‹çš„è¿‡ç¨‹ã€‚è¾“å…¥æ˜¯è½¨è¿¹ $T$ï¼Œå‚æ•°æ˜¯ä»ç®—æ³•1å­¦åˆ°çš„ã€‚å¯¹äºæ–°æ¥çš„è½¨è¿¹è§‚æµ‹å€¼ $\tau_{i+1}$ï¼Œå¦‚æœ latent traffic pattern $z$ å˜äº†ï¼Œé‚£æˆ‘ä»¬å°±æ›´æ–° $z$ã€‚ç„¶ååŸºäº $\tau_{1:i}$ è®¡ç®— $\tau_{1:i+1}$ã€‚æœ€åè¿”å›å¼‚å¸¸åˆ†æ•°ã€‚&lt;/p&gt;
&lt;h2 id="42-complexity-analysis"&gt;4.2 Complexity Analysis
&lt;/h2&gt;&lt;p&gt;æ•´ä¸ªæ£€æµ‹çš„å¤æ‚åº¦æ˜¯ $\mathcal{O}(d_{Z_1} d_{Z_2})$ï¼Œ$d_{Z_1}$ å’Œ $d_{Z_2}$ æ˜¯ $Z$ çš„å¤§å°ã€‚&lt;/p&gt;
&lt;h1 id="5-the-deeptea-a-model-approximate-online-detection"&gt;5 The DeepTEA-A Model: Approximate Online Detection
&lt;/h1&gt;&lt;h2 id="51-approximation-algorithm"&gt;5.1 Approximation Algorithm
&lt;/h2&gt;&lt;h3 id="511-challenge"&gt;5.1.1 Challenge
&lt;/h3&gt;&lt;p&gt;åŸºäº $\tau_{1:i}$ çš„å¼‚å¸¸åˆ†æ•°æ›´æ–°ä¾èµ– $t_{i+1}$ çš„äº¤é€šçŠ¶æ€çŸ©é˜µ $Z$ï¼Œå¦‚æœè·¯ç½‘å¾ˆå¤§ï¼Œè¿™é‡Œè€—æ—¶ä¼šé•¿ã€‚&lt;/p&gt;
&lt;h3 id="512-design"&gt;5.1.2 Design
&lt;/h3&gt;&lt;p&gt;å— GM-VSAE çš„å¯å‘ï¼Œæœ¬æ–‡æå‡ºäº†è¿‘ä¼¼ç®—æ³•ã€‚ä½¿ç”¨ $\tau_1$ çš„æ—¶æ®µçš„äº¤é€šçŠ¶æ€çŸ©é˜µ $Z$ ä½œä¸ºæ•´ä¸ª trip è¿‡ç¨‹çš„äº¤é€šçŠ¶å†µçš„è¿‘ä¼¼ã€‚è¿™æ ·ï¼Œ$Z$ åªè¦åœ¨ç¬¬ä¸€ä¸ªè½¨è¿¹è§‚æµ‹å€¼ $\tau_1$ çš„æ—¶å€™ç®—ä¸€ä¸‹å°±å¥½äº†ã€‚online æ›´æ–°çš„æ—¶å€™å°±ä¸éœ€è¦å†ç®—è¿™ä¸ªäº†ã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªèµ·ç‚¹ $S_T$ å’Œç»ˆç‚¹ $D_T$ï¼Œä» $q(k \mid S_T, D_T, z_{S_T})$ è¿™é‡Œé¢å–å‡ºæœ€ä¼˜çš„ latent route type $k$ æ¥è¿‘ä¼¼æœ€æœ‰ latent route pattern $u_k$ï¼Œè¿™éœ€è¦ä» $q_\gamma (r \mid T)$ çš„ $k$ ä¸ªå‡å€¼é‡Œé¢æ‰¾ï¼Œ$Z_{S_T}$ æ˜¯ trip å¼€å§‹æ—¶çš„äº¤é€šçŠ¶å†µã€‚è¿™æ ·ï¼Œæœ€ä¼˜çš„ latent route type $k$ åœ¨ trip ä¸€å¼€å§‹çš„æ—¶å€™å°±èƒ½æ‹¿åˆ°ã€‚ä»ç¬¬äºŒä¸ªè½¨è¿¹è§‚æµ‹å€¼å¼€å§‹ï¼Œè¿™ä¸ª $k$ å°±ä¸éœ€è¦å†ç®—äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºèµ·ç‚¹ $S_T$ï¼Œäº¤é€šçŠ¶å†µ $Z_{S_T}$ çš„éšè—çŠ¶æ€å¯ä»¥é€šè¿‡ä¸‹é¢å…¬å¼è®¡ç®—ï¼š&lt;/p&gt;
$$
\tag{22} f\_1(Z\_{S\_T}) = \text{CNN} (Z\_{S\_T}),
$$&lt;p&gt;ç„¶å $z_{S_T}$ å¯ä»¥ä» $q_\phi (z_{S_T} \mid Z_{S_T})$ é‡Œé¢é‡‡æ ·å¾—åˆ°ï¼š&lt;/p&gt;
$$
\tag{23} q\_\phi (z\_{S\_T} \mid Z\_{S\_T}) = \mathcal{N}(\mu\_{Z\_{S\_T}}, diag(\sigma^2\_{Z\_{S\_T}})),
$$&lt;p&gt;ç„¶åï¼Œ$\tau_{S_T}$ å¯ä»¥é€šè¿‡ $f_2(\cdot)$ å¾—åˆ°ï¼š&lt;/p&gt;
$$
\tag{24} \tau\_{S\_T} = f\_2(S\_T, z\_{S\_T}) = \text{NN}(S\_T, z\_{S\_T}) = W S\_T + Q z\_{S\_T},
$$&lt;p&gt;åŒç†ï¼Œ$\tau_{D_T}$ æŒ‰åŒæ ·çš„æ–¹å¼è®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶å $q(k \mid S_T, D_T, z_{S_T})$ é€šè¿‡ MLP è®¡ç®—ï¼š&lt;/p&gt;
$$
\tag{25} q(k \mid S\_T, D\_T, z\_{S\_T}) = \text{softmax}(f\_t(\tau\_{S\_T}, \tau\_{D\_T})),
$$&lt;p&gt;$f_5$ å°±æ˜¯ MLPã€‚å‚æ•°è®°ä¸º $\delta = { f_5 (\cdot) }$ã€‚&lt;/p&gt;
&lt;p&gt;å…¬å¼20é‡Œé¢ï¼Œä¸ºäº†è·å¾—æœ€ä¼˜çš„ $k$ï¼Œéœ€è¦è·‘ $k$ æ¬¡ã€‚ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯é€šè¿‡ $q_\gamma (k \mid T)$ ä»è½¨è¿¹ $T$ é‡Œé¢æ‰¾åˆ°æœ€ä¼˜çš„ $k$ã€‚å› æ­¤ $q(k \mid S_T, D_T, z_{S_T})$ å’Œ $q_\gamma (k \mid T)$ è¦å°½å¯èƒ½çš„ç›¸è¿‘ã€‚æˆ‘ä»¬ç”¨äº¤å‰ç†µæœ€å°åŒ–ä¸¤ä¸ªåˆ†å¸ƒçš„å·®åˆ«ï¼š&lt;/p&gt;
$$
\tag{26} l\_k = - \sum^K\_{k=1} q\_\gamma (k \mid T) \log q(k \mid S\_T, D\_T, z\_{S\_T}),
$$&lt;p&gt;è¿™ä¸ªäº¤å‰ç†µ $l_k$ ä¼šå’Œå…¬å¼ 16 çš„ELBOåŒæ—¶è®­ç»ƒã€‚ç„¶ååœ¨çº¿æ£€æµ‹é˜¶æ®µçš„æ—¶å€™ï¼Œæœ€ä¼˜çš„ $k$ æ˜¯ $q(k \mid S_T, D_T, z_{S_T})$ é‡Œé¢æœ€é«˜æ¦‚ç‡çš„é‚£ä¸ªã€‚ç„¶åç›´æ¥å°±èƒ½æ‹¿åˆ°æœ€ä¼˜ latent time-dependent route $u_k$ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿‘ä¼¼ç®—æ³•çš„è®­ç»ƒè¿‡ç¨‹å’Œç®—æ³•1ä¸ä¸€æ ·ã€‚é¦–å…ˆï¼Œäº¤é€šçŠ¶å†µçš„ä½¿ç”¨ä¸ä¸€æ ·ï¼Œè¿‘ä¼¼ç®—æ³•åªç”¨äº† $Z_{S_T}$ã€‚ç¬¬äºŒï¼Œå…¬å¼26ï¼Œæ˜¯ä¸€ä¸ª co-training è¿‡ç¨‹ï¼Œä¸ºäº†è¿‘ä¼¼ä¸¤ä¸ªåˆ†å¸ƒã€‚è®­ç»ƒåå¾—åˆ°æ¨¡å‹å‚æ•° $\phi, \gamma, \theta, \delta$ã€‚æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹å¦‚ç®—æ³•3æ‰€ç¤ºã€‚å…ˆä» $Z_{S_T}$ é‡Œé¢è·å¾— $z_{S_T}$ã€‚ç„¶åè·å¾—æœ€ä¼˜çš„ latent time-dependent route $u_k$ï¼Œè¿™ä¸ªæ•°åªè¦åœ¨è½¨è¿¹å¼€å§‹çš„æ—¶å€™ç®—ä¸€ä¸‹å°±å¥½äº†ã€‚ç„¶ååŸºäº $p_\theta(\tau_{1:i} \mid u_k)$ æ›´æ–°å¼‚å¸¸åˆ†æ•°å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;h2 id="52-complexity-analysis"&gt;5.2 Complexity Analysis
&lt;/h2&gt;&lt;p&gt;åœ¨çº¿æ£€æµ‹çš„å¤æ‚åº¦ $\mathcal{O}(d_{h_t}(d_{h_t} + d_{\tau_i}))$ã€‚è¿™é¡¹æ˜¯æ–°çš„è½¨è¿¹è§‚æµ‹å€¼ $\tau_{i+1}$ åˆ°æ¥çš„æ—¶å€™ RNN çš„å˜æ¢è¿‡ç¨‹çš„å¤æ‚åº¦ã€‚å› ä¸º $d_{h_t}, d_{\tau_i}$ æ˜¯å¸¸æ•°ï¼Œæ‰€ä»¥è¿‘ä¼¼ç®—æ³•çš„å¤æ‚åº¦æ˜¯ $\mathcal{O}(1)$&lt;/p&gt;</description></item></channel></rss>