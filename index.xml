<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Davidhamçš„åšå®¢</title><link>https://davidham3.github.io/blog/</link><description>Recent content on Davidhamçš„åšå®¢</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 24 Feb 2026 00:00:00 +0000</lastBuildDate><atom:link href="https://davidham3.github.io/blog/index.xml" rel="self" type="application/rss+xml"/><item><title>ä»130å€æ€§èƒ½æå‡çœ‹Pythonçš„æ‰¹é‡è®¡ç®—å’Œå¹¶è¡ŒåŒ–ç­–ç•¥ï¼štraj-dist-rsçš„å¹¶è¡Œç­–ç•¥å®ç°</title><link>https://davidham3.github.io/blog/p/%E4%BB%8E130%E5%80%8D%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87%E7%9C%8Bpython%E7%9A%84%E6%89%B9%E9%87%8F%E8%AE%A1%E7%AE%97%E5%92%8C%E5%B9%B6%E8%A1%8C%E5%8C%96%E7%AD%96%E7%95%A5traj-dist-rs%E7%9A%84%E5%B9%B6%E8%A1%8C%E7%AD%96%E7%95%A5%E5%AE%9E%E7%8E%B0/</link><pubDate>Tue, 24 Feb 2026 00:00:00 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E4%BB%8E130%E5%80%8D%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87%E7%9C%8Bpython%E7%9A%84%E6%89%B9%E9%87%8F%E8%AE%A1%E7%AE%97%E5%92%8C%E5%B9%B6%E8%A1%8C%E5%8C%96%E7%AD%96%E7%95%A5traj-dist-rs%E7%9A%84%E5%B9%B6%E8%A1%8C%E7%AD%96%E7%95%A5%E5%AE%9E%E7%8E%B0/</guid><description>&lt;p&gt;åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘åˆ†äº«äº†å¦‚ä½•ç”¨ Rust é‡å†™ &lt;code&gt;traj-dist&lt;/code&gt;ï¼Œå®ç°äº†å•æ¬¡è·ç¦»è®¡ç®—çš„æ€§èƒ½æå‡ã€‚ä½†æ˜¯ï¼Œå½“é¢å¯¹å¤§è§„æ¨¡è½¨è¿¹æ•°æ®é›†æ—¶ï¼Œå•æ¬¡è°ƒç”¨å¹¶ä¸æ˜¯æœ€ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬è¦åšè½¨è¿¹åºåˆ—çš„èšç±»ï¼Œé‚£ä¹ˆå°±ä¸€å®šè¦è®¡ç®—ä»»æ„ä¸¤æ¡è½¨è¿¹ä¹‹é—´çš„è·ç¦»ã€‚ä»¥åŠ¨æ€è§„åˆ’ç±»ç®—æ³•ä¸ºä¾‹ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯&lt;code&gt;O(NM)&lt;/code&gt;ã€‚å‡å¦‚æœ‰ 1000 æ¡è½¨è¿¹ï¼Œéœ€è¦è®¡ç®—å®ƒä»¬ä¹‹é—´çš„æ‰€æœ‰è·ç¦»å¯¹ã€‚é‚£å°±æ˜¯ $1000 \times 1000 \times MN$ï¼Œå‡è®¾è½¨è¿¹å¹³å‡é•¿åº¦æ˜¯1000ï¼Œé‚£è‡³å°‘æœ‰1000^4çš„å¤æ‚åº¦ã€‚é‚£å¦‚æœè¦ç®—10ä¸‡æ¡è½¨è¿¹ä¹‹é—´çš„è·ç¦»å‘¢ï¼Ÿ1000ä¸‡å‘¢ï¼Ÿè¿™å°†æ˜¯éå¸¸å¤§çš„è®¡ç®—é‡ï¼ˆè‚¯å®šè¦ä¸Šåˆ†å¸ƒå¼äº†ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¼šåˆ†äº« &lt;code&gt;traj-dist-rs&lt;/code&gt; çš„æ‰¹é‡è®¡ç®—æ¥å£å’Œå¹¶è¡ŒåŒ–ç­–ç•¥ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡æ­£ç¡®çš„æŠ€æœ¯è·¯çº¿å®ç°è¶…è¿‡&lt;strong&gt;130å€&lt;/strong&gt;çš„æ€§èƒ½æå‡ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè½¨è¿¹åºåˆ—èšç±»ã€knnç­‰ç®—æ³•ï¼Œéœ€è¦è®¡ç®—æ‰€æœ‰è½¨è¿¹ä¹‹é—´çš„è·ç¦»ã€‚&lt;/p&gt;
&lt;p&gt;é—®é¢˜å®šä¹‰ï¼š&lt;/p&gt;
&lt;p&gt;ç»™å®šKæ¡è½¨è¿¹ï¼ˆ&lt;code&gt;List[np.ndarray]&lt;/code&gt;ï¼‰ï¼Œè®¡ç®—å®ƒä»¬ä¸¤ä¸¤ä¹‹é—´çš„è·ç¦»ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ª&lt;code&gt;(K, K)&lt;/code&gt;çš„è·ç¦»çŸ©é˜µã€‚ä¸ºé¿å…å†—ä½™è®¡ç®—ï¼Œæˆ‘ä»¬åªè®¡ç®—çŸ©é˜µçš„ä¸Šä¸‰è§’éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜æ˜¯ä»¥&lt;code&gt;traj-dist&lt;/code&gt;ä½œä¸ºæˆ‘ä»¬å®éªŒçš„åŸºçº¿ã€‚&lt;/p&gt;
&lt;h2 id="ä¸€åŸºå‡†æµ‹è¯•ä¼ ç»Ÿæ–¹æ¡ˆçš„æ€§èƒ½ç“¶é¢ˆ"&gt;ä¸€ã€åŸºå‡†æµ‹è¯•ï¼šä¼ ç»Ÿæ–¹æ¡ˆçš„æ€§èƒ½ç“¶é¢ˆ
&lt;/h2&gt;&lt;p&gt;ç»™å®š20æ¡è½¨è¿¹ï¼Œæ¯æ¡è½¨è¿¹çš„é•¿åº¦ä¸º1000ï¼Œè®¡ç®—è·ç¦»çŸ©é˜µçš„ä¸Šä¸‰è§’éƒ¨åˆ†ï¼Œè·ç¦»ä½¿ç”¨DTWã€‚å› æ­¤ä¸€å…±éœ€è¦è®¡ç®—190æ¬¡ï¼ˆå¯¹è§’çº¿ä¸è®¡ç®—ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰3ç§ç®€å•çš„è§£å†³æ€è·¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨åŒé‡forå¾ªç¯ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;traj-dist&lt;/code&gt;æä¾›çš„pdistå‡½æ•°ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨åŒé‡forå¾ªç¯+joblibã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;span class="lnt"&gt;44
&lt;/span&gt;&lt;span class="lnt"&gt;45
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;joblib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Parallel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delayed&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tqdm&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;trange&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;traj_dist.distance&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;tdist&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;NUM_TRAJECTORIES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;TRAJS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;NUM_TRAJECTORIES&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;WARMUP_RUNS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_runs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# Warmup&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;WARMUP_RUNS&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# Measure time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;times&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;trange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_runs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;perf_counter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;perf_counter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;times&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;times&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test1&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;NUM_TRAJECTORIES&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;NUM_TRAJECTORIES&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tdist&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dtw&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TRAJS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;TRAJS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test2&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tdist&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pdist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TRAJS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;metric&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;dtw&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;type_d&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test3&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Parallel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n_jobs&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;delayed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;tdist&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dtw&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;))(&lt;/span&gt;&lt;span class="n"&gt;TRAJS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;TRAJS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;NUM_TRAJECTORIES&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;NUM_TRAJECTORIES&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è·‘å‡ºæ¥çš„è€—æ—¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;tool&lt;/th&gt;
&lt;th&gt;technique&lt;/th&gt;
&lt;th&gt;running time(s)&lt;/th&gt;
&lt;th&gt;speedup&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 1&lt;/strong&gt;: double for-loop&lt;/td&gt;
&lt;td&gt;10.103s&lt;/td&gt;
&lt;td&gt;1x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 2&lt;/strong&gt;: traj-dist pdist&lt;/td&gt;
&lt;td&gt;10.088s&lt;/td&gt;
&lt;td&gt;1.001x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 3&lt;/strong&gt;: joblib parallel&lt;/td&gt;
&lt;td&gt;1.364s&lt;/td&gt;
&lt;td&gt;7.407x&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;code&gt;traj-dist&lt;/code&gt;çš„ç»“æœè¿˜æ˜¯æœ‰ç‚¹è®©äººæƒŠè®¶çš„ï¼Œå› ä¸ºpdistç›¸è¾ƒäºåŒé‡forå¾ªç¯å‡ ä¹æ²¡æœ‰ä»»ä½•æå‡ï¼Œè¯´æ˜pdistæ²¡æœ‰æ¶ˆé™¤pythonè§£é‡Šå™¨å¸¦æ¥çš„ä¸åˆ©ã€‚èµ¶ç´§å»çœ‹äº†ä¸€ä¸‹æºç ï¼Œæ‰å‘ç°pdistå±…ç„¶æ˜¯åœ¨pythoné‡Œé¢é€šè¿‡åŒé‡forå¾ªç¯å®ç°çš„ï¼Œæ²¡æœ‰ç”¨cythonåŠ é€ŸğŸ˜‚ã€‚é‚£æˆ‘ä»¬åç»­éƒ½ä¸ç”¨è€ƒè™‘è¿™ä¸ªå‡½æ•°äº†ã€‚&lt;/p&gt;
&lt;p&gt;joblibå¹¶è¡Œæœ‰æ¯”è¾ƒæ˜æ˜¾çš„æå‡ï¼Œå› ä¸ºjoblibé»˜è®¤ä½¿ç”¨lokyä½œä¸ºåç«¯å¯åŠ¨å¤šè¿›ç¨‹ï¼Œå¤šä¸ªè¿›ç¨‹åŒæ—¶è®¡ç®—ï¼Œæˆ‘æµ‹è¯•ç”¨çš„æœºå™¨æ˜¯20ä¸ªCPUæ ¸å¿ƒï¼Œjoblibåœ¨è®¾ç½®&lt;code&gt;n_jobs=-1&lt;/code&gt;çš„æ—¶å€™ï¼Œä¼šå¯åŠ¨å’ŒCPUç›¸åŒæ•°é‡çš„è¿›ç¨‹æ•°ã€‚&lt;/p&gt;
&lt;h2 id="äºŒç¬¬ä¸€å±‚åŠ é€Ÿé›¶æ‹·è´ä¸rustçš„é™ç»´æ‰“å‡»"&gt;äºŒã€ç¬¬ä¸€å±‚åŠ é€Ÿï¼šé›¶æ‹·è´ä¸Rustçš„é™ç»´æ‰“å‡»
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;å®Œæˆç›¸åŒçš„å®éªŒï¼Œçœ‹çœ‹æ•ˆæœï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;tool&lt;/th&gt;
&lt;th&gt;technique&lt;/th&gt;
&lt;th&gt;running time(s)&lt;/th&gt;
&lt;th&gt;speedup&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 1&lt;/strong&gt;: double for-loop&lt;/td&gt;
&lt;td&gt;0.631s&lt;/td&gt;
&lt;td&gt;16.011x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 3&lt;/strong&gt;: joblib parallel&lt;/td&gt;
&lt;td&gt;0.105s&lt;/td&gt;
&lt;td&gt;96.219x&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼ŒåŒé‡forå¾ªç¯çš„æ–¹æ¡ˆæ¯”&lt;code&gt;traj-dist&lt;/code&gt;å¿«äº†16.011å€ï¼Œå¦‚æœä½¿ç”¨Joblibï¼Œè¾¾åˆ°äº†96.219å€ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªç»“æœè¿˜æ˜¯æ¯”è¾ƒæƒŠäººçš„ï¼Œåœ¨ä¸Šä¸€ç¯‡æ–‡ç« é‡Œé¢æˆ‘ä»¬è®²äº†ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„æ ¸å¿ƒæå‡åœ¨äºå¼•å…¥é›¶æ‹·è´ï¼Œè®©rustç›´æ¥è¯»å–pythonä¸­numpy.ndarrayçš„åº•å±‚æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;è¿™è¯´æ˜å½“å‰&lt;code&gt;traj-dist-rs&lt;/code&gt;ä½¿ç”¨çš„é›¶æ‹·è´è®¾è®¡é…åˆrustçš„é«˜æ€§èƒ½å¯ä»¥è½»æ¾è¶…è¶Š&lt;code&gt;traj-dist&lt;/code&gt;ä½¿ç”¨cythonç¼–å†™çš„åŠ é€Ÿä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;è¿˜æ²¡æœ‰å®ç°&lt;code&gt;pdist&lt;/code&gt;å‡½æ•°ï¼Œè€ƒè™‘åˆ°pythonç”¨æˆ·ä¸ºäº†åŠ é€Ÿä¸€å®šä¼šä½¿ç”¨å¤šè¿›ç¨‹åŠ é€Ÿï¼Œé‚£ä¹ˆ&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„&lt;code&gt;pdist&lt;/code&gt;å‡½æ•°åœ¨è®¾è®¡ä¸Šå°±ä¸€å®šè¦è€ƒè™‘åˆ°å¹¶è¡Œèƒ½åŠ›ã€‚&lt;/p&gt;
&lt;h2 id="ä¸‰å¹¶è¡Œæ–¹æ¡ˆæ„æƒ³"&gt;ä¸‰ã€å¹¶è¡Œæ–¹æ¡ˆæ„æƒ³
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬åˆ†åˆ«è®¨è®ºpythonçš„å¤šè¿›ç¨‹å¹¶è¡Œä¸rustçš„rayonå¹¶è¡Œã€‚&lt;/p&gt;
&lt;h3 id="31-pythonå¤šè¿›ç¨‹å¹¶è¡Œ"&gt;3.1 Pythonå¤šè¿›ç¨‹å¹¶è¡Œ
&lt;/h3&gt;&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ï¼ŒGILé™åˆ¶äº†Pythonçš„å¹¶è¡Œæ•ˆç‡ï¼Œåªèƒ½é€šè¿‡å¤šè¿›ç¨‹å®ç°å¹¶è¡ŒåŠ é€Ÿè®¡ç®—ï¼Œå¯ä»¥ä½¿ç”¨pythonè‡ªå¸¦çš„å¤šè¿›ç¨‹åº“ï¼Œå¦‚multiprocessingï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼joblibè¿™æ ·çš„åº“ã€‚æœ¬è´¨ä¸Šéƒ½æ˜¯é€šè¿‡å¤šè¿›ç¨‹å®ç°å¹¶è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œä¸è®ºæ˜¯å“ªç§å¹¶è¡Œï¼Œä¸€å®šä¼šé‡åˆ°ä¸‹é¢çš„3ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;h4 id="1-åˆå§‹åŒ–å¼€é”€"&gt;1. åˆå§‹åŒ–å¼€é”€
&lt;/h4&gt;&lt;p&gt;æœ¬è´¨æ˜¯pythonä¸»è¿›ç¨‹ä¼šå¯åŠ¨å¤šä¸ªå­è¿›ç¨‹ï¼Œè¿™äº›å­è¿›ç¨‹çš„å¯åŠ¨æ˜¯æœ‰ä¸€å®šçš„å¼€é”€çš„ã€‚å½“è®¡ç®—é‡å˜å¤§çš„æ—¶å€™ï¼Œè¿™ä¸ªå¼€é”€å°±å¯ä»¥å¿½ç•¥ï¼Œä½†æ˜¯è®¡ç®—é‡å°çš„æ—¶å€™ï¼Œè¿›ç¨‹çš„åˆå§‹åŒ–åè€Œä¼šæˆä¸ºç“¶é¢ˆã€‚&lt;/p&gt;
&lt;h4 id="2-é€šä¿¡å¼€é”€"&gt;2. é€šä¿¡å¼€é”€
&lt;/h4&gt;&lt;p&gt;è¿›ç¨‹ä¹‹é—´çš„æ•°æ®æ˜¯éš”ç¦»çš„ï¼Œä¸èƒ½å…±äº«ï¼Œä½¿ç”¨å¤šè¿›ç¨‹çš„æ—¶å€™ï¼Œå¤§æ¦‚ä¼šç»å†ä¸‹é¢çš„æ­¥éª¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å‚æ•°å’Œå‡½æ•°ä¼šä»¥pickleçš„å½¢å¼åºåˆ—åŒ–ï¼Œç”±ä¸»è¿›ç¨‹ä¼ é€’åˆ°å¦ä¸€ä¸ªpythonè¿›ç¨‹ï¼ˆå­è¿›ç¨‹ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;å­è¿›ç¨‹ååºåˆ—åŒ–ï¼Œè¿›è¡Œè¿ç®—ï¼Œè¿ç®—ç»“æœé€šè¿‡pickleåºåˆ—åŒ–ä¼ é€’åˆ°ä¸»è¿›ç¨‹ï¼›&lt;/li&gt;
&lt;li&gt;ä¸»è¿›ç¨‹ååºåˆ—åŒ–æ‹¿åˆ°æœ€ç»ˆç»“æœï¼Œæ”¶é›†æ‰€æœ‰å­è¿›ç¨‹çš„ç»“æœã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ä¸€å…±æ˜¯2æ¬¡ä¿¡æ¯ä¼ é€’ã€2æ¬¡åºåˆ—åŒ–ã€2æ¬¡ååºåˆ—åŒ–ã€‚æ•°æ®é‡è¶Šå¤§ï¼Œè¿™ä¸ªå¼€é”€è¶Šå¤§ï¼Œå½“ç„¶ä¹Ÿæ˜¯æœ‰é¿å¼€çš„æ–¹æ¡ˆçš„ï¼Œæ¯”å¦‚ä½¿ç”¨å…±äº«å†…å­˜ï¼šæå‰å°†æ•°æ®å†™å…¥å…±äº«å†…å­˜ï¼Œå­è¿›ç¨‹ä»å…±äº«å†…å­˜è¯»å–è¿™éƒ¨åˆ†æ•°æ®ã€‚æœ¬æ–‡å…ˆä¸è®¨è®ºè¿™ä¸ªæ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h4 id="3-è°ƒåº¦ä¸è´Ÿè½½å‡è¡¡å¼€é”€"&gt;3. è°ƒåº¦ä¸è´Ÿè½½å‡è¡¡å¼€é”€
&lt;/h4&gt;&lt;p&gt;ä¸»è¦æœ‰2ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è´Ÿè½½ä¸å‡ï¼šå¦‚æœ1ä¸ªè¿›ç¨‹æ‰§è¡Œçš„éƒ½æ˜¯ä¸€äº›è®¡ç®—é‡æ¯”è¾ƒå¤§çš„å·¥ä½œï¼Œå…¶ä»–è¿›ç¨‹éƒ½æ˜¯è½»é‡çš„å·¥ä½œï¼Œé‚£ä¹ˆå…¶ä»–è¿›ç¨‹å®Œæˆä»»åŠ¡åå°±ä¼šé—²ç½®ï¼Œå°±åƒæœ¨æ¡¶åŸç†ä¸€æ ·ã€‚&lt;/li&gt;
&lt;li&gt;ä»»åŠ¡è°ƒåº¦å¼€é”€ï¼šä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªé˜Ÿåˆ—ç»´æŠ¤ä»»åŠ¡ï¼Œæ¯ä¸ªè¿›ç¨‹ä»é˜Ÿåˆ—é‡Œé¢æ‹‰å–ä»»åŠ¡è¿›è¡Œæ¶ˆè´¹ï¼Œä½†æ˜¯å•ä¸ªä»»åŠ¡çš„ä»»åŠ¡é‡éœ€è¦è®¾ä¸ºå¤šå¤§ï¼Ÿå¦‚æœè®¾ç½®çš„å°äº†ï¼Œå­è¿›ç¨‹ä¼šé¢‘ç¹æ‹‰å–ï¼Œæ¯æ¬¡æ‹‰å–éƒ½æœ‰å›ºå®šå¼€é”€ï¼Œé€ æˆæ€»å¼€é”€å˜å¤§ï¼›è®¾ç½®çš„å¤§äº†å¯¹å†…å­˜å‹åŠ›åˆæ¯”è¾ƒå¤§ï¼Œè€Œä¸”åˆæœ‰å¯èƒ½é€ æˆè´Ÿè½½ä¸å‡çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½†æ˜¯è¯´äº†è¿™ä¹ˆå¤šï¼ŒPythoné‡Œé¢ä¸ºäº†åŠ é€Ÿè¿ç®—ï¼Œå¤šè¿›ç¨‹å¹¶è¡Œä¸€å®šæ˜¯é¿ä¸å¼€çš„ä¸€ä¸ªæ–¹æ¡ˆï¼Œæˆ‘ä¸ªäººè¿˜æ˜¯å–œæ¬¢å…±äº«å†…å­˜çš„æ–¹æ¡ˆï¼Œå°¤å…¶æ˜¯ç»“åˆpyarrowã€‚&lt;/p&gt;
&lt;p&gt;å›åˆ°ä¸Šé¢çš„å®éªŒï¼Œå¯ä»¥çœ‹åˆ°joblibç¡®å®å¯ä»¥æ˜¾è‘—æå‡æ€§èƒ½ï¼Œå› æ­¤å¯¹äºå¤§éƒ¨åˆ†åœºæ™¯æ¥è¯´ï¼Œä½¿ç”¨joblibåªéœ€è¦å‡ è¡Œä»£ç å°±å¯ä»¥å¿«é€Ÿæå‡æ€§èƒ½ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„æ–¹æ¡ˆï¼Œç›¸å½“äº1è¡Œä»£ç æ¢å–æˆå€æå‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡è¿™é‡Œä¹Ÿéœ€è¦å¤šè®²ä¸€å¥ï¼Œjoblibçš„ä¸€å¤§ä¼˜åŠ¿æ˜¯ä¸ºpythonç”¨æˆ·æä¾›äº†éå¸¸Pythonicçš„å¹¶è¡Œæ¥å£ï¼Œé€šè¿‡ç®€å•çš„&lt;code&gt;Parallel(n_jobs=-1)(delayed(...))&lt;/code&gt;å®ç°å¤šè¿›ç¨‹ä»£ç å®ç°ï¼Œè¿™æ˜¯éå¸¸ä¼˜é›…çš„ã€‚&lt;/p&gt;
&lt;h3 id="32-rustrayonçš„å¹¶è¡ŒåŠ é€Ÿæ–¹æ¡ˆ"&gt;3.2 Rust+Rayonçš„å¹¶è¡ŒåŠ é€Ÿæ–¹æ¡ˆ
&lt;/h3&gt;&lt;p&gt;rusté‡Œé¢åšå¹¶è¡Œï¼Œè‚¯å®šé¿ä¸å¼€ä½¿ç”¨Rayonï¼ŒRayonå·²ç»æˆä¸ºrustç”Ÿæ€ä¸­æ•°æ®å¹¶è¡Œçš„äº‹å®æ ‡å‡†ã€‚&lt;/p&gt;
&lt;p&gt;Rayonè‡ªèº«çš„ä¼˜åŠ¿æœ‰å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æè‡´çš„æ˜“ç”¨æ€§ï¼šåƒjoblibä¸€æ ·æä¾›äº†éå¸¸å‚»ç“œçš„ä½¿ç”¨æ–¹å¼ï¼Œæ”¹é€ æˆæœ¬æä½ã€‚&lt;/li&gt;
&lt;li&gt;æ— ç•å¹¶å‘ï¼šç¼–è¯‘æ—¶å°±å¯ä»¥ä¿è¯å®‰å…¨ï¼Œå¤§éƒ¨åˆ†æƒ…å†µæ— éœ€åŠ é”ã€‚&lt;/li&gt;
&lt;li&gt;å·¥ä½œçªƒå–ï¼šæŸä¸ªçº¿ç¨‹å®Œæˆè‡ªå·±æ‰€æœ‰ä»»åŠ¡ä¹‹åä¼šå»å…¶ä»–ç¹å¿™çº¿ç¨‹ä¸­çªƒå–ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç›¸æ¯”ä¸Šé¢çš„pythonå¤šè¿›ç¨‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆå§‹åŒ–å¼€é”€ï¼šrayonç”¨çº¿ç¨‹ï¼Œå¼€é”€æ›´ä½ã€‚&lt;/li&gt;
&lt;li&gt;é€šä¿¡å¼€é”€ï¼šæ•°æ®è·¨çº¿ç¨‹å…±äº«ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒåº¦ä¸è´Ÿè½½å‡è¡¡å¼€é”€ï¼šå·¥ä½œçªƒå–ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å› æ­¤ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„&lt;code&gt;pdist&lt;/code&gt;ä¸€å®šä¼šä½¿ç”¨Rayonå®Œæˆå¹¶è¡Œè®¡ç®—çš„å·¥ä½œï¼Œä»¥å®ç°æœ€ä½³æ€§èƒ½ã€‚&lt;/p&gt;
&lt;h2 id="å››å·…å³°å¯¹å†³130å€æ€§èƒ½æå‡"&gt;å››ã€å·…å³°å¯¹å†³ï¼š130å€æ€§èƒ½æå‡
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ç›´æ¥çœ‹é€šè¿‡rayonåŠ é€Ÿåçš„pdistçš„æ€§èƒ½å§ï¼Œåé¢å†çœ‹å…·ä½“å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ç¬¬ä¸€èŠ‚çš„å®éªŒé‡Œé¢ç»™å‡ºäº†3ç§è·¯çº¿ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨åŒé‡forå¾ªç¯ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;traj-dist&lt;/code&gt;æä¾›çš„pdistå‡½æ•°ã€‚ï¼ˆå®é™…ä¸Šè¿™ä¸ªå’Œç¬¬ä¸€ä¸ªä¸€æ ·ï¼‰&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨åŒé‡forå¾ªç¯+joblibã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;traj-dist-rs&lt;/code&gt;æä¾›çš„pdistå‡½æ•°æ”¯æŒäº†ä¸²è¡Œå’Œå¹¶è¡Œçš„é€‰é¡¹å¯ä»¥é€‰æ‹©ï¼Œå› æ­¤å°±å½¢æˆäº†4æ¡è·¯çº¿ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨åŒé‡forå¾ªç¯ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;æä¾›çš„pdistå‡½æ•°ï¼ˆä¸²è¡Œï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨åŒé‡forå¾ªç¯+joblibã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;æä¾›çš„pdistå‡½æ•°ï¼ˆå¹¶è¡Œï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™é‡Œè®²ä¸€ä¸‹ä¸Šé¢çš„4æ¡æŠ€æœ¯è·¯çº¿ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æŠ€æœ¯è·¯çº¿&lt;/th&gt;
&lt;th&gt;ç‰¹ç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Route1: åŒé‡forå¾ªç¯&lt;/td&gt;
&lt;td&gt;è¿™ä¸ªæ–¹æ¡ˆè°ƒç”¨çš„dtwæ˜¯traj-dist-rsä¼˜åŒ–è¿‡çš„ï¼Œt1ä¸t2ä»pythonè½¬ç§»åˆ°rustçš„æ—¶å€™æ˜¯é›¶æ‹·è´ï¼Œæ€§èƒ½å¾ˆå¥½ã€‚ä½†æ˜¯åŒé‡forå¾ªç¯åœ¨pythoné‡Œé¢ä¼šæ¯”è¾ƒæ…¢ï¼Œå› ä¸ºcpythonçš„è§£é‡Šæ“ä½œä¼šæ‹–ç´¯è¿™é‡Œçš„æ€§èƒ½ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Route2: rustä¸²è¡Œ&lt;/td&gt;
&lt;td&gt;rustå¯ä»¥é€šè¿‡é›¶æ‹·è´ç›´æ¥è¯»å–TRAJSé‡Œé¢çš„æ•°æ®ï¼Œå†…éƒ¨ä¹Ÿæ˜¯é€šè¿‡åŒé‡forå¾ªç¯è°ƒç”¨dtwå‡½æ•°è¿›è¡Œè®¡ç®—ï¼Œä½†æ˜¯è¿™ä¸ªforå¾ªç¯ä¼šæ¯”cpythonå¿«å¤šäº†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Route3: joblibå¹¶è¡Œ&lt;/td&gt;
&lt;td&gt;é€šè¿‡joblibå®ç°å¤šè¿›ç¨‹å¹¶è¡Œï¼ˆé»˜è®¤æ˜¯lokyåç«¯ï¼‰ï¼Œè™½ç„¶è°ƒç”¨çš„æ˜¯traj-dist-rsçš„dtwï¼Œä½†æ˜¯t1å’Œt2è¦ä»ä¸»è¿›ç¨‹è½¬ç§»åˆ°å­è¿›ç¨‹ï¼Œè¿™é‡Œä¼šå‘ç”Ÿæ•°æ®åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼Œå°±ç›¸å½“äºè¾“å…¥æ•°æ®å¤åˆ¶äº†ä¸¤æ¬¡ï¼›è€Œè¿”å›å€¼ä¹Ÿæ˜¯è¦åšä¸€æ¬¡åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå› æ­¤ä¹Ÿæ˜¯ä¸¤æ¬¡ã€‚ä½†æ˜¯å¯¹äºpythonæ¥è¯´ï¼Œæ˜¯ä¸ªä¸é”™çš„å¹¶è¡Œæ–¹æ¡ˆã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Route4: rayonå¹¶è¡Œ&lt;/td&gt;
&lt;td&gt;rusté€šè¿‡é›¶æ‹·è´è¯»å–TRAJSé‡Œé¢çš„æ•°æ®ï¼Œrayoné€šè¿‡å¤šçº¿ç¨‹æ‰§è¡Œdtwï¼Œä¸ä¸Šé¢çš„joblibç±»ä¼¼ï¼Œä¸è¿‡æ²¡æœ‰è·¨è¿›ç¨‹æ•°æ®ä¼ è¾“ã€è¿›ç¨‹ç»´æŠ¤å¼€é”€ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä¸‹é¢æœ‰ä¸¤ä¸ªæµ‹è¯•ç»“æœï¼Œä»ç„¶å–20æ¡è½¨è¿¹ï¼Œæ¯æ¬¡éƒ½æ˜¯å–5æ¬¡æµ‹é‡çš„ä¸­ä½æ•°ã€‚&lt;/p&gt;
&lt;h3 id="41-é«˜è®¡ç®—è´Ÿè½½è½¨è¿¹é•¿åº¦1000"&gt;4.1 é«˜è®¡ç®—è´Ÿè½½ï¼šè½¨è¿¹é•¿åº¦=1000
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;tool&lt;/th&gt;
&lt;th&gt;technique&lt;/th&gt;
&lt;th&gt;running time(s)&lt;/th&gt;
&lt;th&gt;speedup&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 1&lt;/strong&gt;: double for-loop&lt;/td&gt;
&lt;td&gt;10.103s&lt;/td&gt;
&lt;td&gt;1x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 3&lt;/strong&gt;: joblib parallel&lt;/td&gt;
&lt;td&gt;1.364s&lt;/td&gt;
&lt;td&gt;7.407x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 1&lt;/strong&gt;: double for-loop&lt;/td&gt;
&lt;td&gt;0.631s&lt;/td&gt;
&lt;td&gt;16.011x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 2&lt;/strong&gt;: rust serial (pdist)&lt;/td&gt;
&lt;td&gt;0.628s&lt;/td&gt;
&lt;td&gt;16.088x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 3&lt;/strong&gt;: joblib parallel&lt;/td&gt;
&lt;td&gt;0.105s&lt;/td&gt;
&lt;td&gt;96.219x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 4&lt;/strong&gt;: rayon parallel (pdist)&lt;/td&gt;
&lt;td&gt;0.078s&lt;/td&gt;
&lt;td&gt;129.526x&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ç»“æœåˆ†æï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Pythonå¾ªç¯å¼€é”€ vs Rustå¾ªç¯å¼€é”€ï¼š&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„Pythonå¾ªç¯ï¼ˆ0.631sï¼‰å’ŒRustä¸²è¡Œpdistï¼ˆ0.628sï¼‰è€—æ—¶å‡ ä¹ç›¸åŒã€‚è¿™è¯´æ˜åœ¨é«˜è®¡ç®—è´Ÿè½½ä¸‹ï¼ŒDTWç®—æ³•æœ¬èº«çš„è€—æ—¶å æ®ä¸»å¯¼ï¼ŒPythonå¾ªç¯çš„å¼€é”€æ˜¾å¾—ä¸é‚£ä¹ˆé‡è¦ã€‚&lt;/li&gt;
&lt;li&gt;å¤šè¿›ç¨‹ vs å¤šçº¿ç¨‹ï¼šRayonå¹¶è¡Œï¼ˆ0.078sï¼‰æ˜æ˜¾ä¼˜äºJoblibï¼ˆ0.105sï¼‰ï¼Œè¿™å¾—ç›Šäºå…¶æ›´ä½çš„å¼€é”€å’Œæ›´é«˜æ•ˆçš„çº¿ç¨‹é—´åä½œã€‚&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆçš„èƒœåˆ©ï¼š&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„åŸç”Ÿå¹¶è¡Œ pdist æ¥å£ï¼Œç›¸è¾ƒäºæœ€åˆçš„&lt;code&gt;traj-dist&lt;/code&gt;åŸºå‡†ï¼Œå®ç°äº†è¿‘&lt;strong&gt;130å€&lt;/strong&gt;çš„æ€§èƒ½é£è·ƒï¼è¿™æ­£æ˜¯æˆ‘ä»¬è¿½æ±‚çš„æ›´é«˜æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="42-ä½è®¡ç®—è´Ÿè½½è½¨è¿¹é•¿åº¦10"&gt;4.2 ä½è®¡ç®—è´Ÿè½½ï¼šè½¨è¿¹é•¿åº¦=10
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;tool&lt;/th&gt;
&lt;th&gt;technique&lt;/th&gt;
&lt;th&gt;running time(s)&lt;/th&gt;
&lt;th&gt;speedup&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 1&lt;/strong&gt;: double for-loop&lt;/td&gt;
&lt;td&gt;0.00186s&lt;/td&gt;
&lt;td&gt;1x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 3&lt;/strong&gt;: joblib parallel&lt;/td&gt;
&lt;td&gt;0.0653s&lt;/td&gt;
&lt;td&gt;0.028x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 1&lt;/strong&gt;: double for-loop&lt;/td&gt;
&lt;td&gt;0.000139s&lt;/td&gt;
&lt;td&gt;13.381x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 2&lt;/strong&gt;: rust serial (pdist)&lt;/td&gt;
&lt;td&gt;0.0000711s&lt;/td&gt;
&lt;td&gt;26.160x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 3&lt;/strong&gt;: joblib parallel&lt;/td&gt;
&lt;td&gt;0.0545s&lt;/td&gt;
&lt;td&gt;0.034x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Route 4&lt;/strong&gt;: rayon parallel (pdist)&lt;/td&gt;
&lt;td&gt;0.00201s&lt;/td&gt;
&lt;td&gt;0.925x&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ç»“æœåˆ†æï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¹¶è¡ŒåŒ–çš„ä»£ä»·ï¼šæ‰€æœ‰å¹¶è¡Œæ–¹æ¡ˆï¼ˆJoblibå’ŒRayonï¼‰çš„æ€§èƒ½éƒ½ä¸å¦‚ä¸²è¡Œã€‚Joblibçš„è¿›ç¨‹å¯åŠ¨å’Œæ•°æ®åºåˆ—åŒ–å¼€é”€å°¤ä¸ºå·¨å¤§ï¼Œå¯¼è‡´æ€§èƒ½ä¸‹é™äº†ä¸¤ä¸ªæ•°é‡çº§ã€‚Rayonè™½ç„¶å¼€é”€å°å¾—å¤šï¼Œä½†ä¾ç„¶ä¸æ•Œæœ€å¿«çš„ä¸²è¡Œå®ç°ã€‚&lt;/li&gt;
&lt;li&gt;è§£é‡Šå™¨å¼€é”€çš„å‡¸æ˜¾ï¼šåœ¨ä½è®¡ç®—è´Ÿè½½ä¸‹ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„Rustä¸²è¡Œpdistæ¯”å…¶Pythonå¾ªç¯å¿«äº†è¿‘2å€ã€‚è¿™è¯´æ˜å½“æ ¸å¿ƒè®¡ç®—éå¸¸å¿«æ—¶ï¼ŒPythonè§£é‡Šå™¨æœ¬èº«é‚£å¾®ä¸è¶³é“çš„å¾ªç¯å¼€é”€å°±æˆäº†ä¸»è¦ç“¶é¢ˆã€‚&lt;/li&gt;
&lt;li&gt;æœ€ä½³ç­–ç•¥ï¼šåœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œæœ€å¿«çš„æ–¹æ¡ˆæ˜¯è°ƒç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„ä¸²è¡Œ pdist å‡½æ•°ã€‚å®ƒæ—¢é¿å…äº†Pythonçš„å¾ªç¯å¼€é”€ï¼Œä¹Ÿé¿å…äº†å¹¶è¡Œçš„ç®¡ç†å¼€é”€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="äº”å…·ä½“å®ç°traj-dist-rsçš„æ€§èƒ½é­”æ³•"&gt;äº”ã€å…·ä½“å®ç°ï¼štraj-dist-rsçš„æ€§èƒ½é­”æ³•
&lt;/h2&gt;&lt;p&gt;è¯´äº†è¿™ä¹ˆå¤šï¼Œæ ¸å¿ƒè¿˜æ˜¯è¦è®²&lt;code&gt;traj-dist-rs&lt;/code&gt;ä¸ºäº†æ‰¹é‡è¿ç®—ï¼Œåšäº†å“ªäº›å·¥ä½œã€‚&lt;/p&gt;
&lt;h3 id="51-rayonä¸€è¡Œä»£ç è§£é”å¹¶è¡Œ"&gt;5.1 Rayonï¼šä¸€è¡Œä»£ç è§£é”å¹¶è¡Œ
&lt;/h3&gt;&lt;p&gt;æœ€æ ¸å¿ƒçš„åœ°æ–¹å°±åœ¨äºrayonã€‚å› ä¸º&lt;code&gt;traj-dist-rs&lt;/code&gt;å·²ç»æ”¯æŒäº†é›¶æ‹·è´è¯»å–pythonä¸­çš„numpy.ndarrayï¼Œé‚£ä¹ˆåªéœ€è¦å¾ˆç®€å•çš„ä½¿ç”¨rayonåšå¹¶è¡Œè®¡ç®—å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;compute_pdist_parallel&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;D&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trajectories&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;calculator&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;D&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Vec&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;where&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;: &lt;span class="nc"&gt;CoordSequence&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Sync&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;D&lt;/span&gt;: &lt;span class="nc"&gt;Distance&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;trajectories&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Create index pairs for all unique pairs (i, j) where i &amp;lt; j
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pairs&lt;/span&gt;: &lt;span class="nb"&gt;Vec&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;..&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flat_map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;..&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;move&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;collect&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Compute distances in parallel using Rayon&amp;#39;s global thread pool
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;into_par_iter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;calculator&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;distance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;trajectories&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;trajectories&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;collect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å°±è¿™ä¹ˆç®€å•ï¼Œæ ¸å¿ƒå°±æ˜¯å¼•å…¥&lt;code&gt;into_par_iter&lt;/code&gt;ï¼Œç„¶åå°±è‡ªåŠ¨å¹¶è¡Œäº†ã€‚è¿™é‡Œçš„&lt;code&gt;Distance&lt;/code&gt;æä¾›äº†ä¸€ä¸ªå«distanceçš„æ–¹æ³•ï¼Œç”¨äºè®¡ç®—ä¸¤æ¡è½¨è¿¹ä¹‹é—´çš„è·ç¦»ï¼Œæ¯”å¦‚dtwï¼Œedrç­‰ç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä»pythoné‡Œé¢ä¼ é€’ç»™rustçš„æ˜¯ä¸€ä¸ª&lt;code&gt;List[np.ndarray]&lt;/code&gt;ï¼Œrustæ‹¿åˆ°ä¹‹åå°†å…¶è½¬æ¢ä¸º&lt;code&gt;&amp;amp;[CoordSequence]&lt;/code&gt;å¯¹åº”çš„å…·ä½“ç±»å‹ï¼Œå°±å¯ä»¥å¤ç”¨è¿™ä¸ªå¹¶è¡Œè®¡ç®—çš„pdistå‡½æ•°äº†ã€‚è‡³äº&lt;code&gt;np.ndarray&lt;/code&gt;å¦‚ä½•è½¬&lt;code&gt;CoordSequence&lt;/code&gt;ï¼Œè¿™ä¸ªå°±æ˜¯ä¸Šæ¬¡è®²çš„ï¼Œé€šè¿‡PyO3å–å‡º&lt;code&gt;ndarray&lt;/code&gt;åº•å±‚çš„åˆ‡ç‰‡ï¼Œç„¶åå°è£…åˆ°ä¸€ä¸ªå®ç°äº†&lt;code&gt;CoordSequence&lt;/code&gt;è¿™ä¸ªtraitçš„structé‡Œé¢å°±å¯ä»¥äº†ã€‚é‚£&lt;code&gt;List&lt;/code&gt;å¦‚ä½•è½¬&lt;code&gt;&amp;amp;[]&lt;/code&gt;ï¼Œè¿™ä¸ªå°±ä¸ç”¨è¯´äº†ã€‚&lt;/p&gt;
&lt;h3 id="52-bincodeä¸ºpickleåºåˆ—åŒ–åŠ é€Ÿ"&gt;5.2 Bincodeï¼šä¸ºPickleåºåˆ—åŒ–åŠ é€Ÿ
&lt;/h3&gt;&lt;p&gt;å› ä¸º&lt;code&gt;traj-dist-rs&lt;/code&gt;æ”¯æŒpythonï¼Œæ‰€ä»¥ä¸€å®šè¦è€ƒè™‘ç±»ä¼¼ä¸Šé¢é€šè¿‡multiprocessingæˆ–è€…joblibå®ç°å¤šè¿›ç¨‹å¹¶è¡Œçš„æ–¹æ¡ˆã€‚é‚£ä¹ˆå¯¹äºç”¨æˆ·æ¥è¯´ï¼Œpickleåºåˆ—åŒ–çš„æ€§èƒ½å°±å¾ˆå…³é”®ã€‚è€ƒè™‘åˆ°&lt;code&gt;traj-dist-rs&lt;/code&gt;é‡Œé¢çš„åŠ¨æ€è§„åˆ’ç®—æ³•è¿”å›çš„ç±»å‹éƒ½æ˜¯ä¸€ä¸ªRustå®šä¹‰çš„&lt;code&gt;PyDpResult&lt;/code&gt;ï¼Œé‚£ä¹ˆå¯¹è¿™ä¸ªç±»å‹çš„åºåˆ—åŒ–æ€§èƒ½åšæå‡å°±å¾ˆé‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆè¯´ä¸€ä¸‹è¿™é‡Œæ˜¯æ€ä¹ˆè®¾è®¡çš„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è€ƒè™‘åˆ°åŠ¨æ€è§„åˆ’ç®—æ³•çš„è¿”å›å€¼æœ‰ä¸€ä¸ªç»“æœï¼Œè¿˜å¯èƒ½æœ‰å®Œæ•´çš„åŠ¨æ€è§„åˆ’çŸ©é˜µç”¨äºå›æº¯è·¯å¾„ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;å®šä¹‰äº†ä¸€ä¸ª&lt;code&gt;DpResult&lt;/code&gt;çš„structå°è£…äº†è¿™ä¸¤ä¸ªå€¼ã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘åˆ°&lt;code&gt;traj-dist-rs&lt;/code&gt;æ˜¯åŒæ—¶æ”¯æŒRustå’ŒPythonä¸¤ç§è¯­è¨€çš„ï¼Œå¹¶ä¸”æä¾›äº†&lt;code&gt;python-binding&lt;/code&gt;è¿™ä¸ªfeatureï¼Œç”¨äºé¢å¤–ç¼–è¯‘é€‚é…Pythonçš„å‡½æ•°å’Œç±»å‹ã€‚å› æ­¤ç›´æ¥å°†&lt;code&gt;DpResult&lt;/code&gt;æš´éœ²ç»™Pythonç¯å¢ƒä¸åˆç†ï¼Œå› æ­¤éœ€è¦å†å®šä¹‰ä¸€ä¸ª&lt;code&gt;PyDpResult&lt;/code&gt;çš„structæš´éœ²ç»™pythonï¼Œè€Œå®ƒåªæœ‰ä¸€ä¸ªå«innerçš„å±æ€§ï¼Œç±»å‹æ˜¯&lt;code&gt;DpResult&lt;/code&gt;ï¼Œè¿™æ ·Rustç”¨æˆ·ç”¨çš„æ˜¯&lt;code&gt;DpResult&lt;/code&gt;ï¼Œè€Œpythonç”¨æˆ·ç”¨çš„æ˜¯&lt;code&gt;PyDpResult&lt;/code&gt;ï¼Œä¸¤è€…äº’ä¸å¹²æ‰°ï¼Œå……åˆ†è§£è€¦ã€‚&lt;/li&gt;
&lt;li&gt;é‚£ä¹ˆç”¨æˆ·åœ¨pythonå¤šè¿›ç¨‹ç¯å¢ƒä¸­è¿è¡ŒåŠ¨æ€è§„åˆ’ç±»ç®—æ³•çš„æ—¶å€™ï¼Œå°±ä¼šé¢ä¸´è¿”å›å€¼åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯&lt;code&gt;PyDpResult&lt;/code&gt;çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œè¿™é‡Œå¾ˆç®€å•ï¼Œå®ç°&lt;code&gt;__reduce__&lt;/code&gt;æ¥å£å³å¯ï¼Œé‚£è¦æŠŠä»€ä¹ˆä¸œè¥¿è¿”å›ç»™pythonå‘¢ï¼Œå…¶å®å°±æ˜¯æŠŠ&lt;code&gt;DpResult&lt;/code&gt;è¿™ä¸ªstructåºåˆ—åŒ–ä¸ºå­—èŠ‚ï¼Œä¼ é€’ç»™pythonï¼Œpythonæ‹¿åˆ°å­—èŠ‚å†ååºåˆ—åŒ–ä¸º&lt;code&gt;DpResult&lt;/code&gt;ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª&lt;code&gt;PyDpResult&lt;/code&gt;å°†å…¶å°è£…å³å¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å› æ­¤è¿™é‡Œæœ€å¤§çš„å¼€é”€å°±æ˜¯å¯¹&lt;code&gt;DpResult&lt;/code&gt;çš„åºåˆ—åŒ–ï¼Œè¿™é‡Œä½¿ç”¨bincodeï¼Œå°†å…¶åºåˆ—åŒ–ä¸ºå­—èŠ‚ï¼Œè¿™æ˜¯æˆ‘æ‰¾åˆ°çš„æœ€å¿«çš„æ–¹æ¡ˆï¼Œç›¸æ¯”serde_jsonè‚¯å®šæ˜¯å¿«å¾ˆå¤šçš„ã€‚å¦‚æœå¤§å®¶æœ‰å…¶ä»–æ–¹æ¡ˆä¹Ÿå¯ä»¥å’Œæˆ‘äº¤æµã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„æºç æ˜¯&lt;code&gt;PyDpResult&lt;/code&gt;çš„ä»£ç ï¼Œçœç•¥äº†ä¸€äº›ä¸æœ¬æ–‡æ— å…³çš„å†…å®¹ï¼Œå±•ç¤ºäº†å¦‚ä½•è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;span class="lnt"&gt;44
&lt;/span&gt;&lt;span class="lnt"&gt;45
&lt;/span&gt;&lt;span class="lnt"&gt;46
&lt;/span&gt;&lt;span class="lnt"&gt;47
&lt;/span&gt;&lt;span class="lnt"&gt;48
&lt;/span&gt;&lt;span class="lnt"&gt;49
&lt;/span&gt;&lt;span class="lnt"&gt;50
&lt;/span&gt;&lt;span class="lnt"&gt;51
&lt;/span&gt;&lt;span class="lnt"&gt;52
&lt;/span&gt;&lt;span class="lnt"&gt;53
&lt;/span&gt;&lt;span class="lnt"&gt;54
&lt;/span&gt;&lt;span class="lnt"&gt;55
&lt;/span&gt;&lt;span class="lnt"&gt;56
&lt;/span&gt;&lt;span class="lnt"&gt;57
&lt;/span&gt;&lt;span class="lnt"&gt;58
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;/// Python wrapper for the Rust DpResult struct
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;/// This class wraps the Rust DpResult and provides Python-friendly access
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;/// to the distance and optional matrix.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[cfg(feature = &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;python-binding&amp;#34;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[gen_stub_pyclass]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[pyclass(name = &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;DpResult&amp;#34;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;PyDpResult&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// The inner Rust DpResult
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inner&lt;/span&gt;: &lt;span class="nc"&gt;crate&lt;/span&gt;::&lt;span class="n"&gt;distance&lt;/span&gt;::&lt;span class="n"&gt;DpResult&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[cfg(feature = &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;python-binding&amp;#34;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[gen_stub_pymethods]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[pymethods]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyDpResult&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Pickle serialization support using __reduce__
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Uses bincode to serialize the entire DpResult::inner as bytes for better performance.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Returns a tuple (callable, args) that pickle can use to reconstruct the object.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;__reduce__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;: &lt;span class="nc"&gt;Python&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;PyResult&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Py&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;PyAny&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Py&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;PyAny&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Py&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;PyAny&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pyo3&lt;/span&gt;::&lt;span class="n"&gt;prelude&lt;/span&gt;::&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pyo3&lt;/span&gt;::&lt;span class="n"&gt;types&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;PyBytes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyTuple&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Import the module and get the helper function
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;module&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;import&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;traj_dist_rs&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;helper_func&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;module&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;__dp_result_from_pickle&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Serialize the entire DpResult using bincode
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;serialized&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bincode&lt;/span&gt;::&lt;span class="n"&gt;encode_to_vec&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;inner&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bincode&lt;/span&gt;::&lt;span class="n"&gt;config&lt;/span&gt;::&lt;span class="n"&gt;standard&lt;/span&gt;&lt;span class="p"&gt;()).&lt;/span&gt;&lt;span class="n"&gt;map_err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pyo3&lt;/span&gt;::&lt;span class="n"&gt;exceptions&lt;/span&gt;::&lt;span class="n"&gt;PyRuntimeError&lt;/span&gt;::&lt;span class="n"&gt;new_err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="fm"&gt;format!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Serialization failed: &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Create args tuple containing the serialized bytes
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bytes_py&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyBytes&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;serialized&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args_tuple&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyTuple&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;bytes_py&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_any&lt;/span&gt;&lt;span class="p"&gt;()])&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// Return (helper_func, args, state) where state is None
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;helper_func&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unbind&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args_tuple&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unbind&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nb"&gt;None&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;/// Helper function to create DpResult from pickle data
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="sd"&gt;/// Deserializes the DpResult from bincode-encoded bytes.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[cfg(feature = &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;python-binding&amp;#34;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[gen_stub_pyfunction]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#[pyfunction]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;__dp_result_from_pickle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="cp"&gt;#[gen_stub(override_type(type_repr = &lt;/span&gt;&lt;span class="s"&gt;&amp;#34;bytes&amp;#34;&lt;/span&gt;&lt;span class="cp"&gt;))]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;u8&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;PyResult&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;PyDpResult&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bincode&lt;/span&gt;::&lt;span class="n"&gt;decode_from_slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bincode&lt;/span&gt;::&lt;span class="n"&gt;config&lt;/span&gt;::&lt;span class="n"&gt;standard&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dp_result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyDpResult&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inner&lt;/span&gt;: &lt;span class="nc"&gt;dp_result&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map_err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pyo3&lt;/span&gt;::&lt;span class="n"&gt;exceptions&lt;/span&gt;::&lt;span class="n"&gt;PyRuntimeError&lt;/span&gt;::&lt;span class="n"&gt;new_err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="fm"&gt;format!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Deserialization failed: &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™æ ·å®ç°çš„åºåˆ—åŒ–æ¥å£ï¼Œå°±å¯ä»¥ä½¿&lt;code&gt;PyDpResult&lt;/code&gt;è¾¾åˆ°ä¸€ä¸ªæ¯”è¾ƒå¥½çš„åºåˆ—åŒ–æ€§èƒ½äº†ï¼Œè¿™æ ·ä¹Ÿå°±å¯ä»¥å¸®åŠ©Pythonå¤šè¿›ç¨‹ç¯å¢ƒä¸‹çš„æ€§èƒ½æå‡äº†ã€‚&lt;/p&gt;
&lt;h2 id="å…­å®æˆ˜traj-dist-rsæå‡trajclçš„æ•°æ®é¢„å¤„ç†æ€§èƒ½"&gt;å…­ã€å®æˆ˜ï¼š&lt;code&gt;traj-dist-rs&lt;/code&gt;æå‡&lt;code&gt;TrajCL&lt;/code&gt;çš„æ•°æ®é¢„å¤„ç†æ€§èƒ½
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;TrajCL&lt;/code&gt;æ˜¯ä¸€ä¸ªç”¨äºä½¿ç”¨æ·±åº¦å­¦ä¹ ç®—æ³•è¿‘ä¼¼è½¨è¿¹ç›¸ä¼¼åº¦çš„æ–¹æ³•ï¼š&amp;ldquo;TrajCL: Contrastive Trajectory Similarity Learning with Dual-Feature Attention&amp;rdquo;ã€‚åœ¨è®ºæ–‡ä½œè€…çš„&lt;a class="link" href="https://github.com/changyanchuan/TrajCL/blob/master/utils/preprocessing_porto.py" target="_blank" rel="noopener"
&gt;å¼€æºä»£ç &lt;/a&gt;é‡Œé¢ï¼Œæä¾›äº†å¯¹portoæ•°æ®é›†ä¸­è½¨è¿¹ç›¸ä¼¼åº¦çš„è®¡ç®—ï¼Œä½¿ç”¨&lt;code&gt;traj-dist&lt;/code&gt;+pythonå¤šè¿›ç¨‹å®Œæˆã€‚æˆ‘ä»¬è¿™é‡Œå°†ä½œè€…çš„æºä»£ç å–å‡ºå¹¶ä½œè½»é‡ä¼˜åŒ–ï¼Œä¸æˆ‘ä»¬çš„&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„&lt;code&gt;pdist&lt;/code&gt;å¹¶è¡Œç‰ˆåšæ€§èƒ½å¯¹æ¯”ã€‚&lt;/p&gt;
&lt;p&gt;ä½œè€…ä»portoæ•°æ®é›†ä¸­æŒ‘é€‰äº†è½¨è¿¹é•¿åº¦åœ¨20åˆ°200ä¹‹é—´çš„åºåˆ—ï¼Œé€‰å‡º7000æ¡ä½œä¸ºè®­ç»ƒé›†ï¼Œè®¡ç®—è¿™7000æ¡çŸ©é˜µä¹‹é—´çš„è·ç¦»ï¼ˆä¸Šä¸‰è§’ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘åˆ›å»ºäº†ä¸€ä¸ª4æ ¸8Gçš„podï¼Œå¯¹è¿™7000æ¡è½¨è¿¹è¿›è¡Œdtwè®¡ç®—ï¼Œæµ‹è¯•ä¸‹æ¥çš„æ•ˆæœå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;tool&lt;/th&gt;
&lt;th&gt;running time(s)&lt;/th&gt;
&lt;th&gt;speedup&lt;/th&gt;
&lt;th&gt;Peak Memory (MB)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist&lt;/td&gt;
&lt;td&gt;2932.84s&lt;/td&gt;
&lt;td&gt;1x&lt;/td&gt;
&lt;td&gt;1061.68 MB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;traj-dist-rs&lt;/td&gt;
&lt;td&gt;92.21s&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;31.81x&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;642.11 MB&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„&lt;code&gt;pdist&lt;/code&gt;å‡½æ•°ï¼Œå¯ä»¥è®©ä¹‹å‰çš„æ•°æ®é¢„å¤„ç†éƒ¨åˆ†æ€§èƒ½æå‡31.8å€ï¼Œæ•ˆæœæå‡å¾ˆæ˜æ˜¾ï¼Œè€Œä¸”å†…å­˜ç”¨é‡æ˜æ˜¾æ›´å°‘ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯&lt;code&gt;traj-dist-rs&lt;/code&gt;æµ‹è¯•ç”¨çš„æºç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;polars&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pl&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;traj_dist_rs&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Metric&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pdist&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_trajs&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_parquet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;trajcl_samples.parquet&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;start_idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;trajs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;seq&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_numpy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;start_idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_idx&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;trajs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_trajs&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pdist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;metric&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Metric&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dtw&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;parallel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸‹é¢è¿™æ˜¯ä»è®ºæ–‡ä½œè€…ä»£ç ä¸­æˆªå–å‡ºæ¥ï¼Œå¹¶åšäº†ä¸€äº›æ€§èƒ½ä¼˜åŒ–çš„ä»£ç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;span class="lnt"&gt;44
&lt;/span&gt;&lt;span class="lnt"&gt;45
&lt;/span&gt;&lt;span class="lnt"&gt;46
&lt;/span&gt;&lt;span class="lnt"&gt;47
&lt;/span&gt;&lt;span class="lnt"&gt;48
&lt;/span&gt;&lt;span class="lnt"&gt;49
&lt;/span&gt;&lt;span class="lnt"&gt;50
&lt;/span&gt;&lt;span class="lnt"&gt;51
&lt;/span&gt;&lt;span class="lnt"&gt;52
&lt;/span&gt;&lt;span class="lnt"&gt;53
&lt;/span&gt;&lt;span class="lnt"&gt;54
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;math&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;multiprocessing&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;mp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;typing&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;polars&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pl&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;traj_dist.distance&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;tdist&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# ä¼˜åŒ– 1ï¼šç›´æ¥æ¥æ”¶ List[np.ndarray]ï¼ŒæŠ›å¼ƒ Pandas DataFrame&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_simi_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ndarray&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;]]:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tasks&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ceil&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ceil&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# ä¼˜åŒ– 2ï¼šæŠŠåŸæœ¬ä¼  DataFrame æ”¹ä¸ºä¼  trajs åˆ—è¡¨&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)))))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;num_cores&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cpu_count&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pool&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pool&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_cores&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;lst_simi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pool&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;starmap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_simi_comp_operator&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pool&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;lst_simi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_simi_comp_operator&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ndarray&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;sub_idx&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;simi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sub_idx&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t_i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;_i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# ä¼˜åŒ– 3ï¼šç›´æ¥ List ç´¢å¼•ï¼ŒO(1) ä¸”æå¿«ï¼Œå¹²æ‰ .iloc&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;simi_row&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t_j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;_j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# åŒä¸Š&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;simi_row&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t_i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t_j&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;simi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;simi_row&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;simi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_trajs&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# ç»Ÿä¸€ä½¿ç”¨ polars è¯»å–ï¼Œä¿è¯æ•°æ®å‡†å¤‡é˜¶æ®µç»å¯¹å…¬å¹³&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_parquet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;trajcl_samples.parquet&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;start_idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;trajs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;seq&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_numpy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;start_idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_idx&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;trajs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_trajs&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;# è®¡æ—¶å¼€å§‹ï¼ˆä¸åŒ…å«æ•°æ®è¯»å–éƒ¨åˆ†ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;_simi_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tdist&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dtw&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trajs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;Optimized Baseline Time: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;s&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id="ä¸ƒæ€»ç»“"&gt;ä¸ƒã€æ€»ç»“
&lt;/h2&gt;&lt;p&gt;è¿™æ¬¡æ‰¹é‡è®¡ç®—çš„æ€§èƒ½ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œæœ‰å‡ ä¸ªå®è´µçš„ç»éªŒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç“¶é¢ˆè½¬ç§»ï¼šä¼˜åŒ–å®Œæ ¸å¿ƒç®—æ³•ï¼ˆRust/Cythonï¼‰åï¼Œç“¶é¢ˆä¼šè½¬ç§»åˆ°Pythonçš„è°ƒç”¨å±‚ï¼ˆå¾ªç¯ã€GILã€æ•°æ®å¤åˆ¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;â€œæ‰¹å¤„ç†â€ä¸‹æ²‰ï¼šå¯¹äºæ‰¹é‡è®¡ç®—ä»»åŠ¡ï¼Œæœ€å¥½çš„æ–¹å¼æ˜¯è®¾è®¡ä¸€ä¸ªèƒ½æ¥æ”¶æ•´ä¸ªæ•°æ®é›†çš„åº•å±‚å‡½æ•°ï¼Œå°†å¾ªç¯å’Œè°ƒåº¦å®Œå…¨ä¸‹æ²‰åˆ°é«˜æ€§èƒ½è¯­è¨€ï¼ˆRust/C++ï¼‰ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;å¹¶è¡Œæ¨¡å‹çš„é€‰æ‹©ï¼šåœ¨Rustä¸­ï¼ŒåŸºäºå…±äº«å†…å­˜çš„å¤šçº¿ç¨‹å¹¶è¡Œé€šå¸¸æ›´ä¼˜äºPythonä¸­åŸºäºåºåˆ—åŒ–çš„å¤šè¿›ç¨‹å¹¶è¡Œï¼Œå°¤å…¶æ˜¯åœ¨æ•°æ®é‡å¤§æ—¶ã€‚&lt;/li&gt;
&lt;li&gt;å¹¶è¡ŒåŒ–ä¸æ˜¯ä¸‡é‡‘æ²¹ï¼šå¹¶è¡ŒåŒ–æœ‰å…¶è‡ªèº«å¼€é”€ã€‚å¯¹äºè®¡ç®—é‡æå°çš„ä»»åŠ¡ï¼Œä¸²è¡Œå°±æ˜¯æœ€å¥½çš„æ–¹æ¡ˆã€‚åœ¨è®¾è®¡çš„æ—¶å€™å°±åº”è¯¥ç»™ç”¨æˆ·æä¾›ä¸²è¡Œå’Œå¹¶è¡Œçš„æ¥å£ï¼Œè®©ç”¨æˆ·è‡ªå·±é€‰æ‹©ã€‚&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>æ€§èƒ½æå‡10å€ï¼æˆ‘ç”¨Rusté‡å†™Pythonè½¨è¿¹è·ç¦»è®¡ç®—åº“çš„å®è·µåˆ†äº«</title><link>https://davidham3.github.io/blog/p/%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%8710%E5%80%8D%E6%88%91%E7%94%A8rust%E9%87%8D%E5%86%99python%E8%BD%A8%E8%BF%B9%E8%B7%9D%E7%A6%BB%E8%AE%A1%E7%AE%97%E5%BA%93%E7%9A%84%E5%AE%9E%E8%B7%B5%E5%88%86%E4%BA%AB/</link><pubDate>Sun, 08 Feb 2026 23:18:49 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%8710%E5%80%8D%E6%88%91%E7%94%A8rust%E9%87%8D%E5%86%99python%E8%BD%A8%E8%BF%B9%E8%B7%9D%E7%A6%BB%E8%AE%A1%E7%AE%97%E5%BA%93%E7%9A%84%E5%AE%9E%E8%B7%B5%E5%88%86%E4%BA%AB/</guid><description>&lt;p&gt;æœ€è¿‘åœ¨åšè½¨è¿¹æ•°æ®åˆ†æç›¸å…³çš„é¡¹ç›®ï¼Œéœ€è¦è®¡ç®—è½¨è¿¹ä¹‹é—´çš„è·ç¦»ã€‚ä¸€å¼€å§‹ç”¨çš„æ˜¯ &lt;code&gt;traj-dist&lt;/code&gt; è¿™ä¸ª Python åŒ…ï¼Œå®ƒæä¾›äº†å¤šç§è½¨è¿¹è·ç¦»ç®—æ³•çš„å®ç°ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œå› ä¸ºæ˜¯é€šè¿‡CythonåŠ é€Ÿçš„ã€‚ä½†æ˜¯è¿™ä¸ªåŒ…æœ‰ç‚¹å¤ªè€äº†ï¼Œå®‰è£…èµ·æ¥å¾ˆéº»çƒ¦ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘æƒ³ç€èƒ½ä¸èƒ½ç”¨ Rust é‡å†™ä¸€éï¼Œä¸€æ˜¯ä¸ºäº†é€‚é…æ›´æ–°çš„pythonç‰ˆæœ¬ï¼ŒäºŒæ˜¯ä¸ºäº†å°è¯•â€œç”¨rusté‡å†™ä¸€åˆ‡â€ã€‚&lt;/p&gt;
&lt;p&gt;å®ç°å®Œäº†ä¹‹åæµ‹è¯•äº†ä¸€ä¸‹æ€§èƒ½ï¼Œå“äº†ä¸€è·³ï¼šç›¸æ¯” &lt;code&gt;traj-dist&lt;/code&gt; çš„ Python å®ç°ï¼Œæ€§èƒ½æå‡äº† 389 å€ï¼Œç›¸æ¯” Cython å®ç°ä¹Ÿæå‡äº† 10 å€ã€‚æœ¬æ–‡æˆ‘ä¼šåˆ†äº«ä¸€ä¸‹è¿™ä¸ªé¡¹ç›®çš„ä¸€äº›ç»éªŒå’Œè¸©è¿‡çš„å‘ã€‚&lt;/p&gt;
&lt;h2 id="ä¸€ä¸ºä»€ä¹ˆè¦é‡å†™"&gt;ä¸€ã€ä¸ºä»€ä¹ˆè¦é‡å†™
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;traj-dist&lt;/code&gt; æ˜¯ä¸€ä¸ªæŒºä¸é”™çš„åŒ…ï¼Œæä¾›äº†å¤šç§ä¸»æµçš„è½¨è¿¹è·ç¦»ç®—æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SSPDï¼ˆå¯¹ç§°æ®µè·¯å¾„è·ç¦»ï¼‰&lt;/li&gt;
&lt;li&gt;DTWï¼ˆåŠ¨æ€æ—¶é—´è§„æ•´ï¼‰&lt;/li&gt;
&lt;li&gt;Hausdorff è·ç¦»&lt;/li&gt;
&lt;li&gt;LCSSï¼ˆæœ€é•¿å…¬å…±å­åºåˆ—ï¼‰&lt;/li&gt;
&lt;li&gt;EDRï¼ˆå®æ•°åºåˆ—ç¼–è¾‘è·ç¦»ï¼‰&lt;/li&gt;
&lt;li&gt;ERPï¼ˆå¸¦å®æ•°æƒ©ç½šçš„ç¼–è¾‘è·ç¦»ï¼‰&lt;/li&gt;
&lt;li&gt;Discret FrÃ©chet è·ç¦»&lt;/li&gt;
&lt;li&gt;è¿˜æœ‰å¾ˆå¤šï¼Œæˆ‘è¿˜æ²¡æœ‰é‡å†™&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ”¯æŒæ¬§å‡ é‡Œå¾—è·ç¦»å’Œçƒé¢è·ç¦»ï¼ˆHaversineï¼‰ï¼ŒAPI è®¾è®¡å¾—å¾ˆç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œæ ¸å¿ƒç—›ç‚¹æ˜¯è¿™ä¸ªåŒ…çš„å®‰è£…æ¯”è¾ƒéº»çƒ¦ï¼Œæˆ‘å°è¯•è¿‡åœ¨python3.12ä¸Šå®‰è£…ï¼Œä½†æ˜¯å‘ç°å®ƒçš„ä¾èµ–å¤ªè€ã€‚è€Œä¸”æ¯æ¬¡å®‰è£…éƒ½éœ€è¦ç¼–è¯‘Cythonä»£ç ã€‚ä¸ºæ­¤æˆ‘å¸Œæœ›æœ‰ä¸€ä¸ªå®‰è£…ç®€å•ï¼Œè€Œä¸”ä¾èµ–æ¯”è¾ƒå°‘çš„åŒ…å‡ºç°ã€‚&lt;/p&gt;
&lt;h2 id="äºŒé‡å†™æ€è·¯"&gt;äºŒã€é‡å†™æ€è·¯
&lt;/h2&gt;&lt;p&gt;æˆ‘å…ˆè¯´ä¸€ä¸‹æˆ‘çš„é‡å†™æ€è·¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¡®å®šéœ€è¦é‡å†™çš„ç®—æ³•ï¼šé¦–å…ˆæˆ‘åœ¨&lt;code&gt;traj-dist&lt;/code&gt;é‡Œé¢æŒ‘é€‰äº†ä¸€äº›ç®€å•çš„ç®—æ³•ï¼š
&lt;ul&gt;
&lt;li&gt;LCSSã€DTWã€discrete frechetã€EDRã€ERPï¼Œè¿™äº›éƒ½æ˜¯åŠ¨æ€è§„åˆ’ç®—æ³•&lt;/li&gt;
&lt;li&gt;hausdorffï¼Œsspdï¼Œè¿™ä¸¤ä¸ªç®—æ³•æ˜¯éåŠ¨æ€è§„åˆ’çš„ç®—æ³•ï¼Œå®ç°èµ·æ¥ç›¸å¯¹ç®€å•&lt;/li&gt;
&lt;li&gt;å…¶ä»–ç®—æ³•çš„å®ç°ç¨å¾®å¤æ‚äº†ä¸€äº›ï¼Œå°±ç•™åœ¨åé¢çš„ç‰ˆæœ¬äº†&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä»¥&lt;code&gt;traj-dist&lt;/code&gt;ä¸ºground truthï¼šæˆ‘å‘ç°ä½œè€…åœ¨ä»£ç ä»“åº“é‡Œé¢æä¾›äº†ä¸€ä¸ªå¾ˆå°çš„è½¨è¿¹æ•°æ®é›†ï¼Œå¹¶ä¸”ä½œè€…è‡ªå·±åœ¨ä¸Šé¢è¿›è¡Œäº†æ€§èƒ½æµ‹è¯•ï¼Œé‚£æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ•°æ®é›†ï¼Œä½¿ç”¨&lt;code&gt;traj-dist&lt;/code&gt;åœ¨ä¸Šé¢å®Œæˆä¸Šé¢7ä¸ªç®—æ³•çš„è®¡ç®—ï¼Œè®°å½•ç»“æœä¸è€—æ—¶ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨rusté‡å†™ä¸Šè¿°7ä¸ªç®—æ³•ï¼Œrusté‡Œé¢ä½¿ç”¨traitè¡¨ç¤ºç»çº¬åº¦ç‚¹å’Œè½¨è¿¹ï¼Œä¸ºå…¶ä»–äººä½¿ç”¨è¿™ä¸ªåŒ…æä¾›æ‰©å±•æ€§ã€‚åŒæ—¶ä¸ºrustç¼–å†™å•å…ƒæµ‹è¯•ç”¨ä¾‹ï¼Œä¿è¯å…¶APIéƒ½æ˜¯å¯ç”¨çš„ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºrustçš„ç®—æ³•å’Œtraitå®šä¹‰pythonç›¸å…³çš„ç±»å‹å’Œç®—æ³•ï¼Œæš´éœ²ç»™pythonã€‚åŒæ—¶ä¸ºpythonéƒ¨åˆ†ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œä¸€æ–¹é¢ä¿è¯APIå¯ç”¨ï¼Œå¦ä¸€æ–¹é¢ä¸ä¸Šé¢çš„ground truthåšå¯¹æ¯”ï¼Œç¡®ä¿æ¯ä¸ªç®—æ³•çš„è®¡ç®—ç»“æœä¸ground truthçš„ç»“æœåå·®å€¼åœ¨1e-8ä»¥å†…ã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºground truthé‡Œé¢å¸¦äº†&lt;code&gt;traj-dist&lt;/code&gt;çš„æ€§èƒ½ï¼Œå› æ­¤&lt;code&gt;traj-dist-rs&lt;/code&gt;ä¹Ÿå¯ä»¥å¾ˆè½»æ¾åœ°åšå‡ºæ€§èƒ½å¯¹æ¯”ï¼Œå¾—åˆ°rustç›¸å¯¹äºpythonå’Œcythonçš„æ€§èƒ½æå‡æ¯”ä¾‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="ä¸‰æ€§èƒ½æµ‹è¯•ç»“æœ"&gt;ä¸‰ã€æ€§èƒ½æµ‹è¯•ç»“æœ
&lt;/h2&gt;&lt;p&gt;æ€§èƒ½æµ‹è¯•è¿™é‡Œï¼Œé¦–å…ˆéšæœºé€‰1000ä¸ªè½¨è¿¹pairï¼Œæ¯ä¸ªæ ·æœ¬é¢„çƒ­10æ¬¡ï¼Œæ­£å¼æµ‹é‡50æ¬¡ï¼Œè®°å½•è¿™50æ¬¡çš„æ˜ç»†æ—¶é—´ï¼Œå¹¶ç»Ÿè®¡ä¸­ä½æ•°ã€Coefficient of Variationç­‰å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ä¼šç”¨&lt;code&gt;traj-dist&lt;/code&gt;çš„pythonç‰ˆæœ¬ã€cythonç‰ˆæœ¬ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„pythonç‰ˆæœ¬è¿è¡Œç›¸åŒçš„æµ‹è¯•ç”¨ä¾‹ï¼Œè®°å½•å‡å€¼ã€æ ‡å‡†å·®ã€CVå€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯å…·ä½“çš„æå‡æ•ˆæœï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;EUCLIDEAN è·ç¦»&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Rust vs Cython&lt;/strong&gt;: å¹³å‡æå‡ 9.99x (èŒƒå›´: 6.06x - 16.13x)&lt;/li&gt;
&lt;li&gt;Rust vs Python: å¹³å‡æå‡ 389.07x (èŒƒå›´: 187.20x - 594.74x)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½³æ€§èƒ½æå‡ç®—æ³•&lt;/strong&gt;: sspd (16.13x)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;SPHERICAL è·ç¦»&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Rust vs Cython&lt;/strong&gt;: å¹³å‡æå‡ 2.66x (èŒƒå›´: 1.62x - 5.24x)&lt;/li&gt;
&lt;li&gt;Rust vs Python: å¹³å‡æå‡ 75.67x (èŒƒå›´: 41.13x - 167.14x)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½³æ€§èƒ½æå‡ç®—æ³•&lt;/strong&gt;: erp (5.24x)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸ªç»“æœæ¯”æˆ‘é¢„æœŸçš„è¦å¥½å¾ˆå¤šã€‚ç›¸æ¯” Python å®ç°æå‡ 389 å€ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸º Rust æ²¡æœ‰è§£é‡Šå™¨å¼€é”€ï¼ŒåƒåŠ¨æ€è§„åˆ’ç®—æ³•è¿™ç§éœ€è¦åŒé‡forå¾ªç¯çš„ç®—æ³•ï¼Œpythonä¸€å®šæ˜¯éå¸¸æ…¢çš„ï¼Œè€Œä¸”rustçš„ç¼–è¯‘å™¨èƒ½åšå¾ˆå¤šä¼˜åŒ–ã€‚ç›¸æ¯” Cython å®ç°æå‡ 10 å€ï¼Œè¿™éƒ¨åˆ†ä¸»è¦æ˜¯æ•°æ®æ‹·è´å¸¦æ¥çš„ï¼Œrustçš„å®ç°ä¸­ä½¿ç”¨äº†numpy+é›¶æ‹·è´çš„æ–¹æ¡ˆï¼Œé¿å…äº†æ•°æ®å¤åˆ¶ï¼Œè®ºè®¡ç®—æ€§èƒ½æ¥è¯´ï¼Œrustå’Œcythonç”Ÿæˆçš„cä»£ç ï¼Œæœ¬è´¨ä¸Šåº”è¯¥ä¸ä¼šæœ‰å¤ªå¤§åŒºåˆ«ã€‚&lt;/p&gt;
&lt;p&gt;è‡³äºæ¬§æ°è·ç¦»ä¸Šçš„æ€§èƒ½æå‡è¿œå¤§äºçƒé¢è·ç¦»çš„æå‡ï¼Œè¿™æ˜¯å› ä¸ºæ¬§æ°è·ç¦»çš„è®¡ç®—å¤ªç®€å•ï¼Œ&amp;ldquo;è¯­è¨€æ•ˆç‡&amp;quot;æˆä¸ºç“¶é¢ˆï¼ŒRust ä¼˜åŠ¿æ˜æ˜¾ï¼›çƒé¢è·ç¦»çš„è®¡ç®—å¤ªå¤æ‚ï¼Œ&amp;ldquo;æ•°å­¦è®¡ç®—&amp;quot;æˆä¸ºç“¶é¢ˆï¼ŒRust ä¼˜åŠ¿è¢«ç¨€é‡Šã€‚&lt;/p&gt;
&lt;h2 id="å››æ¶æ„è®¾è®¡"&gt;å››ã€æ¶æ„è®¾è®¡
&lt;/h2&gt;&lt;p&gt;æ¥ä¸‹æ¥è¯´ä¸€ä¸‹æ¶æ„çš„è®¾è®¡ï¼Œæ ¸å¿ƒæœ‰å‡ ä¸ªå†…å®¹å§ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;rustæ¥å£è®¾è®¡&lt;/li&gt;
&lt;li&gt;åŠ¨æ€è§„åˆ’ç®—æ³•ä¼˜åŒ–&lt;/li&gt;
&lt;li&gt;rustä¸pythonçš„åŒæ¥å£è®¾è®¡&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="41-rustæ¥å£è®¾è®¡"&gt;4.1 rustæ¥å£è®¾è®¡
&lt;/h3&gt;&lt;p&gt;rustè®¾è®¡äº†å‡ ä¸ªå…³é”®çš„Traitï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;trait&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AsCoord&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Get the x-coordinate (longitude or easting)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Returns the x-coordinate value of the point.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Get the y-coordinate (latitude or northing)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Returns the y-coordinate value of the point.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;y&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸ªAsCoordç”¨æ¥è¡¨ç¤ºä¸€ä¸ªç»çº¬åº¦ç‚¹ï¼Œå› ä¸ºè‚¯å®šè¦è®¡ç®—ç»çº¬åº¦ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œé‚£ä¹ˆç”¨è¿™æ ·ä¸€ä¸ªtraitæŠ½è±¡ï¼Œä¸è®ºç”¨æˆ·æ˜¯ç”¨&lt;code&gt;&amp;amp;[f64]&lt;/code&gt;è¿˜æ˜¯&lt;code&gt;vec&lt;/code&gt;ï¼Œéƒ½å¯ä»¥è½»æ¾æ”¯æŒï¼Œå¹¶ä¸”ä¿è¯å¾ˆå¥½çš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;trait&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CoordSequence&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// The type of coordinate in this sequence
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="nc"&gt;Coord&lt;/span&gt;: &lt;span class="nc"&gt;AsCoord&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Get the number of coordinates in the sequence
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Returns the total number of coordinate points in the sequence.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Check if the sequence is empty
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Returns `true` if the sequence contains no coordinates, `false` otherwise.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// This is implemented as `self.len() == 0` by default.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;is_empty&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Get the i-th coordinate in the sequence
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Returns a copy of the coordinate at the specified index.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// # Panics
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;///
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// This method may panic if the index is out of bounds.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;: &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Coord&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸ªtraitè¡¨ç¤ºè½¨è¿¹ï¼Œä¹Ÿå°±æ˜¯ç»çº¬åº¦åºåˆ—ã€‚å› æ­¤åªè¦ç”¨æˆ·å°†è‡ªå·±çš„æ•°æ®ç±»å‹å®ç°è¿™ä¸ªtraitçš„æ¥å£ï¼Œå°±å¯ä»¥è°ƒç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;é‡Œé¢çš„è·ç¦»è®¡ç®—å‡½æ•°äº†ã€‚&lt;/p&gt;
&lt;h3 id="42-åŠ¨æ€è§„åˆ’ç®—æ³•ä¼˜åŒ–"&gt;4.2 åŠ¨æ€è§„åˆ’ç®—æ³•ä¼˜åŒ–
&lt;/h3&gt;&lt;h4 id="421-åŠ¨æ€è§„åˆ’ç®—æ³•çš„ç±»å‹æŠ½è±¡"&gt;4.2.1 åŠ¨æ€è§„åˆ’ç®—æ³•çš„ç±»å‹æŠ½è±¡
&lt;/h4&gt;&lt;p&gt;å¯¹äºåŠ¨æ€è§„åˆ’ç®—æ³•æ¥è¯´ï¼Œä¸€èˆ¬åªéœ€è¦è®¡ç®—ä»»æ„ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ã€‚è€ƒè™‘åˆ°ç”¨æˆ·éœ€è¦ä½¿ç”¨çš„è·ç¦»è®¡ç®—æ–¹æ³•&lt;code&gt;traj-dist-rs&lt;/code&gt;ä¸æ”¯æŒï¼Œæ¯”å¦‚å¯¼èˆªè·ç¦»ã€‚å› æ­¤éœ€è¦ç»™ç”¨æˆ·æä¾›ä¸€ä¸ªç±»ä¼¼scikit-learnçš„æ–¹æ¡ˆï¼šç”¨æˆ·å¯ç”¨é¢„å…ˆè®¡ç®—å¥½ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œç„¶åä¼ å…¥è¿™ä¸ªâ€œé¢„è®¡ç®—è·ç¦»çŸ©é˜µâ€ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤å¯¹äºåŠ¨æ€è§„åˆ’ç±»çš„ç®—æ³•ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;æä¾›ä¸¤ç§æ¥å£å½¢å¼ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç”¨æˆ·å¯ç”¨ä¼ å…¥2æ¡åŸå§‹çš„ç»çº¬åº¦åºåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·æä¾›ä¸€ä¸ªé¢„è®¡ç®—è·ç¦»çŸ©é˜µã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é’ˆå¯¹è¿™ä¸¤ç§ç±»å‹ï¼Œæˆ‘å®šä¹‰äº†ä¸€ä¸ªå«&lt;code&gt;DistanceCalculator&lt;/code&gt;çš„traitã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;trait&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DistanceCalculator&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Calculate the distance between corresponding elements in two sequences
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;dis_between&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;seq_a_idx&lt;/span&gt;: &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;seq_b_idx&lt;/span&gt;: &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Calculate the distance between a point in a sequence and an external &amp;#34;anchor&amp;#34; point
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;compute_dis_for_extra_point&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;: &lt;span class="nc"&gt;AsCoord&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;seq_id&lt;/span&gt;: &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;point_idx&lt;/span&gt;: &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;anchor&lt;/span&gt;: &lt;span class="nb"&gt;Option&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Length of sequence 1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;len_seq1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sd"&gt;/// Length of sequence 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;len_seq2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kt"&gt;usize&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åŠ¨æ€è§„åˆ’ç®—æ³•å®Œå…¨å¯ä»¥é€šè¿‡è¿™ä¸ªtraitçš„æ³›å‹ï¼Œå–å‡ºä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œå®ŒæˆåŠ¨æ€è§„åˆ’ç®—æ³•çš„è®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œ&lt;code&gt;traj-dist-rs&lt;/code&gt;é‡Œé¢æä¾›äº†ä¸¤ä¸ªå…·ä½“çš„ç±»å‹å®ç°äº†è¿™ä¸ªtraitã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;TrajectoryCalculator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;U&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;where&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;: &lt;span class="nc"&gt;CoordSequence&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;U&lt;/span&gt;: &lt;span class="nc"&gt;CoordSequence&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt; &lt;span class="nc"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;traj2&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt; &lt;span class="nc"&gt;U&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;metric&lt;/span&gt;: &lt;span class="nc"&gt;DistanceType&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;PrecomputedDistanceCalculator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;distance_matrix&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt; &lt;span class="nb"&gt;Vec&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nb"&gt;Vec&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;seq1_extra_dists&lt;/span&gt;: &lt;span class="nb"&gt;Option&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Vec&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;seq2_extra_dists&lt;/span&gt;: &lt;span class="nb"&gt;Option&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Vec&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;f64&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ol&gt;
&lt;li&gt;&lt;code&gt;TrajectoryCalculator&lt;/code&gt;ï¼šç›´æ¥è®¿é—®è½¨è¿¹æ•°æ®ï¼ŒæŒ‰éœ€è®¡ç®—è·ç¦»&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PrecomputedDistanceCalculator&lt;/code&gt;ï¼šä½¿ç”¨é¢„è®¡ç®—çš„è·ç¦»çŸ©é˜µ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™æ ·çš„å¥½å¤„æ˜¯ç®—æ³•é€»è¾‘å’Œè·ç¦»è®¡ç®—é€»è¾‘è§£è€¦ï¼Œå¦‚æœå°†æ¥è¦æ”¯æŒå…¶ä»–è·ç¦»è®¡ç®—æ–¹å¼ï¼Œåªéœ€è¦å®ç°æ–°çš„ Calculator å°±å¯ä»¥äº†ã€‚æ¯”å¦‚ç”¨æˆ·éœ€è¦å®æ—¶è°ƒç”¨æ¥å£è·å–ä¸¤ç‚¹ä¹‹é—´çš„å¯¼èˆªè·ç¦»ï¼Œé‚£ä¹ˆç”¨æˆ·è‡ªå·±å®ç°è¿™ä¸ªtraitå°±å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’ç®—æ³•äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ä»£ç æ˜¯ä½¿ç”¨&lt;code&gt;traj-dist-rs&lt;/code&gt;æä¾›çš„&lt;code&gt;TrajectoryCalculator&lt;/code&gt;è°ƒç”¨åŠ¨æ€è§„åˆ’ç®—æ³•çš„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-rust" data-lang="rust"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;traj_dist_rs&lt;/span&gt;::&lt;span class="n"&gt;distance&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt;::&lt;span class="n"&gt;TrajectoryCalculator&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;distance_type&lt;/span&gt;::&lt;span class="n"&gt;DistanceType&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="fm"&gt;vec!&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;]];&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;traj2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="fm"&gt;vec!&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]];&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;calculator&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TrajectoryCalculator&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;traj2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DistanceType&lt;/span&gt;::&lt;span class="n"&gt;Euclidean&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dist&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;distance&lt;/span&gt;::&lt;span class="n"&gt;dtw&lt;/span&gt;::&lt;span class="n"&gt;dtw&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;calculator&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id="422-åŠ¨æ€è§„åˆ’ç®—æ³•å†…å­˜ä¼˜åŒ–"&gt;4.2.2 åŠ¨æ€è§„åˆ’ç®—æ³•å†…å­˜ä¼˜åŒ–
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;traj-dist-rs&lt;/code&gt;é’ˆå¯¹åŠ¨æ€è§„åˆ’ç®—æ³•è¿˜åšäº†ä¸€ä¸ªå†…å­˜ä¸Šçš„ä¼˜åŒ–ï¼šå¯¹äºå¤§éƒ¨åˆ†åŠ¨æ€è§„åˆ’ç®—æ³•ï¼Œå½“æˆ‘ä»¬ä¸éœ€è¦å›æº¯åŠ¨æ€è§„åˆ’ç®—æ³•çš„è·¯å¾„çš„æ—¶å€™ï¼Œå…¶ç©ºé—´å¤æ‚åº¦å¯ä»¥ç¼©å‡åˆ°&lt;code&gt;O(MN) -&amp;gt; O(min{M, N})&lt;/code&gt;ï¼Œè¿™é‡Œçš„Må’ŒNæ˜¯2æ¡åºåˆ—çš„é•¿åº¦ã€‚&lt;code&gt;traj-dist-rs&lt;/code&gt;ä¼šé»˜è®¤ä½¿ç”¨è¿™ç§ç®—æ³•è®°å½•åŠ¨æ€è§„åˆ’ç®—æ³•çš„ä¸­é—´å€¼ï¼Œå®ç°å†…å­˜ä½¿ç”¨çš„ä¸‹é™ã€‚&lt;/p&gt;
&lt;h3 id="43-åŒæ¥å£æ”¯æŒ"&gt;4.3 åŒæ¥å£æ”¯æŒ
&lt;/h3&gt;&lt;p&gt;è¿™ä¸ªé¡¹ç›®åŒæ—¶æä¾›äº† Rust API å’Œ Python ç»‘å®šã€‚å› ä¸ºæ®æˆ‘äº†è§£è®¡ç®—è½¨è¿¹è·ç¦»ï¼Œå¤§å®¶åŸºæœ¬éƒ½æ˜¯pythonå®ç°ï¼Œè€Œä¸”å­¦æœ¯ç•Œç”¨å¾—æ›´å¤šï¼Œå› ä¸ºè½¨è¿¹è¡¨ç¤ºå­¦ä¹ ä¹‹åçš„åº¦é‡æ–¹å¼ï¼Œå¾ˆå¤šè®ºæ–‡ä¼šä½¿ç”¨æ›´ä¼ ç»Ÿçš„metricsï¼Œæ¯”å¦‚DTWï¼Œfrechetç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤å¦‚æœè¦ç”¨pythonåšçš„è¯ï¼Œcythonè¿™ä¸ªåŠ é€Ÿæ–¹æ¡ˆæœ‰ç‚¹è€äº†ï¼Œè€Œä¸”éœ€è¦å­¦ä¹ cythonä»£ç ï¼›pybind11ä¸c++çš„æ–¹æ¡ˆä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯ä¸å¦‚pyo3+rustçš„æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ˜¯è¿™æ ·ï¼Œæˆ‘è¿˜ä¸å¸Œæœ›è¿™ä¸ªåŒ…åªæœåŠ¡pythonç”¨æˆ·ï¼Œåº”è¯¥ä¹Ÿèƒ½æœåŠ¡rustç”¨æˆ·ã€‚è¿™æ ·å°±è¦æ±‚rustçš„ä»£ç åº”è¯¥æ›´ç®€å•ã€æŠ½è±¡ã€å†…èšï¼Œåœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ pythonçš„bindingã€‚&lt;/p&gt;
&lt;p&gt;Python ç»‘å®šé€šè¿‡ PyO3 å®ç°ï¼ŒAPI è®¾è®¡å°½é‡ä¿æŒå’Œ traj-dist ä¸€è‡´ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;traj_dist_rs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;traj1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;traj2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# ä½¿ç”¨æ–¹å¼å‡ ä¹å’Œ traj-dist ä¸€æ ·&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dist&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;traj_dist_rs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dtw&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;traj2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dist&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;traj_dist_rs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lcss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;traj2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;eps&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# ERP æœ‰ä¸¤ä¸ªç‰ˆæœ¬&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dist_standard&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;traj_dist_rs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;erp_standard&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;traj2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dist_compat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;traj_dist_rs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;erp_compat_traj_dist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;traj1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;traj2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;euclidean&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è€ƒè™‘åˆ°å¤§éƒ¨åˆ†æ•°æ®éƒ½æ˜¯åœ¨pythonä¸­è¯»å–çš„ï¼Œé‚£ä¹ˆå¦‚ä½•è®©rusté€šè¿‡é›¶æ‹·è´çš„æ–¹å¼è¯»å–æ˜¯æå‡æ€§èƒ½çš„ä¸€ä¸ªå…³é”®ã€‚å› ä¸ºä¼ ç»Ÿæ–¹å¼é‡Œé¢ï¼Œå½“ Python è°ƒç”¨ C/C++/Cython æ¨¡å—æ—¶ï¼Œå¾€å¾€éœ€è¦å…ˆæŠŠè¿™ç®±è´§ç‰©â€œå¸ä¸‹â€ï¼ˆä»Pythonå†…å­˜ï¼‰ï¼Œå†â€œæ¬è¿â€å¹¶â€œé‡æ–°æ‰“åŒ…â€ï¼ˆå¤åˆ¶åˆ°C/C++/Cythonèƒ½ç†è§£çš„å†…å­˜ç»“æ„ä¸­ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯æœ‰å¼€é”€çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è¿™é‡Œåˆ©ç”¨äº†numpyçš„c-contiguousç‰¹æ€§ï¼Œå½“numpy.ndarrayçš„æ•°æ®åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­å­˜å‚¨çš„æ—¶å€™ï¼Œå¯ä»¥ä¸éœ€è¦â€œæ¬è¿â€å’Œâ€œæ‰“åŒ…â€æ“ä½œï¼Œç›´æ¥åœ¨åŸåœ°æ‰“å¼€è´§ç‰©ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šrustå¯ä»¥ç›´æ¥è¯»å–pythonä¸­çš„numpy.ndarrayçš„æ•°æ®ï¼Œè€Œä¸æ˜¯å¤åˆ¶ä¸€ä»½ã€‚è¿™é‡Œrustæ‹¿åˆ°çš„æ˜¯ä¸€ä¸ª&lt;code&gt;&amp;amp;[f64]&lt;/code&gt;çš„åˆ‡ç‰‡ã€‚æ¥ä¸‹æ¥åªè¦æŠŠè¿™ä¸ªåˆ‡ç‰‡å®ç°ä¸Šé¢ä»‹ç»çš„&lt;code&gt;CoordSequence&lt;/code&gt;æ¥å£ï¼Œå°±å¯ä»¥é€‚é…å„ä¸ªç®—æ³•äº†ã€‚rustçš„é›¶æˆæœ¬æŠ½è±¡å¯ä»¥ç›´æ¥è®©å„ä¸ªç®—æ³•æ“ä½œè¿™å—å†…å­˜ä¸­çš„æ•°æ®ï¼Œä»¥æ­¤å®ç°æ€§èƒ½æå‡ï¼ŒåŒæ—¶ä¹Ÿé¿å…äº†æ•°æ®çš„æ‹·è´ï¼Œè¿™ä¹Ÿæ˜¯rustæ€§èƒ½è¶…è¶Šcythonçš„æ ¸å¿ƒåŸå› ã€‚&lt;/p&gt;
&lt;h2 id="äº”è¸©è¿‡çš„å‘"&gt;äº”ã€è¸©è¿‡çš„å‘
&lt;/h2&gt;&lt;p&gt;åšè¿™ä¸ªé¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿå‘ç°äº†ä¸€äº›é—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id="51-çƒé¢è·ç¦»çš„ç²¾åº¦é—®é¢˜"&gt;5.1 çƒé¢è·ç¦»çš„ç²¾åº¦é—®é¢˜
&lt;/h3&gt;&lt;p&gt;ä¸€å¼€å§‹æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘å‘ç°çƒé¢è·ç¦»è®¡ç®—çš„ç»“æœå’Œ &lt;code&gt;traj-dist&lt;/code&gt; çš„ç»“æœå¯¹ä¸ä¸Šã€‚æ’æŸ¥äº†å¾ˆä¹…ï¼Œæœ€åå‘ç°é—®é¢˜å‡ºåœ¨ &lt;code&gt;traj-dist&lt;/code&gt; çš„ Cython å®ç°ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;traj-dist çš„ Cython ä»£ç ä¸­ï¼Œçƒé¢è·ç¦»è®¡ç®—ä½¿ç”¨çš„æ˜¯ &lt;code&gt;float&lt;/code&gt;ï¼ˆ32 ä½æµ®ç‚¹æ•°ï¼‰ï¼Œè€Œä¸” PI å€¼æ˜¯ç¡¬ç¼–ç çš„æˆªæ–­å€¼ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cython" data-lang="cython"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;cdef&lt;/span&gt; &lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="nf"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;3.14159265&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸ªç²¾åº¦æ˜¾ç„¶ä¸å¤Ÿã€‚ä¸ºäº†å’Œ &lt;code&gt;traj-dist&lt;/code&gt; çš„ç»“æœå¯¹æ¯”ï¼Œæˆ‘forkå¹¶ä¿®æ”¹äº†&lt;code&gt;traj-dist&lt;/code&gt;çš„æºç ï¼ŒæŠŠ &lt;code&gt;float&lt;/code&gt; æ”¹æˆ &lt;code&gt;double&lt;/code&gt;ï¼Œä½¿ç”¨ &lt;code&gt;M_PI&lt;/code&gt; å¸¸é‡ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cython" data-lang="cython"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;cdef&lt;/span&gt; &lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="nf"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;M_PI&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¿®å¤åï¼ŒRust å®ç°å’Œ traj-dist çš„ç»“æœå°±å¯¹ä¸Šäº†ã€‚&lt;/p&gt;
&lt;h3 id="52-erp-ç®—æ³•çš„å®ç°é—®é¢˜"&gt;5.2 ERP ç®—æ³•çš„å®ç°é—®é¢˜
&lt;/h3&gt;&lt;p&gt;åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç° traj-dist çš„ ERP ç®—æ³•å®ç°æœ‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ERPç®—æ³•æ˜¯å…¸å‹çš„åŠ¨æ€è§„åˆ’ç®—æ³•ï¼Œåœ¨åˆå§‹åŒ–åŠ¨æ€è§„åˆ’çŸ©é˜µçš„è¾¹ç•Œå€¼çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯&lt;code&gt;C[0,:]&lt;/code&gt;å’Œ&lt;code&gt;C[:,0]&lt;/code&gt;ï¼Œ&lt;code&gt;traj-dist&lt;/code&gt;ä½¿ç”¨äº†é”™è¯¯çš„æ–¹æ³•ï¼Œç»™æ¯ä¸ªå€¼éƒ½åˆå§‹åŒ–æˆäº†ç›¸åŒçš„å€¼ï¼Œè¿™é‡Œçš„æ­£ç¡®å®ç°åº”è¯¥æ˜¯ä¸åŒçš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘çº ç»“äº†åŠå¤©ï¼Œè€ƒè™‘åˆ°è¿™ä¸ªåŒ…å·²ç»è¢«å¾ˆå¤šäººç”¨äº†ï¼Œç›´æ¥ä¿®æ”¹ API ä¼šç ´åå…¼å®¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘æƒ³äº†ä¸ªæŠ˜ä¸­çš„æ–¹æ¡ˆï¼šæä¾›ä¸¤ä¸ªç‰ˆæœ¬&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;erp_standard&lt;/code&gt;ï¼šæŒ‰ç…§æ­£ç¡®çš„ç®—æ³•å®ç°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;erp_compat_traj_dist&lt;/code&gt;ï¼šæŒ‰ç…§ &lt;code&gt;traj-dist&lt;/code&gt; çš„é—®é¢˜ç‰ˆæœ¬å®ç°ï¼Œä¿æŒå…¼å®¹æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™æ ·ï¼Œæ–°ç”¨æˆ·å¯ä»¥ç”¨æ­£ç¡®çš„å®ç°ï¼Œè€ç”¨æˆ·å¦‚æœéœ€è¦å’ŒåŸæ¥ä¿æŒä¸€è‡´ï¼Œä¹Ÿå¯ä»¥ç”¨å…¼å®¹ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;h2 id="å…­ç²¾åº¦ä¿è¯"&gt;å…­ã€ç²¾åº¦ä¿è¯
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„å®ç°ï¼Œä»¥&lt;code&gt;traj-dist&lt;/code&gt;ä¸ºåŸºå‡†ï¼Œå› æ­¤éœ€è¦ä¸¤è€…è·‘å‡ºæ¥çš„ç»“æœå°½å¯èƒ½ä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘åšäº†ä¸¤ä»¶äº‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆä¿®æ”¹&lt;code&gt;traj-dist&lt;/code&gt;çš„çƒé¢è·ç¦»è®¡ç®—ä»£ç ï¼Œå°†æ‰€æœ‰çš„floatéƒ¨åˆ†æ›¿æ¢ä¸ºdoubleï¼Œå¹¶ä¸”ä¿®æ”¹PIçš„å€¼ä¸ºM_PIï¼Œä»¥è·å¾—æ›´é«˜çš„ç²¾åº¦ã€‚&lt;/li&gt;
&lt;li&gt;å› ä¸º&lt;code&gt;traj-dist&lt;/code&gt;çš„erpç®—æ³•å®ç°æœ‰è¯¯ï¼Œä¸ºäº†ä¿è¯ç»“æœçš„ä¸€è‡´æ€§ï¼Œæˆ‘è¿™é‡Œæµ‹é‡çš„æ˜¯&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„&lt;code&gt;erp_compat_traj_dist&lt;/code&gt;ä¸&lt;code&gt;traj-dist&lt;/code&gt;çš„erpç®—æ³•ä¹‹é—´çš„è¯¯å·®ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æµ‹ç®—ä¸‹æ¥è¯¯å·®è¿œè¿œå°äºæˆ‘æœŸæœ›çš„1e-8çš„é˜ˆå€¼ï¼Œè¯´æ˜&lt;code&gt;traj-dist-rs&lt;/code&gt;å®ç°äº†ç®—æ³•çš„æ­£ç¡®å®ç°ã€‚&lt;/p&gt;
&lt;h2 id="ä¸ƒæ€»ç»“"&gt;ä¸ƒã€æ€»ç»“
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;traj-dist-rs&lt;/code&gt;çš„å®ç°æˆ‘è§‰å¾—æœ‰å‡ ä¸ªäº®ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨rusté‡å†™&lt;/li&gt;
&lt;li&gt;ä¸pythonçš„ç»‘å®šä¸­è€ƒè™‘äº†é›¶æ‹·è´çš„é—®é¢˜&lt;/li&gt;
&lt;li&gt;rustå±‚é¢åšäº†æ¯”è¾ƒå¥½çš„æŠ½è±¡ï¼Œä¸è®ºæ˜¯&lt;code&gt;CoordSequence&lt;/code&gt;è¿˜æ˜¯&lt;code&gt;DistanceCalculator&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰åŠ¨æ€è§„åˆ’ç®—æ³•æä¾›äº†èŠ‚çœå†…å­˜çš„å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;ç¡®å®å®ç°äº†æ€§èƒ½çš„æ˜¾è‘—æå‡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœä½ ä¹Ÿåœ¨åšè½¨è¿¹æ•°æ®åˆ†æï¼Œæˆ–è€…å¯¹ Rust æ€§èƒ½ä¼˜åŒ–æ„Ÿå…´è¶£ï¼Œæ¬¢è¿è¯•è¯• &lt;code&gt;traj-dist-rs&lt;/code&gt;ã€‚é¡¹ç›®åœ°å€åœ¨ï¼š&lt;a class="link" href="https://github.com/Davidham3/traj-dist-rs" target="_blank" rel="noopener"
&gt;traj-dist-rs&lt;/a&gt;ã€‚ç›®å‰alphaç‰ˆæœ¬å·²ç»å‘å¸ƒåœ¨crates.ioå’Œpypiï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒcontext7ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿äº¤æµï¼&lt;/p&gt;
&lt;h2 id="é™„å½•"&gt;é™„å½•
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;ä¿®å¤çƒé¢è·ç¦»ç²¾åº¦çš„ï¼š&lt;a class="link" href="https://github.com/Davidham3/traj-dist" target="_blank" rel="noopener"
&gt;traj-dist&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®Œæ•´çš„æ€§èƒ½æµ‹è¯•è®°å½•ï¼š&lt;a class="link" href="https://github.com/Davidham3/traj-dist-rs/blob/v0.1.0-alpha.3/docs/performance.md" target="_blank" rel="noopener"
&gt;performance.md&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>uvæ‰¾ä¸åˆ°Pythonå¤´æ–‡ä»¶</title><link>https://davidham3.github.io/blog/p/uv%E6%89%BE%E4%B8%8D%E5%88%B0python%E5%A4%B4%E6%96%87%E4%BB%B6/</link><pubDate>Wed, 30 Apr 2025 10:34:55 +0000</pubDate><guid>https://davidham3.github.io/blog/p/uv%E6%89%BE%E4%B8%8D%E5%88%B0python%E5%A4%B4%E6%96%87%E4%BB%B6/</guid><description>&lt;p&gt;æœ€è¿‘åœ¨å¾®è°ƒLLMçš„æ—¶å€™ï¼Œæˆ‘å‘ç°ä½¿ç”¨uvæ„å»ºçš„ç¯å¢ƒï¼Œæœ‰æ—¶å€™ä¼šæ‰¾ä¸åˆ°Python.hï¼Œå¯¼è‡´ä¸€äº›åº“æŠ¥é”™ï¼Œå¦‚&lt;code&gt;fatal error: Python.h: No such file or directory&lt;/code&gt;ã€‚é€šè¿‡è®¾ç½®&lt;code&gt;python-preference&lt;/code&gt;å¯ä»¥è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘æœ€è¿‘ä½¿ç”¨&lt;code&gt;nvidia/cuda:12.4.1-cudnn-devel-ubuntu22.04&lt;/code&gt;è¿™ä¸ªé•œåƒï¼Œåœ¨é‡Œé¢å®‰è£…äº†uvã€‚ç„¶åæ¯ä¸ªä½¿ç”¨uvç®¡ç†çš„é¡¹ç›®éƒ½ç”¨è¿™ä¸ªé•œåƒè¿è¡Œä»£ç ã€‚ä¹Ÿå°±æ˜¯å°†ä»£ç ä¸‹è½½åˆ°å®¹å™¨é‡Œé¢ï¼Œé€šè¿‡uv syncå¿«é€Ÿæ‹‰èµ·è™šæ‹Ÿç¯å¢ƒï¼Œç„¶åé€šè¿‡uv runè¿è¡Œé¡¹ç›®ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œæˆ‘å‘ç°åœ¨ä½¿ç”¨ms-swiftè¿›è¡Œå¾®è°ƒçš„æ—¶å€™ï¼Œå°±ä¼šæŠ¥&lt;code&gt;fatal error: Python.h: No such file or directory&lt;/code&gt;è¿™ä¸ªé”™è¯¯ã€‚ç ”ç©¶åå‘ç°æœ‰å‡ ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŸºç¡€é•œåƒé‡Œé¢å®‰è£…äº†pythonï¼ˆédevç‰ˆæœ¬ï¼‰ï¼šæˆ‘è¿™ä¸ªé•œåƒå®‰è£…çš„æ˜¯python3.10&lt;/li&gt;
&lt;li&gt;é¡¹ç›®ä½¿ç”¨çš„pythonç‰ˆæœ¬å’Œæœºå™¨ä¸Šçš„pythonç‰ˆæœ¬ä¸€è‡´ï¼šæˆ‘è¿™ä¸ªé¡¹ç›®ç”¨çš„æ˜¯python3.10&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å½“uvå‘ç°æœºå™¨ä¸Šå·²ç»å®‰è£…pythonçš„æ—¶å€™ï¼Œä¼šé»˜è®¤é€‰æ‹©ä½¿ç”¨æœºå™¨ä¸Šçš„pythonã€‚è¯¦ç»†çš„å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š&lt;a class="link" href="https://docs.astral.sh/uv/concepts/python-versions/" target="_blank" rel="noopener"
&gt;Concepts: python-versions&lt;/a&gt;ã€‚åœ¨uvçš„ä½“ç³»ä¸­ï¼Œå­˜åœ¨ä¸¤ç§pythonï¼Œä¸€ç§æ˜¯managed Pythonï¼Œä¸€ç§æ˜¯system Pythonã€‚å‰è€…è¡¨ç¤ºuvè‡ªè¡Œå®‰è£…çš„pythonï¼Œåè€…æ˜¯ç³»ç»Ÿå†…å·²ç»å®‰è£…çš„pythonã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶uvé‡Œé¢æœ‰ä¸€ä¸ªè®¾å®šï¼š&lt;a class="link" href="https://docs.astral.sh/uv/reference/settings/#python-preference" target="_blank" rel="noopener"
&gt;python-preference&lt;/a&gt;ã€‚è¿™ä¸ªé€‰é¡¹é»˜è®¤å€¼æ˜¯&lt;code&gt;managed&lt;/code&gt;ã€‚è¡¨ç¤ºâ€œç›¸æ¯”system Pythonï¼Œuvä¼šä¼˜å…ˆä½¿ç”¨managed Pythonâ€ã€‚é™¤æ­¤ä»¥å¤–ï¼Œè¿˜æœ‰only-managedï¼Œsystemï¼Œonly-systemè¿™ä¸‰ç§ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åˆ°æˆ‘çš„æƒ…å†µï¼šå®¹å™¨é‡Œé¢åªæœ‰1ä¸ªpythonï¼Œæ˜¯system Pythonï¼Œç‰ˆæœ¬æ˜¯3.10ã€‚æˆ‘è¦è¿è¡Œçš„é¡¹ç›®ä¹Ÿæ˜¯3.10ã€‚uvé»˜è®¤ä½¿ç”¨managedæ¨¡å¼ï¼Œå› æ­¤å°±æ²¡æœ‰å®‰è£…pythonï¼Œç”¨äº†ç³»ç»Ÿè‡ªå¸¦çš„pythonã€‚è€Œç³»ç»Ÿè‡ªå¸¦çš„è¿™ä¸ªpythonåˆæ˜¯édevç‰ˆï¼Œæ²¡æœ‰Python.hè¿™æ ·çš„å¤´æ–‡ä»¶ï¼Œæ‰€ä»¥flash-attentionè¿™äº›éœ€è¦Python.hå¤´æ–‡ä»¶çš„åº“å°±ä¼šæŠ¥é”™ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤è§£å†³æ–¹æ¡ˆå°±æ˜¯è®¾å®šä¸Šæ–‡æåˆ°çš„ï¼špython-preferenceï¼Œä¿®æ”¹ä¸º&lt;code&gt;only-managed&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-toml" data-lang="toml"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;tool&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;uv&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nx"&gt;python-preference&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;only-managed&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸ªé€‰é¡¹çš„å«ä¹‰æ˜¯åªä½¿ç”¨managed Pythonï¼Œä¸ç”¨system Pythonã€‚åœ¨é¡¹ç›®çš„pyproject.tomlé‡Œé¢å¢åŠ ä¸Šè¿°é…ç½®åï¼Œuv syncçš„æ—¶å€™å°±ä¼šä¸‹è½½ä¸€ä¸ªpython3.10ï¼Œå¹¶ä¸”å¸¦å¤´æ–‡ä»¶ï¼Œè¿™æ ·å°±ä¸ä¼šæŠ¥é”™äº†ã€‚&lt;/p&gt;</description></item><item><title>uvå®‰è£…pythonåŠå…¶ä¾èµ–çš„åŠ é€Ÿæ–¹æ³•</title><link>https://davidham3.github.io/blog/p/uv%E5%AE%89%E8%A3%85python%E5%8F%8A%E5%85%B6%E4%BE%9D%E8%B5%96%E7%9A%84%E5%8A%A0%E9%80%9F%E6%96%B9%E6%B3%95/</link><pubDate>Mon, 14 Apr 2025 15:58:27 +0000</pubDate><guid>https://davidham3.github.io/blog/p/uv%E5%AE%89%E8%A3%85python%E5%8F%8A%E5%85%B6%E4%BE%9D%E8%B5%96%E7%9A%84%E5%8A%A0%E9%80%9F%E6%96%B9%E6%B3%95/</guid><description>&lt;p&gt;å›½å†…åœ¨ä½¿ç”¨uvçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šæ¶‰åŠåˆ°è£…pythonçš„é€Ÿåº¦å¤ªæ…¢çš„é—®é¢˜ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨&lt;code&gt;UV_PYTHON_INSTALL_MIRROR&lt;/code&gt;è¿™ä¸ªç¯å¢ƒå˜é‡ã€‚é™¤æ­¤ä»¥å¤–ï¼Œå¯¹äºå¤šäººåä½œåœºæ™¯ï¼Œ&lt;code&gt;UV_CACHE_DIR&lt;/code&gt;ä¹Ÿæ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ç¯å¢ƒå˜é‡ã€‚æœ¬æ–‡ä¼šä»‹ç»è¿™ä¸¤ä¸ªå˜é‡ã€‚&lt;/p&gt;
&lt;h2 id="uv_python_install_mirror"&gt;UV_PYTHON_INSTALL_MIRROR
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;uv sync&lt;/code&gt;ã€&lt;code&gt;uv venv&lt;/code&gt;ã€&lt;code&gt;uv python install&lt;/code&gt;è¿™å‡ ä¸ªå‘½ä»¤éƒ½ä¼šå®‰è£…ä¸€ä¸ªpythonã€‚è¿™ä¸ªpythonçš„å®‰è£…åŒ…ä¼šä»&lt;a class="link" href="https://github.com/astral-sh/python-build-standalone/releases" target="_blank" rel="noopener"
&gt;astral-sh/python-build-standalone/releases&lt;/a&gt;è¿™é‡Œä¸‹è½½ã€‚ä½†æ˜¯å¯¹äºå›½å†…çš„ä¸€äº›ä½ç½®ï¼Œä»è¿™é‡Œä¸‹è½½pythonçš„é€Ÿåº¦éå¸¸æ…¢ï¼Œæœ‰äº›åœ°æ–¹æ ¹æœ¬è®¿é—®ä¸äº†ã€‚ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ–¹æ³•æ˜¯è‡ªå·±å…ˆè¿›å…¥è¿™ä¸ªé¡µé¢ï¼Œæ‰¾åˆ°ä¸€ä¸ªç‰ˆæœ¬ï¼Œæ¯”å¦‚&lt;code&gt;20250409&lt;/code&gt;ï¼Œç„¶åä¸‹è½½å‡ ä¸ªéœ€è¦çš„pythonç‰ˆæœ¬ï¼Œæ¯”å¦‚3.10ã€3.11ã€3.12ï¼Œç„¶åæ ¹æ®è‡ªå·±æœºå™¨çš„æ¶æ„ï¼Œæ¯”å¦‚æ˜¯x86_64çš„ï¼Œlinuxç³»ç»Ÿï¼Œé‚£å°±ä¸‹è½½ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;cpython-3.10.17+20250409-x86_64-unknown-linux-gnu-install_only_stripped.tar.gz
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;cpython-3.11.12+20250409-x86_64-unknown-linux-gnu-install_only_stripped.tar.gz
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;cpython-3.12.10+20250409-x86_64-unknown-linux-gnu-install_only_stripped.tar.gz
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶ååœ¨æœ¬åœ°å»ºä¸€ä¸ªç›®å½•ï¼Œæ¯”å¦‚&lt;code&gt;/mnt/workspace/uv_python_install_mirror/20250409&lt;/code&gt;ï¼Œç„¶åå°†ä¸Šè¿°å‹ç¼©åŒ…æ”¾å…¥è¿™ä¸ªç›®å½•ï¼Œç„¶åå°†ç¯å¢ƒå˜é‡&lt;code&gt;UV_PYTHON_INSTALL_MIRROR&lt;/code&gt;è®¾ç½®æˆè¿™ä¸ªç›®å½•ï¼Œè¿™æ ·å°±uvå°±ä¼šå»è¿™ä¸ªç›®å½•é‡Œé¢æ‰¾å‹ç¼©åŒ…ï¼Œç„¶åå¿«é€Ÿå®‰è£…pythonäº†ã€‚æ¯”å¦‚&lt;code&gt;export UV_PYTHON_INSTALL_MIRROR=file:///mnt/workspace/uv_python_install_mirror/20250409&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="uv_cache_dir"&gt;UV_CACHE_DIR
&lt;/h2&gt;&lt;p&gt;uvä¼šæŠŠè¿™å°æœºå™¨ä¸Šå®‰è£…è¿‡çš„ä¸€äº›æºç åŒ…ã€wheelåŒ…å­˜å‚¨åœ¨è¿™ä¸ªç¯å¢ƒå˜é‡æŒ‡å‘çš„ç›®å½•ä¸‹ã€‚å› æ­¤ä¸€æ—¦é€šè¿‡&lt;code&gt;uv sync&lt;/code&gt;åŒæ­¥è¿‡ä¸€ä¸ªç¯å¢ƒï¼Œé‚£ä¹ˆè¿™ä¸ªç¯å¢ƒéœ€è¦çš„ä¾èµ–åŒ…å°±ä¼šåœ¨è¿™ä¸ªç›®å½•å­˜å‚¨ä¸€ä»½ã€‚å¯¹äºäº‘åŸç”Ÿåœºæ™¯ï¼Œå¯åŠ¨ä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œåœ¨è¿™ä¸ªå®¹å™¨é‡Œé¢ä½¿ç”¨&lt;code&gt;uv sync&lt;/code&gt;ï¼Œæˆ–è€…&lt;code&gt;uv pip install&lt;/code&gt;çš„æ—¶å€™ï¼Œå¦‚æœå¯ä»¥å°†è¿™ä¸ªç¼“å­˜ç›®å½•æŒ‚è½½åˆ°å®¹å™¨å†…ï¼Œç„¶åè®¾å®šç¯å¢ƒå˜é‡&lt;code&gt;UV_CACHE_DIR&lt;/code&gt;æŒ‡å‘è¿™ä¸ªç›®å½•ï¼Œé‚£å°±å¯ä»¥å¿«é€Ÿæ‹‰èµ·ä¸€ä¸ªç¯å¢ƒï¼Œæ‰€æœ‰çš„ä¾èµ–éƒ½ä¸éœ€è¦é‡æ–°ä¸‹è½½äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç®€å•æ¥è¯´å°±æ˜¯åœ¨å¼€å‘æœºä¸Šï¼Œè®¾å®š&lt;code&gt;UV_CACHE_DIR&lt;/code&gt;ä¸ºä¸€ä¸ªå¯å…±äº«çš„ç›®å½•ã€‚ç„¶åç”¨&lt;code&gt;uv sync&lt;/code&gt;åŒæ­¥ä¸€ä¸ªç¯å¢ƒï¼Œæ­¤æ—¶è¿™ä¸ªç›®å½•å°±ä¼šå­˜å‚¨å„ç§ç¼“å­˜ã€‚ç„¶ååœ¨äº‘åŸç”Ÿå¹³å°å¯åŠ¨å®¹å™¨çš„æ—¶å€™ï¼ŒæŒ‚è½½è¿™ä¸ªç›®å½•ï¼Œå¹¶ä¸”è®¾å®šå®¹å™¨çš„ç¯å¢ƒå˜é‡&lt;code&gt;UV_CACHE_DIR&lt;/code&gt;ä¸ºè¿™ä¸ªç›®å½•ã€‚ç„¶ååœ¨å®¹å™¨å†…ä½¿ç”¨&lt;code&gt;uv sync&lt;/code&gt;ï¼Œå°±å¯ä»¥åˆ©ç”¨è¿™ä»½ç¼“å­˜æ•°æ®å¿«é€Ÿæ‹‰èµ·ç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œä¸Šè¿°æ–¹æ³•ä¹Ÿæœ‰ç¼ºç‚¹ã€‚æ¯”å¦‚åƒé˜¿é‡Œäº‘çš„NASï¼Œå¦‚æœä½¿ç”¨NFSåè®®æŒ‚è½½ï¼Œç”±äºuvåœ¨æ„å»ºç¯å¢ƒçš„æ—¶å€™æ˜¯å¹¶è¡Œï¼Œå­˜åœ¨ä¸€éƒ¨åˆ†pythonåŒ…ä»–ä»¬çš„æ–‡ä»¶æ˜¯å†²çªçš„ï¼Œuvçš„å¹¶è¡Œä¼šè®©é˜¿é‡Œäº‘çš„NASå‡ºé”™ï¼Œä¼šæŠ¥ä¸€ä¸ªOS Error 523ã€‚&lt;a class="link" href="https://help.aliyun.com/zh/nas/user-guide/cross-mount-compatibility-faq#section-dti-749-ix0" target="_blank" rel="noopener"
&gt;é˜¿é‡Œäº‘å®˜æ–¹æ–‡æ¡£&lt;/a&gt;æœ‰è®²å…·ä½“åŸå› ,æ ¸å¿ƒé—®é¢˜å°±æ˜¯åœ¨é˜¿é‡Œäº‘NASä¸Šä»¥NFSåè®®æŒ‚è½½çš„æ—¶å€™ï¼Œä¸æ”¯æŒå¹¶å‘å¯¹ä¸€ä¸ªç›®å½•çš„æ–‡ä»¶è¿›è¡Œrenameã€‚è¿™æ˜¯é˜¿é‡Œäº‘NASäº§å“è®¾è®¡ä¸Šçš„é—®é¢˜ï¼Œæ‰€ä»¥ä½¿ç”¨é˜¿é‡Œäº‘NASä½œä¸ºuvç¼“å­˜çš„è¯ï¼Œå°±éœ€è¦ç”¨æˆ·è‡ªå·±è§£å†³äº†ã€‚æˆ‘ç›®å‰æµ‹è¯•çš„ç»“æœæ˜¯ï¼Œåƒéƒ¨åˆ†jupyterç›¸å…³çš„åŒ…ï¼Œä¼šå†²çªï¼Œä¼šæŠ¥523ã€‚ä½†æ˜¯æŠ¥äº†523åï¼Œå¯ä»¥å†æ¬¡æ‰§è¡Œ&lt;code&gt;uv sync&lt;/code&gt;ï¼Œç„¶åè¿™ä¸ªåŒæ­¥ä¼šç»§ç»­è¿›è¡Œï¼Œå¤šæ‰§è¡Œå‡ æ¬¡ï¼Œå°±å¯ä»¥å¼ºåˆ¶å®‰è£…å¥½ç¯å¢ƒã€‚&lt;/p&gt;</description></item><item><title>TrajDL</title><link>https://davidham3.github.io/blog/p/trajdl/</link><pubDate>Mon, 06 Jan 2025 12:41:49 +0000</pubDate><guid>https://davidham3.github.io/blog/p/trajdl/</guid><description>&lt;img src="https://trajdl.readthedocs.io/en/latest/_static/wide-logo.svg" alt="Featured image of post TrajDL" /&gt;&lt;p&gt;è®°å½•ä¸€ä¸‹å…³äºTrajDLçš„ä¿¡æ¯ã€‚TrajDLæ˜¯æˆ‘ç¼–å†™çš„ç¬¬ä¸€ä¸ªä½“ç³»å®Œæ•´çš„pythonå·¥å…·åŒ…ï¼Œé¢å‘è½¨è¿¹æ·±åº¦å­¦ä¹ ï¼Œç›®çš„æ˜¯æ”¯æŒå¾ˆå¤šè½¨è¿¹æ·±åº¦å­¦ä¹ ç®—æ³•ï¼ŒåŒ…æ‹¬è½¨è¿¹è¡¨ç¤ºå­¦ä¹ ã€è½¨è¿¹åˆ†ç±»ã€ä¸‹ä¸€ä½ç½®é¢„æµ‹ç­‰æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰å·²ç»åœ¨GitHubä¸Šå¼€æºï¼Œé¡¹ç›®ä¸»é¡µæ˜¯ï¼š&lt;a class="link" href="https://github.com/Spatial-Temporal-Data-Mining/TrajDL" target="_blank" rel="noopener"
&gt;https://github.com/Spatial-Temporal-Data-Mining/TrajDL&lt;/a&gt;ï¼Œå·²ç»å‘å¸ƒäº†0.1.0ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨pypiä¸Šä¸‹è½½ï¼Œå®˜æ–¹æ–‡æ¡£æ˜¯ï¼š&lt;a class="link" href="https://trajdl.readthedocs.io/en/latest/" target="_blank" rel="noopener"
&gt;https://trajdl.readthedocs.io/en/latest/&lt;/a&gt;ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ–‡æ¡£æŸ¥é˜…å®ƒçš„ä½¿ç”¨æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰0.1.0ç‰ˆæœ¬åªæ”¯æŒäº†TULERã€t2vecã€GMVSAEã€ST-LSTM 4ä¸ªç®—æ³•ï¼Œå½“ç„¶è¿˜å¼€å‘äº†æ¯”å¦‚CTLEã€HIERè¿™æ ·çš„ç®—æ³•ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å¼€å‘å®Œã€‚&lt;/p&gt;
&lt;p&gt;TrajDLçš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºå¸®ç”¨æˆ·ç®¡ç†äº†æ•°æ®é›†ï¼Œç”¨æˆ·å¯ä»¥å¿«é€Ÿä¸‹è½½å…¬å¼€æ•°æ®é›†ï¼Œå¹¶ä¸”é€šè¿‡TrajDLè®¾è®¡çš„dataseté«˜æ•ˆåœ°å®Œæˆå®éªŒï¼Œä¸€äº›å…³é”®ç®—å­é€šè¿‡C++å®ç°ï¼Œæ•°æ®é›†åŸºäºArrowæ„å»ºï¼Œæ‰€ä»¥æ•´ä¸ªæ¡†æ¶åœ¨æ€§èƒ½ã€å†…å­˜ä½¿ç”¨ä¸Šéƒ½æœ‰æ¯”è¾ƒå¥½çš„æ•ˆæœã€‚æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹æ„å»ºåœ¨lightningä¸Šï¼Œæ‰€ä»¥å³æ”¯æŒAPIå¼€å‘è®­ç»ƒä»£ç ï¼Œåˆæ”¯æŒé€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œè®­ç»ƒã€‚&lt;/p&gt;
&lt;p&gt;0.2.0ç‰ˆæœ¬ä¸»è¦ä¼šåœ¨è½¨è¿¹ç›¸ä¼¼åº¦è®¡ç®—ä¸Šé¢å®ç°ä¸€äº›ç®—æ³•ï¼Œç›®å‰è¿˜åœ¨å¼€å‘ä¸­ã€‚&lt;/p&gt;</description></item><item><title>DBSCAN with Spark</title><link>https://davidham3.github.io/blog/p/dbscan-with-spark/</link><pubDate>Wed, 25 Dec 2024 08:01:34 +0000</pubDate><guid>https://davidham3.github.io/blog/p/dbscan-with-spark/</guid><description>&lt;p&gt;è®²ä¸€ä¸ªåœ¨sparkä¸ŠåšDBSCANçš„æ¡ˆä¾‹ï¼Œè®°å½•ä¸€ä¸‹è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;èƒŒæ™¯ï¼šæœ‰ä¸€ç»„å®ä½“ï¼Œæ¯ä¸ªå®ä½“ä¸‹é¢æŒ‚äº†å¾ˆå¤šç»çº¬åº¦æ•°æ®ï¼Œéœ€è¦å¯¹æ¯ä¸ªå®ä½“è¿è¡Œå¯†åº¦èšç±»è·å¾—ç±»ä¸­å¿ƒã€‚å®é™…å°±æ˜¯ä¸€ä¸ªæ•°æ®æ¸…æ´—çš„æ–¹æ³•ï¼Œè·å¾—å¯†åº¦èšç±»ç»“æœä¸»ç±»åï¼Œå–ä¸»ç±»å¯¹åº”çš„ç»çº¬åº¦çš„ä¸­å¿ƒç‚¹ã€‚è¿™æ ·å°±å¯ä»¥è·å¾—å®ä½“ä¸ç»çº¬åº¦ä¹‹é—´çš„å…³ç³»ï¼Œå®ç°äº†æ•°æ®æ¸…æ´—ã€‚&lt;/p&gt;
&lt;p&gt;å®ç°çš„æ—¶å€™ï¼Œå› ä¸ºscikit-learnæä¾›äº†DBSCANçš„å·¥å…·ï¼Œå› æ­¤ç›´æ¥ä½¿ç”¨pysparkå®ç°ã€‚å¯ä»¥ç›´æ¥å°†æ¯ä¸ªå®ä½“çš„ç»çº¬åº¦æ•°æ®é€šè¿‡sparkèšåˆï¼Œç„¶åå®šä¹‰UDFï¼Œåœ¨UDFé‡Œé¢åšDBSCANï¼Œç„¶åå°†ç»“æœè¿”å›åˆ°sparkçš„DataFrameé‡Œé¢ï¼Œç„¶åå†é€šè¿‡ä¸€äº›ä»£ç æ‰¾å‡ºä¸»ç±»å³å¯ã€‚DBSCANé‡Œé¢å¦‚æœç±»çš„idæ˜¯-1ï¼Œè¯´æ˜è¿™ä¸ªç±»æ˜¯å™ªå£°ï¼Œæ‰€ä»¥åªè¦çœ‹ä¸€ä¸‹å ç»å¯¹ä¼˜åŠ¿çš„ç±»æ˜¯ä¸æ˜¯-1ï¼Œè¿˜æœ‰å®ƒçš„å æ¯”ï¼Œè®¾å®šä¸€ä¸ªé˜ˆå€¼å°±å¯ä»¥å®ç°æ¸…æ´—äº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯æ•°æ®å€¾æ–œçš„é—®é¢˜ï¼šä¸åŒå®ä½“çš„ç»çº¬åº¦æ•°æ®é‡ä¸ä¸€æ ·ï¼Œæœ‰çš„å¤šæœ‰çš„å°‘ã€‚ç”±äºDBSCANçš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n^2)$ï¼Œæ‰€ä»¥å¦‚æœæ•°æ®é‡å¤ªå¤§æ˜¯ç®—ä¸è¿‡æ¥çš„ï¼Œè€Œä¸”ä¼šæ‹–ç´¯æ•´ä¸ªä»»åŠ¡çš„è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;è§£å†³è¿™ä¸ªé—®é¢˜éœ€è¦åšä¸¤ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯¹äºæ¯ä¸ªå®ä½“ï¼Œè®¾å®šä¸€ä¸ªç»çº¬åº¦æ•°é‡çš„ä¸Šé™ï¼Œæ¯”å¦‚æ¯ä¸ªå®ä½“æœ€å¤šåªèƒ½æœ‰1000ä¸ªç»çº¬åº¦ã€‚å¦‚æœè¿™ä¸ªå®ä½“çš„ç»çº¬åº¦æ•°é‡è¶…è¿‡1000ä¸ªï¼Œç›´æ¥é‡‡æ ·ï¼Œé‡‡åˆ°1000ä¸ªã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åå°±æ˜¯ä»»åŠ¡å‡åˆ†ï¼šå› ä¸ºè‚¯å®šæœ‰å¤§é‡çš„å®ä½“å®ƒçš„ç»çº¬åº¦ä¸ªæ•°æ˜¯ä¸åˆ°1000ä¸ªçš„ï¼Œæœ‰å¯èƒ½æœ‰80%çš„å®ä½“çš„ç»çº¬åº¦æ•°éƒ½å¾ˆå°‘ã€‚å¦‚æœåˆ†åŒºçš„é€»è¾‘ä¸å¯¹ï¼Œå¯èƒ½ä¼šä½¿å¾—è¶…è¿‡1000ä¸ªçš„å®ä½“éƒ½èšé›†åœ¨1ä¸ªåˆ†åŒºé‡Œé¢ï¼Œé‚£è¿™ä¸ªåˆ†åŒºè‚¯å®šç®—çš„æ˜¯æœ€æ…¢çš„ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªåˆç†çš„åˆ†åŒºæ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åˆ†åŒºæ–¹æ¡ˆå¾ˆç®€å•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è®¾å®šä¸€ä¸ªåˆ†åŒºæ•°ï¼Œæ¯”å¦‚200ã€‚&lt;/li&gt;
&lt;li&gt;æ„å»ºä¸€ä¸ªæ•°æ®ç»“æ„KeySetï¼Œé‡Œé¢æœ‰ä¸€ä¸ªList[str]ï¼Œä¸€ä¸ªintï¼Œå‰è€…ç”¨æ¥å­˜å‚¨å®ä½“çš„åç§°ï¼Œåè€…ç”¨æ¥å­˜å‚¨å½“å‰è¿™äº›å®ä½“éœ€è¦çš„è®¡ç®—æ¬¡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;æ„å»ºä¸€ä¸ªå°é¡¶å †ï¼Œé‡Œé¢æ”¾ç½®200ï¼ˆå’Œåˆ†åŒºæ•°ä¸€æ ·ï¼‰ä¸ªä¸Šé¢çš„KeySetã€‚å°é¡¶å †é€šè¿‡KeySetçš„intå€¼è¿›è¡Œæ’åºã€‚æ‰€ä»¥å°é¡¶å †çš„å †é¡¶ä¸€å®šæ˜¯è®¡ç®—æ¬¡æ•°æœ€å°çš„KeySetã€‚&lt;/li&gt;
&lt;li&gt;éå†æ‰€æœ‰çš„å®ä½“åç§°ä¸ä»–ä»¬çš„ç»çº¬åº¦ä¸ªæ•°ï¼ŒæŠŠç»çº¬åº¦ä¸ªæ•°ç®—ä¸€ä¸ªå¹³æ–¹ï¼Œå½¢æˆäºŒå…ƒç»„(å®ä½“åç§°, è®¡ç®—æ¬¡æ•°)ã€‚æ¯æ¬¡ä»å°é¡¶å †å–å‡ºä¸€ä¸ªKeySetï¼Œç„¶åå°†äºŒå…ƒç»„æ’å…¥è¿™ä¸ªKeySetï¼Œä¹Ÿå°±æ˜¯å®ä½“åç§°æ’å…¥listï¼Œè®¡ç®—æ¬¡æ•°åŠ åˆ°intå€¼ä¸Šé¢ã€‚ç„¶åå†å°†è¿™ä¸ªKeySetæ’å…¥åˆ°å †é‡Œé¢ã€‚&lt;/li&gt;
&lt;li&gt;ç»“æŸåå¯ä»¥è·å¾—ä¸€ä¸ª200ä¸ªKeySetçš„å †ï¼Œæ¯ä¸ªKeySeté‡Œé¢æœ‰ä¸€ä¸ªList[str]æ˜¯å®ä½“åç§°ï¼Œè¿˜æœ‰ä¸€ä¸ªintå€¼è¡¨ç¤ºè¿™äº›å®ä½“åç§°çš„æ€»è®¡ç®—æ¬¡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;å°†ä¸Šé¢è¿™ä¸ªè®¡ç®—å¥½çš„æ•°æ®è¿›è¡Œå˜æ¢ï¼Œå½¢æˆä¸€ä¸ªmapï¼Œkeyæ˜¯å®ä½“åç§°ï¼Œå€¼æ˜¯å®ƒçš„idï¼Œidå°±æ˜¯0åˆ°199ï¼Œéšä¾¿èµ‹å€¼å°±å¯ä»¥äº†ã€‚&lt;/li&gt;
&lt;li&gt;æŠŠè¿™ä¸ªmapå¹¿æ’­åˆ°æ‰€æœ‰æœºå™¨ä¸Šï¼Œç„¶ååœ¨dataframeé‡Œé¢é€šè¿‡è¿™ä¸ªmapæ–°å¢ä¸€åˆ—partition idï¼Œç„¶åå†é€šè¿‡repartitionå¯¹è¿™ä¸€åˆ—è¿›è¡Œåˆ†åŒºå°±å¥½äº†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™æ ·å°±å¯ä»¥è®©æ¯ä¸ªåˆ†åŒºé‡Œé¢çš„è®¡ç®—é‡å¤§ä½“ç›¸è¿‘äº†ã€‚è¿™ä¸ªç®—æ³•æ˜¯ä¸€ä¸ªè´ªå¿ƒçš„ç®—æ³•ï¼Œæœ€åæ‹¿åˆ°çš„ç»“æœä¸ä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚å¦‚æœæƒ³è¦æœ€ä¼˜è§£è¿˜éœ€è¦å…¶ä»–çš„ç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé—®é¢˜å®é™…ä¸Šæ˜¯ç»™å®šä¸€ç»„æ•°å­—List[int]ï¼Œç»™å®š200ä¸ªæ¡¶ï¼Œå°†è¿™äº›æ•°å­—æ”¾å…¥è¿™200ä¸ªæ¡¶ä¹‹åï¼Œå°†æ¯ä¸ªæ¡¶é‡Œé¢çš„æ•°å­—ç›¸åŠ ï¼Œå¾—åˆ°200ä¸ªæ•°å­—ã€‚ä½¿å¾—è¿™200ä¸ªæ•°å­—çš„æ ‡å‡†å·®æœ€å°ã€‚&lt;/p&gt;</description></item><item><title>NEUTRAJ</title><link>https://davidham3.github.io/blog/p/neutraj/</link><pubDate>Tue, 24 Dec 2024 07:17:09 +0000</pubDate><guid>https://davidham3.github.io/blog/p/neutraj/</guid><description>&lt;p&gt;&lt;a class="link" href="https://ieeexplore.ieee.org/abstract/document/8731427" target="_blank" rel="noopener"
&gt;ICDE 2019ï¼šComputing Trajectory Similarity in Linear Time: A Generic Seed-Guided Neural Metric Learning Approach&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;æå‡ºçš„æ–¹æ³•å«NEUTRAJï¼Œä¸»è¦è§£å†³è½¨è¿¹ç›¸ä¼¼åº¦è®¡ç®—æ—¶çš„æ€§èƒ½é—®é¢˜ï¼Œåœ¨çº¿æ€§æ—¶é—´å†…è®¡ç®—å®Œæ¯•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯è¦ç”¨æˆ·æå‰é€‰æ‹©ä¸€ç§éå­¦ä¹ çš„åº¦é‡æ–¹å¼ï¼Œç„¶åè¿™ä¸ªæ¡†æ¶å¯ä»¥å»æ‹Ÿåˆè¿™ä¸ªåº¦é‡æ–¹å¼çš„å€¼ï¼Œå› æ­¤è¿™ä¸ªæ¡†æ¶å¯ä»¥æ”¯æŒå¾ˆå¤šåº¦é‡æ–¹å¼ï¼Œæ¯”å¦‚DTWï¼ŒFrechetç­‰ã€‚æ¨¡å‹å±‚é¢æœ‰ä¸¤ä¸ªåˆ›æ–°ï¼Œåœ¨RNNä¸Šå¢åŠ äº†å¸¦æœ‰è®°å¿†æ¨¡å—çš„attentionæœºåˆ¶ï¼›å¦å¤–æ˜¯åœ¨æŸå¤±çš„æ—¶å€™å¢åŠ äº†æ’åºä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h1 id="definition"&gt;Definition
&lt;/h1&gt;&lt;p&gt;æ–‡ç« é‡Œé¢çš„è½¨è¿¹ä½¿ç”¨$T$è¡¨ç¤ºï¼Œ$f(T_i, T_j)$ è¡¨ç¤ºç›¸ä¼¼åº¦ï¼Œè¿™ä¸ªç›¸ä¼¼åº¦å¯ä»¥ä½¿ç”¨DTWï¼ŒFrechetï¼Œå¯ä»¥ä½¿ç”¨å„ç§éå­¦ä¹ çš„åº¦é‡æ–¹å¼ã€‚ä½†æ˜¯å¾ˆå¤šè¿™æ ·çš„åº¦é‡æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦éƒ½è¾¾åˆ°äº†å¹³æ–¹çº§ï¼Œæœ¬æ–‡çš„ä¸€ä¸ªç›®æ ‡å°±æ˜¯å­¦ä¹ ä¸€ä¸ª $g(\cdot, \cdot)$ï¼Œè¿™ä¸ªå‡½æ•°çš„æ—¶é—´å¤æ‚åº¦è¦è¾¾åˆ° $O(n)$ï¼Œè®­ç»ƒæ–¹å¼å°±æ˜¯å°† $\vert f(T_i, T_j) - g(T_i, T_j) \vert$ æœ€å°åŒ–ã€‚&lt;/p&gt;
&lt;h1 id="overview"&gt;Overview
&lt;/h1&gt;&lt;p&gt;$\mathfrak{S}$ æ˜¯ä»æ‰€æœ‰è½¨è¿¹é‡Œé¢éšæœºå–å‡ºçš„ $N$ æ¡è½¨è¿¹ï¼Œè¿™æ‰¹è½¨è¿¹ç§°ä¸ºç§å­ã€‚ç„¶åé€šè¿‡ $f$ è®¡ç®—ä¸€ä¸ªçŸ©é˜µ $\mathbf{D} \in \mathbb{R}^{N \times N}$ å‡ºæ¥ï¼Œç„¶ååšä¸€ä¸ªnormalizationï¼Œå¾—åˆ° $\mathbf{S}$ã€‚å¯¹äºä»»æ„ä¸¤æ¡è½¨è¿¹ï¼ŒNEUTRAJä¼šç”Ÿæˆä¸¤ä¸ª $d$ ç»´å‘é‡ $\mathbf{E_i}, \mathbf{E_j}$ï¼Œä½¿å¾— $f(T_i, T_j) \approx g(T_i, T_j)$ã€‚&lt;/p&gt;
&lt;h2 id="é¢„å¤„ç†"&gt;é¢„å¤„ç†
&lt;/h2&gt;&lt;p&gt;å°†ç©ºé—´åˆ’åˆ†æˆç½‘æ ¼ï¼Œå°†è½¨è¿¹åºåˆ—è½¬æ¢æˆä½ç½®åºåˆ—ï¼Œä½ç½®å°±æ˜¯ç½‘æ ¼çš„idã€‚å‡è®¾ç½‘æ ¼çš„å¤§å°æ˜¯ $P \times Q$ï¼Œé‚£ä¹ˆå®šä¹‰ä¸€ä¸ªmemory tensor $\mathbf{M} \in \mathbb{R}^{P \times Q \times d}$ï¼Œè®­ç»ƒå‰å…¨éƒ½ç½®ä¸º0ã€‚è¿™ä¸ªtensorä¼šå’ŒRNNä¸€èµ·è®­ç»ƒã€‚&lt;/p&gt;
&lt;h2 id="å¸¦æœ‰è®°å¿†æ¨¡å—çš„rnn"&gt;å¸¦æœ‰è®°å¿†æ¨¡å—çš„RNN
&lt;/h2&gt;$$
(\mathbf{f_t, i_t, s_t, o_t}) = \sigma (\mathbf{W_g} \cdot X^c_t + \mathbf{U_g \cdot h_{t-1} + b_g})
$$$$
\mathbf{\tilde{c_t}} = \tanh (\mathbf{W_c} \cdot X^c_t + \mathbf{U_c \cdot h_{t-1} + b_c})
$$$$
\mathbf{\hat{c_t} = f_t \cdot c_{t-1} + i_t \cdot \tilde{c_t}}
$$$$
\mathbf{c_t} = \mathbf{\hat{c_t} + s_t} \cdot \text{read}(\mathbf{\hat{c_t}}, X^g_t, \mathbf{M})
$$$$
\text{write}(\mathbf{c_t, s_t}, X^g_t, \mathbf{M})
$$$$
\mathbf{h_t} = \mathbf{o_t} \cdot \tanh(\mathbf{c_t})
$$&lt;p&gt;where $\mathbf{W_g} \in \mathbb{R}^{4d \times 2}, \mathbf{U_g} \in \mathbb{R}^{4d \times d}, \mathbf{W_c} \in \mathbb{R}^{d \times 2}, \mathbf{U_c} \in \mathbb{R}^{d \times d}$ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ $X^c_t, X^g_t$ åˆ†åˆ«è¡¨ç¤ºè½¨è¿¹çš„ç»çº¬åº¦ç‚¹å’Œç»çº¬åº¦ç‚¹æ‰€åœ¨çš„ç½‘æ ¼ã€‚è¯»å†™æ“ä½œå°±æ˜¯å¯¹ $\mathbf{M}$ è¿›è¡Œè¯»å–å’Œå†™å…¥ã€‚&lt;/p&gt;
&lt;p&gt;è¯»æ“ä½œä½¿ç”¨ä¸¤ä¸ªè¾“å…¥ï¼Œä¸€ä¸ªæ˜¯ç½‘æ ¼è¾“å…¥ $X^g_t$ï¼Œå¦ä¸€ä¸ªæ˜¯ä¸­é—´ç»†èƒçŠ¶æ€ $\mathbf{\hat{c_t}}$ï¼Œç„¶åä¼šè¾“å‡ºä¸€ä¸ªå‘é‡ $\mathbf{c^{his}_t}$ï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥å¢å¼º $\mathbf{\hat{c_t}}$ çš„ã€‚å¤§ä½“åŸç†å°±æ˜¯é€šè¿‡å½“å‰çš„è¿™ä¸ªç½‘æ ¼ä½ç½®ï¼Œä»¥å®ƒä¸ºçŸ©å½¢ä¸­å¿ƒï¼Œå»è¯»å–å‘¨å›´ä¸€ä¸ªæ­£æ–¹å½¢åŒºåŸŸå†…è¿™äº›ç½‘æ ¼çš„memoryï¼Œç„¶åé€šè¿‡ä¸€ä¸ªæ³¨æ„åŠ›æœºåˆ¶å°†å…¶å˜æˆä¸€ä¸ª $d$ ç»´å‘é‡ã€‚å‡è®¾æ­£æ–¹å½¢åŒºåŸŸçš„è¾¹é•¿æ˜¯5ä¸ªæ ¼å­çš„é•¿åº¦ï¼Œé‚£ä¹ˆå°±ä¼šæ‰«æä¸€ä¸ª $5 \times 5$ çš„åŒºåŸŸï¼Œè·å¾—è¿™äº›memoryã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åŠ›æœºåˆ¶çš„è®¡ç®—å…¬å¼ï¼š&lt;/p&gt;
$$
\mathbf{A} = \text{softmax}(\mathbf{G_t \cdot \hat{c_t}})
$$$$
\mathbf{mix = G^T_t \cdot A}
$$$$
\mathbf{c^{cat}_t = [\hat{c_t}, mix]}
$$$$
\mathbf{c_{t}^{his}} = \tanh ( \mathbf{W_{his} \cdot c_{t}^{his} + b_{his}})
$$&lt;p&gt;è¿™é‡Œçš„ $G_t \in \mathbb{R}^{(2w + 1)^2 \times d}$ã€‚&lt;/p&gt;
&lt;p&gt;å†™å…¥æ“ä½œï¼š&lt;/p&gt;
$$
\mathbf{M}(X_g)_{new} = \sigma(\mathbf{s_t}) \cdot \mathbf{c_t} + (1 - \sigma(\mathbf{s_t})) \cdot \mathbf{M}(X_g)\_{old}
$$&lt;h2 id="metric-learning-procedures"&gt;Metric Learning Procedures
&lt;/h2&gt;&lt;p&gt;RNNæœ€åçš„éšè—çŠ¶æ€ä½œä¸ºè½¨è¿¹è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;ä½œè€…è¯´ç›´æ¥å»æ‹Ÿåˆ $\mathbf{S}$ ä¼šè¿‡æ‹Ÿåˆï¼Œæ‰€ä»¥è¦ç»™MSEåŠ æƒã€‚å…·ä½“åšæ³•æ˜¯ä»ç§å­é‡Œé¢é€‰å‡ºä¸€ä¸ªanchorè½¨è¿¹ï¼Œç„¶åçœ‹è¿™æ¡è½¨è¿¹åœ¨ $\mathbf{S}$ é‡Œé¢çš„å“ªä¸€è¡Œï¼Œå–å‡ºè¿™ä¸€è¡Œ $\mathbf{I_a}$ï¼Œç„¶åè¿›è¡Œé‡‡æ ·ã€‚é¦–å…ˆç”¨è¿™ä¸ªå‘é‡çš„æƒé‡é‡‡æ ·æ­£æ ·æœ¬ $n$ ä¸ªï¼Œç„¶åç”¨ $1 - \mathbf{I_a}$ é‡‡ $n$ ä¸ªè´Ÿæ ·æœ¬ã€‚ç„¶åç»™ä»–ä»¬æŒ‰ç›¸ä¼¼å’Œä¸ç›¸ä¼¼åˆ†åˆ«æ’å¥½åºï¼Œç»™ä»–ä»¬èµ‹äºˆæƒé‡ï¼Œæƒé‡æ˜¯ $\mathbf{r} = (1, 1/2, \dots, 1/l, \dots, 1/n)$ï¼Œç„¶åå†é™¤ä»¥ $\sum^n_{l=1} r_l$ è¿›è¡Œå½’ä¸€åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå®šä¹‰æ­£æ ·æœ¬æŸå¤±å‡½æ•°ä¸º&lt;/p&gt;
$$
L^s_a = \sum^n_{l=1} r_l \cdot (g(T_a, T^s_l)- f(T_a, T^s_l))^2
$$&lt;p&gt;è´Ÿæ ·æœ¬æŸå¤±ï¼š&lt;/p&gt;
$$
L^d_a = \sum^n_{l=1} r_l \cdot [\text{ReLU}(g(T_a, T^d_l) - f(T_a, T^d_l))]^2
$$&lt;p&gt;æˆ‘è§‰å¾—ä¸ç›¸ä¼¼æ ·æœ¬çš„æŸå¤±å‡½æ•°è®¾è®¡çš„ä¸å¯¹ï¼Œå¦‚æœ $f$ æ˜¯DTWè¿™ç±»ç®—æ³•ï¼ŒDTWå€¼è¶Šå°è¯´æ˜ä¸¤æ¡è½¨è¿¹è¶Šç›¸ä¼¼ã€‚é‚£ä¹ˆå¦‚æœ $g &amp;gt; f$ï¼Œé‚£å°±è¯´æ˜æ¨¡å‹è®¤ä¸ºä¸¤æ¡è½¨è¿¹çš„è·ç¦»æ¯”çœŸå®è·ç¦»å¤§ã€‚å½“å‰è¿™äº›æ ·æœ¬æœ¬èº«å°±æ˜¯ä¸ç›¸ä¼¼çš„ï¼Œæ‰€ä»¥ $f$ åº”è¯¥ä¼šéå¸¸å¤§ï¼Œè€Œå¦‚æœ $g &amp;gt; f$ ï¼Œè¯´æ˜æ¨¡å‹è®¤ä¸ºä»–ä»¬æ›´ä¸ç›¸ä¼¼ï¼Œæ­¤æ—¶æ˜¯åˆç†çš„ï¼Œå¦‚æœ $g &amp;lt; f$ï¼Œè¯´æ˜æ¨¡å‹è®¤ä¸ºè¿™äº›æ ·æœ¬æ˜¯ç›¸ä¼¼çš„ï¼Œæ­¤æ—¶åº”è¯¥ä¼˜åŒ–ã€‚å› æ­¤å¦‚æœ $ g &amp;lt; f$ï¼Œå³ $ g - f &amp;lt; 0$ï¼Œé‚£ä¹ˆæ­¤æ—¶åº”è¯¥è®©æ¨¡å‹å»ä¼˜åŒ–å‚æ•°ï¼Œå¦‚æœ $g - f &amp;gt; 0$ï¼Œå°±ä¸ç”¨ä¼˜åŒ–äº†ï¼Œå› æ­¤è¿™é‡Œçš„æŸå¤±å‡½æ•°é‡Œé¢ç¼ºå°‘äº†ä¸€ä¸ªè´Ÿå·ã€‚é€šè¿‡é˜…è¯»æºç ï¼Œå‘ç°ä½œè€…ä½¿ç”¨æ˜¯ $ f - g $ï¼Œå› æ­¤è¿™é‡Œå¯ä»¥è®¤ä¸ºæ˜¯è®ºæ–‡æ’°å†™é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæŠŠä¸¤ä¸ªæŸå¤±ç›¸åŠ ï¼Œå¾—åˆ°æœ€ç»ˆçš„loss&lt;/p&gt;
$$
L_{\mathfrak{S}} = \sum_{a \in [1, \dots, N]} (L^s_a + L^d_a)
$$&lt;h1 id="experiments"&gt;Experiments
&lt;/h1&gt;&lt;p&gt;å®éªŒæ˜¯åœ¨Geolifeå’ŒPortoä¸Šé¢åšçš„ã€‚åšäº†ä¸€ä¸ªtop-kæœç´¢ï¼Œè¿˜åšäº†ä¸€ä¸ªèšç±»ã€‚&lt;/p&gt;</description></item><item><title>Hugo Quick Start</title><link>https://davidham3.github.io/blog/p/hugo-quick-start/</link><pubDate>Tue, 24 Dec 2024 06:00:29 +0000</pubDate><guid>https://davidham3.github.io/blog/p/hugo-quick-start/</guid><description>&lt;p&gt;æœ¬æ–‡è®²ä¸€ä¸‹å¦‚ä½•å¿«é€Ÿå¯åŠ¨ä¸€ä¸ªHugoåšå®¢ã€‚æˆ‘ä¹‹å‰çš„åšå®¢æ˜¯éƒ¨ç½²åœ¨hexoä¸Šçš„ï¼Œè€Œä¸”å·²ç»å¾ˆä¹…ç”¨å†™è¿‡äº†ï¼Œç°åœ¨è¦é‡å¯ï¼Œç”±äºhexoçš„ç¯å¢ƒéƒ¨ç½²ä¾èµ–nodeï¼Œæƒ³æ¢ä¸€å¥—æ›´å¥½ç”¨çš„ç³»ç»Ÿï¼ŒClaudeæ¨èæˆ‘ä½¿ç”¨Hugoã€‚&lt;/p&gt;
&lt;p&gt;Hugoç°åœ¨å‡ºåˆ°0.140.1ç‰ˆæœ¬äº†ï¼Œå› æ­¤æœ¬æ–‡æ˜¯æŒ‰ç…§è¿™ä¸ªç‰ˆæœ¬ç¼–å†™çš„ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆæ„å»ºä¸€ä¸ªdockeré•œåƒï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-dockerfile" data-lang="dockerfile"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c"&gt;# ä½¿ç”¨å®˜æ–¹ Go é•œåƒä½œä¸ºåŸºç¡€é•œåƒ&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;golang:latest&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c"&gt;# å®‰è£… Git&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;RUN&lt;/span&gt; apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install -y &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; git &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; rm -rf /var/lib/apt/lists/*&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c"&gt;# å®‰è£… Dart Sass&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;RUN&lt;/span&gt; curl -fsSL https://github.com/sass/dart-sass/releases/download/1.83.0/dart-sass-1.83.0-linux-x64.tar.gz &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; tar -xz -C /usr/local/bin/ --strip-components&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; chmod +x /usr/local/bin/sass&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c"&gt;# å®‰è£… Hugo&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;RUN&lt;/span&gt; curl -L https://github.com/gohugoio/hugo/releases/download/v0.140.1/hugo_0.140.1_linux-amd64.tar.gz &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; tar -xz -C /usr/local/bin/ hugo &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; chmod +x /usr/local/bin/hugo&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c"&gt;# è®¾ç½®å·¥ä½œç›®å½•&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;WORKDIR&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;/app&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c"&gt;# éªŒè¯å®‰è£…&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;RUN&lt;/span&gt; go version &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; git --version &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sass --version &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; hugo version&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c"&gt;# è®¾ç½®å®¹å™¨å¯åŠ¨æ—¶çš„é»˜è®¤å‘½ä»¤&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;CMD&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;bash&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="err"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ„å»ºé•œåƒï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;docker build -t hugo:0.140.1 .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ„å»ºå®Œæˆåé€šè¿‡ä¸‹é¢çš„å‘½ä»¤å¯åŠ¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;docker run -ti --rm --user &lt;span class="k"&gt;$(&lt;/span&gt;id -u&lt;span class="k"&gt;)&lt;/span&gt;:&lt;span class="k"&gt;$(&lt;/span&gt;id -g&lt;span class="k"&gt;)&lt;/span&gt; -v &lt;span class="nv"&gt;$PWD&lt;/span&gt;:/app -p 1314:1314 hugo:0.140.1 bash
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åˆ›å»ºä¸€ä¸ªæ–°çš„ç«™ç‚¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;span class="lnt"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# åˆ›å»ºä¸€ä¸ªæ–°çš„ç«™ç‚¹å«blogï¼Œé…ç½®æ–‡ä»¶ä½¿ç”¨yamlï¼ˆå¦åˆ™ä¼šç”¨tomlï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;hugo new site blog --format&lt;span class="o"&gt;=&lt;/span&gt;yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; blog
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git init
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# è¿™é‡Œå®‰è£…hextraè¿™ä¸ªä¸»é¢˜&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git submodule add https://github.com/imfing/hextra.git themes/hextra
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶åå»blog/hugo.yamlé‡Œé¢æ–°å¢&lt;code&gt;theme: hextra&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;hugo server --bind 0.0.0.0 --port &lt;span class="m"&gt;1314&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;é€šè¿‡ä¸Šè¿°å‘½ä»¤å¯åŠ¨serverï¼Œç„¶åå°±å¯ä»¥ç›´æ¥æ‰“å¼€æµè§ˆå™¨è®¿é—®&lt;code&gt;localhost:1314&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œæˆ‘ç¼–å†™äº†ä¸€ä¸ªpythonè„šæœ¬ç”¨æ¥å°†hexoçš„åšå®¢è¿ç§»åˆ°hugoä¸Šé¢ï¼Œå‘½åä½&lt;code&gt;scripts/migrate.py&lt;/code&gt;ï¼Œç›´æ¥ä½¿ç”¨&lt;code&gt;uv run scripts/migrate.py&lt;/code&gt;è¿è¡Œå³å¯ã€‚&lt;/p&gt;</description></item><item><title>DeepTEA: Effective and Efficient Online Time-dependent Trajectory Outlier Detection</title><link>https://davidham3.github.io/blog/p/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/</link><pubDate>Fri, 09 Sep 2022 14:24:04 +0000</pubDate><guid>https://davidham3.github.io/blog/p/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/</guid><description>&lt;p&gt;PVLDB 2022. &lt;a class="link" href="https://www.vldb.org/pvldb/vol15/p1493-han.pdf" target="_blank" rel="noopener"
&gt;DeepTEA: Effective and Efficient Online Time-dependent Trajectory Outlier&lt;br&gt;
Detection&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;ç ”ç©¶å¼‚å¸¸è½¨è¿¹æ£€æµ‹ï¼Œç›®çš„æ˜¯æå–é“è·¯ä¸­è½¦è¾†çš„å¼‚å¸¸ç§»åŠ¨ã€‚å¯ä»¥å¸®åŠ©ç†è§£äº¤é€šè¡Œä¸ºï¼Œè¯†åˆ«å‡ºç§Ÿè½¦æ¬ºè¯ˆã€‚ç”±äºäº¤é€šçŠ¶å†µåœ¨ä¸åŒæ—¶é—´ä¸åŒåœ°ç‚¹ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥è¿™ä¸ªé—®é¢˜å…·æœ‰æŒ‘æˆ˜ã€‚æœ¬æ–‡æå‡ºäº†Deep-probabilistic-based time-dependent anomaly detection algorithm (DeepTEA)ã€‚ä½¿ç”¨æ·±åº¦å­¦ä¹ æ–¹æ³•ä»å¤§é‡è½¨è¿¹é‡Œé¢è·å¾—time-dependent outlinersï¼Œå¯ä»¥å¤„ç†å¤æ‚çš„äº¤é€šçŠ¶å†µï¼Œå¹¶ç²¾ç¡®åœ°æ£€æµ‹å¼‚å¸¸ç°è±¡ã€‚æœ¬æ–‡è¿˜æå‡ºäº†ä¸€ä¸ªå¿«é€Ÿçš„è¿‘ä¼¼æ–¹æ³•ï¼Œä¸ºäº†åœ¨å®æ—¶ç¯å¢ƒä¸‹æ•è·åˆ°å¼‚å¸¸è¡Œä¸ºã€‚ç›¸æ¯”SOTAæ–¹æ³•ï¼Œæœ¬æ–‡æ–¹æ³•æå‡äº†17.52%ï¼Œå¹¶ä¸”å¯ä»¥å¤„ç†ç™¾ä¸‡è®¡çš„è½¨è¿¹æ•°æ®ã€‚&lt;/p&gt;
&lt;h1 id="2-problem-definition"&gt;2. Problem Definition
&lt;/h1&gt;&lt;p&gt;Definition 1(Trajectory). è½¨è¿¹ç‚¹$p_{t_i}$æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„$(t_i, x, y)$ï¼Œåˆ†åˆ«æ˜¯æ—¶é—´æˆ³ã€çº¬åº¦ã€ç»åº¦ã€‚è½¨è¿¹$T$æ˜¯ä¸€ä¸ªè½¨è¿¹ç‚¹çš„æœ‰åºåºåˆ—ï¼Œå…¶ä¸­$t_1 &amp;lt; \dots &amp;lt; t_i &amp;lt; \dots &amp;lt; t_n$ã€‚&lt;/p&gt;
&lt;p&gt;è½¨è¿¹å¼‚å¸¸æ£€æµ‹åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯åªè€ƒè™‘ä¸æ­£å¸¸è·¯çº¿ä¸åŒçš„å¼‚å¸¸è½¨è¿¹ã€‚å¦ä¸€ç§æ˜¯è€ƒè™‘ä¸time-dependentçš„æ­£å¸¸è·¯çº¿ä¸åŒçš„å¼‚å¸¸è½¨è¿¹ã€‚&lt;/p&gt;
&lt;p&gt;Definition 2(Time-dependent Trajectory Outlier)ã€‚ç»™ä¸€æ¡è½¨è¿¹$T$ï¼Œèµ·ç‚¹$S_T$ï¼Œç»ˆç‚¹æ˜¯$D_T$ï¼Œè¿˜æœ‰travelæ—¶é—´ï¼Œä¸€ä¸ªtime-dependentè½¨è¿¹å¼‚å¸¸å®šä¹‰ä¸ºï¼šç›¸åŒçš„$S_T$å’Œ$D_T$ä»¥åŠç›¸åŒçš„å‡ºå‘ã€åˆ°è¾¾æ—¶é—´ä¸‹çš„è½¨è¿¹é‡Œé¢ï¼Œä¸€ä¸ªå¾ˆç¨€æœ‰çš„ã€ä¸åŒäºå…¶ä»–è½¨è¿¹çš„è½¨è¿¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Fig1.jpg"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸¾ä¾‹ï¼Œå¦‚æœä¸€ä¸ªè½¨è¿¹åœ¨2016å¹´10æœˆ1æ—¥çš„ä¸Šåˆ10ç‚¹å‡ºå‘ï¼Œ11ç‚¹åˆ°è¾¾ï¼Œé‚£ä¹ˆä¸€æ¡ç¨€æœ‰çš„è½¨è¿¹ä¸”å’Œç›¸åŒæ—¶é—´ç›¸åŒODçš„è½¨è¿¹ä¸åŒçš„è½¨è¿¹å°±æ˜¯è¿™ä¸ªTime-dependent Trajectory Outlier.&lt;/p&gt;
&lt;p&gt;Problem 1(Online Time-dependent Trajectory Outlier Detection)ã€‚ç»™å®šä¸€æ¡æ­£åœ¨å‰è¿›çš„è½¨è¿¹$T$ï¼Œå®æ—¶è®¡ç®—å¹¶æ›´æ–°è¿™æ¡è½¨è¿¹æ˜¯æ—¶é—´ä¾èµ–çš„å¼‚å¸¸è½¨è¿¹çš„æ¦‚ç‡ã€‚&lt;/p&gt;
&lt;h1 id="3-the-deeptea-model"&gt;3. The DeepTEA Model
&lt;/h1&gt;&lt;h2 id="31-framework"&gt;3.1 Framework
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Fig2.jpg"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®šè½¨è¿¹$T$ï¼Œåœ¨æ—…è¡Œè¿‡ç¨‹ä¸­æ¨ç®—latent traffic pattern $q(z \mid T)$ã€‚è½¨è¿¹è§‚æµ‹å€¼ $\tau$ åæ˜ æ—¶é—´ä¾èµ–çš„è½¨è¿¹è½¬ç§»ï¼Œå¯ä»¥åœ¨ inference network é‡Œé¢ç”¨æ¥å»ºæ¨¡latent time-dependent route $r$ã€‚ä¹‹åï¼Œtime-dependent route $r$ç”¨æ¥ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼$\tau$ã€‚&lt;/p&gt;
&lt;h2 id="32-latent-traffic-pattern-inference"&gt;3.2 Latent Traffic Pattern Inference
&lt;/h2&gt;&lt;p&gt;latent traffic pattern $z$ï¼Œè¡¨ç¤ºæ—…é€”è¿‡ç¨‹ä¸­çš„åŠ¨æ€äº¤é€šçŠ¶å†µï¼Œæ¯”å¦‚ ${\text{smooth} \rightarrow \text{congested} \rightarrow \text{smooth} }$ï¼Œæˆ–è€…${\text{congested} \rightarrow \text{smooth} }$ã€‚&lt;/p&gt;
&lt;h3 id="321-challenges"&gt;3.2.1 Challenges
&lt;/h3&gt;&lt;p&gt;ç»™å®šè½¨è¿¹ $T$ï¼Œæˆ‘ä»¬æƒ³åŸºäº $T$ çš„ç©ºé—´è½¬ç§»ï¼Œæ¨ç®—å‡º latent traffic pattern $q(z \mid T)$ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªè¿œè·ç¦»çš„ç§»åŠ¨è¡¨æ˜å½“æ—¶çš„äº¤é€šçŠ¶å†µæ˜¯é€šç•…çš„ã€‚ä½†æ˜¯ä¸€ä¸ªè½¨è¿¹ $T$ å¯èƒ½è¡¨ç¤ºä¸€äº›éšæœºè¡Œä¸ºï¼Œæ¯”å¦‚åœè½¦ä¼‘æ¯ï¼Œè¿™ç§è¡Œä¸ºä¸èƒ½è¡¨æ˜å½“æ—¶çš„äº¤é€šçŠ¶å†µã€‚è¿™æ˜¯åœ¨è¡¨ç¤ºå®é™…äº¤é€šæ¨¡å¼æ—¶çš„ç¬¬ä¸€ä¸ªæŒ‘æˆ˜ã€‚ç¬¬äºŒä¸ªæŒ‘æˆ˜æ˜¯äº¤é€šçŠ¶æ€åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œä¸åŒçš„æ—¶é—´æ˜¯ä¸åŒçš„ï¼ŒåŠ¨æ€çš„ã€‚åŒä¸€æ—¶é—´ï¼Œä¸åŒODä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚è€Œä¸”åœ¨æ•´ä¸ªæ—…é€”ä¸­çš„äº¤é€šçŠ¶æ€å˜åŒ–ä¹Ÿæ˜¯å‰§çƒˆçš„ã€‚å¯èƒ½å¼€å§‹çš„æ—¶å€™é¡ºç•…ï¼Œç»“æŸçš„æ—¶å€™æ‹¥å µã€‚æ•è·äº¤é€šçŠ¶æ€å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå¯¹æ—¶é—´ä¾èµ–çš„æ­£å¸¸è·¯å¾„å½±å“å¾ˆå¤§ã€‚&lt;/p&gt;
&lt;h3 id="322-design"&gt;3.2.2 Design
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†è§£å†³ç¬¬ä¸€ä¸ªæŒ‘æˆ˜ï¼Œæˆ‘ä»¬ä»æ—¶é—´ $t_i$ çš„ä¸€ç»„è½¨è¿¹ ${ T_{t_i} }$ é‡Œé¢å­¦ä¹ latent traffic pattern $z$ï¼Œè€Œä¸æ˜¯å•æ¡è½¨è¿¹ $T$ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨ time point series è¡¨ç¤ºæ—…è¡Œæ—¶é—´ã€‚ä¸ºäº†ä» ${ T_{t_i} }$ é‡Œé¢å¾ˆå¥½åœ°ç»„ç»‡äº¤é€šä¿¡æ¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª map grid matrix $Z_{t_i}$ï¼Œè¿™é‡Œé¢æ¯ä¸ªå•å…ƒè¡¨ç¤ºå¹³å‡é€Ÿåº¦ï¼Œç”¨è¿™ä¸ªå¯¹ $t_i$ çš„äº¤é€šçŠ¶æ€å»ºæ¨¡ã€‚ä»å›¾2å¯ä»¥çœ‹å‡ºï¼Œçº¢è‰²è¡¨ç¤ºé€Ÿåº¦ä½ï¼Œè¡¨ç¤ºæ‹¥å µã€‚ç»¿è‰²è¡¨ç¤ºç•…é€šã€‚é»„è‰²è¡¨ç¤ºå³å°†æ‹¥å µï¼Œå¹³å‡é€Ÿåº¦ä»‹äºçº¢ç»¿ä¹‹é—´ã€‚ä¸ºäº†è§£å†³åŒä¸€æ—¶é—´ä¸åŒä½ç½®äº¤é€šçŠ¶æ€çš„å¤šæ ·æ€§ï¼Œæˆ‘ä»¬ç”¨CNNå»ºæ¨¡ã€‚å¯¹äºæ²¡æœ‰è½¦è¾†çš„åŒºåŸŸï¼ŒCNNå¯ä»¥ä»æœ‰è½¦è¾†çš„å•å…ƒå­¦åˆ°ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å°†ä»–ä»¬è¡¨ç¤ºä¸ºç¼ºå¤±å€¼ã€‚å› ä¸ºå®æ—¶çŠ¶æ€ä¸‹äº¤é€šçŠ¶å†µå˜å¾—å¾ˆé¢‘ç¹ï¼Œæˆ‘ä»¬ç”¨RNNæ•è·è¿™ç§ä¸æ–­å˜åŒ–çš„åŠ¨æ€æ€§ï¼Œè§£å†³ç¬¬äºŒä¸ªæŒ‘æˆ˜ã€‚äº¤é€šçŠ¶æ€çš„å˜åŒ–å¯ä»¥é€šè¿‡RNNå¾ˆå¥½çš„å»ºæ¨¡ã€‚ç„¶åæˆ‘ä»¬ç”¨ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒå’ŒRNNçš„éšè—çŠ¶æ€ï¼Œæ¨ç®— latent traffic pattern $z$ã€‚CNN+RNNé€‰ç”¨äº† Convolutional LSTMã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç”¨ä¸Šé¢çš„éšæ—¶é—´å˜åŒ–çš„åŠ¨æ€äº¤é€šçŠ¶æ€æ¥æ¨ç®—latent traffic pattern $z$ã€‚è¿™é‡Œçš„æƒ³æ³•æ˜¯äº¤é€šçŠ¶æ€ä¼šå› ä¸ºå¤æ‚çš„å®æ—¶ç‰¹å¾å‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚ä¿¡å·ç¯ã€äº‹æ•…ã€æ—©æ™šé«˜å³°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨DeepTEAé‡Œé¢ä¼šéšæ—¶é—´å˜åŒ–æ›´æ–°$Z$ï¼Œè¡¨ç¤ºä¸º$Z_{t_i}$ï¼Œè¡¨ç¤ºè½¨è¿¹ç‚¹$p_{t_i}$åœ¨æ—¶é—´$t_i$çš„äº¤é€šçŠ¶æ€ã€‚æˆ‘ä»¬ä¼šä»å®é™…äº¤é€šçŠ¶å†µ$Z = { Z_{t_i}, Z_{t_{i+1}}, \dots, Z_{t_{i+n}} }$é‡Œé¢æ¨ç®—latent traffic pattern $z$ã€‚è¿™é‡Œé¢çš„äº¤é€šçŠ¶å†µå¯¹åº”çš„æ—¶é—´åˆ†åˆ«æ˜¯å¯¹åº”è½¨è¿¹ç‚¹${ p_t, p_{t+1}, \dots, p_{t_{i+n}} }$çš„æ—¶é—´ã€‚å¯¹äºçœŸå®äº¤é€šçŠ¶å†µ$Z$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è½¨è¿¹$T$ç»è¿‡çš„æ—¶é—´çš„å¹³å‡é€Ÿåº¦ã€‚æ¢å¥è¯è¯´å°±æ˜¯ï¼ŒçœŸå®äº¤é€šçŠ¶å†µ$Z_{t_i}$æ˜¯ä¸€ä¸ªå¹³å‡é€Ÿåº¦çŸ©é˜µï¼Œå®ƒåŒ…å«äº†æ•´ä¸ªåŸå¸‚åœ¨$t_i$çš„ç§»åŠ¨çŠ¶æ€ã€‚å¦‚æœä¸¤ä¸ªè½¨è¿¹ç‚¹ä¹‹é—´çš„æ—¶é—´å·®å¾ˆå°ï¼Œé‚£ä¹ˆ$Z_{t_i}$å’Œ$Z_{t_{i+1}}$å¯èƒ½ä¼šå¾ˆç›¸ä¼¼ã€‚è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦æŠŠé€Ÿåº¦æŒ‰æ—¶æ®µæå‰èšåˆèµ·æ¥ï¼Œå°±å–å¹³å‡é€Ÿåº¦ï¼Œæ¯”å¦‚10åˆ†é’Ÿçš„æ—¶æ®µï¼Œè€Œä¸å†ä½¿ç”¨æ—¶é—´ç‚¹ã€‚ä¸ºäº†å‡è½»ç¨€ç–çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨CNNå°†æœ‰è½¦è¾†çš„ä½ç½®çš„ä¿¡æ¯ä¼ æ’­åˆ°æ²¡æœ‰è½¦è¾†æ²¡æ•°æ®çš„ä½ç½®ä¸Šã€‚ä¸ºäº†æ•è·ä¸åŒæ—¶æ®µçš„åŠ¨æ€å˜åŒ–ï¼Œæˆ‘ä»¬ç”¨RNNå»ºæ¨¡æ—¶é—´ç»´åº¦çš„äº¤é€šè½¬ç§»ã€‚è¿™æ ·ï¼Œspatial traffic correlationå’Œtemporal transitioné€šè¿‡$f_1(Z)$æ¥æ•è·ï¼š&lt;/p&gt;
$$
\tag{1} f\_1(Z) = \text{RNN}(\text{CNN}(Z)),
$$&lt;p&gt;è¿™é‡Œå‡½æ•°$f_1(\cdot)$æ˜¯ä¸€ä¸ªCNN+RNNï¼ŒCNNå¯¹æ¯ä¸ª$Z_i$éƒ½ä½¿ç”¨ï¼Œç„¶åç”¨RNNå¯¹ä»–ä»¬å»ºæ¨¡ï¼Œæ•è·traffic transitionã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©æ¨¡å‹å…·æœ‰ç”Ÿæˆèƒ½åŠ›ï¼Œå¹¶ä¸”å¯¹äº¤é€šçŠ¶æ€çš„ä¸ç¡®å®šæ€§å»ºæ¨¡ï¼Œåœ¨ç»™å®šå®é™…äº¤é€šçŠ¶æ€$Z$çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç”¨é«˜æ–¯åˆ†å¸ƒå¯¹latent traffic pattern $z$å»ºæ¨¡ï¼Œå¯ä»¥ç”¨æ¥åœ¨ç»™å®šè½¨è¿¹$T$æ—¶è¿‘ä¼¼latent traffic pattern $z$çš„åˆ†å¸ƒï¼Œå¦‚å…¬å¼2æ‰€ç¤ºã€‚æˆ‘ä»¬å°†å‚æ•°è®°ä¸º$\phi$ï¼Œ&lt;/p&gt;
$$
\tag{2} q\_\phi(z \mid T) \coloneqq q\_\phi(z \mid Z) = \mathcal{N}(\mu\_Z, \text{diag}(\sigma^2\_Z)),
$$&lt;p&gt;å‡å€¼$\mu_Z$å’Œæ ‡å‡†å·®$\sigma_Z$é€šè¿‡MLPå‡½æ•° $g_1(f_1(Z))$å¾—åˆ°ï¼Œå‚æ•°æ˜¯$\phi = { f_1(\cdot), g_1(\cdot) }$ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§æ–¹å¼åœ¨ç»™å®šè½¨è¿¹$T$çš„æ—¶å€™å¯ä»¥å¾ˆå¥½çš„æ¨æ–­å‡ºlatent traffic pattern $z$ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œå‚æ•°$\phi$å¯ä»¥å­¦åˆ°å¦‚ä½•æ•è·latent traffic pattern $z$ï¼Œè€Œä¸”èƒ½è¡¨ç¤ºäº¤é€šçŠ¶æ€çš„å¤šæ ·æ€§å’ŒåŠ¨æ€æ€§ã€‚&lt;/p&gt;
&lt;h2 id="33-latent-time-dependent-route-inference"&gt;3.3 Latent Time-dependent Route Inference
&lt;/h2&gt;&lt;h3 id="331-challenges"&gt;3.3.1 Challenges
&lt;/h3&gt;&lt;p&gt;è½¨è¿¹$T$ä¸ä»…å¯ä»¥è¡¨ç¤ºä½ç½®ä¿¡æ¯ï¼Œè¿˜å¯ä»¥è¡¨ç¤ºä¸¤ä¸ªè½¨è¿¹ç‚¹ä¹‹é—´è½¬ç§»çš„latent traffic pattern $z$ã€‚ç›¸æ¯”åªæœ€å¤§åŒ–ä½ç½®ä¿¡æ¯çš„ä¼¼ç„¶ï¼Œå¯¹ä½ç½®å’Œlatent traffic pattern $z$åŒæ—¶åšæ›´informativeï¼Œå› ä¸ºå®ƒå¯ä»¥åæ˜ åœ¨æ—¶é—´ä¾èµ–çš„äº¤é€šçŠ¶æ€ä¸‹çš„è½¨è¿¹è½¬ç§»ã€‚&lt;/p&gt;
&lt;h3 id="332-design"&gt;3.3.2 Design
&lt;/h3&gt;&lt;p&gt;ä¸€æ¡è½¨è¿¹ $T$ ä¸ä»…èƒ½åæ˜ ä½ç½® $p_{t_i}$ï¼Œè¿˜èƒ½åŸºäºä¸¤ä¸ªè¿ç»­è½¨è¿¹ç‚¹ $p_{t_{i-1}}$ å’Œ $p_{t_i}$ ä¹‹é—´çš„è½¬ç§»ï¼Œä¼ é€’å‡º latent traffic pattern $z$ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨ $o(p_{t_i}, z)$ è¡¨ç¤ºè½¨è¿¹ $T$ èƒŒåçš„è§‚æµ‹å€¼ $\tau_i$ã€‚è¿™é‡Œå¸Œæœ›ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œå¤„ç†è§‚æµ‹å€¼ $p_{t_i}$ å’Œ $z$ï¼š&lt;/p&gt;
$$
\tag{3} \tau\_i = o(p\_{t\_i}, z) = f\_2(p\_{t\_i}, z) = \text{NN}(p\_{t\_i}, z),
$$&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œå­¦ä¹  latent traffic pattern $z$ çš„è§‚æµ‹å€¼ $p_{t_i}$ï¼š&lt;/p&gt;
$$
\tag{4} \text{NN}(p\_{t\_i}, z) = W p\_{t\_i} + Q z,
$$&lt;p&gt;$\text{NN}$çš„å‚æ•°æ˜¯$W$å’Œ$Q$ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬å­¦ä¹ ä¸€æ¡è½¨è¿¹ $T$ ç»è¿‡çš„ latent time-dependent route $r$ã€‚æˆ‘ä»¬è§£é‡Šè¿‡ï¼Œè½¨è¿¹ $T$ ä¸ä»…èƒ½è¡¨ç¤ºè½¨è¿¹ç‚¹ $p_{t_i}$ çš„ä½ç½®ä¿¡æ¯ï¼Œè¿˜èƒ½æŒ‡æ˜ä¸¤ä¸ªè½¨è¿¹ç‚¹ä¹‹é—´è½¬ç§»çš„ latent traffic pattern $z$ã€‚latent time-dependent route $r$ çš„å«ä¹‰å¯ä»¥è§£é‡Šä¸ºï¼šé«˜å³°æ—¶é—´æ®µåŸå¸‚è·¯æ®µçš„äº¤é€šçŠ¶æ€æ˜¯æ‹¥å µçš„ï¼Œé©¾é©¶å‘˜é€šå¸¸ä¼šä¸Šé«˜é€Ÿï¼Œå› ä¸ºé‚£é‡Œä¼šç•…é€šã€‚&lt;/p&gt;
&lt;p&gt;è½¨è¿¹ $T$ ç»è¿‡çš„ latent time-dependent route $r$ çš„è¡¨ç¤ºä¸ºï¼š&lt;/p&gt;
$$
\tag{5} r\_T \sim q\_\gamma (r \mid T),
$$&lt;p&gt;$\gamma$ æ˜¯æ¨æµ‹ latent time-dependent route $r$ æ—¶çš„å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;åŸºäºä¹‹å‰çš„è½¨è¿¹ç‚¹å’Œ latent traffic pattern $z$ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨RNNè·å¾—è½¨è¿¹è§‚æµ‹å€¼ä¹‹é—´çš„è½¬ç§»ï¼ŒRNNè®°ä¸º $f_3$ï¼Œè¿™é‡Œä½¿ç”¨GRUï¼š&lt;/p&gt;
$$
\tag{6} h\_i = f\_3 (h\_{i-1}, \tau\_i),
$$&lt;p&gt;$h_{i-1}$ æ˜¯ä¹‹å‰è§‚æµ‹å€¼ $\tau_{i-1}$ çš„éšè—çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è½¨è¿¹ç‚¹ $p_{t_{i-1}}$ å¸¦ç€ latent traffic pattern $z$ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè½¨è¿¹è§‚æµ‹å€¼çš„ä¸ç¡®å®šæ€§ï¼Œæˆ‘ä»¬é€šè¿‡é«˜æ–¯åˆ†å¸ƒå»ºæ¨¡ $q_\gamma (r \mid T)$ï¼š&lt;/p&gt;
$$
\tag{7} q\_\gamma (r \mid T) = \mathcal{N} (\mu\_T, \text{diag}(\sigma^2\_T)),
$$&lt;p&gt;æˆ‘ä»¬ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œ $g_3(h_n)$ æ¥å­¦ä¹ å‡å€¼å’Œæ ‡å‡†å·®ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†åœ¨ latent traffic pattern é‡Œé¢åŒºåˆ†æ­£å¸¸çš„è½¨è¿¹è½¬ç§»å’Œå¼‚å¸¸çš„è½¨è¿¹è½¬ç§»ï¼Œéœ€è¦è®¾è®¡ä¸€ä¸ªæ¨¡å—å¯¹è½¨è¿¹é‡Œ latent time-dependent normal routeå»ºæ¨¡ï¼Œè¿™é‡Œ $z$ ä¼šæä¾› time-dependent traffic ä¿¡æ¯ã€‚ä½¿ç”¨é«˜æ–¯åˆ†å¸ƒï¼š&lt;/p&gt;
$$
\tag{8} p\_\gamma (r \mid k, z) = \mathcal{N}(\mu\_r, \text{diag}(\sigma^2\_r)),
$$&lt;p&gt;$k$ è¡¨ç¤º latent time-dependent route çš„ç±»å‹ï¼Œæœä»å¤šé¡¹å¼åˆ†å¸ƒï¼š&lt;/p&gt;
$$
\tag{9} p\_\gamma (k) = \text{Mult} (\pi),
$$&lt;p&gt;$\pi$ æ˜¯å¤šé¡¹å¼åˆ†å¸ƒçš„å‚æ•°ã€‚ç„¶åï¼Œè¶‹è¿‘ $q_\gamma (r \mid T)$ çš„å‡å€¼çš„ latent time-dependent route æ˜¯time-dependent normal routeã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œæ¨æ–­ç½‘ç»œå¯ä»¥ä»ç»™å®šçš„è½¨è¿¹ $T$ é‡Œé¢æ¨ç®— latent time-dependent route $r$ï¼Œlatent time-dependent route type $k$ï¼Œè¿˜æœ‰ latent traffic pattern $z$ ä¸º $q_{\gamma,\phi}(r, k, z \mid T)$ã€‚é€šè¿‡ä½¿ç”¨ mean-field approximationï¼Œå¯ä»¥åˆ†è§£ä¸ºï¼š&lt;/p&gt;
$$
\tag{10} q\_{\gamma,\phi}(r, k, z \mid T) = q\_\gamma(r \mid T) \ q\_\phi(z \mid T) \ q\_\gamma (k \mid T),
$$&lt;p&gt;$q_\gamma (k \mid T)$ å¯ä»¥è½¬æ¢ä¸ºåœ¨ç»™å®š è½¨è¿¹ $T$ ç»è¿‡ latent time-dependent route $r$ çš„æ¡ä»¶ä¸‹ï¼Œroute type $k$ çš„åˆ†å¸ƒï¼š&lt;/p&gt;
$$
\tag{11} q\_\gamma (k \mid T) \coloneqq p\_\gamma (k \mid r\_T) = \frac{p\_\gamma (k) p\_\gamma (r\_T \mid k)}{\sum^K\_{i=1} p\_\gamma (k\_i) p\_\gamma (r\_T \mid k\_i)},
$$&lt;p&gt;$K$ æ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼Œè¡¨ç¤º route ç±»å‹çš„ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œæ¨æ–­ç½‘ç»œå¯ä»¥ä»è½¨è¿¹ $T$ çš„è§‚æµ‹å€¼ $o(p_{t_i}, z)$ æ¨æ–­å‡º latent time-dependent route $r$ã€‚$\gamma = { f_2(\cdot), f_3(\cdot), g_3(\cdot), \pi, \mu_r, \sigma_r }$ è¿™äº›éƒ½æ˜¯å‚æ•°ã€‚&lt;/p&gt;
&lt;h2 id="34-trajectory-observation-generation"&gt;3.4 Trajectory Observation Generation
&lt;/h2&gt;&lt;p&gt;ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼çš„ç›®æ ‡æ˜¯ç»™å®š latent time-dependent route $r$ï¼Œtime-dependent route type $k$ å’Œ latent traffic pattern $z$ æ—¶ï¼Œæœ€å¤§åŒ–ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ çš„æ¦‚ç‡ï¼Œä¹Ÿå°±æ˜¯ $o(p_{t_i}, z)$ã€‚è¿™ä¸ªæ¦‚ç‡è®°ä¸º $p_\theta (T \mid r, z, k)$ï¼Œ$\theta$ è¡¨ç¤ºç”¨äºç”Ÿæˆè¿‡ç¨‹çš„å‚æ•°ã€‚ä»å¯¹ç§°çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬ç”¨RNNæ¥ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ï¼Œä¹Ÿå°±æ˜¯ $o(p_{t_i}, z)$ï¼š&lt;/p&gt;
$$
\tag{12} \begin{align} \eta\_i &amp;= f\_4 (\tau\_i, \eta\_{i-1}) \\ &amp;= f\_4(o(p\_{t\_i}, z), \eta\_{i-1}) \\ &amp;= \text{RNN} (o(p\_{t\_i}, z), \eta\_{i-1}), i = 1, 2, \dots, n, \ and \ \eta\_o = r, \end{align}
$$&lt;p&gt;RNNçš„èµ·å§‹è¾“å…¥æ˜¯ $\eta_0$ã€‚ä» $\eta_1$ å¼€å§‹ï¼Œè¾“å…¥å˜æˆä¸Šä¸€ä¸ªéšè—çŠ¶æ€ $\eta_{i-1}$ å’Œè½¨è¿¹è§‚æµ‹å€¼ $o(p_{t_i}, z)$ã€‚å› æ­¤ï¼Œè§‚æµ‹å€¼ $\tau_i$ï¼Œä¹Ÿå°±æ˜¯ $p_{t_i}$ åœ¨ latent traffic pattern $z$ çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å…¬å¼ç”Ÿæˆï¼š&lt;/p&gt;
$$
\tag{13} \begin{align} \tau\_i &amp;= o(p\_{t\_i}, z) \sim p\_\theta (o(p\_{t\_i}, z) \mid o(p\_{1:i-1}, z), r) \\ &amp;= p\_\theta(\tau \mid \eta\_{i-1}) \\ &amp;= \text{Mult}(\text{softmax}(g\_4 (\eta\_{i-1}))), \end{align}
$$&lt;p&gt;$g_4(\cdot)$æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠè¾“å‡ºæ˜ å°„åˆ°ç½‘æ ¼çš„ä¸ªæ•°ã€‚softmax ç”¨æ¥æŠŠæ¦‚ç‡çš„å’Œå˜æˆ1ã€‚ç„¶åè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ å¯ä»¥é€šè¿‡å¤šé¡¹å¼åˆ†å¸ƒç”Ÿæˆã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ï¼Œä¹Ÿå°±æ˜¯ $o(p_{t_i}, z)$ï¼Œå¯ä»¥åŸºäº latent time-dependent route $r$ï¼Œroute type $k$ å’Œ latent traffic pattern $z$ ç”Ÿæˆã€‚æˆ‘ä»¬ç»™ç”Ÿæˆç”¨çš„å‚æ•°è®°ä¸º $\theta = { f_4(\cdot), g_4(\cdot) }$ã€‚è¿™äº›å‚æ•°ä¼šåœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­å­¦åˆ°ã€‚&lt;/p&gt;
&lt;h2 id="35-optimization"&gt;3.5 Optimization
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ä¸Šé¢è®²äº†ï¼Œè½¨è¿¹è§‚æµ‹å€¼ä¸ä»…èƒ½åæ˜ ä½ç½®ä¿¡æ¯ï¼Œè¿˜èƒ½åŸºäºä¸¤ä¸ªè¿ç»­çš„è½¨è¿¹ç‚¹çš„è½¬ç§»ä¼ é€’å‡º latent traffic patternã€‚å› æ­¤ï¼Œç›®æ ‡å‡½æ•°æ˜¯æœ€å¤§åŒ–è§‚æµ‹åˆ°çš„è½¨è¿¹çš„è¾¹ç¼˜å¯¹æ•°ä¼¼ç„¶ï¼š&lt;/p&gt;
$$
\tag{14} \log p\_\theta(T^{(1)}, T^{(2)}, \dots, T^{(N)}) \coloneqq \log p\_\theta (\tau^{(1)}, \tau^{(2)}, \dots, \tau^{(N)}).
$$&lt;p&gt;æˆ‘ä»¬é€šè¿‡æœ€å¤§åŒ–ELBOæ¥ä¼˜åŒ–ä¸Šé¢çš„è¾¹ç¼˜å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š&lt;/p&gt;
$$
\tag{15} \log p\_\theta (T) \geq \text{ELBO} = \mathcal{L}(\phi, \gamma, \theta; T).
$$&lt;p&gt;è½¨è¿¹ $T$ çš„è¾¹ç¼˜å¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„ ELBO é€šè¿‡ä¸‹é¢çš„å…¬å¼è®¡ç®—ï¼š&lt;/p&gt;
$$
\tag{16} \begin{align} \mathcal{L}(\phi, \gamma, \theta; T) &amp;= \mathbb{E}\_{q\_{\gamma, \phi}(r, k, z \mid T)}[ \log \frac{p\_{\phi, \gamma, \theta}(r, k, z, T)}{q\_{\gamma, \theta}(r, k, z \mid T)}] \\ &amp;= - \mathbb{E}\_{q\_\gamma(r \mid T)} D\_{KL} (q\_\gamma (k \mid T) \Vert p\_\gamma (k)) \\ &amp; - \mathbb{E}\_{q\_\gamma (k \mid T)} D\_{KL} ( q\_\gamma (r \mid T) \Vert p\_\gamma (r \mid k, z)) \\ &amp; - D\_{KL} (q\_\phi (z \mid T) \Vert p\_\phi(z)) + \mathbb{E}\_{q\_{\gamma, \phi}(r, k, z \mid T)} \log p\_\theta (T \mid r, z, k), \end{align}
$$&lt;p&gt;å…¶ä¸­ï¼Œ$p_\theta(z)$ æ˜¯ latent traffic pattern $z$ çš„å…ˆéªŒæ¦‚ç‡ã€‚ç”Ÿæˆç½‘ç»œ $\log p_\theta(T \mid r, z, k)$ å¯ä»¥é€šè¿‡ä¸‹é¢å…¬å¼è®¡ç®—ï¼š&lt;/p&gt;
$$
\tag{17} \log p\_\theta (T \mid r, z, k) = \sum^n\_{i=1} \log p\_\theta (\tau\_i \mid \tau\_{1: i-1}, r, z, k)
$$&lt;p&gt;æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹çš„ç®—æ³•å¦‚ç®—æ³•1æ‰€ç¤ºã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹å‚æ•°é€šè¿‡ä¼˜åŒ–è½¨è¿¹ $T$ çš„ ELBO æ¥å­¦ä¹ ã€‚ç„¶åè¿™äº›å­¦åˆ°çš„å‚æ•°ä¼šç”¨äº online anomaly detectionï¼Œåé¢ä¼šä»‹ç»ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Algo1.jpg"
loading="lazy"
alt="Algo1"
&gt;&lt;/p&gt;
&lt;h2 id="36-complexity-analysis"&gt;3.6 Complexity Analysis
&lt;/h2&gt;&lt;p&gt;è®­ç»ƒ DeepTEA çš„å¤æ‚åº¦æ˜¯ $O(N \cdot (d_{Z_1} d_{Z_2} \bar{V} + \bar{n}))$ï¼Œ$N$ æ˜¯è½¨è¿¹æ•°ï¼Œ$d_{Z_1}$ å’Œ $d_{Z_2}$ æ˜¯ $Z$ çš„å¤§å°ï¼Œ$\bar{V}$ æ˜¯æ—¶é—´é—´éš”çš„å¹³å‡ä¸ªæ•°ï¼Œ$\bar{n}$ æ˜¯è½¨è¿¹çš„å¹³å‡é•¿åº¦ã€‚&lt;/p&gt;
&lt;h1 id="online-trajectory-outlier-detection-by-deeptea"&gt;Online Trajectory Outlier Detection by DeepTEA
&lt;/h1&gt;&lt;p&gt;åŸºäºç®—æ³•1å­¦ä¹ å¾—åˆ°çš„å‚æ•°ï¼Œå½“ä¸‹ä¸€ä¸ªè½¨è¿¹è§‚æµ‹å€¼ $\tau_{i+1}$ å®æ—¶è¿‡æ¥çš„æ—¶å€™ï¼Œå¼‚å¸¸åˆ†æ•°ä¼šå®æ—¶æ›´æ–°ã€‚è¿™ä¸ªè¿‡ç¨‹è¦å¿«ã€‚è€Œä¸”ç›´åˆ°è½¨è¿¹å®Œæˆï¼Œè¿™ä¸ªå¼‚å¸¸åˆ†æ•°éƒ½è¦æ›´æ–°ã€‚&lt;/p&gt;
&lt;h2 id="41-online-detection-by-generation"&gt;4.1 Online Detection by Generation
&lt;/h2&gt;&lt;p&gt;å›¾3å±•ç¤ºäº†åœ¨çº¿å¼‚å¸¸è½¨è¿¹æ£€æµ‹çš„æ­¥éª¤ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Fig3.jpg"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬é€šè¿‡å­¦åˆ°çš„ç½‘ç»œç”Ÿæˆè§‚æµ‹åˆ°çš„è½¨è¿¹æ¥æ£€æµ‹å¼‚å¸¸ã€‚latent time-dependent route çš„åˆ†å¸ƒ $q_\gamma (r \mid T)$ å¯ä»¥é€šè¿‡å‚æ•° $\gamma$ æ¥è®¡ç®—ã€‚latent traffic pattern $z$ å¯ä»¥é€šè¿‡å‚æ•° $\phi$ å’Œ $Z$ è·å¾—ã€‚ç»™å®š $q_\gamma (r \mid T)$ é‡Œé¢ç¬¬ $k$ ä¸ªå‡å€¼ $u_k$ï¼Œæˆ‘ä»¬ç”¨ RNN ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼ï¼š&lt;/p&gt;
$$
\tag{18} \eta\_i = f\_4(\tau\_i, \eta\_{i-1}) = \text{RNN} (\tau\_i, \eta\_{i - 1}), i = 1, 2, \dots, n, \text{and} \ \eta\_0 = u\_k,
$$&lt;p&gt;RNNçš„èµ·å§‹è¾“å…¥æ˜¯ $\eta_0$ï¼Œè¿™é‡Œè®¾ç½®ä¸º $u_k$ã€‚ä» $\eta_1$ å¼€å§‹ï¼Œè¾“å…¥æ ‡ç§°éšè—çŠ¶æ€ $\eta_{i-1}$ å’Œè½¨è¿¹è§‚æµ‹å€¼ $\tau_i$ï¼Œå³ $o(p_{t_i}, z)$ã€‚å› æ­¤ $\tau_{i+1}$ å¯ä»¥ç”¨ä¸‹é¢çš„å…¬å¼ç”Ÿæˆï¼š&lt;/p&gt;
$$
\tag{19} p\_\theta (\tau\_{i+1} \mid \tau\_{i:i}, u\_k) = \text{softmax}(g\_4 (\eta\_{i-1})),
$$&lt;p&gt;$g_4(\cdot)$ æ˜¯ç”¨æ¥æŠŠè¾“å‡ºæ˜ å°„åˆ°ç½‘æ ¼æ•°çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®šå­¦åˆ°çš„ $q_\gamma (r \mid T)$ å’Œ latent traffic pattern $z$ï¼Œè½¨è¿¹ $T$ çš„å®æ—¶å¼‚å¸¸åˆ†æ•° $s_a(\tau_{i:i})$ å¯ä»¥è®¡ç®—ä¸º 1 - ç”Ÿæˆè½¨è¿¹è§‚æµ‹å€¼ $\tau_{i:i}$ çš„ä¼¼ç„¶ï¼Œå³ ${ \tau_1 \rightarrow \tau_2 \rightarrow \dots \tau_i }$ï¼š&lt;/p&gt;
$$
\tag{20} s\_a(\tau\_{i:i}) = 1 - \arg \max\_k \exp [\frac{\sum^n\_{i=1} \log p\_\theta (\tau\_i \mid \tau\_{1:i-1}, u\_k)}{n}]
$$&lt;p&gt;åœ¨çº¿ä¸Šåœºæ™¯ä¸‹ï¼Œç»™å®šä¹‹å‰çš„è½¨è¿¹è§‚æµ‹å€¼ $\tau_{i:i}$ï¼Œä¸‹ä¸€ä¸ªè½¨è¿¹è§‚æµ‹å€¼çš„å¼‚å¸¸åˆ†æ•°å¯ä»¥é€šè¿‡ä¹‹å‰è¿™ä¸ªæ•°æ¥è®¡ç®—ï¼š&lt;/p&gt;
$$
\tag{21} s\_a(\tau\_{i:i+1}) = 1 - \arg \max\_k \exp [\frac{\log p\_\theta (\tau\_{1:i} \mid u\_k) p\_\theta(\tau\_{i+1} \mid \tau\_{1:i}, u\_k)}{i + 1}]
$$&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deeptea-effective-and-efficient-online-time-dependent-trajectory-outlier-detection/Algo2.jpg"
loading="lazy"
alt="Algo2"
&gt;&lt;/p&gt;
&lt;p&gt;ç®—æ³•2æ˜¯åœ¨çº¿æ£€æµ‹çš„è¿‡ç¨‹ã€‚è¾“å…¥æ˜¯è½¨è¿¹ $T$ï¼Œå‚æ•°æ˜¯ä»ç®—æ³•1å­¦åˆ°çš„ã€‚å¯¹äºæ–°æ¥çš„è½¨è¿¹è§‚æµ‹å€¼ $\tau_{i+1}$ï¼Œå¦‚æœ latent traffic pattern $z$ å˜äº†ï¼Œé‚£æˆ‘ä»¬å°±æ›´æ–° $z$ã€‚ç„¶ååŸºäº $\tau_{1:i}$ è®¡ç®— $\tau_{1:i+1}$ã€‚æœ€åè¿”å›å¼‚å¸¸åˆ†æ•°ã€‚&lt;/p&gt;
&lt;h2 id="42-complexity-analysis"&gt;4.2 Complexity Analysis
&lt;/h2&gt;&lt;p&gt;æ•´ä¸ªæ£€æµ‹çš„å¤æ‚åº¦æ˜¯ $\mathcal{O}(d_{Z_1} d_{Z_2})$ï¼Œ$d_{Z_1}$ å’Œ $d_{Z_2}$ æ˜¯ $Z$ çš„å¤§å°ã€‚&lt;/p&gt;
&lt;h1 id="5-the-deeptea-a-model-approximate-online-detection"&gt;5 The DeepTEA-A Model: Approximate Online Detection
&lt;/h1&gt;&lt;h2 id="51-approximation-algorithm"&gt;5.1 Approximation Algorithm
&lt;/h2&gt;&lt;h3 id="511-challenge"&gt;5.1.1 Challenge
&lt;/h3&gt;&lt;p&gt;åŸºäº $\tau_{1:i}$ çš„å¼‚å¸¸åˆ†æ•°æ›´æ–°ä¾èµ– $t_{i+1}$ çš„äº¤é€šçŠ¶æ€çŸ©é˜µ $Z$ï¼Œå¦‚æœè·¯ç½‘å¾ˆå¤§ï¼Œè¿™é‡Œè€—æ—¶ä¼šé•¿ã€‚&lt;/p&gt;
&lt;h3 id="512-design"&gt;5.1.2 Design
&lt;/h3&gt;&lt;p&gt;å— GM-VSAE çš„å¯å‘ï¼Œæœ¬æ–‡æå‡ºäº†è¿‘ä¼¼ç®—æ³•ã€‚ä½¿ç”¨ $\tau_1$ çš„æ—¶æ®µçš„äº¤é€šçŠ¶æ€çŸ©é˜µ $Z$ ä½œä¸ºæ•´ä¸ª trip è¿‡ç¨‹çš„äº¤é€šçŠ¶å†µçš„è¿‘ä¼¼ã€‚è¿™æ ·ï¼Œ$Z$ åªè¦åœ¨ç¬¬ä¸€ä¸ªè½¨è¿¹è§‚æµ‹å€¼ $\tau_1$ çš„æ—¶å€™ç®—ä¸€ä¸‹å°±å¥½äº†ã€‚online æ›´æ–°çš„æ—¶å€™å°±ä¸éœ€è¦å†ç®—è¿™ä¸ªäº†ã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªèµ·ç‚¹ $S_T$ å’Œç»ˆç‚¹ $D_T$ï¼Œä» $q(k \mid S_T, D_T, z_{S_T})$ è¿™é‡Œé¢å–å‡ºæœ€ä¼˜çš„ latent route type $k$ æ¥è¿‘ä¼¼æœ€æœ‰ latent route pattern $u_k$ï¼Œè¿™éœ€è¦ä» $q_\gamma (r \mid T)$ çš„ $k$ ä¸ªå‡å€¼é‡Œé¢æ‰¾ï¼Œ$Z_{S_T}$ æ˜¯ trip å¼€å§‹æ—¶çš„äº¤é€šçŠ¶å†µã€‚è¿™æ ·ï¼Œæœ€ä¼˜çš„ latent route type $k$ åœ¨ trip ä¸€å¼€å§‹çš„æ—¶å€™å°±èƒ½æ‹¿åˆ°ã€‚ä»ç¬¬äºŒä¸ªè½¨è¿¹è§‚æµ‹å€¼å¼€å§‹ï¼Œè¿™ä¸ª $k$ å°±ä¸éœ€è¦å†ç®—äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºèµ·ç‚¹ $S_T$ï¼Œäº¤é€šçŠ¶å†µ $Z_{S_T}$ çš„éšè—çŠ¶æ€å¯ä»¥é€šè¿‡ä¸‹é¢å…¬å¼è®¡ç®—ï¼š&lt;/p&gt;
$$
\tag{22} f\_1(Z\_{S\_T}) = \text{CNN} (Z\_{S\_T}),
$$&lt;p&gt;ç„¶å $z_{S_T}$ å¯ä»¥ä» $q_\phi (z_{S_T} \mid Z_{S_T})$ é‡Œé¢é‡‡æ ·å¾—åˆ°ï¼š&lt;/p&gt;
$$
\tag{23} q\_\phi (z\_{S\_T} \mid Z\_{S\_T}) = \mathcal{N}(\mu\_{Z\_{S\_T}}, diag(\sigma^2\_{Z\_{S\_T}})),
$$&lt;p&gt;ç„¶åï¼Œ$\tau_{S_T}$ å¯ä»¥é€šè¿‡ $f_2(\cdot)$ å¾—åˆ°ï¼š&lt;/p&gt;
$$
\tag{24} \tau\_{S\_T} = f\_2(S\_T, z\_{S\_T}) = \text{NN}(S\_T, z\_{S\_T}) = W S\_T + Q z\_{S\_T},
$$&lt;p&gt;åŒç†ï¼Œ$\tau_{D_T}$ æŒ‰åŒæ ·çš„æ–¹å¼è®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶å $q(k \mid S_T, D_T, z_{S_T})$ é€šè¿‡ MLP è®¡ç®—ï¼š&lt;/p&gt;
$$
\tag{25} q(k \mid S\_T, D\_T, z\_{S\_T}) = \text{softmax}(f\_t(\tau\_{S\_T}, \tau\_{D\_T})),
$$&lt;p&gt;$f_5$ å°±æ˜¯ MLPã€‚å‚æ•°è®°ä¸º $\delta = { f_5 (\cdot) }$ã€‚&lt;/p&gt;
&lt;p&gt;å…¬å¼20é‡Œé¢ï¼Œä¸ºäº†è·å¾—æœ€ä¼˜çš„ $k$ï¼Œéœ€è¦è·‘ $k$ æ¬¡ã€‚ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯é€šè¿‡ $q_\gamma (k \mid T)$ ä»è½¨è¿¹ $T$ é‡Œé¢æ‰¾åˆ°æœ€ä¼˜çš„ $k$ã€‚å› æ­¤ $q(k \mid S_T, D_T, z_{S_T})$ å’Œ $q_\gamma (k \mid T)$ è¦å°½å¯èƒ½çš„ç›¸è¿‘ã€‚æˆ‘ä»¬ç”¨äº¤å‰ç†µæœ€å°åŒ–ä¸¤ä¸ªåˆ†å¸ƒçš„å·®åˆ«ï¼š&lt;/p&gt;
$$
\tag{26} l\_k = - \sum^K\_{k=1} q\_\gamma (k \mid T) \log q(k \mid S\_T, D\_T, z\_{S\_T}),
$$&lt;p&gt;è¿™ä¸ªäº¤å‰ç†µ $l_k$ ä¼šå’Œå…¬å¼ 16 çš„ELBOåŒæ—¶è®­ç»ƒã€‚ç„¶ååœ¨çº¿æ£€æµ‹é˜¶æ®µçš„æ—¶å€™ï¼Œæœ€ä¼˜çš„ $k$ æ˜¯ $q(k \mid S_T, D_T, z_{S_T})$ é‡Œé¢æœ€é«˜æ¦‚ç‡çš„é‚£ä¸ªã€‚ç„¶åç›´æ¥å°±èƒ½æ‹¿åˆ°æœ€ä¼˜ latent time-dependent route $u_k$ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿‘ä¼¼ç®—æ³•çš„è®­ç»ƒè¿‡ç¨‹å’Œç®—æ³•1ä¸ä¸€æ ·ã€‚é¦–å…ˆï¼Œäº¤é€šçŠ¶å†µçš„ä½¿ç”¨ä¸ä¸€æ ·ï¼Œè¿‘ä¼¼ç®—æ³•åªç”¨äº† $Z_{S_T}$ã€‚ç¬¬äºŒï¼Œå…¬å¼26ï¼Œæ˜¯ä¸€ä¸ª co-training è¿‡ç¨‹ï¼Œä¸ºäº†è¿‘ä¼¼ä¸¤ä¸ªåˆ†å¸ƒã€‚è®­ç»ƒåå¾—åˆ°æ¨¡å‹å‚æ•° $\phi, \gamma, \theta, \delta$ã€‚æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹å¦‚ç®—æ³•3æ‰€ç¤ºã€‚å…ˆä» $Z_{S_T}$ é‡Œé¢è·å¾— $z_{S_T}$ã€‚ç„¶åè·å¾—æœ€ä¼˜çš„ latent time-dependent route $u_k$ï¼Œè¿™ä¸ªæ•°åªè¦åœ¨è½¨è¿¹å¼€å§‹çš„æ—¶å€™ç®—ä¸€ä¸‹å°±å¥½äº†ã€‚ç„¶ååŸºäº $p_\theta(\tau_{1:i} \mid u_k)$ æ›´æ–°å¼‚å¸¸åˆ†æ•°å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;h2 id="52-complexity-analysis"&gt;5.2 Complexity Analysis
&lt;/h2&gt;&lt;p&gt;åœ¨çº¿æ£€æµ‹çš„å¤æ‚åº¦ $\mathcal{O}(d_{h_t}(d_{h_t} + d_{\tau_i}))$ã€‚è¿™é¡¹æ˜¯æ–°çš„è½¨è¿¹è§‚æµ‹å€¼ $\tau_{i+1}$ åˆ°æ¥çš„æ—¶å€™ RNN çš„å˜æ¢è¿‡ç¨‹çš„å¤æ‚åº¦ã€‚å› ä¸º $d_{h_t}, d_{\tau_i}$ æ˜¯å¸¸æ•°ï¼Œæ‰€ä»¥è¿‘ä¼¼ç®—æ³•çš„å¤æ‚åº¦æ˜¯ $\mathcal{O}(1)$&lt;/p&gt;</description></item><item><title>Modeling The Intensity Function Of Point Process Via Recurrent Neural Networks</title><link>https://davidham3.github.io/blog/p/modeling-the-intensity-function-of-point-process-via-recurrent-neural-networks/</link><pubDate>Wed, 25 May 2022 15:01:51 +0000</pubDate><guid>https://davidham3.github.io/blog/p/modeling-the-intensity-function-of-point-process-via-recurrent-neural-networks/</guid><description>&lt;p&gt;AAAI 2017, Intensity RNN: &lt;a class="link" href="https://arxiv.org/pdf/1705.08982.pdf" target="_blank" rel="noopener"
&gt;Modeling The Intensity Function Of Point Process Via Recurrent Neural Networks&lt;/a&gt;ã€‚ç›¸æ¯”RMTPPï¼Œç”¨LSTMã€‚ç„¶åæ¨¡å‹åŠ äº†ä¸€ä¸ªæ—¶é—´åºåˆ—æ¨¡å—ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ”¯æŒæœ‰æ—¶é—´åºåˆ—ä¿¡æ¯çš„æ•°æ®é›†ã€‚ç„¶åè®¡ç®—äº‹ä»¶å‘ç”Ÿæ—¶é—´çš„æŸå¤±æ—¶ï¼Œç”¨äº†ä¸€ä¸ªé«˜æ–¯æ ¸å‡½æ•°ã€‚æœ¬è´¨ä¸Šè¿˜æ˜¯MSEï¼Œæ²¡å•¥åŒºåˆ«ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 Introduction
&lt;/h1&gt;&lt;p&gt;${z_i, t_i }^N_{i=1}$è¡¨ç¤ºäº‹ä»¶æ•°æ®ã€‚äº‹ä»¶åºåˆ—çš„æ—¶é—´é—´éš”ä¸åƒæ—¶é—´åºåˆ—é‚£æ ·ç›¸ç­‰ã€‚ç‚¹è¿‡ç¨‹æ˜¯ç ”ç©¶äº‹ä»¶åºåˆ—çš„é‡è¦æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘ä¸€äº›æœºå™¨å­¦ä¹ æ–¹æ³•åœ¨æ•°å­¦å…¬å¼å’Œä¼˜åŒ–æŠ€æœ¯ä¸Šåšäº†ä¸€äº›å·§å¦™çš„ä¿®æ”¹ï¼Œè¿˜æœ‰ä¸€äº›æ–°çš„æ¡ä»¶å¼ºåº¦å‡½æ•°å»ºæ¨¡æ–¹æ³•ï¼Œä¸»è¦æ˜¯ç”¨ä¸€äº›æ•°æ®é›†ä¸Šçš„å…ˆéªŒçŸ¥è¯†æ¥åˆ»ç”»æ•°æ®çš„æ€§è´¨ã€‚ç‚¹è¿‡ç¨‹çš„ä¸»è¦ç¼ºç‚¹æ˜¯è¡¨è¾¾èƒ½åŠ›å—é™ï¼Œæ¨¡å‹å¤ªå¼±äº†ï¼Œéš¾ä»¥æ•è·å¤æ‚çš„æ•°æ®ã€‚è€Œä¸”å¦‚æœæ¨¡å‹é€‰é”™äº†çš„è¯ï¼Œæ•ˆæœä¼šå¾ˆå·®ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å°†ç‚¹è¿‡ç¨‹çš„æ¡ä»¶å¼ºåº¦çœ‹ä½œæ˜¯æ¨¡å‹çš„è¾“å…¥ä¿¡æ¯åˆ°äº‹ä»¶å‘ç”Ÿå¼ºåº¦ä¹‹é—´çš„éçº¿æ€§æ˜ å°„ã€‚è¾“å…¥iè¥¿å—è¥¿åŒ…å«äº‹ä»¶çš„ç±»å‹ã€äº‹ä»¶ä¿¡æ¯ã€ç³»ç»Ÿå†å²ã€‚è¿™æ ·çš„éçº¿æ€§æ˜ å°„ç›®æ ‡æ˜¯è¶³å¤Ÿå¤æ‚ä¸”è¶³å¤Ÿçµæ´»ï¼Œå¯ä»¥å¯¹äº‹ä»¶æ•°æ®çš„ç‰¹æ€§å»ºæ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ç”¨RNNç¼–ç è¿™ç§éçº¿æ€§å…³ç³»ï¼Œåœ¨ä¸ç”¨å…ˆéªŒçŸ¥è¯†çš„æƒ…å†µä¸‹ä»¥ç«¯åˆ°ç«¯çš„å½¢å¼å»ºæ¨¡éçº¿æ€§å¼ºåº¦æ˜ å°„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/modeling-the-intensity-function-of-point-process-via-recurrent-neural-networks/Fig1.jpg"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;h1 id="3-network-structure-and-end-to-end-learning"&gt;3 Network Structure and End-to-End Learning
&lt;/h1&gt;&lt;p&gt;RNNçš„è¾“å…¥åºåˆ—${\mathbf{x}}^T_{t=1}$ï¼Œéšè—çŠ¶æ€${\mathbf{h}}^T_{t=1}$ã€‚æœ¬æ–‡ç”¨LSTMã€‚&lt;/p&gt;
$$
\begin{align} \mathbf{i}\_t &amp;= \sigma(\mathbf{W}\_i \mathbf{x}\_t + \mathbf{U}\_i \mathbf{h}\_{t-1} + \mathbf{V}\_i \mathbf{c}\_{t-1} + \mathbf{b}\_i),\\ \mathbf{f}\_t &amp;= \sigma(\mathbf{W}\_f \mathbf{x}\_t + \mathbf{U}\_f \mathbf{h}\_{t-1} + \mathbf{V}\_f \mathbf{c}\_{t-1} + \mathbf{b}\_f),\\ \mathbf{c}\_t &amp;= \mathbf{f}\_t \mathbf{c}\_{t-1} + \mathbf{i}\_t \odot \text{tanh}(\mathbf{W}\_c \mathbf{x}\_t + \mathbf{U}\_c \mathbf{h}\_{t-1} + \mathbf{b}\_c),\\ \mathbf{o}\_t &amp;= \sigma(\mathbf{W}\_o \mathbf{x}\_t + \mathbf{U}\_o \mathbf{h}\_{t-1} + \mathbf{V}\_o \mathbf{c}\_t + \mathbf{b}\_o),\\ \mathbf{h}\_t &amp;= \mathbf{o}\_t \odot \text{tanh}(\mathbf{c}\_t) \end{align}
$$&lt;p&gt;$\odot$è¡¨ç¤ºelement-wise multiplicationï¼Œ$\sigma$æ˜¯sigmoidã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šè¿°LSTMå¯ä»¥å†™ä¸ºï¼š&lt;/p&gt;
$$
(\mathbf{h}\_t, \mathbf{c}\_t) = \text{LSTM}(\mathbf{x}\_t, \mathbf{h}\_{t-1} + \mathbf{c}\_{t-1})
$$&lt;p&gt;è€ƒè™‘ä¸¤ç±»è¾“å…¥ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¿ç»­ç­‰é—´éš”åˆ†å¸ƒçš„æ—¶é—´åºåˆ—&lt;/li&gt;
&lt;li&gt;é—´éš”éšæœºçš„äº‹ä»¶æ•°æ®&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç½‘ç»œç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€ä¸ªRNNå»ºæ¨¡æ—¶é—´åºåˆ—${y_t}^T_{t=1}$ï¼Œæ•è·äº‹ä»¶å‘ç”Ÿçš„background intensityï¼Œå¦ä¸€ä¸ªå»ºæ¨¡äº‹ä»¶åºåˆ—${z_i, t_i}^N_{i=1}$ï¼Œæ•è·long-rangeäº‹ä»¶çš„ä¾èµ–å…³ç³»ã€‚å› æ­¤ï¼š&lt;/p&gt;
$$
\begin{align} (\mathbf{h}^y\_t, \mathbf{c}^y\_t) &amp;= \text{LSTM}\_y(\mathbf{y}\_t, \mathbf{h}^y\_{t-1} + \mathbf{c}^y\_{t-1}),\\ (\mathbf{h}^z\_t, \mathbf{c}^z\_t) &amp;= \text{LSTM}\_z(\mathbf{z}\_t, \mathbf{h}^z\_{t-1} + \mathbf{c}^z\_{t-1}),\\ \mathbf{e}\_t &amp;= \text{tanh}(\mathbf{W}\_f [\mathbf{h}^y\_t, \mathbf{h}^z\_t] + \mathbf{b}\_f),\\ \mathbf{U}\_t &amp;= \text{softMax}(\mathbf{W}\_U \mathbf{e}\_t + \mathbf{b}\_U),\\ \mathbf{u}\_t &amp;= \text{softMax}(\mathbf{W}\_u[\mathbf{e}\_t, \mathbf{U}\_t] + \mathbf{b}\_u),\\ s\_t &amp;= \mathbf{W}\_s \mathbf{e}\_t + b\_s,\\ \end{align}
$$&lt;p&gt;$U$å’Œ$u$åˆ†åˆ«è¡¨ç¤ºäº‹ä»¶çš„ä¸»è¦ç±»å‹å’Œå­ç±»ï¼Œ$s$è¡¨ç¤ºäº‹ä»¶çš„æ—¶é—´æˆ³ï¼ŒæŸå¤±å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$
\sum^N\_{j=1}(- W^j\_U \log(U^j\_t) - w^j\_u \log(u^j\_t) - \log(f(s^j\_t \mid h^j\_{t-1})))
$$&lt;p&gt;$N$æ˜¯æ ·æœ¬æ•°ï¼Œ$j$æ˜¯æ ·æœ¬çš„indexï¼Œ$s^j_t$æ˜¯ä¸‹ä¸€ä¸ªäº‹ä»¶çš„æ—¶é—´æˆ³ï¼Œ$h^j_{t-1}$æ˜¯å†å²ä¿¡æ¯ã€‚ç¬¬ä¸‰é¡¹çš„å«ä¹‰æ˜¯ï¼Œæˆ‘ä»¬ä¸ä»…è¦é¢„æµ‹å¯¹ä¸‹ä¸€ä¸ªäº‹ä»¶çš„ç±»å‹ï¼Œä¹Ÿè¦è®©ä¸‹ä¸€ä¸ªäº‹ä»¶çš„é¢„æµ‹å‘ç”Ÿæ—¶é—´å°½å¯èƒ½å‡†ç¡®ã€‚è¿™é‡Œç”¨ä¸€ä¸ªé«˜æ–¯æƒ©ç½šå‡½æ•°ï¼Œ$\sigma^2 = 10$ï¼š&lt;/p&gt;
$$
f(s^j\_t \mid h^j\_{t-1}) = \frac{1}{\sqrt{2 \pi \sigma}} \exp(\frac{-(s^j\_t - \tilde{s}^j\_t)^2}{2\sigma^2})
$$&lt;p&gt;æ—¶é—´æˆ³é¢„æµ‹å±‚çš„è¾“å‡º$\tilde{s}^j_t$è®¡ç®—æŸå¤±çš„æ—¶å€™ï¼Œè¦è®¡ç®—ä¸Šé¢çš„æƒ©ç½šã€‚&lt;/p&gt;
&lt;p&gt;$W, w$åˆ†åˆ«æ˜¯ä¸»ç±»å’Œå­ç±»çš„æƒé‡ï¼Œç”¨æ¥å¹³è¡¡æ ·æœ¬ã€‚è¿™é‡Œè¯´ï¼Œå¦‚æœä¸»ç±»å’Œå­ç±»çš„é¢„æµ‹æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œé‚£ä¹ˆå°±æŠŠè¿™ä¸¤ä¸ªæ•°è®¾ä¸º0ã€‚è¿™é‡Œæ˜æ˜¾ä¸å¯¹å§ï¼Œè®¾ä¸º0äº†æŸå¤±ä¸ä¹…åªå‰©ä¸‹äº‹ä»¶å‘ç”Ÿæ—¶é—´äº†å—ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨RMSpropä¼˜åŒ–ã€‚&lt;/p&gt;</description></item><item><title>MULTIBENCH: Multiscale Benchmarks for Multimodal Representation Learning</title><link>https://davidham3.github.io/blog/p/multibench-multiscale-benchmarks-for-multimodal-representation-learning/</link><pubDate>Tue, 24 May 2022 15:10:01 +0000</pubDate><guid>https://davidham3.github.io/blog/p/multibench-multiscale-benchmarks-for-multimodal-representation-learning/</guid><description>&lt;p&gt;NIPS 2021, datasets and benchmarks track, &lt;a class="link" href="https://openreview.net/pdf?id=izzQAL8BciY" target="_blank" rel="noopener"
&gt;MULTIBENCH: Multiscale Benchmarks for Multimodal Representation Learning&lt;/a&gt;ã€‚ä»£ç ï¼š&lt;a class="link" href="https://github.com/pliang279/MultiBench" target="_blank" rel="noopener"
&gt;MultiBench&lt;/a&gt;ã€‚è¿™æ˜¯ä¸ªbenchmarkï¼Œæ¶µç›–15ä¸ªæ•°æ®é›†ï¼Œ10ä¸ªæ¨¡æ€ï¼Œ20ä¸ªé¢„æµ‹ä»»åŠ¡ï¼Œ6ä¸ªç ”ç©¶é¢†åŸŸã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸ªbenchmarkï¼Œæ¶µç›–15ä¸ªæ•°æ®é›†ï¼Œ10ä¸ªæ¨¡æ€ï¼Œ20ä¸ªé¢„æµ‹ä»»åŠ¡ï¼Œ6ä¸ªç ”ç©¶é¢†åŸŸã€‚&lt;/p&gt;
&lt;p&gt;è¯„ä¼°ä¸‰é¡¹å†…å®¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;generalization&lt;/li&gt;
&lt;li&gt;time and space complexity&lt;/li&gt;
&lt;li&gt;modality robustness&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æä¾›äº†20ä¸ªå…³äºèåˆã€ä¼˜åŒ–ç›®æ ‡ã€è®­ç»ƒæ–¹æ³•çš„æ ¸å¿ƒæ–¹æ³•çš„æ ‡å‡†å®ç°ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 Introduction
&lt;/h1&gt;&lt;p&gt;A modality refers to a way in which a signal exists or is experienced.æ¨¡æ€æ˜¯æŒ‡æ•°æ®çš„å­˜åœ¨æˆ–è¡¨ç°å½¢å¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multibench-multiscale-benchmarks-for-multimodal-representation-learning/Fig1.jpg"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Limitations of current multimodal datasets&lt;/strong&gt;ï¼šç°åœ¨çš„å¤šæ¨¡æ€ä¸»è¦ç ”ç©¶å›¾åƒå’Œæ–‡æœ¬ï¼Œå…¶ä»–æ¨¡æ€å¤ªå°‘äº†ã€‚æ­¤å¤–ï¼Œå½“å‰çš„benchmarkè¿‡åˆ†å…³æ³¨æ•ˆæœï¼Œå¿½ç•¥äº†æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ï¼ŒåŒæ—¶ä¹Ÿå¿½ç•¥äº†ä¸€äº›ä¸å®Œç¾çš„æ¨¡æ€å¸¦æ¥çš„é²æ£’æ€§çš„ä¸‹é™ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä»¥ä¸Šä¸‰ç‚¹éƒ½åº”è¯¥è¢«è€ƒè™‘ã€‚&lt;/p&gt;</description></item><item><title>Semi-supervised Learning for Marked Temporal Point Processes</title><link>https://davidham3.github.io/blog/p/semi-supervised-learning-for-marked-temporal-point-processes/</link><pubDate>Mon, 23 May 2022 15:27:10 +0000</pubDate><guid>https://davidham3.github.io/blog/p/semi-supervised-learning-for-marked-temporal-point-processes/</guid><description>&lt;p&gt;&lt;a class="link" href="https://arxiv.org/pdf/2107.07729.pdf" target="_blank" rel="noopener"
&gt;Semi-supervised Learning for Marked Temporal Point Processes&lt;/a&gt;ã€‚MTPPçš„åŠç›‘ç£å­¦ä¹ ï¼Œæ¨¡å‹ç§°ä¸ºSSL-MTPPã€‚æœ‰æ ‡ç­¾çš„åœ°æ–¹å°±ç”¨RMTPPï¼Œæ²¡æœ‰æ ‡ç­¾çš„åœ°æ–¹ç”¨RMTPPçš„ç¼–ç å™¨å’Œè§£ç å™¨æ¥é‡æ„ã€‚ä¸¤è¾¹çš„æŸå¤±åŠ åœ¨ä¸€èµ·ä¼˜åŒ–ç½‘ç»œã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/semi-supervised-learning-for-marked-temporal-point-processes/Fig1.jpg"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;h1 id="3-proposed-algorithm"&gt;3 Proposed Algorithm
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/semi-supervised-learning-for-marked-temporal-point-processes/Fig2.jpg"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;æ¶æ„å¦‚å›¾2æ‰€ç¤ºï¼ŒæŸå¤±å‡½æ•°ï¼š&lt;/p&gt;
$$
\tag{1} \mathcal{L}\_{SSL-MTPP} = \mathcal{L}\_{Time} + \mathcal{L}\_{Marker} + \mathcal{L}\_{Recon}
$$&lt;h2 id="31-ssl-mtpp-algorithm"&gt;3.1 SSL-MTPP Algorithm
&lt;/h2&gt;&lt;p&gt;æœ‰æ ‡ç­¾çš„æ•°æ®ï¼Œä¸€ç»„åºåˆ—$(S)$ï¼ŒåŒ…å«$n$ä¸ªåºåˆ—pairï¼Œ$(x_i, y_i)$ï¼Œ$(x_i)$æ˜¯äº‹ä»¶çš„æ—¶é—´ä¿¡æ¯ï¼Œ$(y_i)$æ˜¯markerä¿¡æ¯ã€‚ç”¨RNNæ•è·markerå’Œåºåˆ—çš„æ—¶é—´ä¿¡æ¯ã€‚åµŒå…¥è¡¨ç¤ºç”¨äºé¢„æµ‹markerå’Œæ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;æ²¡æœ‰æ ‡ç­¾çš„æ•°æ®ï¼Œç”¨RNNç¼–è§£ç å™¨æ¨¡å‹ï¼Œåªå­¦ä¹ æ—¶é—´ä¿¡æ¯ã€‚å­¦ä¹ åˆ°çš„æ—¶é—´è¡¨ç¤ºç”¨æ¥å¢å¼ºmarker-time embeddingã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unsupervised Reconstruction Loss Component&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é‡æ„æŸå¤±ï¼Œåªé‡æ„æ—¶é—´ï¼Œä¸è€ƒè™‘markerï¼Œå› æ­¤æœ‰æ²¡æœ‰æ ‡ç­¾éƒ½å¯ä»¥ç”¨ã€‚ç»™å®š$n$ä¸ªåºåˆ—çš„è®­ç»ƒé›†$S = {x_1, x_2, \dots, x_n }$ï¼Œæ¯ä¸ªåºåˆ—$x_i$åŒ…å«$k$ä¸ªäº‹ä»¶ï¼Œé‡æ„æŸå¤±å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$
\tag{2} \mathcal{L}\_{Recon} = \sum^n\_{i=1} \Vert x\_i - \mathcal{D}(\mathcal{E}(x\_i)) \Vert^2\_2
$$&lt;p&gt;$\mathcal{E}$å’Œ$\mathcal{D}$åˆ†åˆ«è¡¨ç¤ºRNNç¼–ç å™¨å’ŒRNNè§£ç å™¨ã€‚é‡æ„æŸå¤±ä¸“æ³¨äºåœ¨ç»™å®šçš„æ—¶é—´åºåˆ—ä¸Šå­¦ä¹ æœ‰æ„ä¹‰çš„è¡¨ç¤ºï¼Œç”¨äºåç»­markerçš„é¢„æµ‹ã€‚é‡æ„æŸå¤±åœ¨è®­ç»ƒè¿‡ç¨‹å®Œå…¨æ˜¯æ— ç›‘ç£çš„ã€‚$(\mathcal{E}(x_i))$æ˜¯æ—¶é—´åºåˆ—çš„ç¼–ç ã€‚å¦‚ä½•ç”¨è¿™ä¸ªåµŒå…¥è¡¨ç¤ºé¢„æµ‹åç»­çš„markeråé¢ä¼šè®²ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/semi-supervised-learning-for-marked-temporal-point-processes/Fig3.jpg"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Supervised Marker and Time Prediction Loss Components&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;$(x_i, y_i)$åŒ…å«äº‹ä»¶çš„æ—¶é—´ä¿¡æ¯å’Œmarkerä¿¡æ¯ï¼Œè¾“å…¥åˆ°RNNæ¨¡å—åå¯ä»¥è·å¾—markerå’Œæ—¶é—´ç›¸äº’ä¾èµ–çš„è¡¨ç¤ºï¼š&lt;/p&gt;
$$
\tag{3} f\_i = RNN(x\_i, y\_i)
$$&lt;p&gt;æå–å‡ºçš„ç‰¹å¾è¡¨ç¤ºä¸æ— ç›‘ç£çš„æ—¶é—´è¡¨ç¤º$(\mathcal{E}(x_i))$ä¸€èµ·ç”ŸæˆèåˆåµŒå…¥è¡¨ç¤ºï¼š&lt;/p&gt;
$$
\tag{4} f^{fused}\_i = f\_i + \lambda \ast \mathcal{E}(x\_i)
$$&lt;p&gt;$\lambda$æ˜¯æƒé‡ã€‚è¿™ä¸ªèåˆè¡¨ç¤ºæ”¾å…¥ä¸€ä¸ª2å±‚æ„ŸçŸ¥æœºé¢„æµ‹ä¸‹ä¸€ä¸ªäº‹ä»¶çš„æ—¶é—´å’Œmarkerã€‚é¢„æµ‹æ¨¡å‹é€šè¿‡ä¸‹é¢çš„æŸå¤±æ¥è®­ç»ƒï¼š&lt;/p&gt;
$$
\tag{5} \begin{align} \mathcal{L}\_{Marker} &amp;= - \sum^M\_{c=1} y^i\_{i,c} \log(p^j\_{i,c})\\ \mathcal{L}\_{Time} &amp;= \Vert x^j\_i - {x^j}'\_i \Vert \end{align}
$$&lt;p&gt;$\mathcal{L}_{Marker}$ç”¨äº¤å‰ç†µï¼Œ$\mathcal{L}_{Time}$ç”¨MAEæŸå¤±ã€‚äº‹ä»¶$j$æ˜¯åºåˆ—$i$çš„ä¸€ä¸ªäº‹ä»¶ï¼Œæ—¶é—´æ˜¯$x^j_i$ï¼Œmarkeræ˜¯$y^j_i$ï¼Œé¢„æµ‹çš„ç±»åˆ«æœ‰$M$ä¸ªã€‚$y^j_{i,c}$æ˜¯ä¸€ä¸ªbinaryå˜é‡ï¼Œè¡¨ç¤ºæ ·æœ¬$y^j_i$æ˜¯å¦æ˜¯ç±»åˆ«$c$ï¼Œ$p^j_{i,c}$æ˜¯æ ·æœ¬å±äºç±»åˆ«$c$çš„æ¦‚ç‡ï¼Œ${x^j}â€™_i$æ˜¯ç»™å®šäº‹ä»¶çš„é¢„æµ‹æ—¶é—´ã€‚&lt;/p&gt;
&lt;h2 id="32-implementation-details"&gt;3.2 Implementation Details
&lt;/h2&gt;&lt;p&gt;SSL-MTPPåˆ©ç”¨äº†RMTPPçš„æ¶æ„ã€‚ç›‘ç£éƒ¨åˆ†çš„RNNæ˜¯ä¸€ä¸ª5å±‚LSTMæ¨¡å‹ï¼Œæ— ç›‘ç£éƒ¨åˆ†æ˜¯2å±‚çš„RNNç¼–ç å™¨å’Œè§£ç å™¨ã€‚markerå’Œevent predictionæ¨¡å—åˆ†åˆ«ç”¨äº†2ä¸ªdenseå±‚ã€‚RNNåé¢ç”¨äº†Dropoutã€‚$\lambda$è®¾ä¸º0.1ã€‚Adamï¼Œå­¦ä¹ ç‡0.01ï¼Œè®­ç»ƒ100è½®ï¼Œbatch sizeæ˜¯1024ä¸ªsequenceã€‚&lt;/p&gt;</description></item><item><title>Individual Mobility Prediction via Attentive Marked Temporal Point Processes</title><link>https://davidham3.github.io/blog/p/individual-mobility-prediction-via-attentive-marked-temporal-point-processes/</link><pubDate>Fri, 20 May 2022 15:35:04 +0000</pubDate><guid>https://davidham3.github.io/blog/p/individual-mobility-prediction-via-attentive-marked-temporal-point-processes/</guid><description>&lt;p&gt;&lt;a class="link" href="https://arxiv.org/pdf/2109.02715.pdf" target="_blank" rel="noopener"
&gt;Individual Mobility Prediction via Attentive Marked Temporal Point Processes&lt;/a&gt;ã€‚ä»£ç ï¼š&lt;a class="link" href="https://github.com/Kaimaoge/AMTPP_for_Mobility" target="_blank" rel="noopener"
&gt;https://github.com/Kaimaoge/AMTPP_for_Mobility&lt;/a&gt;ã€‚ç»“åˆæ·±åº¦å­¦ä¹ çš„TPPï¼Œç”¨æ³¨æ„åŠ›æœºåˆ¶å¢å¼ºå¯¹äº‹ä»¶çš„è¡¨ç¤ºï¼Œä½¿ç”¨æ··åˆALLåˆ†å¸ƒå¯¹äº‹ä»¶é—´çš„æ—¶é—´é—´éš”å»ºæ¨¡ï¼Œé€šè¿‡å­¦ä¹ ODè½¬ç§»æ¦‚ç‡çŸ©é˜µç»™å®šOé¢„æµ‹Dã€‚&lt;/p&gt;
&lt;p&gt;é¢„æµ‹ç”¨æˆ·ä¸‹ä¸€ä¸ªtripçš„å¼€å§‹æ—¶é—´$t$ï¼Œèµ·ç‚¹$o$ï¼Œç›®çš„åœ°$d$ã€‚AMTPPæ¨¡å‹ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶æ•è·ç”¨æˆ·travel behaviorå†…çš„å‘¨æœŸæ€§å’Œregularityã€‚ä½¿ç”¨éå¯¹ç§°çš„log-Laplace mixture distributionå»ºæ¨¡èµ·å§‹æ—¶é—´$t$çš„åˆ†å¸ƒã€‚æ­¤å¤–ï¼Œè¿˜å¼€å‘äº†ä¸€ä¸ªODçŸ©é˜µå­¦ä¹ æ¨¡å—ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 Introduction
&lt;/h1&gt;&lt;p&gt;æœ¬è´¨ä¸Šï¼Œç”¨æˆ·çš„ç§»åŠ¨æ•°æ®åˆ†ä¸ºä¸¤ç±»ï¼šå¸¦æ—¶é—´æˆ³çš„ä½ç½®åºåˆ—${ (t_i, l_i) }^n_{i=1}$ï¼Œè¡¨ç¤ºæ—¶é—´$t_i$çš„ä½ç½®$l_i$ï¼›trip/activity sequence ${(t_i, o_i, d_i)}^n_{i=1}$ï¼Œæ—¶é—´$t_i$çš„ä»$o_i$å‡ºå‘ï¼Œç›®çš„åœ°æ˜¯$d_i$ã€‚é¢„æµ‹ä¸‹ä¸€ä½ç½®çš„ç ”ç©¶æ¯”è¾ƒå¤šï¼Œä½†æ˜¯é¢„æµ‹ä¸‹ä¸€ä¸ªtripçš„å·¥ä½œæ¯”è¾ƒå°‘ã€‚ç›¸æ¯”å‰è€…ï¼Œåè€…çš„ä¿¡æ¯é‡æ›´å¤§ï¼Œæ—¶ç©ºå…³è”æ›´å¤æ‚ã€‚è€Œä¸”tripè®°å½•æ¯”è½¨è¿¹åº”ç”¨çš„åœºæ™¯æ›´å¤šã€‚ä½†æ˜¯å¯¹ODå»ºæ¨¡ï¼Œå‡è®¾æœ‰$S$ä¸ªä½ç½®ï¼Œé‚£å°±è¦$S \times S$è¿™ä¸ªæ•°é‡çº§ï¼Œè€ƒè™‘åˆ°æ—¶é—´å’Œtravelçš„æ–¹å¼ï¼Œæ¯”å¦‚car, bike, busã€æ—…è¡Œçš„ç›®çš„ï¼Œwork, school, leisureï¼Œè¿™ä¸ªæ•°é‡çº§å°±æ›´å¤§äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/individual-mobility-prediction-via-attentive-marked-temporal-point-processes/Fig1.jpg"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡çš„ç›®çš„æ˜¯ç»™å®šå†å²çš„è½¨è¿¹${t_i, o_i, d_i}^n_{i=1}$ï¼Œé¢„æµ‹$t_{n+1}, o_{n+1}, d_{n+1}$ã€‚å¦‚æœæŠŠæ—¶é—´$t$çœ‹ä½œæ˜¯è¿ç»­å˜é‡ï¼Œ$o, d$çœ‹ä½œæ˜¯ç¦»æ•£å˜é‡ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªtripçš„æœç´¢ç©ºé—´æ˜¯$[t_n, +\infty) \times {1, \dots, S} \times {1, \dots, S}$ã€‚ç°åœ¨å¤„ç†äº‹ä»¶åºåˆ—çš„æ–¹æ³•æœ‰ä¸¤ç±»ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;HMMï¼Œéšé©¬å°”å¯å¤«æ¨¡å‹&lt;/li&gt;
&lt;li&gt;marked temporal point processesã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;HMMçš„ç¼ºç‚¹æ˜¯æ—¶é—´æ˜¯ç¦»æ•£çš„ï¼Œä¸æ˜¯è¿ç»­çš„ã€‚TPPç›¸æ¯”HMMï¼Œæ›´é€šç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘çš„å·¥ä½œæŠŠæ·±åº¦å­¦ä¹ å’ŒTPPç»“åˆåœ¨ä¸€èµ·ã€‚ä½†æ˜¯è¿™äº›æ–¹æ³•åœ¨å»ºæ¨¡ç”¨æˆ·ç§»åŠ¨æˆ–æ—…è¡Œæ•°æ®ä¸Šæœ‰ä¸€äº›æŒ‘æˆ˜ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ODæ•°æ®ä¹‹é—´çš„æ—¶ç©ºå…³ç³»å¤ªå¤æ‚äº†ã€‚è€Œä¸”$S \times S$è¿™ä¸ªæ•°é‡çº§å¤ªå¤§ã€‚æœ‰äº›å·¥ä½œå‡è®¾timeå’Œmarkerä¹‹é—´çš„å…³ç³»æ˜¯é™æ€çš„ã€‚å½“markerçš„ç»´æ•°æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œå‚æ•°ä¼šå˜å¾—å¾ˆå¤šã€‚&lt;/li&gt;
&lt;li&gt;å¾ˆå¤šTPPæ–¹æ³•æ˜¯ç”¨Hawkesè¿‡ç¨‹æ¥å»ºæ¨¡çš„ï¼Œè¿™ç§è¿‡ç¨‹æ²¡æ³•æç°travelä¸­çš„å‘¨æœŸæ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœ¬æ–‡æå‡ºçš„AMTPPè§£å†³äº†ä¸Šè¿°çš„æŒ‘æˆ˜ã€‚ç”¨è‡ªæ³¨æ„åŠ›è®¡ç®—è¿‡å»çš„tripå¯¹æœªæ¥tripçš„å½±å“ã€‚å¹¶ä¸”è®¾è®¡äº†ä¸€ä¸ªæ–°çš„position embeddingæ¥æ•è·æ—¶é—´ä¿¡æ¯ã€‚ä½¿ç”¨asymmetric Log-Laplace mixture distributionå»ºæ¨¡äº‹ä»¶é—´çš„æ—¶é—´ã€‚ALLåˆ†å¸ƒå¯ä»¥åˆ»ç”»travel behaviorçš„rhythmså’Œregularityã€‚ODçŸ©é˜µå­¦ä¹ æ¨¡å—ï¼Œå¯ä»¥ä»æ•°æ®ä¸­å­¦ä¹ åˆ°ä¸€ä¸ªåŠ¨æ€çš„ODå…³ç³»çŸ©é˜µã€‚&lt;/p&gt;
&lt;h1 id="problem-description"&gt;Problem Description
&lt;/h1&gt;&lt;p&gt;ä¸€ä¸ªç”¨æˆ·$u$ç›´åˆ°æ—¶é—´$t$çš„trip sequenceï¼š&lt;/p&gt;
$$
\tag{1} \mathcal{H}^u\_t = \{(t^u\_1, o^u\_1, d^u\_1), \dots, (t^u\_{n\_u}, o^u\_{n\_u}, d^u\_{n\_u}): t^u\_{n\_u} \leq t \},
$$&lt;p&gt;$n_u$è¡¨ç¤ºåºåˆ—ä¸­çš„tripä¸ªæ•°ã€‚$t^u_i, o^u_i, d^u_i$è¡¨ç¤ºç¬¬$i$ä¸ªtripçš„å‡ºå‘æ—¶é—´ã€èµ·ç‚¹å’Œç›®çš„åœ°ã€‚æ—¶é—´æ˜¯è¿ç»­å˜é‡ï¼ŒODæ˜¯ç¦»æ•£å˜é‡ã€‚åé¢å¿½ç•¥$u$ã€‚$t_i$å¯ä»¥è¡¨ç¤ºä¸ºäº‹ä»¶é—´çš„æ—¶é—´é—´éš”$\tau_i = t_i - t_{i - 1} \in \mathbb{R}^+$ã€‚$\tau$å¯ä»¥çœ‹ä½œæ˜¯äº‹ä»¶çš„æ´»åŠ¨æ—¶é—´ã€‚è¿™ä¿©è¡¨ç¤ºæ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç›®æ ‡ï¼š&lt;/p&gt;
$$
\tag{2} p^\ast(\tau\_{n+1}, o\_{n+1}, d\_{n+1}) = p(\tau\_{n+1}, o\_{n+1}, d\_{n+1} \mid \mathcal{H}\_{t\_n}),
$$&lt;p&gt;$\ast$è¡¨ç¤ºæ¡ä»¶æ¦‚ç‡ã€‚æœ¬æ–‡è®¤ä¸º$o_{n+1} = d_n$ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€ä¸ªtripçš„ç›®çš„åœ°ç­‰äºä¸‹ä¸€ä¸ªtripçš„èµ·ç‚¹ï¼Œè¿™æ ·çš„è¯ï¼Œtripçš„TPPå°±å˜æˆæ™®é€šçš„TPPäº†ã€‚&lt;/p&gt;
&lt;h1 id="4-methodology"&gt;4 Methodology
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/individual-mobility-prediction-via-attentive-marked-temporal-point-processes/Fig2.jpg"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;å›¾2æ˜¯AMTPPçš„æ¶æ„ã€‚&lt;/p&gt;
&lt;h2 id="41-self-attention-encoder"&gt;4.1 Self-attention Encoder
&lt;/h2&gt;&lt;p&gt;ç¬¬ä¸€æ­¥æ˜¯è·å¾—$t_n, o_n, d_n$çš„åµŒå…¥è¡¨ç¤ºï¼š&lt;/p&gt;
$$
\tag{3} e\_n = \text{concat}(emb^t\_n, emb^o\_n, emb^d\_n),
$$&lt;p&gt;ä¸ºäº†è€ƒè™‘å‘¨æœŸå’ŒéŸµå¾‹ï¼Œå¼•å…¥ä½ç½®ç¼–ç ï¼š&lt;/p&gt;
$$
\tag{4} \begin{align} pe^n\_n(pos\_n, 2i) &amp;= \text{sin}(pos\_n / L^{2i/J}\_{pos}),\\ pe^h\_n(pos\_n, 2i+1) &amp;= \text{cos}(pos\_n / L^{2i/J}\_{pos}), \end{align},
$$&lt;p&gt;$pos_n \in {0, 1, \dots, 23 }$æ˜¯ç¬¬$n$ä¸ªtripçš„å°æ—¶ï¼Œ$J$æ˜¯åµŒå…¥çš„ç»´æ•°ï¼Œ$i \in {1, \dots, \lfloor J/2 \rfloor }$, $L_{pos}$æ˜¯ç¼©æ”¾å› å­ã€‚å¾ˆå¤šæ–¹æ³•æŠŠ$L_{pos}$è®¾ç½®æˆä¸€ä¸ªå®šå€¼ï¼Œæ¯”å¦‚10000ï¼Œä½†æ˜¯æœ¬æ–‡æŠŠå®ƒè®¾å®šä¸ºä¸€ä¸ªå‚æ•°ã€‚æ­¤å¤–ï¼Œè¿˜å¼•å…¥äº†day of weekä½œä¸ºä½ç½®ç¼–ç $pe^w_n$ã€‚åŠ ä¸Š$\tau_n$ï¼Œæœ€åçš„äº‹ä»¶åµŒå…¥è¡¨ç¤ºï¼š&lt;/p&gt;
$$
\tag{5} emb^t\_n = \text{concat}(pe^w\_n, pe^h\_n, \tau\_n).
$$&lt;p&gt;ODåµŒå…¥ï¼š&lt;/p&gt;
$$
\tag{6} \begin{align} emb^o\_n &amp;= \text{concat}(W^o\_{em} \hat{o}\_n + b^o\_{em}, p^o\_n),\\ emb^d\_n &amp;= \text{concat}(W^d\_{em} \hat{d}\_n + b^d\_{em}, p^d\_n), \end{align}
$$&lt;p&gt;$W^o_{em} \in \mathbb{R}^{J_o \times S}, W^d_{em} \in \mathbb{R}^{J_d \times S}, b^o_{em} \in \mathbb{R}^{J_o}, b^d_{em} \in \mathbb{R}^{J_d}$æ˜¯å‚æ•°ï¼Œ$J_o, J_d$æ˜¯ODåµŒå…¥å‘é‡çš„ç»´æ•°ï¼Œ$S$æ˜¯ä½ç½®çš„æ•°é‡ï¼Œ$p^o_n, p^d_n$æ˜¯ODçš„å…¶ä»–ä¿¡æ¯ï¼Œæ¯”å¦‚POIä»€ä¹ˆçš„ã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®šå†å²äº‹ä»¶åºåˆ—çš„åµŒå…¥$E_n = [e_1, e_2, \dots, e_n]^\top \in \mathbb{R}^{n \times J}$ï¼Œç”¨å¤šå¤´è‡ªæ³¨æ„åŠ›è®¡ç®—ç¬¬$n$ä¸ªtripçš„éšè—çŠ¶æ€ã€‚æ³¨æ„åŠ›çš„å‚æ•°çŸ©é˜µ$Q_l = EW^Q_l, K_l = E W^K_l, V_l = E W^V_l, l = 1, 2, \dots, L$ã€‚$W^Q_l, W^K_l \in \mathbb{R}^{J \times c_k}, W^V_l \in \mathbb{R}^{J \times C_v}$ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åŠ›ï¼š&lt;/p&gt;
$$
\tag{7} \text{Att}(Q\_l, K\_l, V\_l) = \text{softmax}(\frac{Q\_l K^\top\_l}{\sqrt{d\_k}} \cdot M) V\_l,
$$&lt;p&gt;$M \in \mathbb{R}^{n \times n}$æ˜¯maskçŸ©é˜µï¼Œä¸Šä¸‰è§’éƒ¨åˆ†è®¾ä¸º$-\infty$ï¼Œé˜²æ­¢ä¿¡æ¯æ³„éœ²ã€‚&lt;/p&gt;
&lt;p&gt;å¤šå¤´æ³¨æ„åŠ›ï¼š&lt;/p&gt;
$$
\tag{8} \begin{align} H &amp;= \text{gelu}(\text{concat}(\text{head}\_1, \dots, \text{head}\_L) W^O),\\ \text{head}\_l &amp;= \text{Att}(EW^Q\_l, EW^K\_l, EW^V\_l), \end{align}
$$&lt;p&gt;$W_O \in \mathbb{R}^{L \cdot c_v \times C_{\text{model}}}$, $c_{\text{model}}$æ˜¯è¾“å‡ºçš„ç‰¹å¾æ•°ã€‚$\text{gelu}$è¡¨ç¤ºGaussian Error Linear Unitï¼Œéçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œ$H_n = [h_1, h_2, \dots, h_n]^\top \in \mathbb{R}^{n \times c_{\text{model}}}$æ˜¯è¾“å‡ºã€‚å› ä¸ºç”¨äº†maskï¼Œæ‰€ä»¥$h_i$åªæ˜¯åŸºäºå†å²ç”Ÿæˆçš„ã€‚&lt;/p&gt;
&lt;h2 id="42-asymmetrical-log-laplace-mixture-for-inter-trip-time"&gt;4.2 Asymmetrical Log-Laplace Mixture for Inter-trip Time
&lt;/h2&gt;&lt;p&gt;è¿™ä¸ªéƒ¨åˆ†æ˜¯å¯¹äº‹ä»¶é—´çš„æ—¶é—´é—´éš”çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $p_\theta(\tau_{n+1} \mid h_n)$ å»ºæ¨¡ï¼Œä½¿ç”¨å‚æ•°ä¸º$\theta$çš„æ·±åº¦ç¥ç»ç½‘ç»œå»ºæ¨¡ã€‚ã€ŠIntensity-Free Learning of Temporal Point Processesã€‹è¿™ç¯‡è®ºæ–‡è®¤ä¸ºç›¸æ¯”å¯¹å¼ºåº¦å‡½æ•°å»ºæ¨¡ï¼Œç›´æ¥å¯¹æ—¶é—´é—´éš”å»ºæ¨¡æ›´æ–¹ä¾¿ã€‚è¿™ç¯‡è®ºæ–‡ç”¨log-normal mixture modelå¯¹TPPçš„æ¡ä»¶æ¦‚ç‡å¯†åº¦$p_\theta(\tau_{n+1} \mid h_n)$å»ºæ¨¡ã€‚ä½†æ˜¯è¿™ä¸ªåˆ†å¸ƒå¯¹tripä¹‹é—´çš„intervalä¸é€‚ç”¨ï¼Œå› ä¸ºtripä¹‹é—´çš„intervalè¡¨ç¤ºäº†äº‹ä»¶çš„æŒç»­æ—¶é—´ï¼Œè€Œä¸”æ¡ä»¶åˆ†å¸ƒé€šå¸¸æœ‰ä¸€äº›æ˜æ˜¾çš„å³°ã€‚ä¸ºäº†æ›´å¥½çš„åˆ»ç”»tripé—´çš„æ—¶é—´é—´éš”ï¼Œæœ¬æ–‡ç”¨Aysmmetric Log-Laplaceåˆ†å¸ƒã€‚è¿™ä¸ªåˆ†å¸ƒç»å¸¸ç”¨äºå¯¹éå¸¸åã€æœ‰å³°å’Œé•¿å°¾çš„æ•°æ®å»ºæ¨¡ã€‚ALLåˆ†å¸ƒæœ‰ä¸‰ä¸ªå‚æ•°ï¼š&lt;/p&gt;
$$
ALL(\tau; \beta, \lambda, \gamma) = \frac{\lambda \gamma}{\tau(\lambda + \gamma)} \begin{cases} (\frac{\tau}{\beta})^\lambda &amp; \text{if} \ 0 &lt; \tau &lt; \beta,\\ (\frac{\beta}{\tau})^\gamma &amp; \text{if} \ \tau \geq \beta, \end{cases}
$$&lt;p&gt;$\beta$æ§åˆ¶æ¨¡å¼ï¼Œ$\lambda$å’Œ$\gamma$åˆ†åˆ«æ˜¯å·¦å³é•¿å°¾çš„æ­£é•¿å°¾å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç†æƒ³çš„$p_\theta(\tau \mid h)$åˆ†å¸ƒèƒ½è¶‹è¿‘ä»»æ„åˆ†å¸ƒã€‚å› ä¸ºæ··åˆæ¨¡å‹æœ‰è¶‹è¿‘$\mathbb{R}$ä¸Šä»»æ„æ¦‚ç‡åˆ†å¸ƒçš„æ€§è´¨ï¼šuniversal approximation(UA)ï¼Œæˆ‘ä»¬ä½¿ç”¨$\mathcal{D}$ï¼Œä½œä¸ºALLçš„æ··åˆåˆ†å¸ƒï¼Œæ¥è¶‹è¿‘$p_\theta(\tau \mid h)$ï¼š&lt;/p&gt;
$$
\tag{9} \mathcal{D}(\tau; w, \beta, \lambda, \gamma) = \sum^K\_{k=1} w\_k ALL(\tau; \beta\_k, \lambda\_k, \gamma\_k),
$$&lt;p&gt;$w$æ˜¯æ··åˆæƒé‡ã€‚é€šè¿‡è¿™ä¸ªæ··åˆæ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥è¿‘ä¼¼ä¸€ä¸ªç”¨æˆ·çš„å¤šæ¨¡æ€æ—…è¡Œæ¨¡å¼ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä¸€ä¸ªæ—…è¡Œè€…åªæœ‰æ—©ä¸Šçš„é€šå‹¤æ•°æ®ï¼Œæˆ‘ä»¬åœ¨24å°æ—¶å†…åªèƒ½çœ‹åˆ°ä¸€ä¸ªå³°ã€‚ä½†æ˜¯å¯¹äºæ¥å›é€šå‹¤çš„äººï¼Œæˆ‘ä»¬å¸Œæœ›çœ‹åˆ°çš„æ˜¯æ—©ä¸Šä¸€ä¸ªå³°ï¼Œæ™šä¸Šä¸€ä¸ªå³°ã€‚è¿™ç§æ··åˆæ¨¡å‹å¯ä»¥è¡¨ç¤ºå¤šä¸ªå³°ã€‚&lt;/p&gt;
&lt;p&gt;ALLæ··åˆåˆ†å¸ƒä¸‹çš„å˜é‡çš„å¯¹æ•°æœä»$\text{ALMixture}(w,\hat{\beta}, \hat{\lambda}, \hat{\gamma})$ï¼Œæ¯ä¸ªéƒ¨åˆ†æ˜¯ï¼š&lt;/p&gt;
$$
\tag{10} AL(y) = \frac{\hat{\lambda}\_k}{\hat{\gamma}\_k + \frac{1}{\hat{\gamma}\_k}} \begin{cases} \exp (\frac{\hat{\lambda}\_k}{\hat{\gamma}\_k} (y - \hat{\beta}\_k)) &amp; \ \text{if} \ 0 &lt; y &lt; \hat{\beta}\_k,\\ \exp(- \hat{\lambda}\_k \hat{\gamma}\_k (y - \hat{\beta}\_k)) &amp; \ \text{if} \ y \geq \hat{\beta}\_k, \end{cases}
$$&lt;p&gt;$\hat{\beta}_k = \log(\beta_k), \hat{\gamma}_k = \sqrt{\frac{\lambda_k}{\gamma_k}}, \hat{\lambda}_k = \sqrt{\lambda_k \gamma_k}$ã€‚&lt;/p&gt;
&lt;p&gt;å…¬å¼10é‡Œé¢çš„å¯¹æ•°ä¼¼ç„¶æ¯”å…¬å¼9ä¸­çš„åŸå§‹ALLæ›´å®¹æ˜“å­¦ä¹ ã€‚æˆ‘ä»¬ç”¨MDNç½‘ç»œå­¦ä¹ ALMixtureé‡Œé¢çš„å‚æ•°ï¼š&lt;/p&gt;
$$
\tag{11} \begin{align} w\_n &amp;= \text{softmax}(\Phi\_w h\_n + b\_w),\\ \hat{\beta}\_n &amp;= \exp(\Phi\_\beta h\_n + b\_\beta),\\ \hat{\lambda}\_n &amp;= \exp(\Phi\_\lambda h\_n + b\_\lambda),\\ \hat{\gamma}\_n &amp;= \exp(\Phi\_\gamma h\_n + b\_\gamma), \end{align}
$$&lt;p&gt;softmaxå’Œexpç”¨æ¥çº¦æŸåˆ†å¸ƒçš„å‚æ•°ï¼Œ$\Phi, b$éƒ½æ˜¯learnable parametersã€‚&lt;/p&gt;
&lt;h2 id="43-od-matrix-learning"&gt;4.3 OD Matrix Learning
&lt;/h2&gt;&lt;p&gt;æ˜¾ç„¶ODå’Œ$t$æ˜¯æœ‰å…³çš„ï¼Œå³$p^\ast(o_{n+1} \mid \tau_{n+1})$ï¼Œè¿™é‡Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥å¯¹æ—¶é—´$\tau$å»ºæ¨¡ï¼Œè€Œæ˜¯å¯¹$\tau$ä¸Šé¢çš„å‚æ•°${w_n, \beta_n, \lambda_n, \gamma_n }$å»ºæ¨¡ï¼Œè¿™æ ·å°±ä¸ç”¨ä»åˆ†å¸ƒä¸­é‡‡æ ·äº†ã€‚å› ä¸ºALLæ··åˆåˆ†å¸ƒä¸­çš„å‚æ•°æ˜¯æœ‰ç‰©ç†æ„ä¹‰çš„ï¼Œä»å­¦ä¹ åˆ°çš„æ¨¡å‹ä¸­æ¨¡æ‹Ÿtripä¹Ÿå¾ˆå®¹æ˜“ã€‚é€šè¿‡è°ƒæ•´å‚æ•°å°±å¯ä»¥çœ‹åˆ°ODåˆ†å¸ƒçš„å˜åŒ–ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡å°å³°å‚æ•°$\beta$æ¥è§‚å¯ŸODåˆ†å¸ƒçš„å˜åŒ–ï¼Œå¯ä»¥ç†è§£æˆä¸€ä¸ªäººçš„å‡ºå‘æ—¶é—´æå‰ä¹‹åä»–çš„tripä¼šæœ‰ä»€ä¹ˆå˜åŒ–ã€‚&lt;/p&gt;
$$
\tag{12} \begin{align} \hat{h}\_n &amp;= \text{concat}(h\_n, w\_n, \hat{\beta}\_n, \hat{\lambda}\_n, \hat{\gamma}\_n),\\ \hat{o}\_{n+1} &amp;= \text{softmax}(\Phi\_o \hat{h}\_n + b\_o), \end{align}
$$&lt;p&gt;ä¸‹ä¸€ä¸ªä½ç½®$\hat{o}_{n+1}$çš„åˆ†å¸ƒä¾èµ–æ‹¼æ¥å‘é‡$\hat{h}_n$ï¼Œè¿™ä¸ªå‘é‡ç”±å†å²ç¼–ç $h_n$å’Œtripçš„æ—¶é—´å‚æ•°ç»„æˆã€‚&lt;/p&gt;
&lt;p&gt;$p^\ast(d_{n+1})$é€šè¿‡æŠŠ$\hat{o}_{n+1}$ä¹˜ä»¥ä¸€ä¸ªODçŸ©é˜µ$OD_{n+1}$å¾—åˆ°ï¼Œè¿™ä¸ªçŸ©é˜µçš„æ¯ä¸€åˆ—åŒ…å«äº†ä»ä¸€ä¸ªOè½¬ç§»åˆ°æ‰€æœ‰Dçš„è½¬ç§»æ¦‚ç‡ã€‚è¿™ä¸ªODçŸ©é˜µå¾ˆæœ‰ç”¨ï¼Œæœ‰äº†è¿™ä¸ªODçŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“åœ°é“çº¿è·¯é‡Œé¢å“ªä¸ªç»“ç‚¹çš„äººæ¯”è¾ƒå¤šã€‚ä½†æ˜¯$S \times S$å¤ªå¤§äº†ï¼Œå­¦ä¸€ä¸ªå®æ—¶çš„ODçŸ©é˜µå¤ªéš¾äº†ã€‚æˆ‘ä»¬ç”¨ä¸‹é¢çš„æ–¹æ³•å­¦ä¹ $OD_{n+1}$é‡Œé¢çš„å‚æ•°ï¼š&lt;/p&gt;
$$
\tag{13}
\begin{align}
D^1\_{n+1} &amp;= \text{reshape}(\Phi^1\_m \hat{h}\_n),\\
D^2\_{n+1} &amp;= \text{reshape}(\Phi^2\_m \hat{h}\_n),\\
OD\_{n+1} &amp;= D^1\_{n+1}{D^2\_{n+1}}^\top \cdot M\_{od},\\
OD\_{n+1} &amp;= \text{softmax}(OD\_{n+1}).\\
\hat{d}\_{n+1} &amp;= OD\_{n+1} \hat{o}\_{n+1}
\end{align}
$$&lt;p&gt;$D^1_{n+1}, D^2_{n+1} \in \mathbb{R}^{S \times r}$, $r \ll S$ã€‚$\Phi$æ˜¯learnable parametersã€‚$M_{od} \in \mathbb{R}^{S \times S}$ç”¨æ¥è¿‡æ»¤æ‰ä¸å¯èƒ½çš„OD pairï¼Œæ–¹æ³•å°±æ˜¯æŠŠè¿™äº›ä½ç½®è®¾ç½®æˆ $- \infty$ï¼ŒåŒ…æ‹¬çŸ©é˜µçš„å¯¹è§’çº¿ã€‚softmaxç”¨æ¥çº¦æŸçŸ©é˜µçš„æ¯ä¸€åˆ—çš„å’Œéƒ½ä¸º1ã€‚è¿™ä¸ªçŸ©é˜µæ˜¯æ ¹æ®æ—¶é—´ç¼–ç $\hat{h}_n$åŠ¨æ€å˜åŒ–çš„ã€‚è¾“å‡ºçš„$\hat{d}_{n+1}$å’Œè¾“å…¥çš„$\hat{o}_{n+1}$ä¸å‚æ•°å…³è”åœ¨ä¸€èµ·ï¼Œè®©ç½‘ç»œè®­ç»ƒèµ·æ¥æ›´å®¹æ˜“ã€‚&lt;/p&gt;
&lt;h2 id="44-model-training"&gt;4.4 Model Training
&lt;/h2&gt;&lt;p&gt;è´Ÿå¯¹æ•°ä¼¼ç„¶ã€‚éšæœºæ¢¯åº¦ä¸‹é™ã€‚çŸ­çš„åºåˆ—è¦åŠ padã€‚padéƒ¨åˆ†ä¼šè¢«maskæ‰ã€‚æŸå¤±å‡½æ•°ï¼š&lt;/p&gt;
$$
\tag{14} \mathcal{L} = - \sum^U\_{u=1} \sum^{n\_u}\_{n=1} \log p^\ast\_\Theta(\tau^u\_n) + \log p^\ast\_\Theta(o^u\_n) + \log p^\ast\_\Theta(d^u\_n),
$$&lt;p&gt;$U$æ˜¯ç”¨æˆ·æ•°ï¼Œ$n_u$æ˜¯ç”¨æˆ·$u$çš„tripçš„ä¸ªæ•°ã€‚å¯¹äº$\tau$çš„å¯¹æ•°ä¼¼ç„¶ï¼Œåœ¨$\tau$ä¸Šé¢åŠ ä¸€ä¸ªå¯¹æ•°å˜æ¢ï¼Œå¾—åˆ°éå¯¹ç§°Laplaceåˆ†å¸ƒï¼š$y = \log(\tau)$ï¼Œæœ€ç»ˆå¾—åˆ°ï¼š&lt;/p&gt;
$$
\tag{15} \begin{align} \log p^\ast\_\Theta(\tau) &amp;= \log p^\ast\_\Theta(y) - \log(\tau), \ \ \ \ y = \log(\tau),\\ p^\ast\_\Theta(y) &amp;= \text{ALMixture}(w, \hat{\beta}, \hat{\lambda}, \hat{\gamma}). \end{align}
$$</description></item><item><title>Unsupervised Scalable Representation Learning for Multivariate Time Series</title><link>https://davidham3.github.io/blog/p/unsupervised-scalable-representation-learning-for-multivariate-time-series/</link><pubDate>Thu, 19 May 2022 14:54:43 +0000</pubDate><guid>https://davidham3.github.io/blog/p/unsupervised-scalable-representation-learning-for-multivariate-time-series/</guid><description>&lt;p&gt;NIPS 2019, &lt;a class="link" href="https://arxiv.org/abs/1901.10738" target="_blank" rel="noopener"
&gt;Unsupervised Scalable Representation Learning for Multivariate Time Series&lt;/a&gt;ã€‚T-lossã€‚æ— ç›‘ç£å¤šå…ƒæ—¶é—´åºåˆ—è¡¨ç¤ºæ¨¡å‹ã€‚åˆ©ç”¨word2vecçš„è´Ÿæ ·æœ¬é‡‡æ ·çš„æ€æƒ³å­¦ä¹ æ—¶é—´åºåˆ—çš„åµŒå…¥è¡¨ç¤ºã€‚ä»£ç ï¼š&lt;a class="link" href="https://github.com/White-Link/UnsupervisedScalableRepresentationLearningTimeSeries" target="_blank" rel="noopener"
&gt;UnsupervisedScalableRepresentationLearningTimeSeries&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="3-unsupervised-training"&gt;3 Unsupervised Training
&lt;/h1&gt;&lt;p&gt;åªæƒ³è®­ç»ƒç¼–ç å™¨ï¼Œä¸æƒ³æç¼–ç è§£ç ç»“æ„ï¼Œå› ä¸ºè®¡ç®—é‡å¤ªå¤§äº†ã€‚å› æ­¤å¼•å…¥äº†ä¸€ä¸ªé’ˆå¯¹æ—¶é—´åºåˆ—çš„triplet lossã€‚&lt;/p&gt;
&lt;p&gt;ç›®æ ‡æ˜¯æ— ç›‘ç£çš„æƒ…å†µä¸‹ç›¸ä¼¼çš„æ—¶é—´åºåˆ—å…·æœ‰ç›¸ä¼¼çš„è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/unsupervised-scalable-representation-learning-for-multivariate-time-series/Fig1.jpg"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;å›¾1ï¼Œç»™å®šæ—¶é—´åºåˆ—$y_i$ï¼Œä¸€ä¸ªéšæœºå­åºåˆ—$x^{\text{ref}}$ã€‚$x^{\text{ref}}$çš„è¡¨ç¤ºè¦ä¸$x^{\text{pos}}$ç›¸ä¼¼ï¼Œä¸å¦ä¸€ä¸ªéšæœºé‡‡æ ·çš„å­åºåˆ—$x^{\text{neg}}$ä¸ç›¸ä¼¼ã€‚ç±»æ¯”word2vecï¼Œ$x^{\text{pos}}$æ˜¯wordï¼Œ$x^{\text{ref}}$æ˜¯contextï¼Œ$x^{\text{neg}}$æ˜¯ä¸€ä¸ªéšæœºçš„è¯ã€‚&lt;/p&gt;
&lt;p&gt;æŸå¤±å‡½æ•°ï¼š&lt;/p&gt;
$$
\tag{1} -\log{( \sigma(f(x^{\text{ref}}, \theta)^\top f(x^{\text{pos}}, \theta)) )} - \sum^K\_{k=1} \log{( \sigma( -f(x^{\text{ref}}, \theta)^\top f(x^{\text{neg}}, \theta) ) )},
$$&lt;p&gt;$f(\cdot, \theta)$æ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œå‚æ•°æ˜¯$\theta$ï¼Œ$\sigma$æ˜¯sigmoidæ¿€æ´»å‡½æ•°ã€‚$K$æ˜¯è´Ÿæ ·æœ¬çš„ä¸ªæ•°&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/unsupervised-scalable-representation-learning-for-multivariate-time-series/Alg1.jpg"
loading="lazy"
alt="Algorithm_1"
&gt;&lt;/p&gt;
&lt;h1 id="4-encoder-architecture"&gt;4 Encoder Architecture
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;å¿…é¡»ä»æ—¶é—´åºåˆ—ä¸­æå–ç›¸å…³ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;è®­ç»ƒå’Œæ¨æ–­çš„æ—¶å€™æ—¶é—´å’Œç©ºé—´éƒ½è¦é«˜æ•ˆ&lt;/li&gt;
&lt;li&gt;å¿…é¡»èƒ½æ¥å—å˜é•¿çš„è¾“å…¥&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½¿ç”¨exponentially dilated causal convolutionså¤„ç†ã€‚ç›¸æ¯”RNNï¼Œè¿™ç±»ç½‘ç»œå¯ä»¥åœ¨GPUä¸Šé«˜æ•ˆåœ°å¹¶è¡Œè®¡ç®—ã€‚å¯¹æ¯”fully convolutionsï¼Œå¯ä»¥æ•è·æ›´é•¿èŒƒå›´çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;å³ä¾¿LSTMè§£å†³äº†æ¢¯åº¦æ¶ˆå¤±å’Œçˆ†ç‚¸çš„é—®é¢˜ï¼Œåœ¨è¿™ä¸ªæ¢¯åº¦é—®é¢˜ä¸Šä»ç„¶æ¯”ä¸è¿‡å·ç§¯ç½‘ç»œã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„æ¨¡å‹å †å äº†å¤šä¸ªdilated causal convolutionsï¼Œå¦‚å›¾2aã€‚æ¯ä¸ªæ•°éƒ½æ˜¯é€šè¿‡å‰é¢çš„æ•°è®¡ç®—å‡ºæ¥çš„ï¼Œå› æ­¤ç§°ä¸ºå› æœã€‚å›¾2açº¢è‰²éƒ¨åˆ†å±•ç¤ºäº†è¾“å‡ºå€¼çš„è®¡ç®—è·¯å¾„ã€‚&lt;/p&gt;
&lt;p&gt;å·ç§¯ç½‘ç»œçš„è¾“å‡ºä¼šæ”¾å…¥ä¸€ä¸ªmax poolingå±‚ï¼ŒæŠŠæ‰€æœ‰æ—¶é—´ä¿¡æ¯èšåˆåˆ°ä¸€ä¸ªå›ºå®šå¤§å°çš„å‘é‡ä¸­ã€‚&lt;/p&gt;</description></item><item><title>Fully Neural Network based Model for General Temporal Point Processes</title><link>https://davidham3.github.io/blog/p/fully-neural-network-based-model-for-general-temporal-point-processes/</link><pubDate>Tue, 17 May 2022 13:11:14 +0000</pubDate><guid>https://davidham3.github.io/blog/p/fully-neural-network-based-model-for-general-temporal-point-processes/</guid><description>&lt;p&gt;NIPS 2019: &lt;a class="link" href="https://arxiv.org/abs/1905.09690v3" target="_blank" rel="noopener"
&gt;Fully Neural Network based Model for General Temporal Point Processes&lt;/a&gt;ã€‚åˆ›æ–°ç‚¹æ˜¯ä¹‹å‰çš„æ¡ä»¶å¼ºåº¦å‡½æ•°æœ‰ä¸€ä¸ªç§¯åˆ†é¡¹ï¼Œè¿™ä¸ªç§¯åˆ†é¡¹ä¸æ˜¯å¾ˆå¥½æ±‚ï¼Œæœ¬æ–‡æå‡ºç”¨ä¸€ä¸ªFNNè®¡ç®—ç´¯ç§¯å¼ºåº¦å‡½æ•°ï¼Œè¿™æ ·æ¡ä»¶å¼ºåº¦å‡½æ•°çš„è®¡ç®—åªéœ€è¦è®¡ç®—ç´¯ç§¯å¼ºåº¦å‡½æ•°å¯¹äº‹ä»¶æ—¶é—´é—´éš”çš„åå¯¼æ•°å°±å¯ä»¥å¾—åˆ°äº†ã€‚ä»£ç ï¼š&lt;a class="link" href="https://github.com/omitakahiro/NeuralNetworkPointProcess" target="_blank" rel="noopener"
&gt;https://github.com/omitakahiro/NeuralNetworkPointProcess&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="2-method"&gt;2 Method
&lt;/h1&gt;&lt;p&gt;æ¡ä»¶å¼ºåº¦å‡½æ•°ï¼š&lt;/p&gt;
$$
\tag{5} \lambda(t \mid H\_t) = \phi(t - t\_i \mid h\_i)
$$&lt;p&gt;è¿™é‡Œ$\phi$æ˜¯éè´Ÿå‡½æ•°ï¼Œè¡¨ç¤ºhazardå‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;Du et al., 2016æå‡ºçš„è¿‘ä¼¼å½¢å¼ï¼š&lt;/p&gt;
$$
\tag{6} \phi(\tau \mid h\_i) = \exp{(w^t \tau + v^\phi \cdot h\_i + b^\phi)}
$$&lt;p&gt;å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š&lt;/p&gt;
$$
\tag{8} \log{L(\{ t\_i \})} = \sum\_i[ \log{\phi(t\_{i+1} - t\_i \mid h\_i)} - \int^{t\_{i+1} - t\_i}\_0 \phi(\tau \mid h\_i)d\tau]
$$&lt;p&gt;ä½¿ç”¨BPTTä¼˜åŒ–ï¼Œ$h_i$æ˜¯RNNçš„éšè—çŠ¶æ€ã€‚&lt;/p&gt;
&lt;h2 id="24-proposed-model"&gt;2.4 Proposed Model
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/fully-neural-network-based-model-for-general-temporal-point-processes/Fig1.jpg"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå»ºæ¨¡ç´¯ç§¯hazardå‡½æ•°ï¼š&lt;/p&gt;
$$
\tag{9} \Phi(\tau \mid h\_i) = \int^\tau\_0 \phi(s \mid h\_i)ds
$$&lt;p&gt;hazardå‡½æ•°é€šè¿‡å¯¹ä¸Šå¼æ±‚åå¯¼æ•°å¾—åˆ°ï¼š&lt;/p&gt;
$$
\tag{10} \phi(\tau \mid h\_i) = \frac{\partial}{\partial \tau} \Phi(\tau \mid h\_i)
$$&lt;p&gt;å¯¹æ•°ä¼¼ç„¶å‡½æ•°å¯ä»¥æ”¹å†™ä¸ºï¼š&lt;/p&gt;
$$
\tag{11} \log{L(\{t\_i\})} = \sum\_i[\log{\{\frac{\partial}{\partial \tau} \Phi(\tau = t\_{i+1} - t\_i \mid h\_i)\}} - \Phi(t\_{i+1} - t\_i \mid h\_i)]
$$&lt;p&gt;ç´¯ç§¯Hazardå‡½æ•°æ˜¯ä¸€ä¸ªå…³äº$\tau$çš„æ­£çš„å•è°ƒé€’å¢å‡½æ•°ã€‚æœ¬æ–‡ç”¨ä¸€ä¸ªFNNç½‘ç»œè¿‘ä¼¼è¿™ä¸ªå‡½æ•°ã€‚ä¸ºäº†ä¿è¯è¿™ä¸ªæ€§è´¨ï¼Œåªè¦åœ¨$\tau$åˆ°æœ€åçš„æŸå¤±çš„è·¯å¾„ä¸Šæƒé‡éƒ½æ˜¯æ­£çš„å°±å¥½äº†ã€‚ç½‘ç»œæ¶æ„å¦‚å›¾1æ‰€ç¤ºã€‚åœ¨æ¨¡å‹å‚æ•°æ›´æ–°çš„æ—¶å€™ï¼Œå¦‚æœæƒé‡å˜æˆè´Ÿçš„ï¼Œå°±ç”¨ç»å¯¹å€¼æ›¿æ¢å®ƒã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçœ‹äº†ä»£ç åå‘ç°æ˜¯æŠŠRNNçš„æœ€åä¸€ä¸ªé¢„æµ‹å€¼ä¸$\tau$ä¸€èµ·è¾“å…¥åˆ°FNNä¸­äº†ã€‚ä¸­é—´è¿™äº›å±‚çš„æƒé‡éƒ½æ˜¯æ­£çš„ï¼Œè€Œä¸”æ¿€æ´»å‡½æ•°æ˜¯$tanh$ï¼Œæœ€åä¸€å±‚çš„æ¿€æ´»å‡½æ•°æ˜¯$softplus$ï¼Œå³$\log{(1 + \exp(\cdot))}$ã€‚&lt;/p&gt;
&lt;p&gt;é¢„æµ‹ä¸‹ä¸€ä¸ªäº‹ä»¶çš„å‘ç”Ÿæ—¶é—´çš„æ–¹å¼æ˜¯ï¼šç»™å®šè¿‡å»äº‹ä»¶${t_1, t_2, \dots t_i}$ï¼Œä¸‹ä¸€ä¸ªäº‹ä»¶çš„å‘ç”Ÿæ—¶é—´$t_{i+1}$çš„æ¡ä»¶å¯†åº¦å‡½æ•°$p^\ast(t \mid t_1, t_2, \dots, t_i)$é€šè¿‡å…¬å¼2è®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;\tag{2} p(t_{i+1} \mid t_1, t_2, \dots, t_i) = \lambda(t_{i+1} \mid H_{t_{i+1}}) \exp{{- \int^{t_{i+1}}_{t_i} \lambda(t \mid H_t) dt }}&lt;/p&gt;
&lt;p&gt;è¿™é‡Œä½¿ç”¨é¢„æµ‹åˆ†å¸ƒ$p^\ast$çš„ä¸­ä½æ•°$t^\ast_{i+1}$æ¥é¢„æµ‹$t_{i+1}$ã€‚è¿™é‡Œåˆ©ç”¨$\Phi(t^\ast_{i+1} - t_i \mid h_i) = \log{(2)}$è¿™ä¸ªå…³ç³»æ¥è®¡ç®—ä¸­ä½æ•°$t^\ast_{i+1}$ã€‚è¿™ä¸ªå…³ç³»é€šè¿‡åœ¨$[t_i, t_{i+1})$ä¸Šé¢å¯¹å¼ºåº¦å‡½æ•°ç§¯åˆ†å¾—åˆ°ï¼Œæ­¤æ—¶æŒ‡æ•°åˆ†å¸ƒçš„å‡å€¼ä¸º1ï¼Œè¿˜å¯ä»¥å¯¹å…¬å¼2ç›´æ¥ç§¯åˆ†å¾—åˆ°ã€‚ä¸­ä½æ•°$t^\ast_{i+1}$å¯ä»¥ä½¿ç”¨root findingæ–¹æ³•ï¼Œæ¯”å¦‚äºŒåˆ†æ–¹æ³•ç›´æ¥è·å¾—ã€‚æœ¬æ–‡çš„æ¨¡å‹åªéœ€è¦1så°±å¯ä»¥ç»™20000ä¸ªäº‹ä»¶ç”Ÿæˆé¢„æµ‹ç»“æœã€‚å› æ­¤ç´¯ç§¯hazardå‡½æ•°åœ¨ç”Ÿæˆä¸­ä½æ•°çš„é¢„æµ‹ä¸­ä¹Ÿå¾ˆé‡è¦ã€‚&lt;/p&gt;</description></item><item><title>Recurrent Marked Temporal Point Processes: Embedding Event History to Vector</title><link>https://davidham3.github.io/blog/p/recurrent-marked-temporal-point-processes-embedding-event-history-to-vector/</link><pubDate>Sun, 01 May 2022 09:18:43 +0000</pubDate><guid>https://davidham3.github.io/blog/p/recurrent-marked-temporal-point-processes-embedding-event-history-to-vector/</guid><description>&lt;p&gt;KDD 2016: RMTPP &lt;a class="link" href="https://www.kdd.org/kdd2016/papers/files/rpp1081-duA.pdf" target="_blank" rel="noopener"
&gt;Recurrent Marked Temporal Point Processes: Embedding Event History to Vector&lt;/a&gt;ã€‚ç»å…¸è®ºæ–‡ï¼Œåˆ©ç”¨RNNè¿‘ä¼¼æ¡ä»¶å¼ºåº¦å‡½æ•°ï¼Œå°†ä¼ ç»Ÿç‚¹è¿‡ç¨‹å¸¦å…¥åˆ°ç¥ç»ç‚¹è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1. Introduction
&lt;/h1&gt;&lt;p&gt;å½“å‰æ–¹æ³•ä¸¤ç±»å˜é‡é©¬å°”å¯å¤«æ¨¡å‹ï¼ŒæŠŠé—®é¢˜çœ‹ä½œæ˜¯discrete-time sequence prediction taskã€‚åŸºäºè§‚å¯Ÿåˆ°çš„çŠ¶æ€åºåˆ—ï¼Œé¢„æµ‹ä¸‹ä¸€æ­¥æœ€å¯èƒ½çš„çŠ¶æ€ã€‚ç¼ºç‚¹æ˜¯è¿™ç±»æ¨¡å‹çš„æ—¶é—´æ˜¯å•ä½å˜åŒ–çš„ï¼Œåœ¨é¢„æµ‹ä¸‹ä¸€ä¸ªäº‹ä»¶çš„æ—¶å€™ä¸èƒ½æ•è·æ—¶é—´çš„heterogeneityã€‚æ­¤å¤–ï¼ŒçŠ¶æ€ä¸èƒ½å¤ªå¤šï¼Œè¦ä¸ç„¶ç®—ä¸è¿‡æ¥ï¼Œå°±æ²¡æ³•æ•è·é•¿è·ç¦»çš„ä¾èµ–å…³ç³»ã€‚åŠé©¬å°”å¯å¤«æ¨¡å‹&lt;/p&gt;
\[26\]&lt;p&gt;å¯ä»¥ç”¨æ¥å»ºæ¨¡ä¸¤ä¸ªè¿ç»­äº‹ä»¶ä¹‹é—´çš„continuous time-intervalï¼Œé€šè¿‡å‡è®¾intervalä¹‹é—´æ˜¯ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒï¼Œä½†æ˜¯éšç€é˜¶æ•°çš„å¢åŠ ï¼Œè®¡ç®—ä»ç„¶ä¼šçˆ†ç‚¸ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒç±»æ˜¯marked temporal point processeså’Œintensity functionï¼Œè¿™ä¸¤ç±»æ˜¯å»ºæ¨¡è¿™ç§äº‹ä»¶æ•°æ®æ›´é€šç”¨çš„æ•°å­¦æ¡†æ¶ã€‚åœ°éœ‡å­¦ä¸­ï¼Œæ—¶é—´ç‚¹è¿‡ç¨‹å¹¿æ³›ç”¨ç”¨åœ¨å»ºæ¨¡åœ°éœ‡å’Œä½™éœ‡ä¸Šé¢ã€‚æ¯ä¸ªåœ°éœ‡è¡¨ç¤ºæ—¶ç©ºç©ºé—´ä¸­çš„ä¸€ä¸ªç‚¹ï¼Œåœ°éœ‡å­¦å·²ç»æå‡ºä¸åŒçš„å…¬å¼æ¥æ•è·è¿™äº›äº‹ä»¶çš„éšæœºæ€§ã€‚é‡‘èé¢†åŸŸï¼Œæ—¶é—´ç‚¹è¿‡ç¨‹æ˜¯ç»æµå­¦çš„æ´»è·ƒæ–¹å‘ï¼Œå¯ä»¥ç»™å‡ºç°ä»£é‡‘èå¸‚åœºå¤æ‚åŠ¨æ€æ€§çš„ä¸€äº›ç®€ç­”è§£é‡Šã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å®é™…ä¸­å…¸å‹çš„è¿™äº›ç‚¹è¿‡ç¨‹æ¨¡å‹çš„å‡è®¾ä¸€èˆ¬åšä¸åˆ°ï¼Œè€Œä¸”è¿™äº›æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›æœ‰é™ã€‚æˆ‘ä»¬æå‡ºäº†æ–°çš„markedæ—¶é—´ç‚¹è¿‡ç¨‹æ¨¡å‹ï¼ŒRMTPPï¼ŒåŒæ­¥å»ºæ¨¡äº‹ä»¶çš„äº‹ä»¶å’Œæ ‡è®°ã€‚æˆ‘ä»¬æ–¹æ³•çš„æ ¸å¿ƒæ˜¯å°†ä¸€ä¸ªæ—¶é—´ç‚¹è¿‡ç¨‹çš„intensity functionçœ‹ä½œæ˜¯ä¸€ä¸ªå†å²è¿‡ç¨‹çš„éçº¿æ€§å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ç”¨RNNè¡¨ç¤ºã€‚&lt;/p&gt;
&lt;h1 id="2-é—®é¢˜å®šä¹‰"&gt;2. é—®é¢˜å®šä¹‰
&lt;/h1&gt;&lt;p&gt;ä¸€ç»„åºåˆ— $\mathcal{C} = { S^1, S^2, \dots, }$&lt;/p&gt;
&lt;p&gt;åºåˆ— $\mathcal{S}^i = ((t^i_1, y^i_1), (t^i_2, y^i_2), \dots)$ æ˜¯$(t^i_j, y^i_j)$ç»„æˆçš„åºåˆ—ï¼Œ$t^i_j$æ˜¯äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ï¼Œ$y^i_j$æ˜¯äº‹ä»¶çš„ç±»åˆ«ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»™å®šå®ä½“$i$ï¼Œé¢„æµ‹ä¸‹ä¸€ä¸ªäº‹ä»¶pair $(t^i_{n+1}, y^i_{n+1})$&lt;/li&gt;
&lt;li&gt;è®¡ç®—ä¸€ä¸ªç»™å®šåºåˆ—çš„likelihood&lt;/li&gt;
&lt;li&gt;é€šè¿‡å­¦ä¹ å¾—åˆ°çš„æ¨¡å‹æ¨¡æ‹Ÿä¸€ä¸ªæ–°çš„åºåˆ—&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="3-related-work"&gt;3. Related Work
&lt;/h1&gt;&lt;p&gt;ç°å­˜å·¥ä½œçš„ä¸€ä¸ªä¸»è¦çš„é™åˆ¶å°±æ˜¯å¯¹latent dynamicsçš„å„ç§å‚æ•°å‡è®¾ï¼Œlatent dynamicsæ§åˆ¶äº†è§‚æµ‹åˆ°çš„ç‚¹è¿‡ç¨‹çš„ç”Ÿæˆã€‚&lt;/p&gt;
&lt;h1 id="4-marked-temporal-point-process"&gt;4. Marked Temporal Point Process
&lt;/h1&gt;&lt;p&gt;è¿™ä¸ªç¬¬å››èŠ‚ä¸»è¦ä»‹ç»äº†ä¹‹å‰çš„ä¸€äº›ç‚¹è¿‡ç¨‹ä½¿ç”¨çš„æ¡ä»¶å¼ºåº¦å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ ‡è®°æ—¶é—´ç‚¹è¿‡ç¨‹æ˜¯ä¸€ä¸ªå¯¹è§‚æµ‹åˆ°çš„éšæ—¶é—´å‘ç”Ÿçš„éšæœºäº‹ä»¶æ¨¡å¼è¿›è¡Œå»ºæ¨¡çš„å¼ºæœ‰åŠ›å·¥å…·ã€‚å› ä¸ºä¸€ä¸ªäº‹ä»¶çš„å‡ºç°ä¸å†å²å‘ç”Ÿäº†ä»€ä¹ˆæœ‰å…³ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸€äº›æ¨¡å‹ï¼Œç»™å®šæˆ‘ä»¬å·²çŸ¥çš„è¿‡å»ï¼Œå¯¹ä¸‹ä¸€ä¸ªäº‹ä»¶å»ºæ¨¡ã€‚ä¸¥æ ¼æ¥è®²ï¼Œä¸€ä¸ªæ ‡è®°æ—¶é—´ç‚¹è¿‡ç¨‹æ˜¯ä¸€ä¸ªéšæœºè¿‡ç¨‹ï¼Œè¿™ä¸ªéšæœºè¿‡ç¨‹åŒ…å«äº†ä¸€ä¸ªå¸¦æœ‰æ—¶é—´ä¿¡æ¯çš„ç¦»æ•£äº‹ä»¶çš„åˆ—è¡¨ï¼Œ${ t_j, y_j }$ï¼Œ$t_j \in \mathbb{R}^+, y_j \in \mathcal{Y}, j \in \mathbb{Z}^+$ï¼Œ$t$æ˜¯æ—¶é—´ï¼Œ$y$æ˜¯æ ‡è®°ã€‚å†å² $\mathcal{H}_t$ æ˜¯ç›´åˆ°æ—¶é—´$t$çš„äº‹ä»¶æ—¶é—´å’Œæ ‡è®°ç»„æˆçš„listã€‚è¿ç»­äº‹ä»¶æ—¶é—´ä¹‹é—´çš„æ—¶é—´å·® $d_{j+1} = t_{j+1} - t_j$ ç§°ä¸ºäº‹ä»¶é—´çš„durationã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®šè¿‡å»äº‹ä»¶çš„å†å²ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸‹ä¸€ä¸ªäº‹ä»¶ç±»å‹$y$åœ¨æ—¶é—´$t$å‘ç”Ÿçš„æ¡ä»¶å¯†åº¦å‡½æ•°ä¸º $f^{\ast}(t, y) = f(t, y \mid \mathcal{H}_t)$ï¼Œ$f^{\ast}(t, y)$å¼ºè°ƒäº†è¿™ä¸ªå¯†åº¦æ˜¯åŸºäºå†å²çš„è¿™ä¸ªæ¡ä»¶ã€‚åˆ©ç”¨é“¾å¼æ³•åˆ™ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªåºåˆ—çš„è”åˆä¼¼ç„¶ä¸ºï¼š&lt;/p&gt;
$$
\tag{1} f(\{ (t\_j, y\_j) \}^n\_{j=1}) = \prod\_j f(t\_j, y\_j \mid \mathcal{H}\_t) = \prod\_j f^{\ast}(t\_j, y\_j)
$$&lt;p&gt;$f^{\ast}(t_j, y_j)$ æœ‰å¾ˆå¤šç§å½¢å¼å¯ä»¥é€‰æ‹©ã€‚ä½†æ˜¯å®é™…ä¸­äººä»¬ä¸€èˆ¬é€‰æ‹©éå¸¸ç®€å•å¯åˆ†è§£çš„å½¢å¼ï¼Œæ¯”å¦‚$f(t_j, y_j \mid \mathcal{H}_t) = f(y_j) f(t_j \mid \dots, t_{j-2}, t_{j-1})$ï¼Œè¦ä¸ç„¶å¯¹äº‹ä»¶æ ‡è®°å’Œæ—¶é—´è¿›è¡Œè”åˆå»ºæ¨¡ä¼šéå¸¸å¤æ‚ã€‚æˆ‘ä»¬å¯ä»¥è®¤ä¸ºåœ¨$y_j$åªå¯å–æœ‰é™ä¸ªå€¼ä¸”ä¸å†å²å®Œå…¨æ— å…³çš„æ—¶å€™ï¼Œ$f(y_j)$æ˜¯ä¸€ä¸ªå¤šé¡¹å¼åˆ†å¸ƒã€‚$f(t_j \mid \dots, t_{j-2}, t_{j-1})$æ˜¯ç»™å®šè¿‡å»äº‹ä»¶çš„æ—¶é—´çš„åºåˆ—æ—¶ï¼Œäº‹ä»¶å‘ç”Ÿåœ¨$t_j$çš„æ¡ä»¶å¯†åº¦ã€‚è€Œä¸”éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ$f^{\ast}(t_j)$ä¸èƒ½æ•è·è¿‡å»äº‹ä»¶æ ‡è®°çš„å½±å“ã€‚&lt;/p&gt;
&lt;h2 id="41-parametrizations"&gt;4.1 Parametrizations
&lt;/h2&gt;&lt;p&gt;ä¸€ä¸ªæ ‡è®°ç‚¹è¿‡ç¨‹çš„æ—¶é—´ä¿¡æ¯å¯ä»¥é€šè¿‡ä¸€ä¸ªå…¸å‹çš„æ—¶é—´ç‚¹è¿‡ç¨‹æ¥æ•è·ã€‚ä¸€ä¸ªåˆ»ç”»æ—¶é—´ç‚¹è¿‡ç¨‹çš„é‡è¦æ–¹å¼æ˜¯é€šè¿‡æ¡ä»¶å¼ºåº¦å‡½æ•°â€”â€”ç»™å®šè¿‡å»æ‰€æœ‰äº‹ä»¶ï¼Œå¯¹ä¸‹ä¸€ä¸ªäº‹ä»¶å»ºæ¨¡çš„éšæœºæ¨¡å‹ã€‚åœ¨ä¸€ä¸ªå°çš„æ—¶é—´çª—å£$[t, t + dt)$é‡Œï¼Œ$\lambda^{\ast}(t)dt$æ˜¯ä¸€ä¸ªæ–°äº‹ä»¶åœ¨ç»™å®šå†å²$\mathcal{H}_t$æ—¶å‡ºç°çš„æ¦‚ç‡ï¼š&lt;/p&gt;
$$
\tag{2} \lambda^{\ast}(t)dt = \mathbb{P}\{ \text{event in }[t, t+dt) \mid \mathcal{H}\_t \}
$$&lt;p&gt;$\ast$æ˜¯ç”¨æ¥æé†’æˆ‘ä»¬è¿™ä¸ªå‡½æ•°æ˜¯ä¾èµ–å†å²çš„ã€‚ç»™å®šæ¡ä»¶å¯†åº¦å‡½æ•°$f^{\ast}(t)$ï¼Œæ¡ä»¶å¼ºåº¦å‡½æ•°ä¸ºï¼š&lt;/p&gt;
$$
\tag{3} \lambda^{\ast}(t)dt = \frac{f^{\ast}(t)dt}{S^{\ast}(t)} = \frac{f^{\ast}(t)dt}{1 - F^{\ast}(t)},
$$&lt;p&gt;$F^{\ast}(t)$æ˜¯åœ¨æœ€åä¸€ä¸ªäº‹ä»¶æ—¶é—´$t_n$ä¹‹åï¼Œä¸€ä¸ªæ–°äº‹ä»¶å‘ç”Ÿåœ¨$t$ä¹‹å‰çš„ç´¯ç§¯æ¦‚ç‡ï¼Œ$S^{\ast}(t) = \text{exp}(- \int^t_{t_n} \lambda^{\ast}(\tau) d\tau)$ æ˜¯$t_n$åˆ°$t$ä¹‹é—´æ²¡æœ‰æ–°äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ã€‚å› æ­¤æ¡ä»¶å¯†åº¦å‡½æ•°å¯ä»¥å†™æˆï¼š&lt;/p&gt;
$$
\tag{4} f^{\ast}(t) = \lambda^{\ast}(t) \text{exp}(- \int^t\_{t\_n} \lambda^{\ast}(\tau) d\tau).
$$&lt;h1 id="5-recurrent-marked-temporal-point-process"&gt;5. Recurrent Marked Temporal Point Process
&lt;/h1&gt;&lt;p&gt;æ¡ä»¶å¼ºåº¦å‡½æ•°çš„å½¢å¼å†³å®šäº†ä¸€ç±»ç‚¹è¿‡ç¨‹çš„äº‹ä»¶æ€§è´¨ã€‚ä½†æ˜¯ï¼Œä¸ºäº†è€ƒè™‘markerå’Œäº‹ä»¶ä¿¡æ¯ï¼Œåœ¨ç¼ºå°‘å‰æ²¿çŸ¥è¯†çš„æƒ…å†µä¸‹å¾ˆéš¾å†³å®šä½¿ç”¨å“ªç§å½¢å¼çš„æ¡ä»¶å¼ºåº¦å‡½æ•°ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…æå‡ºäº†ä¸€ä¸ªç»Ÿä¸€çš„æ¨¡å‹ï¼Œå¯ä»¥åœ¨å†å²çš„äº‹ä»¶å’Œmarkerä¿¡æ¯ä¸Šå¯¹éçº¿æ€§ä¾èµ–å»ºæ¨¡çš„æ¨¡å‹ã€‚&lt;/p&gt;
&lt;h2 id="51-model-formulation"&gt;5.1 Model Formulation
&lt;/h2&gt;&lt;p&gt;å…¬å¼5ï¼Œ6ï¼Œ7æœ‰ä¸åŒçš„è¡¨è¾¾å½¢å¼ï¼Œè€Œä¸”æ˜¯å¯¹è¿‡å»äº‹ä»¶ä¸åŒç±»å‹çš„ä¾èµ–ç»“æ„ã€‚å—åˆ°è¿™ä¸€ç‚¹çš„å¯å‘ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å­¦ä¹ åˆ°ä¸€ä¸ªè¶‹è¿‘äºå†å²æœªçŸ¥ä¾èµ–ç»“æ„çš„é€šç”¨è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/recurrent-marked-temporal-point-processes-embedding-event-history-to-vector/Fig2.jpg"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„æƒ³æ³•æ˜¯ç”¨RNNæ¥å®ç°è¿™ä¸€æ­¥ã€‚å¦‚å›¾2æ‰€ç¤ºï¼ŒRNNåœ¨æ—¶é—´æ­¥$t_j$çš„è¾“å…¥æ˜¯$(t_j, y_j)$ã€‚$y_i$æ˜¯äº‹ä»¶çš„ç±»å‹ã€‚$h_{j-1}$è¡¨ç¤ºä»è¿‡å»äº‹ä»¶å’Œäº‹ä»¶å¾—åˆ°çš„å½±å“çš„memoryï¼Œåœ¨æ›´æ–°çš„æ—¶å€™ä¼šè€ƒè™‘å½“å‰çš„äº‹ä»¶å’Œæ—¶é—´ã€‚å› ä¸º$h_j$è¡¨ç¤ºè¿‡å»ä¸€ç›´åˆ°ç¬¬$j$ä¸ªäº‹ä»¶çš„å½±å“ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªäº‹ä»¶æ—¶é—´çš„æ¡ä»¶å¼ºåº¦å‡½æ•°å°±å¯ä»¥è¡¨ç¤ºä¸ºï¼š&lt;/p&gt;
$$
\tag{8} f^{\ast}(t\_{j + 1}) = f(t\_{j+1} \mid \mathcal{H}\_t) = f(t\_{j+1} \mid h\_j) = f(d\_{j + 1} \mid h\_j),
$$&lt;p&gt;$d_{j+1} = t_{j+1} - t_j$ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨$h_j$å»é¢„æµ‹æ—¶é—´$\hat{t}_{j + 1}$å’Œä¸‹ä¸€äº‹ä»¶ç±»å‹$\hat{y}_{j + 1}$ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå…¬å¼çš„å¥½å¤„æ˜¯æˆ‘ä»¬å°†å†å²äº‹ä»¶åµŒå…¥åˆ°äº†ä¸€ä¸ªéšå‘é‡ç©ºé—´ï¼Œç„¶åé€šè¿‡å…¬å¼4ï¼Œæˆ‘ä»¬ä¸ç”¨æŒ‡å®šä¸€ä¸ªå›ºå®šçš„å‚æ•°å½¢å¼æ¥å»ºæ¨¡å†å²çš„ä¾èµ–ç»“æ„ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªæ›´ç®€å•çš„å½¢å¼å¾—åˆ°æ¡ä»¶å¼ºåº¦å‡½æ•°$\lambda^{\ast}(t)$ã€‚å›¾3å±•ç¤ºäº†RMTPPæ¨¡å‹çš„æ¶æ„ã€‚ç»™å®šä¸€ä¸ªäº‹ä»¶åºåˆ—$\mathcal{S} = ((t_j, y_j)^n_{j=1})$ï¼Œé€šè¿‡è¿­ä»£ä»¥ä¸‹ç»„ä»¶ï¼Œå¾—åˆ°ä¸€ä¸ªéšè—å•å…ƒ${ h_j }$çš„åºåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Input Layer&lt;/strong&gt;ï¼Œå…ˆç”¨ä¸€ä¸ªinput layerå¯¹one-hotçš„äº‹ä»¶è¡¨ç¤ºè¿›è¡ŒæŠ•å½±ã€‚$y_j = W^T_{em} y_j + b_{em}$ã€‚ç„¶åäº‹ä»¶æ­¥$t_j$ä¹ŸæŠ•å½±æˆä¸€ä¸ªå‘é‡$t_j$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/recurrent-marked-temporal-point-processes-embedding-event-history-to-vector/Fig3.jpg"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hidden Layer&lt;/strong&gt;&lt;/p&gt;
$$
\tag{9} h\_j = \text{max} \{ W^y y\_j + W^t t\_j + W^h h\_{j-1} + b\_h, 0 \}
$$&lt;p&gt;&lt;strong&gt;Marker Generation&lt;/strong&gt;ï¼Œç»™å®šè¡¨ç¤º$h_j$ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå¤šé¡¹å¼åˆ†å¸ƒå»ºæ¨¡markerçš„ç”Ÿæˆï¼š&lt;/p&gt;
$$
\tag{10} P(y\_{j+1} = k \mid h\_j) = \frac{ \text{exp}(V^y\_{k,:} h\_j + b^y\_k) }{ \sum^K\_{k=1} \text{exp} ( V^y\_{k,:} h\_j + b^y\_k ) },
$$&lt;p&gt;$K$æ˜¯markerçš„ä¸ªæ•°ï¼Œ$V^y_{k,:}$æ˜¯çŸ©é˜µ$V^y$çš„ç¬¬$k$è¡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Conditional Intensity&lt;/strong&gt;ï¼ŒåŸºäº$h_j$ï¼Œå¯ä»¥å¾—åˆ°æ¡ä»¶å¼ºåº¦å‡½æ•°ï¼š&lt;/p&gt;
$$
\tag{11} \lambda^{\ast}(t) = \text{exp}( \mathcal{v}^{t^T} \cdot h\_j + w^t (t - t\_j) + b^t ),
$$&lt;p&gt;$\mathcal{v}^t$æ˜¯ä¸€ä¸ªåˆ—å‘é‡ï¼Œ$w^t, b^t$æ˜¯æ ‡é‡ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€é¡¹ $\mathcal{v}^{t^T} \cdot h_j$ è¡¨ç¤ºè¿‡å»çš„äº‹ä»¶å’Œæ—¶é—´ä¿¡æ¯ç´¯ç§¯çš„å½±å“ã€‚å¯¹æ¯”å…¬å¼5ï¼Œ6ï¼Œ7å¯¹è¿‡å»å½±å“å›ºå®šçš„å…¬å¼ï¼Œç°åœ¨è¿™ä¸ªæ˜¯å¯¹è¿‡å»å½±å“çš„é«˜åº¦éçº¿æ€§é€šç”¨è¡¨ç¤ºã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒé¡¹å¼ºè°ƒå½“å‰äº‹ä»¶$j$çš„å½±å“ã€‚&lt;/li&gt;
&lt;li&gt;æœ€åä¸€é¡¹å¯¹ä¸‹ä¸€ä¸ªäº‹ä»¶çš„å‡ºç°ç»™äº†ä¸€ä¸ªåŸºç¡€çš„å¼ºåº¦ç­‰çº§ã€‚&lt;/li&gt;
&lt;li&gt;æŒ‡æ•°å‡½æ•°æ˜¯ä¸€ä¸ªéçº¿æ€§å‡½æ•°ï¼Œä¸”ä¿è¯å¼ºåº¦æ°¸è¿œæ˜¯æ­£çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€šè¿‡å…¬å¼4ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ç»™å®šå†å²çš„æƒ…å†µä¸‹ï¼Œä¸‹ä¸€ä¸ªäº‹ä»¶åœ¨æ—¶é—´$t$å‡ºç°çš„likelihoodï¼š&lt;/p&gt;
$$
\tag{12} f^{\ast}(t) = \lambda^{\ast}(t) \text{exp}( - \int^t\_{t\_j} \lambda^{\ast}(\tau) d\tau) \ = \text{exp} \{ \mathcal{v}^{t^T} \cdot h\_j + w^t (t - t\_j) + b^t + \frac{1}{w} \text{exp}(\mathcal{v}^{t^T} + b^t) \ - \frac{1}{w} \text{exp}(\mathcal{v}^{t^T} \cdot h\_j + w^t(t - t\_j) + b^t) \}
$$&lt;p&gt;ç„¶åï¼Œä¸‹ä¸€ä¸ªäº‹ä»¶çš„æ—¶é—´å¯ä»¥ç”¨æœŸæœ›æ¥è®¡ç®—&lt;/p&gt;
$$
\tag{13} \hat{t}\_{j+1} = \int^\infty\_{t\_j} t \cdot f^{\ast}(t) dt.
$$&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼Œå…¬å¼13çš„ç§¯åˆ†æ²¡æœ‰è§£æè§£ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨&lt;/p&gt;
\[32\]&lt;p&gt;çš„ç”¨äºä¸€ç»´å‡½æ•°çš„æ•°å€¼ç§¯åˆ†æŠ€æœ¯æ¥è®¡ç®—å…¬å¼13ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Remark&lt;/strong&gt;ã€‚å› ä¸ºæˆ‘ä»¬ç”¨RNNè¡¨ç¤ºå†å²ï¼Œæ‰€ä»¥æ¡ä»¶å¼ºåº¦å‡½æ•°$\lambda^{\ast}(t_{j+1})$çš„å…¬å¼11ï¼Œæ•è·äº†è¿‡å»äº‹ä»¶å’Œæ—¶é—´ä¸¤éƒ¨åˆ†ä¿¡æ¯ã€‚å¦ä¸€æ–¹é¢ï¼Œå› ä¸ºmarkerçš„é¢„æµ‹ä¹Ÿä¾èµ–äºè¿‡å»çš„æ—¶é—´ä¿¡æ¯ï¼Œå½“æ—¶é—´å’Œäº‹ä»¶ä¿¡æ¯ç›¸äº’å…³è”çš„æ—¶å€™ï¼Œå°±å¯ä»¥æå‡æ¨¡å‹çš„æ€§èƒ½ã€‚åé¢çš„å®éªŒè¯æ˜äº†è¿™ç§äº’ç›¸æå‡çš„ç°è±¡ç¡®å®å­˜åœ¨ã€‚&lt;/p&gt;
&lt;h2 id="52-å‚æ•°å­¦ä¹ "&gt;5.2 å‚æ•°å­¦ä¹ 
&lt;/h2&gt;&lt;p&gt;æœ€å¤§å¯¹æ•°ä¼¼ç„¶&lt;/p&gt;
$$
\tag{14} \ell(\{\mathcal{S}^i \}) = \sum\_i \sum\_j (\text{log} P(y^i\_{j+1} \mid h\_j) + \text{log} f(d^i\_{j+1} \mid h\_j) ),
$$&lt;p&gt;$\mathcal{C} = { \mathcal{S}^i }$æ˜¯ä¸€ç»„åºåˆ—, $\mathcal{S}^i = ((t^i_j, y^i_j)^{n_i}_{j=1})$ã€‚ç”¨BPTTè®­ç»ƒã€‚&lt;/p&gt;</description></item><item><title>Time-dependent representation for neural event sequence prediction</title><link>https://davidham3.github.io/blog/p/time-dependent-representation-for-neural-event-sequence-prediction/</link><pubDate>Wed, 27 Apr 2022 15:37:58 +0000</pubDate><guid>https://davidham3.github.io/blog/p/time-dependent-representation-for-neural-event-sequence-prediction/</guid><description>&lt;p&gt;ICLR 2018 workshop, &lt;a class="link" href="https://arxiv.org/abs/1708.00065" target="_blank" rel="noopener"
&gt;Time-dependent representation for neural event sequence prediction&lt;/a&gt;ã€‚äº‹ä»¶åºåˆ—çš„è¡¨ç¤ºå­¦ä¹ æ¨¡å‹ã€‚ä¸»è¦æ˜¯å¯¹äº‹ä»¶çš„åµŒå…¥è¡¨ç¤ºæœ‰äº†ä¸€äº›åˆ›æ–°ï¼ŒåŠ å…¥äº†å¯¹äº‹ä»¶durationçš„è€ƒè™‘ã€‚æ¨¡å‹æ•´ä½“è¿˜æ˜¯RNNæ¶æ„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/time-dependent-representation-for-neural-event-sequence-prediction/Fig1.jpg"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨äº‹ä»¶åºåˆ—ä¸­ï¼Œæœ‰ä¸¤ä¸ªæ—¶é—´æ®µ(time span)ï¼Œä¸€ä¸ªæ˜¯durationï¼Œäº‹ä»¶çš„æŒç»­æ—¶é•¿ï¼Œå¦ä¸€ä¸ªæ˜¯intervalï¼Œäº‹ä»¶ä¸äº‹ä»¶ä¹‹é—´çš„é—´éš”ã€‚ä¸ºäº†ç»Ÿä¸€è¿™ä¸¤ä¸ªæ—¶é—´æ®µï¼Œä½œè€…å°†intervalçœ‹ä½œæ˜¯ä¸€ä¸ªç©ºé—²äº‹ä»¶(idle event)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/time-dependent-representation-for-neural-event-sequence-prediction/Fig2.jpg"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;å›¾2æ˜¯æ¨¡å‹æ¶æ„ï¼Œå°±æ˜¯æŠŠäº‹ä»¶åšåµŒå…¥è¡¨ç¤ºï¼Œç„¶åæŠŠdurationè€ƒè™‘è¿›å»ï¼Œå¾—åˆ°äº‹ä»¶åºåˆ—é‡Œé¢æ¯ä¸ªæ—¶é—´æ­¥çš„åµŒå…¥è¡¨ç¤ºï¼Œç„¶åä¸¢åˆ°RNNé‡Œé¢ï¼Œæœ€åæ˜¯è¦é¢„æµ‹ä¸‹ä¸€ä¸ªeventæ˜¯ä»€ä¹ˆï¼ŒåŒæ—¶å¯ä»¥æŠŠä¸‹ä¸€ä¸ªeventçš„durationæ‹¿è¿›æ¥è®¡ç®—æŸå¤±ï¼Œèµ·åˆ°ä¸€ä¸ªæ­£åˆ™çš„ä½œç”¨ã€‚&lt;/p&gt;
&lt;h2 id="31-contextualizing-event-embedding-with-time-mask"&gt;3.1 Contextualizing Event Embedding With Time Mask
&lt;/h2&gt;&lt;p&gt;è¿™é‡Œæœ‰ä¸€ä¸ªè§‚ç‚¹ï¼Œå°±æ˜¯åœ¨æœºå™¨ç¿»è¯‘ä¸­ï¼ŒRNNä¼šèŠ±ä¸€å®šçš„capacityå»åŒºåˆ†ä¸åŒcontextä¸‹ä¸€ä¸ªè¯çš„æ„æ€ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒChoi et al., 2016 æå‡ºäº†ä¸€ä¸ªmaskè®¡ç®—ã€‚æœ¬æ–‡å€ŸåŠ©è¿™ä¸ªæ€æƒ³ï¼Œæå‡ºäº†ä¸€ä¸ªæ—¶é—´ä¾èµ–çš„åµŒå…¥è¡¨ç¤ºã€‚&lt;/p&gt;
$$
\tag{1} c^d = \phi (\log(d\_t);\theta)
$$&lt;p&gt;ä¸Šå¼æ˜¯ä¸€ä¸ªFNNï¼Œ$\phi$æ˜¯éçº¿æ€§å˜æ¢ï¼Œå‚æ•°æ˜¯$\theta$ã€‚åŠ å¯¹æ•°æ˜¯ä¸ºäº†é™ä½$d_t$çš„èŒƒå›´ã€‚ç„¶åç”¨ä¸€ä¸ªå•å±‚sigmoidçš„éçº¿æ€§å˜æ¢æŠŠ$c^d$æ˜ å°„åˆ°$m^d \in \mathbb{R}^E$ä¸Šï¼Œè¿™ä¸ªå°±æ˜¯maskã€‚&lt;/p&gt;
$$
\tag{2} m\_d = \sigma(c^d W\_d + b\_d)
$$&lt;p&gt;ç„¶å&lt;/p&gt;
$$
\tag{3} x\_t \leftarrow x\_t \odot m\_d
$$&lt;p&gt;æŠŠmaskå’Œä¸€ä¸ªäº‹ä»¶çš„embeddingç›¸ä¹˜ï¼Œelement-wise productionï¼Œè¿™ä¸ªä¸œè¥¿æ”¾å…¥RNNã€‚&lt;/p&gt;
&lt;h2 id="32-event-time-joint-embedding"&gt;3.2 Event-Time Joint Embedding
&lt;/h2&gt;&lt;p&gt;è¿™é‡Œæœ‰ä¸ªè§‚ç‚¹ï¼Œæˆ‘ä»¬å¹³æ—¶åªä¼šè¯´â€œå’Œè°ç®€å•åœ°èŠäº†ä¸€ä¼šå„¿â€ï¼Œä¸ä¼šè¯´å…·ä½“èŠäº†å¤šå°‘åˆ†é’Ÿã€‚æˆ‘ä»¬å¯¹äºäº‹ä»¶æ—¶é•¿çš„æ„Ÿå—ä¾èµ–äº‹ä»¶çš„ç±»å‹ã€‚åŸºäºè¿™ä¸ªç›´è§‰ï¼Œæˆ‘ä»¬ç”¨äº†ä¸€ä¸ªsort one-hotåµŒå…¥è¡¨ç¤ºï¼Œåšäº†ä¸€ä¸ªäº‹ä»¶çš„è”åˆè¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæŠŠäº‹ä»¶æ—¶é•¿æ˜ å°„åˆ°ä¸€ä¸ªå‘é‡ä¸Šå»&lt;/p&gt;
$$
\tag{4} p^d = d\_t W\_d + b\_d \in \mathbb{R}^P
$$&lt;p&gt;ç„¶ååœ¨è¿™ä¸ªå‘é‡ä¸Šé¢åšä¸€ä¸ªsoftmaxè¿ç®—&lt;/p&gt;
$$
\tag{5} s^d\_i = \frac{\exp(p^d\_i)}{\sum^P\_{k=1} \exp(p^d\_k)}
$$&lt;p&gt;ç„¶ååšä¸€ä¸ªçº¿æ€§å˜æ¢&lt;/p&gt;
$$
\tag{6} g\_d = s^d E^s \in \mathbb{R}^E
$$&lt;p&gt;ç„¶åæŠŠäº‹ä»¶åµŒå…¥å’Œè¿™ä¸ªæ—¶é—´åµŒå…¥æ±‚å¹³å‡ï¼Œå¾—åˆ°äº‹ä»¶åµŒå…¥è¡¨ç¤ºï¼š&lt;/p&gt;
$$
\tag{7} x\_t \leftarrow \frac{x\_t + g\_d}{2} \in \mathbb{R}^E
$$&lt;h1 id="4-next-event-duration-as-a-regularizer"&gt;4 Next Event Duration as A Regularizer
&lt;/h1&gt;&lt;p&gt;è¿™é‡Œè®¨è®ºçš„æ˜¯é€šè¿‡è®©æ¨¡å‹å»é¢„æµ‹ä¸‹ä¸€äº‹ä»¶çš„æ—¶é•¿æ¥å¢å¼ºæ¨¡å‹ã€‚è¿™ä¸ªæ—¶é•¿æ˜¯é€šè¿‡å¯¹RNNå¾ªç¯å±‚åšçº¿æ€§å˜æ¢å¾—åˆ°çš„ã€‚å¯¹äºæ—¶é—´æ­¥$t$ï¼Œæ¥è¯´ï¼Œéœ€è¦é¢„æµ‹çš„durationæ˜¯$dâ€™_{t+1}$ã€‚å®ƒçš„æŸå¤±å›ä¼ åä¼šèµ·åˆ°ä¸€ä¸ªæ­£åˆ™çš„ä½œç”¨ã€‚è€Œä¸”å¯ä»¥å¯¹äº‹ä»¶é¢„æµ‹è¾“å‡ºå±‚è·¯å¾„ä¸Šçš„å¤šä¸ªå±‚è¿›è¡Œæ­£åˆ™ã€‚&lt;/p&gt;
&lt;h2 id="41-negative-log-lieklihood-of-time-prediction-error"&gt;4.1 Negative Log Lieklihood of Time Prediction Error
&lt;/h2&gt;&lt;p&gt;è¿™é‡Œè¯´ï¼Œå¯¹äºè¿ç»­å€¼çš„é¢„æµ‹ï¼Œä¸€èˆ¬ç”¨MSEï¼Œä½†æ˜¯MSEè¿™ä¸ªæŒ‡æ ‡éœ€è¦å’Œäº‹ä»¶é¢„æµ‹çš„æŸå¤±åœ¨åŒä¸€ä¸ªæ•°é‡çº§ä¸Šã€‚è€Œäº‹ä»¶æŸå¤±ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªlogå½¢å¼çš„æŸå¤±ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªæ•°ä¼šæ¯”è¾ƒå°ã€‚Hinton &amp;amp; van Camp, 1993ç ”ç©¶è¯æ˜æœ€å°åŒ–å¹³æ–¹æŸå¤±å¯ä»¥å†™æˆæœ€å¤§åŒ–0å‡å€¼é«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦ï¼Œè€Œä¸”ä¸éœ€è¦durationæœä»é«˜æ–¯åˆ†å¸ƒï¼Œä½†æ˜¯é¢„æµ‹è¯¯å·®éœ€è¦ã€‚å› æ­¤æ­£åˆ™é¡¹è¦åšä¸€ä¸ªæ ‡å‡†åŒ–ï¼Œ&lt;/p&gt;
$$
\tag{8} R^N\_t = \frac{(d'\_{t+1} - d\_{t+1})^2}{2\sigma^2\_i}
$$&lt;p&gt;$\sigma_i$æ˜¯é€šè¿‡è®­ç»ƒé›†çš„durationç®—å‡ºæ¥çš„ï¼Œç„¶ååœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡æ—¶é•¿é¢„æµ‹è¯¯å·®çš„åˆ†å¸ƒæ¥æ›´æ–°ã€‚&lt;/p&gt;
&lt;h2 id="42-cross-entropy-loss-on-time-projection"&gt;4.2 Cross Entropy Loss on Time Projection
&lt;/h2&gt;&lt;p&gt;è¿™é‡Œè¯´ï¼Œå¯¹äºæ—¶é•¿çš„æŸå¤±è®¡ç®—è¿˜å¯ä»¥ç”¨softmaxã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸º3.2èŠ‚æåˆ°äº†ä¸€ä¸ªæŠŠè¿ç»­å€¼æ˜ å°„åˆ°å‘é‡ç©ºé—´çš„åŠæ³•ï¼Œä½¿ç”¨åŒæ ·çš„åŠæ³•å¯ä»¥è®¡ç®—å¦ä¸€ç§æŸå¤±ï¼š&lt;/p&gt;
$$
\tag{9} R^X\_t = - \sum^P\_{k=1} Proj\_k (d\_{t+1}) \log{Proj\_k (d'\_{t+1})}
$$&lt;p&gt;$Proj$å°±æ˜¯å…¬å¼4å’Œ5å®šä¹‰çš„æŠ•å½±å‡½æ•°ï¼Œ$Proj_k$æ˜¯æŠ•å½±å‘é‡ä¸­çš„ç¬¬$k$é¡¹ã€‚å½“3.2èŠ‚çš„äº‹ä»¶ä¸æ—¶é—´çš„è”åˆåµŒå…¥è¡¨ç¤ºå’Œè¿™ä¸ªæŸå¤±éƒ½ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠæŠ•å½±å‡½æ•°çš„æƒé‡å…±äº«ã€‚&lt;/p&gt;
&lt;h1 id="5-experiments"&gt;5 Experiments
&lt;/h1&gt;&lt;p&gt;ç”¨äº†5ä¸ªæ•°æ®é›†ã€‚&lt;/p&gt;
&lt;h2 id="51-æ•°æ®é¢„å¤„ç†"&gt;5.1 æ•°æ®é¢„å¤„ç†
&lt;/h2&gt;&lt;p&gt;åšäº†ä¸€äº›ç‰¹åˆ«ç¨€æœ‰çš„äº‹ä»¶çš„è¿‡æ»¤ã€‚æœ‰äº›äº‹ä»¶å°‘äº5æ¬¡çš„ç”¨OOVä»£æ›¿äº†ã€‚ä½¿ç”¨MAP@Kå’ŒPrecision@Kæ¥è¯„ä¼°ã€‚&lt;/p&gt;
&lt;p&gt;è®­ç»ƒã€éªŒè¯ã€æµ‹è¯•çš„æ¯”ä¾‹æ˜¯8:1:1&lt;/p&gt;
&lt;h2 id="52-æ¨¡å‹é…ç½®"&gt;5.2 æ¨¡å‹é…ç½®
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;NoTime: å°±ç”¨ä¸€ä¸ªç®€å•çš„LSTM&lt;/li&gt;
&lt;li&gt;TimeConcat: æŠŠdurationåšlogå˜æ¢ï¼Œä¸äº‹ä»¶åµŒå…¥è¡¨ç¤ºæ‹¼æ¥ï¼Œè¾“å…¥RNN&lt;/li&gt;
&lt;li&gt;TimeMask: 3.1èŠ‚çš„æ–¹æ³•&lt;/li&gt;
&lt;li&gt;TimeJoint: 3.2èŠ‚çš„æ–¹æ³•&lt;/li&gt;
&lt;li&gt;RMTPP: &lt;a class="link" href="https://www.kdd.org/kdd2016/papers/files/rpp1081-duA.pdf" target="_blank" rel="noopener"
&gt;RMTPP&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="54-å®éªŒç»“æœ"&gt;5.4 å®éªŒç»“æœ
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/time-dependent-representation-for-neural-event-sequence-prediction/Fig3.jpg"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;Effectiveness of Temporal Representation: å›¾3å±•ç¤ºå‡ºäº†TimeMaskå’ŒTimeJointçš„æœ‰æ•ˆæ€§ã€‚MIMIC IIæ•°æ®é›†ä¸Šé¢æ²¡æ•ˆæœï¼Œå¯èƒ½æ˜¯åŠ æ—¶é—´æœ¬æ¥å°±æ²¡å•¥ç”¨ã€‚ç»“è®ºå°±æ˜¯ï¼Œç”¨è¿™ä¸¤ä¸ªä¸œè¥¿è‚¯å®šæ¯”åªåŠ æ—¶é—´çš„å€¼åˆ°RNNé‡Œé¢è¦æœ‰æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/time-dependent-representation-for-neural-event-sequence-prediction/Table1_2.jpg"
loading="lazy"
alt="Table 1 &amp; 2"
&gt;&lt;/p&gt;
&lt;p&gt;è¡¨1å’Œè¡¨2ä¹Ÿè¯æ˜äº†åŠ å…¥æ—¶é—´çš„æœ‰æ•ˆæ€§ã€‚è€Œä¸”æœ‰äº›æ—¶å€™ç›´æ¥åŠ æ—¶é—´å¯èƒ½ä¼šä¼¤å®³æ¨¡å‹çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;Effectiveness of Event Duration Regularization: è¡¨1å’Œè¡¨2è¯æ˜äº†æ­£åˆ™çš„æœ‰æ•ˆæ€§ã€‚&lt;/p&gt;
&lt;p&gt;Learned Time Representation: è¿™æ®µè¯´çš„ä¸æ˜æ‰€ä»¥ï¼Œè®ºæ–‡é‡Œé¢è¿˜æœ‰é”™è¯¯ï¼Œå›¾ç”»çš„ä¹Ÿä¸æ¸…æ™°ï¼Œæ²¡æ‡‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/time-dependent-representation-for-neural-event-sequence-prediction/Fig4.jpg"
loading="lazy"
alt="Figure4"
&gt;&lt;/p&gt;</description></item><item><title>Event sequence metric learning</title><link>https://davidham3.github.io/blog/p/event-sequence-metric-learning/</link><pubDate>Tue, 26 Apr 2022 14:38:05 +0000</pubDate><guid>https://davidham3.github.io/blog/p/event-sequence-metric-learning/</guid><description>&lt;p&gt;è¿™æ˜¯ä¸€ç¯‡è®²äº‹ä»¶åºåˆ—åº¦é‡å­¦ä¹ çš„æ–‡ç« ï¼Œæå‡ºçš„æ¨¡å‹å«MeLESï¼ŒMetric Learning for Event Sequencesã€‚&lt;a class="link" href="https://arxiv.org/abs/2002.08232" target="_blank" rel="noopener"
&gt;Event sequence metric learning&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;äº‹ä»¶åºåˆ—ä¸»è¦æ˜¯æŒ‡è¿ç»­æ—¶é—´ä¸‹çš„ç¦»æ•£äº‹ä»¶ã€‚æ¯”å¦‚ç”¨æˆ·çš„ä¿¡ç”¨å¡äº¤æ˜“ã€åœ¨ç½‘ç«™ä¸Šçš„ç‚¹å‡»è¡Œä¸ºç­‰ç­‰ã€‚&lt;/p&gt;
&lt;h1 id="1-æ¨¡å‹æ¶æ„"&gt;1. æ¨¡å‹æ¶æ„
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/event-sequence-metric-learning/Fig1.jpg"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;h1 id="2-åŸç†"&gt;2. åŸç†
&lt;/h1&gt;&lt;h2 id="21-æ ·æœ¬æ„æˆ"&gt;2.1 æ ·æœ¬æ„æˆ
&lt;/h2&gt;&lt;p&gt;æ¯ $N$ ä¸ªåºåˆ—æ„æˆä¸€ä¸ªbatchï¼Œå¯¹è¿™ä¸ªbatchå†…çš„åºåˆ—è¿›è¡Œåˆ‡åˆ†ï¼Œæœ‰ä¸‰ç§åˆ‡åˆ†æ–¹å¼ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¿æŒäº‹ä»¶é¡ºåºï¼Œéšæœºä¸æ”¾å›é‡‡æ ·&lt;/li&gt;
&lt;li&gt;éšæœºåˆ‡åˆ†åºåˆ—ï¼Œå­åºåˆ—ä¹‹é—´ä¸é‡å &lt;/li&gt;
&lt;li&gt;éšæœºåˆ‡åˆ†åºåˆ—ï¼Œå­åºåˆ—ä¹‹é—´é‡å &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ç®¡æ€ä¹ˆåˆ‡ï¼Œéƒ½èƒ½æŠŠä¸€ä¸ªåºåˆ—åˆ‡æˆå¤šä¸ªå­åºåˆ—ï¼Œè¿™é‡Œå°†æ¯ä¸ªåºåˆ—åˆ‡æˆ $K$ ä¸ªå­åºåˆ—ï¼Œé‚£ä¹ˆä¸€ä¸ªbatchå°±å¯ä»¥å¾—åˆ° $N \times K$ ä¸ªå­åºåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™äº›å­åºåˆ—ä¸­ï¼Œæ¥è‡ªåŒä¸€ä¸ªåºåˆ—çš„ä¸¤ä¸ªå­åºåˆ—ç»„æˆçš„pairï¼Œä¸ºæ­£æ ·æœ¬ï¼Œæ¥è‡ªä¸åŒåºåˆ—çš„ä¸¤ä¸ªå­åºåˆ—ç»„æˆçš„pairä¸ºè´Ÿæ ·æœ¬ã€‚è¿™æ ·ï¼Œå¯¹äºæ¯ä¸ªå­åºåˆ—ï¼Œå°±æœ‰ $K - 1$ ä¸ªæ­£æ ·æœ¬ï¼Œ$(N - 1) \times K$ ä¸ªè´Ÿæ ·æœ¬ã€‚&lt;/p&gt;
&lt;h2 id="22-åºåˆ—è¡¨ç¤º"&gt;2.2 åºåˆ—è¡¨ç¤º
&lt;/h2&gt;&lt;p&gt;ç„¶åä½¿ç”¨RNNæˆ–è€…æ˜¯transformerå¯¹å­åºåˆ—è¿›è¡Œç¼–ç ï¼Œç¼–ç åå¯ä»¥å¾—åˆ°ä¸€ä¸ªå‘é‡ï¼Œè¿™ä¸ªå‘é‡å°±æ˜¯è¿™ä¸ªå­åºåˆ—çš„åµŒå…¥è¡¨ç¤ºã€‚æ‹¿åˆ°è¿™ä¸ªè¡¨ç¤ºï¼Œå°±å¯ä»¥è®¡ç®—æŸå¤±äº†ã€‚&lt;/p&gt;
&lt;h2 id="23-æŸå¤±"&gt;2.3 æŸå¤±
&lt;/h2&gt;&lt;p&gt;è®¡ç®—æŸå¤±çš„æ—¶å€™ï¼Œæœ€ç®€å•çš„æƒ³æ³•è‚¯å®šå°±æ˜¯ç±»ä¼¼äº¤å‰ç†µä¸€æ ·çš„æŸå¤±ï¼Œæ­£æ ·æœ¬çš„æŸå¤±åŠ ä¸Šè´Ÿæ ·æœ¬çš„æŸå¤±å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ä¹‹å‰çš„ç ”ç©¶è®¤ä¸ºï¼Œæœ‰äº›åµŒå…¥è¡¨ç¤ºï¼Œä»–ä»¬çš„è·ç¦»è¿‡äºè¿œï¼Œè¿™ç§æ ·æœ¬å¯¹æ¨¡å‹è®­ç»ƒæ²¡ä»€ä¹ˆç”¨ï¼Œå› æ­¤æœ¬æ–‡ç»™äº†ä¸¤ä¸ªæŸå¤±å‡½æ•°æ¥å‰”é™¤è¿™ç§æƒ…å†µã€‚ä¸€ä¸ªå«contrastive lossï¼Œä¸€ä¸ªå«margin lossï¼ŒåŸç†éƒ½æ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/event-sequence-metric-learning/loss.jpg"
loading="lazy"
alt="loss"
&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºcontrastive lossæ¥è¯´ï¼Œæ­£æ ·æœ¬çš„æŸå¤±æ­£å¸¸è®¡ç®—ï¼Œè€Œè´Ÿæ ·æœ¬çš„æŸå¤±ï¼Œå¦‚æœpairä¸­çš„ä¸¤ä¸ªè¡¨ç¤ºçš„è·ç¦»å¤§äº $m$ ï¼Œå°±ä¸è¦äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºmargin lossæ˜¯åŒæ ·çš„åŸç†ï¼Œ$b + m$ å’Œ $b - m$ æ„æˆäº†æŸå¤±å‡½æ•°çš„è¾¹ç•Œï¼Œæ­£æ ·æœ¬çš„è·ç¦»è¦å¤§äº $b - m$ æ‰æœ‰æ„ä¹‰ï¼Œè€Œè´Ÿæ ·æœ¬çš„è·ç¦»è¦å°äº $b + m$ æ‰æœ‰æ„ä¹‰ã€‚è€Œä¸”ï¼Œå½“ $b &amp;lt; m$ çš„æ—¶å€™ï¼Œè¿™ä¸ªæŸå¤±å°±ä¼šå˜å¾—å’Œä¸Šé¢çš„contrastive lossä¸€æ ·ï¼Œåªè€ƒè™‘è´Ÿæ ·æœ¬çš„marginï¼Œå› ä¸ºåªè¦è·ç¦»æ˜¯æ¬§å¼è·ç¦»ï¼Œåœ¨ä»»ä½•æƒ…å†µä¸‹ $max(0, D^i_W - b + m) = D^i_W - b + m &amp;gt; 0$ã€‚&lt;/p&gt;
&lt;h2 id="24-è´Ÿæ ·æœ¬é‡‡æ ·ç­–ç•¥"&gt;2.4 è´Ÿæ ·æœ¬é‡‡æ ·ç­–ç•¥
&lt;/h2&gt;&lt;p&gt;ç„¶åï¼Œé™¤äº†ä¸Šè¿°çš„æŸå¤±å‡½æ•°å¯ä»¥æ§åˆ¶ä¸¤ä¸ªè·ç¦»è¿‡è¿œçš„è´Ÿæ ·æœ¬ä¸è®¡ç®—æŸå¤±ï¼Œè¿˜å¯ä»¥åšè´Ÿæ ·æœ¬é‡‡æ ·ï¼Œä¹Ÿå°±æ˜¯åˆšæ‰è¯´çš„ $(N - 1) \times K$ ä¸ªè´Ÿæ ·æœ¬ï¼Œåªå–å‡ºä¸€éƒ¨åˆ†ç”¨æ¥è®­ç»ƒã€‚è¿™é‡Œæœ‰4ç§æ–¹å¼ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;éšæœºé‡‡æ ·&lt;/li&gt;
&lt;li&gt;éš¾ä¾‹æŒ–æ˜ï¼Œå¯¹æ¯ä¸ªæ•´ç†ç”Ÿæˆ$k$ä¸ªéš¾ä¾‹ä½œä¸ºè´Ÿæ ·æœ¬&lt;/li&gt;
&lt;li&gt;è´Ÿæ ·æœ¬é‡‡æ ·çš„æ—¶å€™è€ƒè™‘è·ç¦»å› ç´ &lt;/li&gt;
&lt;li&gt;ç¬¬å››ä¸ªæ²¡çœ‹æ˜ç™½ä»–åœ¨è¯´å•¥ï¼Œå€’æ˜¯ç»™äº†ä¸ªå‚è€ƒæ–‡çŒ®ï¼šFlorian Schroff, Dmitry Kalenichenko, and James Philbin. 2015. FaceNet: A&lt;br&gt;
unified embedding for face recognition and clustering. 2015 IEEE Conference on&lt;br&gt;
Computer Vision and Pattern Recognition (CVPR) (2015), 815â€“823.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ç®¡æ˜¯ä¸Šè¿°å“ªç§è´Ÿé‡‡æ ·æ–¹æ¡ˆï¼Œé™¤äº†ç¬¬ä¸€ç§ï¼Œéƒ½æ˜¯è¦ç®—è·ç¦»çš„ï¼Œä¹Ÿå°±æ˜¯ç®—ä¸¤ä¸ªembeddingä¹‹é—´çš„è·ç¦»ã€‚è€Œä¸”æ˜¯è¦ç®—batchå†…ä»»æ„ä¸¤ä¸ªembeddingä¹‹é—´çš„è·ç¦»ï¼Œæˆ–è€…è¯´æ˜¯ç®— $(N - 1) \times K$ ä¸ªè·ç¦»ã€‚å¦‚æœç”¨æ¬§æ°è·ç¦»è®¡ç®—åµŒå…¥ $A$ å’Œ $B$ ä¹‹é—´çš„è·ç¦»ï¼Œé‚£ä¹ˆ $D(A, B) = \sqrt{\sum_i (A_i - B_i)^2} = \sqrt{\sum_i A^2_i + \sum_i B^2_i - 2 \sum_i A_i B_i}$ï¼Œè¿™é‡Œä¸ºäº†è®¡ç®—ç®€ä¾¿ï¼Œåªè¦è®© $\Vert A \Vert = \Vert B \Vert = 1$ å°±å¥½äº†ï¼Œé‚£å°±èƒ½è½¬æ¢æˆ $D(A, B) = \sqrt{2 - 2(A \cdot B)}$ã€‚æ‰€ä»¥ï¼Œä¸ºäº†è¾¾æˆä¸Šé¢çš„ç›®æ ‡ï¼Œè®© $A$ å’Œ $B$ çš„æ¨¡ç­‰äº1ï¼Œåªè¦å¯¹è¿™äº›åµŒå…¥è¡¨ç¤ºåšæ ‡å‡†åŒ–ï¼Œå°±å¯ä»¥å®ç°äº†ã€‚è®ºæ–‡é‡Œé¢è¯´ï¼Œåšäº†è¿™ä¸ªæ“ä½œä¹‹åï¼Œè´Ÿæ ·æœ¬é‡‡æ ·çš„è®¡ç®—å¤æ‚åº¦æ˜¯ $O(n^2h)$ï¼Œè¿™ä¸ªæˆ‘è¿˜æ²¡æƒ³æ˜ç™½ï¼Œåé¢å†è¯´å§ã€‚&lt;/p&gt;
&lt;h1 id="3-å®éªŒ"&gt;3. å®éªŒ
&lt;/h1&gt;&lt;p&gt;ä¸¤ä¸ªæ•°æ®é›†éƒ½æ˜¯é“¶è¡Œäº¤æ˜“æ•°æ®ï¼Œä¸»è¦æ˜¯é€šè¿‡äº¤æ˜“äº‹ä»¶åºåˆ—é¢„æµ‹ç”¨æˆ·çš„å¹´é¾„ä¸æ€§åˆ«ã€‚&lt;/p&gt;
&lt;h2 id="31-baselines"&gt;3.1 Baselines
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ‰‹å·¥ç‰¹å¾+GBMï¼Œæ‰‹å·¥æ„å»ºäº†è¿‘1kä¸ªç‰¹å¾ï¼Œç„¶åç”¨LightGBMã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Contrastive Predictive Coding(CPC)ï¼Œä¸€ä¸ªè‡ªç›‘ç£å­¦ä¹ æ–¹æ³•ï¼ŒAÃ¤ron van den Oord, Yazhe Li, and Oriol Vinyals. 2018. Representation&lt;br&gt;
Learning with Contrastive Predictive Coding. CoRR abs/1807.03748 (2018).&lt;br&gt;
arXiv:1807.03748 &lt;a class="link" href="http://arxiv.org/abs/1807.03748" target="_blank" rel="noopener"
&gt;http://arxiv.org/abs/1807.03748&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é™¤äº†ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•ï¼Œä½œè€…è¿˜è¯•äº†ç¼–ç å™¨ç½‘ç»œ+åˆ†ç±»ç½‘ç»œç›´æ¥ç”¨äºç›‘ç£å­¦ä¹ ä»»åŠ¡ï¼Œè¿™é‡Œå°±æ²¡æœ‰é¢„è®­ç»ƒäº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="32-å‚æ•°é€‰æ‹©"&gt;3.2 å‚æ•°é€‰æ‹©
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/event-sequence-metric-learning/Table4_to_7.jpg"
loading="lazy"
alt="result"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šé¢4ä¸ªè¡¨çš„ç»“è®ºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸åŒç¼–ç å™¨æ•ˆæœä¸åŒ&lt;/li&gt;
&lt;li&gt;åœ¨è®­ç»ƒé›†ä¸Šè¡¨ç°æœ€å¥½çš„æŸå¤±å‡½æ•°åœ¨æµ‹è¯•é›†ä¸Šä¸ä¸€å®šæ˜¯æœ€å¥½çš„&lt;/li&gt;
&lt;li&gt;éšæœºsliceæ¯”éšæœºé‡‡æ ·æ›´å¥½&lt;/li&gt;
&lt;li&gt;éš¾ä¾‹æŒ–æ˜å¸¦æ¥çš„æå‡æ˜¯æ˜¾è‘—çš„ï¼ˆä½†æ˜¯è®ºæ–‡å‰è¾¹æ ¹æœ¬æ²¡ä»”ç»†ä»‹ç»éš¾ä¾‹æŒ–æ˜å¥½å§ã€‚ã€‚ã€‚ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/event-sequence-metric-learning/Fig2.jpg"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;å›¾2æ˜¯è¯´åµŒå…¥åœ¨800ç»´çš„æ—¶å€™æ•ˆæœæœ€å¥½ï¼Œç”¨bias-varianceæ¥è§£é‡Šã€‚ç»´æ•°å°‘çš„æ—¶å€™é«˜biasï¼Œä¿¡æ¯ä¸¢å¤±ï¼Œç»´æ•°é«˜çš„æ—¶å€™é«˜varianceï¼Œå™ªå£°å¤šäº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/event-sequence-metric-learning/Fig3.jpg"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;å›¾3ä¸€æ ·ï¼Œ256åˆ°2048æ¯”è¾ƒå¹³ç¼“ï¼Œä¸‹æ¸¸ä»»åŠ¡çš„æ•ˆæœæ²¡æœ‰æ˜æ˜¾å¢å¼ºã€‚&lt;/p&gt;
&lt;p&gt;ä½œè€…è¯´åµŒå…¥ç»´æ•°çš„å¢åŠ ï¼Œè®­ç»ƒæ—¶é—´å’Œæ˜¾å­˜æ¶ˆè€—éƒ½æ˜¯çº¿æ€§å¢åŠ çš„ã€‚&lt;/p&gt;
&lt;h2 id="33-åµŒå…¥å¯è§†åŒ–"&gt;3.3 åµŒå…¥å¯è§†åŒ–
&lt;/h2&gt;&lt;p&gt;tSNEï¼ŒæŸ“è‰²æ˜¯ç”¨æ•°æ®é›†ä¸­çš„target valueæŸ“è‰²çš„ã€‚å­¦ä¹ å®Œå…¨æ˜¯è‡ªç›‘ç£çš„ã€‚äº¤æ˜“åºåˆ—è¡¨ç¤ºçš„æ˜¯ç”¨æˆ·çš„è¡Œä¸ºï¼Œå› æ­¤æ¨¡å‹å¯ä»¥æ•è·è¡Œä¸ºæ¨¡å¼ï¼Œäº§å‡ºçš„embeddingå¦‚æœç›¸è¿‘ï¼Œåˆ™è¯´æ˜ç”¨æˆ·çš„è¡Œä¸ºæ¨¡å¼ç›¸ä¼¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/event-sequence-metric-learning/Fig4.jpg"
loading="lazy"
alt="Figure4"
&gt;&lt;/p&gt;
&lt;h2 id="34-ç»“æœ"&gt;3.4 ç»“æœ
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/event-sequence-metric-learning/Table8.jpg"
loading="lazy"
alt="Table8"
&gt;&lt;/p&gt;
&lt;p&gt;å¯¹æ¯”æ‰‹å·¥æ„å»ºçš„ç‰¹å¾ï¼Œæ¨¡å‹æ•ˆæœå¼ºåŠ²ã€‚fine-tunedçš„è¡¨ç¤ºæ•ˆæœæœ€å¥½ã€‚å¦å¤–å¯ä»¥çœ‹åˆ°çš„æ˜¯ï¼Œä½¿ç”¨æ‰‹å·¥ç‰¹å¾+äº‹ä»¶åºåˆ—åµŒå…¥è¡¨ç¤ºçš„æ¨¡å‹æ•ˆæœæ¯”çº¯æ‰‹å·¥ç‰¹å¾æ•ˆæœæ›´å¥½ã€‚&lt;/p&gt;
&lt;h3 id="341-å…³äºåŠç›‘ç£çš„å®éªŒ"&gt;3.4.1 å…³äºåŠç›‘ç£çš„å®éªŒ
&lt;/h3&gt;&lt;p&gt;åªå–äº†ä¸€éƒ¨åˆ†æ ‡ç­¾åšå®éªŒï¼Œå°±åƒç›‘ç£å­¦ä¹ ä¸€æ ·ç”¨æ‰‹å·¥ç‰¹å¾çš„lightgbmå’ŒCPCã€‚å¯¹äºåµŒå…¥ç”Ÿæˆæ–¹æ³•ï¼ˆMeLESå’ŒCPCï¼‰ï¼Œåˆ†åˆ«ä½¿ç”¨lightgbmå’Œfine-tunedæ¨¡å‹æ¥è¯„ä¼°æ•ˆæœã€‚åŒæ—¶è¿˜æ¯”äº†ç›‘ç£æ¨¡å‹åœ¨è¿™äº›labelä¸Šçš„æ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/event-sequence-metric-learning/Fig5.jpg"
loading="lazy"
alt="Figure5"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/event-sequence-metric-learning/Fig6.jpg"
loading="lazy"
alt="Figure6"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/event-sequence-metric-learning/Fig78.jpg"
loading="lazy"
alt="Figure7_and_Figure8"
&gt;&lt;/p&gt;
&lt;p&gt;ç»“è®ºå°±æ˜¯æ ‡ç­¾å°‘çš„æ—¶å€™ï¼Œæ•ˆæœå¾ˆå¥½ã€‚&lt;/p&gt;
&lt;h1 id="4-ç»“è®º"&gt;4. ç»“è®º
&lt;/h1&gt;&lt;p&gt;æå‡ºäº†MeLESï¼Œæ•ˆæœå¾ˆå¥½ï¼Œè€Œä¸”è¿˜å¯ä»¥åœ¨åŠç›‘ç£ä¸­åšé¢„è®­ç»ƒã€‚å¥½å¤„æ˜¯åŸºæœ¬ä¸ç”¨æ€ä¹ˆå¯¹æ•°æ®åšå¤„ç†å°±å¯ä»¥æ‹¿åˆ°åµŒå…¥è¡¨ç¤ºï¼Œè·å¾—å¥½çš„æ•ˆæœã€‚è€Œä¸”åœ¨æ–°çš„äº‹ä»¶åŠ å…¥çš„æ—¶å€™ï¼Œç”šè‡³æ˜¯å¯ä»¥å¢é‡æ›´æ–°å·²ç»è®¡ç®—çš„åµŒå…¥è¡¨ç¤ºã€‚å¦ä¸€æ–¹é¢æ˜¯åµŒå…¥è¡¨ç¤ºæ— æ³•è¿˜åŸåŸå§‹çš„äº‹ä»¶åºåˆ—ï¼Œå¯ä»¥èµ·åˆ°æ•°æ®åŠ å¯†çš„ä½œç”¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæåˆ°çš„å¢é‡æ›´æ–°å…¶å®å°±æ˜¯ï¼ŒRNNçš„è®¡ç®—åªè¦ä¸Šä¸€ä¸ªæ—¶é—´æ­¥çš„ä¿¡æ¯å°±å¥½äº†ï¼Œä¸éœ€è¦ä»å¤´å†è®­ç»ƒä¸€æ¬¡ï¼Œå› æ­¤å¦‚æœæœ‰æ–°çš„äº‹ä»¶åˆ°æ¥ï¼Œä»æœ€åä¸€æ¬¡çš„çŠ¶æ€å¼€å§‹ç®—å°±å¥½äº†ï¼Œè¿™å°±å«å¢é‡æ›´æ–°ã€‚&lt;/p&gt;</description></item><item><title>Archives</title><link>https://davidham3.github.io/blog/archives/</link><pubDate>Sun, 06 Mar 2022 00:00:00 +0000</pubDate><guid>https://davidham3.github.io/blog/archives/</guid><description/></item><item><title>åšå®¢é‡è£…...</title><link>https://davidham3.github.io/blog/p/%E5%8D%9A%E5%AE%A2%E9%87%8D%E8%A3%85.../</link><pubDate>Thu, 14 May 2020 12:00:28 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E5%8D%9A%E5%AE%A2%E9%87%8D%E8%A3%85.../</guid><description>&lt;p&gt;æœ€è¿‘åˆé‡è£…äº†ä¸€ä¸‹ç³»ç»Ÿï¼Œä¹‹å‰åšå®¢æ˜¯åœ¨Windowsä¸‹é¢çš„ï¼Œæœ€è¿‘æˆ‘æŠŠé‚£ä¸ªWindowsç³»ç»Ÿåˆ äº†ï¼Œå…ˆåœ¨OSXä¸Šé¢ç”¨ä¸€æ®µæ—¶é—´ã€‚ä½†æ˜¯å‘ç°æ•´ä¸ªåšå®¢çš„ç¨‹åºè¿‘ä¹æŠ¥åºŸï¼Œå›¾ç‰‡åŠ è½½ä¸äº†ï¼Œå…¬å¼æ˜¾ç¤ºä¸äº†ã€‚ã€‚ã€‚ç„¶åå¼€å§‹ä¸€æ­¥ä¸€æ­¥ä¿®ç†ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é‡è£… node&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è£… hexo&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œåœ¨é‡Œé¢ &lt;code&gt;hexo init&lt;/code&gt;ï¼Œåˆ é™¤ post é‡Œé¢çš„ hello world&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æŠŠåŸæ¥åšå®¢çš„_config.yml, scaffolds, source, themesï¼Œè¿™å››ä¸ªä¸œè¥¿å¤åˆ¶åˆ°æ–°çš„ blog é‡Œé¢&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;hexo clean &amp;amp;&amp;amp; hexo s -g&lt;/code&gt; æœ¬åœ°å¯åŠ¨ä¸€ä¸‹åšå®¢ï¼Œè¿›å…¥ blog é‡Œé¢çœ‹çœ‹æœ‰ä»€ä¹ˆé”™è¯¯æç¤ºï¼Œç¼ºä»€ä¹ˆæ’ä»¶å°±è£…ä»€ä¹ˆæ’ä»¶&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¸è½½é»˜è®¤çš„ render: &lt;code&gt;npm un hexo-renderer-marked -save&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®‰è£…æ–°çš„ render: &lt;code&gt;npm install hexo-renderer-kramed --save&lt;/code&gt;ï¼Œç„¶åä¿®æ”¹ node_modules\kramed\lib\rules\inline.js&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;//escape: /^\\([\\`*{}\[\]()#$+\-.!\_&amp;gt;])/,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;escape: /^\\([`*\[\]()#$+\-.!_&amp;gt;])/,
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;//em: /^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;em: /^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;npm install https://github.com/7ym0n/hexo-asset-image --sa&lt;/code&gt;ï¼Œè£…è¿™ä¸ªä¿®æ­£åçš„å›¾ç‰‡å·¥å…·&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç„¶åè¦å†™ä¸€ä¸ªç¨‹åºï¼ŒæŠŠæ‰€æœ‰æ–‡ç« é‡Œé¢çš„ &lt;code&gt;![Figure2](Fig2.png)&lt;/code&gt; è¿™ä¸ª markdown æ’å…¥å›¾ç‰‡çš„è¯­æ³•ï¼Œæ¢æˆ &lt;code&gt;\{\% asset_img Fig2.png Figure2 \%\}&lt;/code&gt;ï¼Œè¿™é‡Œéœ€è¦æŠŠæˆ‘è‡ªå·±åŠ çš„è¿™å››ä¸ªåæ–œæ &amp;quot;&amp;quot;å»æ‰ï¼Œæˆ‘è¿™é‡ŒåŠ ä¸Šæ˜¯å› ä¸ºå¦‚æœä¸åŠ çš„è¯ï¼Œè¿™é‡Œå°±å˜æˆå›¾ç‰‡äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆå¤‡ä»½å¥½åšå®¢ï¼Œç„¶åè¿è¡Œä¸‹é¢çš„ä»£ç å³å¯ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;re&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;folder&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;source/_posts/&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;pattern&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;!\[(.*?)\]\((.*?)\)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;fname&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;folder&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;fname&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;endswith&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.md&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;folder&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fname&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;markdown_pics&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;findall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pattern&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;desc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pic_name&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;markdown_pics&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;original_str&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;![&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;](&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;)&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;desc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pic_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;desc&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;desc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#34;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;desc&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#34;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;pic_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pic_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#34;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;pic_name&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#34;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;target_str&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;{![&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;](/blog/images/åšå®¢é‡è£…/&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;)}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pic_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;desc&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;original_str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target_str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fname&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;original_str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target_str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç„¶åå°±OKäº†ï¼Œå¿ƒæƒ…èˆ’ç•…~&lt;/p&gt;</description></item><item><title>Neural Collaborative Filtering</title><link>https://davidham3.github.io/blog/p/neural-collaborative-filtering/</link><pubDate>Wed, 13 May 2020 17:07:14 +0000</pubDate><guid>https://davidham3.github.io/blog/p/neural-collaborative-filtering/</guid><description>&lt;p&gt;ã€ŠNeural Collaborative Filteringã€‹WWW 2017ã€‚è¿™ç¯‡è®ºæ–‡ä½¿ç”¨å…¨è¿æ¥ç¥ç»ç½‘ç»œå®ç°äº†ä¸€ä¸ªçŸ©é˜µåˆ†è§£çš„æ¨èç³»ç»Ÿã€‚ç»™å®šä¸€ä¸ªuserçš„ç‰¹å¾è¡¨ç¤ºï¼Œç»™å®šä¸€ä¸ªitemçš„ç‰¹å¾è¡¨ç¤ºï¼Œé€šè¿‡ç¥ç»ç½‘ç»œè¾“å‡ºç”¨æˆ·å¯¹è¿™ä¸ªitemæ„Ÿå…´è¶£çš„åˆ†æ•°ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1708.05031" target="_blank" rel="noopener"
&gt;Neural Collaborative Filtering&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘çœ‹äº†çœ‹æ¨èç³»ç»Ÿï¼Œè¿™ç¯‡è®ºæ–‡æå‡ºäº†ä¸€ä¸ª NeuMF çš„æ¨¡å‹ï¼ŒåŸºäºå…¨è¿æ¥å±‚çš„ä¸€ä¸ªæ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;æ¨¡å‹å¾ˆç®€å•ï¼Œä¸»è¦åˆ†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªGMFéƒ¨åˆ†ï¼Œä¸€ä¸ªMLPéƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h1 id="generalized-matrix-factorization-gmf"&gt;Generalized Matrix Factorization (GMF)
&lt;/h1&gt;&lt;p&gt;è¿™ä¸ªéƒ¨åˆ†æ˜¯ user çš„ç‰¹å¾å‘é‡ä¸ item çš„ç‰¹å¾å‘é‡åš element-wise productã€‚&lt;/p&gt;
&lt;h1 id="multi-layer-perceptron-mlp"&gt;Multi-Layer Perceptron (MLP)
&lt;/h1&gt;&lt;p&gt;å¤šå±‚æ„ŸçŸ¥æœºéƒ¨åˆ†å°±æ˜¯å°† user å’Œ item çš„ç‰¹å¾å‘é‡æ‹¼æ¥ï¼Œç„¶åæ”¾åˆ°å¤šå±‚å…¨è¿æ¥é‡Œé¢ã€‚&lt;/p&gt;
&lt;h1 id="neumf"&gt;NeuMF
&lt;/h1&gt;&lt;p&gt;æœ€åå°†è¿™ä¸¤ä¸ªæ¨¡å—çš„è¾“å‡ºæ‹¼æ¥ï¼Œç„¶åä¸¢åˆ°ä¸€ä¸ªå…¨è¿æ¥å±‚é‡Œé¢ï¼Œæ˜ å°„åˆ°ç›®æ ‡çš„åˆ†æ•°ï¼Œ0åˆ°1ï¼Œç„¶åä½¿ç”¨å¯¹æ•°æŸå¤±ï¼Œè®­ç»ƒå³å¯ã€‚&lt;/p&gt;
&lt;h1 id="experiments"&gt;Experiments
&lt;/h1&gt;&lt;p&gt;å®éªŒéƒ¨åˆ†ï¼Œæ•°æ®é›†çš„åˆ’åˆ†æ˜¯ï¼Œæ‹¿åˆ°ç”¨æˆ·æ‰€æœ‰çš„æ­£ä¾‹åï¼Œå¯¹æ¯ä¸ªç”¨æˆ·ï¼Œéšæœºå–ä¸€ä¸ªä½œä¸ºæµ‹è¯•é›†è¦é¢„æµ‹çš„æ­£ä¾‹ã€‚ç„¶åå–ä¸€å®šæ•°é‡çš„è´Ÿæ ·æœ¬ä½œä¸ºæµ‹è¯•é›†çš„è´Ÿä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä»–çš„æ­£ä¾‹ä½œä¸ºè®­ç»ƒé›†çš„æ­£ä¾‹ï¼Œè®­ç»ƒçš„æ—¶å€™é€šè¿‡é‡‡æ ·çš„æ–¹å¼å–è´Ÿæ ·æœ¬ä¸¢åˆ°ç½‘ç»œä¸­è®­ç»ƒã€‚&lt;/p&gt;
&lt;p&gt;è¯„ä»·æŒ‡æ ‡æœ‰ä¸¤ä¸ªï¼šHit Ratio å’Œ Normalized Discounted Cumulative Gainã€‚&lt;/p&gt;
&lt;p&gt;æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸Šè¿°çš„â€œä¸€å®šæ•°é‡çš„è´Ÿæ ·æœ¬ä½œä¸ºæµ‹è¯•é›†çš„è´Ÿä¾‹â€ï¼Œè¿™ä¸ªâ€œä¸€å®šæ•°é‡â€å–999ï¼Œé‚£ä¹ˆæµ‹è¯•é›†é‡Œé¢æ¯ä¸ªç”¨æˆ·å°±æœ‰1000ä¸ªæ ·æœ¬ï¼Œå› ä¸ºè¿˜è¦åŠ é‚£ä¸€ä¸ªæ­£ä¾‹ã€‚è®©æ¨¡å‹å¯¹è¿™1000ä¸ªæ ·æœ¬è¿›è¡Œé¢„æµ‹ï¼Œé¢„æµ‹å‡º1000ä¸ªåˆ†æ•°ï¼Œå– top10ã€‚å¦‚æœè¿™æœ€å¤§çš„10ä¸ªåˆ†æ•°å¯¹åº”çš„ item ä¸­ï¼Œæœ‰é‚£ä¸ªæ­£ä¾‹ï¼Œè¯´æ˜æˆ‘ä»¬çš„æ¨¡å‹åœ¨1000ä¸ª item ä¸­ï¼Œé¢„æµ‹å‡ºçš„å‰ååé‡Œé¢æˆåŠŸå‘½ä¸­é‚£ä¸ªæ­£ä¾‹äº†ï¼Œé‚£è¿™ä¸ªç”¨æˆ·çš„ hit rate å°±ä¸º1ï¼Œå¦åˆ™ä¸º0ï¼Œç„¶åç®—æ‰€æœ‰ç”¨æˆ·çš„å¹³å‡å€¼å³å¯ï¼Œå°±æ˜¯ hit ratioã€‚&lt;/p&gt;
&lt;p&gt;NDCG çš„æŒ‡æ ‡è®¡ç®—æˆ‘è¿˜æ²¡æœ‰ç ”ç©¶ï¼Œç­‰ç ”ç©¶åå†å†™ã€‚æ¨¡å‹çš„ä»£ç çœ‹äº† mxnet å®˜æ–¹æä¾›çš„ exampleï¼š&lt;a class="link" href="https://github.com/apache/incubator-mxnet/tree/master/example/neural_collaborative_filtering" target="_blank" rel="noopener"
&gt;NeuMF&lt;/a&gt;ï¼Œé€Ÿåº¦å¾ˆå¿«ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“çš„å®éªŒç»“æœï¼Œæˆ‘åœ¨æˆ‘è‡ªå·±ç”¨çˆ¬è™«æŠ“çš„ä¸€ä¸ªæ•°æ®é›†ä¸Šçœ‹ï¼Œæ•ˆæœæ²¡æœ‰ implicit è¿™ä¸ªåº“é‡Œé¢çš„ als æ•ˆæœå¥½ã€‚ALS çš„ HR@10 èƒ½è·‘åˆ°51%ï¼Œæˆ‘è‡ªå·±å®ç°çš„ NeuMF åªèƒ½è·‘åˆ°48%ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ user å’Œ item çš„ id ä½œä¸ºç‰¹å¾ã€‚ä½†æ˜¯ NeuMF ç›¸æ¯” ALS çš„ä¸€ä¸ªä¼˜åŠ¿æ˜¯å¯ä»¥åŠ å…¥ user å’Œ item çš„å…¶ä»–ç‰¹å¾ä¿¡æ¯ï¼Œæ•ˆæœå¯èƒ½ä¼šæ›´å¥½ä¸€ç‚¹ï¼Œè¿˜éœ€è¦è¿›ä¸€æ­¥å®éªŒè®ºè¯ã€‚&lt;/p&gt;</description></item><item><title>è®°ä¸€æ¬¡pysparkæ€§èƒ½æå‡ï¼Œnp.frombufferçš„ä½¿ç”¨</title><link>https://davidham3.github.io/blog/p/%E8%AE%B0%E4%B8%80%E6%AC%A1pyspark%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87np.frombuffer%E7%9A%84%E4%BD%BF%E7%94%A8/</link><pubDate>Thu, 13 Feb 2020 00:12:07 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E8%AE%B0%E4%B8%80%E6%AC%A1pyspark%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87np.frombuffer%E7%9A%84%E4%BD%BF%E7%94%A8/</guid><description>&lt;p&gt;ä¹‹å‰é¡¹ç›®ä¸­æœ‰ä¸ªä»»åŠ¡æ˜¯è¯»å–ä¸€å †äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯¹äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œè§£æï¼Œç„¶åå­˜åˆ°HBaseã€‚ç”±äºæœ‰ .mat æ–‡ä»¶ï¼Œæ•´ä¸ª spark éƒ½ç”¨ pyspark å†™æ¥ç€ï¼Œä¹Ÿæ²¡ç”¨ scalaã€‚æœ€è¿‘å¤©å¤©éƒ½åœ¨å†™æ–‡æ¡£å•¥çš„ï¼Œè¿˜å¾—å†™æ¯•ä¸šè®ºæ–‡ï¼Œè§‰å¾—å¤ªæ²¡åŠ²äº†å°±ç ”ç©¶äº†ä¸€ä¸‹ä¼˜åŒ–çš„é—®é¢˜ï¼Œé¡ºä¾¿æ›´æ–°ä¸‹åšå®¢ï¼Œå¥½ä¹…æ²¡æ›´æ–°äº†ã€‚&lt;/p&gt;
&lt;p&gt;åŸæ¥çš„æ•°æ®æ ¼å¼å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸€å † float ç±»å‹çš„æ•°å­—ï¼Œè½¬æˆäº†äºŒè¿›åˆ¶çš„å½¢å¼ï¼Œæ¯ 4 ä¸ªå­—èŠ‚ä¸€ä¸ªæ•°ï¼Œè¿ç»­åœ°å†™åˆ°äº†æ–‡ä»¶é‡Œé¢ã€‚å› ä¸ºæ–‡ä»¶å¾ˆå¤šï¼Œè€Œä¸”è¦å­˜åˆ° HBaseï¼Œå°±é€‰æ‹©ç”¨ Spark æ¥å¤„ç†ã€‚æ¯ä¸ªæ–‡ä»¶å·®ä¸å¤š 300Mï¼Œé‡Œé¢çš„æ•°å­—å¾ˆå¤šï¼Œæœ€åçš„ç›®æ ‡æ˜¯æå–æˆæ–‡ä»¶å†…æ•°æ®ä¸ºçŸ©é˜µçš„å½¢å¼ã€‚æ¯ä¸ªæ–‡ä»¶é‡Œé¢æœ‰ $K \times M \times N$ ä¸ªæµ®ç‚¹å‹æ•°å­—ã€‚è¦æå–æˆ $K$ ä¸ª $M \times N$ çš„çŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾ $K = 500$ï¼Œ$M = 5000$, $N = 30$ï¼Œé¦–å…ˆå†™ä¸€ä¸ªæ•°æ®ç”Ÿæˆå™¨å‡ºæ¥ï¼š&lt;/p&gt;
&lt;p&gt;data_generator.py&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;span class="lnt"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;K&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;M&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;K&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;M&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;astype&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;float32&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tofile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test.data&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åŸæ¥ä¸çŸ¥é“æœ‰è¿™ä¸ª np.tofileï¼Œä»Šå¤©æ‰çŸ¥é“çš„ã€‚ã€‚ã€‚é€Ÿåº¦å¾ˆå¿«ï¼Œå‡†ç¡®çš„è¯´æ˜¯å¤ªå¿«äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;æ•°æ®ä½¿ç”¨ sparkContext çš„ binaryFiles å°±å¯ä»¥è¯»åˆ°å†…å­˜ä¸­ï¼Œä»¥ bytes çš„å½¢å¼å­˜å‚¨ã€‚&lt;/p&gt;
&lt;p&gt;åŸæ¥æˆ‘æå– $K$ ä¸ªçŸ©é˜µçš„æ–¹æ³•æ˜¯ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;K&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;M&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;UNIT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;M&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;UNIT_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;UNIT&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;record_time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;wrapper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;wrapper&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@record_time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;method1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;K&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;struct&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unpack&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;f&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;UNIT&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;UNIT_&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;UNIT_&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç›´æ¥ç”¨ struct.unpack $K$ æ¬¡ï¼Œè€Œä¸”æ¯æ¬¡éƒ½ç”¨ np.array æ„é€ å‡ºæ–°çš„ arrayã€‚ä½†æ˜¯ä¸å¾—ä¸è¯´ï¼Œå› ä¸º python åº•å±‚æ˜¯ C å†™çš„ï¼Œè¿™ä¸ª struct.unpack å¾ˆå¿«ï¼Œå®Œæˆä¸Šé¢çš„è§£æåªéœ€è¦ 10sã€‚å½“æ—¶æƒ³ç€ python è§£æè¿™ä¸ªçš„é€Ÿåº¦è‚¯å®šæ²¡æœ‰ scala å¿«ï¼Œå†™æˆè¿™æ ·åº”è¯¥å°±å·®ä¸å¤šäº†ã€‚ä½†æ˜¯æœ€è¿‘æˆ‘éƒ½æ²¡æ€ä¹ˆå†™ç¨‹åºï¼Œå°±æƒ³ç ”ç©¶ç ”ç©¶èƒ½ä¸èƒ½ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;h2 id="ä¼˜åŒ–æ–¹æ¡ˆ1ä½¿ç”¨-c-é‡å†™è¿™éƒ¨åˆ†"&gt;ä¼˜åŒ–æ–¹æ¡ˆ1ï¼šä½¿ç”¨ C++ é‡å†™è¿™éƒ¨åˆ†
&lt;/h2&gt;&lt;p&gt;æˆ‘å½“æ—¶è§‰å¾—ï¼Œä½¿ç”¨ C++ å®Œæˆ bytes åˆ° np.ndarray çš„è½¬æ¢åº”è¯¥å¿«ä¸€ç‚¹ï¼Œç„¶åå°±å†™äº†ä¸€ä¸ªï¼š&lt;/p&gt;
&lt;p&gt;tools.cpp&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cpp" data-lang="cpp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;fstream&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;string&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;ctime&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;time.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;Eigen/Dense&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#include&amp;lt;pybind11/eigen.h&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;pybind11/pybind11.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="n"&gt;Eigen&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MatrixXd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;MatrixXd&lt;/span&gt; &lt;span class="nf"&gt;extract_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;k_idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;stream&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;MatrixXd&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;offset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;k_idx&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;memcpy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stream&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;offset&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;offset&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;PYBIND11_MODULE&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;def&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;extract_matrix&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;extract_matrix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pybind11&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;return_value_policy&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;reference&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å®é™…ä¸Šæ˜¯åˆ©ç”¨ pybind11 å®ç°äº†ä¸€ä¸ª C++ å‡½æ•°ï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ç¼–è¯‘ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-gdscript3" data-lang="gdscript3"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;O3&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;Wall&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;shared&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fPIC&lt;/span&gt; &lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;python3&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="n"&gt;pybind11&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;includes&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;I&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mnt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Users&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;chaosong&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Downloads&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;eigen&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cpp&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;python3&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;extension&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;suffix&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶å python å°±å¯ä»¥å¯¼å…¥äº†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;tools&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@record_time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;method2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;K&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extract_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœè¿™ç©æ„å‡ºå¥‡çš„æ…¢ã€‚ã€‚ã€‚ç”¨è¿™ä¸ª method2 å¤„ç†é‚£ä¸ªæ–‡ä»¶è¦ 254sã€‚æ¯”åŸæ¥çš„æ–¹æ³•æ…¢äº† 25 å€ã€‚&lt;/p&gt;
&lt;h2 id="ä¼˜åŒ–æ–¹æ¡ˆ2ä½¿ç”¨-npfrombuffer"&gt;ä¼˜åŒ–æ–¹æ¡ˆ2ï¼šä½¿ç”¨ np.frombuffer
&lt;/h2&gt;&lt;p&gt;æˆ‘å»çœ‹äº†çœ‹ numpy çš„æ–‡æ¡£ï¼Œç»“æœå‘ç°äº†è¿™ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥ç›´æ¥è¯» bytesï¼Œéƒ½ä¸éœ€è¦ç”¨ struct è§£æäº†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@record_time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;method3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;K&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;frombuffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;UNIT_&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;UNIT_&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;float32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;UNIT&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œæˆ‘æ•…æ„å†™æˆåˆ‡ç‰‡çš„å½¢å¼ï¼Œä¸ºäº†å’Œä¼˜åŒ–æ–¹æ¡ˆ3çš„é€Ÿåº¦åšå¯¹æ¯”ã€‚ä½†å³ä¾¿æ˜¯å¾ªç¯ K æ¬¡ï¼Œå°†åŸå§‹æ•°æ®ç”¨åˆ‡ç‰‡è¿›è¡Œäº†å¤åˆ¶ï¼Œè¿™ä¸ªæ–¹æ³•çš„æ—¶é—´éƒ½èƒ½è¾¾åˆ° 0.03sï¼Œæ¯”æˆ‘é‚£ä¸ªå¤±è´¥çš„æ–¹æ¡ˆ 1 å¿«äº† 8467 å€ï¼Œæ¯”åŸæ–¹æ¡ˆå¿«äº† 333 å€ã€‚&lt;/p&gt;
&lt;h2 id="ä¼˜åŒ–æ–¹æ¡ˆ3ä½¿ç”¨-npfrombuffer"&gt;ä¼˜åŒ–æ–¹æ¡ˆ3ï¼šä½¿ç”¨ np.frombuffer
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;span class="lnt"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@record_time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;method4&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;K&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;frombuffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;float32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;UNIT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;offset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;UNIT_&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸ªèƒ½è·‘åˆ° 0.0007sã€‚æ¯”æ–¹æ¡ˆ 1 å¿« 36 ä¸‡å€ï¼Œæ¯”åŸæ–¹æ¡ˆå¿« 14285 å€ï¼Œæ¯”æ–¹æ¡ˆ 2 å¿« 42 å€ã€‚&lt;/p&gt;
&lt;p&gt;ç»“è®ºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æˆ‘çš„é‚£ä¸ªæ–¹æ¡ˆ 1 å¤ªå·®åŠ²äº†ï¼Œè‚¯å®šæ˜¯æˆ‘ä¸ä¼šå†™æ‰å¯¼è‡´çš„ã€‚ã€‚ã€‚çœ‹çœ‹ä»¥åå•¥æ—¶å€™æœ‰æ—¶é—´ç ”ç©¶ä¸€ä¸‹&lt;/li&gt;
&lt;li&gt;np.frombufferï¼Œå¤ªå¼ºäº†ã€‚ã€‚ã€‚&lt;/li&gt;
&lt;li&gt;å¤šçœ‹ APIã€‚&lt;/li&gt;
&lt;li&gt;python çš„ struct å…¶å®æŒºå¿«çš„ï¼Œä½†æ˜¯åŸºäº C/C++ çš„ numpy æ›´å¿«ï¼Œæ— æ•Œå¿«ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é™„ä¸Šå®Œæ•´ä»£ç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;span class="lnt"&gt;44
&lt;/span&gt;&lt;span class="lnt"&gt;45
&lt;/span&gt;&lt;span class="lnt"&gt;46
&lt;/span&gt;&lt;span class="lnt"&gt;47
&lt;/span&gt;&lt;span class="lnt"&gt;48
&lt;/span&gt;&lt;span class="lnt"&gt;49
&lt;/span&gt;&lt;span class="lnt"&gt;50
&lt;/span&gt;&lt;span class="lnt"&gt;51
&lt;/span&gt;&lt;span class="lnt"&gt;52
&lt;/span&gt;&lt;span class="lnt"&gt;53
&lt;/span&gt;&lt;span class="lnt"&gt;54
&lt;/span&gt;&lt;span class="lnt"&gt;55
&lt;/span&gt;&lt;span class="lnt"&gt;56
&lt;/span&gt;&lt;span class="lnt"&gt;57
&lt;/span&gt;&lt;span class="lnt"&gt;58
&lt;/span&gt;&lt;span class="lnt"&gt;59
&lt;/span&gt;&lt;span class="lnt"&gt;60
&lt;/span&gt;&lt;span class="lnt"&gt;61
&lt;/span&gt;&lt;span class="lnt"&gt;62
&lt;/span&gt;&lt;span class="lnt"&gt;63
&lt;/span&gt;&lt;span class="lnt"&gt;64
&lt;/span&gt;&lt;span class="lnt"&gt;65
&lt;/span&gt;&lt;span class="lnt"&gt;66
&lt;/span&gt;&lt;span class="lnt"&gt;67
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;struct&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;tools&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test.data&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;K&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;M&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;UNIT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;M&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;UNIT_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;UNIT&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;record_time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;wrapper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;wrapper&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@record_time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;method1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;K&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;struct&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unpack&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;f&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;UNIT&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;UNIT_&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;UNIT_&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@record_time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;method2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;K&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extract_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@record_time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;method3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;K&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;frombuffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;UNIT_&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;UNIT_&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;float32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;UNIT&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@record_time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;method4&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;K&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;frombuffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;float32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;UNIT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;offset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;UNIT_&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;method1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method4&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ¥ä¸‹æ¥éœ€è¦éªŒè¯çš„æ˜¯ï¼Œæˆ‘ä»¬çš„ pyspark ç¨‹åºæ¯”åŸæ¥å¿«äº†å¤šå°‘ï¼Œè¿™ä¸ªæ˜å¤©å†éªŒè¯å§ã€‚&lt;/p&gt;</description></item><item><title>Multi-Range Attentive Bicomponent Graph Convolutional Network for Traffic Forecasting</title><link>https://davidham3.github.io/blog/p/multi-range-attentive-bicomponent-graph-convolutional-network-for-traffic-forecasting/</link><pubDate>Fri, 03 Jan 2020 20:18:29 +0000</pubDate><guid>https://davidham3.github.io/blog/p/multi-range-attentive-bicomponent-graph-convolutional-network-for-traffic-forecasting/</guid><description>&lt;p&gt;AAAI 2020ï¼ŒåŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1911.12093" target="_blank" rel="noopener"
&gt;https://arxiv.org/abs/1911.12093&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;äº¤é€šé¢„æµ‹åœ¨è¿è¾“å’Œå…¬å…±å®‰å…¨ä¸­æ‰®æ¼”é‡è¦è§’è‰²ï¼Œç”±äºå¤æ‚çš„æ—¶ç©ºä¾èµ–å’Œè·¯ç½‘å’Œäº¤é€šçŠ¶å†µå¸¦æ¥çš„ä¸ç¡®å®šæ€§ä½¿è¿™ä¸ªé—®é¢˜å¾ˆæœ‰æŒ‘æˆ˜ã€‚æœ€æ–°çš„ç ”ç©¶ä¸“æ³¨äºä½¿ç”¨å›¾å·ç§¯ç½‘ç»œ GCNs å¯¹ä¸€ä¸ªå›ºå®šæƒé‡çš„å›¾è¿›è¡Œå»ºæ¨¡ï¼Œå³å¯¹ç©ºé—´ä¾èµ–å»ºæ¨¡ã€‚ç„¶è€Œï¼Œè¾¹ï¼Œå³ä¸¤ä¸ªç»“ç‚¹ä¹‹é—´çš„å…³ç³»æ›´åŠ å¤æ‚ä¸”ä¸¤è€…ç›¸äº’å½±å“ã€‚æˆ‘ä»¬æå‡ºäº† Multi-Range Attentive Bicomponent GCN (MRA-BGCN)ï¼Œä¸€ç§æ–°çš„ç”¨äºäº¤é€šé¢„æµ‹çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ã€‚æˆ‘ä»¬å…ˆæ ¹æ®è·¯ç½‘ä¸Šç»“ç‚¹çš„è·ç¦»æ„å»ºç»“ç‚¹å›¾ï¼Œåœ¨æ ¹æ®ä¸åŒçš„è¾¹çš„äº¤äº’æ¨¡å¼æ„é€ è¾¹å›¾ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ bicomponent å›¾å·ç§¯å®ç°ç»“ç‚¹å’Œè¾¹çš„äº¤äº’ã€‚è¿™ä¸ªå¤šèŒƒå›´æ³¨æ„åŠ›æœºåˆ¶ç”¨æ¥èšåˆä¸åŒé‚»å±…èŒƒå›´çš„ä¿¡æ¯ï¼Œè‡ªåŠ¨åœ°å­¦ä¹ ä¸åŒèŒƒå›´çš„é‡è¦æ€§ã€‚å¤§é‡çš„å®éªŒåœ¨ä¸¤ä¸ªçœŸå®æ•°æ®é›†ï¼ŒMETR-LA å’Œ PEMS-BAY ä¸Šå¼€å±•ï¼Œæ˜¾ç¤ºå‡ºæˆ‘ä»¬çš„æ¨¡å‹æ•ˆæœå¾ˆå¥½ã€‚&lt;/p&gt;
&lt;h1 id="introduction"&gt;Introduction
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multi-range-attentive-bicomponent-graph-convolutional-network-for-traffic-forecasting/Fig1.png"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;è®²äº†å¥½å¤šå†å²ã€‚ã€‚ã€‚ç„¶åæ˜¯è®ºç‚¹éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è®¤ä¸º DCRNN å’Œ STGCN è™½è¯´é›†æˆäº† GCNï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªç‚¹å¿½ç•¥äº†ï¼š&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œè¿™äº›æ–¹æ³•ä¸»è¦å…³æ³¨é€šè¿‡åœ¨ä¸€ä¸ªå›ºå®šæƒé‡çš„å›¾ä¸Šéƒ¨ç½² GCN å¯¹ç©ºé—´ä¾èµ–å»ºæ¨¡ã€‚ç„¶è€Œï¼Œè¾¹æ›´å¤æ‚ã€‚å›¾ 1a ä¸­ï¼Œä¼ æ„Ÿå™¨ 1 å’Œ 3ï¼Œè¿˜æœ‰ 2 å’Œ 3ï¼Œé€šè¿‡è·¯ç½‘è¿æ¥ã€‚æ˜¾ç„¶ï¼Œè¿™äº›å…³è”éšå½“å‰çš„äº¤é€šçŠ¶å†µæ”¹å˜ï¼Œä»–ä»¬ä¹‹é—´ä¹Ÿäº’ç›¸äº¤äº’ã€‚å›¾ 1b æ‰€ç¤ºï¼Œç°å­˜çš„æ–¹æ³•æ ¹æ®è·¯ç½‘è·ç¦»æ„å»ºä¸€ä¸ªå›ºå®šçš„å¸¦æƒå›¾ï¼Œä½¿ç”¨ GCN å®ç°è¿™äº›ç»“ç‚¹çš„äº¤äº’ï¼Œä½†æ˜¯ç»“ç‚¹é—´çš„å…³è”æ€§åœ¨é‚»æ¥çŸ©é˜µä¸­é€šè¿‡å›ºå®šçš„å€¼è¡¨ç¤ºï¼Œè¿™å°±å¿½ç•¥äº†è¾¹çš„å¤æ‚æ€§å’Œäº¤äº’æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œè¿™äº›æ–¹æ³•ç»å¸¸ä½¿ç”¨ä¸€ä¸ªç»™å®šèŒƒå›´å†…èšåˆçš„ä¿¡æ¯ï¼Œæ¯”å¦‚ $k$ é˜¶é‚»å±…ï¼Œå¿½ç•¥å¤šä¸ªèŒƒå›´çš„ä¿¡æ¯ã€‚ç„¶è€Œï¼Œä¸åŒèŒƒå›´çš„ä¿¡æ¯è¡¨ç°å‡ºä¸åŒçš„äº¤é€šå±æ€§ã€‚å°çš„èŒƒå›´è¡¨ç°å‡ºå±€éƒ¨ä¾èµ–ï¼Œå¤§èŒƒå›´å€¾å‘äºè¡¨ç°å…¨å±€çš„äº¤é€šæ¨¡å¼ã€‚æ­¤å¤–ï¼Œä¸åŒèŒƒå›´çš„ä¿¡æ¯ä¹Ÿä¸æ˜¯æ°¸è¿œéƒ½å…·æœ‰ç›¸åŒçš„åˆ†é‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€æ¬¡äº¤é€šäº‹æ•…ï¼Œä¸€ä¸ªç»“ç‚¹ä¸»è¦å—å®ƒæœ€è¿‘çš„é‚»å±…çš„å½±å“ï¼Œè¿™æ ·æ¨¡å‹å°±åº”è¯¥æ›´å…³æ³¨å®ƒï¼Œè€Œä¸æ˜¯ç»™å…¶ä»–çš„ $k$ é˜¶é‚»å±…ç›¸åŒçš„å…³æ³¨ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§£å†³ä¸Šè¿°ä¸¤ç‚¹é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº† MRA-BGCNï¼Œä¸ä»…è€ƒè™‘ç»“ç‚¹å…³è”ï¼Œä¹ŸæŠŠè¾¹ä½œä¸ºå®ä½“ï¼Œè€ƒè™‘ä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå¦‚å›¾ 1cï¼Œæˆ‘ä»¬è¿˜åˆ©ç”¨äº†ä¸åŒçš„èŒƒå›´ä¿¡æ¯ã€‚æˆ‘ä»¬çš„è´¡çŒ®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æå‡º MRA-BGCNï¼Œå¼•å…¥ bicomponent å›¾å·ç§¯ï¼Œå¯¹ç»“ç‚¹å’Œè¾¹ç›´æ¥å»ºæ¨¡ã€‚ç»“ç‚¹å›¾æ ¹æ®è·¯ç½‘è·ç¦»æ„å»ºï¼Œè¾¹å›¾æ ¹æ®è¾¹çš„äº¤äº’æ¨¡å¼ã€stream connectivity å’Œ ç«äº‰å…³ç³»æ„å»ºã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬é’ˆå¯¹ bicomponent å›¾å·ç§¯æå‡ºå¤šèŒƒå›´æ³¨æ„åŠ›æœºåˆ¶ï¼Œå¯ä»¥èšåˆä¸åŒèŒƒå›´é‚»å±…çš„ä¿¡æ¯ï¼Œå­¦ä¹ ä¸åŒèŒƒå›´çš„é‡è¦æ€§ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬å¼€å±•äº†å¤§é‡çš„å®éªŒï¼Œå®éªŒæ•ˆæœå¾ˆå¥½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="preliminaries"&gt;Preliminaries
&lt;/h1&gt;&lt;h2 id="problem-definition"&gt;Problem Definition
&lt;/h2&gt;&lt;p&gt;ç»™å®šå†å²çš„æ•°æ®ï¼Œé¢„æµ‹æœªæ¥çš„æ•°æ®ã€‚$N$ ä¸ªç»“ç‚¹ç»„æˆçš„å›¾ $G = (V, E, \bm{A})$ã€‚æ—¶é—´ $t$ è·¯ç½‘ä¸Šçš„äº¤é€šæ•°æ®è¡¨ç¤ºä¸ºå›¾ä¿¡å· $\bm{X}^{(t)} \in \mathbb{R}^{N \times P}$ï¼Œ$P$ æ˜¯ç‰¹å¾æ•°ã€‚äº¤é€šé¢„æµ‹æ˜¯è¿‡å»çš„æ•°æ®é¢„æµ‹æœªæ¥ï¼š&lt;/p&gt;
$$
[\bm{X}^{(t-T'+1):t},G] \xrightarrow{f} [\bm{X}^{(t+1)}:(t+T)],
$$&lt;p&gt;$\bm{X}^{(t-T&amp;rsquo;+1):t} \in \mathbb{R}^{N \times P \times T&amp;rsquo;}$ï¼Œ$\bm{X}^{(t+1):(t+T)} \in \mathbb{R}^{N \times P \times T}$ã€‚&lt;/p&gt;
&lt;h2 id="graph-convolution"&gt;Graph Convolution
&lt;/h2&gt;&lt;p&gt;ä¸ä»‹ç»äº†ã€‚&lt;/p&gt;
&lt;h1 id="methodology"&gt;Methodology
&lt;/h1&gt;&lt;h2 id="model-overview"&gt;Model Overview
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multi-range-attentive-bicomponent-graph-convolutional-network-for-traffic-forecasting/Fig2.png"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;å›¾ 2 å±•ç¤ºäº† MRA-BGCN çš„æ¶æ„ï¼ŒåŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼šï¼ˆ1ï¼‰åŒç»„ä»¶å›¾å·ç§¯æ¨¡å—ï¼›ï¼ˆ2ï¼‰å¤šèŒƒå›´æ³¨æ„åŠ›å±‚ã€‚åŒç»„ä»¶å›¾å·ç§¯æ¨¡å—åŒ…å«å¤šä¸ªç»“ç‚¹å›¾å·ç§¯å±‚å’Œè¾¹å›¾å·ç§¯å±‚ï¼Œç›´æ¥å¯¹ç»“ç‚¹å’Œè¾¹çš„äº¤äº’å»ºæ¨¡ã€‚å¤šèŒƒå›´æ³¨æ„åŠ›å±‚èšåˆä¸åŒèŒƒå›´çš„é‚»å±…ä¿¡æ¯ï¼Œå­¦ä¹ ä¸åŒèŒƒå›´çš„é‡è¦æ€§ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬èåˆ MRA-BGCN å’Œ RNN å¯¹æ—¶é—´ä¾èµ–å»ºæ¨¡å®Œæˆäº¤é€šé¢„æµ‹ã€‚&lt;/p&gt;
&lt;h2 id="bicomponent-graph-convolution"&gt;Bicomponent Graph Convolution
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multi-range-attentive-bicomponent-graph-convolutional-network-for-traffic-forecasting/Fig3.png"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;å›¾å·ç§¯å¯ä»¥æœ‰æ•ˆèšåˆç»“ç‚¹ä¹‹é—´çš„äº¤äº’å…³ç³»ï¼Œç„¶è€Œï¼Œäº¤é€šé¢„æµ‹ä¸­è¾¹æ›´å¤æ‚ï¼ˆè¿™å¥è¯è¯´ä¸‰éäº†ï¼‰ã€‚å› æ­¤æˆ‘ä»¬æå‡ºåŒç»„ä»¶å›¾å·ç§¯ï¼Œç›´æ¥å¯¹ç»“ç‚¹å’Œè¾¹çš„äº¤äº’å»ºæ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;Chen ç­‰äººæå‡ºè¾¹çš„é‚»è¿‘çš„ line graph æ¥å»ºæ¨¡è¾¹çš„å…³ç³»ã€‚$G = (V, E, \bm{A})$ è¡¨ç¤ºç»“ç‚¹æœ‰å‘å›¾ï¼Œ$G_L = (V_L, E_L, \bm{A}_L)$ æ˜¯å¯¹åº”çš„ line graphï¼Œ$G_L$ çš„ç»“ç‚¹ $V_L$ æ˜¯ $E$ ä¸­æœ‰åºçš„è¾¹ã€‚$\bm{A}_L$ æ˜¯æ— æƒçš„é‚»æ¥çŸ©é˜µï¼Œç¼–ç äº†ç»“ç‚¹å›¾ä¸­çš„è¾¹é‚»æ¥å…³ç³»ï¼Œæœ‰å…³ç³»å°±ç­‰äº1ã€‚&lt;/p&gt;
&lt;p&gt;å°½ç®¡ line graph å¯ä»¥è€ƒè™‘è¾¹çš„é‚»æ¥ï¼Œå®ƒä»ç„¶æ˜¯ä¸€ä¸ªæ— æƒå›¾ä¸”åªè®¤ä¸ºä¸¤æ¡è¾¹ä¸­çš„ä¸€æ¡è¾¹çš„æ±‡ç‚¹å’Œå¦ä¸€æ¡è¾¹çš„æºç‚¹ç›¸åŒæ—¶ï¼Œè¿™ä¸¤æ¡æ‰ç›¸å…³ã€‚ç„¶è€Œï¼Œå¯¹äºåˆ»ç”»äº¤é€šé¢„æµ‹ä¸­å„ç§å„æ ·è¾¹çš„äº¤äº’å…³ç³»æ¥è¯´è¿™ä¸å¤Ÿé«˜æ•ˆã€‚å¦‚å›¾ 3 æ‰€ç¤ºï¼Œæˆ‘ä»¬å®šä¹‰ä¸¤ç±»è¾¹çš„äº¤äº’æ¨¡å¼æ¥æ„å»ºè¾¹å›¾ $G_e = (V_e, E_e, \bm{A}_e)$ã€‚$V_e$ ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹è¡¨ç¤º $E$ ä¸­çš„è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Stream connectivity&lt;/strong&gt; åœ¨äº¤é€šç½‘ç»œä¸­ï¼Œè·¯ç½‘å¯èƒ½å—å®ƒä¸Šä¸‹æ¸¸çš„è·¯æ®µå½±å“ã€‚å¦‚å›¾ 3a æ‰€ç¤ºï¼Œ$(i \rightarrow j)$ æ˜¯ $(j \rightarrow k)$ çš„ä¸Šæ¸¸çš„è¾¹ï¼Œå› æ­¤ä»–ä»¬æ˜¯ç›¸äº’å…³è”çš„ã€‚ç›´è§‚ä¸Šæ¥çœ‹ï¼Œå¦‚æœç»“ç‚¹ $j$ æœ‰å¾ˆå¤šæ•°é‡çš„é‚»å±…ï¼Œé‚£ä¹ˆ $(i \rightarrow j)$ å’Œ $(j \rightarrow k)$ ä¹‹é—´çš„å…³ç³»æ˜¯å¼±çš„ï¼Œå› ä¸ºå®ƒè¿˜è¦å—å…¶ä»–é‚»å±…çš„å½±å“ã€‚æˆ‘ä»¬ä½¿ç”¨é«˜æ–¯æ ¸è®¡ç®—è¾¹çš„æƒé‡ç”¨æ¥è¡¨ç¤º $\bm{A}_e$ ä¸­çš„ stream connectivityï¼š&lt;/p&gt;
$$\tag{2}
\bm{A}\_{e, (i \rightarrow j), (j \rightarrow k)} = \bm{A}\_{e, (j \rightarrow k), (i \rightarrow j)} = \text{exp}(- \frac{(\text{deg}^-(j) + \text{deg}^+(j) - 2)^2}{\sigma^2})
$$&lt;p&gt;$\text{deg}^-(j)$ å’Œ $\text{deg}^+(j)$ åˆ†åˆ«è¡¨ç¤ºç»“ç‚¹ $j$ çš„å…¥åº¦å’Œå‡ºåº¦ï¼Œ$\sigma$ æ˜¯ç»“ç‚¹åº¦çš„æ ‡å‡†å·®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Competitive relationship&lt;/strong&gt; è·¯ç½‘&lt;/p&gt;</description></item><item><title>GMAN: A Graph Multi-Attention Network for Traffic Prediction</title><link>https://davidham3.github.io/blog/p/gman-a-graph-multi-attention-network-for-traffic-prediction/</link><pubDate>Thu, 02 Jan 2020 17:03:30 +0000</pubDate><guid>https://davidham3.github.io/blog/p/gman-a-graph-multi-attention-network-for-traffic-prediction/</guid><description>&lt;p&gt;AAAI 2020ï¼Œä½¿ç”¨ç¼–ç è§£ç +attçš„æ¶æ„ï¼Œåªä¸è¿‡ç¼–ç å’Œè§£ç éƒ½ä½¿ç”¨ attention ç»„æˆã€‚ä¸»è¦çš„è®ºç‚¹æ˜¯ç©ºé—´å’Œæ—¶é—´çš„å…³è”æ€§æ˜¯åŠ¨æ€çš„ï¼Œæ‰€ä»¥è®¾è®¡è¿™ä¹ˆä¸€ä¸ªçº¯æ³¨æ„åŠ›çš„æ¡†æ¶ã€‚å€¼å¾—æ³¨æ„çš„ç‚¹æ˜¯ï¼šç”±äºæ³¨æ„åŠ›åˆ†æ•°çš„ä¸ªæ•°æ˜¯å¹³æ–¹çº§åˆ«çš„ï¼Œåœ¨è®¡ç®—ç©ºé—´æ³¨æ„åŠ›çš„æ—¶å€™ï¼Œä¸€æ—¦ç»“ç‚¹æ•°å¾ˆå¤§ï¼Œè¿™é‡Œä¼šæœ‰è¶…å¤§çš„è®¡ç®—é‡å’Œå†…å­˜æ¶ˆè€—ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯å°†ç»“ç‚¹åˆ†ç»„åï¼Œè®¡ç®—ç»„å†…æ³¨æ„åŠ›å’Œç»„é—´æ³¨æ„åŠ›ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1911.08415" target="_blank" rel="noopener"
&gt;https://arxiv.org/abs/1911.08415&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;é•¿æ—¶é—´èŒƒå›´çš„äº¤é€šæµé¢„æµ‹æ˜¯ä¸ªæŒ‘æˆ˜ï¼Œä¸¤æ–¹é¢åŸå› ï¼šäº¤é€šç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œå¾ˆå¤šå½±å“å› ç´ çš„æŒç»­å˜åŒ–æ€§ã€‚æˆ‘ä»¬åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œä¸“æ³¨äºæ—¶ç©ºå› ç´ ï¼Œæå‡ºäº†ä¸€ä¸ªå›¾å¤šæ³¨æ„åŠ›æœºæ™ºç½‘ç»œï¼ˆGMANï¼‰ï¼Œé¢„æµ‹è·¯ç½‘ä¸Šä¸åŒåŒºåŸŸçš„äº¤é€šçŠ¶å†µã€‚GMAN ä½¿ç”¨ä¸€ä¸ªç¼–ç è§£ç ç»“æ„ï¼Œç¼–ç è§£ç å™¨éƒ½ç”±å¤šä¸ªæ—¶ç©ºæ³¨æ„åŠ›å—ç»„æˆï¼Œæ—¶ç©ºæ³¨æ„åŠ›å—å¯¹äº¤é€šçŠ¶å†µä¸Šçš„æ—¶ç©ºå› ç´ çš„å½±å“å»ºæ¨¡ã€‚ç¼–ç å™¨å°†è¾“å…¥çš„äº¤é€šç‰¹å¾ç¼–ç ï¼Œè§£ç å™¨è¾“å‡ºé¢„æµ‹åºåˆ—ã€‚ç¼–ç è§£ç å™¨ä¹‹é—´ï¼Œæœ‰ä¸€ä¸ªå˜æ¢æ³¨æ„åŠ›å±‚ï¼Œç”¨æ¥æŠŠç¼–ç å™¨ç¼–ç åçš„äº¤é€šç‰¹å¾ç”Ÿæˆæˆæœªæ¥æ—¶é—´æ­¥çš„åºåˆ—è¡¨ç¤ºï¼Œç„¶åæŠŠè¿™ä¸ªè¡¨ç¤ºè¾“å…¥åˆ°è§£ç å™¨é‡Œé¢ã€‚å˜æ¢æ³¨æ„åŠ›æœºåˆ¶å¯¹å†å²å’Œæœªæ¥æ—¶é—´æ­¥çš„å…³ç³»å»ºæ¨¡ï¼Œå¯ä»¥å‡è½»å¤šæ­¥é¢„æµ‹ä¸­çš„é”™è¯¯ç§¯ç´¯ã€‚ä¸¤ä¸ªçœŸå®æ•°æ®é›†ä¸Šçš„äº¤é€šé¢„æµ‹ä»»åŠ¡ï¼ˆä¸€ä¸ªæ˜¯æµé‡é¢„æµ‹ï¼Œä¸€ä¸ªæ˜¯é€Ÿåº¦é¢„æµ‹ï¼‰æ˜¾ç¤º GMAN çš„æ•ˆæœä¼˜è¶Šã€‚åœ¨1å°æ—¶çš„é¢„æµ‹ä¸Šï¼ŒGMAN åœ¨ MAE æ¯” state-of-the-art å¥½4%ã€‚æºç åœ¨ï¼š&lt;a class="link" href="https://github.com/zhengchuanpan/GMAN" target="_blank" rel="noopener"
&gt;https://github.com/zhengchuanpan/GMAN&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="introduction"&gt;Introduction
&lt;/h1&gt;&lt;p&gt;äº¤é€šé¢„æµ‹çš„ç›®æ ‡æ˜¯åŸºäºå†å²è§‚æµ‹é¢„æµ‹æœªæ¥çš„äº¤é€šçŠ¶å†µã€‚åœ¨å¾ˆå¤šåº”ç”¨ä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œç²¾ç¡®çš„äº¤é€šé¢„æµ‹å¯ä»¥å¸®åŠ©äº¤ç®¡éƒ¨é—¨æ›´å¥½çš„æ§åˆ¶äº¤é€šï¼Œå‡å°‘æ‹¥å µã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/gman-a-graph-multi-attention-network-for-traffic-prediction/Fig1.png"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;é‚»è¿‘åŒºåŸŸçš„äº¤é€šçŠ¶å†µä¼šäº’ç›¸å½±å“ã€‚å¤§å®¶ä½¿ç”¨ CNN æ•è·è¿™æ ·çš„ç©ºé—´ä¾èµ–ã€‚åŒæ—¶ï¼Œä¸€ä¸ªåœ°æ–¹çš„äº¤é€šçŠ¶å†µå’Œå®ƒçš„å†å²è®°å½•æœ‰å…³ã€‚RNN å¹¿æ³›åœ°ç”¨äºè¿™æ ·æ—¶é—´ç›¸å…³æ€§çš„å»ºæ¨¡ã€‚æœ€è¿‘çš„ç ”ç©¶å°†äº¤é€šé¢„æµ‹å˜ä¸ºå›¾æŒ–æ˜é—®é¢˜ï¼Œå› ä¸ºäº¤é€šé—®é¢˜å—é™äºè·¯ç½‘ã€‚ä½¿ç”¨ GCN çš„è¿™äº›ç ”ç©¶åœ¨çŸ­æœŸé¢„æµ‹ï¼ˆ5 åˆ° 15 åˆ†é’Ÿï¼‰å†…è¡¨ç°å‡ºä¸é”™çš„æ•ˆæœã€‚ç„¶è€Œï¼Œé•¿æœŸé¢„æµ‹ï¼ˆå‡ ä¸ªå°æ—¶ï¼‰ä»ç¼ºä¹ä»¤äººæ»¡æ„çš„æ•ˆæœï¼Œä¸»è¦å—é™äºä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¤æ‚çš„æ—¶ç©ºå…³è”ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;åŠ¨æ€çš„ç©ºé—´å…³è”ã€‚å¦‚å›¾ 1 æ‰€ç¤ºï¼Œè·¯ç½‘ä¸­çš„ä¼ æ„Ÿå™¨ä¹‹é—´çš„å…³è”éšæ—¶é—´å‰§çƒˆåœ°å˜åŒ–ï¼Œæ¯”å¦‚é«˜å³°æ—¶æ®µçš„å‰åã€‚å¦‚ä½•åŠ¨æ€åœ°é€‰æ‹©ç›¸å…³çš„æ£€æµ‹å™¨æ•°æ®æ¥é¢„æµ‹ä¸€ä¸ªæ£€æµ‹å™¨åœ¨æœªæ¥é•¿æ—¶é—´èŒƒå›´çš„äº¤é€šçŠ¶å†µæ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚&lt;/li&gt;
&lt;li&gt;éçº¿æ€§çš„æ—¶é—´å…³è”ã€‚å›¾ 1ï¼Œä¸€ä¸ªæ£€æµ‹å™¨çš„äº¤é€šçŠ¶å†µå¯èƒ½å˜åŒ–å¾—éå¸¸å‰§çƒˆï¼Œä¸”å¯èƒ½ç”±äºäº‹æ•…ç­‰å› ç´ ï¼Œçªç„¶å½±å“ä¸åŒæ—¶é—´æ­¥ä¹‹é—´çš„å…³è”æ€§ã€‚å¦‚ä½•è‡ªé€‚åº”åœ°éšæ—¶é—´çš„æ¨ç§»å¯¹è¿™ç§éçº¿æ€§æ—¶é—´å…³è”å»ºæ¨¡ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;å¯¹è¯¯å·®ä¼ é€’çš„æ•æ„Ÿã€‚é•¿æœŸé¢„æµ‹ä¸Šï¼Œæ¯ä¸ªæ—¶é—´æ­¥ä¸Šå°çš„é”™è¯¯éƒ½ä¼šè¢«æ”¾å¤§ã€‚è¿™æ ·çš„è¯¯å·®ä¼ é€’å¯¹äºè¿œæœŸæ—¶é—´é¢„æµ‹æ¥è¯´ä»å…·æœ‰æŒ‘æˆ˜æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ºäº†è§£å†³ä¸Šè¿°æŒ‘æˆ˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªå›¾å¤šæ³¨æ„åŠ›ç½‘ç»œï¼ˆGMANï¼‰æ¥é¢„æµ‹æœªæ¥çš„äº¤é€šçŠ¶å†µã€‚è¿™é‡ŒæŒ‡çš„äº¤é€šçŠ¶å†µæ˜¯ä¸€ä¸ªäº¤é€šç³»ç»Ÿä¸­å¯ä»¥è®°å½•ä¸ºæ•°å€¼çš„è§‚æµ‹å€¼ã€‚ä¸ºäº†æè¿°ï¼Œæˆ‘ä»¬è¿™é‡Œä¸“æ³¨äºæµé‡å’Œé€Ÿåº¦é¢„æµ‹ï¼Œä½†æ˜¯æˆ‘ä»¬çš„æ¨¡å‹æ˜¯å¯ä»¥åº”ç”¨åˆ°å…¶ä»–æ•°å€¼å‹çš„äº¤é€šæ•°æ®ä¸Šçš„ã€‚&lt;/p&gt;
&lt;p&gt;GMAN ä½¿ç”¨ç¼–ç è§£ç æ¶æ„ï¼Œç¼–ç å™¨ç¼–ç äº¤é€šç‰¹å¾ï¼Œè§£ç å™¨ç”Ÿæˆé¢„æµ‹åºåˆ—ã€‚å˜æ¢æ³¨æ„åŠ›å±‚ç”¨æ¥æŠŠç¼–ç å†å²ç‰¹å¾è½¬æ¢ä¸ºæœªæ¥è¡¨ç¤ºã€‚ç¼–è§£ç å™¨éƒ½ç”±ä¸€ç»„æ—¶ç©ºæ³¨æ„åŠ›å— &lt;em&gt;ST-Attention blocks&lt;/em&gt; ç»„æˆã€‚æ¯ä¸ªæ—¶ç©ºæ³¨æ„åŠ›å—ç”±ä¸€ä¸ªç©ºé—´æ³¨æ„åŠ›ã€ä¸€ä¸ªæ—¶é—´æ³¨æ„åŠ›å’Œä¸€ä¸ªé—¨æ§èåˆæœºåˆ¶ç»„æˆã€‚ç©ºé—´æ³¨æ„åŠ›å»ºæ¨¡åŠ¨æ€ç©ºé—´å…³è”ï¼Œæ—¶é—´æ³¨æ„åŠ›å»ºæ¨¡éçº¿æ€§æ—¶é—´å…³è”ï¼Œé—¨æ§èåˆæœºåˆ¶è‡ªé€‚åº”åœ°èåˆç©ºé—´å’Œæ—¶é—´è¡¨ç¤ºã€‚å˜æ¢æ³¨æ„åŠ›æœºåˆ¶å»ºæ¨¡å†å²å’Œæœªæ¥çš„å…³ç³»ï¼Œå‡è½»é”™è¯¯ä¼ æ’­ã€‚ä¸¤ä¸ªçœŸå®ä¸–ç•Œæ•°æ®é›†è¯æ˜ GMAN è·å¾—äº†æœ€å¥½çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„è´¡çŒ®&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æå‡ºç©ºé—´æ³¨æ„åŠ›å’Œæ—¶é—´æ³¨æ„åŠ›å¯¹åŠ¨æ€ç©ºé—´å’Œéçº¿æ€§æ—¶é—´å…³è”åˆ†åˆ«å»ºæ¨¡ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªé—¨æ§èåˆæœºåˆ¶ï¼Œè‡ªé€‚åº”åœ°èåˆç©ºé—´æ³¨æ„åŠ›å’Œæ—¶é—´æ³¨æ„åŠ›æœºåˆ¶çš„çš„ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;æå‡ºä¸€ä¸ªå˜æ¢æ³¨æ„åŠ›æœºåˆ¶å°†å†å²äº¤é€šç‰¹å¾è½¬æ¢ä¸ºæœªæ¥çš„è¡¨ç¤ºã€‚è¿™ä¸ªæ³¨æ„åŠ›æœºåˆ¶å¯¹å†å²å’Œæœªæ¥çš„å…³ç³»ç›´æ¥å»ºæ¨¡ï¼Œå‡è½»é”™è¯¯ä¼ æ’­çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šè¯„ä¼°äº†æˆ‘ä»¬çš„å›¾å¤šæ³¨æ„åŠ›ç½‘ç»œï¼Œåœ¨ 1 å°æ—¶é¢„æµ‹é—®é¢˜ä¸Šæ¯” state-of-the-art æé«˜äº† 4%ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="preliminaries"&gt;Preliminaries
&lt;/h1&gt;&lt;p&gt;è·¯ç½‘è¡¨ç¤ºä¸ºä¸€ä¸ªå¸¦å…¨æœ‰å‘å›¾ $\mathcal{G} = (\mathcal{V}, \mathcal{E}, \mathcal{A})$ã€‚$\mathcal{V}$ æ˜¯ $N$ ä¸ªç»“ç‚¹çš„é›†åˆï¼›$\mathcal{E}$ æ˜¯è¾¹é›†ï¼›$\mathcal{A} \in \mathbb{R}^{N \times N}$ æ˜¯é‚»æ¥çŸ©é˜µï¼Œè¡¨ç¤ºç»“ç‚¹é—´çš„ç›¸ä¼¼æ€§ï¼Œè¿™ä¸ªç›¸ä¼¼æ€§æ˜¯ç»“ç‚¹åœ¨è·¯ç½‘ä¸Šçš„è·ç¦»ã€‚&lt;/p&gt;
&lt;p&gt;æ—¶é—´æ­¥ $t$ çš„è·¯ç½‘çŠ¶å†µè¡¨ç¤ºä¸ºå›¾ä¿¡å· $X_t \in \mathbb{R}^{N \times C}$ï¼Œ$C$ æ˜¯ç‰¹å¾æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç ”ç©¶çš„é—®é¢˜ï¼šç»™å®š $N$ ä¸ªç»“ç‚¹å†å² $P$ ä¸ªæ—¶é—´æ­¥çš„è§‚æµ‹å€¼ $\mathcal{X} = (X_{t_1}, X_{t_2}, \dots. X_{t_P}) \in \mathbb{R}^{P \times N \times C}$ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯é¢„æµ‹æœªæ¥ $Q$ ä¸ªæ—¶é—´æ­¥æ‰€æœ‰ç»“ç‚¹çš„äº¤é€šçŠ¶å†µï¼Œè¡¨ç¤ºä¸º $\hat{Y} = (\hat{X}_{t_{P+1}}, \hat{X}_{t_{P+2}}, \dots, \hat{X}_{t_{P+Q}}) \in \mathbb{R}^{Q \times N \times C}$ã€‚&lt;/p&gt;
&lt;h1 id="graph-multi-attention-network"&gt;Graph Multi-Attention Network
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/gman-a-graph-multi-attention-network-for-traffic-prediction/Fig2.png"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;å›¾ 2 æè¿°äº†æˆ‘ä»¬æ¨¡å‹çš„æ¶æ„ã€‚ç¼–ç å’Œè§£ç å™¨éƒ½æœ‰ STAtt Block å’Œæ®‹å·®è¿æ¥ã€‚æ¯ä¸ª ST-Attention block ç”±ç©ºé—´æ³¨æ„åŠ›æœºåˆ¶ã€æ—¶é—´æ³¨æ„åŠ›æœºåˆ¶å’Œä¸€ä¸ªé—¨æ§èåˆç»„æˆã€‚ç¼–ç å™¨å’Œè§£ç å™¨ä¹‹é—´æœ‰ä¸ªå˜æ¢æ³¨æ„åŠ›å±‚ã€‚æˆ‘ä»¬è¿˜é€šè¿‡ä¸€ä¸ªæ—¶ç©ºåµŒå…¥ spatial-temporal embedding (STE) ç»§æ‰¿äº†å›¾ç»“æ„å’Œæ—¶é—´ä¿¡æ¯åˆ°å¤šæ³¨æ„åŠ›æœºåˆ¶ä¸­ã€‚æ­¤å¤–ï¼Œä¸ºäº†è¾…åŠ©æ®‹å·®è¿æ¥ï¼Œæ‰€æœ‰å±‚çš„è¾“å‡ºéƒ½æ˜¯ D ç»´ã€‚&lt;/p&gt;
&lt;h2 id="spatio-temporal-embedding"&gt;Spatio-Temporal Embedding
&lt;/h2&gt;&lt;p&gt;å› ä¸ºäº¤é€šçŠ¶å†µçš„å˜åŒ–å—é™äºè·¯ç½‘ï¼Œé›†æˆè·¯ç½‘ä¿¡æ¯åˆ°æ¨¡å‹ä¸­å¾ˆé‡è¦ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºä¸€ä¸ªç©ºé—´åµŒå…¥ï¼ŒæŠŠç»“ç‚¹åµŒå…¥åˆ°å‘é‡ä¸­ä»¥æ­¤ä¿å­˜å›¾ç»“æ„ä¿¡æ¯ã€‚æˆ‘ä»¬åˆ©ç”¨ node2vec å­¦ä¹ ç»“ç‚¹è¡¨ç¤ºã€‚æ­¤å¤–ï¼Œä¸ºäº†ååŒè®­ç»ƒæ¨¡å‹å’Œé¢„å­¦ä¹ çš„å‘é‡ï¼Œè¿™äº›å‘é‡ä¼šæ”¾å…¥ä¸€ä¸ªä¸¤å±‚å…¨è¿æ¥ç¥ç»ç½‘ç»œä¸­ã€‚ç„¶åå°±å¯ä»¥æ‹¿åˆ°ç©ºé—´è¡¨ç¤º $e^S_{v_i} \in \mathbb{R}^D$ã€‚&lt;/p&gt;
&lt;p&gt;ç©ºé—´åµŒå…¥åªæä¾›äº†å›ºå®šçš„è¡¨ç¤ºï¼Œä¸èƒ½è¡¨ç¤ºè·¯ç½‘ä¸­çš„ä¼ æ„Ÿå™¨çš„åŠ¨æ€å…³è”æ€§ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ—¶é—´åµŒå…¥æ¥æŠŠæ¯ä¸ªæ—¶é—´æ­¥ç¼–ç åˆ°å‘é‡ä¸­ã€‚å‡è®¾ä¸€å¤©æ˜¯ T ä¸ªæ—¶é—´æ­¥ã€‚æˆ‘ä»¬ä½¿ç”¨ one-hot ç¼–ç æ˜ŸæœŸã€æ—¶é—´åˆ° $\mathbb{R}^7$ å’Œ $\mathbb{R}^T$ é‡Œé¢ï¼Œç„¶åæ‹¼æ¥ï¼Œå¾—åˆ° $\mathbb{R}^{T + 7}$ã€‚æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ä¸¤å±‚å…¨è¿æ¥æ˜ å°„åˆ° $\mathbb{R}^D$ã€‚åœ¨æˆ‘ä»¬çš„æ¨¡å‹é‡Œé¢ï¼Œç»™å†å²çš„ $P$ ä¸ªæ—¶é—´æ­¥å’Œæœªæ¥çš„ $Q$ ä¸ªæ—¶é—´æ­¥åµŒå…¥æ—¶é—´ç‰¹å¾ï¼Œè¡¨ç¤ºä¸º $e^T_{t_j} \in \mathbb{R}^D$ï¼Œ$t_j = t_1, \dots, t_P, \dots, t_{P+Q}$ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è·å¾—éšæ—¶é—´å˜åŒ–çš„é¡¶ç‚¹è¡¨ç¤ºï¼Œæˆ‘ä»¬èåˆäº†ä¸Šè¿°çš„ç©ºé—´åµŒå…¥å’Œæ—¶é—´åµŒå…¥ï¼Œå¾—åˆ°æ—¶ç©ºåµŒå…¥ï¼ˆSTEï¼‰ï¼Œå¦‚å›¾ 2b æ‰€ç¤ºã€‚ç»“ç‚¹ $v_i$ åœ¨æ—¶é—´æ­¥ $t_j$ï¼ŒSTE å®šä¹‰ä¸º $e_{v_i,t_j} = e^S_{v_i} + e^T_{t_j}$ã€‚å› æ­¤ï¼Œ$N$ ä¸ªç»“ç‚¹åœ¨ $P + Q$ çš„æ—¶é—´æ­¥é‡Œçš„ STE è¡¨ç¤ºä¸º $E \in \mathbb{R}^{(P + Q) \times N \times D}$ã€‚STE åŒ…å«å›¾ç»“æ„å’Œæ—¶é—´ä¿¡æ¯ã€‚å®ƒä¼šç”¨åœ¨ç©ºé—´ã€æ—¶é—´ã€å˜æ¢æ³¨æ„åŠ›æœºåˆ¶é‡Œé¢ã€‚&lt;/p&gt;
&lt;h2 id="st-attention-block"&gt;ST-Attention Block
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬å°†ç¬¬ $l$ ä¸ªå—çš„è¾“å…¥è¡¨ç¤ºä¸º $H^{(l-1)}$ï¼Œç»“ç‚¹ $v_i$ åœ¨æ—¶é—´æ­¥ $t_j$ çš„éšè—çŠ¶æ€è¡¨ç¤ºä¸º $h^{(l-1)}_{v_i,t_j}$ã€‚ç¬¬ $l$ å—ä¸­çš„ç©ºé—´å’Œæ—¶é—´æ³¨æ„åŠ›æœºåˆ¶çš„è¾“å‡ºè¡¨ç¤ºä¸º $H^{(l)}_S$ å’Œ $H^{(l)}_T$ï¼Œéšè—çŠ¶æ€è¡¨ç¤ºä¸º $hs^{(l)}_{v_i,t_j}$ å’Œ $ht^{(l)}_{v_i,t_j}$ã€‚é—¨æ§èåˆåï¼Œç¬¬ $l$ å±‚çš„è¾“å‡ºè¡¨ç¤ºä¸º $H^{(l)}$ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†éçº¿æ€§å˜æ¢è¡¨ç¤ºä¸ºï¼š&lt;/p&gt;
$$\tag{1}
f(x) = \text{ReLU}(x\mathbf{W} + \mathbf{b}).
$$&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/gman-a-graph-multi-attention-network-for-traffic-prediction/Fig3.png"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Spatial Attention&lt;/strong&gt; ä¸€æ¡è·¯çš„äº¤é€šçŠ¶å†µå—å…¶ä»–è·¯çš„å½±å“ï¼Œä¸”å½±å“ä¸åŒã€‚è¿™æ ·çš„å½±å“æ˜¯é«˜åº¦åŠ¨æ€çš„ï¼Œéšæ—¶é—´å˜åŒ–ã€‚ä¸ºäº†å»ºæ¨¡è¿™äº›å±æ€§ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªç©ºé—´æ³¨æ„åŠ›æœºåˆ¶åŠ¨æ€åœ°æ•è·è·¯ç½‘ä¸­ä¼ æ„Ÿå™¨é—´çš„å…³è”æ€§ã€‚æ ¸å¿ƒç‚¹æ˜¯åœ¨ä¸åŒçš„æ—¶é—´æ­¥åŠ¨æ€åœ°ç»™ä¸åŒçš„ç»“ç‚¹åˆ†é…æƒé‡ï¼Œå¦‚å›¾ 3 æ‰€ç¤ºã€‚å¯¹äºæ—¶é—´æ­¥ $t_j$ çš„ç»“ç‚¹ $v_i$ï¼Œæˆ‘ä»¬è®¡ç®—æ‰€æœ‰ç»“ç‚¹çš„å¸¦æƒå’Œï¼š&lt;/p&gt;
$$\tag{2}
hs^{(l)}\_{v\_i,t\_j} = \sum\_{v \in \mathcal{V}} \alpha\_{v\_i, v} \cdot h^{(l-1)}\_{v,t\_j},
$$&lt;p&gt;$\alpha_{v_i, v}$ æ˜¯ç»“ç‚¹ $v$ å¯¹ $v_i$ çš„æ³¨æ„åŠ›åˆ†æ•°ï¼Œæ³¨æ„åŠ›åˆ†æ•°ä¹‹å’Œä¸º1ï¼š$\sum_{v \in \mathcal{V}} \alpha_{v_i, v} = 1$ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªç¡®å®šçš„æ—¶é—´æ­¥ï¼Œå½“å‰äº¤é€šçŠ¶å†µå’Œè·¯ç½‘ç»“æ„èƒ½å¤Ÿå½±å“ä¼ æ„Ÿå™¨ä¹‹é—´çš„å…³è”æ€§ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè·¯ä¸Šçš„æ‹¥æŒ¤å¯èƒ½æå¤§åœ°å½±å“å®ƒä¸´è¿‘è·¯æ®µçš„äº¤é€šçŠ¶å†µã€‚å—è¿™ä¸ªç›´è§‰çš„å¯å‘ï¼Œæˆ‘ä»¬è€ƒè™‘ä½¿ç”¨äº¤é€šç‰¹å¾å’Œå›¾ç»“æ„ä¸¤æ–¹é¢æ¥å­¦ä¹ æ³¨æ„åŠ›åˆ†æ•°ã€‚æˆ‘ä»¬æŠŠéšè—çŠ¶æ€å’Œæ—¶ç©ºåµŒå…¥æ‹¼æ¥èµ·æ¥ï¼Œä½¿ç”¨ scaled dot-product approach (Vaswani et al. 2017) æ¥è®¡ç®—ç»“ç‚¹ $v_i$ å’Œ $v$ ä¹‹é—´çš„ç›¸å…³æ€§ï¼š&lt;/p&gt;
$$\tag{3}
s\_{v\_i, v} = \frac{&lt; h^{(l-1)}\_{v\_i,t\_j} \Vert\ e\_{v\_i,t\_j}, h^{(l-1)}+{v,t\_j}, \Vert e\_{v,t\_j} &gt;}{\sqrt{2D}}
$$&lt;p&gt;å…¶ä¸­ï¼Œ$\Vert$ è¡¨ç¤ºæ‹¼æ¥æ“ä½œï¼Œ$&amp;lt; \bullet, \bullet &amp;gt;$ è¡¨ç¤ºå†…ç§¯ï¼Œ$2D$ è¡¨ç¤º $h^{(l-1)}_{v_i,t_j} \Vert e_{v_i,t_j}$ çš„ç»´åº¦ã€‚$s_{v_i,v}$ é€šè¿‡ softmax å½’ä¸€åŒ–ï¼š&lt;/p&gt;
$$\tag{4}
\alpha\_{v\_i,v} = \frac{\text{exp}(s\_{v\_i,v})}{\sum\_{v\_r \in \mathcal{V}} \text{exp}(s\_{v\_i,v\_r})}.
$$&lt;p&gt;å¾—åˆ°æ³¨æ„åŠ›åˆ†æ•° $\alpha_{v_i,v}$ ä¹‹åï¼Œéšè—çŠ¶æ€é€šè¿‡å…¬å¼ 2 æ›´æ–°ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ç¨³å®šå­¦ä¹ è¿‡ç¨‹ï¼Œæˆ‘ä»¬æŠŠç©ºé—´æ³¨æ„åŠ›æœºåˆ¶æ‰©å±•ä¸ºå¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ã€‚æˆ‘ä»¬æ‹¼æ¥ $K$ ä¸ªå¹¶è¡Œçš„æ³¨æ„åŠ›æœºåˆ¶ï¼Œä½¿ç”¨ä¸åŒçš„å…¨è¿æ¥æ˜ å°„ï¼š&lt;/p&gt;
$$\tag{5}
s^{(k)}\_{v\_i,v} = \frac{&lt; f^{(k)}\_{s,1} (h^{(l-1)}\_{v\_i,t\_j} \Vert e\_{v\_i,t\_j}), f^{(k)}\_{s,2} (h^{(l-1)}\_{v,t\_j} \Vert e\_{v,t\_j}) &gt;}{\sqrt{d}},
$$$$\tag{6}
\alpha^{(k)}\_{v\_i,v} = \frac{\text{exp}(s^{(k)}\_{v\_i,v})}{\sum\_{v\_r \in \mathcal{V}} \text{exp}(s^{(k)}\_{v\_i,v\_r})},
$$$$\tag{7}
hs^{(l)}\_{v\_i,t\_j} = \Vert^K\_{k=1} \lbrace \sum\_{v \in \mathcal{V}} \alpha^{(k)}\_{v\_i,v} \cdot f^{(k)}\_{s,3}(h^{(l-1)}\_{v,t\_j}) \rbrace,
$$&lt;p&gt;å…¶ä¸­ $f^{(k)}_{s,1}(\bullet), f^{(k)}_{s,2}(\bullet), f^{(k)}_{s,3}(\bullet)$ è¡¨ç¤ºç¬¬ $k$ æ³¨æ„åŠ›å¤´çš„ä¸‰ä¸ªä¸åŒçš„éçº¿æ€§æ˜ å°„ï¼Œå³å…¬å¼ 1 ï¼Œäº§ç”Ÿ $d = D / K$ ç»´çš„è¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;å½“ç»“ç‚¹æ•° $N$ å¾ˆå¤§çš„æ—¶å€™ï¼Œæ—¶é—´å’Œå†…å­˜æ¶ˆè€—éƒ½ä¼šå¾ˆå¤§ï¼Œè¾¾åˆ° $N^2$ çš„æ•°é‡çº§ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé™åˆ¶ï¼Œæˆ‘ä»¬æå‡ºäº†ç»„ç©ºé—´æ³¨æ„åŠ›ï¼ŒåŒ…å«äº†ç»„å†…æ³¨æ„åŠ›åˆ†æ•°å’Œç»„é—´æ³¨æ„åŠ›åˆ†æ•°ï¼Œå¦‚å›¾ 4 æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/gman-a-graph-multi-attention-network-for-traffic-prediction/Fig4.png"
loading="lazy"
alt="Figure4"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æŠŠ $N$ ä¸ªç»“ç‚¹éšæœºåˆ’åˆ†ä¸º $G$ ä¸ªç»„ï¼Œæ¯ä¸ªç»„åŒ…å« $M = N / G$ ä¸ªç»“ç‚¹ï¼Œå¦‚æœå¿…è¦çš„è¯å¯ä»¥åŠ  paddingã€‚æ¯ä¸ªç»„ï¼Œæˆ‘ä»¬ä½¿ç”¨å…¬å¼ 5ï¼Œ6ï¼Œ7 è®¡ç®—ç»„å†…çš„æ³¨æ„åŠ›ï¼Œå¯¹å±€éƒ¨ç©ºé—´å…³ç³»å»ºæ¨¡ï¼Œå‚æ•°æ˜¯å¯¹æ‰€æœ‰çš„ç»„å…±äº«çš„ã€‚ç„¶åï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªç»„ä½¿ç”¨æœ€å¤§æ± åŒ–å¾—åˆ°æ¯ä¸ªç»„çš„è¡¨ç¤ºã€‚æ¥ä¸‹æ¥è®¡ç®—ç»„é—´ç©ºé—´æ³¨æ„åŠ›ï¼Œå¯¹ç»„é—´å…³ç³»å»ºæ¨¡ï¼Œç»™æ¯ä¸ªç»„ç”Ÿæˆä¸€ä¸ªå…¨å±€ç‰¹å¾ã€‚å±€éƒ¨ç‰¹å¾å’Œå…¨å±€ç‰¹å¾ç›¸åŠ å¾—åˆ°æœ€åçš„è¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ç»„ç©ºé—´æ³¨æ„åŠ›ä¸­ï¼Œæˆ‘ä»¬æ¯ä¸ªæ—¶é—´æ­¥éœ€è¦è®¡ç®— $GM^2 + G^2 = NM + (N / M)^2$ ä¸ªæ³¨æ„åŠ›åˆ†æ•°ã€‚é€šè¿‡ä½¿æ¢¯åº¦ä¸º0ï¼Œæˆ‘ä»¬çŸ¥é“ $M = \sqrt[3]{2N}$ æ—¶ï¼Œæ³¨æ„åŠ›åˆ†æ•°çš„ä¸ªæ•°è¾¾åˆ°æœ€å¤§å€¼ $2^{-1/3} N^{4/3} \ll N^2$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/gman-a-graph-multi-attention-network-for-traffic-prediction/Fig5.png"
loading="lazy"
alt="Figure5"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Temporal Attention&lt;/strong&gt; ä¸€ä¸ªåœ°ç‚¹çš„äº¤é€šçŠ¶å†µå’Œå®ƒä¹‹å‰çš„è§‚æµ‹å€¼æœ‰å…³ï¼Œè¿™ä¸ªå…³è”æ˜¯éçº¿æ€§çš„ã€‚ä¸ºäº†å»ºæ¨¡è¿™äº›æ€§è´¨ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªæ—¶é—´æ³¨æ„åŠ›æœºåˆ¶ï¼Œè‡ªé€‚åº”åœ°å¯¹ä¸åŒæ—¶é—´æ­¥çš„éçº¿æ€§å…³ç³»å»ºæ¨¡ï¼Œå¦‚å›¾ 5 æ‰€ç¤ºã€‚å¯ä»¥æ³¨æ„åˆ°æ—¶é—´å…³è”å—åˆ°äº¤é€šçŠ¶å†µå’Œå¯¹åº”çš„æ—¶é—´ç¯å¢ƒä¸¤è€…çš„å½±å“ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ—©é«˜å³°çš„æ‹¥å µå¯èƒ½ä¼šå½±å“äº¤é€šå¥½å‡ ä¸ªå°æ—¶ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è€ƒè™‘äº¤é€šç‰¹å¾å’Œæ—¶é—´ä¸¤è€…æ¥è¡¡é‡ä¸åŒæ—¶é—´æ­¥çš„ç›¸å…³æ€§ã€‚æˆ‘ä»¬æŠŠéšè—çŠ¶æ€å’Œæ—¶ç©ºåµŒå…¥æ‹¼æ¥èµ·æ¥ï¼Œä½¿ç”¨å¤šå¤´æ³¨æ„åŠ›è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°ã€‚å¯¹äºç»“ç‚¹ $v_i$ï¼Œæ—¶é—´æ­¥ $t_j$ ä¸ $t$ çš„ç›¸å…³æ€§å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{8}
u^{(k)}\_{t\_j,t} = \frac{&lt; f^{(k)}\_{t,1}(h^{(l-1)}\_{v\_i,t\_j} \Vert e\_{v\_i,t\_j}), f^{(k)}\_{t,2}(h^{(l-1)}\_{v\_i,t} \Vert e\_{v\_i,t}) &gt;}{\sqrt{d}},
$$$$\tag{9}
\beta^{(k)}\_{t\_j,t} = \frac{\text{exp}(u^{(k)}\_{t\_j,t})}{\sum\_{t\_r \in \mathcal{N}\_{t\_j}}} \text{exp}(u^{(k)}\_{t\_j,t\_r}),
$$&lt;p&gt;$u^{(k)}_{t_j,t}$ è¡¨ç¤ºæ—¶é—´æ­¥ $t_j$ å’Œ $t$ ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œ$\beta^{(k)}_{t_j,t}$ æ˜¯ç¬¬ $k$ ä¸ªå¤´çš„æ³¨æ„åŠ›åˆ†æ•°ï¼Œè¡¨ç¤ºæ—¶é—´æ­¥ $t$ å¯¹æ—¶é—´æ­¥ $t_j$ çš„é‡è¦æ€§ï¼Œä¸¤ä¸ª $f$ æ˜¯éçº¿æ€§å˜æ¢ï¼Œ$\mathcal{N}_{t_j}$ è¡¨ç¤º $t_j$ å‰çš„æ—¶é—´æ­¥çš„é›†åˆï¼Œå³åªè€ƒè™‘ç›®æ ‡æ—¶é—´æ­¥ä»¥å‰çš„æ—¶é—´æ­¥ï¼Œè¿™æ ·æ‰æœ‰å› æœã€‚ä¸€æ—¦è·å¾—äº†æ³¨æ„åŠ›åˆ†æ•°ï¼Œæ—¶é—´æ­¥ $t_j$ çš„ç»“ç‚¹ $v_i$ çš„éšè—çŠ¶æ€å¯ä»¥é€šè¿‡ä¸‹é¢çš„å…¬å¼æ›´æ–°ï¼š&lt;/p&gt;
$$\tag{10}
ht^{(l)}\_{v\_i,t\_j} = \Vert^K\_{k=1} \lbrace \sum\_{t \in \mathcal{N}\_{t\_j}} \beta^{(k)}\_{t\_j,t} \cdot f^{(k)}\_{t,3}(h^{(l-1)}\_{v\_i,t}) \rbrace
$$&lt;p&gt;$f$ æ˜¯éçº¿æ€§æ˜ å°„ã€‚å…¬å¼ 8ï¼Œ9ï¼Œ10 å­¦ä¹ åˆ°çš„å‚æ•°å¯¹æ‰€æœ‰ç»“ç‚¹å’Œæ‰€æœ‰æ—¶é—´æ­¥å…±äº«ï¼Œä¸”å¹¶è¡Œè®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Gated Fusion&lt;/strong&gt; ä¸€ä¸ªæ—¶é—´æ­¥ä¸€æ¡è·¯ä¸Šçš„äº¤é€šçŠ¶å†µä¸å®ƒè‡ªèº«ä¹‹å‰çš„å€¼å’Œç›¸é‚»é“è·¯ä¸Šçš„äº¤é€šçŠ¶å†µç›¸å…³ã€‚å¦‚å›¾ 2c æ‰€ç¤ºï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªé—¨æ§èåˆæœºåˆ¶è‡ªé€‚åº”åœ°èåˆç©ºé—´å’Œæ—¶é—´è¡¨ç¤ºã€‚åœ¨ç¬¬ $l$ ä¸ªå—ï¼Œç©ºé—´å’Œæ—¶é—´æ³¨æ„åŠ›çš„è¾“å‡ºè¡¨ç¤ºä¸º $H^{(l)}_S$ å’Œ $H^{(l)}_T$ï¼Œä¸¤è€…çš„ç»´åº¦åœ¨ç¼–ç å™¨ä¸­æ˜¯ $\mathbb{R}^{P \times N \times D}$ï¼Œè§£ç å™¨ä¸­æ˜¯ $\mathbb{R}^{Q \times N \times D}$ã€‚é€šè¿‡ä¸‹å¼èåˆï¼š&lt;/p&gt;
$$\tag{11}
H^{(l)} = z \odot H^{(l)}\_S + (1 - z) \odot H^{(l)}\_T,
$$$$\tag{12}
z = \sigma(H^{(l)}\_S \mathbf{W}\_{z,1} + H^{(l)}\_T \mathbf{W}\_{z,2} + \mathbf{b}\_z),
$$&lt;p&gt;é—¨æ§èåˆæœºåˆ¶è‡ªé€‚åº”åœ°æ§åˆ¶æ¯ä¸ªæ—¶é—´æ­¥å’Œç»“ç‚¹ä¸Šç©ºé—´å’Œæ—¶é—´ä¾èµ–çš„æµåŠ¨ã€‚&lt;/p&gt;
&lt;h2 id="transform-attention"&gt;Transform Attention
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/gman-a-graph-multi-attention-network-for-traffic-prediction/Fig6.png"
loading="lazy"
alt="Figure6"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å‡è½»é”™è¯¯ä¼ æ’­çš„é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ç¼–ç å™¨å’Œè§£ç å™¨ä¹‹é—´åŠ å…¥äº†ä¸€ä¸ªå˜æ¢æ³¨æ„åŠ›å±‚ã€‚å®ƒèƒ½ç›´æ¥åœ°å¯¹å†å²æ—¶é—´æ­¥å’Œæœªæ¥æ—¶é—´æ­¥çš„å…³ç³»å»ºæ¨¡ï¼Œå°†äº¤é€šç‰¹å¾ç¼–ç ä¸ºæœªæ¥çš„è¡¨ç¤ºï¼Œä½œä¸ºè§£ç å™¨çš„è¾“å…¥ã€‚å¦‚å›¾ 6 æ‰€ç¤ºï¼Œå¯¹äºç»“ç‚¹ $v_i$ æ¥è¯´ï¼Œé¢„æµ‹çš„æ—¶é—´æ­¥ $t_j \ (t_j = t_{P+1}, \dots, t_{P+Q})$ å’Œå†å²çš„æ—¶é—´æ­¥ $t \ (t_1, \dots, t_P)$ é€šè¿‡æ—¶ç©ºåµŒå…¥æ¥è¡¡é‡ï¼š&lt;/p&gt;
$$\tag{13}
\lambda^{(k)}\_{t\_j,t} = \frac{&lt; f^{(k)}\_{tr,1}(e\_{v\_i,t\_j}), f^{(k)}\_{tr,2}(e\_{v\_i,t}) &gt;}{\sqrt{d}},
$$$$\tag{14}
\gamma^{(k)}\_{t\_j,t} = \frac{\text{exp}(\lambda^{(k)}\_{t\_j,t})}{\sum^{t\_P}\_{t\_r=t\_1} \text{exp}(\lambda^{(k)}\_{t\_j,t\_r})}.
$$&lt;p&gt;ç¼–ç çš„äº¤é€šç‰¹å¾é€šè¿‡æ³¨æ„åŠ›åˆ†æ•° $\gamma^{(k)}_{t_j,t}$ è‡ªé€‚åº”åœ°åœ¨å†å² $P$ ä¸ªæ—¶é—´æ­¥é€‰æ‹©ç›¸å…³çš„ç‰¹å¾ï¼Œå˜æ¢åˆ°è§£ç å™¨çš„è¾“å…¥ï¼š&lt;/p&gt;
$$\tag{15}
h^{(l)}\_{v\_i,t\_j} = \Vert^K\_{k=1} \lbrace \sum^{t\_P}\_{t=t\_1} \gamma^{(k)}\_{t\_j,t} \cdot f^{(k)}\_{tr,3}(h^{(l-1)}\_{v\_i,t}) \rbrace.
$$&lt;h2 id="encoder-decoder"&gt;Encoder-Decoder
&lt;/h2&gt;&lt;p&gt;å¦‚å›¾ 2a æ‰€ç¤ºï¼ŒGMAN æ˜¯ç¼–ç è§£ç æ¶æ„ã€‚åœ¨è¿›å…¥ç¼–ç å™¨å‰ï¼Œå†å²è®°å½• $\mathcal{X} \in \mathbb{R}^{P \times N \times C}$ é€šè¿‡å…¨è¿æ¥å˜æ¢åˆ° $H^{(0)} \in \mathbb{R}^{P \times N \times D}$ã€‚ç„¶å $H^{(0)}$ è¾“å…¥åˆ° $L$ ä¸ªæ—¶ç©ºæ³¨æ„åŠ›å—ç»„æˆçš„ç¼–ç å™¨ä¸­ï¼Œäº§ç”Ÿè¾“å‡º $H^{(L)} \in \mathbb{R}^{P \times N \times D}$ã€‚ç„¶åå˜æ¢æ³¨æ„åŠ›å±‚æŠŠç¼–ç ç‰¹å¾ä» $H^{(L)}$ è½¬æ¢ä¸º $H^{(L+1)} \in \mathbb{R}^{Q \times N \times D}$ã€‚ç„¶å $L$ ä¸ªæ—¶ç©ºæ³¨æ„åŠ›å—çš„è§£ç å™¨äº§ç”Ÿè¾“å‡º $H^{(2L + 1)} \in \mathbb{R}^{Q \times N \times D}$ã€‚æœ€åï¼Œå…¨è¿æ¥å±‚è¾“å‡º $Q$ ä¸ªæ—¶é—´æ­¥çš„é¢„æµ‹ $\hat{Y} \in \mathbb{R}^{Q \times N \times C}$ã€‚&lt;/p&gt;
&lt;p&gt;GMAN å¯ä»¥é€šè¿‡æœ€å°åŒ– MAE æ¥ä¼˜åŒ–ï¼š&lt;/p&gt;
$$\tag{16}
\mathcal{L}(\Theta) = \frac{1}{Q} \sum^{t\_{P + Q}}\_{t = t\_P + 1} \vert Y\_t - \hat{Y}\_t \vert,
$$&lt;p&gt;$\Theta$ è¡¨ç¤ºå¯å­¦ä¹ çš„å‚æ•°ã€‚&lt;/p&gt;
&lt;h1 id="experiments"&gt;Experiments
&lt;/h1&gt;&lt;h2 id="datasets"&gt;Datasets
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬åœ¨ä¸¤ä¸ªä¸åŒè§„æ¨¡çš„äº¤é€šé¢„æµ‹æ•°æ®é›†ä¸Šè¡¡é‡äº†æ¨¡å‹çš„æ•ˆæœï¼šï¼ˆ1ï¼‰å¦é—¨æ•°æ®é›†ï¼Œæµé‡é¢„æµ‹ï¼ŒåŒ…å« 95 ä¸ªä¼ æ„Ÿå™¨ä» 2015 å¹´ 8 æœˆ 1 æ—¥åˆ° 12 æœˆ 31 æ—¥ 5 ä¸ªæœˆçš„æ•°æ®ï¼›ï¼ˆ2ï¼‰PeMS æ•°æ®é›†ä¸Šé€Ÿåº¦é¢„æµ‹ï¼ŒåŒ…å« 325 ä¸ªä¼ æ„Ÿå™¨ 6 ä¸ªæœˆçš„æ•°æ®ã€‚æ£€æµ‹å™¨çš„åˆ†å¸ƒå¦‚å›¾ 7.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/gman-a-graph-multi-attention-network-for-traffic-prediction/Fig7.png"
loading="lazy"
alt="Figure7"
&gt;&lt;/p&gt;
&lt;h2 id="data-preprocessing"&gt;Data Preprocessing
&lt;/h2&gt;&lt;p&gt;ä¸€ä¸ªæ—¶é—´æ­¥è¡¨ç¤º 5 minï¼Œä½¿ç”¨ Z-Score å½’ä¸€åŒ–ï¼Œ70% ç”¨äºè®­ç»ƒï¼Œ10% éªŒè¯ï¼Œ20% æµ‹è¯•ã€‚æˆ‘ä»¬è®¡ç®—è·¯ç½‘ä¸Šä¼ æ„Ÿå™¨ä¹‹é—´çš„è·ç¦»ï¼Œä½¿ç”¨å¦‚ä¸‹çš„è·¯ç½‘æ„å»ºæ–¹æ³•ï¼š&lt;/p&gt;
$$\tag{17}
\mathcal{A}\_{v\_i,v\_j} = \begin{cases}
\text{exp}(- \frac{d^2\_{v\_i,v\_j}}{\sigma^2}), &amp; \text{if} \ \text{exp}(-\frac{d^2\_{v\_i,v\_j}}{\sigma^2}) \geq \epsilon\\
0, &amp; \text{otherwise}
\end{cases}
$$&lt;p&gt;$\epsilon$ è®¾å®šä¸º 0.1ã€‚&lt;/p&gt;
&lt;h2 id="experimental-settings"&gt;Experimental Settings
&lt;/h2&gt;&lt;p&gt;æŒ‡æ ‡ï¼šMAE, RMSE, MAPEã€‚&lt;/p&gt;
&lt;p&gt;è¶…å‚æ•°å°±ä¸æè¿°äº†ã€‚&lt;/p&gt;
&lt;p&gt;Baselineséƒ½æ˜¯è¿‘å‡ å¹´çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/gman-a-graph-multi-attention-network-for-traffic-prediction/Table1.png"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œæœ€åä¸€ä¸ªè®­ç»ƒå’Œé¢„æµ‹æ—¶é—´çš„æ¯”è¾ƒï¼Œæˆ‘ä¸ªäººè®¤ä¸ºè„±ç¦»äº†æ¡†æ¶æˆ–è½¯ä»¶ï¼Œå•å•æ¯”è¾ƒæ¯è½®è®­ç»ƒæ—¶é•¿æ˜¯æ¯«æ— æ„ä¹‰çš„ï¼Œå› ä¸ºæœ‰äº›é™æ€å›¾æ¡†æ¶å®ƒå°±æ˜¯å¾ˆå¿«ï¼ŒåŠ¨æ€å›¾çš„å°±æ˜¯æ…¢ï¼Œè€Œä¸”ä»£ç è´¨é‡ä¹Ÿæœ‰åŒºåˆ«ï¼Œæœ‰çš„ä»£ç è´¨é‡é«˜ï¼Œè‡ªç„¶å°±å¾ˆå¿«ï¼Œä»£ç è´¨é‡ä½çš„å°±å¾ˆæ…¢ã€‚æ‹¿ Graph WaveNet ä¸¾ä¾‹ï¼Œä»–ä»¬å…¬å¼€çš„ä»£ç æ˜¯ pytorch çš„ï¼Œè€Œä¸”ä»–ä»¬åœ¨ inference çš„æ—¶å€™è¦å¯¹ ground truth è¿›è¡Œåå½’ä¸€åŒ–ï¼Œæœ‰çš„ä»£ç äººå®¶å°±ä¸åå½’ä¸€åŒ–ï¼Œè¿™ä¹Ÿä¼šé€ æˆ inference çš„æ—¶å€™æœ‰å·®åˆ«ï¼Œä¸”æœ‰çš„æ¨¡å‹æ˜¯éšç€ç»“ç‚¹æ•° $N$ çš„å¢åŠ æ¨¡å‹æœ‰æ˜¾è‘—çš„è€—æ—¶å¢åŠ çš„ç°è±¡ï¼Œæ²¡æœ‰è€ƒè™‘è¿™äº›å°±å†™ computation time çš„æ¯”è¾ƒæˆ‘è§‰å¾—æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œä½•å†µä»¥ AAAI 7 é¡µçš„é™åˆ¶æ¥è¯´ï¼Œå®Œå…¨è¯´æ¸…æ¥šè¿™äº›ä¹Ÿæ¯«æ— æ„ä¹‰ã€‚&lt;/p&gt;</description></item><item><title>githubå¤§æ–‡ä»¶ä¸Šä¼ </title><link>https://davidham3.github.io/blog/p/github%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</link><pubDate>Fri, 20 Dec 2019 11:18:36 +0000</pubDate><guid>https://davidham3.github.io/blog/p/github%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</guid><description>&lt;p&gt;åˆšæ‰å¼€æºäº†æˆ‘ä»¬ç»„åœ¨AAAI 2020ä¸Šä¸€ç¯‡è®ºæ–‡çš„ä»£ç å’Œæ•°æ®ï¼Œä¸Šä¼ æ•°æ®çš„æ—¶å€™è¶…äº†GitHubçš„100Må¤§å°é™åˆ¶ï¼ŒGitHubè¯´è®©æˆ‘ç”¨lfsè§£å†³ï¼Œç ”ç©¶äº†ä¸€ä¸‹æ€ä¹ˆä¼ ï¼Œè®°å½•ä¸€ä¸‹ï¼Œä»¥åè¯´ä¸å®šè¿˜ä¼šç”¨åˆ°ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git lfs install
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git lfs track &amp;#34;data.tar.gz&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git add .gitattributes
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git commit -m &amp;#34;Updated attributes&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git push
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git add data.tar.gz
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git lfs ls-files
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git commit -m &amp;#34;Add file&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git push
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åŸç†è¿˜ä¸å¤ªæ‡‚ï¼Œè¿™å‡ å¤©å¤ªå¿™äº†ï¼Œè¿‡å‡ å¤©çœ‹çœ‹ã€‚&lt;/p&gt;
&lt;p&gt;2020.1.2 æ›´æ–°ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;æœ€è¿‘æ”¶åˆ°äº†GitHubçš„é‚®ä»¶ï¼Œè¯´è¿™ä¸ªLFSæ˜¯æœ‰é™é¢çš„ã€‚ã€‚ã€‚ç„¶åæˆ‘çš„å·²ç»è¶…é¢äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªä¸œè¥¿æ˜¯åˆ†storageå’Œbandwidthä¸¤ä¸ªé¢åº¦ï¼Œä¸¤ä¸ªé¢åº¦éƒ½æ˜¯1ä¸ªæœˆ1Gã€‚å­˜å‚¨çš„è¯ï¼Œå¦‚æœä½ å­˜å‚¨ä¸€æ¬¡ï¼Œå°±ä¼šå ä¸€æ¬¡çš„å®¹é‡ï¼Œå¦‚æœä½ ä¿®æ”¹äº†é‡Œé¢çš„å†…å®¹ï¼Œå†pushä¸€æ¬¡ï¼Œå°±ä¼šå†å ä¸€æ¬¡è¿™ä¹ˆå¤§çš„ç©ºé—´ï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ª100Mçš„æ–‡ä»¶ï¼Œæˆ‘pushä¸Šå»ï¼Œå 100Mï¼Œæˆ‘æ”¹äº†ä¸€ä¸‹ï¼Œå†pushï¼Œé‚£æˆ‘å°±ä½¿ç”¨äº†200Mç©ºé—´ã€‚ã€‚ã€‚è¿™ä¸ªç©ºé—´æ˜¯è¿™ä¹ˆè®¡ç®—çš„ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;å¸¦å®½çš„è®¡ç®—æ˜¯ï¼Œä½ ä¸Šä¼ æ–‡ä»¶ä¸ç®—æµé‡ã€‚ä½†æ˜¯åªè¦æœ‰äººä¸‹è½½ï¼Œé‚£å°±èµ°è¿™ä¸ªæµé‡ï¼Œä¸€ä¸ªæœˆ1Gå…è´¹æµé‡ã€‚ã€‚ã€‚æˆ‘è¿™ä¸ªæ•°æ®é›†ï¼Œä¸€å¤©å°±è¶…äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;è§£å†³æ–¹æ³•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿›å…¥GitHubçš„help pageé‡Œé¢ï¼Œå¯ä»¥æ‰¾åˆ°åˆ é™¤æ–‡ä»¶çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œå³ä¾¿ä½ æƒ³åŠæ³•åˆ äº†ï¼Œå¦‚æœä½ çš„ä»“åº“ä¹‹å‰è¢«åˆ«äººforkè¿‡äº†ï¼Œé‚£ä»–ä»¬é‚£è¾¹çš„ä¸‹è½½ï¼Œä¹Ÿä¼šå ç”¨ä½ çš„bandwidthï¼Œå¾—çŸ¥è¿™ç‚¹åæˆ‘çœŸçš„å¥½æ— è¯­ã€‚ã€‚ã€‚ä¸»è¦å¦ä¸€ä¸ªå‘çˆ¹çš„äº‹æƒ…æ˜¯ï¼Œè¿™ä¸ªstorageå’Œbandwidthæ˜¯æŒ‰è´¦æˆ·è®°å¾—ï¼Œä¸æ˜¯æŒ‰ä»“åº“ï¼Œå³ä¸€ä¸ªè´¦æˆ·1æœˆ1Gã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åæˆ‘æŠŠä»“åº“åˆ äº†ï¼Œæƒ³ç€å»è”ç³»é‚£å‡ ä¸ªforkè¿‡çš„äººï¼Œè®©ä»–ä»¬åˆ é™¤ä»–ä»¬çš„ä»“åº“ï¼Œä½†æ˜¯ä»–ä»¬ç«Ÿç„¶æ²¡æœ‰ç•™ä¸‹é‚®ç®±ã€‚ã€‚ã€‚æ‰€ä»¥æˆ‘æ ¹æœ¬è”ç³»ä¸ä¸Šä»–ä»¬ã€‚ã€‚ã€‚ç®€ç›´äº†ã€‚ã€‚ã€‚&lt;/p&gt;</description></item><item><title>é‡è£…ç³»ç»Ÿåhexoåšå®¢çš„æ¢å¤</title><link>https://davidham3.github.io/blog/p/%E9%87%8D%E8%A3%85%E7%B3%BB%E7%BB%9F%E5%90%8Ehexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E6%81%A2%E5%A4%8D/</link><pubDate>Sat, 09 Nov 2019 00:21:08 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E9%87%8D%E8%A3%85%E7%B3%BB%E7%BB%9F%E5%90%8Ehexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E6%81%A2%E5%A4%8D/</guid><description>&lt;p&gt;å…ˆé‡è£…ä¸€ä¸‹node.jsï¼Œç„¶åæŠŠGitHubä¸Šé¢çš„å¯†é’¥æ¢ä¸€ä¸‹å¥½åƒå°±OKäº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é‡è£…node.js&lt;/li&gt;
&lt;li&gt;æ›´æ¢GitHubä¸Šé¢ä»“åº“çš„å¯†é’¥&lt;/li&gt;
&lt;li&gt;éšä¾¿å†™ä¸ªæ–‡ç« pushä¸Šå»è¯•è¯•&lt;/li&gt;
&lt;li&gt;ä¸çŸ¥é“ä¸ºä»€ä¹ˆå¥½ä¹…ä¹‹å‰çš„æ–‡ç« è·‘åˆ°é¦–é¡µæ¥äº†ã€‚ã€‚ã€‚æ—¶é—´å‡ºç°äº†é—®é¢˜ï¼Ÿ
æˆ‘æŠ˜è…¾äº†ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸¤ç¯‡æ–‡ç« çš„æ—¶é—´hexoå¥½åƒè®¡ç®—å¾—ä¸å¤ªå¯¹ã€‚ã€‚ã€‚æ˜å¤©æŠŠæ‰€æœ‰çš„æ’ä»¶åˆ é™¤å†è£…ä¸€æ¬¡è¯•è¯•ï¼Œä½†æ˜¯éš¾ç‚¹æ˜¯æˆ‘å·²ç»ä¸å¤ªè®°å¾—æˆ‘è£…è¿‡å“ªäº›æ’ä»¶äº†ã€‚ã€‚ã€‚
å¥½åƒæœ‰ä¸ªç»Ÿè®¡å­—æ•°çš„ï¼Œè¿˜æœ‰ä¸€ä¸ªpicture assetsã€‚&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>MXNet ä¸ cuda ç‰ˆæœ¬å…¼å®¹çš„é—®é¢˜</title><link>https://davidham3.github.io/blog/p/mxnet-%E4%B8%8E-cuda-%E7%89%88%E6%9C%AC%E5%85%BC%E5%AE%B9%E7%9A%84%E9%97%AE%E9%A2%98/</link><pubDate>Fri, 02 Aug 2019 20:22:10 +0000</pubDate><guid>https://davidham3.github.io/blog/p/mxnet-%E4%B8%8E-cuda-%E7%89%88%E6%9C%AC%E5%85%BC%E5%AE%B9%E7%9A%84%E9%97%AE%E9%A2%98/</guid><description>&lt;p&gt;æœ€è¿‘åœ¨åšå®éªŒçš„æ—¶å€™å‘ç°äº†ä¸€ä¸ªéå¸¸ç¥å¥‡çš„é—®é¢˜ï¼Œæå¾—æˆ‘ä¸€åº¦å¾ˆéƒé—·ã€‚æˆ‘åœ¨ kaggle ä¸Šé¢å†™äº†ä¸ª mxnet symbolic çš„ç¨‹åºï¼Œåœ¨æµ‹è¯•é›†ä¸Šæ•ˆæœä¸é”™ï¼Œè®ºæ–‡éƒ½å†™å®Œäº†ï¼Œç»“æœæ‹¿å›å®éªŒå®¤çš„ GPU ä¸Šä¸€è·‘ï¼Œå‘ç°ç»“æœå¤ç°ä¸äº†äº†ï¼Œå·®äº†ä¸¤ä¸ªç‚¹ã€‚ä½†æˆ‘æ‰€æœ‰çš„å®éªŒéƒ½åšäº† 10 æ¬¡ï¼Œå¦‚æœè¯´ 1 æ¬¡å®éªŒæ•ˆæœå¥½è¿˜å¯ä»¥è¯´æ˜¯å·§åˆï¼Œä½†è¿™æ˜¯ 10 æ¬¡å®éªŒå•Šã€‚&lt;/p&gt;
&lt;p&gt;å°è¯•æ‰¾äº†ä¸€ä¸‹é—®é¢˜åœ¨å“ªé‡Œï¼Œé¦–å…ˆæ˜¯ GPU å‹å·ï¼Œkaggle ä¸Šé¢æä¾›çš„æ˜¯ Tesla P100ï¼Œéå¸¸å¼ºåŠ²çš„ GPUï¼Œ16G çš„æ˜¾å­˜ï¼Œè€Œä¸”å¥½åƒè¿˜æ”¯æŒåŠç²¾åº¦æµ®ç‚¹è¿ç®—ã€‚æˆ‘åœ¨å®éªŒå®¤ä½¿ç”¨äº† RTX 2080 è·‘å®éªŒã€‚åœ¨ 4 å° RTX 2080 ä¸Šé¢æ­å»ºäº† OpenPAIï¼Œå¾®è½¯çš„ä¸€ä¸ªå¼€æºæ·±åº¦å­¦ä¹ èµ„æºè°ƒåº¦å¹³å°ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘åœ¨ kaggle ä¸Šè·‘ 10 æ¬¡ï¼Œæµ‹è¯•é›†æŒ‡æ ‡æ˜¯ 18.039ï¼Œåšäº† 10 æ¬¡å®éªŒå–çš„å¹³å‡å€¼ï¼Œæ–¹å·®æ˜¯ 0.075ï¼Œéå¸¸ç¨³å®šï¼Œä¹Ÿå°±æ˜¯å¯¹äºéšæœºæ€§ä¸æ•æ„Ÿï¼Œæ‰€ä»¥ä¸éœ€è¦æŒ‡å®šéšæœºç§å­ä»€ä¹ˆçš„ï¼Œæˆ‘ä¹Ÿä¸çˆ±æŒ‡å®šéšæœºç§å­ï¼Œå› ä¸ºæˆ‘è§‰å¾—å¥½çš„æ¨¡å‹å°±åº”è¯¥å¯¹éšæœºæ€§ä¸æ•æ„Ÿã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†éªŒè¯æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜ï¼Œæˆ‘æ‰“å°äº† kaggle çš„ç¯å¢ƒé…ç½®ï¼Œkaggle ä½¿ç”¨çš„ mxnet_cu100 1.5.0ï¼Œnumpy 1.16.4ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ç”¨ Docker æ„å»ºäº† 4 ä¸ªé•œåƒï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;softwares&lt;/th&gt;
&lt;th&gt;cuda 100&lt;/th&gt;
&lt;th&gt;cuda 101&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;mxnet 1.41&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;mx1.41_cu100&lt;/td&gt;
&lt;td&gt;mx1.41_cu101&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;mxnet 1.50&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;mx1.50_cu100&lt;/td&gt;
&lt;td&gt;mx1.50_cu101&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;åœ¨å®‰è£…çš„æ—¶å€™æ²¡æœ‰å®‰è£…mklã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªé•œåƒè·‘åŒä¸€ä¸ªå®éªŒ 3 æ¬¡å§ï¼Œæœ€è¿‘æ²¡ä»€ä¹ˆæ—¶é—´è·‘ 10 æ¬¡ï¼Œç»“æœç­‰æˆ‘è·‘å®Œäº†å†æ›´æ–°ã€‚&lt;/p&gt;
&lt;p&gt;2019å¹´8æœˆ9æ—¥æ›´æ–°ï¼š&lt;/p&gt;
&lt;p&gt;è·‘å®Œäº†ï¼Œå‘ç°ç»“æœå…¨éƒ½ä¸€æ ·ï¼Œå’Œæ˜¾å¡ï¼Œcudaï¼Œmxnet ç‰ˆæœ¬éƒ½æ— å…³ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;åæ¥æ‰¾äº†ä¸€ä¸‹é—®é¢˜ï¼Œé—®é¢˜å‡ºåœ¨ training set çš„ dataloaderï¼Œå¿˜äº†ç»™ training set shuffle äº†ï¼Œæ‰€ä»¥æ•ˆæœå˜å·®äº†ã€‚ã€‚ã€‚&lt;/p&gt;</description></item><item><title>STG2Seq: Spatial-temporal Graph to Sequence Model for Multi-step Passenger Demand Forecasting</title><link>https://davidham3.github.io/blog/p/stg2seq-spatial-temporal-graph-to-sequence-model-for-multi-step-passenger-demand-forecasting/</link><pubDate>Fri, 12 Jul 2019 19:57:39 +0000</pubDate><guid>https://davidham3.github.io/blog/p/stg2seq-spatial-temporal-graph-to-sequence-model-for-multi-step-passenger-demand-forecasting/</guid><description>&lt;p&gt;IJCAI 2019. åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1905.10069.pdf" target="_blank" rel="noopener"
&gt;STG2Seq: Spatial-temporal Graph to Sequence Model for Multi-step Passenger
Demand Forecasting&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;å¤šæ­¥ä¹˜å®¢éœ€æ±‚é¢„æµ‹å¯¹äºæŒ‰éœ€è½¦è¾†å…±äº«æœåŠ¡æ¥è¯´æ˜¯ä¸ªé‡è¦çš„ä»»åŠ¡ã€‚ç„¶è€Œï¼Œé¢„æµ‹å¤šä¸ªæ—¶åˆ»çš„ä¹˜å®¢éœ€æ±‚ç”±äºæ—¶ç©ºä¾èµ–çš„éçº¿æ€§å’ŒåŠ¨æ€æ€§å¾ˆæœ‰æŒ‘æˆ˜ã€‚æˆ‘ä»¬æå‡ºäº†åŸºäºå›¾çš„åŸå¸‚èŒƒå›´çš„æ—…å®¢éœ€æ±‚é¢„æµ‹æ¨¡å‹ï¼Œä½¿ç”¨ä¸€ä¸ªå±‚æ¬¡å›¾å·ç§¯åŒæ—¶æ•è·ç©ºé—´å’Œæ—¶é—´å…³è”æ€§ã€‚æˆ‘ä»¬çš„æ¨¡å‹æœ‰ä¸‰éƒ¨åˆ†ï¼š1) é•¿æœŸç¼–ç å™¨å¯¹å†å²æ—…å®¢éœ€æ±‚ç¼–ç ï¼›2) çŸ­æœŸç¼–ç å™¨æ¨å¯¼ä¸‹ä¸€æ­¥é¢„æµ‹ç»“æœæ¥ç”Ÿæˆå¤šæ­¥é¢„æµ‹ï¼›3) ä½¿ç”¨ä¸€ä¸ªåŸºäºæ³¨æ„åŠ›çš„è¾“å‡ºæ¨¡å—å¯¹åŠ¨æ€çš„æ—¶é—´å’Œå„é€šé“ä¿¡æ¯å»ºæ¨¡ã€‚å®éªŒåœ¨ä¸‰ä¸ªæ•°æ®é›†ä¸Šè¡¨æ˜æˆ‘ä»¬çš„æ–¹æ³•æ¯”å¾ˆå¤šæ–¹æ³•å¥½ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1. Introduction
&lt;/h1&gt;&lt;h1 id="2-notations-and-problem-statement"&gt;2. Notations and Problem Statement
&lt;/h1&gt;&lt;p&gt;å‡è®¾ä¸€ä¸ªåŸå¸‚åˆ†æˆ $N$ ä¸ªå°çš„åŒºåŸŸï¼Œä¸è€ƒè™‘æ˜¯åˆ†æˆç½‘æ ¼è¿˜æ˜¯è·¯ç½‘ã€‚æˆ‘ä»¬å°†åŒºåŸŸçš„é›†åˆè¡¨ç¤ºä¸º $\lbrace r_1, r_2, \dots, r_i, \dots r_N \rbrace$ã€‚åœ¨æ¯ä¸ªæ—¶é—´æ­¥ $t$ï¼Œä¸€ä¸ªäºŒç»´çŸ©é˜µ $\boldsymbol{D_t} \in \mathbb{R}^{N \times d_{in}}$ è¡¨ç¤ºæ‰€æœ‰åŒºåŸŸåœ¨æ—¶é—´ $t$ çš„æ—…å®¢éœ€æ±‚ã€‚å¦ä¸€ä¸ªå‘é‡ $\boldsymbol{E_t} \in \mathbb{R}^{d_e}$ è¡¨ç¤ºæ—¶é—´æ­¥ $t$ çš„æ—¶é—´ç‰¹å¾ï¼ŒåŒ…å«äº†å‡ ç‚¹ã€æ˜ŸæœŸå‡ ä»¥åŠèŠ‚å‡æ—¥çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®šåŸå¸‚èŒƒå›´çš„å†å²æ—…å®¢éœ€æ±‚åºåˆ— $\lbrace \bm{D_0}, \bm{D_1}, \dots, \bm{D_t} \rbrace$ å’Œæ—¶é—´ç‰¹å¾ $\lbrace \bm{E_0}, \bm{E_1}, \dots, \bm{E_{t+\tau}} \rbrace$ï¼Œç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªé¢„æµ‹å‡½æ•° $\Gamma(\cdot)$ æ¥é¢„æµ‹æ¥ä¸‹æ¥çš„ $\tau$ ä¸ªæ—¶é—´æ­¥ä¸ŠåŸå¸‚èŒƒå›´çš„æ—…å®¢éœ€æ±‚åºåˆ—ã€‚æˆ‘ä»¬åªä½¿ç”¨å†å² $h$ ä¸ªæ—¶é—´æ­¥çš„éœ€æ±‚åºåˆ—ä½œä¸ºè¾“å…¥ $\lbrace \bm{D_{t-h+1}, \bm{D_{t-h+2}}, \dots, \bm{D_t}} \rbrace$ã€‚æˆ‘ä»¬çš„ä»»åŠ¡æè¿°ä¸ºï¼š&lt;/p&gt;
$$\tag{1}
(\bm{D\_{t+1}}, \bm{D\_{t+2}}, \dots, \bm{D\_{t+\tau}}) = \Gamma(\bm{D\_{t-h+1}}, \bm{D\_{t-h+2}}, \dots, \bm{D\_t}; \bm{E\_0}, \bm{E\_1}, \dots, \bm{E\_{t+\tau}})
$$&lt;h1 id="3-methodology"&gt;3. Methodology
&lt;/h1&gt;&lt;p&gt;STG2Seq çš„æ¶æ„æœ‰ä¸‰ä¸ªç»„ä»¶ï¼š1. é•¿æœŸç¼–ç å™¨ï¼Œ2. çŸ­æœŸç¼–ç å™¨ï¼Œ3.åŸºäºæ³¨æ„åŠ›çš„è¾“å‡ºæ¨¡å—ã€‚é•¿æœŸå’ŒçŸ­æœŸç¼–ç å™¨ç”±å¤šä¸ªåºåˆ—æ—¶ç©ºé—¨æ§å›¾å·ç§¯æ¨¡å— (GGCM) ç»„æˆï¼Œé€šè¿‡åœ¨æ—¶é—´ç»´åº¦ä½¿ç”¨ GCN å¯ä»¥åŒæ—¶æ•è·æ—¶é—´å’Œç©ºé—´ç›¸å…³æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/stg2seq-spatial-temporal-graph-to-sequence-model-for-multi-step-passenger-demand-forecasting/Fig2.JPG"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;h2 id="31-passenger-demand-on-graph"&gt;3.1 Passenger Demand on Graph
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬å…ˆä»‹ç»å¦‚ä½•å°†åŸå¸‚èŒƒå›´çš„æ—…å®¢éœ€æ±‚åœ¨å›¾ä¸Šæè¿°å‡ºæ¥ã€‚ä¹‹å‰çš„å·¥ä½œå‡è®¾ä¸€ä¸ªåŒºåŸŸçš„æ—…å®¢éœ€æ±‚ä¼šè¢«è¿‘é‚»çš„åŒºåŸŸå½±å“ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬è®¤ä¸ºç©ºé—´å…³ç³»å¹¶ä¸æ˜¯ä»…ä¾èµ–ç©ºé—´ä½ç½®ã€‚å¦‚æœé¥è¿œçš„åŒºåŸŸå’Œå½“å‰åŒºåŸŸæœ‰ç›¸ä¼¼çš„åœ°æ–¹ï¼Œæ¯”å¦‚å…·æœ‰ç›¸ä¼¼çš„ POIï¼Œé‚£ä¹ˆä¹Ÿå¯èƒ½æ‹¥æœ‰ç›¸åŒçš„æ—…å®¢éœ€æ±‚æ¨¡å¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†åŸå¸‚çœ‹ä½œä¸€ä¸ªå›¾ $G = (v, \xi, A)$ï¼Œ$v$ æ˜¯åŒºåŸŸçš„é›†åˆ $v = \lbrace r_i \mid i=1,2,\dots,N \rbrace$ï¼Œ$\xi$ è¡¨ç¤ºè¾¹çš„é›†åˆï¼Œ$A$ æ˜¯é‚»æ¥çŸ©é˜µã€‚æˆ‘ä»¬æ ¹æ®åŒºåŸŸé—´æ—…å®¢éœ€æ±‚æ¨¡å¼çš„ç›¸ä¼¼æ€§å®šä¹‰å›¾çš„è¾¹ã€‚&lt;/p&gt;
$$\tag{2}
A\_{i, j} = \begin{cases}
1, \quad \text{if} \quad Similarity\_{r\_i, r\_j} &gt; \epsilon\\
0, \quad \text{otherwise}
\end{cases}
$$&lt;p&gt;å…¶ä¸­ $\epsilon$ æ˜¯é˜ˆå€¼ï¼Œæ§åˆ¶ $A$ çš„ç¨€ç–ç¨‹åº¦ã€‚ä¸ºäº†å®šé‡åŒºåŸŸé—´çš„æ—…å®¢éœ€æ±‚æ¨¡å¼çš„ç›¸ä¼¼æ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨çš®å°”é€Šç›¸å…³ç³»æ•°ã€‚$D_{0\text{\textasciitilde}t}(r_i)$ è¡¨ç¤ºæ—¶é—´ä» 0 åˆ° $t$ çš„åŒºåŸŸ $r_i$ å†å²æ—…å®¢éœ€æ±‚åºåˆ—ã€‚$r_i$ å’Œ $r_j$ ä¹‹é—´çš„ç›¸ä¼¼åº¦å¯ä»¥å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{3}
Similarity\_{r\_i, r\_j} = Pearson(D\_{0\text{\textasciitilde}t}(r\_i), D\_{0\text{\textasciitilde}t}(r\_j))
$$&lt;h2 id="32-long-term-and-short-term-encoders"&gt;3.2 Long-term and Short-term Encoders
&lt;/h2&gt;&lt;p&gt;å¾ˆå¤šä¹‹å‰çš„å·¥ä½œåªè€ƒè™‘ä¸‹ä¸€æ­¥é¢„æµ‹ï¼Œå³é¢„æµ‹ä¸‹ä¸€æ—¶é—´æ­¥çš„æ—…å®¢éœ€æ±‚ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­é€šè¿‡å‡å°‘ä¸‹ä¸€æ—¶é—´æ­¥é¢„æµ‹å€¼çš„è¯¯å·®è€Œä¸è€ƒè™‘åç»­æ—¶é—´æ­¥çš„è¯¯å·®æ¥ä¼˜åŒ–æ¨¡å‹ã€‚å› æ­¤ï¼Œè¿™äº›æ–¹æ³•åœ¨å¤šæ­¥é¢„æµ‹çš„é—®é¢˜ä¸Šä¼šé€€åŒ–ã€‚ä»…æœ‰ä¸€äº›å·¥ä½œè€ƒè™‘äº†å¤šæ­¥é¢„æµ‹çš„é—®é¢˜ [Xingjian et al., 2015; Li et al., 2018]ã€‚è¿™äº›å·¥ä½œé‡‡ç”¨äº†åŸºäº RNN çš„ç¼–ç è§£ç å™¨çš„æ¶æ„ï¼Œæˆ–æ˜¯å®ƒçš„å˜ä½“ï¼Œæ¯”å¦‚ ConvLSTM è¿™æ ·çš„ä½œä¸ºç¼–ç è§£ç å™¨ã€‚è¿™äº›æ–¹æ³•æœ‰ä¸¤ä¸ªåŠ£åŠ¿ï¼š1. é“¾çŠ¶ç»“æ„çš„ RNN åœ¨ç¼–ç çš„æ—¶å€™éœ€è¦éå†è¾“å…¥çš„æ—¶é—´æ­¥ã€‚å› æ­¤ä»–ä»¬éœ€è¦ä¸è¾“å…¥åºåˆ—ç­‰é•¿çš„ RNN å•å…ƒä¸ªæ•°ï¼ˆåºåˆ—å¤šé•¿ï¼ŒRNNå•å…ƒå°±æœ‰å¤šå°‘ä¸ªï¼‰ã€‚åœ¨ç›®æ ‡éœ€æ±‚å’Œå‰ä¸€ä¸ªéœ€æ±‚ä¸Šçš„é•¿è·ç¦»è®¡ç®—ä¼šå¯¼è‡´ä¸€äº›ä¿¡æ¯çš„é—å¿˜ã€‚2. åœ¨è§£ç éƒ¨åˆ†ï¼Œä¸ºäº†é¢„æµ‹æ—¶é—´æ­¥ $T$ çš„éœ€æ±‚ï¼ŒRNN å°†éšè—çŠ¶æ€å’Œå‰ä¸€æ—¶é—´æ­¥ $T-1$ ä½œä¸ºè¾“å…¥ã€‚å› æ­¤ï¼Œå‰ä¸€æ—¶é—´æ­¥å¸¦æ¥çš„è¯¯å·®ä¼šç›´æ¥å½±å“åˆ°é¢„æµ‹ï¼Œå¯¼è‡´æœªæ¥æ—¶é—´æ­¥è¯¯å·®çš„ç´¯ç§¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸åŒäºä¹‹å‰æ‰€æœ‰çš„å·¥ä½œï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ªä¾èµ–äºåŒæ—¶ä½¿ç”¨é•¿æœŸå’ŒçŸ­æœŸç¼–ç å™¨çš„æ¶æ„ï¼Œä¸ç”¨ RNN åšå¤šæ­¥é¢„æµ‹ã€‚é•¿æœŸç¼–ç å™¨å–æœ€è¿‘çš„ $h$ ä¸ªæ—¶é—´æ­¥çš„åŸå¸‚å†å²æ—…å®¢éœ€æ±‚åºåˆ— $\lbrace \bm{D_{t-h+1}}, \bm{D_{t-h+2}}, \dots, \bm{D_t} \rbrace$ ä½œä¸ºè¾“å…¥æ¥å­¦ä¹ å†å²çš„æ—¶ç©ºæ¨¡å¼ã€‚è¿™ $h$ æ­¥éœ€æ±‚åˆå¹¶åç»„ç»‡æˆä¸‰ç»´çŸ©é˜µï¼Œ$h \times N \times d_{in}$ã€‚é•¿æœŸç¼–ç å™¨ç”±ä¸€äº› GGCM ç»„æˆï¼Œæ¯ä¸ª GCGGM æ•è·åœ¨æ‰€æœ‰çš„ $N$ ä¸ªåŒºåŸŸä¸Šæ•è·ç©ºé—´å…³è”æ€§ï¼Œåœ¨ $k$ ä¸ªæ—¶é—´æ­¥ä¸Šæ•è·æ—¶é—´å…³è”æ€§ã€‚$k$ æ˜¯è¶…å‚æ•°ï¼Œæˆ‘ä»¬ä¼šåœ¨ 3.3 èŠ‚è®¨è®ºã€‚å› æ­¤ï¼Œåªéœ€è¦ $\frac{h-1}{k-1}$ ä¸ªè¿­ä»£çš„æ­¥æ•°å°±å¯ä»¥æ•è· $h$ ä¸ªæ—¶é—´æ­¥ä¸Šçš„æ—¶é—´å…³è”æ€§ã€‚å¯¹æ¯” RNN ç»“æ„ï¼Œæˆ‘ä»¬çš„åŸºäº GGCM çš„é•¿æœŸç¼–ç å™¨æ˜¾è‘—çš„é™ä½äº†éå†é•¿åº¦ï¼Œè¿›ä¸€æ­¥å‡å°‘äº†ä¿¡æ¯çš„æŸå¤±ã€‚é•¿æœŸç¼–ç å™¨çš„è¾“å‡º $Y_h$ çš„ç»´æ•°æ˜¯ $h \times N \times d_{out}$ï¼Œæ˜¯è¾“å…¥çš„ç¼–ç è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;çŸ­æœŸç¼–ç å™¨ç”¨æ¥é›†æˆå·²ç»é¢„æµ‹çš„éœ€æ±‚ï¼Œç”¨äºå¤šæ­¥é¢„æµ‹ã€‚å®ƒä½¿ç”¨ä¸€ä¸ªé•¿åº¦ä¸º $q$ çš„æ»‘åŠ¨çª—æ¥æ•è·è¿‘æœŸçš„æ—¶ç©ºå…³è”æ€§ã€‚å½“é¢„æµ‹åœ¨ $T(T \in [t+1,t+\tau])$ æ­¥çš„æ—…å®¢éœ€æ±‚æ—¶ï¼Œå®ƒå–æœ€è¿‘çš„ $q$ ä¸ªæ—¶é—´æ­¥çš„æ—…å®¢éœ€æ±‚ï¼Œå³ $\lbrace \bm{D_{T-q}}, \bm{D_{T-q+1}}, \dots, \bm{D_{T-1}} \rbrace$ ä½œä¸ºè¾“å…¥ã€‚é™¤äº†æ—¶é—´æ­¥çš„é•¿åº¦ä»¥å¤–ï¼ŒçŸ­æœŸç¼–ç å™¨å’Œé•¿æœŸç¼–ç å™¨ä¸€æ ·ã€‚çŸ­æœŸç¼–ç å™¨ç”Ÿæˆä¸€ä¸ªç»´æ•°ä¸º $q \times N \times d_{out}$ çš„çŸ©é˜µ $Y^T_q$ ä½œä¸ºè¿‘æœŸè¶‹åŠ¿è¡¨ç¤ºã€‚å’ŒåŸºäº RNN çš„è§£ç å™¨ä¸åŒçš„æ˜¯ï¼ŒRNNçš„è§£ç å™¨åªå°†æœ€åä¸€ä¸ªæ—¶é—´æ­¥çš„é¢„æµ‹ç»“æœè¾“å…¥å›å»ã€‚å› æ­¤ï¼Œé¢„æµ‹è¯¯å·®ä¼šè¢«é•¿æœŸç¼–ç å™¨å°æŸ”ï¼Œå‡è½»åŸºäº RNN çš„è§£ç å™¨ä¼šå¯¼è‡´è¯¯å·®ç´¯ç§¯çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id="33-gated-graph-convolutional-module"&gt;3.3 Gated Graph Convolutional Module
&lt;/h2&gt;&lt;p&gt;é—¨æ§å›¾å·ç§¯æ¨¡å—æ˜¯é•¿æœŸç¼–ç å™¨å’ŒçŸ­æœŸç¼–ç å™¨çš„æ ¸å¿ƒã€‚æ¯ä¸ª GGCM ç”±å‡ ä¸ª GCN å±‚ç»„æˆï¼Œæ²¿ç€æ—¶é—´è½´å¹¶è¡Œã€‚ä¸ºäº†æ•è·æ—¶ç©ºå…³è”æ€§ï¼Œæ¯ä¸ª GCN åœ¨ä¸€å®šé•¿åº¦çš„æ—¶é—´çª—å†…æ“ä½œ($k$)ã€‚å®ƒå¯ä»¥æå– $k$ ä¸ªæ—¶é—´æ­¥å†…æ‰€æœ‰åŒºåŸŸçš„ç©ºé—´å…³è”æ€§ã€‚é€šè¿‡å †å å¤šä¸ª GGCMï¼Œæˆ‘ä»¬çš„æ¨¡å‹å½¢æˆäº†ä¸€ä¸ªå±‚æ¬¡ç»“æ„ï¼Œå¯ä»¥æ•è·æ•´ä¸ªè¾“å…¥çš„æ—¶ç©ºå…³è”æ€§ã€‚å›¾ 3 å±•ç¤ºäº†åªä½¿ç”¨ GCN æ•è·æ—¶ç©ºå…³è”æ€§ï¼Œä¸ºäº†ç®€åŒ–æˆ‘ä»¬å¿½ç•¥äº†é€šé“ç»´ã€‚Yu et al., 2018 çš„å·¥ä½œå’Œæˆ‘ä»¬çš„ GGCM æ¨¡å—å¾ˆåƒã€‚ä»–ä»¬çš„å·¥ä½œé¦–å…ˆä½¿ç”¨ CNN æ•è·æ—¶é—´å…³è”æ€§ï¼Œç„¶åä½¿ç”¨ GCN æ•è·ç©ºé—´å…³è”æ€§ã€‚æˆ‘ä»¬çš„æ–¹æ³•å¯¹æ¯”ä»–ä»¬çš„æ–¹æ³•æå¤§çš„ç®€åŒ–äº†ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥åŒæ—¶æ•è·æ—¶ç©ºå…³è”æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/stg2seq-spatial-temporal-graph-to-sequence-model-for-multi-step-passenger-demand-forecasting/Fig3.JPG"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/stg2seq-spatial-temporal-graph-to-sequence-model-for-multi-step-passenger-demand-forecasting/Fig4.JPG"
loading="lazy"
alt="Figure4"
&gt;&lt;/p&gt;
&lt;p&gt;GGCM æ¨¡å—çš„è¯¦ç»†è®¾è®¡å¦‚å›¾ 4ã€‚ç¬¬ $l$ ä¸ª GGCM çš„è¾“å…¥æ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œç»´æ•°ä¸º $h \times N \times C^l$ã€‚åœ¨ç¬¬ä¸€ä¸ª GGCM æ¨¡å—ï¼Œ$C^l$ æ˜¯ $d_{in}$ ç»´çš„ã€‚ç¬¬ $l$ ä¸ª GGCM çš„è¾“å‡ºæ˜¯ $h \times N \times C^{l+1}$ã€‚æˆ‘ä»¬å…ˆæ‹¼æ¥ä¸€ä¸ª zero paddingï¼Œç»´æ•°ä¸º $(k-1) \times N \times C^l$ï¼Œå¾—åˆ°æ–°çš„è¾“å…¥ $(h+k-1) \times N \times C^l$ï¼Œç¡®ä¿å˜æ¢ä¸ä¼šå‡å°‘åºåˆ—çš„é•¿åº¦ã€‚æ¥ä¸‹æ¥ï¼ŒGGCM ä¸­çš„æ¯ä¸ª GCN å– $k$ ä¸ªæ—¶é—´æ­¥çš„æ•°æ® $k \times N \times C^l$ ä½œä¸ºè¾“å…¥æ¥æå–æ—¶ç©ºå…³è”æ€§ï¼Œç„¶å reshape æˆä¸€ä¸ªäºŒç»´çŸ©é˜µ $N \times (k \cdot C^l)$ã€‚æ ¹æ® Kipf &amp;amp; Welling çš„ GCNï¼ŒGCN å±‚å¯ä»¥æè¿°å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{4}
X^{l+1} = (\tilde{P}^{-\frac{1}{2}} \tilde{A} \tilde{P}^{-\frac{1}{2}}) X^l W
$$&lt;p&gt;$\tilde{A} = A + I_n$ï¼Œ$\tilde{P}_{ii} = \sum_j \tilde{A}_{ij}$ï¼Œ$X \in \mathbb{R}^{N \times (k \cdot C^l)}$ï¼Œ$W \in \mathbb{R}^{(k \cdot C^l) \times C^{l+1}}$ï¼Œ$X^{l+1} \in \mathbb{R}^{N \times C^{l+1}}$
ã€‚&lt;/p&gt;
&lt;p&gt;é™¤æ­¤ä»¥å¤–ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†é—¨æ§æœºåˆ¶å¯¹æ—…å®¢éœ€æ±‚é¢„æµ‹çš„å¤æ‚éçº¿æ€§å»ºæ¨¡ã€‚å¼ 4 é‡æ–°æè¿°å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{5}
X^{l+1} = ((\tilde{P}^{-\frac{1}{2}} \tilde{A} \tilde{P}^{-\frac{1}{2}}) X^l W\_1 + X^l) \otimes \sigma((\tilde{P}^{-\frac{1}{2}} \tilde{A} \tilde{P}^{-\frac{1}{2}}) X^l W\_2)
$$&lt;p&gt;$\otimes$ æ˜¯å¯¹åº”å…ƒç´ ç›¸ä¹˜ï¼Œ$\sigma$æ˜¯ sigmoid æ¿€æ´»å‡½æ•°ã€‚å› æ­¤è¾“å‡ºæ˜¯ä¸€ä¸ªéçº¿æ€§é—¨ $\sigma((\tilde{P}^{-\frac{1}{2}} \tilde{A} \tilde{P}^{-\frac{1}{2}}) X^l W_2)$ æ§åˆ¶çš„çº¿æ€§å˜æ¢ $((\tilde{P}^{-\frac{1}{2}} \tilde{A} \tilde{P}^{-\frac{1}{2}}) X^l W_1 + X^l)$ã€‚éçº¿æ€§é—¨æ§åˆ¶çº¿æ€§å˜æ¢çš„å“ªä¸ªéƒ¨åˆ†å¯ä»¥é€šè¿‡é—¨å½±å“é¢„æµ‹ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä½¿ç”¨æ®‹å·®è¿æ¥æ¥é¿å…å¼ 5 ä¸­çš„ç½‘ç»œé€€åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œé—¨æ§æœºåˆ¶äº§ç”Ÿçš„ $h$ ä¸ªè¾“å‡ºæ²¿æ—¶é—´è½´åˆå¹¶ï¼Œç”Ÿæˆ GGCM æ¨¡å—çš„è¾“å‡º $h \times N \times C^{l+1}$ã€‚&lt;/p&gt;
&lt;h2 id="34-attention-based-output-module"&gt;3.4 Attention-based Output Module
&lt;/h2&gt;&lt;p&gt;å¦‚ 3.2 æè¿°çš„é‚£æ ·ï¼Œé•¿æœŸæ—¶ç©ºä¾èµ–å’Œ $T$ æ—¶é—´æ­¥çš„è¿‘æœŸæ—¶ç©ºä¾èµ–é€šè¿‡ä¸¤ä¸ªçŸ©é˜µæè¿° $Y_h$ å’Œ $Y^T_q$ã€‚æˆ‘ä»¬æ‹¼æ¥ã€‚æˆ‘ä»¬æ‹¼æ¥ä»–ä»¬å½¢æˆè”åˆè¡¨ç¤º $Y_{h+q} \in \mathbb{R}^{(h+q) \times N \times d_{out}}$ï¼Œé€šè¿‡ä¸€ä¸ªåŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„æ¨¡å—è§£ç è·å¾—é¢„æµ‹å€¼ã€‚è¿™é‡Œä¸ºäº†ç®€ä¾¿å¿½ç•¥ $T$ã€‚$Y_{h+q}$ çš„ä¸‰ä¸ªè½´åˆ†åˆ«æ˜¯æ—¶é—´ã€ç©ºé—´ã€é€šé“ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆå¼•å…¥ä¸€ä¸ªæ—¶é—´æ³¨æ„åŠ›æœºåˆ¶æ¥è§£ç  $Y_{h+q}$ã€‚æ—…å®¢éœ€æ±‚æ˜¯ä¸€ä¸ªå…¸å‹çš„æ—¶é—´åºåˆ—ï¼Œå‰ä¸€æ—¶åˆ»çš„éœ€æ±‚å¯¹åä¸€æ—¶åˆ»æœ‰å½±å“ã€‚ç„¶è€Œï¼Œä¹‹å‰çš„æ¯ä¸€æ­¥å¯¹é¢„æµ‹ç›®æ ‡çš„å½±å“æ˜¯ä¸åŒçš„ï¼Œå½±å“éšæ—¶é—´å˜åŒ–ã€‚æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªæ—¶é—´æ³¨æ„åŠ›æœºåˆ¶å¯¹æ¯ä¸ªå†å²æ—¶é—´æ­¥å¢åŠ æ³¨æ„åŠ›åˆ†æ•°è¡¡é‡å…¶å½±å“ã€‚åˆ†æ•°é€šè¿‡ $Y_{h+q} = [y_1, y_2, \dots, y_{h+q}](y_i \in \mathbb{R}^{N \times d_{out}})$ å’Œç›®æ ‡æ—¶é—´æ­¥çš„æ—¶é—´ç‰¹å¾ $\bm{E}_T$ ç”Ÿæˆï¼Œè¿™ä¸ªåˆ†æ•°å¯ä»¥è‡ªé€‚åº”åœ°å­¦ä¹ ä¹‹å‰çš„æ—¶é—´æ­¥éšæ—¶é—´çš„åŠ¨æ€å½±å“ã€‚æˆ‘ä»¬å®šä¹‰æ—¶é—´æ³¨æ„åŠ›åˆ†æ•°å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{6}
\bm{\alpha} = softmax(tanh(Y\_{h+q} W^Y\_3 + E\_T W^E\_4 + b\_1))
$$&lt;p&gt;$W^Y_3 \in \mathbb{R}^{(h+q) \times (N \times d_{out}) \times 1}$ï¼Œ$W^E_4 \in \mathbb{R}^{d_e \times (h+q)}$ï¼Œ$b_1 \in \mathbb{R}^{(h+q)}$ã€‚è”åˆè¡¨ç¤º $Y_{h+q}$ é€šè¿‡æ³¨æ„åŠ›åˆ†æ•° $\bm{\alpha}$ è½¬æ¢ï¼š&lt;/p&gt;
$$\tag{7}
Y\_{\alpha} = \sum^{h+q}\_{i=1} \alpha^i y\_i \quad \in \mathbb{R}^{N \times d\_{out}}
$$&lt;p&gt;å—åˆ° [Chen et al., 2017] çš„å¯å‘ï¼Œæ¯ä¸ªé€šé“çš„é‡è¦æ€§æ˜¯ä¸åŒçš„ï¼Œæˆ‘ä»¬åœ¨æ—¶é—´æ³¨æ„åŠ›åé¢åŠ äº†ä¸€ä¸ªé€šé“æ³¨æ„åŠ›æ¨¡å—æ¥æ‰¾åˆ° $Y_\alpha = [y_1, y_2, \dots, y_{d_{out}}]$ ä¸­æœ€é‡è¦çš„é‚£ä¸ªã€‚è®¡ç®—å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{8}
\bm\beta = softmax(tanh(Y\_\alpha W^Y\_5 + E\_T W^E\_6 + b\_2))
$$$$\tag{9}
Y\_{\beta} = \sum^{d\_{out}}\_{i=1} \beta^i y\_i \quad \mathbb{R}^N
$$&lt;p&gt;å…¶ä¸­ï¼Œ$W^Y_5 \in \mathbb{R}^{d_{out} \times N \times 1}$ï¼Œ$W^E_6 \in \mathbb{R}^{d_e \times d_{out}}$ï¼›$\bm\beta \in \mathbb{R}^{d_{out}}$ æ˜¯æ¯ä¸ªé€šé“çš„æ³¨æ„åŠ›åˆ†æ•°ã€‚å½“é¢„æµ‹çš„ç»´åº¦æ˜¯1æ—¶ï¼Œ$Y_\beta$ å°±æ˜¯æˆ‘ä»¬é¢„æµ‹çš„æ—…å®¢éœ€æ±‚ $\bm{D&amp;rsquo;_T}$ã€‚å½“é¢„æµ‹ç»´åº¦æ˜¯ 2 æ—¶ï¼ˆé¢„æµ‹èµ·æ­¢éœ€æ±‚ï¼‰ï¼Œæˆ‘ä»¬ç»™æ¯ä¸ªé€šé“è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°ï¼Œå°†ä»–ä»¬æ‹¼æ¥èµ·æ¥å¾—åˆ°æœ€åçš„é¢„æµ‹å€¼ã€‚&lt;/p&gt;</description></item><item><title>Self-Attention Graph Pooling</title><link>https://davidham3.github.io/blog/p/self-attention-graph-pooling/</link><pubDate>Tue, 25 Jun 2019 16:34:02 +0000</pubDate><guid>https://davidham3.github.io/blog/p/self-attention-graph-pooling/</guid><description>&lt;p&gt;ICML 2019ï¼ŒåŸæ–‡åœ°å€ï¼š&lt;a class="link" href="https://arxiv.org/abs/1904.08082" target="_blank" rel="noopener"
&gt;Self-Attention Graph Pooling&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;è¿™äº›å¹´æœ‰ä¸€äº›å…ˆè¿›çš„æ–¹æ³•å°†æ·±åº¦å­¦ä¹ åº”ç”¨åˆ°äº†å›¾æ•°æ®ä¸Šã€‚ç ”ç©¶ä¸“æ³¨äºå°†å·ç§¯ç¥ç»ç½‘ç»œæ¨å¹¿åˆ°å›¾æ•°æ®ä¸Šï¼ŒåŒ…æ‹¬é‡æ–°å®šä¹‰å›¾ä¸Šçš„å·ç§¯å’Œä¸‹é‡‡æ ·ï¼ˆæ± åŒ–ï¼‰ã€‚æ¨å¹¿çš„å·ç§¯æ–¹æ³•å·²ç»è¢«è¯æ˜æœ‰æ€§èƒ½æå‡ä¸”è¢«å¹¿æ³›ä½¿ç”¨ã€‚ä½†æ˜¯ï¼Œä¸‹é‡‡æ ·çš„æ–¹æ³•ä»ç„¶æ˜¯ä¸€ä¸ªéš¾é¢˜ä¸”æœ‰æå‡ç©ºé—´ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªåŸºäºè‡ªæ³¨æ„åŠ›çš„å›¾çš„æ± åŒ–æ–¹æ³•ã€‚ä½¿ç”¨å›¾å·ç§¯çš„è‡ªæ³¨æ„åŠ›ä½¿å¾—æˆ‘ä»¬çš„æ± åŒ–æ–¹æ³•å¯ä»¥åŒæ—¶è€ƒè™‘é¡¶ç‚¹ç‰¹å¾å’Œå›¾çš„æ‹“æ‰‘ç»“æ„ã€‚ä¸ºäº†ç¡®ä¿ä¸€ä¸ªå…¬å¹³çš„å¯¹æ¯”ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ç›¸åŒçš„è®­ç»ƒæ­¥éª¤å’Œæ¨¡å‹æ¶æ„ã€‚å®éªŒç»“æœæ˜¾ç¤ºæˆ‘ä»¬çš„æ–¹æ³•æœ‰æ›´é«˜çš„åˆ†ç±»ç²¾åº¦ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1. Introduction
&lt;/h1&gt;&lt;p&gt;CNN æˆåŠŸåˆ©ç”¨äº†å›¾åƒã€è¯­éŸ³ã€è§†é¢‘æ•°æ®ä¸­çš„æ¬§æ°ç©ºé—´ï¼ˆç½‘æ ¼ç»“æ„ï¼‰ã€‚CNN ç”±å·ç§¯å±‚å’Œä¸‹é‡‡æ ·å±‚ï¼ˆæ± åŒ–å±‚ï¼‰ç»„æˆã€‚å·ç§¯å±‚å’Œæ± åŒ–å±‚æŒ–æ˜äº†ç½‘æ ¼æ•°æ®çš„å¹³ç§»ä¸å˜æ€§å’Œcompositionalityï¼ˆè¿™ä¸ªæˆ‘ä¸çŸ¥é“æ˜¯ä»€ä¹ˆã€‚ã€‚ã€‚ï¼‰ã€‚ç»“æœæ˜¯ï¼ŒCNN ç”¨å°‘é‡çš„å‚æ•°å°±å¯ä»¥è¡¨ç°çš„å¾ˆå¥½ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œå¾ˆå¤šæ•°æ®æ˜¯éæ¬§ç©ºé—´ä¸Šçš„ã€‚ç¤¾äº¤ç½‘ç»œã€ç”Ÿç‰©è›‹ç™½è´¨ç½‘ç»œã€åˆ†å­ç½‘ç»œå¯ä»¥è¡¨ç¤ºæˆç½‘ç»œã€‚å°† CNN åº”ç”¨åœ¨éæ¬§ç©ºé—´ä¸Šçš„å°è¯•å·²ç»è·å¾—äº†æˆåŠŸã€‚å¾ˆå¤šç ”ç©¶é‡æ–°å®šä¹‰äº†å›¾ä¸Šçš„å·ç§¯å’Œæ± åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå›¾å·ç§¯çš„æ± åŒ–æ“ä½œç°åœ¨æ¯”è¾ƒå°‘ã€‚ä¹‹å‰å›¾çš„æ± åŒ–çš„ç ”ç©¶åªè€ƒè™‘å›¾çš„æ‹“æ‰‘ç»“æ„ (Defferrard et al., 2016; Rhee et al., 2018)ã€‚ä¸€äº›æ–¹æ³•åˆ©ç”¨äº†ç»“ç‚¹çš„ç‰¹å¾è·å¾—ä¸€ä¸ªå°å›¾çš„è¡¨ç¤ºã€‚æœ€è¿‘ï¼ŒYing et al.; Gao &amp;amp; Ji; Cangea et al. æå‡ºäº†åˆ›æ–°çš„æ± åŒ–æ–¹æ³•ï¼Œå¯ä»¥å±‚çº§çš„è¡¨ç¤ºå›¾ã€‚è¿™äº›æ–¹æ³•ä½¿å¾—å›¾ç¥ç»ç½‘ç»œå¯ä»¥é€šè¿‡ç«¯åˆ°ç«¯çš„å½¢å¼ï¼Œåœ¨æ± åŒ–åè·å¾—å°ºå¯¸ç¼©å‡çš„å›¾ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œä¸Šè¿°çš„æ± åŒ–æ–¹æ³•ä»æœ‰æå‡ç©ºé—´ã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒYing et al. çš„å¯å¾®å±‚çº§æ± åŒ–æ–¹æ³•æœ‰å¹³æ–¹çº§åˆ«çš„ç©ºé—´å¤æ‚åº¦ï¼Œå‚æ•°ä¾èµ–äºé¡¶ç‚¹æ•°ã€‚Gao &amp;amp; Ji; Cangea et al. è§£å†³äº†å¤æ‚åº¦çš„é—®é¢˜ï¼Œä½†æ˜¯æ²¡æœ‰è€ƒè™‘å›¾çš„æ‹“æ‰‘ç»“æ„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æå‡ºçš„ SAGPool æ˜¯ä¸€ä¸ªå±‚æ¬¡çš„è‡ªæ³¨æ„åŠ›å›¾æ± åŒ–æ–¹æ³•ã€‚æˆ‘ä»¬çš„æ–¹æ³•å¯ä»¥é€šè¿‡ç«¯åˆ°ç«¯çš„æ–¹å¼ä½¿ç”¨ç›¸å¯¹è¾ƒå°‘çš„å‚æ•°å­¦ä¹ åˆ°å±‚æ¬¡è¡¨ç¤ºã€‚è‡ªæ³¨æ„åŠ›æœºåˆ¶ç”¨æ¥åŒºåˆ†ç»“ç‚¹æ˜¯å¦ä¸¢å¼ƒæ‰è¿˜æ˜¯ä¿ç•™ã€‚ç”±äºè‡ªæ³¨æ„åŠ›æœºåˆ¶ä½¿ç”¨å›¾å·ç§¯è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°ï¼Œç»“ç‚¹ç‰¹å¾å’Œå›¾çš„æ‹“æ‰‘ç»“æ„å¯ä»¥è¢«è€ƒè™‘å…¶ä¸­ã€‚ä¸€å¥è¯ï¼ŒSAGPool æœ‰å‰é¢æ–¹æ³•çš„ä¼˜ç‚¹ï¼Œæ˜¯ç¬¬ä¸€ä¸ªä½¿ç”¨è‡ªæ³¨æ„åŠ›ç”¨äºæ± åŒ–çš„æ–¹æ³•ï¼Œå¹¶ä¸”è·å¾—äº†å¾ˆå¥½çš„æ€§èƒ½ã€‚ä»£ç å·²ç»åœ¨ Github ä¸Šå¼€æºäº†ã€‚&lt;/p&gt;
&lt;h1 id="2-related-work"&gt;2. Related Work
&lt;/h1&gt;&lt;h2 id="21-graph-convolution"&gt;2.1. Graph Convolution
&lt;/h2&gt;&lt;p&gt;å›¾ä¸Šçš„å·ç§¯è¦ä¹ˆæ˜¯åŸºäºè°±çš„ï¼Œè¦ä¹ˆæ˜¯éè°±çš„ã€‚è°±æ–¹æ³•ä¸“æ³¨äºåœ¨å‚…é‡Œå¶åŸŸä¸Šå®šä¹‰å·ç§¯ï¼Œåˆ©ç”¨ä½¿ç”¨å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„è°±æ»¤æ³¢å™¨ã€‚Kipf &amp;amp; Welling æå‡ºäº†ä¸€ä¸ªå±‚çº§ä¼ æ’­çš„è§„åˆ™ï¼Œç®€åŒ–äº†ä½¿ç”¨åˆ‡æ¯”é›ªå¤«å±•å¼€æ¥è¶‹è¿‘æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„æ–¹æ³•ã€‚éè°±æ–¹æ³•çš„ç›®æ ‡æ˜¯å®šä¹‰ä¸€ä¸ªå·ç§¯æ“ä½œï¼Œå¯ä»¥ç›´æ¥åº”ç”¨åœ¨å›¾ä¸Šã€‚é€šå¸¸æ¥è¯´ï¼Œéè°±æ–¹æ³•ï¼Œä¸­å¿ƒç»“ç‚¹åœ¨ç‰¹å¾ä¼ å…¥ä¸‹å±‚ä¹‹å‰èšåˆé‚»æ¥ç»“ç‚¹çš„ç‰¹å¾ã€‚Hamilton et al. æå‡ºäº† GraphSAGEï¼Œé€šè¿‡é‡‡æ ·å’Œèšåˆå­¦ä¹ ç»“ç‚¹çš„åµŒå…¥ã€‚å°½ç®¡ GraphSAGE ä¼šé‡‡æ ·å›ºå®šæ•°é‡çš„é‚»å±…ï¼ŒGAT åŸºäºæ³¨æ„åŠ›æœºåˆ¶ï¼Œåœ¨æ‰€æœ‰çš„é‚»å±…ä¸Šè®¡ç®—ç»“ç‚¹è¡¨ç¤ºã€‚ä¸¤ä¸ªæ–¹æ³•åœ¨å›¾ç›¸å…³çš„ä»»åŠ¡ä¸Šéƒ½æœ‰æå‡ã€‚&lt;/p&gt;
&lt;h2 id="22-graph-pooling"&gt;2.2. Graph Pooling
&lt;/h2&gt;&lt;p&gt;æ± åŒ–å±‚é€šè¿‡ç¼©å‡è¡¨ç¤ºçš„å¤§å°ï¼Œä½¿å¾— CNN èƒ½å‡å°‘å‚æ•°çš„æ•°é‡ï¼Œå› æ­¤èƒ½é¿å…è¿‡æ‹Ÿåˆã€‚ä¸ºäº†æ³›åŒ– CNNï¼ŒGNN ä¸Šçš„æ± åŒ–æ˜¯å¿…è¦çš„ã€‚å›¾çš„æ± åŒ–æ–¹æ³•å¯ä»¥å½’å…¥ä¸‰ç±»ï¼šåŸºäºæ‹“æ‰‘çš„ï¼ŒåŸºäºå…¨å±€çš„ï¼ŒåŸºäºå±‚æ¬¡çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Topology based pooling&lt;/strong&gt; æ—©æœŸçš„å·¥ä½œä½¿ç”¨å›¾çš„ç¼©å‡ç®—æ³•ï¼Œè€Œä¸æ˜¯ç¥ç»ç½‘ç»œã€‚è°±èšç±»ç®—æ³•ä½¿ç”¨ç‰¹å¾å€¼åˆ†è§£è·å¾—ç¼©å‡çš„å›¾ã€‚ç„¶è€Œï¼Œç‰¹å¾å€¼åˆ†è§£çš„æ—¶é—´å¤æ‚åº¦é«˜ã€‚Graclus (Dhillon et al., 2007) ä¸ä½¿ç”¨ç‰¹å¾å‘é‡è®¡ç®—ç»™å®šå›¾çš„èšç±»ç»“æœï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªè°±èšç±»çš„ç›®æ ‡å‡½æ•°ä¸ä¸€ä¸ªå¸¦æƒçš„æ ¸ k-means ç›®æ ‡å‡½æ•°çš„ç­‰ä»·æ€§ã€‚å³ä¾¿åœ¨æœ€è¿‘çš„ GNN æ¨¡å‹ä¸­ï¼ŒGraclus ä¹Ÿè¢«ä½¿ç”¨ä½œä¸ºä¸€ä¸ªæ± åŒ–å•å…ƒã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Global pooling&lt;/strong&gt; ä¸åƒä¹‹å‰çš„æ–¹æ³•ï¼Œå…¨å±€æ± åŒ–æ–¹æ³•è€ƒè™‘å›¾çš„ç‰¹å¾ã€‚å…¨å±€æ± åŒ–æ–¹æ³•åœ¨æ¯å±‚èšåˆè¡¨ç¤ºçš„æ—¶å€™ä½¿ç”¨åŠ å’Œçš„æ–¹å¼è€Œä¸æ˜¯ç”¨ç¥ç»ç½‘ç»œã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥å¤„ç†ä¸åŒç»“æ„çš„å›¾ï¼Œå› ä¸ºå®ƒè·å¾—äº†æ‰€æœ‰çš„è¡¨ç¤ºã€‚Gilmer et al. å°† GNN çœ‹ä½œæ˜¯ä¸€ç§ä¿¡æ¯çš„ä¼ é€’è§„åˆ™ï¼Œæå‡ºäº†ä¸€ä¸ªé€šç”¨æ¡†æ¶ç”¨äºå›¾åˆ†ç±»ï¼Œæ•´ä¸ªå›¾çš„è¡¨ç¤ºå¯ä»¥é€šè¿‡ä½¿ç”¨ Set2Set (Vinyals et al., 2015) æ¥è·å¾—ã€‚SortPool (Zhang et al., 2018b) æ ¹æ®ä¸€ä¸ªå›¾çš„ç»“æ„è§’è‰²å¯¹ç»“ç‚¹åµŒå…¥æ’åºï¼Œå°†æ’åºåçš„è¡¨ç¤ºä¼ å…¥ä¸‹ä¸€å±‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hierarchical pooling&lt;/strong&gt; å…¨å±€æ± åŒ–æ–¹æ³•ä¸å­¦ä¹ å±‚æ¬¡è¡¨ç¤ºï¼Œä½†æ˜¯å¯¹äºæ•è·å›¾çš„ç»“æ„ä¿¡æ¯æ¥è¯´ï¼Œå±‚æ¬¡è¡¨ç¤ºå¾ˆå…³é”®ã€‚å±‚æ¬¡æ± åŒ–çš„åŠ¨æœºåœ¨äºåœ¨æ¯å±‚æ„å»ºä¸€ä¸ªæ¨¡å‹ï¼Œè¿™ä¸ªæ¨¡å‹å¯ä»¥å­¦ä¹ åŸºäºç‰¹å¾çš„æˆ–åŸºäºæ‹“æ‰‘çš„é¡¶ç‚¹åˆ†é…ã€‚Ying et al. æå‡ºäº† DiffPoolï¼Œè¿™æ˜¯ä¸€ç§å¯å¾®çš„å›¾çš„æ± åŒ–æ–¹æ³•ï¼Œå¯ä»¥ä»¥ç«¯åˆ°ç«¯çš„å½¢å¼å­¦ä¹ åˆ†é…çŸ©é˜µã€‚åœ¨å±‚ $l$ å­¦ä¹ åˆ°çš„åˆ†é…çŸ©é˜µ $S^{(l)} \in \mathbb{R}^{n_l \times n_{l+1}}$ åŒ…å«äº†å±‚ $l$ ä¸­çš„ç»“ç‚¹åœ¨ $l + 1$ å±‚è¢«åˆ†é…åˆ°ç±»ç°‡çš„æ¦‚ç‡ã€‚$n_l$ è¡¨ç¤ºå±‚ $l$ çš„ç»“ç‚¹æ•°ã€‚ç»“ç‚¹é€šè¿‡ä¸‹å¼æ¥åˆ†é…ï¼š&lt;/p&gt;
$$\tag{1}
S^{(l)} = \text{softmax}(\text{GNN}\_l (A^{(l)}, X^{(l)})) \\
A^{(l+1)} = S^{(l)\text{T}} A^{(l)} S^{(l)}
$$&lt;p&gt;$X$ è¡¨ç¤ºçŸ©é˜µçš„ç»“ç‚¹ç‰¹å¾ï¼Œ$A$ æ˜¯é‚»æ¥çŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;Cangea et al. ä½¿ç”¨ gPool (Gao &amp;amp; Ji, 2019) è·å¾—äº†å’Œ DiffPool ç›¸å½“çš„æ€§èƒ½ã€‚gPool éœ€è¦ $\mathcal{O}(\vert V \vert + \vert E \vert)$ çš„ç©ºé—´å¤æ‚åº¦ï¼ŒDiffPool éœ€è¦ $\mathcal{O}(k \vert V \vert^2)$ çš„ç©ºé—´å¤æ‚åº¦ã€‚$V$ï¼Œ
$E$ï¼Œ$k$ åˆ†åˆ«è¡¨ç¤ºé¡¶ç‚¹ã€è¾¹ã€æ± åŒ–æ¯”ä¾‹ã€‚gPool ä½¿ç”¨ä¸€ä¸ªå¯å­¦ä¹ çš„å‘é‡ $p$ è®¡ç®—æŠ•å½±åˆ†æ•°ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªåˆ†æ•°é€‰æ‹©æœ€é«˜çš„ç»“ç‚¹ã€‚æŠ•å½±åˆ†æ•°é€šè¿‡ $p$ å’Œæ‰€æœ‰ç»“ç‚¹çš„ç‰¹å¾å‘é‡çš„å†…ç§¯è·å¾—ã€‚åˆ†æ•°è¡¨ç¤ºç»“ç‚¹å¯ä»¥è·å¾—çš„ä¿¡æ¯é‡ã€‚ä¸‹é¢çš„å¼å­å¤§ä½“çš„æè¿°äº† gPool ä¸­çš„æ± åŒ–æ­¥éª¤ï¼š&lt;/p&gt;
$$\tag{2}
y = X^{(l)} \mathbf{p}^{(l)} / \Vert \mathbf{p}^{(l)} \Vert, \text{idx=top-rank}(y, \lceil kN \rceil) \\
A^{(l+1)} = A^{(l)}\_{\text{idx,idx}}
$$&lt;p&gt;å¦‚å¼ 2ï¼Œå›¾çš„æ‹“æ‰‘ç»“æ„ä¸å½±å“æŠ•å½±åˆ†æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è¿›ä¸€æ­¥æé«˜å›¾çš„æ± åŒ–ï¼Œæˆ‘ä»¬æå‡ºäº† SAGPoolï¼Œå¯ä»¥åœ¨å¯è§‚çš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ä¸Šåˆ©ç”¨ç‰¹å¾å’Œæ‹“æ‰‘ç»“æ„ç”Ÿæˆå±‚æ¬¡è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;h1 id="3-proposed-method"&gt;3. Proposed Method
&lt;/h1&gt;&lt;p&gt;SAGPool çš„å…³é”®æ˜¯å®ƒä½¿ç”¨äº† GNN å¾—åˆ°çš„æ³¨æ„åŠ›åˆ†æ•°ã€‚SAGPool å±‚å’Œæ¨¡å‹æ¶æ„åˆ†åˆ«æ˜¯å›¾ 1 å’Œå›¾ 2.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/self-attention-graph-pooling/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/self-attention-graph-pooling/Fig2.JPG"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;h2 id="31-self-attention-graph-pooling"&gt;3.1 Self-Attention Graph Pooling
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Self-attention mask&lt;/strong&gt; æ³¨æ„åŠ›æœºåˆ¶å¹¿æ³›åº”ç”¨åœ¨æœ€è¿‘çš„æ·±åº¦å­¦ä¹ ç ”ç©¶ä¸­ã€‚è¿™æ ·çš„æœºåˆ¶ä½¿å¾—æ¨¡å‹å¯ä»¥æ›´ä¸“æ³¨äºé‡è¦çš„ç‰¹å¾ï¼Œä¸é‚£ä¹ˆå…³æ³¨ä¸é‡è¦çš„ç‰¹å¾ã€‚è‡ªæ³¨æ„åŠ›ä¸€èˆ¬ç§°ä¸ºå†…æ³¨æ„åŠ›ï¼Œå…è®¸è¾“å…¥ç‰¹å¾ä½œä¸ºè‡ªèº«æ³¨æ„åŠ›çš„æ ‡å‡† (Vaswani et al., 2017)ã€‚æˆ‘ä»¬ä½¿ç”¨å›¾å·ç§¯è·å¾—è‡ªæ³¨æ„åŠ›åˆ†æ•°ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœå›¾å·ç§¯çš„å…¬å¼æ˜¯ Kipf &amp;amp; Welling ä½¿ç”¨çš„ï¼Œé‚£ä¹ˆè‡ªæ³¨æ„åŠ›åˆ†æ•° $Z \in \mathbb{R}^{N \times 1}$ é€šè¿‡ä¸‹å¼è®¡ç®—ï¼š&lt;/p&gt;
$$\tag{3}
Z = \sigma(\tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}} X \Theta\_{att})
$$&lt;p&gt;$\sigma$ æ˜¯æ¿€æ´»å‡½æ•°ï¼Œå¦‚ $tanh$ï¼Œ$\tilde{A} \in \mathbb{R}^{N \times N}$ æ˜¯æœ‰è‡ªè¿æ¥çš„é‚»æ¥çŸ©é˜µï¼Œ$\tilde{D} \in \mathbb{R}^{N \times N}$ æ˜¯åº¦çŸ©é˜µï¼Œ$X \in \mathbb{R}^{N \times F}$ æ˜¯å›¾çš„ç‰¹å¾çŸ©é˜µï¼Œ$\Theta_{att} \in \mathbb{R}^{F \times 1}$ æ˜¯ SAGPool å±‚ä»…æœ‰çš„å‚æ•°ã€‚é€šè¿‡åˆ©ç”¨å›¾å·ç§¯è·å¾—è‡ªæ³¨æ„åŠ›åˆ†æ•°ï¼Œæ± åŒ–çš„ç»“æœæ˜¯åŒæ—¶åŸºäºå›¾çš„ç‰¹å¾å’Œæ‹“æ‰‘ç»“æ„çš„ã€‚æˆ‘ä»¬åˆ©ç”¨ Gao &amp;amp; Ji; Cangea et al. çš„ç»“ç‚¹é€‰æ‹©æ–¹æ³•ï¼Œä¿ç•™äº†è¾“å…¥çš„å›¾çš„ä¸€éƒ¨åˆ†ç»“ç‚¹ï¼Œç”šè‡³å½“å›¾çš„å°ºå¯¸å’Œç»“æ„æ”¹å˜æ—¶ã€‚æ± åŒ–æ¯”ä¾‹ $k \in (0, 1]$ æ˜¯ä¸€ä¸ªè¶…å‚æ•°å†³å®šäº†ä¿ç•™å¤šå°‘ç»“ç‚¹ã€‚åŸºäº $Z$ çš„å€¼é€‰æ‹©æœ€é«˜çš„ $\lceil kN \rceil$ ä¸ªç»“ç‚¹ã€‚&lt;/p&gt;
$$\tag{4}
\text{idx = top-rank}(Z, \lceil kN \rceil), Z\_{mask} = Z\_{\text{idx}}
$$&lt;p&gt;$\text{top-rank}$ è¿”å›æœ€é«˜çš„ $\lceil kN \rceil$ ä¸ªå€¼çš„ä¸‹æ ‡ï¼Œ$\cdot_{\text{idx}}$ æ˜¯ä¸‹æ ‡æ“ä½œï¼Œ$Z_{mask}$ æ˜¯ç‰¹å¾çš„æ³¨æ„åŠ› maskã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Graph pooling&lt;/strong&gt; è¾“å…¥çš„å›¾é€šè¿‡å›¾ 1 ä¸­çš„ &lt;strong&gt;masking&lt;/strong&gt; æ“ä½œã€‚&lt;/p&gt;
$$\tag{5}
X' = X\_{idx,:}, X\_{out} = X' \odot Z\_{mask}, A\_{out} = A\_{\text{idx, idx}}
$$&lt;p&gt;å…¶ä¸­ $X_{\text{idx,:}}$ æ˜¯æŒ‡å®šè¡Œä¸‹æ ‡çš„ç‰¹å¾çŸ©é˜µï¼Œæ¯è¡Œè¡¨ç¤ºä¸€ä¸ªç»“ç‚¹ï¼Œ$\odot$ æ˜¯ elementwise ä¹˜ç§¯ï¼Œ$A_{\text{idx, idx}}$ æ˜¯æŒ‡å®šè¡Œä¸‹æ ‡å’Œåˆ—ä¸‹æ ‡çš„é‚»æ¥çŸ©é˜µã€‚$X_{out}$ å’Œ $A_{out}$ æ˜¯æ–°çš„ç‰¹å¾çŸ©é˜µå’Œå¯¹åº”çš„é‚»æ¥çŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Variation of SAGPool&lt;/strong&gt; ä½¿ç”¨å›¾å·ç§¯çš„ä¸»è¦åŸå› æ˜¯ä¸ºäº†åæ˜ å›¾çš„ç‰¹å¾å’Œæ‹“æ‰‘ç»“æ„ã€‚å¯ä»¥ä½¿ç”¨ä¸åŒçš„å›¾å·ç§¯æ¥æ›¿æ¢å¼ 3 ä¸­çš„å›¾å·ç§¯ã€‚è®¡ç®—æ³¨æ„åŠ›æœºåˆ¶ $Z \in \mathbb{R}^{N \times 1}$ çš„æ³›åŒ–å…¬å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{6}
Z = \sigma(\text{GNN}(X, A))
$$&lt;p&gt;$X$ å’Œ $A$ æ˜¯ç‰¹å¾çŸ©é˜µå’Œé‚»æ¥çŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†ä½¿ç”¨é‚»æ¥ç»“ç‚¹è¿˜å¯ä»¥ä½¿ç”¨å¤šè·³ç»“ç‚¹æ¥è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°ã€‚å¼ 7 å’Œå¼ 8 åˆ†åˆ«ä½¿ç”¨äº†ä¸¤è·³è¿æ¥å’Œå †å  GNN å±‚ã€‚å¢åŠ é‚»æ¥çŸ©é˜µçš„å¹³æ–¹å¢åŠ äº†ä¸¤æ¡é‚»å±…ï¼š&lt;/p&gt;
$$\tag{7}
Z = \sigma(\text{GNN}(X, A + A^2))
$$&lt;p&gt;å †å  GNN å±‚å¯ä»¥é—´æ¥çš„èšåˆä¸¤è·³ç»“ç‚¹ã€‚è¿™æ ·çš„è¯ï¼Œéçº¿æ€§å±‚å’Œå‚æ•°çš„æ•°é‡å°±å¢åŠ äº†ï¼š&lt;/p&gt;
$$\tag{8}
Z = \sigma(\text{GNN}\_2 (\sigma(\text{GNN}\_1 (X, A)), A))
$$&lt;p&gt;å¼ 7 å’Œå¼ 8 å¯ä»¥åˆ©ç”¨å¤šè·³è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªå˜ä½“æ˜¯å¹³å‡å¤šä¸ªæ³¨æ„åŠ›åˆ†æ•°ã€‚å¹³å‡æ³¨æ„åŠ›åˆ†æ•°é€šè¿‡ $M$ ä¸ª GNN è·å¾—ï¼š&lt;/p&gt;
$$\tag{9}
Z = \frac{1}{m} \sum\_m \sigma(\text{GNN}\_m (X, A))
$$&lt;p&gt;åœ¨è®ºæ–‡ä¸­ï¼Œå¼ 7ï¼Œ8ï¼Œ9 çš„æ¨¡å‹åˆ†åˆ«è®°ä¸º $\rm {SAGPool}_{augmentation}$ï¼Œ$\rm {SAGPool}_{serial}$ï¼Œ$\rm {SAGPool}_{parallel}$ã€‚&lt;/p&gt;
&lt;h2 id="32-model-architecture"&gt;3.2 Model Architecture
&lt;/h2&gt;&lt;p&gt;æ ¹æ® Lipton &amp;amp; Steinhardt çš„ç ”ç©¶ï¼Œå¦‚æœå¯¹ä¸€ä¸ªæ¨¡å‹åšå¾ˆå¤šä¿®æ”¹ï¼Œé‚£å¾ˆéš¾çŸ¥é“æ˜¯å“ªéƒ¨åˆ†æ”¹è¿›èµ·çš„ä½œç”¨ã€‚ä¸ºäº†ä¸€ä¸ªå…¬å¹³çš„å¯¹æ¯”ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Zhang et al. å’Œ Cangea et al. çš„æ¨¡å‹æ¥å¯¹æ¯”æˆ‘ä»¬çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Convolution layer&lt;/strong&gt; å¦‚ 2.1 èŠ‚æåˆ°çš„ï¼Œæœ‰å¾ˆå¤šå›¾å·ç§¯çš„å®šä¹‰ã€‚å…¶ä»–ç±»å‹çš„å›¾å·ç§¯å¯èƒ½ä¹Ÿèƒ½æå‡æ€§èƒ½ï¼Œä½†æ˜¯æˆ‘ä»¬åˆ©ç”¨çš„æ˜¯ Kipf &amp;amp; Welling æå‡ºçš„å¹¿æ³›ä½¿ç”¨çš„å›¾å·ç§¯ã€‚å¼ 10 å’Œå¼3 ä¸€æ ·ï¼Œé™¤äº† $\Theta$ çš„ç»´åº¦ï¼š&lt;/p&gt;
$$\tag{10}
h^{(l+1)} = \sigma(\tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}} h^{(l)} \Theta)
$$&lt;p&gt;å…¶ä¸­ $h^{(l)}$ æ˜¯ç¬¬ $l$ å±‚çš„èŠ‚ç‚¹è¡¨ç¤ºï¼Œ$\Theta \in \mathbb{R}^{F \times F&amp;rsquo;}$ æ˜¯å·ç§¯æ ¸ã€‚ä½¿ç”¨ ReLU ä½œä¸ºæ¿€æ´»å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Readout layer&lt;/strong&gt; å— JK-net çš„å¯å‘ï¼ŒCangea et al. æå‡ºäº†ä¸€ä¸ª readout å±‚ï¼Œèšåˆç»“ç‚¹çš„ç‰¹å¾ç”Ÿæˆä¸€ä¸ªå›ºå®šå¤§å°çš„è¡¨ç¤ºã€‚readout å±‚çš„èšåˆç‰¹å¾å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{11}
s = \frac{1}{N} \sum^N\_{i=1} x\_i \mid \mid \mathop{max}\limits^N\_{i=1} x\_i
$$&lt;p&gt;$N$ æ˜¯ç»“ç‚¹æ•°ï¼Œ$x_i$ æ˜¯ç¬¬ $i$ ä¸ªç»“ç‚¹çš„ç‰¹å¾å‘é‡ï¼Œ$\mid \mid$ è¡¨ç¤ºæ‹¼æ¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Global pooling architecture&lt;/strong&gt; æˆ‘ä»¬å®ç°äº† Zhang et al. æå‡ºçš„å…¨å±€æ± åŒ–ç»“æ„ã€‚å¦‚å›¾ 2 æ‰€ç¤ºï¼Œå…¨å±€æ± åŒ–ç»“æ„ç”±ä¸‰å±‚å›¾å·ç§¯å±‚ç»„æˆï¼Œæ¯å±‚çš„è¾“å‡ºæ‹¼æ¥åœ¨ä¸€èµ·ã€‚ç»“ç‚¹ç‰¹å¾åœ¨ readout å±‚èšåˆï¼Œç„¶åæ¥ä¸€ä¸ªæ± åŒ–å±‚ã€‚å›¾çš„ç‰¹å¾è¡¨ç¤ºä¼ å…¥çº¿æ€§å±‚ç”¨æ¥åˆ†ç±»ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hierarchical pooling architecture&lt;/strong&gt; åœ¨è¿™éƒ¨åˆ†è®¾ç½®ä¸­ï¼Œæˆ‘ä»¬å®ç°äº† Cangea et al. çš„å±‚æ¬¡æ± åŒ–ç»“æ„ã€‚å¦‚å›¾ 2 æ‰€ç¤ºï¼Œç»“æ„åŒ…å«äº†ä¸‰ä¸ªå—ï¼Œæ¯ä¸ªå—ç”±ä¸€ä¸ªå·ç§¯å±‚å’Œä¸€ä¸ªæ± åŒ–å±‚ç»„æˆã€‚æ¯ä¸ªå—çš„è¾“å‡ºé€šè¿‡ä¸€ä¸ª readout å±‚èšåˆã€‚æ¯ä¸ª readout å±‚çš„è¾“å‡ºä¹‹å’Œæ”¾å…¥çº¿æ€§å±‚åšåˆ†ç±»ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/self-attention-graph-pooling/Table1.JPG"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;h1 id="4-experiments"&gt;4. Experiments
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬åœ¨å›¾åˆ†ç±»ä¸Šè¯„ä¼°äº†å…¨å±€æ± åŒ–å’Œå±‚æ¬¡æ± åŒ–ã€‚&lt;/p&gt;
&lt;h2 id="41-datasets"&gt;4.1. Datasets
&lt;/h2&gt;&lt;p&gt;5 ä¸ªæ•°æ®é›†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/self-attention-graph-pooling/Table2.JPG"
loading="lazy"
alt="Table2"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/self-attention-graph-pooling/Table3.JPG"
loading="lazy"
alt="Table3"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/self-attention-graph-pooling/Table4.JPG"
loading="lazy"
alt="Table4"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/self-attention-graph-pooling/Fig3.JPG"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;</description></item><item><title>Session-based Social Recommendation via Dynamic Graph Attention Networks</title><link>https://davidham3.github.io/blog/p/session-based-social-recommendation-via-dynamic-graph-attention-networks/</link><pubDate>Wed, 29 May 2019 13:37:55 +0000</pubDate><guid>https://davidham3.github.io/blog/p/session-based-social-recommendation-via-dynamic-graph-attention-networks/</guid><description>&lt;p&gt;WSDM 2019ï¼ŒåŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1902.09362" target="_blank" rel="noopener"
&gt;Session-based Social Recommendation via Dynamic Graph Attention Networks&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;åƒ Facebook å’Œ Twitter è¿™æ ·çš„åœ¨çº¿ç¤¾åŒºå¾ˆæµè¡Œï¼Œå·²ç»æˆä¸ºå¾ˆå¤šç”¨æˆ·ç”Ÿæ´»ä¸­çš„é‡è¦éƒ¨åˆ†ã€‚é€šè¿‡è¿™äº›å¹³å°ï¼Œç”¨æˆ·å¯ä»¥å‘æ˜å¹¶åˆ›å»ºä¿¡æ¯ï¼Œå…¶ä»–äººä¼šæ¶ˆè´¹è¿™äº›ä¿¡æ¯ã€‚åœ¨è¿™ç§ç¯å¢ƒä¸‹ï¼Œç»™ç”¨æˆ·æ¨èç›¸å…³ä¿¡æ¯å˜å¾—å¾ˆé‡è¦ã€‚ç„¶è€Œï¼Œåœ¨çº¿ç¤¾åŒºçš„æ¨èæ˜¯ä¸€ä¸ªéš¾é¢˜ï¼š1. ç”¨æˆ·å…´è¶£æ˜¯åŠ¨æ€çš„ï¼Œ2. ç”¨æˆ·ä¼šå—å…¶æœ‹å‹çš„å½±å“ã€‚æ­¤å¤–ï¼Œå½±å“è€…ä¸ç¯å¢ƒç›¸ä¾ã€‚ä¸åŒçš„æœ‹å‹å¯èƒ½å…³æ³¨ä¸åŒçš„è¯é¢˜ã€‚å¯¹ä¸¤è€…å»ºæ¨¡å¯¹æ¨èæ¥è¯´æ˜¯é‡è¦çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªåŸºäºåŠ¨æ€å›¾æ³¨æ„åŠ›æœºåˆ¶çš„åœ¨çº¿ç¤¾åŒºæ¨èç³»ç»Ÿã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ª RNN å¯¹åŠ¨æ€çš„ç”¨æˆ·è¡Œä¸ºå»ºæ¨¡ï¼Œç”¨å›¾å·ç§¯å¯¹ä¾èµ–ç¯å¢ƒçš„ç¤¾äº¤å½±å“å»ºæ¨¡ï¼Œå¯ä»¥åŠ¨æ€åœ°æ ¹æ®ç”¨æˆ·å½“å‰çš„å…´è¶£æ¨æµ‹å½±å“è€…ã€‚æ•´ä¸ªæ¨¡å‹å¯ä»¥é«˜æ•ˆåœ°ç”¨äºå¤§è§„æ¨¡çš„æ•°æ®ã€‚å‡ ä¸ªçœŸå®æ•°æ®é›†ä¸Šçš„å®éªŒç»“æœæ˜¾ç¤ºæˆ‘ä»¬çš„æ–¹æ³•å¾ˆå¥½ï¼Œæºç åœ¨ï¼š&lt;a class="link" href="https://github.com/DeepGraphLearning/RecommenderSystems" target="_blank" rel="noopener"
&gt;https://github.com/DeepGraphLearning/RecommenderSystems&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 Introduction
&lt;/h1&gt;&lt;p&gt;åœ¨çº¿ç¤¾åŒºå·²ç»æˆä¸ºä»Šå¤©åœ¨çº¿ä½“éªŒçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚Facebook, Twitter, è±†ç“£å¯ä»¥è®©ç”¨æˆ·åˆ›å»ºã€åˆ†äº«ã€æ¶ˆè´¹ä¿¡æ¯ã€‚å› æ­¤è¿™äº›å¹³å°çš„æ¨èç³»ç»Ÿå¯¹å¹³å°ä¸Šçš„è¡¨å±‚ä¿¡æ¯å’Œç»´æŒç”¨æˆ·æ´»è·ƒåº¦æ¥è¯´å¾ˆé‡è¦ã€‚ç„¶è€Œï¼Œåœ¨çº¿ç¤¾åŒºå¯¹æ¨èç³»ç»Ÿæå‡ºäº†ä¸€äº›æŒ‘æˆ˜ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œç”¨æˆ·å…´è¶£æœ¬è´¨ä¸Šæ¥è¯´æ˜¯åŠ¨æ€çš„ã€‚ä¸€ä¸ªç”¨æˆ·å¯èƒ½ä¸€æ®µæ—¶é—´å¯¹ä½“è‚²æ„Ÿå…´è¶£ï¼Œä¹‹åå‘¢å¯¹éŸ³ä¹æ„Ÿå…´è¶£ã€‚å…¶æ¬¡ï¼Œå› ä¸ºåœ¨çº¿ç¤¾åŒºé‡Œé¢çš„ç”¨æˆ·ç»å¸¸ç»™æœ‹å‹åˆ†äº«ä¿¡æ¯ï¼Œç”¨æˆ·ä¹Ÿä¼šè¢«ä»–ä»¬çš„æœ‹å‹å½±å“ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªæ‰¾ç”µå½±çš„ç”¨æˆ·å¯èƒ½ä¼šè¢«å¥¹çš„æœ‹å‹å–œæ¬¢çš„ç”µå½±å½±å“ã€‚æ­¤å¤–ï¼Œæ–½åŠ å½±å“çš„ä¸€æ–¹ç»„æˆçš„é›†åˆæ˜¯åŠ¨æ€çš„ï¼Œå› ä¸ºè¿™å’Œç¯å¢ƒæœ‰å…³ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªç”¨æˆ·åœ¨æ‰¾ä¸€ä¸ªæç¬‘ç”µå½±çš„æ—¶å€™ä¼šå¬å–ä¸€ç¾¤å–œæ¬¢å–œå‰§çš„æœ‹å‹çš„æ„è§ï¼Œåœ¨æ‰¾åŠ¨ä½œç”µå½±çš„æ—¶å€™ï¼Œä¼šå—åˆ°å¦ä¸€ç»„æœ‹å‹çš„å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Motivating Example.&lt;/strong&gt; å›¾ 1 å±•ç¤ºäº† Alice å’Œ å¥¹çš„æœ‹å‹åœ¨ä¸€ä¸ªåœ¨çº¿ç¤¾åŒºçš„è¡Œä¸ºã€‚è¡Œä¸ºé€šè¿‡ä¸€ä¸ªåŠ¨ä½œï¼ˆæ¯”å¦‚ç‚¹å‡»æ“ä½œï¼‰åºåˆ—æè¿°ã€‚ä¸ºäº†æ•è·ç”¨æˆ·çš„åŠ¨æ€å…´è¶£ï¼Œå¥¹ä»¬çš„è¡Œä¸ºè¢«åˆ†æˆäº†ä¸åŒçš„å­åºåˆ—ï¼Œè¡¨ç¤º &lt;em&gt;sessions&lt;/em&gt;ã€‚æˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯åŸºäº &lt;em&gt;session&lt;/em&gt; çš„æ¨èï¼šæˆ‘ä»¬æ ¹æ®å½“å‰æƒ…å¢ƒä¸‹ Alice å·²ç»æ¶ˆè´¹è¿‡çš„ä¸œè¥¿ç»™å¥¹æ¨èä¸‹ä¸€ä¸ªå¥¹å¯èƒ½æ¶ˆè´¹çš„ä¸œè¥¿ã€‚å›¾ 1 å±•ç¤ºå‡ºä¸¤ä¸ªæƒ…æ™¯ï¼Œa å’Œ bã€‚æ­¤å¤–ï¼ŒAlice æœ‹å‹ä»¬çš„æ¶ˆè´¹ä¿¡æ¯ä¹Ÿæ˜¯å¯è·å¾—çš„ã€‚æˆ‘ä»¬ä¼šåˆ©ç”¨è¿™äº›ä¿¡æ¯ç”Ÿæˆæ›´å¥½çš„æ¨èã€‚å› æ­¤æˆ‘ä»¬åœ¨ä¸€ä¸ªåŸºäº session çš„ç¤¾äº¤æ¨èæƒ…æ™¯ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/session-based-social-recommendation-via-dynamic-graph-attention-networks/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ session a ä¸­ï¼ŒAlice æµè§ˆäº†ä½“è‚²çš„ç‰©å“ã€‚å¥¹çš„ä¸¤ä¸ªæœ‹å‹ï¼šBob å’Œ Evaï¼Œæ˜¯å‡ºäº†åçš„ä½“è‚²ç²‰ä¸ï¼ˆé•¿æœŸå…´è¶£ï¼‰ï¼Œä»–ä»¬æœ€è¿‘æ­£å¥½æµè§ˆäº†ä½“è‚²ç›¸å…³çš„ç‰©å“ï¼ˆçŸ­æœŸå…´è¶£ï¼‰ã€‚è€ƒè™‘åˆ°è¿™ä¸ªæƒ…å†µï¼ŒAlice å¯èƒ½è¢«ä»–ä»¬ä¸¤ä¸ªå½±å“ï¼Œæ¯”å¦‚è¯´æ¥ä¸‹æ¥å¥¹å¯èƒ½ä¼šå­¦ä¹ ä¹’ä¹“çƒã€‚åœ¨ session b ä¸­ï¼ŒAlice å¯¹æ–‡å­¦è‰ºæœ¯ç‰©å“æ„Ÿå…´è¶£ã€‚è¿™ä¸ªç¯å¢ƒå’Œåˆšæ‰ä¸ä¸€æ ·äº†å› ä¸ºå¥¹æ²¡æœ‰æœ€è¿‘æ­£åœ¨æ¶ˆè´¹è¿™æ ·ç‰©å“çš„æœ‹å‹ã€‚ä½†æ˜¯ David ä¸€ç›´å¯¹è¿™ä¸ªè¯é¢˜æ„Ÿå…´è¶£ï¼ˆé•¿æœŸå…´è¶£ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹ Alice æ¥è¯´å¯èƒ½ä¼šè¢« David å½±å“ï¼Œå¯èƒ½ä¼šè¢«æ¨èä¸€æœ¬ David å–œæ¬¢çš„ä¹¦ã€‚è¿™äº›ä¾‹å­è¡¨æ˜äº†ä¸€ä¸ªç”¨æˆ·å½“å‰çš„å…´è¶£æ˜¯å¦‚ä½•ä¸ä»–ä¸åŒçš„æœ‹å‹çš„å…´è¶£ç›¸èåˆæ¥æä¾›åŸºäºæƒ…æ™¯çš„æ¨èçš„ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ¨èæ¨¡å‹æ¥å¤„ç†è¿™ä¸¤ç§æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;å½“å‰çš„æ¨èç³»ç»Ÿè¦ä¹ˆå¯¹ç”¨æˆ·çš„åŠ¨æ€å…´è¶£å»ºæ¨¡ï¼Œè¦ä¹ˆå¯¹ä»–ä»¬çš„ç¤¾äº¤å½±å“å»ºæ¨¡ï¼Œä½†æ˜¯ï¼Œæ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œç°å­˜çš„æ–¹æ³•è¿˜æ²¡æœ‰èåˆè¿‡ä»–ä»¬ã€‚æœ€è¿‘çš„ä¸€ä¸ªç ”ç©¶å¯¹ session çº§åˆ«çš„ç”¨æˆ·è¡Œä¸ºä½¿ç”¨ RNN å»ºæ¨¡ï¼Œå¿½ç•¥äº†ç¤¾äº¤å½±å“ã€‚å…¶ä»–çš„ç ”ç©¶ä»…è€ƒè™‘ç¤¾äº¤å½±å“ã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒMa et al. æ¢ç´¢äº†æœ‹å‹çš„é•¿æœŸå…´è¶£äº§ç”Ÿçš„ç¤¾äº¤å½±å“ã€‚ä½†æ˜¯ï¼Œä¸åŒç”¨æˆ·çš„å½±å“æ˜¯é™æ€çš„ï¼Œæ²¡æœ‰æç»˜å‡ºæ¯ä¸ªç”¨æˆ·å½“å‰çš„å…´è¶£ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–¹æ³•å¯¹ç”¨æˆ·åŸºäº session çš„å…´è¶£å’ŒåŠ¨æ€ç¤¾äº¤å½±å“åŒæ—¶å»ºæ¨¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè€ƒè™‘äº†åŸºäºå½“å‰ç”¨æˆ·çš„ sessionï¼Œä»–çš„æœ‹å‹çš„å“ªä¸ªå­é›†å½±å“äº†ä»–ã€‚æˆ‘ä»¬çš„æ¨èæ¨¡å‹åŸºäºåŠ¨æ€æ³¨æ„åŠ›ç½‘ç»œã€‚æˆ‘ä»¬çš„æ–¹æ³•å…ˆç”¨ä¸€ä¸ª RNN å¯¹ä¸€ä¸ª session å†…çš„ç”¨æˆ·è¡Œä¸ºå»ºæ¨¡ã€‚æ ¹æ®ç”¨æˆ·å½“å‰å…´è¶£â€”â€”é€šè¿‡ RNN çš„éšè—è¡¨ç¤ºæ•è·åˆ°çš„â€”â€”æˆ‘ä»¬ä½¿ç”¨ GAT æ•è·äº†ä»–çš„æœ‹å‹çš„å½±å“ã€‚ä¸ºäº†æä¾› session çº§åˆ«çš„æ¨èï¼Œæˆ‘ä»¬åŒºåˆ†äº†çŸ­æœŸå…´è¶£å’Œé•¿æœŸå…´è¶£ã€‚åœ¨ç»™å®šç”¨æˆ·å½“å‰å…´è¶£çš„åŸºç¡€ä¸Šï¼Œæ¯ä¸ªæœ‹å‹çš„å½±å“é€šè¿‡æ³¨æ„åŠ›æœºåˆ¶è‡ªåŠ¨åœ°å†³å®šã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åšäº†å¤§é‡å®éªŒï¼Œæ•ˆæœæ¯”å¾ˆå¤šæ–¹æ³•å¥½ã€‚è´¡çŒ®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æå‡ºäº†åŒæ—¶å¯¹åŠ¨æ€ç”¨æˆ·å…´è¶£å’Œä¾èµ–ç¯å¢ƒçš„ç¤¾äº¤å½±å“å­¦ä¹ åå¯¹åœ¨çº¿ç¤¾åŒºè¿›è¡Œæ¨èçš„æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;æå‡ºäº†åŸºäºåŠ¨æ€å›¾æ³¨æ„åŠ›ç½‘ç»œçš„æ¨èæ–¹æ³•ã€‚åœ¨å¤§æ•°æ®é›†ä¸Šä¹Ÿæœ‰æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;å®éªŒç»“æœæ¯” state-of-the-art å¥½å¾ˆå¤šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="2-related-work"&gt;2 Related Work
&lt;/h1&gt;&lt;p&gt;è®¨è®ºä¸‰æ¡è·¯çº¿ï¼š1. å¯¹åŠ¨æ€ç”¨æˆ·è¡Œä¸ºå»ºæ¨¡çš„æ¨èç³»ç»Ÿï¼Œ2. è€ƒè™‘ç¤¾äº¤å½±å“çš„æ¨èç³»ç»Ÿï¼Œ3. å›¾å·ç§¯ç½‘ç»œã€‚&lt;/p&gt;
&lt;h2 id="21-dynamic-recommendation"&gt;2.1 Dynamic Recommendation
&lt;/h2&gt;&lt;h2 id="22-social-recommendation"&gt;2.2 Social Recommendation
&lt;/h2&gt;&lt;h2 id="23-graph-convolutional-networks"&gt;2.3 Graph Convolutional Networks
&lt;/h2&gt;&lt;h1 id="3-problem-definition"&gt;3 Problem Definition
&lt;/h1&gt;&lt;p&gt;æ¨èç³»ç»Ÿæ ¹æ®å†å²è¡Œä¸ºæ¨èç›¸å…³çš„ç‰©å“ã€‚ä¼ ç»Ÿçš„æ¨èæ¨¡å‹ï¼Œå¦‚çŸ©é˜µåˆ†è§£ï¼Œå¿½ç•¥äº†ç”¨æˆ·çš„æ¶ˆè´¹é¡ºåºã€‚åœ¨çº¿ç¤¾åŒºä¸­ï¼Œç”¨æˆ·å…´è¶£æ˜¯å¿«é€Ÿå˜åŒ–çš„ï¼Œå¿…é¡»è¦è€ƒè™‘ç”¨æˆ·åå¥½é¡ºåºï¼Œä»¥ä¾¿å¯¹ç”¨æˆ·çš„åŠ¨æ€å…´è¶£å»ºæ¨¡ã€‚å®é™…ä¸Šï¼Œå› ä¸ºç”¨æˆ·å…¨éƒ¨çš„å†å²è®°å½•å¯ä»¥å¾ˆé•¿ï¼ˆæœ‰äº›ç¤¾åŒºå­˜åœ¨å¥½å¤šå¹´äº†ï¼‰ï¼Œç”¨æˆ·å…´è¶£åˆ‡æ¢çš„å¾ˆå¿«ï¼Œä¸€ä¸ªå¸¸ç”¨çš„æ–¹æ³•æ˜¯å°†ç”¨æˆ·çš„åå¥½åˆ†æˆä¸åŒçš„ sessionï¼Œï¼ˆä½¿ç”¨æ—¶é—´æˆ³ï¼Œä»¥ä¸€ä¸ªæ˜ŸæœŸä¸ºæ—¶é—´æ®µè€ƒè™‘æ¯ä¸ªç”¨æˆ·çš„è¡Œä¸ºï¼‰å¹¶ä»¥ session ä¸ºçº§åˆ«æä¾›æ¨èã€‚å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;DEFINITION 1. (&lt;strong&gt;Session-based Recommendation&lt;/strong&gt;)ï¼Œ$U$ è¡¨ç¤ºç”¨æˆ·çš„é›†åˆï¼Œ$I$ è¡¨ç¤ºç‰©å“é›†ã€‚æ¯ä¸ªç”¨æˆ· $u$ å’Œä¸€ç»„å¸¦æœ‰æ—¶é—´æ­¥ $T$ çš„ session ç›¸å…³ï¼Œ$I^u_T = \lbrace \vec{S}^u_1, \vec{S}^u_2, \dots \vec{S}^u_T \rbrace$ï¼Œå…¶ä¸­ $\vec{S}^u_t$ æ˜¯ç”¨æˆ· $u$ çš„ç¬¬ $t$ ä¸ª sessionã€‚åœ¨æ¯ä¸ª session å†…ï¼Œ$\vec{S}^u_t$ ç”±ä¸€ä¸ªç”¨æˆ·è¡Œä¸ºçš„åºåˆ— $\lbrace i^u_{t,1}, i^u_{t,2}, \dots, i^u_{t,N_{u,t}} \rbrace$ ç»„æˆï¼Œå…¶ä¸­ $i^u_{t,p}$ æ˜¯åœ¨ç¬¬ $t$ ä¸ª session ä¸­ç”¨æˆ·æ¶ˆè´¹çš„ç¬¬ $p$ ä¸ªç‰©å“ï¼Œ$N_{u,t}$ æ˜¯ session ä¸­ç‰©å“çš„æ€»æ•°ã€‚å¯¹äºæ¯ä¸ªç”¨æˆ· $u$ï¼Œç»™å®šä¸€ä¸ª session $\vec{S}^u_{T+1} = \lbrace i^u_{T+1,1}, \dots i^u_{T+1,n} \rbrace$ï¼ŒåŸºäº session çš„æ¨èç³»ç»Ÿçš„ç›®æ ‡æ˜¯ä» $I$ ä¸­æ¨èä¸€ç»„ç”¨æˆ·å¯èƒ½åœ¨ä¸‹æ¥çš„ $n+1$ æ­¥æ—¶æ„Ÿå…´è¶£çš„ç‰©å“ï¼Œå³ $i^u_{T+1, n+1}$ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨åœ¨çº¿ç¤¾åŒºä¸­ï¼Œç”¨æˆ·çš„å…´è¶£ä¸ä»…ä¸ä»–ä»¬çš„å†å²è¡Œä¸ºç›¸å…³ï¼Œä¹Ÿå—ä»–ä»¬çš„æœ‹å‹çš„å½±å“ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªæœ‹å‹çœ‹ç”µå½±ï¼Œæˆ‘ä¹Ÿå¯èƒ½ä¼šæ„Ÿå…´è¶£ã€‚è¿™å°±å«ç¤¾äº¤å½±å“ã€‚æ­¤å¤–ï¼Œä»æœ‹å‹é‚£é‡Œæ¥çš„å½±å“æ˜¯è·Ÿç¯å¢ƒæœ‰å…³çš„ã€‚æ¢å¥è¯è¯´ï¼Œä»æœ‹å‹é‚£é‡Œæ¥çš„å½±å“æ˜¯ä¸ä¸€æ ·çš„ã€‚å¦‚æœä¸€ä¸ªç”¨æˆ·æƒ³ä¹°ä¸ªç¬”è®°æœ¬ç”µè„‘ï¼Œå¥¹å¯èƒ½æ›´å€¾å‘äºé—®é—®å¥¹å–œæ¬¢é«˜ç§‘æŠ€äº§å“çš„æœ‹å‹ï¼›å¦‚æœå¥¹è¦ä¹°ç›¸æœºï¼Œå¥¹å¯èƒ½ä¼šè¢«å¥¹çš„æ‘„å½±å¸ˆæœ‹å‹å½±å“ã€‚å°±åƒå›¾ 1ï¼Œä¸€ä¸ªç”¨æˆ·å¯èƒ½è¢«å¥¹æœ‹å‹çš„é•¿æœŸå…´è¶£å’ŒçŸ­æœŸå…´è¶£å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æä¾›ä¸€ä¸ªæœ‰æ•ˆçš„æ¨èç»“æœï¼Œæˆ‘ä»¬æå‡ºå¯¹åŠ¨æ€çš„ç”¨æˆ·å…´è¶£å’Œä¾èµ–äºç¯å¢ƒçš„ç¤¾äº¤å½±å“å»ºæ¨¡ã€‚æˆ‘ä»¬å®šä¹‰äº†å¦‚ä¸‹çš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;DEFINITION 2. (&lt;strong&gt;Session-based Social Recommendation&lt;/strong&gt;) $U$ è¡¨ç¤ºç”¨æˆ·é›†ï¼Œ$I$ è¡¨ç¤ºç‰©å“é›†åˆï¼Œ$G=(U, E)$ æ˜¯ç¤¾äº¤ç½‘ç»œï¼Œ$E$ æ˜¯ç¤¾äº¤ç½‘ç»œçš„è¾¹ã€‚ç»™å®šç”¨æˆ· $u$ çš„ä¸€ä¸ª session $\vec{S}^u_{T+1} = \lbrace i^u_{T+1,1}, \dots i^u_{T+1,n} \rbrace$ï¼Œç›®æ ‡æ˜¯åˆ©ç”¨å¥¹çš„åŠ¨æ€å…´è¶£ï¼ˆ$\cup^{T+1}_{t=1} \vec{S}^u_t$ï¼‰å’Œç¤¾äº¤å½±å“ï¼ˆ$\cup^{N(u)}_{k=1} \cup^T_{t=1} \vec{S}^k_t$ï¼Œå…¶ä¸­ $N(u)$ æ˜¯ç”¨æˆ· $u$ çš„é‚»å±…ï¼‰ï¼Œä» $I$ ä¸­æ¨èä¸€ç»„ç”¨æˆ· $u$ å¯èƒ½åœ¨ä¸‹æ¥çš„ $n+1$ æ­¥æ—¶æ„Ÿå…´è¶£çš„ç‰©å“ï¼Œå³ $i^u_{T+1, n+1}$ã€‚&lt;/p&gt;
&lt;h1 id="4-dynamic-social-recommender-systems"&gt;4 Dynamic Social Recommender Systems
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬æå‡ºçš„æ¨¡å‹ Dynamic Graph Recommendation (DGREC) æ˜¯ä¸ªåŠ¨æ€å›¾æ³¨æ„åŠ›æ¨¡å‹ï¼Œå¯ä»¥å¯¹ç”¨æˆ·è¿‘æœŸçš„åå¥½å’Œä»–çš„æœ‹å‹çš„åå¥½å»ºæ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;DGREC æœ‰ 4 ä¸ªæ¨¡å—ï¼ˆå›¾ 2ï¼‰ã€‚é¦–å…ˆï¼Œä¸€ä¸ª RNN å¯¹ç”¨æˆ·å½“å‰ session ä¸­çš„ç‰©å“åºåˆ—å»ºæ¨¡ã€‚å¥¹æœ‹å‹çš„åå¥½ä½¿ç”¨é•¿æœŸåå¥½å’ŒçŸ­æœŸåå¥½èåˆæ¥å»ºæ¨¡ã€‚çŸ­æœŸåå¥½ï¼Œæˆ–æ˜¯æœ€è¿‘ä¸€æ¬¡ session ä¸­çš„ç‰©å“ä¹Ÿä½¿ç”¨ RNN æ¥ç¼–ç ã€‚æœ‹å‹çš„é•¿æœŸåå¥½é€šè¿‡ä¸€ä¸ªç‹¬ç«‹çš„åµŒå…¥å±‚ç¼–ç ã€‚æ¨¡å‹ä½¿ç”¨ GAT èåˆå½“å‰ç”¨æˆ·çš„è¡¨ç¤ºå’Œå¥¹æœ‹å‹çš„è¡¨ç¤ºã€‚è¿™æ˜¯æˆ‘ä»¬æ¨¡å‹çš„å…³é”®ï¼šæˆ‘ä»¬æå‡ºäº†åŸºäºç”¨æˆ·å½“å‰çš„å…´è¶£å­¦ä¹ æ¯ä¸ªæœ‹å‹çš„æƒé‡çš„æœºåˆ¶ã€‚æœ€åä¸€æ­¥ï¼Œæ¨¡å‹é€šè¿‡èåˆç”¨æˆ·å½“å‰åå¥½å’Œå¥¹çš„ç¤¾äº¤å½±å“å¾—åˆ°æ¨èç»“æœã€‚&lt;/p&gt;</description></item><item><title>DeepSTN+: Context-aware Spatial-Temporal Neural Network for Crowd Flow Prediction in Metropolis</title><link>https://davidham3.github.io/blog/p/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/</link><pubDate>Wed, 08 May 2019 16:40:48 +0000</pubDate><guid>https://davidham3.github.io/blog/p/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/</guid><description>&lt;p&gt;AAAI 2019ï¼Œç½‘æ ¼æµé‡é¢„æµ‹ï¼Œå¯¹æ¯”ST-ResNetï¼ŒæŠ›å‡ºä¸‰ä¸ªé—®é¢˜ï¼Œå·ç§¯æ•è·çš„ç©ºé—´èŒƒå›´å°ã€äººå£æµåŠ¨å’ŒåŒºåŸŸçš„åŠŸèƒ½ç›¸å…³ã€ä¹‹å‰çš„èåˆæœºåˆ¶ä¸å¥½ã€‚æ”¹äº†ä¸€ä¸‹æ®‹å·®å·ç§¯ï¼Œç»™ POI ä¿¡æ¯å¢åŠ äº†æ—¶é—´ç»´åº¦ï¼Œå¤šç»„ä»¶çš„ä¿¡æ¯æå‰èåˆï¼Œå‡å°‘äº†å‚æ•°ï¼Œç¨³å®šæ¨¡å‹è®­ç»ƒã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://github.com/FIBLAB/DeepSTN/blob/master/docs/5624_AAAI19_DeepSTN%2B_Camera_Ready.pdf" target="_blank" rel="noopener"
&gt;DeepSTN+: Context-aware Spatial-Temporal Neural Network for Crowd Flow Prediction in Metropolis&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;äººå£æµé‡é¢„æµ‹åœ¨åŸå¸‚è§„åˆ’ã€äº¤é€šç®¡æ§ä¸­çš„å¾ˆå¤šåº”ç”¨ä¸­éƒ½å¾ˆé‡è¦ã€‚ç›®çš„æ˜¯é¢„æµ‹æµå…¥å’Œæµå‡ºæµé‡ã€‚æˆ‘ä»¬æå‡ºäº† DeepSTN+ï¼Œä¸€ä¸ªåŸºäºæ·±åº¦å­¦ä¹ çš„å·ç§¯æ¨¡å‹ï¼Œé¢„æµ‹è¶…å¤§åŸå¸‚çš„äººå£æµé‡ã€‚é¦–å…ˆï¼ŒDeepSTN+ ä½¿ç”¨ &lt;em&gt;ConvPlus&lt;/em&gt; ç»“æ„å¯¹å¤§èŒƒå›´çš„ç©ºé—´ä¾èµ–å»ºæ¨¡ã€‚æ­¤å¤–ï¼ŒPOI åˆ†å¸ƒå’Œæ—¶é—´å› ç´ ç›¸èåˆæ¥è¡¨è¾¾åŒºåŸŸå±æ€§çš„å½±å“ï¼Œä»¥æ­¤å¼•å…¥äººå£æµåŠ¨çš„å…ˆéªŒçŸ¥è¯†ã€‚æœ€åï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæœ‰æ•ˆçš„èåˆæœºåˆ¶æ¥ç¨³å®šè®­ç»ƒè¿‡ç¨‹ï¼Œæå‡äº†ç»“æœã€‚åŸºäºä¸¤ä¸ªçœŸå®æ•°æ®é›†çš„å¤§é‡å®éªŒç»“æœè¡¨æ˜æˆ‘ä»¬æ¨¡å‹çš„å…ˆè¿›æ€§ï¼Œå’Œ state-of-the-art æ¯”é«˜äº† 8% ~ 13% å·¦å³ã€‚&lt;/p&gt;
&lt;h1 id="introduction"&gt;Introduction
&lt;/h1&gt;&lt;p&gt;å¦‚å›¾ 1 æ‰€ç¤ºï¼Œäººå£æµé‡é¢„æµ‹æ˜¯åœ¨ç»™å®šå†å²æµé‡ä¿¡æ¯çš„å‰æä¸‹ï¼Œé¢„æµ‹åŸå¸‚å†…æ¯ä¸ªåŒºåŸŸçš„æµå…¥å’Œæµå‡ºæµé‡ã€‚æœ€è¿‘ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒåŸºäºæ·±åº¦å­¦ä¹ çš„æ¨¡å‹è¢«ç›¸ç»§æå‡ºï¼Œè·å¾—äº†å¾ˆå¥½çš„æ•ˆæœã€‚Deep-ST æ˜¯ç¬¬ä¸€ä¸ªä½¿ç”¨å·ç§¯ç½‘ç»œæ•è·ç©ºé—´ä¿¡æ¯çš„æ¨¡å‹ã€‚ST-ResNet ç”¨å·ç§¯æ¨¡å—æ›¿æ¢äº†å·ç§¯ã€‚é€šè¿‡èåˆé‡‘å­—å¡”å‹çš„ ConvGRU æ¨¡å‹å’Œå‘¨æœŸè¡¨ç¤ºï¼ŒPeriodic-CRN è®¾è®¡æˆäº†æ•è·äººå£æµåŠ¨å‘¨æœŸæ€§çš„æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;è¿™äº›æ–¹æ³•ä»ç„¶ä¸å¤Ÿæœ‰æ•ˆä¸”ä¸ç²¾ç¡®ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;em&gt;ä¸èƒ½æ•è·åŒºåŸŸé—´çš„ç©ºé—´ä¾èµ–ã€‚&lt;/em&gt; ç”±äºç°ä»£åŸå¸‚ä¸­é«˜çº§çš„è¿è¾“ç³»ç»Ÿçš„å­˜åœ¨ï¼Œäººä»¬å¯ä»¥é€šè¿‡åœ°é“æˆ–å‡ºç§Ÿè½¦åœ¨çŸ­æ—¶é—´å†…ç§»åŠ¨åˆ°å¾ˆè¿œçš„åœ°æ–¹ã€‚å› æ­¤ï¼ŒåŒºåŸŸé—´çš„å¤§èŒƒå›´ç©ºé—´ä¾èµ–åœ¨äººå£ç§»åŠ¨ä¸­é€æ¸æ‰®æ¼”é‡è¦çš„è§’è‰²ã€‚ç°å­˜çš„å·¥ä½œä½¿ç”¨å¤šå±‚å·ç§¯ç½‘ç»œæ¥å»ºæ¨¡ã€‚ç„¶è€Œï¼Œå®ƒä»¬åªèƒ½ä¸€æ­¥ä¸€æ­¥åœ°æ•è·è¿‘é‚»çš„ç©ºé—´ä¾èµ–ï¼Œä¸èƒ½ç›´æ¥åœ°æ•è·å¤§èŒƒå›´çš„ç©ºé—´ä¾èµ–ã€‚&lt;/li&gt;
&lt;li&gt;&lt;em&gt;å¿½ç•¥äº†äººå£æµåŠ¨çš„åŒºåŸŸåŠŸèƒ½çš„å½±å“ã€‚&lt;/em&gt; äººå£ç§»åŠ¨æ˜¯å‘ç”Ÿåœ¨ç‰©ç†ä¸–ç•Œä¸­çš„ï¼Œä¼šç›´æ¥å—åˆ°åŒºåŸŸå±æ€§çš„å½±å“ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œäººä»¬é€šå¸¸æ—©ä¸Šä»å®¶å‡ºå‘åˆ°å…¬å¸ï¼Œæ™šä¸Šå›æ¥ã€‚æ˜¾ç„¶ï¼ŒåŒºåŸŸçš„åŠŸèƒ½ï¼ˆå±æ€§ï¼‰åŒ…å«äº†å…³äºäººç±»ç§»åŠ¨çš„å…ˆéªŒçŸ¥è¯†ã€‚ç„¶è€Œï¼Œç°å­˜çš„è§£å†³æ–¹æ¡ˆæ²¡æœ‰è€ƒè™‘è¿‡åŒºåŸŸçš„å±æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;em&gt;å†—ä½™ä»¥åŠä¸ç¨³å®šçš„ç¥ç»ç½‘ç»œç»“æ„ã€‚&lt;/em&gt; ST-ResNet åˆ©ç”¨äº†ä¸‰ä¸ªç‹¬ç«‹åˆ†æ”¯ï¼Œæ¯ä¸ªåˆ†æ”¯éƒ½æ˜¯æ®‹å·®å·ç§¯å•å…ƒï¼Œç”¨æ¥å¤„ç†ä¸åŒçš„è¾“å…¥ï¼Œåœ¨æ¨¡å‹çš„ç»“å°¾ç”¨ä¸€ä¸ªçº¿æ€§æ“ä½œèåˆä¸‰ä¸ªè¾“å‡ºã€‚ä½†æ˜¯ï¼Œæœ€åçš„èåˆæœºåˆ¶å¯¼è‡´ä¸åŒç»„ä»¶é—´çš„äº¤äº’äº§ç”Ÿäº†ç¼ºé™·ï¼Œè¿™ä¸ªç¼ºé™·å¯¼è‡´äº†ç½‘ç»œå†…äº§ç”Ÿäº†æ— æ•ˆçš„å‚æ•°å’Œä¸ç¨³å®šçš„æ€§è´¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ€»ç»“ä¸€ä¸‹ï¼Œæ¨¡å‹åº”è¯¥è€ƒè™‘å¤§èŒƒå›´çš„ç©ºé—´ä¾èµ–ï¼ŒåŒºåŸŸçš„å½±å“ï¼Œæ›´æœ‰æ•ˆçš„èåˆæœºåˆ¶è¿™ä¸‰ç‚¹å› ç´ ã€‚æˆ‘ä»¬æå‡ºçš„ DeepSTN+ è§£å†³äº†ä¸Šè¿°æŒ‘æˆ˜ã€‚æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ª &lt;em&gt;ConvPlus&lt;/em&gt; ç»“æ„ç›´æ¥åœ°æ•è·å¤§èŒƒå›´ç©ºé—´ä¾èµ–ã€‚&lt;em&gt;ConvPlus&lt;/em&gt; æ”¾åœ¨æ®‹å·®å•å…ƒå‰é¢ä½œä¸ºä¸€ä¸ªå…¨å±€ç‰¹å¾æå–å™¨æå–å‡ºåŒºåŸŸé—´çš„å…¨å±€ç‰¹å¾ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ª &lt;em&gt;SemanticPlus&lt;/em&gt; ç»“æ„æ¥å­¦ä¹ äººå£åœ¨åŒºåŸŸé—´ç§»åŠ¨çš„å…ˆéªŒçŸ¥è¯†ã€‚ç”¨é™æ€çš„ POI åˆ†å¸ƒä½œä¸ºè¾“å…¥ï¼Œ&lt;em&gt;SemanticPlus&lt;/em&gt; åˆ©ç”¨æ—¶é—´å› ç´ ç»™ä¸åŒæ—¶é—´ä¸Šä¸åŒçš„ POI åˆ†é…æƒé‡ã€‚æœ€åï¼Œæˆ‘ä»¬å¼•å…¥æ—©èåˆå’Œå¤šå°ºåº¦èåˆæœºåˆ¶æ¥å‡å°‘è®­ç»ƒå‚æ•°ï¼Œæ•è·ä¸åŒçº§åˆ«ç‰¹å¾é—´çš„å¤æ‚å…³ç³»ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿå¯ä»¥å¯¹æ›´å¤æ‚çš„ç©ºé—´å…³è”æ€§å»ºæ¨¡ï¼Œè·å¾—æ›´å¥½çš„æ•ˆæœï¼Œæˆ‘ä»¬çš„è´¡çŒ®æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªæ–°çš„æ®‹å·®å•å…ƒï¼ŒResPlus å•å…ƒç”¨æ¥æ›¿æ¢åŸå§‹çš„æ®‹å·®å•å…ƒã€‚æˆ‘ä»¬æŒ‡å‡ºäº†å…¸å‹çš„å·ç§¯æ¨¡å‹ä¸èƒ½æœ‰æ•ˆåœ°æ•è·å¤§èŒƒå›´ä¾èµ–ã€‚ResPlus åŒ…å«äº†ä¸€ä¸ª &lt;em&gt;ConvPlus&lt;/em&gt; ç»“æ„ï¼Œå¯ä»¥æ•è·äººæµé—´çš„å¤§èŒƒå›´ç©ºé—´ä¾èµ–ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ª &lt;em&gt;SemanticPlus&lt;/em&gt; ç»“æ„æ¥å»ºæ¨¡ä¸åŒåŒºåŸŸçš„å½±å“ï¼Œå­¦ä¹ äººå£æµåŠ¨çš„å…ˆéªŒçŸ¥è¯†ã€‚æˆ‘ä»¬åœ¨æ¨¡å‹å¤´éƒ¨ä½¿ç”¨æ—©èåˆæœºåˆ¶ï¼Œåœ¨ç»“å°¾ä½¿ç”¨å¤šå°ºåº¦èåˆæœºåˆ¶ï¼Œæå‡äº†æ¨¡å‹çš„ç²¾åº¦å’Œç¨³å®šæ€§ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šå¼€å±•äº†å¤§é‡çš„å®éªŒï¼Œå¯¹æ¯”äº† 5 ä¸ª baselinesï¼Œç»“æœæ˜¾ç¤ºæˆ‘ä»¬çš„æ¨¡å‹åœ¨é¢„æµ‹äººå£æµåŠ¨çš„é”™è¯¯ä¸Šå‡å°‘äº† 8% ~ 13%ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="preliminaries"&gt;Preliminaries
&lt;/h1&gt;&lt;p&gt;è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬é¦–å…ˆä»‹ç»äººå£æµé‡é¢„æµ‹é—®é¢˜ï¼Œç®€è¦å›é¡¾ ST-ResNetã€‚&lt;/p&gt;
&lt;h2 id="problem-formulation"&gt;Problem Formulation
&lt;/h2&gt;&lt;p&gt;**Definition 1 (Region (Zhang et al. 2016)) ä¸ºäº†è¡¨ç¤ºåŸå¸‚çš„åŒºåŸŸï¼Œæˆ‘ä»¬åŸºäºç»çº¬åº¦å°†åŸå¸‚åˆ’åˆ†æˆ $H \times W$ ä¸ªåŒºåŸŸï¼Œæ‰€æœ‰çš„ç½‘æ ¼æœ‰ç›¸åŒå¤§å°ä¸”è¡¨ç¤ºä¸€ä¸ªåŒºåŸŸã€‚&lt;/p&gt;
&lt;p&gt;**Definition 2 (Inflow/outflow (Zhang et al. 2016)) ä¸ºäº†è¡¨ç¤ºåŸå¸‚å†…çš„äººå£æµåŠ¨ï¼Œæˆ‘ä»¬å®šä¹‰äº†åŒºåŸŸ $(h, w)$ åœ¨æ—¶æ®µ $i$ çš„æµå…¥å’Œæµå‡ºæµé‡ï¼š&lt;/p&gt;
&lt;p&gt;$$
x^{h,w,in}_{i} = \sum_{T_{r_k} \in \mathbb{P}} \vert \lbrace j &amp;gt; 1 \mid g_{j-1} \not \in (h, w) \And g_j \in (h, w) \rbrace \vert,\&lt;/p&gt;
&lt;p&gt;x^{h,w,out}_{i} = \sum_{T_{r_k} \in \mathbb{P}} \vert \lbrace j \geq 1 \mid g_{j-1} \in (h, w) \And g_j \not \in (h, w) \rbrace \vert.
$$&lt;/p&gt;
&lt;p&gt;è¿™é‡Œ $\mathbb{P}$ è¡¨ç¤ºæ—¶æ®µ $i$ çš„è½¨è¿¹é›†åˆã€‚$T_r: g_1 \rightarrow g_2 \rightarrow \cdots \rightarrow g_{\vert T_r \vert}$ æ˜¯ $\mathbb{P}$ ä¸­çš„ä¸€æ¡è½¨è¿¹ï¼Œ$g_j$ æ˜¯åæ ‡ï¼›
$g_j \in (h, w)$ è¡¨ç¤ºç‚¹ $g_j$ åœ¨ç½‘æ ¼ $(h, w)$ å†…ï¼Œåä¹‹äº¦ç„¶ï¼›$\vert \cdot \vert$ è¡¨ç¤ºé›†åˆçš„åŸºæ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Crowd Flow Prediction&lt;/strong&gt;: ç»™å®šå†å²è§‚æµ‹å€¼ $\lbrace \mathbf{X}_i \mid i=1,2,\cdots, n-1 \rbrace$ï¼Œé¢„æµ‹ $\mathbf{X}_n$ã€‚&lt;/p&gt;
&lt;p&gt;ST-ResNet åŒ…å«å››ä¸ªç»„ä»¶ï¼Œ&lt;em&gt;closeness&lt;/em&gt;, &lt;em&gt;period&lt;/em&gt;, &lt;em&gt;trend&lt;/em&gt; å’Œ å¤–éƒ¨å› ç´ å•å…ƒã€‚æ¯ä¸ªç»„æˆéƒ¨åˆ†é€šè¿‡ä¸€ä¸ªåˆ†æ”¯çš„æ®‹å·®å•å…ƒæˆ–å…¨è¿æ¥å±‚é¢„æµ‹å‡ºä¸€ä¸ªæµé‡åœ°å›¾ã€‚ç„¶åæ¨¡å‹ä½¿ç”¨ä¸€ä¸ªçº¿æ€§ç»„åˆä½œä¸ºæœ«ç«¯èåˆæ–¹å¼èåˆè¿™äº›é¢„æµ‹å€¼ã€‚ST-ResNet çš„å¤–éƒ¨å› ç´ åŒ…å«äº†å¤©æ°”ã€å‡æœŸäº‹ä»¶ã€å…ƒæ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;å·ç§¯ç¥ç»ç½‘ç»œçš„å·ç§¯æ ¸é€šå¸¸å¾ˆå°ï¼Œæ„å‘³ç€ä»–ä»¬ä¸èƒ½ç›´æ¥æ•è·è¿œè·ç¦»çš„ç©ºé—´ä¾èµ–ã€‚ç„¶è€Œï¼Œå¤§èŒƒå›´çš„ç©ºé—´ä¾èµ–åœ¨åŸå¸‚ä¸­å¾ˆé‡è¦ã€‚å¦ä¸€æ–¹é¢ï¼ŒST-ResNet å¿½ç•¥äº†äººå£æµåŠ¨çš„åœ¨ä½ç½®ä¸Šçš„å½±å“ã€‚æ­¤å¤–ï¼ŒST-ResNet çš„æœ«ç«¯èåˆæœºåˆ¶å¯¼è‡´äº†æ¨¡å‹äº¤äº’ä¸Šçš„ç¼ºç‚¹ä»¥åŠå‚æ•°çš„ä½æ•ˆï¼Œè¿˜æœ‰æ¨¡å‹çš„ä¸ç¨³å®šçš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;h1 id="our-model"&gt;Our Model
&lt;/h1&gt;&lt;p&gt;å›¾ 2 å±•ç¤ºäº†æˆ‘ä»¬æ¨¡å‹çš„æ¡†æ¶ã€‚ä¸»è¦æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼šæµé‡è¾“å…¥ã€SemanticPlus å’Œ ResPlus å•å…ƒã€‚æµé‡æ…å…¥åŒ…å« &lt;em&gt;closeness, period, terend&lt;/em&gt;ï¼Œç”±äºæ•°æ®çš„æ—¶é—´èŒƒå›´é™åˆ¶å¯ä»¥å‡å°‘ä¸º &lt;em&gt;closeness, period&lt;/em&gt;ã€‚SemanticPlus åŒ…å« POI åˆ†å¸ƒå’Œæ—¶é—´ä¿¡æ¯ã€‚ResPlus å•å…ƒå¯ä»¥æ•è·è¿œè·ç¦»ç©ºé—´ä¾èµ–ã€‚æ¯ä¸ªåŒºåŸŸçš„æµå…¥å’Œæµå‡ºæµé‡é€šè¿‡æ¯å°æ—¶æˆ–è€…æ¯åŠå°æ—¶ç»Ÿè®¡å¾—åˆ°æµé‡åœ°å›¾çš„æ—¶é—´åºåˆ—ã€‚è¿™äº›æµé‡åœ°å›¾é€šè¿‡ Min-Max å½’ä¸€åŒ–å¤„ç†åˆ° $[-1, 1]$ã€‚å¦‚å›¾ 2 æ‰€ç¤ºï¼Œäººå£åˆ†å¸ƒåœ°å›¾é€šè¿‡è¿‘æœŸæ—¶é—´ã€è¿‘é‚»å†å²ã€è¿œæœŸå†å²é€‰æ‹©åä½œä¸ºè¾“å…¥æ”¾å…¥æ¨¡å‹ã€‚ä¸åŒç±»å‹çš„ POI åˆ†å¸ƒé€šè¿‡ Min-Max å½’ä¸€åŒ–åˆ° $[0, 1]$ã€‚å¦‚å›¾ 2 åšéƒ¨åˆ†æ‰€ç¤ºï¼ŒPOI åˆ†å¸ƒåœ°å›¾é€šè¿‡æ—¶é—´ä¿¡æ¯èµ‹äºˆäº†ä¸åŒçš„æƒé‡ã€‚ä¹‹åï¼ŒPOI ä¿¡æ¯å’Œäººæµä¿¡æ¯é€šè¿‡æ—©èåˆåæ”¾å…¥å †å çš„ ResPlus å•å…ƒä¸­ã€‚æœ€åï¼ŒResPlus å•å…ƒä¸åŒçº§åˆ«çš„ç‰¹å¾èåˆåè¿›å…¥å·ç§¯éƒ¨åˆ†ï¼Œç„¶åé€šè¿‡ Tanh æ˜ å°„åˆ° $[-1, 1]$ã€‚ä¸‹é¢ä¼šä»‹ç»ç»†èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/Fig2.JPG"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;h2 id="resplus"&gt;ResPlus
&lt;/h2&gt;&lt;p&gt;å¾ˆå¤šå¤„ç†äººå£æµé‡é¢„æµ‹çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ä¸»è¦åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼šåŸºäº RNN çš„ç»“æ„ï¼Œåƒ ConvLSTM å’Œ Periodic-CRNï¼Œä»¥åŠåŸºäº CNN çš„ç»“æ„ï¼Œå¦‚ Deep-ST å’Œ ST-ResNetã€‚ä½†æ˜¯ï¼Œè®­ç»ƒåŸºäº RNN ç»“æ„çš„æ¨¡å‹è´¹æ—¶ã€‚å› æ­¤æˆ‘ä»¬é€‰ç”¨åŸºäº CNN çš„ç»“æ„ ST-ResNet ä½œä¸ºæˆ‘ä»¬çš„åŸºç¡€æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œæˆ‘ä»¬è®¾è®¡ ConvPlus æ¥æ•è·åŸå¸‚å†…è¿œè·ç¦»çš„ç©ºé—´ä¾èµ–ã€‚å¦‚å›¾ 3ï¼ŒResPlus å•å…ƒä½¿ç”¨ä¸€ä¸ª ConvPlus å’Œä¸€ä¸ªå…¸å‹å·ç§¯ã€‚æˆ‘ä»¬å°è¯•äº† Batch Normalization å’Œ Dropoutï¼Œä¸ºäº†ç®€ä»‹æ²¡æœ‰åœ¨å›¾é‡Œé¢ç”»å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/Fig3.JPG"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;å…¸å‹å·ç§¯çš„æ¯ä¸ªé€šé“å¯¹åº”ä¸€ä¸ªå·ç§¯æ ¸ã€‚å·ç§¯æ ¸ä½¿ç”¨è¿™äº›æ ¸æ¥è®¡ç®—åœ°å›¾ä¸Šçš„äº’ç›¸å…³ç³»æ•°ï¼Œæ¯”å¦‚æ•è·æ¢¯åº¦ä¸Šçš„ç‰¹å¾ã€‚å·ç§¯æ ¸çš„å¤§å°ä¸€èˆ¬å¾ˆå°ã€‚åœ¨ ST-ResNet å’Œ DeepSTN+ é‡Œé¢ï¼Œå·ç§¯æ ¸çš„å¤§å°æ˜¯ $3 \times 3$ã€‚ä½†æ˜¯åŸå¸‚ä¸­å­˜åœ¨ç€è¿œè·ç¦»çš„ä¾èµ–ã€‚äººä»¬å¯èƒ½ååœ°é“å»ä¸Šç­ã€‚æˆ‘ä»¬ç§°è¿™ç±»å…³ç³»å«è¿œè·ç¦»ç©ºé—´ä¾èµ–å…³ç³»ã€‚è¿™ç§å…³ç³»ä½¿å¾—å †å å·ç§¯éš¾ä»¥æœ‰æ•ˆåœ°æ•è·è¿™ä¸ªå…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚å›¾ 3 å·¦éƒ¨åˆ†æ‰€ç¤ºï¼Œåœ¨ ConvPlus ç»“æ„ä¸­ï¼Œæˆ‘ä»¬å°†å…¸å‹å·ç§¯çš„ä¸€äº›é€šé“åˆ†ç¦»æ¥æ•è·æ¯ä¸ªåŒºåŸŸçš„è¿œè·ç¦»ç©ºé—´ä¾èµ–ã€‚ç„¶åç”¨ä¸€ä¸ªå…¨è¿æ¥å±‚ç›´æ¥æ•è·æ¯ä¸¤ä¸ªåŒºåŸŸä¹‹é—´çš„è¿œè·ç¦»ç©ºé—´ä¾èµ–ï¼Œåœ¨è¿™å±‚å‰é¢ç”¨ä¸€ä¸ªæ± åŒ–å±‚æ¥å‡å°‘å‚æ•°ã€‚å› æ­¤ï¼Œåœ¨ ConvPlus çš„è¾“å‡ºæœ‰ä¸¤ç±»é€šé“ã€‚ConvPlus çš„è¾“å‡ºæœ‰ç€å’Œæ™®é€šå·ç§¯ä¸€æ ·çš„è¾“å‡ºï¼Œå¯ä»¥ç”¨äºä¸‹ä¸€ä¸ªå·ç§¯çš„è¾“å…¥ã€‚&lt;/p&gt;
&lt;p&gt;å›¾ 4 å±•ç¤ºäº†ä¸¤ä¸ªä¸åŒåŒºåŸŸçš„ç©ºé—´ä¾èµ–çƒ­åŠ›å›¾ï¼Œåˆ†åˆ«æ˜¯çº¢è‰²å’Œé»„è‰²çš„æ˜Ÿã€‚è¿™äº›ç›®æ ‡åŒºåŸŸä¸ä»…æœ‰åŒºåŸŸä¸Šçš„ä¾èµ–ï¼Œè¿˜æœ‰ä¸€äº›å’Œè¿œå¤„åŒºåŸŸçš„è¿œè·ç¦»ä¾èµ–ã€‚è¿™ä¹Ÿæ˜¾ç¤ºå‡ºä¸åŒçš„åŒºåŸŸå’Œåœ°å›¾ä¸Šçš„å…¶ä»–åŒºåŸŸæœ‰ä¸ä¸€æ ·çš„å…³ç³»ï¼Œè¿™å¾ˆéš¾é€šè¿‡å †å å·ç§¯æœ‰æ•ˆåœ°æ•è·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/Fig4.JPG"
loading="lazy"
alt="Figure4"
&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸º ConvPlus æœ‰ä¸¤ç±»ä¸åŒçš„è¾“å‡ºé€šé“ï¼Œæˆ‘ä»¬åœ¨ ResPlus å•å…ƒä¸­ä½¿ç”¨ ConvPlus + Conv è€Œä¸æ˜¯ ConvPlus + ConvPlusã€‚æ²¡æœ‰ SemanticPlus çš„ DeepSTN+ å½¢å¼åŒ–ä¸ºï¼š&lt;/p&gt;
$$
\widehat{\mathbf{X}} = f\_{Res}(f\_{EF}(\mathbf{X}^c + \mathbf{X}^p + \mathbf{X}^t)),
$$&lt;p&gt;ä¸‰ä¸ª $\mathbf{X}$ è¡¨ç¤ºä¸‰ç§ç±»å‹çš„å†å²åœ°å›¾â€”â€”&lt;em&gt;closeness, period, trend&lt;/em&gt;ã€‚$\widehat{\mathbf{X}}$ è¡¨ç¤ºé¢„æµ‹å‡ºçš„æµé‡åœ°å›¾ã€‚$+$ è¡¨ç¤ºæ‹¼æ¥æ“ä½œã€‚$f_{EF}$ è¡¨ç¤ºç”¨æ¥æ—©èåˆä¸åŒç±»å‹ä¿¡æ¯çš„å·ç§¯å‡½æ•°ï¼Œ$f_{Res}$ è¡¨ç¤ºä¸€ä¸ªå †å çš„ ResPlus å•å…ƒã€‚&lt;/p&gt;
&lt;h2 id="semanticplus"&gt;SemanticPlus
&lt;/h2&gt;&lt;p&gt;POI åœ¨äººå£æµåŠ¨ä¸Šæœ‰å¾ˆå¼ºçƒˆçš„å½±å“ï¼Œè¿™äº›å½±å“éšæ—¶é—´å˜åŒ–è€Œå˜åŒ–ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç»§æ‰¿è¿™ä¸ªå…ˆéªŒçŸ¥è¯†åˆ°æ¨¡å‹å†…ã€‚æˆ‘ä»¬æ‰‹æœºäº†åŒ…æ‹¬ç±»å‹ã€æ•°é‡ã€ä½ç½®çš„ POI ä¿¡æ¯ã€‚ç„¶åç»Ÿè®¡æ¯ä¸ªç½‘æ ¼å†… POI çš„æ•°é‡ï¼Œä½¿ç”¨ä¸€ä¸ªä¸€ç»´å‘é‡è¡¨ç¤ºæ¯ç§ POI çš„åˆ†å¸ƒã€‚å›¾ 5 å±•ç¤ºäº†åŒ—äº¬çš„æµé‡åˆ†å¸ƒåœ°å›¾å’Œé¤é¥®åˆ†å¸ƒåœ°å›¾ã€‚å®ƒä»¬çš„åˆ†å¸ƒå¾ˆç›¸ä¼¼ï¼Œå¹¶ä¸”äº’ç›¸å…³ç³»æ•°æœ‰ 0.87ï¼Œæš—ç¤ºäº†å®ƒä»¬ä¹‹é—´çš„æ½œåœ¨å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/Fig5.JPG"
loading="lazy"
alt="Figure5"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ—¶é—´å‘é‡æ¥è¡¨ç¤ºæ¯ä¸ªäººå£æµé‡åœ°å›¾çš„æ—¶é—´ã€‚æ—¶é—´å‘é‡åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸€ä¸ª one-hot å‘é‡è¡¨ç¤ºä¸€å¤©ä¸­çš„å„ä¸ªæ—¶é—´ï¼Œå¦‚æœæ—¶æ®µæŒ‰å°æ—¶èµ°ï¼Œé‚£é•¿åº¦å°±æ˜¯ 24ï¼›å¦ä¸€ä¸ª one-hot å‘é‡è¡¨ç¤ºæ˜¯ä¸€å‘¨ä¸­çš„å“ªå¤©ï¼Œé•¿åº¦æ˜¯ 7ã€‚ä¸€ä¸ªæ—¶é—´å‘é‡æ‹¼æ¥äº†è¿™ä¸¤ä¸ªå‘é‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å»ºæ¨¡å¯¹æµé‡åœ°å›¾æœ‰å˜åŒ–çš„æ—¶é—´å½±å“çš„ POI ä¿¡æ¯ï¼Œæˆ‘ä»¬å°†æ—¶é—´å‘é‡è½¬æ¢ä¸º POI çš„å½±å“å¼ºåº¦ã€‚æˆ‘ä»¬ä½¿ç”¨å¤§å°ä¸º $PN \times H \times W$ çš„ $\mathbf{X}^s$ æ¥è¡¨ç¤º POI åœ°å›¾ï¼ˆ$PN$ è¡¨ç¤º POI çš„ç±»æ•°ï¼Œ$H$ å’Œ $W$ æ˜¯ç½‘æ ¼çš„è¡Œæ•°å’Œåˆ—æ•°ï¼Œä¸€ä¸ªå‘é‡ $\bf{I}$ ç”¨æ¥è¡¨ç¤ºæ—¶é—´å‘é‡ï¼Œå¤§å°ä¸º $PN$ çš„å‘é‡ $\bf{R}$ è¡¨ç¤º POI çš„å½±å“å¼ºåº¦ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ‰å¸¦æœ‰æ—¶é—´æƒé‡çš„ POI åˆ†å¸ƒï¼Œå½¢å¼åŒ–å¦‚ä¸‹ï¼š&lt;/p&gt;
$$
\mathbf{S} = \mathbf{X}^s \ast \mathbf{R} = \mathbf{X}^s \ast f\_t(\mathbf{I})
$$&lt;p&gt;å‡½æ•° $f_t()$ å°†æ—¶é—´å‘é‡è½¬æ¢ä¸ºè¡¨ç¤º POI å½±å“å¼ºåº¦çš„å‘é‡ã€‚$\ast$ è¡¨ç¤ºæ¯ä¸ª POI åˆ†å¸ƒåœ°å›¾ä¼šè¢«é™„ä¸Šä¸€ä¸ªæƒé‡ï¼Œè¡¨ç¤º POI çš„å½±å“å¼ºåº¦ã€‚æˆ‘ä»¬å‡è®¾åŒä¸€ç±»åœ¨ä¸åŒçš„åŒºåŸŸçš„ POI æœ‰ç›¸åŒçš„æ—¶é—´æ¨¡å¼ã€‚å› æ­¤ï¼Œä¸€ä¸ªç±»åˆ«çš„ POI åˆ†å¸ƒåœ°å›¾ä¼šæœ‰ç›¸åŒçš„æƒé‡ã€‚å›¾ 6 å±•ç¤ºäº†å¨±ä¹å’Œå±…ä½åŒºçš„å½±å“å¼ºåº¦ã€‚å½±å“å¼ºåº¦åœ¨ä¸€å‘¨å†…éšæ—¶é—´çš„å˜åŒ–è€Œå˜åŒ–ï¼Œæ¯å¤©å­˜åœ¨ç€ä¸€äº›å…¸å‹çš„æ¨¡å¼ã€‚å¾ˆå¤šäººæ—©ä¸Šå»ä¸Šç­ï¼Œå·¥ä½œç»“æŸåå›å®¶ï¼Œæ‰€ä»¥æ¯å¤©æ—©ä¸Šå’Œä¸‹åˆä½å®…åŒºæœ‰æ˜æ˜¾çš„ä¸¤ä¸ªå³°ã€‚å¯¹æ¯”å±…ä½åŒºï¼Œå¨±ä¹åŒºçš„å½±å“ç›¸å¯¹ç¨³å®šã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/Fig6.JPG"
loading="lazy"
alt="Figure6"
&gt;&lt;/p&gt;
&lt;h2 id="fusion"&gt;Fusion
&lt;/h2&gt;&lt;p&gt;ä¸‰ç»„ä»¶åº”è¯¥ç”¨æ›´å¤æ‚çš„èåˆæ–¹å¼ï¼Œè€Œä¸æ˜¯çº¿æ€§ç»„åˆã€‚è¿™äº›å¸¦æœ‰ POI ä¿¡æ¯çš„æµé‡ä¿¡æ¯ä¹Ÿæœ‰å¤æ‚çš„äº¤äº’ã€‚ä¸ºäº†å»ºæ¨¡è¿™ç§ç›¸äº’å½±å“ï¼Œæˆ‘ä»¬ä½¿ç”¨æ—©èåˆè€Œä¸æ˜¯æœ«ç«¯èåˆä½¿å¾—ä¸åŒçš„ä¿¡æ¯èƒ½æ›´æ—©çš„èåˆèµ·æ¥ã€‚æ—©èåˆå‡å°‘äº†å¤§çº¦ä¸‰åˆ†ä¹‹äºŒçš„å‚æ•°ã€‚æ­¤å¤–ï¼ŒST-ResNet æœ‰äº›æ—¶å€™ä¸èƒ½æ”¶æ•›ã€‚æˆ‘ä»¬å‘ç°è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡æ—©èåˆå‡å°‘å‚æ•°æ¥ç®€åŒ–æ¨¡å‹è§£å†³ã€‚è€ƒè™‘åˆ°ä¸åŒå±‚çš„ç‰¹å¾æœ‰ä¸åŒçš„å‡½æ•°ï¼Œæˆ‘ä»¬åœ¨æ¨¡å‹æœ«ç«¯è®¾å®šäº†ä¸€ä¸ªå¤šå°ºåº¦çš„èåˆæœºåˆ¶ã€‚è¿™é‡Œæˆ‘ä»¬å½¢å¼åŒ–æè¿°æ•´ä¸ªç½‘ç»œï¼š&lt;/p&gt;
$$
\widehat{\mathbf{X}} = f\_{con}(f\_{Res}(f\_{EF}(\mathbf{X}^c + \mathbf{X}^p + \mathbf{X}^t + \mathbf{S}))),
$$&lt;p&gt;å‡½æ•° $f_{EF}$ è¡¨ç¤ºä¸€ä¸ªæ—©èåˆä½¿ç”¨çš„å·ç§¯æ“ä½œï¼Œåœ¨æ—©èåˆä¹‹å‰å‹ç¼©äº†é€šé“æ•°ã€‚å‡½æ•° $f_{con}$ è¡¨æ˜äº†æœ€åçš„å¤šå°ºåº¦èåˆï¼Œè¡¨ç¤ºå·ç§¯å±‚åçš„ä¸€ä¸ªæ‹¼æ¥å±‚ã€‚$\bf{S}$ è¡¨ç¤º SemanticPlus çš„è¾“å‡ºï¼Œå³ å¸¦æœ‰æ—¶é—´æƒé‡çš„ POI åˆ†å¸ƒã€‚&lt;/p&gt;
&lt;h2 id="training"&gt;Training
&lt;/h2&gt;&lt;p&gt;ç®—æ³• 1 æè¿°äº†è®­ç»ƒè¿‡ç¨‹ã€‚å‰ 7 è¡Œæ˜¯æ„å»ºè®­ç»ƒé›†å’Œ POI ä¿¡æ¯ï¼Œæ¨¡å‹é€šè¿‡ Adam è®­ç»ƒï¼ˆ8-12 è¡Œï¼‰&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/Alg1.JPG"
loading="lazy"
alt="Alg1"
&gt;&lt;/p&gt;
&lt;h1 id="performance-evaluation"&gt;Performance Evaluation
&lt;/h1&gt;&lt;p&gt;è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šä¸åŒåŸå¸‚çš„ä¸åŒç±»å‹çš„æµé‡ä¸Šåšäº†å¤§é‡çš„å®éªŒï¼Œä¸ºäº†å›ç­”ä¸‰ä¸ªç ”ç©¶é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æˆ‘ä»¬çš„æå‡ºçš„ DeepSTN+ æ˜¯å¦æ¯”ç°å­˜çš„æ–¹æ³•å¥½ï¼Ÿ&lt;/li&gt;
&lt;li&gt;ResPlus, SemanticPlus, æ—©èåˆæ˜¯æ€ä¹ˆæå‡é¢„æµ‹ç»“æœçš„ï¼Ÿ&lt;/li&gt;
&lt;li&gt;DeepSTN+ çš„è¶…å‚æ•°å¦‚ä½•å½±å“é¢„æµ‹ç»“æœï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="datasets"&gt;Datasets
&lt;/h2&gt;&lt;p&gt;è¡¨ 1 åŒ…å«äº†æ•°æ®ã€‚æ¯ä¸ªæ•°æ®æœ‰ä¸¤ä¸ªå­é›†ï¼šæµé‡è½¨è¿¹å’Œ POI ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/Table1.JPG"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;MobileBJ:&lt;/strong&gt;&lt;/em&gt; æ•°æ®æ˜¯ä¸­å›½ä¸€ä¸ªå¾ˆæµè¡Œçš„ç¤¾äº¤ç½‘ç»œåº”ç”¨å•†æä¾›çš„ï¼Œæ—¶é—´èŒƒå›´æ˜¯4 æœˆ 1 æ—¥åˆ° 4 æœˆ 30 æ—¥ã€‚è®°å½•äº†ç”¨æˆ·è¯·æ±‚åŒºåŸŸæœåŠ¡æ—¶çš„ä½ç½®ã€‚æˆ‘ä»¬ç”¨å®šä¹‰ 2 è½¬æ¢æˆäº†ç½‘æ ¼æµé‡ã€‚æˆ‘ä»¬é€‰æ‹©æœ€åä¸€å‘¨çš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œå‰é¢çš„ä½œä¸ºè®­ç»ƒé›†ã€‚è¡¨ 2 å±•ç¤ºäº†è¿™ä¸ªæ•°æ®é›†çš„ 17 ç±» POI ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;BikeNYC:&lt;/strong&gt;&lt;/em&gt; NYC çš„è‡ªè¡Œè½¦æ•°æ®ï¼Œ2014 å¹´ï¼Œ4 æœˆ 1 æ—¥åˆ° 9 æœˆ 30 æ—¥ã€‚æ•°æ®åŒ…å«äº†æ—…é€”æ—¶é•¿ï¼Œå‡ºå‘å’Œåˆ°è¾¾ç«™çš„ IDï¼Œèµ·å§‹å’Œç»“æŸæ—¶é—´ã€‚æœ€å 14 å¤©çš„æ•°æ®ç”¨æ¥æµ‹è¯•ï¼Œå…¶ä»–çš„è®­ç»ƒã€‚æˆ‘ä»¬é€‰äº† 9 ç±» POI ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/Table2.JPG"
loading="lazy"
alt="Table2"
&gt;&lt;/p&gt;
&lt;h2 id="baselines"&gt;Baselines
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;HA&lt;/li&gt;
&lt;li&gt;VAR&lt;/li&gt;
&lt;li&gt;ARIMA&lt;/li&gt;
&lt;li&gt;ConvLSTM&lt;/li&gt;
&lt;li&gt;ST-ResNet&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="metrics-and-parameters"&gt;Metrics and Parameters
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;RMSE&lt;/li&gt;
&lt;/ul&gt;
$$
RMSE = \sqrt{\frac{1}{T} \sum^T\_{i=1} \Vert \mathbf{X}\_i - \widehat{X}\_i \Vert^2\_2},
$$&lt;ul&gt;
&lt;li&gt;MAE&lt;/li&gt;
&lt;/ul&gt;
$$
MAE = \frac{1}{T} \sum^T\_{i=1} \vert \mathbf{X}\_i - \widehat{\mathbf{X}}\_i \vert,
$$&lt;p&gt;RMSE ä½œä¸º loss functionã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/Table3.JPG"
loading="lazy"
alt="Table3"
&gt;&lt;/p&gt;
&lt;p&gt;è¡¨ 3 å±•ç¤ºäº†ä¸åŒçš„å‚æ•°è®¾ç½®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/Table4.JPG"
loading="lazy"
alt="Table4"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/Table5.JPG"
loading="lazy"
alt="Table5"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deepstn-context-aware-spatial-temporal-neural-network-for-crowd-flow-prediction-in-metropolis/Fig7.JPG"
loading="lazy"
alt="Figure7"
&gt;&lt;/p&gt;</description></item><item><title>Flow Prediction in Spatio-Temporal Networks Based on Multitask Deep Learning</title><link>https://davidham3.github.io/blog/p/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/</link><pubDate>Fri, 19 Apr 2019 16:40:41 +0000</pubDate><guid>https://davidham3.github.io/blog/p/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/</guid><description>&lt;p&gt;TKDE 2019ï¼Œç½‘æ ¼æµé‡é¢„æµ‹ï¼Œç”¨ä¸€ä¸ªæ¨¡å‹åŒæ—¶é¢„æµ‹æ¯ä¸ªç½‘æ ¼çš„æµå…¥/æµå‡ºæµé‡å’Œç½‘æ ¼ä¹‹é—´çš„è½¬ç§»æµé‡ï¼Œåˆ†åˆ«ç§°ä¸ºé¡¶ç‚¹æµé‡å’Œè¾¹æµé‡ï¼ŒåŒæ—¶é¢„æµ‹è¿™ä¸¤ç±»æµé‡æ˜¯æœ¬æ–‡æ‰€è§£å†³çš„å¤šä»»åŠ¡é¢„æµ‹é—®é¢˜ã€‚æœ¬æ–‡æå‡ºçš„æ˜¯ä¸ªæ¡†æ¶ï¼Œæ‰€ä»¥é‡Œé¢ç”¨ä»€ä¹ˆç»„ä»¶åº”è¯¥éƒ½æ˜¯å¯ä»¥çš„ï¼Œæ–‡ç« ä¸­ä½¿ç”¨äº† FCNã€‚ä½¿ç”¨ä¸¤ä¸ªå­æ¨¡å‹åˆ†åˆ«å¤„ç†é¡¶ç‚¹æµé‡å’Œè¾¹æµé‡é¢„æµ‹é—®é¢˜ï¼Œä½¿ç”¨ä¸¤ä¸ªå­æ¨¡å‹çš„è¾“å‡ºä½œä¸ºéšè—çŠ¶æ€è¡¨ç¤ºï¼Œé€šè¿‡æ‹¼æ¥æˆ–åŠ å’Œçš„æ–¹å¼èåˆï¼Œèåˆåçš„æ–°è¡¨ç¤ºå†åˆ†åˆ«è¾“å‡ºé¡¶ç‚¹æµé‡å’Œè¾¹æµé‡ã€‚è¿™ç¯‡æ–‡ç« å’Œä¹‹å‰éƒ‘å®‡çš„æ–‡ç« ä¸€æ ·ï¼Œè€ƒè™‘äº†ä¸‰ç§æ—¶åºæ€§è´¨ã€èåˆäº†å¤–éƒ¨å› ç´ ã€‚æŸå¤±å‡½æ•°ä»é¡¶ç‚¹æµé‡é¢„æµ‹å€¼å’ŒçœŸå€¼ä¹‹é—´çš„å·®ã€è¾¹æµé‡é¢„æµ‹å€¼å’ŒçœŸå€¼ä¹‹é—´çš„å·®ã€é¡¶ç‚¹æµé‡é¢„æµ‹å€¼ä¹‹å’Œä¸è¾¹æµé‡çš„é¢„æµ‹å€¼ä¹‹å·®ä¸‰ä¸ªæ–¹é¢è€ƒè™‘ã€‚æ•°æ®é›†æ˜¯åŒ—äº¬å’Œçº½çº¦çš„å‡ºç§Ÿè½¦æ•°æ®é›†ã€‚ &lt;a class="link" href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;amp;arnumber=8606218" target="_blank" rel="noopener"
&gt;Flow Prediction in Spatio-Temporal Networks Based on Multitask Deep Learning&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;â€”â€”é¢„æµ‹æµé‡ï¼ˆå¦‚è½¦æµã€äººæµã€è‡ªè¡Œè½¦æµï¼‰åŒ…æ‹¬ç»“ç‚¹çš„æµå…¥ã€æµå‡ºæµé‡ä»¥åŠä¸åŒçš„ç»“ç‚¹é—´çš„è½¬ç§»ï¼Œåœ¨äº¤é€šè¿è¾“ç³»ç»Ÿä¸­çš„æ—¶ç©ºç½‘ç»œé‡Œæ‰®æ¼”ç€é‡è¦çš„è§’è‰²ã€‚ç„¶è€Œï¼Œè¿™ä¸ªé—®é¢˜å—å¤šæ–¹é¢å¤æ‚å› ç´ å½±å“ï¼Œæ¯”å¦‚ä¸åŒåœ°ç‚¹çš„ç©ºé—´å…³ç³»ã€ä¸åŒæ—¶æ®µçš„æ—¶é—´å…³ç³»ã€è¿˜æœ‰åƒæ´»åŠ¨å’Œå¤©æ°”è¿™æ ·çš„å¤–éƒ¨å› ç´ ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸ªæœ‰æŒ‘æˆ˜æ€§çš„é—®é¢˜ã€‚æ­¤å¤–ï¼Œä¸€ä¸ªç»“ç‚¹çš„æµé‡ï¼ˆç»“ç‚¹æµé‡ï¼‰å’Œç»“ç‚¹ä¹‹é—´çš„è½¬ç§»ï¼ˆè¾¹æµé‡ï¼‰äº’ç›¸å½±å“ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªå¤šä»»åŠ¡çš„æ·±åº¦å­¦ä¹ æ¡†æ¶å¯ä»¥åŒæ—¶é¢„æµ‹ä¸€ä¸ªæ—¶ç©ºç½‘ç»œä¸Šçš„ç»“ç‚¹æµé‡å’Œè¾¹æµé‡ã€‚åŸºäºå…¨å·ç§¯ç½‘ç»œï¼Œæˆ‘ä»¬çš„æ–¹æ³•è®¾è®¡äº†ä¸¤ä¸ªå¤æ‚çš„æ¨¡å‹åˆ†åˆ«å¤„ç†ç»“ç‚¹æµé‡é¢„æµ‹å’Œè¾¹æµé‡é¢„æµ‹ã€‚è¿™ä¸¤ä¸ªæ¨¡å‹é€šè¿‡ç»„åˆä¸­é—´å±‚çš„éšè—è¡¨ç¤ºè¿æ¥ï¼Œè€Œä¸”å…±åŒè®­ç»ƒã€‚å¤–éƒ¨å› ç´ é€šè¿‡ä¸€ä¸ªé—¨æ§èåˆæœºåˆ¶å¼•å…¥æ¨¡å‹ã€‚åœ¨è¾¹æµé‡é¢„æµ‹æ¨¡å‹ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªåµŒå…¥ç»„ä»¶æ¥å¤„ç†é¡¶ç‚¹é—´çš„ç³»æ•°è½¬ç§»é—®é¢˜ã€‚æˆ‘ä»¬åœ¨åŒ—äº¬å’Œçº½çº¦çš„å‡ºç§Ÿè½¦æ•°æ®é›†ä¸Šåšäº†å®éªŒã€‚å®éªŒç»“æœæ˜¾ç¤ºæ¯”11ç§æ–¹æ³•éƒ½å¥½ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 Introduction
&lt;/h1&gt;&lt;p&gt;æ—¶ç©ºç½‘ç»œï¼ˆST-networksï¼‰ï¼Œå¦‚è¿è¾“ç½‘ç»œå’Œä¼ æ„Ÿå™¨ç½‘ç»œï¼Œåœ¨ä¸–ç•Œä¸Šåˆ°å¤„éƒ½æ˜¯ï¼Œæ¯ä¸ªç‚¹æœ‰ä¸ªç©ºé—´åæ ‡ï¼Œæ¯ä¸ªè¾¹å…·æœ‰åŠ¨æ€å±æ€§ã€‚æ—¶ç©ºç½‘ç»œä¸­çš„æµé‡æœ‰ä¸¤ç§è¡¨ç¤ºï¼Œå¦‚å›¾ 1ï¼Œé¡¶ç‚¹æµé‡ï¼ˆä¸€ä¸ªç»“ç‚¹çš„æµå…¥å’Œæµå‡ºæµé‡ï¼‰å’Œè¾¹æµé‡ï¼ˆç»“ç‚¹é—´çš„è½¬ç§»æµé‡ï¼‰ã€‚åœ¨è¿è¾“ç³»ç»Ÿä¸­ï¼Œè¿™ä¸¤ç±»æµé‡å¯é€šè¿‡4ç§æ–¹å¼æµ‹é‡ï¼Œ1. è¿‘é‚»é“è·¯çš„è½¦è¾†æ•°ï¼Œ2. å…¬äº¤è½¦çš„æ—…å®¢æ•°ï¼Œ3. è¡Œäººæ•°ï¼Œ4. ä»¥ä¸Šä¸‰ç‚¹ã€‚å›¾1b æ˜¯ä¸€ä¸ªç¤ºæ„å›¾ã€‚å–é¡¶ç‚¹ $r_1$ ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æ‰‹æœºä¿¡ä»¤å’Œè½¦è¾† GPS è½¨è¿¹åˆ†åˆ«è®¡ç®—å¾—åˆ°æµå…¥æµé‡æ˜¯ 3ï¼Œæµå‡ºæµé‡æ˜¯ 3ã€‚$r_3$ åˆ° $r_1$ çš„è½¬ç§»æ˜¯ 3ï¼Œ$r_1$ åˆ° $r_2$ å’Œ $r_4$ çš„è½¬ç§»æ˜¯ 2 å’Œ 1ã€‚å› æ­¤ï¼Œå¦‚å›¾1cæ‰€ç¤ºï¼Œæˆ‘ä»¬èƒ½æ‹¿åˆ°ä¸¤ç§ç±»å‹çš„æµé‡ï¼Œå››ä¸ªç»“ç‚¹çš„æµå…¥å’Œæµå‡ºåˆ†åˆ«æ˜¯ $(3,3,0,5)$ å’Œ $(3,2,5,1)$ã€‚æ‰€æœ‰çš„è¾¹è½¬ç§»éƒ½çœ‹ä½œæ˜¯åœ¨æœ‰å‘å›¾ä¸Šå‘ç”Ÿçš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;é¢„æµ‹è¿™ç±»çš„æµé‡å¯¹å…¬å…±å®‰å…¨ï¼Œäº¤é€šç®¡ç†ï¼Œç½‘ç»œä¼˜åŒ–å¾ˆé‡è¦ã€‚å–äººå£æµåŠ¨åšä¸€ä¸ªä¾‹å­ï¼Œ2015 å¹´è·¨å¹´å¤œçš„ä¸Šæµ·ï¼Œè¸©è¸äº‹æ•…å¯¼è‡´ 36 äººæ­»äº¡ã€‚å¦‚æœèƒ½é¢„æµ‹æ¯ä¸ªåŒºåŸŸä¹‹é—´çš„äººæµè½¬ç§»ï¼Œè¿™æ ·çš„æ‚²å‰§å°±å¯ä»¥é€šè¿‡åº”æ€¥é¢„æ¡ˆé¿å…æˆ–å‡è½»ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼ŒåŒæ—¶é¢„æµ‹æ‰€æœ‰ç»“ç‚¹å’Œè¾¹çš„è½¬ç§»æ˜¯å¾ˆéš¾çš„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Scale and complexity&lt;/strong&gt;: ä¸€ä¸ªåœ°æ–¹çš„æµå…¥å’Œæµå‡ºä¾èµ–äºå®ƒçš„é‚»å±…ï¼Œæœ‰è¿‘é‚»çš„ä¹Ÿæœ‰é¥è¿œçš„ï¼Œå› ä¸ºäººä»¬ä¼šåœ¨è¿™äº›åŒºåŸŸä¹‹é—´è½¬ç§»ï¼Œå°¤å…¶æ˜¯æœ‰æ´»åŠ¨çš„æ—¶å€™ã€‚ç»™å®šä¸€ä¸ªåŸå¸‚ï¼Œæœ‰ $N$ ä¸ªåœ°ç‚¹ï¼Œ$N$ å¾ˆå¤§ï¼Œé‚£ä¹ˆå°±æœ‰ $N^2$ ç§è½¬ç§»æ–¹å¼ï¼Œå°½ç®¡è¿™äº›è½¬ç§»å¯èƒ½ä¸ä¼šåŒæ—¶å‘ç”Ÿã€‚å› æ­¤ï¼Œé¢„æµ‹åœ°ç‚¹çš„æµé‡ï¼Œè¦ä¹ˆæ˜¯æµå…¥ã€æµå‡ºæˆ–æ˜¯è½¬ç§»æµé‡ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘åœ°ç‚¹ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚è€Œä¸”ï¼Œé¢„æµ‹ä¹Ÿè€ƒè™‘è¿‡å»æ—¶æ®µçš„æµé‡ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¸èƒ½å•ç‹¬åœ°é¢„æµ‹æ¯ä¸ªåœ°ç‚¹çš„æµé‡ï¼Œå› ä¸ºåŸå¸‚å†…çš„åœ°ç‚¹é—´æ˜¯ç›¸è¿çš„ï¼Œç›¸å…³çš„ï¼Œäº’ç›¸å½±å“çš„ã€‚å¤æ‚åº¦å’Œå°ºåº¦éƒ½æ˜¯ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå¦‚æ¦‚ç‡å›¾æ¨¡å‹åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶é¢ä¸´çš„å·¨å¤§æŒ‘æˆ˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Model multiple correlations and external factors&lt;/strong&gt;: æˆ‘ä»¬éœ€è¦å¯¹ä¸‰ç§å…³ç³»å»ºæ¨¡æ¥å¤„ç†é¢„æµ‹é—®é¢˜ã€‚ç¬¬ä¸€ä¸ªæ˜¯ä¸åŒåœ°ç‚¹æµé‡çš„ç©ºé—´ç›¸å…³æ€§ï¼ŒåŒ…å«è¿‘é‚»å’Œé¥è¿œçš„ã€‚ç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªåœ°ç‚¹ä¸åŒæ—¶æ®µçš„æµé‡é—´çš„æ—¶é—´å…³ç³»ï¼ŒåŒ…æ‹¬æ—¶é—´è¿‘é‚»ã€å‘¨æœŸå’Œè¶‹åŠ¿æ€§ã€‚ç¬¬ä¸‰ï¼Œæµå…¥æµå‡ºæµé‡å’Œè½¬ç§»æµé‡é«˜åº¦ç›¸å…³ï¼Œäº’ç›¸å½±å“ã€‚ä¸€ä¸ªåŒºåŸŸçš„è½¬å…¥æµé‡ä¹‹å’Œæ˜¯è¿™ä¸ªåŒºåŸŸçš„æµå…¥æµé‡ã€‚ç²¾ç¡®åœ°é¢„æµ‹ä¸€ä¸ªåŒºåŸŸçš„æµå‡ºæµé‡å¯ä»¥è®©é¢„æµ‹å…¶ä»–åŒºåŸŸçš„è½¬ç§»æµé‡æ›´ç²¾ç¡®ï¼Œåä¹‹äº¦ç„¶ã€‚æ­¤å¤–ï¼Œè¿™äº›æµé‡å—å¤–éƒ¨å› ç´ å½±å“ï¼Œå¦‚æ´»åŠ¨ã€å¤©æ°”ã€äº‹æ•…ç­‰ã€‚å¦‚ä½•æ•´åˆè¿™äº›ä¿¡æ¯è¿˜æ˜¯ä¸ªéš¾é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Dynamics and sparsity&lt;/strong&gt;: ç”±äº $N^2$ ç§æƒ…å†µï¼ŒåŒºåŸŸé—´éšæ—¶é—´æ”¹å˜çš„è½¬ç§»æµé‡æ¯”æµå…¥æµå‡ºæµé‡è¦å¤§å¾—å¤šã€‚ä¸€ä¸ªåœ°ç‚¹å’Œå…¶ä»–åœ°ç‚¹é—´çš„è½¬ç§»ä¼šåœ¨æ¥ä¸‹æ¥çš„æ—¶æ®µå‘ç”Ÿï¼Œå¯èƒ½æ˜¯ $N^2$ ä¸­çš„å¾ˆå°ä¸€éƒ¨åˆ†ï¼ˆç¨€ç–ï¼‰ã€‚é¢„æµ‹è¿™æ ·çš„ç¨€ç–è½¬ç§»ä¹Ÿæ˜¯ä¸ªéš¾é¢˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ºäº†è§£å†³ä¸Šè¿°æŒ‘æˆ˜ï¼Œæˆ‘ä»¬æå‡ºäº†å¤šä»»åŠ¡æ·±åº¦å­¦ä¹ æ¡†æ¶MDLï¼ˆå›¾4ï¼‰æ¥åŒæ—¶é¢„æµ‹é¡¶ç‚¹æµé‡å’Œè¾¹æµé‡ã€‚æˆ‘ä»¬çš„è´¡çŒ®æœ‰ä¸‰ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;MDL è®¾è®¡äº†ä¸€ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œæ¥é¢„æµ‹é¡¶ç‚¹æµé‡ï¼ˆå‘½åä¸º NODENETï¼‰ï¼Œå¦ä¸€ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œé¢„æµ‹è¾¹æµé‡ï¼ˆå‘½åä¸º EDGENETï¼‰ã€‚é€šè¿‡å°†ä»–ä»¬çš„éšè—çŠ¶æ€æ‹¼æ¥æ¥è¿æ¥è¿™ä¸¤ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œï¼Œå¹¶ä¸€åŒè®­ç»ƒã€‚æ­¤å¤–ï¼Œè¿™ä¸¤ç±»æµé‡çš„ç›¸å…³æ€§é€šè¿‡æŸå¤±å‡½æ•°ä¸­çš„æ­£åˆ™é¡¹æ¥å»ºæ¨¡ã€‚åŸºäºæ·±åº¦å­¦ä¹ çš„æ¨¡å‹å¯ä»¥å¤„ç†å¤æ‚æ€§å’Œå°ºåº¦ç­‰é—®é¢˜ï¼ŒåŒæ—¶å¤šä»»åŠ¡æ¡†æ¶å¢å¼ºäº†æ¯ç±»æµé‡çš„é¢„æµ‹æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;NODENET å’Œ EDGENET éƒ½æ˜¯ three-stream å…¨å·ç§¯ç½‘ç»œï¼ˆ3S-FCNsï¼‰ï¼Œcloseness-stream, period-stream, trend-stream æ•è·ä¸‰ç§ä¸åŒçš„æ—¶é—´ç›¸å…³æ€§ã€‚æ¯ä¸ª FCN ä¹ŸåŒæ—¶æ•è·è¿‘é‚»å’Œé¥è¿œçš„ç©ºé—´å…³ç³»ã€‚ä¸€ä¸ªé—¨æ§ç»„ä»¶ç”¨æ¥èåˆæ—¶ç©ºç›¸å…³æ€§å’Œå¤–éƒ¨å› ç´ ã€‚ä¸ºäº†è§£å†³è½¬ç§»ç¨€ç–çš„é—®é¢˜ï¼ŒEDGENET ä¸­æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªåµŒå…¥ç»„ä»¶ï¼Œç”¨ä¸€ä¸ªéšè—ä½ç»´è¡¨ç¤ºç¼–ç äº†ç¨€ç–é«˜ç»´çš„è¾“å…¥ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬åœ¨åŒ—äº¬å’Œçº½çº¦çš„ taxicab data ä¸Šè¯„ä¼°äº†æ–¹æ³•ã€‚ç»“æœæ˜¾ç¤ºæˆ‘ä»¬çš„ MDL è¶…è¶Šäº†å…¶ä»– 11 ç§æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¡¨ 1 åˆ—å‡ºäº†è¿™ç¯‡æ–‡ç« ä¸­å‡ºç°çš„æ•°å­¦ç¬¦å·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Table1.JPG"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;h1 id="2-problem-formulation"&gt;2 Problem Formulation
&lt;/h1&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;Definition 1(Node).&lt;/strong&gt;&lt;/em&gt; ä¸€ä¸ªç©ºé—´åœ°å›¾åŸºäºç»çº¬åº¦è¢«åˆ†æˆ $I \times J$ ä¸ªç½‘æ ¼ï¼Œè¡¨ç¤ºä¸º $V = \lbrace r_1, r_2, &amp;hellip;, r_{I\times J} \rbrace$ï¼Œæ¯ä¸ªå…ƒç´ è¡¨ç¤ºä¸€ä¸ªç©ºé—´èŠ‚ç‚¹ï¼Œå¦‚å›¾2(a)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Fig2.JPG"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ $(\tau, x, y)$ ä¸ºæ—¶ç©ºåæ ‡ï¼Œ$\tau$ è¡¨ç¤ºæ—¶é—´æˆ³ï¼Œ$(x, y)$ è¡¨ç¤ºç©ºé—´ç‚¹ã€‚ä¸€ä¸ªç‰©ä½“çš„ç§»åŠ¨å¯ä»¥è®°ä¸ºä¸€ä¸ªæŒ‰æ—¶é—´é¡ºåºçš„ç©ºé—´è½¨è¿¹ï¼Œèµ·ç‚¹å’Œç»ˆç‚¹è¡¨ç¤ºä¸º $s = (\tau_s, x_s, y_s)$ å’Œ $e = (\tau_e, x_e, y_e)$ï¼Œè¡¨ç¤ºå‡ºå‘åœ°å’Œç›®çš„åœ°ã€‚$\mathbb{P}$ è¡¨ç¤ºæ‰€æœ‰çš„èµ·æ­¢å¯¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Definition 2(In/out flows).&lt;/strong&gt;&lt;/em&gt; ç»™å®šä¸€ç»„èµ·æ­¢å¯¹ $\mathbb{P}$ã€‚$\mathcal{T} = \lbrace t_1, \dots t_T\rbrace$ è¡¨ç¤ºä¸€ä¸ªæ—¶æ®µåºåˆ—ã€‚å¯¹äºåœ°å›¾ä¸Šç¬¬ $i$ è¡Œç¬¬ $j$ åˆ—çš„é¡¶ç‚¹ $r_{ij}$ï¼Œæ—¶æ®µ $t$ æµå‡ºå’Œæµå…¥çš„æµé‡åˆ†åˆ«å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{1}
\mathcal{X}\_t(0, i, j) = \vert \lbrace (s,e) \in \mathbb{P} : (x\_s, y\_s) \in r\_{ij} \wedge \tau\_s \in t \rbrace \vert
$$$$\tag{2}
\mathcal{X}\_t(1, i, j) = \vert \lbrace (s,e) \in \mathbb{P} : (x\_e, y\_e) \in r\_{ij} \wedge \tau\_e \in t \rbrace \vert
$$&lt;p&gt;å…¶ä¸­ $\mathcal{X}_t(0, :, :)$ å’Œ $\mathcal{X}_t(1, :, :)$ è¡¨ç¤ºæµå‡ºå’Œæµå…¥çŸ©é˜µã€‚$(x, y) \in r_{ij}$ è¡¨ç¤ºç‚¹ $(x, y)$ åœ¨é¡¶ç‚¹ $r_{ij}$ ä¸Šï¼Œ$\tau_e \in t$ è¡¨ç¤ºæ—¶é—´æˆ³ $\tau_e$ åœ¨æ—¶æ®µ $t$ å†…ã€‚æµå…¥å’Œæµå‡ºçŸ©é˜µåœ¨ç‰¹å®šæ—¶é—´çš„çŸ©é˜µå¦‚å›¾2ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸¤ç±»æµé‡ï¼ˆæµå…¥å’Œæµå‡ºï¼‰ï¼Œä¸€ä¸ªéšæ—¶é—´å˜åŒ–çš„ç©ºé—´åœ°å›¾ä¸€èˆ¬è¡¨ç¤ºä¸€ä¸ªæ—¶é—´æœ‰åºçš„å¼ é‡åºåˆ—ï¼Œæ¯ä¸ªå¼ é‡å¯¹åº”åœ°å›¾åœ¨ç‰¹å®šæ—¶é—´çš„ä¸€ä¸ªå¿«ç…§ã€‚è¯¦ç»†æ¥è¯´ï¼Œæ¯ä¸ªå¼ é‡åŒ…å«ä¸¤ä¸ªçŸ©é˜µï¼šæµå…¥çŸ©é˜µå’Œæµå‡ºçŸ©é˜µï¼Œå¦‚å›¾ 2 æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;è®© $V$ è¡¨ç¤ºæ—¶ç©ºç½‘ç»œä¸­çš„é¡¶ç‚¹é›†ï¼Œ$N \triangleq \vert V \vert = I \times J$ æ˜¯é¡¶ç‚¹æ•°ã€‚ä¸€ä¸ªæ—¶é—´å›¾åŒ…å« $T$ ä¸ªç¦»æ•£çš„ä¸é‡å çš„æ—¶æ®µï¼Œè¡¨ç¤ºä¸ºæœ‰å‘å›¾ $G_{t_1}, \dots G_{t_T}$ çš„æ—¶é—´æœ‰åºåºåˆ—ã€‚å›¾ $G_t = (V, E_t)$ æ•è·äº†æ—¶æ®µ $t$ æ—¶ç©ºç³»ç»Ÿä¸Šçš„æ‹“æ‰‘çŠ¶æ€ã€‚å¯¹äºæ¯ä¸ªå›¾ $G_t$ (å…¶ä¸­ $t = t_1, \dots, t_T$) å­˜åœ¨ä¸€ä¸ªå¯¹åº”çš„æƒé‡çŸ©é˜µ $\mathbf{S}_t \in \mathbb{R}^{N \times N}$ï¼Œè¡¨ç¤ºæ—¶æ®µ $t$ çš„å¸¦æƒæœ‰å‘è¾¹ã€‚åœ¨æˆ‘ä»¬çš„ç ”ç©¶ä¸­ï¼Œæ—¶æ®µ $t$ é¡¶ç‚¹ $r_s$ åˆ°é¡¶ç‚¹ $r_e$ çš„è¾¹çš„æƒé‡ï¼Œæ˜¯ä¸€ä¸ªéè´Ÿæ ‡é‡ï¼Œè¡¨ç¤º $r_s$ åˆ° $r_e$ çš„ &lt;em&gt;transition&lt;/em&gt;ï¼Œæ—¶æ®µ $t$ ä¸Šä¸¤ä¸ªé¡¶ç‚¹é—´æ²¡æœ‰è¿æ¥çš„è¯ï¼Œå¯¹åº”çš„å…ƒç´ åœ¨ $\mathbf{S}_t$ ä¸­ä¸º 0ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Definition 3 (Transition).&lt;/strong&gt;&lt;/em&gt; ç»™å®šä¸€ç»„èµ·æ­¢ç‚¹å¯¹ $\mathbb{P}$ã€‚$\mathcal{T} = \lbrace t_1, \dots, t_T \rbrace$ æ˜¯ä¸€ç»„æ—¶æ®µçš„åºåˆ—ã€‚$\mathbf{S}_t$ æ˜¯æ—¶æ®µ $t$ çš„è½¬ç§»çŸ©é˜µï¼Œ$r_s$ åˆ° $r_e$ ä¹‹é—´çš„è½¬ç§»è¡¨ç¤ºä¸º $\mathbf{S}_t(r_s, r_e)$ï¼Œå®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{3}
\mathbf{S}\_t(r\_s, r\_e) = \vert \lbrace (s,e) \in \mathbb{P} : (x\_s, y\_s) \in r\_s \wedge (x\_e, y\_e) \in r\_e \wedge \tau\_s \in t \wedge \tau\_e \in t \rbrace \vert
$$&lt;p&gt;å…¶ä¸­ $r_s, r_e \in V$ æ˜¯èµ·å§‹é¡¶ç‚¹å’Œç»ˆæ­¢é¡¶ç‚¹ã€‚$(x, y) \in r$ è¡¨ç¤ºç‚¹ $(x, y)$ åœ¨ç½‘æ ¼ $r$ ä¸Šã€‚$\tau_s \in t$ å’Œ $\tau_e \in t$ è¡¨ç¤ºæ—¶é—´æˆ³ $\tau_s$ å’Œ $\tau_e$ éƒ½åœ¨æ—¶æ®µ $t$ å†…ã€‚æˆ‘ä»¬è€ƒè™‘è½¬ç§»è‡³å‘ç”Ÿåœ¨ä¸€ä¸ªç‰¹å®šçš„æ—¶æ®µå†…ã€‚å› æ­¤ï¼Œå¯¹äºå®é™…åº”ç”¨æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é¢„æµ‹èµ·å§‹å’Œç»“æŸéƒ½å‘ç”Ÿåœ¨æœªæ¥çš„è½¬ç§»ã€‚&lt;/p&gt;
&lt;h2 id="21-converting-time-varying-graphs-into-tensors"&gt;2.1 Converting time-varying graphs into tensors
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬å°†æ¯ä¸ªæ—¶é—´ä¸Šçš„å›¾è½¬ä¸ºå¼ é‡ã€‚ç»™å®šæ—¶é—´ $t$ æœ‰å‘å›¾ $G_t = (V, E_t)$ï¼Œæˆ‘ä»¬å…ˆåšå±•å¼€ï¼Œç„¶åè®¡ç®—æœ‰å‘å¸¦æƒçŸ©é˜µï¼ˆè½¬ç§»çŸ©é˜µ $\mathbf{S}_t$ï¼‰ï¼Œæœ€åç»™å®šä¸€ä¸ªå¼ é‡ $\mathcal{M}_t \in \mathbf{R}^{2N \times I \times J}$ã€‚å›¾ 3 æ˜¯ç¤ºæ„å›¾ã€‚(a)ç»™å®šæ—¶é—´ $t$ 4 ä¸ªé¡¶ç‚¹ 6 æ¡è¾¹çš„å›¾ã€‚(b)é¦–å…ˆå±•å¼€æˆæœ‰å‘å›¾ã€‚(c)å¯¹æ¯ä¸ªé¡¶ç‚¹ï¼Œæœ‰ä¸€ä¸ªæµå…¥çš„è½¬ç§»ï¼Œè¿˜æœ‰ä¸ªæµå‡ºçš„è½¬ç§»ï¼Œç”±ä¸€ä¸ªå‘é‡è¡¨ç¤ºï¼ˆç»´åº¦æ˜¯8ï¼‰ã€‚å– $r_1$ ä¸ºä¾‹ï¼Œå®ƒçš„æµå‡ºå’Œæµå…¥è½¬ç§»å‘é‡åˆ†åˆ«ä¸º $[0, 2, 0, 1]$ å’Œ $[0, 0, 3, 0]$ï¼Œæ‹¼æ¥åå¾—åˆ°ä¸€ä¸ªå‘é‡ $[0, 2, 0, 1, 0, 0, 3, 0]$ï¼ŒåŒ…å«æµå‡ºå’Œæµå…¥çš„ä¿¡æ¯ã€‚(d)æœ€åï¼Œæˆ‘ä»¬å°†çŸ©é˜µ reshape æˆä¸€ä¸ªå¼ é‡ï¼Œæ¯ä¸ªé¡¶ç‚¹æ ¹æ®åŸæ¥åœ°å›¾æœ‰ä¸€ä¸ªå›ºå®šçš„ç©ºé—´ä½ç½®ï¼Œä¿æŠ¤äº†ç©ºé—´ç›¸å…³æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Fig3.JPG"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;h2 id="22-flow-prediction-problem"&gt;2.2 FLow Prediction Problem
&lt;/h2&gt;&lt;p&gt;æµé‡é¢„æµ‹ï¼Œç®€å•æ¥è¯´ï¼Œæ˜¯æ—¶é—´åºåˆ—é—®é¢˜ï¼Œç›®æ ‡æ˜¯ç»™å®šå†å² $T$ ä¸ªæ—¶æ®µçš„è§‚æµ‹å€¼ï¼Œé¢„æµ‹ $T+1$ æ—¶æ®µæ¯ä¸ªåŒºåŸŸçš„æµé‡ã€‚ä½†æ˜¯æˆ‘ä»¬çš„æ–‡ç« ä¸­æµé‡æœ‰ä¸¤ä¸ªå±‚æ¬¡ï¼Œæµå…¥å’Œæµå‡ºä»¥åŠåŒºåŸŸé—´çš„è½¬ç§»æµé‡ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åŒæ—¶é¢„æµ‹è¿™äº›æµé‡ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜èå…¥äº†å¤–éƒ¨å› ç´ å¦‚æˆ¿ä»·ä¿¡æ¯ï¼Œå¤©æ°”çŠ¶å†µï¼Œæ¸©åº¦ç­‰ç­‰ã€‚è¿™äº›å¤–éƒ¨å› ç´ å¯ä»¥æ”¶é›†å¹¶æä¾›ä¸€äº›é¢å¤–æœ‰ç”¨çš„ä¿¡æ¯ã€‚ç›¸å…³çš„ç¬¦å·åœ¨è¡¨ 1 ä¹‹ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Problem 1.&lt;/strong&gt;&lt;/em&gt; ç»™å®šå†å²è§‚æµ‹å€¼ $\lbrace \mathcal{X}_t, \mathcal{M}_t \mid t = t_1, \dots, t_T \rbrace$ï¼Œå¤–éƒ¨ç‰¹å¾ $\mathcal{E}_T$ï¼Œæˆ‘ä»¬æå‡ºä¸€ä¸ªæ¨¡å‹å…±åŒé¢„æµ‹ $\mathcal{X}_{t_{T+1}}$ å’Œ $\mathcal{M}_{t_{T+1}}$ã€‚&lt;/p&gt;
&lt;h1 id="3-multitask-deep-learning"&gt;3 Multitask Deep Learning
&lt;/h1&gt;&lt;p&gt;å›¾ 4 å±•ç¤ºäº†æˆ‘ä»¬çš„ MDL æ¡†æ¶ï¼ŒåŒ…å« 3 ä¸ªç»„æˆéƒ¨åˆ†ï¼Œåˆ†åˆ«ç”¨äºæ•°æ®è½¬æ¢ï¼Œé¡¶ç‚¹æµé‡å»ºæ¨¡ï¼Œè¾¹æµé‡å»ºæ¨¡ã€‚æˆ‘ä»¬é¦–å…ˆå°†è½¨è¿¹ï¼ˆæˆ–è®¢å•ï¼‰æ•°æ®è½¬æ¢æˆä¸¤ç±»æµé‡ï¼Œi) é¡¶ç‚¹æµé‡è¡¨ç¤ºæˆæœ‰æ—¶é—´é¡ºåºçš„å¼ é‡åºåˆ— $\lbrace\mathcal{X}_t \mid t = t_1, \dots, t_T \rbrace$ (1a); ii) è¾¹æµé‡æ˜¯ä¸€ä¸ªæœ‰æ—¶é—´é¡ºåºçš„å›¾åºåˆ—ï¼ˆè½¬ç§»çŸ©é˜µï¼‰$\lbrace\mathbf{S}_t \mid t = t_1, \dots, t_T \rbrace$ (2a)ï¼Œä¹‹åå†æ ¹æ® 2.1 èŠ‚çš„æ–¹æ³•è½¬æ¢ä¸ºå¼ é‡çš„åºåˆ— $\lbrace\mathcal{M}_t \mid t = t_1, \dots, t_T \rbrace$ (2b)ã€‚è¿™ä¸¤ç±»åƒè§†é¢‘ä¸€æ ·çš„æ•°æ®ä¹‹åæ”¾åˆ° NODENET å’Œ EDGENET ä¸­ã€‚ä»¥ NODENET ä¸ºä¾‹ï¼Œå®ƒé€‰äº†ä¸‰ä¸ªä¸åŒç±»å‹çš„ç‰‡æ®µï¼Œæ”¾å…¥ 3S-FCN ä¸­ï¼Œå¯¹æ—¶é—´ç›¸å…³æ€§å»ºæ¨¡ã€‚åœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œæ¯éƒ¨åˆ†çš„ FCN å¯ä»¥é€šè¿‡å¤šé‡å·ç§¯æ•è·ç©ºé—´ç›¸å…³æ€§ã€‚NODENET å’Œ EDGENET ä¸­é—´çš„éšè—è¡¨ç¤ºé€šè¿‡ä¸€ä¸ª BRIDGE ç»„ä»¶è¿æ¥ï¼Œä½¿ä¸¤ä¸ªæ¨¡å‹å¯ä»¥å…±åŒè®­ç»ƒã€‚æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªåµŒå…¥å±‚æ¥å¤„ç†è½¬ç§»ç¨€ç–çš„é—®é¢˜ã€‚ä¸€ä¸ªé—¨æ§èåˆç»„ä»¶ç”¨æ¥æ•´åˆå¤–éƒ¨ä¿¡æ¯ã€‚é¡¶ç‚¹æµé‡å’Œè¾¹æµé‡ç”¨ä¸€ä¸ªæ­£åˆ™åŒ–æ¥å»ºæ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Fig4.JPG"
loading="lazy"
alt="Figure4"
&gt;&lt;/p&gt;
&lt;h2 id="31-edgenet"&gt;3.1 EDGENET
&lt;/h2&gt;&lt;p&gt;æ ¹æ®ä¸Šè¿°çš„è½¬æ¢æ–¹æ³•ï¼Œæ¯ä¸ªæ—¶æ®µçš„è½¬ç§»å›¾å¯ä»¥è½¬æ¢æˆä¸€ä¸ªå¼ é‡ $\mathcal{M}_t \in \mathbb{R}^{2N \times I \times J}$ã€‚å¯¹äºæ¯ä¸ªé¡¶ç‚¹ $r_{ij}$ï¼Œå®ƒæœ€å¤šæœ‰ $2N$ ä¸ªè½¬ç§»æ¦‚ç‡ï¼ŒåŒ…å« $N$ ä¸ªæµå…¥å’Œ $N$ ä¸ªæµå‡ºã€‚ç„¶è€Œï¼Œå¯¹äºä¸€ä¸ªç¡®å®šçš„æ—¶æ®µï¼Œé¡¶ç‚¹é—´çš„è½¬ç§»æ˜¯ç¨€ç–çš„ã€‚å— NLP çš„åµŒå…¥æ–¹æ³•å¯å‘ï¼Œæˆ‘ä»¬æå‡ºäº†ä½¿ç”¨ç©ºé—´åµŒå…¥æ–¹æ³•ï¼Œè§£å†³è¿™æ ·çš„ç¨€ç–å’Œé«˜ç»´é—®é¢˜ã€‚è¯¦ç»†æ¥è¯´ï¼Œç©ºé—´åµŒå…¥å€¾å‘äºå­¦ä¹ ä¸€ä¸ªå°† $2N$ ç»´æ˜ å°„åˆ° $k$ ç»´çš„å‡½æ•°ï¼š&lt;/p&gt;
$$\tag{4}
\mathcal{Z}\_t(:, i, j) = \mathbf{W}\_m \mathcal{M}\_t (:, i, j) + \mathbf{b}\_m, 1 \leq i \leq I, 1 \leq j \leq J
$$&lt;p&gt;å…¶ä¸­ $\mathbf{W}_m \in \mathbb{R}^{k \times 2N}$ å’Œ $\mathbf{b}_m \in \mathbb{R}^k$ æ˜¯å‚æ•°ã€‚æ‰€æœ‰çš„ç»“ç‚¹å…±äº«å‚æ•°ã€‚$\mathcal{M}_t(:, i, j) \in \mathbb{R}^{2N}$ è¡¨ç¤º $(i, j)$ çš„å‘é‡ã€‚&lt;/p&gt;
&lt;p&gt;æµé‡ï¼Œæ¯”å¦‚åŸå¸‚ä¸­çš„äº¤é€šæµï¼Œæ€»æ˜¯å—æ—¶ç©ºä¾èµ–å…³ç³»å½±å“ã€‚ä¸ºäº†æ•è·ä¸åŒçš„æ—¶é—´ä¾èµ–ï¼ˆè¿‘é‚»ã€å‘¨æœŸã€è¶‹åŠ¿ï¼‰ï¼ŒZhang et al. æå‡ºäº†æ·±åº¦æ—¶ç©ºæ®‹å·®ç½‘ç»œï¼Œæ²¿æ—¶é—´è½´é€‰æ‹©ä¸åŒçš„å…³é”®å¸§ã€‚å—è¿™ç‚¹çš„å¯å‘ï¼Œæˆ‘ä»¬é€‰æ‹©è¿‘é‚»ã€è¾ƒè¿‘ã€è¿œæœŸå…³é”®å¸§æ¥é¢„æµ‹æ—¶æ®µ $t$ï¼Œåˆ†åˆ«è¡¨ç¤ºä¸º $M^{dep}_t = \lbrace M^{close}_t, M^{period}_t, M^{trend}_t \rbrace$ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Closeness&lt;/strong&gt; dependents:
$$M^{close}\_t = \lbrace \mathcal{Z}\_{t-l\_c}, \dots, \mathcal{Z}\_{t-1} \rbrace$$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Period&lt;/strong&gt; dependents:
$$M^{period}\_t = \lbrace \mathcal{Z}\_{t-l\_p}, \mathcal{Z}\_{t-(l\_p - 1) \cdot p}, \dots, \mathcal{Z}\_{t-p} \rbrace$$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Trend&lt;/strong&gt; dependents:
$$M^{trend}\_t = \lbrace \mathcal{Z}\_{t-l\_q \cdot q}, \mathcal{Z}\_{t-(l\_q - 1)\cdot q}, \dots, \mathcal{Z}\_{t-q} \rbrace$$&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶ä¸­ $p$ å’Œ $q$ æ˜¯å‘¨æœŸå’Œè¶‹åŠ¿èŒƒå›´ã€‚$l_c$, $l_p$ å’Œ $l_q$ æ˜¯ä¸‰ä¸ªåºåˆ—çš„é•¿åº¦ã€‚&lt;/p&gt;
&lt;p&gt;è¾“å‡ºï¼ˆå³ä¸‹ä¸ªæ—¶æ®µçš„é¢„æµ‹ï¼‰å’Œè¾“å…¥æœ‰ç›¸åŒçš„åˆ†è¾¨ç‡ã€‚è¿™æ ·çš„äººç‰©å’Œå›¾åƒåˆ†å‰²é—®é¢˜å¾ˆåƒï¼Œå¯ä»¥é€šè¿‡å…¨å·ç§¯ç½‘ç»œ (FCN) [22] å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;å—åˆ°è¿™ä¸ªå¯å‘ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸‰ç»„ä»¶çš„ FCNï¼Œå¦‚å›¾ 4ï¼Œæ¥æ•è·æ—¶é—´è¿‘é‚»ã€å‘¨æœŸå’Œè¶‹åŠ¿ä¾èµ–ã€‚æ¯ä¸ªç»„ä»¶éƒ½æ˜¯ä¸ª FCNï¼ŒåŒ…å«äº†å¾ˆå¤šå·ç§¯ï¼ˆå›¾ 5ï¼‰ã€‚æ ¹æ®å·ç§¯çš„æ€§è´¨ï¼Œä¸€ä¸ªå·ç§¯å±‚å¯ä»¥æ•è·ç©ºé—´è¿‘é‚»å…³ç³»ã€‚éšç€å·ç§¯å±‚æ•°çš„å¢åŠ ï¼ŒFCN å¯ä»¥æ•è·æ›´è¿œçš„ä¾èµ–ï¼Œç”šè‡³æ˜¯åŸå¸‚èŒƒå›´å¤§å°çš„ç©ºé—´ä¾èµ–ã€‚ç„¶è€Œï¼Œè¿™æ ·çš„æ·±å±‚å·ç§¯ç½‘ç»œå¾ˆéš¾è®­ç»ƒã€‚å› æ­¤æˆ‘ä»¬ä½¿ç”¨æ®‹å·®è¿æ¥æ¥å¸®åŠ©è®­ç»ƒã€‚ç±»ä¼¼æ®‹å·®ç½‘ç»œä¸­çš„æ®‹å·®è¿æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªåŒ…å« BNï¼ŒReLUï¼Œå·ç§¯çš„å—ã€‚ä»¤ä¸‰ä¸ªè¿‘é‚»ã€å‘¨æœŸã€è¶‹åŠ¿ä¸‰ç»„ä»¶çš„è¾“å‡ºåˆ†åˆ«ä¸º $\mathcal{M}_c$, $\mathcal{M}_p$, $\mathcal{M}_q$ã€‚ä¸åŒçš„é¡¶ç‚¹åœ¨è¿‘é‚»ã€å‘¨æœŸã€è¶‹åŠ¿ä¸Šå¯èƒ½æœ‰ä¸åŒçš„æ€§è´¨ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºä½¿ç”¨ä¸€ä¸ªåŸºäºå‚æ•°çŸ©é˜µçš„èåˆæ–¹å¼ï¼ˆå›¾ 4 ä¸­çš„ PM èåˆï¼‰ï¼š&lt;/p&gt;
$$\tag{5}
\mathcal{M}\_{fcn} = \mathbf{W}\_c \odot \mathcal{M}\_c + \mathbf{W}\_p \odot \mathcal{M}\_p + \mathbf{W}\_q \odot \mathcal{M}\_q
$$&lt;p&gt;å…¶ä¸­ $\odot$ æ˜¯å“ˆè¾¾ç›ç§¯ï¼Œ$\mathbf{W}$ æ˜¯å‚æ•°ï¼Œè°ƒæ•´ä¸‰ç§æ—¶é—´ä¾èµ–å…³ç³»çš„å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Fig5.JPG"
loading="lazy"
alt="Figure5"
&gt;&lt;/p&gt;
&lt;h2 id="32-nodenet-and-bridge"&gt;3.2 NODENET and BRIDGE
&lt;/h2&gt;&lt;p&gt;ç±»ä¼¼ EDGENETï¼ŒNODENET ä¹Ÿæ˜¯ä¸€ä¸ª 3S-GCNï¼Œæˆ‘ä»¬é€‰æ‹©è¿‘é‚»ã€è¾ƒè¿‘ã€é¥è¿œçš„å…³é”®å¸§ä½œä¸ºè¿‘é‚»ã€å‘¨æœŸã€è¶‹åŠ¿ä¾èµ–ã€‚åŒºåˆ«æ˜¯ NODENET æ²¡æœ‰åµŒå…¥å±‚å› ä¸ºè¾“å…¥çš„é€šé“æ•°åªæœ‰ 2ã€‚è¿™ä¸‰ç§ä¸åŒçš„ä¾èµ–æ”¾å…¥ä¸‰ä¸ªä¸åŒçš„ FCN ä¸­ï¼Œè¾“å‡ºé€šè¿‡ PM èåˆç»„ä»¶èåˆï¼ˆå›¾ 4ï¼‰ã€‚ç„¶åï¼Œå¾—åˆ° 3S-FCN çš„è¾“å‡ºï¼Œè¡¨ç¤ºä¸º $\mathcal{X}_{fcn} \in \mathbb{R}^{C_x \times I \times J}$ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘é¡¶ç‚¹æµé‡ä¸è¾¹æµé‡çš„ç›¸å…³æ€§ï¼Œæ‰€ä»¥ä» NODENET å’Œ EDGENET å­¦ä¹ åˆ°çš„è¡¨ç¤ºåº”è¯¥è¢«è¿èµ·æ¥ã€‚ä¸ºäº†è¿æ¥ NODENET å’Œ EDGENETï¼Œå‡è®¾ NODENET å’Œ EDGENET çš„éšè—è¡¨ç¤ºåˆ†åˆ«ä¸º $\mathcal{X}_{fcn}$ å’Œ $\mathcal{M}_{fcn}$ã€‚æˆ‘ä»¬æå‡ºä¸¤ç§èåˆæ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;SUM Fusion:&lt;/strong&gt; åŠ å’Œèåˆæ–¹æ³•ç›´æ¥å°†ä¸¤ç§è¡¨ç¤ºç›¸åŠ ï¼š&lt;/p&gt;
$$\tag{6}
\mathcal{H}(c, :, :) = \mathcal{X}\_{fcn}(c, :, :) + \mathcal{M}\_{fcn}(c, :, :), c = 0, \dots, C - 1
$$&lt;p&gt;å…¶ä¸­ $C$ æ˜¯ $\mathcal{X}_{fcn}$ å’Œ $\mathcal{M}_{fcn}$ çš„é€šé“æ•°ï¼Œ$\mathcal{H} \in \mathbb{R}^{C \times I \times J}$ã€‚æ˜¾ç„¶è¿™ç§èåˆæ–¹æ³•å—é™äºä¸¤ç§è¡¨ç¤ºå¿…é¡»æœ‰ç›¸åŒçš„ç»´åº¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;CONCAT Fusion:&lt;/strong&gt; ä¸ºäº†ä»ä¸Šè¿°çš„é™åˆ¶ä¸­è§£è„±ï¼Œæˆ‘ä»¬æå‡ºäº†å¦ä¸€ç§èåˆæ–¹æ³•ã€‚é¡ºç€é€šé“æ‹¼æ¥ä¸¤ä¸ªéšè—è¡¨ç¤ºï¼š&lt;/p&gt;
$$\tag{7}
\mathcal{H}(c, :, :) = \mathcal{X}\_{fcn}(c, :, :), c=0, \dots, C\_x - 1
$$$$\tag{8}
\mathcal{H}(C\_x + c, :, :) = \mathcal{M}\_{fcn}(c, :, :), c=0, \dots, C\_m - 1
$$&lt;p&gt;$C_x$ å’Œ $C_m$ åˆ†åˆ«æ˜¯ä¸¤ä¸ªéšè—è¡¨ç¤ºçš„é€šé“æ•°ã€‚$\mathcal{H} \in \mathbb{R}^{(C_x + C_m) \times I \times J}$ã€‚æ‹¼æ¥èåˆå®é™…ä¸Šå¯ä»¥é€šè¿‡äº’ç›¸å¼ºåŒ–æ›´å¥½åœ°èåˆé¡¶ç‚¹æµé‡å’Œè¾¹æµé‡ã€‚åƒ BRIDGE ä¸€æ ·æˆ‘ä»¬ä¹Ÿè®¨è®ºäº†å…¶ä»–çš„èåˆæ–¹å¼ï¼ˆ4.3 èŠ‚ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ‹¼æ¥èåˆä¸­ï¼Œæˆ‘ä»¬åœ¨ NODENET å’Œ EDGENET ä¸­åˆ†åˆ«åŠ äº†ä¸€å±‚å·ç§¯ã€‚å·ç§¯ç”¨æ¥å°†åˆå¹¶çš„éšè—ç‰¹å¾ $\mathcal{H}$ æ˜ å°„åˆ° ä¸åŒé€šé“å¤§å°çš„è¾“å‡ºä¸Šï¼Œå³ $\mathcal{X}_{res} \in \mathbb{R}^{2 \times I \times J}$ å’Œ $\mathcal{M}_{res} \in \mathbb{R}^{2N \times I \times J}$ï¼Œå¦‚å›¾ 6ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Fig6.JPG"
loading="lazy"
alt="Figure6"
&gt;&lt;/p&gt;
&lt;h2 id="33-fusing-external-factors-using-a-gating-mechanism"&gt;3.3 Fusing External Factors Using a Gating Mechanism
&lt;/h2&gt;&lt;p&gt;å¤–éƒ¨å› ç´ ï¼Œæ´»åŠ¨ã€å¤©æ°”ä¼šå½±å“æ—¶ç©ºç½‘ç»œä¸åŒåŒºåŸŸçš„æµé‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€èµ·äº‹æ•…å¯èƒ½ä¼šé˜»å¡ä¸€ä¸ªå±€éƒ¨åŒºåŸŸçš„äº¤é€šï¼Œä¸€åœºæš´é£é›¨å¯èƒ½ä¼šå‡å°‘æ•´ä¸ªåŸå¸‚çš„æµé‡ã€‚è¿™æ ·çš„å¤–éƒ¨å› ç´ å°±åƒä¸€ä¸ªå¼€å…³ï¼Œå¦‚æœå®ƒæ‰“å¼€äº†é‚£æµé‡ä¼šäº§ç”Ÿå·¨å¤§çš„å˜åŒ–ã€‚åŸºäºè¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ç§åŸºäºé—¨æ§æœºåˆ¶çš„èåˆï¼Œå¦‚å›¾ 6 æ‰€ç¤ºã€‚æ—¶é—´ $t$ çš„å¤–éƒ¨å› ç´ è¡¨ç¤ºä¸º $\mathcal{E}_t \in \mathbb{R}^{l_e \times I \times J}$ï¼Œ$\mathcal{E}_t(:, i, j) \in \mathbb{R}^{l_e}$ è¡¨ç¤ºä¸€ä¸ªç‰¹å®šé¡¶ç‚¹çš„å¤–éƒ¨ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹å¼è·å¾— EDGENET çš„é—¨æ§å€¼ï¼š&lt;/p&gt;
$$\tag{9}
\mathbf{F}\_m(i, j) = \sigma(\mathbf{W}\_e(:, i, j) \cdot \mathcal{E}\_t(:, i, j) + \mathbf{b}\_e(i, j)), 1 \leq i \leq I, 1 \leq j \leq J
$$&lt;p&gt;å…¶ä¸­ $\mathbf{W}_e \in \mathbb{R}^{l_e \times I \times J}$ å’Œ $\mathbf{b}_e \in \mathbb{R}^{I \times J}$ æ˜¯å‚æ•°ã€‚$\mathbf{F}_m \in \mathbb{R}^{I \times J}$ æ˜¯ GATING çš„è¾“å‡ºï¼Œ$\mathbf{F}_m(i, j)$ æ˜¯å¯¹åº”æ—¶ç©ºç½‘ç»œä¸­ç»“ç‚¹ $r_{ij}$ çš„é—¨æ§å€¼ã€‚$\sigma(\cdot)$ æ˜¯ sigmoid æ¿€æ´»å‡½æ•°ï¼Œ$\cdot$ æ˜¯ä¸¤å‘é‡çš„å†…ç§¯ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬ä½¿ç”¨ PRODUCT èåˆæ–¹å¼ï¼š&lt;/p&gt;
$$\tag{10}
\hat{\mathcal{M}}\_t(c, :, :) = \text{tanh}(\mathbf{F}\_m \odot \mathcal{M}\_{Res}(c, :, :)), c = 0, \dots, 2N - 1
$$&lt;p&gt;ç±»ä¼¼çš„ï¼ŒNODENET æœ€ååœ¨æ—¶é—´ $t$ çš„é¢„æµ‹ç»“æœä¸ºï¼š&lt;/p&gt;
$$\tag{11}
\hat{\mathcal{X}}\_t(c, :, :) = \text{tanh} (\mathbf{F}\_x \odot \mathcal{X}\_{Res}(c, :, :)), c = 0, 1
$$&lt;p&gt;å…¶ä¸­ $\mathbf{F}_x \in \mathbb{R}^{I \times J}$ æ˜¯ GATING çš„å¦ä¸€ä¸ªè¾“å‡ºã€‚å¯¹äºé¡¶ç‚¹æµé‡å’Œè¾¹æµé‡ä½¿ç”¨ä¸åŒçš„é—¨æ§å€¼çš„ä¸€ä¸ªåŸå› æ˜¯å¤–éƒ¨å› ç´ å¯¹æµå…¥/æµå‡ºæµé‡å’Œä¸åŒåœ°ç‚¹ä¹‹é—´çš„è½¬ç§»æµé‡çš„å½±å“æ˜¯ä¸ä¸€è‡´çš„ã€‚&lt;/p&gt;
&lt;h2 id="34-losses"&gt;3.4 Losses
&lt;/h2&gt;&lt;p&gt;ä»¤ $\phi$ ä¸º EDGENET ä¸­æ‰€æœ‰çš„å‚æ•°ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯é€šè¿‡æœ€å°åŒ–ç›®æ ‡å‡½æ•°å­¦ä¹ è¿™äº›å‚æ•°ï¼š&lt;/p&gt;
$$\tag{12}
\mathop{\mathrm{argmin}}\limits\_{\phi} \mathcal{J}\_{edge} = \sum\_{t \in \mathcal{T}}\sum^{2N-1}\_{c=0} \Vert Q^c\_t \odot (\hat{\mathcal{M}}\_t(c, :, :) - \mathcal{M}\_t(c, :, :)) \Vert^2\_F
$$&lt;p&gt;å…¶ä¸­ $Q^c_t$ æ˜¯æŒ‡ç¤ºçŸ©é˜µï¼Œè¡¨ç¤º $\mathcal{M}_t(c, :, :)$ ä¸­æ‰€æœ‰éé›¶å…ƒç´ ã€‚$\mathcal{T}$ æ˜¯å¯ç”¨çš„æ—¶æ®µï¼Œ$\Vert \cdot \Vert_F$ æ˜¯çŸ©é˜µçš„ F èŒƒæ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç±»ä¼¼çš„ï¼Œ$\theta$ æ˜¯ NODENET çš„å‚æ•°ï¼Œç›®æ ‡å‡½æ•°æ˜¯ï¼š&lt;/p&gt;
$$\tag{13}
\mathop{\mathrm{argmin}}\limits\_{\theta} \mathcal{J}\_{node} = \sum\_{t \in \mathcal{T}}\sum^1\_{c=0} \Vert P^c\_t \odot (\hat{\mathcal{X}}\_t(c, :, :) - \mathcal{X}\_t(c, :, :)) \Vert^2\_F
$$&lt;p&gt;å…¶ä¸­ $P^c_t$ æ˜¯æŒ‡ç¤ºçŸ©é˜µï¼Œè¡¨ç¤º $\mathcal{X}_t(c, :, :)$ ä¸­æ‰€æœ‰éé›¶å…ƒç´ ã€‚æˆ‘ä»¬çŸ¥é“å¯¹äºä¸€ä¸ªç»“ç‚¹æ¥è¯´ï¼Œå®ƒçš„è½¬å…¥æµé‡ä¹‹å’Œå°±æ˜¯å®ƒçš„æµå…¥æµé‡ï¼Œè½¬å‡ºæµé‡ä¹‹å’Œå°±æ˜¯æµå‡ºæµé‡ã€‚å®šä¹‰ 2 ä¸­å®šä¹‰ï¼Œ$\hat{\mathcal{X}}_t(0, :, :)$ å’Œ $\hat{\mathcal{X}}_t(1, :, :)$ åˆ†åˆ«æ˜¯æµå‡ºå’Œæµå…¥çŸ©é˜µã€‚æ ¹æ® 2.1 èŠ‚å®šä¹‰çš„æ–¹æ³•æ„å»ºè½¬ç§»çŸ©é˜µï¼Œå¯çŸ¥å‰ $N$ ä¸ªé€šé“è¡¨ç¤ºè½¬å‡ºæµé‡ï¼Œå $N$ ä¸ªé€šé“è¡¨ç¤ºè½¬å…¥æµé‡ã€‚å› æ­¤ï¼Œæœ‰ä¸‹é¢çš„æŸå¤±å‡½æ•°ï¼š&lt;/p&gt;
$$\tag{14}
\mathop{\mathrm{argmin}}\limits\_{\theta, \phi} \sum\_{t \in \mathcal{T}} \sum\_i \sum\_j (\Vert \hat{\mathcal{X}}\_t(0, i, j) - \sum^{N-1}\_{c=0} \hat{\mathcal{M}}\_t(c,i,j) \Vert^2 + \Vert \hat{\mathcal{M}}\_t(1,i,j) - \sum^{2N-1}\_{c=N} \hat{\mathcal{M}}\_t(c,i,j) \Vert^2)
$$&lt;p&gt;æˆ–è€…ç­‰ä»·çš„å¯ä»¥å†™æˆ&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/EQ1.JPG"
loading="lazy"
alt="EQ15"
&gt;&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬è·å¾—èåˆçš„æŸå¤±ï¼š&lt;/p&gt;
$$\tag{16}
\mathop{\mathrm{argmin}}\limits\_{\theta, \phi} \lambda\_{node} \mathcal{J}\_{node} + \lambda\_{edge} \mathcal{J}\_{edge} + \lambda\_{mdl} \mathcal{J}\_{mdl}
$$&lt;p&gt;å…¶ä¸­ï¼Œ$\lambda_{node}$, $\lambda_{edge}$, $\lambda_{mdl}$ æ˜¯å¯è°ƒèŠ‚çš„å‚æ•°ã€‚&lt;/p&gt;
&lt;h3 id="341-optimization-algorithm"&gt;3.4.1 Optimization Algorithm
&lt;/h3&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Alg1.JPG"
loading="lazy"
alt="Alg1"
&gt;&lt;/p&gt;
&lt;p&gt;ç®—æ³• 1 æ˜¯ MDL çš„è®­ç»ƒè¿‡ç¨‹ã€‚1-4 è¡Œæ˜¯æ„å»ºè®­ç»ƒæ ·ä¾‹ã€‚7-8 è¡Œæ˜¯ç”¨æ‰¹é‡æ ·æœ¬ä¼˜åŒ–ç›®æ ‡å‡½æ•°ã€‚&lt;/p&gt;
&lt;h1 id="4-experiments"&gt;4 Experiments
&lt;/h1&gt;&lt;p&gt;ä¸¤ä¸ªæ•°æ®é›† &lt;strong&gt;TaxiBJ&lt;/strong&gt; å’Œ &lt;strong&gt;TaxiNYC&lt;/strong&gt;ï¼Œçœ‹è¡¨ 2ã€‚æˆ‘ä»¬ä½¿ç”¨ RMSE å’Œ MAE ä½œä¸ºè¯„ä»·æŒ‡æ ‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Table2.JPG"
loading="lazy"
alt="Table2"
&gt;&lt;/p&gt;
&lt;h2 id="41-settings"&gt;4.1 Settings
&lt;/h2&gt;&lt;h3 id="411-datasets"&gt;4.1.1 Datasets
&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨è¡¨ 3 ä¸­çš„ä¸¤ä¸ªæ•°æ®é›†ã€‚æ¯ä¸ªæ•°æ®é›†åŒ…å«ä¸¤ä¸ªå­é›†ï¼Œè½¨è¿¹/å‡ºè¡Œå’Œå¤–éƒ¨å› ç´ ï¼Œç»†èŠ‚å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;TaxiBJ&lt;/strong&gt;: åŒ—äº¬å‡ºç§Ÿè½¦ GPS è½¨è¿¹æ•°æ®æœ‰å››ä¸ªæ—¶æ®µï¼š20130101-20131030, 20140301-20140630, 20150501-20150630, 201501101-20160410ã€‚æˆ‘ä»¬ç”¨æœ€å 4 ä¸ªæ˜ŸæœŸä½œä¸ºæµ‹è¯•é›†ï¼Œä¹‹å‰çš„æ•°æ®ä½œä¸ºè®­ç»ƒé›†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TaxiNYC&lt;/strong&gt;: NYC 2011 åˆ° 2014 å¹´çš„å‡ºç§Ÿè½¦è®¢å•æ•°æ®ã€‚è®¢å•æ•°æ®åŒ…å«ä¸Šè½¦å’Œä¸‹è½¦çš„æ—¶é—´ã€‚ä¸Šè½¦å’Œä¸‹è½¦åœ°ç‚¹ã€‚æœ€åå››ä¸ªæ˜ŸæœŸä½œä¸ºæµ‹è¯•é›†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Table3.JPG"
loading="lazy"
alt="Table3"
&gt;&lt;/p&gt;
&lt;h3 id="412-baselines"&gt;4.1.2 Baselines
&lt;/h3&gt;&lt;p&gt;HA, ARIMA, SARIMA, VAR, RNN, LSTM. GRU, ST-ANN, ConvLSTM, ST-ResNet, MRF.&lt;/p&gt;
&lt;h3 id="413-preprocessing"&gt;4.1.3 Preprocessing
&lt;/h3&gt;&lt;p&gt;MDL çš„è¾“å‡ºï¼Œæˆ‘ä»¬ç”¨ $\text{tanh}$ ä½œä¸ºæœ€åçš„æ¿€æ´»å‡½æ•°ã€‚æˆ‘ä»¬ç”¨æœ€å¤§æœ€å°å½’ä¸€åŒ–ã€‚è¯„ä¼°çš„æ—¶å€™ï¼Œå°†é¢„æµ‹å€¼è½¬æ¢ä¸ºåŸæ¥çš„å€¼ã€‚å¯¹äºå¤–éƒ¨å› ç´ ï¼Œä½¿ç”¨ one-hotï¼Œå‡æœŸå’Œå¤©æ°”æ”¾å…¥äºŒå€¼å‘é‡ä¸­ï¼Œç”¨æœ€å¤§æœ€å°å½’ä¸€åŒ–æŠŠæ¸©åº¦å’Œé£é€Ÿå½’ä¸€åŒ–ã€‚&lt;/p&gt;
&lt;h3 id="414-hyperparameters"&gt;4.1.4 Hyperparameters
&lt;/h3&gt;&lt;p&gt;$\lambda_{node} = 1$ å’Œ $\lambda_{edge} = 1$ï¼Œ$\lambda_{mdl} = 0.0005$ï¼Œ$p$ å’Œ $q$ æŒ‰ç»éªŒè®¾å®šä¸ºä¸€å¤©å’Œä¸€å‘¨ã€‚ä¸‰ä¸ªä¾èµ–åºåˆ—çš„é•¿åº¦åˆ†åˆ«ä¸º $l_c \in \lbrace 1, 2, 3\rbrace$, $l_p \in \lbrace 1,2,3 \rbrace$, $l_q \in \lbrace 1,2,3 \rbrace$ã€‚å·ç§¯çš„æ•°é‡æ˜¯ 5 ä¸ªã€‚è®­ç»ƒé›†çš„ 90% ç”¨æ¥è®­ç»ƒï¼Œ10% æ¥éªŒè¯ï¼Œç”¨æ—©åœé€‰æœ€å¥½çš„å‚æ•°ã€‚ç„¶åä½¿ç”¨æ‰€æœ‰çš„æ•°æ®è®­ç»ƒæ¨¡å‹ã€‚ç½‘ç»œå‚æ•°é€šè¿‡éšæœºåˆå§‹åŒ–ï¼ŒAdam ä¼˜åŒ–ã€‚batch size 32ã€‚å­¦ä¹ ç‡ $\lbrace 0.01, 0.005, 0.001, 0.0005, 0.0001, 0.00005 \rbrace$ã€‚&lt;/p&gt;
&lt;h3 id="415-evaluation-metrics"&gt;4.1.5 Evaluation Metrics
&lt;/h3&gt;&lt;p&gt;RMSE å’Œ MAEã€‚&lt;/p&gt;
&lt;h2 id="42-results"&gt;4.2 Results
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Table4.JPG"
loading="lazy"
alt="Table4"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Node Flow Prediction.&lt;/strong&gt; æˆ‘ä»¬å…ˆæ¯”æµå…¥å’Œæµå‡ºæµé‡çš„é¢„æµ‹ã€‚è¡¨ 4 å±•ç¤ºäº†ä¸¤ä¸ªæ•°æ®é›†ä¸Šçš„è¯„ä»·æŒ‡æ ‡ç»“æœã€‚MDL å’Œ MRF æ¯”å…¶ä»–æ‰€æœ‰çš„æ–¹æ³•å¤šè¦å¥½ã€‚æˆ‘ä»¬çš„ MDL åœ¨ NYC çš„æ•°æ®é›†ä¸Šæ˜æ˜¾æ¯” MRF å¥½ã€‚BJ çš„æ•°æ®é›†ä¸Šï¼ŒMDL æ¯” MRF å·®ä¸å¤šã€‚åŸå› æ˜¯ NYC æ•°æ®é›†æ¯” BJ æ•°æ®é›†å¤§äº†ä¸‰å€ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨å¤§çš„æ•°æ®é›†ä¸Šï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ¯” MRF æ›´å¥½ã€‚æˆ‘ä»¬ä¹Ÿæ³¨æ„åˆ°è®­ç»ƒ MRF å¾ˆå¥½ä½¿ï¼Œåœ¨ BJ æ•°æ®é›†ä¸Šè®­ç»ƒäº†ä¸€ä¸ªæ˜ŸæœŸã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Table5.JPG"
loading="lazy"
alt="Table5"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Results of Edge Flow Prediction.&lt;/strong&gt; è¡¨6 å±•ç¤ºäº†è¾¹æµé‡é¢„æµ‹ã€‚è¾¹æµé‡é¢„æµ‹çš„å®éªŒå¾ˆè´¹æ—¶ã€‚MDL æ¯”å…¶ä»–çš„éƒ½å¥½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Table6.JPG"
loading="lazy"
alt="Table6"
&gt;&lt;/p&gt;
&lt;h2 id="43-evaluation-on-fusing-mechanisms"&gt;4.3 Evaluation on Fusing Mechanisms
&lt;/h2&gt;&lt;p&gt;èåˆ NODENET å’Œ EDGENET æœ‰ CONCAT å’Œ SUM ä¸¤ç§æ–¹æ³•ã€‚èåˆå¤–éƒ¨å› ç´ æœ‰ GATED å’Œ SIMPLE èåˆï¼Œæˆ–è€…ä¸ä½¿ç”¨ã€‚å› æ­¤æ€»å…±æœ‰ 6 ç§æ–¹æ³•ã€‚å¦‚è¡¨ 7ã€‚ä½¿ç”¨åŒæ ·çš„è¶…å‚æ•°è®¾å®šã€‚æˆ‘ä»¬å‘ç° CONCAT + GATING æ¯”å…¶ä»–çš„æ–¹æ³•å¥½ã€‚&lt;/p&gt;
&lt;h2 id="44-evaluation-on-model-hyper-parameters"&gt;4.4 Evaluation on Model Hyper-parameters
&lt;/h2&gt;&lt;h3 id="441-effect-of-training-data-size"&gt;4.4.1 Effect of Training Data Size
&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬é€‰äº† NYC 3 ä¸ªæœˆï¼Œ6 ä¸ªæœˆï¼Œ1 å¹´ï¼Œ3 å¹´æ•°æ®ã€‚$l_c = 3$, $l_p = 1$, $l_q = 1$ã€‚å›¾ 8 æ˜¯ç»“æœã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°æ•°æ®è¶Šå¤šï¼Œæ•ˆæœè¶Šå¥½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Fig8.JPG"
loading="lazy"
alt="Figure8"
&gt;&lt;/p&gt;
&lt;h3 id="442-effect-of-network-depth"&gt;4.4.2 Effect of Network Depth
&lt;/h3&gt;&lt;p&gt;å›¾ 9 å±•ç¤ºäº†ç½‘ç»œæ·±åº¦åœ¨ NYC 3 ä¸ªæœˆæ•°æ®é›†ä¸Šçš„å½±å“ã€‚ç½‘ç»œè¶Šæ·±ï¼ŒRMSE ä¼šä¸‹é™ï¼Œå› ä¸ºç½‘ç»œè¶Šæ·±è¶Šèƒ½æ•è·æ›´å¤§èŒƒå›´çš„ç©ºé—´ä¾èµ–ã€‚ç„¶è€Œï¼Œç½‘ç»œæ›´æ·± RMSE å°±ä¼šä¸Šå‡ï¼Œè¿™æ˜¯å› ä¸ºç½‘ç»œåŠ æ·±åè®­ç»ƒä¼šå˜å¾—å›°éš¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Fig9.JPG"
loading="lazy"
alt="Figure9"
&gt;&lt;/p&gt;
&lt;h3 id="443-effect-of-multi-task-component"&gt;4.4.3 Effect of multi-task component
&lt;/h3&gt;&lt;p&gt;è¡¨ 8 å’Œå›¾ 10 å±•ç¤ºäº†å¤šä»»åŠ¡ç»„ä»¶çš„å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è½¬ç§»æµé‡é¢„æµ‹ä»»åŠ¡å¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥æå‡ï¼Œ$\lambda_{node} = \lambda_{edge} = 1$ï¼Œ$\lambda_{mdl}=0.1$ï¼Œæˆ‘ä»¬çš„æ¨¡å‹è·å¾—æœ€å¥½çš„æ•ˆæœï¼Œä¸¤ç§ä»»åŠ¡éƒ½è·å¾—æ›´å¥½çš„ç»“æœï¼Œè¯æ˜äº†å¤šä»»åŠ¡å¯ä»¥äº’ç›¸æå‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Table8.JPG"
loading="lazy"
alt="Table8"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Fig10.JPG"
loading="lazy"
alt="Figure10"
&gt;&lt;/p&gt;
&lt;h2 id="45-flow-predictions"&gt;4.5 Flow Predictions
&lt;/h2&gt;&lt;p&gt;å›¾ 11 æç»˜äº†æˆ‘ä»¬çš„ MDL åœ¨ NYC ä¸Šé¢„æµ‹ä¸¤ä¸ªèŠ‚ç‚¹æœªæ¥ä¸€å°æ—¶çš„æ•°æ®ã€‚ç»“ç‚¹ (10, 1)ï¼Œæ€»æ˜¯æ¯” (8, 3) é«˜ã€‚æˆ‘ä»¬çš„æ¨¡å‹åœ¨é¢„æµ‹æ›²çº¿ä¸Šæ›´ç²¾ç¡®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/flow-prediction-in-spatio-temporal-networks-based-on-multitask-deep-learning/Fig11.JPG"
loading="lazy"
alt="Figure11"
&gt;&lt;/p&gt;</description></item><item><title>ubuntu /boot æ»¡äº†æ€ä¹ˆåŠ</title><link>https://davidham3.github.io/blog/p/ubuntu-/boot-%E6%BB%A1%E4%BA%86%E6%80%8E%E4%B9%88%E5%8A%9E/</link><pubDate>Fri, 19 Apr 2019 15:02:46 +0000</pubDate><guid>https://davidham3.github.io/blog/p/ubuntu-/boot-%E6%BB%A1%E4%BA%86%E6%80%8E%E4%B9%88%E5%8A%9E/</guid><description>&lt;p&gt;ubuntu /boot æ»¡äº†æ€ä¹ˆåŠï¼Œ&lt;a class="link" href="https://askubuntu.com/questions/171209/my-boot-partition-hit-100-and-now-i-cant-upgrade-cant-remove-old-kernels-to" target="_blank" rel="noopener"
&gt;è§£å†³æ–¹æ¡ˆ&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;uname -a
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;çœ‹ä¸€ä¸‹ç°åœ¨ç”¨çš„æ˜¯ä»€ä¹ˆå†…æ ¸&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;cd /boot
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æŠŠè€çš„å†…æ ¸æŒªèµ°ï¼ŒæŒªçš„æ—¶å€™æŒ‰ç‰ˆæœ¬å·æŒªï¼Œä»è€çš„å¼€å§‹æŒªï¼Œå…·æœ‰åŒä¸€ä¸ªç‰ˆæœ¬å·çš„æ–‡ä»¶åŒæ—¶æŒªèµ°ï¼ŒæŒªå‡ ä¸ªè€çš„å°±è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ç„¶å&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;apt-get install -f
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;dpkg --get-selections |grep linux-
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æŠŠè€çš„å†…æ ¸éƒ½å¸è½½æ‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;apt-get purge linux-headers-4.4.0-137-generic linux-image-4.4.0-137-generic linux-image-extra-4.4.0-137-generic
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶åæŠŠåˆšæ‰æŒªèµ°çš„æ–‡ä»¶å†æŒªå›å»ï¼Œå†ç”¨ä¸Šé¢çš„å‘½ä»¤å¸è½½æ‰ã€‚&lt;/p&gt;</description></item><item><title>pysparkè¯»å†™HBase</title><link>https://davidham3.github.io/blog/p/pyspark%E8%AF%BB%E5%86%99hbase/</link><pubDate>Wed, 10 Apr 2019 17:26:30 +0000</pubDate><guid>https://davidham3.github.io/blog/p/pyspark%E8%AF%BB%E5%86%99hbase/</guid><description>&lt;p&gt;åº”ç”²æ–¹éœ€æ±‚ï¼Œå†™ä¸€ä¸ª pyspark è¯»å†™ HBase çš„æ•™ç¨‹ã€‚ä¸»è¦åŒ…å«äº†åŸºæœ¬è¯»å†™æ–¹æ³•å’Œè‡ªå®šä¹‰ Converter çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h1 id="pyspark-è¯»å–-hbase"&gt;pyspark è¯»å– HBase
&lt;/h1&gt;&lt;p&gt;ä»¥ä¸‹å†…å®¹çš„ç¯å¢ƒï¼špython 3.5ï¼Œspark 1.6&lt;/p&gt;
&lt;p&gt;pyspark è¯»å– HBase éœ€è¦å€ŸåŠ© Java çš„ç±»å®Œæˆè¯»å†™ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆéœ€è¦æ˜ç¡®çš„æ˜¯ï¼ŒHBase ä¸­å­˜å‚¨çš„æ˜¯ &lt;code&gt;byte[]&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆæ ·çš„æ•°æ®ï¼Œéƒ½éœ€è¦å…ˆè½¬æ¢ä¸º &lt;code&gt;byte[]&lt;/code&gt; åï¼Œæ‰èƒ½å­˜å…¥ HBaseã€‚&lt;/p&gt;
&lt;h2 id="åŸºæœ¬æ–¹æ³•"&gt;åŸºæœ¬æ–¹æ³•
&lt;/h2&gt;&lt;p&gt;pyspark è¯»å– HBase éœ€è¦ä½¿ç”¨ &lt;code&gt;SparkContext&lt;/code&gt; çš„ &lt;a class="link" href="http://spark.apache.org/docs/1.6.0/api/python/pyspark.html#pyspark.SparkContext.newAPIHadoopRDD" target="_blank" rel="noopener"
&gt;newAPIHadoopRDD&lt;/a&gt; è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•éœ€è¦ä½¿ç”¨ Java çš„ç±»ï¼Œç”¨è¿™äº›ç±»è¯»å– HBase&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ç¤ºä¾‹ä»£ç é»˜è®¤ HBase ä¸­çš„è¡Œé”®ã€åˆ—æ—åã€åˆ—åå’Œå€¼éƒ½æ˜¯å­—ç¬¦ä¸²è½¬æˆçš„ &lt;code&gt;byte&lt;/code&gt; æ•°ç»„ï¼š&lt;/p&gt;
&lt;p&gt;read_hbase_pyspark.py&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;span class="lnt"&gt;44
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pyspark&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SparkContext&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pyspark&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SparkConf&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SparkConf&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;spark.executorEnv.PYTHONHASHSEED&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;0&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;spark.kryoserializer.buffer.max&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;2040mb&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SparkContext&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;appName&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;HBaseInputFormat&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# é…ç½®é¡¹è¦åŒ…å« zookeeper çš„ ip&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;zookeeper_host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zkServer&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# è¿˜è¦åŒ…å«è¦è¯»å–çš„ HBase è¡¨å&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;hbase_table_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;testTable&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;hbase.zookeeper.quorum&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;zookeeper_host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;hbase.mapreduce.inputtable&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;hbase_table_name&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# è¿™ä¸ªJavaç±»ç”¨æ¥å°† HBase çš„è¡Œé”®è½¬æ¢ä¸ºå­—ç¬¦ä¸²&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;keyConv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.spark.examples.pythonconverters.ImmutableBytesWritableToStringConverter&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# è¿™ä¸ªJavaç±»ç”¨æ¥å°† HBase æŸ¥è¯¢å¾—åˆ°çš„ç»“æœï¼Œè½¬æ¢ä¸ºå­—ç¬¦ä¸²&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;valueConv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.spark.examples.pythonconverters.HBaseResultToStringConverter&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ hadoop æ–‡ä»¶çš„è¾“å…¥ç±»å‹&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# ç¬¬äºŒä¸ªå‚æ•°æ˜¯ HBase rowkey çš„ç±»å‹&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ HBase å€¼çš„ç±»å‹&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# è¿™ä¸‰ä¸ªå‚æ•°ä¸ç”¨æ”¹å˜&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# è¯»å–åçš„ rddï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œ(key, value)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;hbase_rdd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;newAPIHadoopRDD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.hadoop.hbase.mapreduce.TableInputFormat&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.hadoop.hbase.io.ImmutableBytesWritable&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.hadoop.hbase.client.Result&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;keyConverter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;keyConv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;valueConverter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;valueConv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# è¯»å–åï¼Œå°†é”®å€¼å¯¹ (key, value) ä¸­çš„å€¼ valueï¼Œä½¿ç”¨\nåˆ‡åˆ†ï¼Œç”¨ flatMap å±•å¼€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# ç„¶åå°†é”®å€¼å¯¹ (key, value) ä¸­çš„å€¼ value ä½¿ç”¨ json.loads è§£æï¼Œå¾—åˆ° dict&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;hbase_rdd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hbase_rdd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flatMapValues&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mapValues&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loads&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hbase_rdd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;collect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸Šè¿°ä»£ç åœ¨æäº¤ç»™ spark é›†ç¾¤çš„æ—¶å€™ï¼Œè¦æŒ‡åç”¨åˆ°çš„ Java ç±»çš„ä½ç½®ï¼Œè¿™äº›ç±»éƒ½åœ¨ spark-examples è¿™ä¸ªåŒ…é‡Œé¢ï¼Œè¿™ä¸ªåŒ…åœ¨ spark ç›®å½•ä¸‹çš„ lib é‡Œé¢ã€‚ä»¥ CDH 5.7.2 ä¸ºä¾‹ï¼ŒCDH é›†ç¾¤ä¸­è¿™ä¸ªåŒ…çš„ä½ç½®åœ¨ &lt;code&gt;/opt/cloudera/parcels/CDH-5.7.2-1.cdh5.7.2.p0.18/lib/spark/lib/spark-examples-1.6.0-cdh5.7.2-hadoop2.6.0-cdh5.7.2.jar&lt;/code&gt;ï¼Œæ‰€ä»¥æäº¤å‘½ä»¤ä¸ºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;spark-submit --master yarn --jars /opt/cloudera/parcels/CDH-5.7.2-1.cdh5.7.2.p0.18/lib/spark/lib/spark-examples-1.6.0-cdh5.7.2-hadoop2.6.0-cdh5.7.2.jar read_hbase_pyspark.py
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ‰€ä»¥ï¼Œä¸Šè¿°çš„ Java ç±»ï¼Œæ ¸å¿ƒéƒ½æ˜¯è®¤ä¸º HBase ä¸­æ‰€æœ‰çš„å€¼ï¼ŒåŸæœ¬éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œç„¶åè½¬æ¢æˆ &lt;code&gt;byte&lt;/code&gt; æ•°ç»„åå­˜å…¥çš„ HBaseï¼Œå®ƒåœ¨è§£æçš„æ—¶å€™ï¼Œå°†è¯»å–åˆ°çš„ &lt;code&gt;byte[]&lt;/code&gt; è½¬æ¢ä¸ºå­—ç¬¦ä¸²åè¿”å›ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‹¿åˆ°çš„å€¼å°±æ˜¯å­—ç¬¦ä¸²ã€‚&lt;/p&gt;
&lt;h2 id="è¿›é˜¶æ–¹æ³•"&gt;è¿›é˜¶æ–¹æ³•
&lt;/h2&gt;&lt;p&gt;å¯¹äºå…¶ä»–ç±»å‹çš„æ•°æ®ï¼Œè½¬æ¢ä¸º &lt;code&gt;byte&lt;/code&gt; æ•°ç»„åå­˜å…¥ HBaseï¼Œå¦‚æœæˆ‘ä»¬è¿˜ä½¿ç”¨ä¸Šé¢çš„ Java ç±»å»è¯»å– HBaseï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‹¿åˆ°çš„å­—ç¬¦ä¸²çš„å€¼å°±æ˜¯ä¸æ­£ç¡®çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ç†è§£è¿™äº›å†…å®¹ï¼Œæˆ‘ä»¬é¦–å…ˆè¦è®¨è®º HBase ä¸­å€¼çš„å­˜å‚¨ç»“æ„ã€‚&lt;/p&gt;
&lt;p&gt;HBase æ˜¯éç»“æ„åŒ–æ•°æ®åº“ï¼Œä»¥è¡Œä¸ºå•ä½ï¼Œæ¯è¡Œæ‹¥æœ‰ä¸€ä¸ªè¡Œé”® rowkeyï¼Œå¯¹åº”çš„å€¼å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ª mapï¼ˆpython ä¸­çš„ dictï¼‰ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€æ¡è®°å½•ï¼Œè¡Œé”®è®°ä¸º &amp;ldquo;r1&amp;rdquo;ï¼Œé‡Œé¢æœ‰ 1 ä¸ªåˆ—æ—(columnFamily) &amp;ldquo;A&amp;rdquo;ï¼Œåˆ—æ—ä¸­æœ‰ä¸¤åˆ—(qualifier)ï¼Œåˆ†åˆ«è®°ä¸º &amp;ldquo;a&amp;rdquo; å’Œ &amp;ldquo;b&amp;rdquo;ï¼Œå¯¹åº”çš„å€¼åˆ†åˆ«ä¸º &amp;ldquo;v1&amp;rdquo; å’Œ &amp;ldquo;v2&amp;rdquo;ï¼Œé‚£ä¹ˆè¡¨ç¤ºæˆ json å­—ç¬¦ä¸²å°±æ˜¯ä¸‹é¢çš„å½¢å¼ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;r1&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;A&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;v1&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;b&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;v2&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸Šé¢è¿™ä¸ª json å­—ç¬¦ä¸²å°±æ˜¯ä¸Šé¢é‚£æ¡è®°å½•åœ¨ HBase ä¸­å­˜å‚¨çš„ç¤ºä¾‹ï¼Œç¬¬ä¸€å±‚çš„é”®è¡¨ç¤ºè¡Œé”®(rowkey)ï¼Œå¯¹åº”çš„å€¼è¡¨ç¤ºè¿™ä¸€è¡Œçš„å€¼ï¼›ç¬¬äºŒå±‚çš„é”®è¡¨ç¤ºåˆ—æ—å(columnFamily)ï¼Œå€¼è¡¨ç¤ºè¿™ä¸ªåˆ—æ—ä¸‹åˆ—çš„å€¼ï¼›ç¬¬ä¸‰å±‚çš„é”®è¡¨ç¤ºåˆ—å(qualifier)ï¼Œå¯¹åº”çš„å€¼(value)è¡¨ç¤ºè¿™ä¸ªç”±è¡Œé”®ã€åˆ—æ—åã€åˆ—åä¸‰é¡¹ç¡®å®šçš„ä¸€ä¸ªå•å…ƒæ ¼(Cell)å†…çš„å€¼ã€‚æ‰€ä»¥ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œåªæœ‰ä¸€è¡Œï¼Œä¸¤ä¸ªå•å…ƒæ ¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬é’ˆå¯¹ pyspark è¯»å– HBase ä½¿ç”¨åˆ°çš„ &lt;code&gt;org.apache.spark.examples.pythonconverters.HBaseResultToStringConverter&lt;/code&gt; æ¥è®¨è®ºã€‚&lt;/p&gt;
&lt;p&gt;Java çš„ API åœ¨è¯»å– HBase çš„æ—¶å€™ï¼Œä¼šå¾—åˆ°ä¸€ä¸ª &lt;code&gt;Result&lt;/code&gt; ç±»å‹ï¼Œè¿™ä¸ª &lt;code&gt;Result&lt;/code&gt; å°±æ˜¯æŸ¥è¯¢ç»“æœã€‚&lt;code&gt;Result&lt;/code&gt; å¯ä»¥éå†ï¼Œé‡Œé¢æ‹¥æœ‰å¤šä¸ª &lt;code&gt;Cell&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯å•å…ƒæ ¼ã€‚ä¸Šé¢æˆ‘ä»¬è¯´äº†ï¼Œæ¯ä¸ªå•å…ƒæ ¼è‡³å°‘æœ‰ 4 ä¸ªå†…å®¹ï¼šè¡Œé”®ã€åˆ—æ—åã€åˆ—åã€å€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;HBaseResultToStringConverter&lt;/code&gt; æ˜¯ç”± scala å®ç°çš„ä¸€ä¸ªç±»ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯å°† Java HBase API çš„ &lt;code&gt;Result&lt;/code&gt; è½¬æ¢ä¸º &lt;code&gt;String&lt;/code&gt;ï¼Œæºç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-scala" data-lang="scala"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;package&lt;/span&gt; &lt;span class="nn"&gt;org.apache.spark.examples.pythonconverters&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;scala.collection.JavaConverters._&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;scala.util.parsing.json.JSONObject&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.spark.api.python.Converter&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.client.&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nc"&gt;Put&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nc"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.util.Bytes&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.KeyValue.Type&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.CellUtil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HBaseResultToStringConverter&lt;/span&gt; &lt;span class="k"&gt;extends&lt;/span&gt; &lt;span class="nc"&gt;Converter&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;Any&lt;/span&gt;, &lt;span class="kt"&gt;String&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="n"&gt;convert&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;Any&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;String&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="k"&gt;=&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asInstanceOf&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="k"&gt;=&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listCells&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asScala&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt; &lt;span class="k"&gt;=&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nc"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;row&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneRow&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;columnFamily&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneFamily&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;qualifier&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneQualifier&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;timestamp&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getTimestamp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;type&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;codeToType&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getTypeByte&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;value&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneValue&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;JSONObject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;_&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;()).&lt;/span&gt;&lt;span class="n"&gt;mkString&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;\n&amp;#34;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å®ƒå®Œæˆçš„å·¥ä½œæ˜¯éå† &lt;code&gt;Result&lt;/code&gt; ä¸­çš„ &lt;code&gt;Cell&lt;/code&gt;ï¼Œæ¯ä¸ª &lt;code&gt;Cell&lt;/code&gt; è½¬æ¢æˆä¸€ä¸ª scala &lt;code&gt;Map&lt;/code&gt;ï¼Œé”®åˆ†åˆ«æ˜¯è¡Œé”®ã€åˆ—æ—åã€åˆ—åã€æ—¶é—´æˆ³ã€HBase æ“ä½œç±»å‹ã€å€¼ã€‚æœ€åæ¯ä¸ª scala &lt;code&gt;Map&lt;/code&gt; è¢«è½¬æ¢æˆ json å­—ç¬¦ä¸²ï¼Œä¹‹é—´ç”¨ &amp;lsquo;\n&amp;rsquo; åˆ†éš”ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„ &lt;code&gt;CellUtil.CloneRow&lt;/code&gt;ï¼Œ&lt;code&gt;CellUtil.cloneFamily&lt;/code&gt;ï¼Œ&lt;code&gt;CellUtil.cloneQualifier&lt;/code&gt;ï¼Œ&lt;code&gt;CellUtil.cloneValue&lt;/code&gt; æ˜¯æˆ‘ä»¬ä¸»è¦ä½¿ç”¨çš„å››ä¸ªæ–¹æ³•ï¼Œè¿™å››ä¸ªæ–¹æ³•ç”Ÿæˆçš„éƒ½æ˜¯ &lt;code&gt;byte[]&lt;/code&gt;ï¼Œç„¶åè¿™å››ä¸ª &lt;code&gt;byte[]&lt;/code&gt; éƒ½è¢« &lt;code&gt;Bytes.toStringBinary&lt;/code&gt; è½¬æ¢æˆäº† &lt;code&gt;String&lt;/code&gt; ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬å­˜å…¥ HBase çš„æ•°æ®æ˜¯ &lt;code&gt;String&lt;/code&gt; ä»¥å¤–ç±»å‹çš„ï¼Œå¦‚ &lt;code&gt;Float&lt;/code&gt;, &lt;code&gt;Double&lt;/code&gt;, &lt;code&gt;BigDecimal&lt;/code&gt;ï¼Œé‚£ä¹ˆè¿™é‡Œä½¿ç”¨ &lt;code&gt;CellUtil&lt;/code&gt; çš„æ–¹æ³•æ‹¿åˆ° &lt;code&gt;byte[]&lt;/code&gt; åï¼Œéœ€è¦ä½¿ç”¨ &lt;code&gt;Bytes&lt;/code&gt; é‡Œé¢çš„å¯¹åº”æ–¹æ³•è½¬æ¢ä¸ºåŸæ¥çš„ç±»å‹ï¼Œå†è½¬æˆå­—ç¬¦ä¸²æˆ–å…¶ä»–ç±»å‹ï¼Œç”Ÿæˆ json å­—ç¬¦ä¸²ï¼Œç„¶åè¿”å›ï¼Œè¿™æ ·æˆ‘ä»¬é€šè¿‡ pyspark æ‰èƒ½æ‹¿åˆ°æ­£ç¡®çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬çš„æ•°æ®éƒ½æ˜¯ &lt;code&gt;java.math.BigDecimal&lt;/code&gt; ç±»å‹çš„å€¼ï¼Œå­˜ HBase çš„æ—¶å€™å°†ä»–ä»¬è½¬æ¢ä¸º &lt;code&gt;byte[]&lt;/code&gt; åè¿›è¡Œäº†å­˜å‚¨ã€‚é‚£ä¹ˆè§£æçš„æ—¶å€™ï¼Œå°±éœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªå¤„ç† &lt;code&gt;BigDecimal&lt;/code&gt; çš„ç±»ï¼š&lt;code&gt;HBaseResultToBigDecimalToStringConverter&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-scala" data-lang="scala"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;package&lt;/span&gt; &lt;span class="nn"&gt;org.apache.spark.examples.pythonconverters&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;java.math.BigDecimal&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;scala.collection.JavaConverters._&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;scala.util.parsing.json.JSONObject&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.spark.api.python.Converter&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.client.&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nc"&gt;Put&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nc"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.io.ImmutableBytesWritable&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.util.Bytes&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.KeyValue.Type&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.CellUtil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HBaseResultToBigDecimalToStringConverter&lt;/span&gt; &lt;span class="k"&gt;extends&lt;/span&gt; &lt;span class="nc"&gt;Converter&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;Any&lt;/span&gt;, &lt;span class="kt"&gt;String&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="n"&gt;convert&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;Any&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;String&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="k"&gt;=&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asInstanceOf&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="k"&gt;=&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listCells&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asScala&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt; &lt;span class="k"&gt;=&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nc"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;row&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneRow&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;columnFamily&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneFamily&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;qualifier&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneQualifier&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;timestamp&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getTimestamp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;type&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;codeToType&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getTypeByte&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;value&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toBigDecimal&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneValue&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)).&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;JSONObject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;_&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;()).&lt;/span&gt;&lt;span class="n"&gt;mkString&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;\n&amp;#34;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸Šè¿°ä»£ç ä¸­ï¼Œå¼•å…¥äº† &lt;code&gt;java.math.BigDecimal&lt;/code&gt;ï¼Œå°† &lt;code&gt;value&lt;/code&gt; çš„è§£æè¿›è¡Œäº†ç®€å•çš„ä¿®æ”¹ï¼Œé€šè¿‡ &lt;code&gt;CellUtil.cloneValue&lt;/code&gt; æ‹¿åˆ° &lt;code&gt;byte[]&lt;/code&gt; åï¼Œé€šè¿‡ &lt;code&gt;Bytes.toBigDecimal&lt;/code&gt; è½¬æ¢æˆ &lt;code&gt;java.math.BigDecimal&lt;/code&gt;ï¼Œç„¶åä½¿ç”¨ &lt;code&gt;toString&lt;/code&gt; æ–¹æ³•è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªç±»å†™å®Œåï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹å…¶è¿›è¡Œç¼–è¯‘ï¼Œå¯¼å‡ºæˆ jar åŒ…ï¼Œåœ¨ pyspark ç¨‹åºä¸­æŒ‡æ˜ï¼Œè¯»å–çš„æ—¶å€™ï¼Œä½¿ç”¨è¿™ä¸ªç±»è§£æ valueã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·æºä»£ç å°±æ”¹å®Œäº†ï¼Œéœ€è¦ç¼–è¯‘æˆ jar åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå®‰è£… &lt;a class="link" href="http://maven.apache.org/" target="_blank" rel="noopener"
&gt;maven&lt;/a&gt; 3.6.0ï¼Œä¸‹è½½åï¼Œè§£å‹ï¼Œé…ç½®ç¯å¢ƒå˜é‡å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹è½½ spark çš„æºç ï¼Œå» Apache Spark å®˜ç½‘ï¼Œä¸‹è½½ä»“åº“ä¸­çš„æºä»£ç  &lt;a class="link" href="https://archive.apache.org/dist/spark/spark-1.6.0/" target="_blank" rel="noopener"
&gt;spark-1.6.0.tgz&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹è½½åè§£å‹ï¼Œå°†æ ¹ç›®å½•ä¸­çš„ scalastyle-config.xml æ‹·è´åˆ° examples ç›®å½•ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ &lt;code&gt;examples/src/main/scala/org/apache/spark/examples/pythonconverters/HBaseConverters.scala&lt;/code&gt;ï¼Œå¢åŠ è‡ªå·±ç”¨çš„ç±»ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ &lt;code&gt;examples/pom.xml&lt;/code&gt;ï¼Œå°† &lt;code&gt;&amp;lt;artifactId&amp;gt;spark-examples_2.10&amp;lt;/artifactId&amp;gt;&lt;/code&gt; ä¿®æ”¹ä¸º &lt;code&gt;&amp;lt;artifactId&amp;gt;spark-examples_2.10_my_converters&amp;lt;/artifactId&amp;gt;&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;cd åˆ° examples ç›®å½•ä¸‹ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¯‘ spark-examples&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mvn clean install -pl :spark-examples_2.10_my_converters
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¼–è¯‘é€”ä¸­ä¿è¯å…¨ç¨‹è”ç½‘ï¼Œç¼–è¯‘çš„æ—¶å€™ä¼šæœ‰ä¸€äº›è­¦å‘Šï¼Œç¼–è¯‘å¥½çš„åŒ…åœ¨åŒçº§ç›®å½•ä¸‹çš„ target ä¸­ï¼Œæœ‰ä¸ªå« spark-examples_2.10_my_converters-1.6.0.jar çš„æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°±æ˜¯ä½¿ç”¨è¿™ä¸ªåŒ…è¯»å– HBase ä¸­çš„ BigDecimaläº†ï¼š&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ standalone æ¨¡å¼è¿è¡Œ pyspark äº¤äº’å¼ç•Œé¢ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;pyspark --master spark://host1:7077 --jars spark-examples_2.10_my_converters-1.6.0.jar
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ‰§è¡Œä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;zookeeper_host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;host1&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;hbase_table_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;testTable&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;conf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;hbase.zookeeper.quorum&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;zookeeper_host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;hbase.mapreduce.inputtable&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;hbase_table_name&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;keyConv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.spark.examples.pythonconverters.ImmutableBytesWritableToStringConverter&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# æ³¨æ„è¿™é‡Œï¼Œä½¿ç”¨è‡ªå·±å®šä¹‰çš„Converterè¯»å–&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;valueConv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.spark.examples.pythonconverters.HBaseResultToBigDecimalToStringConverter&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;hbase_rdd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;newAPIHadoopRDD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.hadoop.hbase.mapreduce.TableInputFormat&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.hadoop.hbase.io.ImmutableBytesWritable&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.hadoop.hbase.client.Result&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;keyConverter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;keyConv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;valueConverter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;valueConv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;hbase_rdd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hbase_rdd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flatMapValues&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mapValues&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loads&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;hbase_rdd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;take&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶åå°±å¯ä»¥çœ‹åˆ°ç»“æœäº†ï¼Œå¦‚ä½•éªŒè¯è¯»å–çš„å¯¹ä¸å¯¹å‘¢ï¼Œå¯ä»¥å°è¯•å°† &lt;code&gt;valueConv&lt;/code&gt; æ”¹å› &lt;code&gt;HBaseResultToStringConverter&lt;/code&gt;ï¼Œç„¶åè§‚å¯Ÿ value çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸Šå°±æ˜¯å¦‚ä½•é€šè¿‡ä¿®æ”¹ HBaseConverters.scala è®© pyspark ä» HBase ä¸­è¯»å– &lt;code&gt;java.math.BigDecimal&lt;/code&gt; çš„ç¤ºä¾‹ã€‚&lt;/p&gt;
&lt;h1 id="pyspark-å†™å…¥-hbase"&gt;pyspark å†™å…¥ HBase
&lt;/h1&gt;&lt;p&gt;pyspark å†™å…¥ HBase ä½¿ç”¨ &lt;code&gt;SparkContext&lt;/code&gt; çš„ &lt;a class="link" href="http://spark.apache.org/docs/1.6.0/api/python/pyspark.html#pyspark.RDD.saveAsNewAPIHadoopDataset" target="_blank" rel="noopener"
&gt;saveAsNewAPIHadoopDataset&lt;/a&gt;ï¼Œå’Œè¯»å–çš„æ–¹æ³•ç±»ä¼¼ï¼Œä¹Ÿéœ€è¦ä½¿ç”¨ Java çš„ç±»ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸‹é¢çš„æ–¹æ³•è¦æ±‚å­˜å…¥ HBase ä¸­çš„æ•°æ®ï¼Œè¡Œé”®ã€åˆ—æ—åã€åˆ—åã€å€¼éƒ½ä¸ºå­—ç¬¦ä¸²&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;write_into_hbase_pyspark.py&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pyspark&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SparkContext&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pyspark&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SparkConf&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SparkConf&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;spark.executorEnv.PYTHONHASHSEED&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;0&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;spark.kryoserializer.buffer.max&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;2040mb&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SparkContext&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;appName&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;HBaseOutputFormat&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# é…ç½®é¡¹è¦åŒ…å« zookeeper çš„ ip&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;zookeeper_host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zkServer&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# è¿˜è¦åŒ…å«è¦å†™å…¥çš„ HBase è¡¨å&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;hbase_table_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;testTable&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;hbase.zookeeper.quorum&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;zookeeper_host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;hbase.mapred.outputtable&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;hbase_table_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;mapreduce.outputformat.class&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.hadoop.hbase.mapreduce.TableOutputFormat&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;mapreduce.job.output.key.class&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.hadoop.hbase.io.ImmutableBytesWritable&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;mapreduce.job.output.value.class&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.hadoop.io.Writable&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;keyConv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.spark.examples.pythonconverters.StringToImmutableBytesWritableConverter&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;valueConv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.spark.examples.pythonconverters.StringListToPutConverter&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;records&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;row1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;f1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;q1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;value1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;row2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;f1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;q1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;value2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;row3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;f1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;q1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;value3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;row4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;f1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;q1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;value4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parallelize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;records&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;saveAsNewAPIHadoopDataset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;keyConverter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;keyConv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;valueConverter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;valueConv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;é¦–å…ˆåœ¨æ§åˆ¶å°å¯åŠ¨ HBase-shell&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;hbase shell
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶ååˆ›å»ºè¡¨ï¼Œè¡¨åä¸º testTableï¼Œåªæœ‰ä¸€ä¸ªåˆ—æ—ï¼Œåˆ—æ—åä¸º f1ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;create &lt;span class="s1"&gt;&amp;#39;testTable&amp;#39;&lt;/span&gt;, &lt;span class="s1"&gt;&amp;#39;f1&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä½¿ç”¨ &lt;code&gt;quit&lt;/code&gt; é€€å‡º HBase-shell&lt;/p&gt;
&lt;p&gt;æäº¤ pyspark ç¨‹åºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;spark-submit --master spark://master:7077 --jars /opt/cloudera/parcels/CDH-5.7.2-1.cdh5.7.2.p0.18/lib/spark/lib/spark-examples-1.6.0-cdh5.7.2-hadoop2.6.0-cdh5.7.2.jar write_into_hbase_pyspark.py
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿è¡Œå®Œæˆåï¼Œå†æ¬¡è¿›å…¥ HBase-shellï¼Œè¿è¡Œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;scan &lt;span class="s1"&gt;&amp;#39;testTable&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡ºç»“æœï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;hbase(main):001:0&amp;gt; scan &amp;#39;testTable&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;ROW COLUMN+CELL
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; row1 column=f1:q1, timestamp=1554892784494, value=value1
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; row2 column=f1:q1, timestamp=1554892784494, value=value2
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; row3 column=f1:q1, timestamp=1554892816961, value=value3
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; row4 column=f1:q1, timestamp=1554892816961, value=value4
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;4 row(s) in 0.3330 seconds
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™å°±å®Œæˆäº†å†™å…¥ HBase çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼šrdd ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œéƒ½å¿…é¡»æ˜¯ä¸€ä¸ªåˆ—è¡¨(&lt;code&gt;list&lt;/code&gt;)ï¼Œä¸èƒ½æ˜¯å…¶ä»–ç±»å‹ï¼Œå¦‚ &lt;code&gt;tuple&lt;/code&gt;ï¼Œè€Œä¸”æ¯ä¸ªåˆ—è¡¨å†…å¿…é¡»æ˜¯ 4 ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«è¡¨ç¤º &lt;code&gt;[è¡Œé”®ã€åˆ—æ—åã€åˆ—åã€å€¼]&lt;/code&gt;ï¼Œä¸”æ¯ä¸ªå…ƒç´ éƒ½ä¸º &lt;code&gt;str&lt;/code&gt; ç±»å‹ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åŸå› æ˜¯ &lt;code&gt;StringListToPutConverter&lt;/code&gt; è¿™ä¸ªç±»åšè½¬æ¢çš„æ—¶å€™éœ€è¦å°† rdd ä¸­çš„å…ƒç´ ï¼Œçœ‹ä½œæ˜¯ä¸€ä¸ª &lt;code&gt;java.util.ArrayList[String]&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-scala" data-lang="scala"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;StringListToPutConverter&lt;/span&gt; &lt;span class="k"&gt;extends&lt;/span&gt; &lt;span class="nc"&gt;Converter&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;Any&lt;/span&gt;, &lt;span class="kt"&gt;Put&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="n"&gt;convert&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;Any&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;Put&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="k"&gt;=&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asInstanceOf&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;java.util.ArrayList&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;String&lt;/span&gt;&lt;span class="o"&gt;]].&lt;/span&gt;&lt;span class="n"&gt;asScala&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toBytes&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="n"&gt;toArray&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;put&lt;/span&gt; &lt;span class="k"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nc"&gt;Put&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;put&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;),&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;),&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;StringListToPutConverter&lt;/code&gt; çš„å·¥ä½œåŸç†æ˜¯ï¼Œå°†ä¼ å…¥çš„å…ƒç´ å¼ºåˆ¶ç±»å‹è½¬æ¢ä¸º &lt;code&gt;java.util.ArrayList[String]&lt;/code&gt;ï¼Œå°†ç¬¬ä¸€ä¸ªå…ƒç´ ä½œä¸ºè¡Œé”®ã€ç¬¬äºŒä¸ªå…ƒç´ ä½œä¸ºåˆ—æ—åã€ç¬¬ä¸‰ä¸ªå…ƒç´ ä½œä¸ºåˆ—åã€ç¬¬å››ä¸ªå…ƒç´ ä½œä¸ºå€¼ï¼Œå››ä¸ªå€¼éƒ½è½¬æ¢ä¸º &lt;code&gt;byte[]&lt;/code&gt; åä¸Šä¼ è‡³ HBaseã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¿®æ”¹è¿™ä¸ªç±»ï¼Œå®ç°å­˜å…¥ç±»å‹çš„å¤šæ ·åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘æƒ³å­˜å…¥ä¸€ä¸ª &lt;code&gt;java.math.BigDecimal&lt;/code&gt;ï¼Œé‚£å®ç°çš„æ–¹æ³•å°±æ˜¯ï¼šåœ¨ pyspark ç¨‹åºä¸­ï¼Œå°†æ•°å­—è½¬æ¢æˆ &lt;code&gt;str&lt;/code&gt; ç±»å‹ï¼Œè°ƒç”¨æˆ‘ä»¬è‡ªå·±å†™çš„ä¸€ä¸ª converterï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-scala" data-lang="scala"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;java.math.BigDecimal&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;StringListToBigDecimalToPutConverter&lt;/span&gt; &lt;span class="k"&gt;extends&lt;/span&gt; &lt;span class="nc"&gt;Converter&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;Any&lt;/span&gt;, &lt;span class="kt"&gt;Put&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="n"&gt;convert&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;Any&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;Put&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="k"&gt;=&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asInstanceOf&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;java.util.ArrayList&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;String&lt;/span&gt;&lt;span class="o"&gt;]].&lt;/span&gt;&lt;span class="n"&gt;asScala&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toArray&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;put&lt;/span&gt; &lt;span class="k"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nc"&gt;Put&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toBytes&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;put&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toBytes&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toBytes&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toBytes&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nc"&gt;BigDecimal&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å°±å¯ä»¥å®ç°å­˜å…¥çš„å€¼æ˜¯ &lt;code&gt;java.math.BigDecimal&lt;/code&gt; äº†ã€‚&lt;/p&gt;
&lt;h1 id="cdh-59-ä»¥å‰çš„ç‰ˆæœ¬python3master-é€‰å®šä¸º-yarn-æ—¶çš„-bug"&gt;CDH 5.9 ä»¥å‰çš„ç‰ˆæœ¬ï¼Œpython3ï¼Œmaster é€‰å®šä¸º yarn æ—¶çš„ bug
&lt;/h1&gt;&lt;p&gt;CDH 5.9 ä»¥å‰çš„ç‰ˆæœ¬åœ¨ä½¿ç”¨ yarn ä½œä¸º spark master çš„æ—¶å€™ï¼Œå¦‚æœä½¿ç”¨ python3ï¼Œä¼šå‡ºç° yarn å…§éƒ¨ &lt;code&gt;topology.py&lt;/code&gt; è¿™ä¸ªæ–‡ä»¶å¼•å‘çš„ bugã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯ python2 çš„è¯­æ³•ï¼Œæˆ‘ä»¬ä½¿ç”¨ python3 è¿è¡Œä»»åŠ¡çš„æ—¶å€™ï¼Œpython3 çš„è§£é‡Šå™¨åœ¨å¤„ç†è¿™ä¸ªæ–‡ä»¶æ—¶ä¼šå‡ºé”™ã€‚&lt;/p&gt;
&lt;p&gt;è§£å†³æ–¹æ¡ˆæ˜¯ï¼šå°†è¿™ä¸ªæ–‡ä»¶é‡å†™ä¸º python3 çš„ç‰ˆæœ¬ï¼Œæ¯æ¬¡åœ¨é‡å¯ yarn ä¹‹åï¼Œå°†è¿™ä¸ªæ–‡ä»¶å¤åˆ¶åˆ°æ‰€æœ‰æœºå™¨çš„ &lt;code&gt;/etc/hadoop/conf.cloudera.yarn/&lt;/code&gt;ç›®å½•ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ python3 ç‰ˆæœ¬çš„ &lt;code&gt;topology.py&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;topology.py&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;span class="lnt"&gt;44
&lt;/span&gt;&lt;span class="lnt"&gt;45
&lt;/span&gt;&lt;span class="lnt"&gt;46
&lt;/span&gt;&lt;span class="lnt"&gt;47
&lt;/span&gt;&lt;span class="lnt"&gt;48
&lt;/span&gt;&lt;span class="lnt"&gt;49
&lt;/span&gt;&lt;span class="lnt"&gt;50
&lt;/span&gt;&lt;span class="lnt"&gt;51
&lt;/span&gt;&lt;span class="lnt"&gt;52
&lt;/span&gt;&lt;span class="lnt"&gt;53
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# Copyright (c) 2010-2012 Cloudera, Inc. All rights reserved.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt;This script is provided by CMF for hadoop to determine network/rack topology.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt;It is automatically generated and could be replaced at any time. Any changes
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt;made to it will be lost when this happens.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;xml.dom.minidom&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;MAP_FILE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;{{CMF_CONF_DIR}}/topology.map&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;DEFAULT_RACK&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/default&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;CMF_CONF_DIR&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;MAP_FILE&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# variable was not substituted. Use this file&amp;#39;s dir&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;MAP_FILE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dirname&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__file__&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;topology.map&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# We try to keep the default rack to have the same&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# number of elements as the other hosts available.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# There are bugs in some versions of Hadoop which&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# make the system error out.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;max_elements&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;map&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;mapFile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MAP_FILE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dom&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xml&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;minidom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mapFile&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;dom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getElementsByTagName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;node&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;rack&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getAttribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;rack&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;max_elements&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_elements&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rack&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;/&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getAttribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getAttribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;rack&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;default_rack&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="n"&gt;DEFAULT_RACK&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_elements&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;default_rack&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;default_rack&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="n"&gt;DEFAULT_RACK&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_elements&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;default_rack&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34; &amp;#34;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default_rack&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>MXNet: Optimizing Memory Consumption in Deep Learning</title><link>https://davidham3.github.io/blog/p/mxnet-optimizing-memory-consumption-in-deep-learning/</link><pubDate>Sun, 07 Apr 2019 13:02:17 +0000</pubDate><guid>https://davidham3.github.io/blog/p/mxnet-optimizing-memory-consumption-in-deep-learning/</guid><description>&lt;p&gt;&lt;a class="link" href="https://mxnet.incubator.apache.org/versions/master/architecture/note_memory.html" target="_blank" rel="noopener"
&gt;MXNet: Optimizing Memory Consumption in Deep Learning&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿‡å»çš„åå¹´ï¼Œæ·±åº¦å­¦ä¹ æ¨¡å‹è¶‹å‘äºæ›´æ·±æ›´å¤§çš„ç½‘ç»œã€‚å°½ç®¡ç¡¬ä»¶æ€§èƒ½çš„å¿«é€Ÿå‘å±•ï¼Œå‰æ²¿çš„æ·±åº¦å­¦ä¹ æ¨¡å‹è¿˜æ˜¯ç»§ç»­å°† GPU æ˜¾å­˜çš„é™åˆ¶æ¨å‘æé™ã€‚æ‰€ä»¥å³ä¾¿åœ¨ä»Šå¤©ï¼Œäººä»¬ä»åœ¨å¯»æ‰¾åŠæ³•æ¶ˆè€—æ›´å°‘çš„å†…å­˜ï¼Œè®­ç»ƒæ›´å¤§çš„æ¨¡å‹ã€‚è¿™æ ·å¯ä»¥è®©æˆ‘ä»¬è®­ç»ƒçš„æ›´å¿«ã€ä½¿ç”¨æ›´å¤§çš„æ‰¹é‡ã€è·å¾—æ›´é«˜çš„ GPU åˆ©ç”¨ç‡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç¯‡æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºé›†ä¸­ä¼˜åŒ–å†…å­˜åˆ†é…çš„æŠ€æœ¯ã€‚å°½ç®¡æˆ‘ä»¬çš„è®¨è®ºä¸å½»åº•ï¼Œä½†è¿™äº›æ–¹æ¡ˆå…·æœ‰æŒ‡å¯¼æ„ä¹‰ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿä»‹ç»ä¸»è¦çš„è®¾è®¡é—®é¢˜ã€‚&lt;/p&gt;
&lt;h1 id="computation-graph"&gt;Computation Graph
&lt;/h1&gt;&lt;p&gt;è®¡ç®—å›¾æè¿°äº†æ“ä½œé—´çš„ä¾èµ–ã€‚å›¾ä¸­çš„æ“ä½œè¦ä¹ˆæ˜¯ç»†ç²’åº¦çš„ï¼Œè¦ä¹ˆæ˜¯ç²—ç²’åº¦çš„ã€‚ä¸‹å›¾å±•ç¤ºäº†ä¸¤ä¸ªè®¡ç®—å›¾çš„ä¾‹å­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/mxnet-optimizing-memory-consumption-in-deep-learning/Fig1.png"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;è®¡ç®—å›¾çš„æ¦‚å¿µè¢«æ˜ç¡®åœ°ç¼–ç è¿›äº†åº“ä¸­ï¼Œå¦‚ Theano å’Œ CGTã€‚å…¶ä»–åº“ä¸­ï¼Œè®¡ç®—å›¾éšå¼åœ°ä½œä¸ºç½‘ç»œçš„é…ç½®æ–‡ä»¶ã€‚ä¸»è¦åŒºåˆ«æ˜¯å¦‚ä½•è®¡ç®—æ¢¯åº¦ã€‚ä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ï¼šåœ¨åŒä¸€ä¸ªå›¾ä¸Šåšåå‘ä¼ æ’­æˆ–æ˜ç¡®åœ°è¡¨ç¤ºå‡ºä¸€ä¸ªå›æº¯çš„è·¯å¾„æ¥è®¡ç®—éœ€è¦çš„æ¢¯åº¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/mxnet-optimizing-memory-consumption-in-deep-learning/Fig2.png"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;åƒ Caffeï¼ŒCXXNetï¼ŒTorchè¿™æ ·çš„æ¡†æ¶ä½¿ç”¨å‰è€…ï¼Œåœ¨åŸå›¾ä¸Šåšåå‘ä¼ æ’­ã€‚Theano å’Œ CGT ä½¿ç”¨åè€…ï¼Œæ˜¾ç¤ºåœ°è¡¨ç¤ºåå‘è·¯å¾„ã€‚æˆ‘ä»¬è®¨è®ºæ˜¾ç¤ºåœ°åå‘è·¯å¾„æ–¹æ³•ï¼Œå› ä¸ºå®ƒå¯¹äºä¼˜åŒ–æœ‰å‡ ä¸ªä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œæˆ‘ä»¬åº”è¯¥å¼ºè°ƒä¸€ä¸‹é€‰æ‹©æ˜¾ç¤ºåå‘è·¯å¾„æ–¹æ³•å¹¶ä¸ä¼šé™åˆ¶æˆ‘ä»¬ä½¿ç”¨ç¬¦å·å¼çš„åº“ï¼Œå¦‚ Theano å’Œ CGTã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ˜¾ç¤ºåå‘è·¯å¾„å¯¹åŸºäºå±‚ï¼ˆå°†å‰å‘å’Œåå‘ç»‘èµ·æ¥ï¼‰çš„åº“è¿›è¡Œæ¢¯åº¦è®¡ç®—ã€‚ä¸‹é¢çš„å›¾è¡¨ç¤ºäº†è¿™ä¸ªè¿‡ç¨‹ã€‚åŸºæœ¬ä¸Šæ¥è¯´ï¼Œæˆ‘ä»¬å¼•å…¥åå‘ç»“ç‚¹ï¼Œè¿æ¥å›¾ä¸­çš„å‰å‘èŠ‚ç‚¹ï¼Œåœ¨åå‘æ“ä½œçš„æ—¶å€™è°ƒç”¨ &lt;code&gt;layer.backward&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/mxnet-optimizing-memory-consumption-in-deep-learning/Fig3.png"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªè®¨è®ºå¯ä»¥åº”ç”¨åœ¨å‡ ä¹æ‰€æœ‰ç°å­˜çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆæ˜¾ç¤ºåå‘è·¯å¾„æ›´å¥½ï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹ä¸¤ä¸ªä¾‹å­ã€‚ç¬¬ä¸€ä¸ªåŸå› æ˜¯æ˜¾ç¤ºåå‘è·¯å¾„æ¸…æ™°åœ°æè¿°äº†è®¡ç®—é—´çš„ä¾èµ–å…³ç³»ã€‚è€ƒè™‘ä¸€ç§æƒ…å†µï¼Œæˆ‘ä»¬æƒ³è·å¾— A å’Œ B çš„æ¢¯åº¦ã€‚æˆ‘ä»¬å¯ä»¥ä»å›¾ä¸­æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œ&lt;code&gt;d(C)&lt;/code&gt; æ¢¯åº¦çš„è®¡ç®—ä¸ä¾èµ–äº Fã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨å‰å‘ä¼ æ’­å®Œæˆåé‡Šæ”¾ &lt;code&gt;F&lt;/code&gt; çš„å†…å­˜ã€‚ç±»ä¼¼çš„ï¼Œ&lt;code&gt;C&lt;/code&gt; çš„å†…å­˜ä¹Ÿå¯ä»¥è¢«å›æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/mxnet-optimizing-memory-consumption-in-deep-learning/Fig4.png"
loading="lazy"
alt="Figure4"
&gt;&lt;/p&gt;
&lt;p&gt;æ‹¥æœ‰ä¸åŒçš„åå‘è·¯å¾„è€Œä¸æ˜¯å‰å‘ä¼ æ’­çš„é•œåƒçš„èƒ½åŠ›æ˜¯å…¶å¦ä¸€ä¸ªä¼˜ç‚¹ã€‚ä¸€ä¸ªå¸¸è§çš„ä¾‹å­æ˜¯åˆ†ç¦»è¿æ¥çš„æƒ…å†µï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/mxnet-optimizing-memory-consumption-in-deep-learning/Fig5.png"
loading="lazy"
alt="Figure5"
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒB çš„è¾“å‡ºç”±ä¸¤ä¸ªæ“ä½œå¼•ç”¨ã€‚å¦‚æœæˆ‘ä»¬æƒ³åœ¨åŒä¸€ä¸ªç½‘ç»œä¸­è®¡ç®—æ¢¯åº¦ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªæ˜¾ç¤ºçš„åˆ†å‰²å±‚ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦å¯¹å‰å‘ä¹Ÿåšä¸€æ¬¡åˆ†ç¦»ã€‚å¦‚å›¾ï¼Œå‰å‘ä¸åŒ…å«ä¸€ä¸ªåˆ†å‰²å±‚ï¼Œä½†æ˜¯å›¾ä¼šè‡ªåŠ¨åœ°åœ¨å°†æ¢¯åº¦ä¼ å› B ä¹‹å‰æ’å…¥ä¸€ä¸ªæ¢¯åº¦èšåˆç»“ç‚¹ã€‚è¿™æœ‰åŠ©äºæˆ‘ä»¬èŠ‚çœåˆ†é…åˆ†å‰²è¾“å‡ºçš„å†…å­˜æˆæœ¬ï¼Œä»¥åŠåœ¨å‰å‘ä¼ é€’ä¸­å¤åˆ¶æ•°æ®çš„æ“ä½œæˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬åº”ç”¨æ˜¾ç¤ºåå‘æ–¹æ³•ï¼Œåœ¨å‰å‘å’Œåå‘çš„æ—¶å€™å°±æ²¡æœ‰åŒºåˆ«ã€‚æˆ‘ä»¬ç®€å•åœ°æŒ‰æ—¶é—´é¡ºåºè¿›å…¥è®¡ç®—å›¾ï¼Œå¼€å§‹è®¡ç®—ã€‚è¿™ä½¿å¾—æ˜¾ç¤ºåå‘è·¯å¾„å®¹æ˜“å»åˆ†æã€‚æˆ‘ä»¬ä»…éœ€è¦å›ç­”ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬å¦‚ä½•å¯¹è®¡ç®—å›¾æ¯ä¸ªè¾“å‡ºç»“ç‚¹åˆ†é…å†…å­˜ï¼Ÿ&lt;/p&gt;
&lt;h1 id="what-can-be-optimized"&gt;What Can Be Optimized?
&lt;/h1&gt;&lt;p&gt;è®¡ç®—å›¾æ˜¯ä¸€ç§è®¨è®ºå†…å­˜åˆ†é…ä¼˜åŒ–æŠ€æœ¯æœ‰ç”¨çš„æ–¹å¼ã€‚æˆ‘ä»¬å·²ç»æƒ³ä½ å±•ç¤ºäº†å¦‚ä½•é€šè¿‡æ˜¾ç¤ºåå‘å›¾èŠ‚çœå†…å­˜ã€‚ç°åœ¨æˆ‘ä»¬è®¨è®ºäº›è¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼Œçœ‹çœ‹å¦‚ä½•ç¡®å®šåŸºå‡†æµ‹è¯•çš„åˆç†åŸºçº¿ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬æƒ³æ„å»º &lt;code&gt;n&lt;/code&gt; å±‚ç¥ç»ç½‘ç»œã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨æˆ‘ä»¬å®ç°ç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åŒæ—¶ä¸ºæ¯å±‚çš„è¾“å‡ºå’Œåå‘ä¼ æ’­æ—¶çš„æ¢¯åº¦åˆ†é…ç©ºé—´ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦å·®ä¸å¤š &lt;code&gt;2n&lt;/code&gt; çš„å†…å­˜ã€‚åœ¨æ˜¾ç¤ºåå‘å›¾æ–¹æ³•ä¸­æˆ‘ä»¬é¢å¯¹çš„æ˜¯åŒæ ·çš„éœ€æ±‚å› ä¸ºåå‘ä¼ æ’­æ—¶ç»“ç‚¹æ•°ä¸å‰å‘ä¼ æ’­å·®ä¸å¤šã€‚&lt;/p&gt;
&lt;h2 id="in-place-operations"&gt;In-place Operations
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„ä¸€ä¸ªæœ€ç®€å•çš„æŠ€æœ¯å°±æ˜¯è·¨æ“ä½œçš„åŸåœ°å†…å­˜å…±äº«ã€‚å¯¹äºç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬é€šå¸¸å°†è¿™ä¸ªæŠ€æœ¯åº”ç”¨åœ¨å¯¹åº”æ“ä½œçš„æ¿€æ´»å‡½æ•°ä¸Šã€‚è€ƒè™‘ä¸‹é¢çš„æƒ…å†µï¼Œæˆ‘ä»¬æƒ³è®¡ç®—ä¸‰ä¸ªé“¾å¼ sigmoid å‡½æ•°çš„å€¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/mxnet-optimizing-memory-consumption-in-deep-learning/Fig6.png"
loading="lazy"
alt="Figure6"
&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸ºæˆ‘ä»¬å¯ä»¥åŸåœ°è®¡ç®— sigmoidï¼Œä½¿ç”¨åŒæ ·çš„å†…å­˜ç»™è¾“å…¥å’Œè¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å›ºå®šçš„å†…å­˜å¤§å°è®¡ç®—ä»»æ„é•¿åº¦çš„é“¾å¼ sigmoid å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼šåœ¨å®ç°åŸåœ°ä¼˜åŒ–æ—¶å¾ˆå®¹æ˜“çŠ¯é”™è¯¯ã€‚è€ƒè™‘ä¸‹é¢çš„æƒ…å†µï¼ŒB çš„å€¼ä¸ä»…ç”¨äº Cï¼Œè¿˜ç”¨äº Fã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/mxnet-optimizing-memory-consumption-in-deep-learning/Fig7.png"
loading="lazy"
alt="Figure7"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨åŸåœ°ä¼˜åŒ–å› ä¸º B çš„å€¼åœ¨ &lt;code&gt;C = sigmoid(B)&lt;/code&gt; è®¡ç®—ä¹‹åä»ç„¶éœ€è¦ã€‚å¦‚æœä¸€ä¸ªç®—æ³•ç®€å•åœ°å¯¹æ‰€æœ‰ sigmoid å‡½æ•°éƒ½åšè¿™ä¸ªåŸåœ°ä¼˜åŒ–å°±ä¼šæ‰è¿›è¿™ä¸ªé™·é˜±ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id="standard-memory-sharing"&gt;Standard Memory Sharing
&lt;/h2&gt;&lt;p&gt;é™¤äº†åŸåœ°æ“ä½œè¿˜æœ‰å…¶ä»–åœ°æ–¹å¯ä»¥å…±äº«å†…å­˜ã€‚ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œå› ä¸º B çš„å€¼åœ¨è®¡ç®— E ä¹‹åä¸å†éœ€è¦ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°ä½¿ç”¨ B çš„å†…å­˜æ¥å­˜å‚¨ Eã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/mxnet-optimizing-memory-consumption-in-deep-learning/Fig8.png"
loading="lazy"
alt="Figure8"
&gt;&lt;/p&gt;
&lt;p&gt;å†…å­˜å…±äº«ä¸éœ€è¦ç›¸åŒå¤§å°çš„æ•°æ®ã€‚æ³¨æ„å†ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒB å’Œ E çš„ shape å¯ä»¥ä¸ä¸€æ ·ã€‚ä¸ºäº†å¤„ç†è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åˆ†é…ä¸€ä¸ªç­‰ä»·äº B å’Œ E ä¸­å¤§çš„é‚£ä¸ªå…ƒç´ çš„å¤§å°ï¼Œç„¶åè®©ä»–ä»¬å…±äº«è¿™ä¸ªåŒºåŸŸã€‚&lt;/p&gt;</description></item><item><title>MXNet: Dependency Engine for Deep Learning</title><link>https://davidham3.github.io/blog/p/mxnet-dependency-engine-for-deep-learning/</link><pubDate>Sun, 07 Apr 2019 12:18:41 +0000</pubDate><guid>https://davidham3.github.io/blog/p/mxnet-dependency-engine-for-deep-learning/</guid><description>&lt;p&gt;&lt;a class="link" href="https://mxnet.incubator.apache.org/versions/master/architecture/note_engine.html" target="_blank" rel="noopener"
&gt;MXNet: Dependency Engine for Deep Learning&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ€»æ˜¯æƒ³è®©æ·±åº¦å­¦ä¹ æ¡†æ¶è·‘çš„æ›´å¿«ï¼Œèƒ½é€‚åº”æ›´å¤§çš„æ•°æ®é›†ã€‚ä¸€ä¸ªè‡ªç„¶çš„æƒ³æ³•æ˜¯æˆ‘ä»¬èƒ½å¦é€šè¿‡å †æ›´å¤šçš„ç¡¬ä»¶è§£å†³é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯åŒæ—¶ä½¿ç”¨å¤šä¸ª GPUã€‚&lt;/p&gt;
&lt;p&gt;æ¡†æ¶è®¾è®¡è€…å°±ä¼šé—®ï¼šæˆ‘ä»¬æ€ä¹ˆæ‰èƒ½è®©è®¡ç®—åœ¨è®¾å¤‡é—´å¹¶è¡Œï¼Ÿè€Œä¸”ï¼Œå½“æˆ‘ä»¬å¼•å…¥å¤šçº¿ç¨‹çš„æ—¶å€™ï¼Œå¦‚ä½•åŒæ­¥è®¡ç®—ï¼Ÿä¸€ä¸ªè¿è¡Œç¯å¢ƒä¾èµ–å¼•æ“æ˜¯è¿™äº›é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç¯‡æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬æ£€éªŒäº†ä½¿ç”¨è¿è¡Œç¯å¢ƒä¾èµ–è°ƒåº¦è£…ç½®æ¥åŠ é€Ÿæ·±åº¦å­¦ä¹ çš„æ–¹æ³•ï¼Œè§£é‡Šäº†è¿è¡Œç¯å¢ƒä¾èµ–è°ƒåº¦å™¨å¦‚ä½•åŒæ—¶åŠ é€Ÿå’Œç®€åŒ–å¤šè®¾å¤‡æ·±åº¦å­¦ä¹ ã€‚æˆ‘ä»¬è¿˜æ¢ç´¢äº†æ¡†æ¶ç‹¬ç«‹æˆ–æ“ä½œç‹¬ç«‹çš„é€šç”¨ä¾èµ–å¼•æ“å¯èƒ½çš„è®¾è®¡æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„å¾ˆå¤šè®¨è®ºéƒ½æ˜¯æºäº MXNet ä¾èµ–å¼•æ“ã€‚æˆ‘ä»¬è®¨è®ºçš„ä¾èµ–è¿½è¸ªç®—æ³•ä¸»è¦ç”± &lt;a class="link" href="https://github.com/hotpxl" target="_blank" rel="noopener"
&gt;Yutian Li&lt;/a&gt; å’Œ &lt;a class="link" href="https://github.com/jermainewang" target="_blank" rel="noopener"
&gt;Mingjie Wang&lt;/a&gt; è®¾è®¡ã€‚&lt;/p&gt;
&lt;h1 id="dependency-scheduling"&gt;Dependency Scheduling
&lt;/h1&gt;&lt;p&gt;å°½ç®¡å¤§å¤šæ•°ç”¨æˆ·æƒ³åˆ©ç”¨å¹¶è¡Œè®¡ç®—ï¼Œä½†å¤§éƒ¨åˆ†äººæ›´ç†Ÿæ‚‰ä¸²è¡Œç¼–ç¨‹ã€‚æ‰€ä»¥ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šæˆ‘ä»¬å¦‚ä½•èƒ½å†™ä¸²è¡Œç¨‹åºï¼Œæ„å»ºä¸€ä¸ªåº“ï¼Œè‡ªåŠ¨åœ°å¹¶è¡Œæˆ‘ä»¬çš„ç¨‹åºï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥ä»»æ„é¡ºåºè¿è¡Œ &lt;code&gt;B = A + 1&lt;/code&gt; å’Œ &lt;code&gt;C = A + 2&lt;/code&gt; è¿™ä¸¤ä¸ªå‘½ä»¤ï¼Œæˆ–æ˜¯å¹¶è¡Œè¿è¡Œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;A = 2
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;B = A + 1
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;C = A + 2
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;D = B * C
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä½†æ˜¯ç”±äºæœ€åä¸€ä¸ªæ“ä½œ &lt;code&gt;D = B * C&lt;/code&gt;ï¼Œå¯¼è‡´æ‰‹åŠ¨ç¼–ç åºåˆ—å¾ˆéº»çƒ¦ï¼Œæœ€åä¸€ä¸ªæ“ä½œéœ€è¦ç­‰å¾…å‰é¢çš„æ“ä½œå®Œæˆæ‰èƒ½ç»§ç»­ã€‚ä¸‹é¢çš„ä¾èµ–å›¾/æ•°æ®æµå›¾å±•ç¤ºäº†è¿™ä¸ªè¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/mxnet-dependency-engine-for-deep-learning/Fig1.png"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªä¾èµ–å¼•æ“å¯ä»¥è·å–ä¸€ä¸ªæ“ä½œåºåˆ—å¹¶ä¸”æ ¹æ®ä¾èµ–å…³ç³»è°ƒåº¦ä»–ä»¬ï¼Œæ›´å¯èƒ½ä»¥å¹¶è¡Œçš„æ–¹å¼ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸€ä¸ªä¾èµ–åº“å¯ä»¥å¹¶è¡Œè¿ç®— &lt;code&gt;B = A + 1&lt;/code&gt; å’Œ &lt;code&gt;C = A + 2&lt;/code&gt;ï¼Œç„¶ååœ¨è¿™ä¸¤ä¸ªæ“ä½œå®Œæˆåè¿è¡Œ &lt;code&gt;D = B * C&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h1 id="problems-in-dependency-scheduling"&gt;Problems in Dependency Scheduling
&lt;/h1&gt;&lt;p&gt;ä¸€ä¸ªä¾èµ–å¼•æ“å‡è½»äº†ç¼–å†™å¹¶å‘ç¨‹åºçš„è´Ÿæ‹…ã€‚ä½†æ˜¯ï¼Œç”±äºæ“ä½œå¯ä»¥å¹¶è¡ŒåŒ–ï¼Œæ–°çš„ä¾èµ–è¿½è¸ªé—®é¢˜äº§ç”Ÿäº†ï¼Œè¿™èŠ‚æˆ‘ä»¬è®¨è®ºè¿™äº›é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id="data-flow-dependency"&gt;Data Flow Dependency
&lt;/h2&gt;&lt;p&gt;æ•°æ®æµä¾èµ–è¡¨è¿°äº†ä¸€ä¸ªè®¡ç®—çš„è¾“å‡ºå¦‚ä½•ç”¨äºå…¶ä»–çš„è®¡ç®—ã€‚æ¯ä¸ªä¾èµ–å¼•æ“å¿…é¡»è§£å†³æ•°æ®æµä¾èµ–é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/mxnet-dependency-engine-for-deep-learning/Fig2.png"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸ºæˆ‘ä»¬åœ¨å‰é¢çš„éƒ¨åˆ†è®¨è®ºè¿‡è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨åŒä¸€å¼ å›¾ã€‚åŒ…å«æ•°æ®æµè¿½è¸ªå¼•æ“çš„æ¡†æ¶åŒ…æ‹¬ Minerva å’Œ Purine2ã€‚&lt;/p&gt;
&lt;h2 id="memory-recycling"&gt;Memory Recycling
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ä»€ä¹ˆæ—¶å€™å›æ”¶åˆ†é…ç»™ array çš„å†…å­˜ï¼Ÿåœ¨ä¸²è¡Œç¨‹åºä¸­è¿™ä¸ªé—®é¢˜å¾ˆç®€å•ã€‚æˆ‘ä»¬åœ¨å˜é‡åœ¨ä½œç”¨åŸŸä¸­æ¶ˆå¤±åå›æ”¶å³å¯ã€‚ä½†æ˜¯ï¼Œä¸‹é¢çš„å›¾å±•ç¤ºäº†å¹¶è¡Œç¨‹åºä¸­è¿™æœ‰å¤šéº»çƒ¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/mxnet-dependency-engine-for-deep-learning/Fig3.png"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸¤ä¸ªæ“ä½œéƒ½éœ€è¦ &lt;code&gt;A&lt;/code&gt; çš„å€¼ï¼Œæˆ‘ä»¬éœ€è¦ç­‰ä¸¤ä¸ªæ“ä½œéƒ½å®Œæˆæ‰èƒ½å›æ”¶ã€‚å¼•æ“å¿…é¡»æ ¹æ®ä¾èµ–æ¥è°ƒåº¦å›æ”¶å™¨ï¼Œç¡®ä¿åœ¨ &lt;code&gt;B = A + 1&lt;/code&gt; å’Œ &lt;code&gt;C = A + 2&lt;/code&gt; éƒ½å®Œæˆåå†æ‰§è¡Œã€‚&lt;/p&gt;
&lt;h2 id="random-number-generation"&gt;Random Number Generation
&lt;/h2&gt;&lt;p&gt;éšæœºæ•°ç”Ÿæˆå™¨æ˜¯æœºå™¨å­¦ä¹ ä¸­å¸¸ç”¨çš„ï¼Œç»™ä¾èµ–å¼•æ“æå‡ºäº†æœ‰è¶£çš„æŒ‘æˆ˜ã€‚è€ƒè™‘ä¸‹é¢çš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/mxnet-dependency-engine-for-deep-learning/Fig4.png"
loading="lazy"
alt="Figure4"
&gt;&lt;/p&gt;
&lt;p&gt;å†è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä»¥åºåˆ—å½¢å¼ç”Ÿæˆäº†éšæœºæ•°ã€‚å°½ç®¡çœ‹èµ·æ¥ä¸¤ä¸ªéšæœºæ•°ç”Ÿæˆè¿‡ç¨‹æ˜¯å¹¶è¡Œçš„ï¼Œä½†å®é™…ä¸Šä¸æ˜¯ã€‚ä¸€ä¸ªä¼ªéšæœºæ•°ç”Ÿæˆå™¨ (PRNG) ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› ä¸ºåœ¨ç”Ÿæˆæ–°çš„éšæœºæ•°æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸€äº›å†…éƒ¨çŠ¶æ€çš„å˜åŒ–ã€‚å³ä½¿ PRNG æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¸Œæœ›æ•°å­—çš„ç”Ÿæˆæ˜¯ä¸²è¡Œçš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¯é‡ç°çš„éšæœºæ•°åºåˆ—ã€‚&lt;/p&gt;</description></item><item><title>pysparkä¸­çš„HBaseConverters</title><link>https://davidham3.github.io/blog/p/pyspark%E4%B8%AD%E7%9A%84hbaseconverters/</link><pubDate>Sat, 06 Apr 2019 16:43:29 +0000</pubDate><guid>https://davidham3.github.io/blog/p/pyspark%E4%B8%AD%E7%9A%84hbaseconverters/</guid><description>&lt;p&gt;æœ€è¿‘é¡¹ç›®ä¸Šæœ‰ä¸ªéœ€æ±‚ï¼Œä½¿ç”¨ pyspark è¯»å– HBase ä¸­å­˜å‚¨çš„ java.math.BigDecimalã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘ç”²æ–¹è®©æˆ‘ä»¬å†™ä¸€ä¸ª pyspark çš„æ•™ç¨‹ï¼Œä»–ä»¬ä»¥åæ‰“ç®—ä½¿ç”¨ pyspark å¼€å‘ã€‚ä»–ä»¬çš„æ•°æ®æ˜¯é‚£ç§ç²¾åº¦è¦æ±‚æ¯”è¾ƒé«˜çš„æ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨ java.math.BigDecimal è¡¨ç¤ºæ•°å­—ï¼Œç„¶åè½¬æˆ byte[] åå­˜å…¥äº† HBaseï¼Œä½†æ˜¯ python æ˜¯æ²¡æ³•ç›´æ¥è¯»å–è¿™ä¸ª BigDecimalï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ spark-examples ä¸­ HBaseConverters.scala è¯»å–ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è®¨è®ºçš„ spark ç‰ˆæœ¬æ˜¯ 1.6ï¼Œå› ä¸ºç”¨çš„æ˜¯ CDH 5ï¼Œæ‰€ä»¥æ˜¯è¿™ä¸ªç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;åŸç†å®é™…ä¸Šæ˜¯ï¼Œpyspark åœ¨è¯»å– HBase çš„æ—¶å€™éœ€è¦å€ŸåŠ© org.apache.spark.examples.pythonconverters è¿™ä¹ˆä¸€ä¸ªç±»ï¼Œè¿™ä¸ªç±»å®é™…ä¸Šæ˜¯ scala å°† HBase ä¸­çš„æ•°æ®è¯»å–åï¼Œè½¬æ¢æˆ json å­—ç¬¦ä¸²è¿”å›ï¼Œè¿™æ · pyspark å¯ä»¥é€šè¿‡è¿™ä¸ªç±»ä» HBase ä¸­ç›´æ¥è·å–åˆ° json å­—ç¬¦ä¸²è¿™æ ·çš„è¿”å›å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä» &lt;a class="link" href="https://github.com/apache/spark/blob/branch-1.6/examples/src/main/scala/org/apache/spark/examples/pythonconverters/HBaseConverters.scala" target="_blank" rel="noopener"
&gt;HBaseConverters.scala&lt;/a&gt; è¿™é‡Œçœ‹åˆ° HBaseConverters.scala çš„æºç ï¼Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯ä» HBase ä¸­æŸ¥è¯¢ value è¿™ä¸€éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-scala" data-lang="scala"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;package&lt;/span&gt; &lt;span class="nn"&gt;org.apache.spark.examples.pythonconverters&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;scala.collection.JavaConverters._&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;scala.util.parsing.json.JSONObject&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.spark.api.python.Converter&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.client.&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nc"&gt;Put&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nc"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.io.ImmutableBytesWritable&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.util.Bytes&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.KeyValue.Type&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.apache.hadoop.hbase.CellUtil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cm"&gt;/**
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cm"&gt; * Implementation of [[org.apache.spark.api.python.Converter]] that converts all
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cm"&gt; * the records in an HBase Result to a String
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HBaseResultToStringConverter&lt;/span&gt; &lt;span class="k"&gt;extends&lt;/span&gt; &lt;span class="nc"&gt;Converter&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;Any&lt;/span&gt;, &lt;span class="kt"&gt;String&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="n"&gt;convert&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;Any&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;String&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="k"&gt;=&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asInstanceOf&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="k"&gt;=&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listCells&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asScala&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt; &lt;span class="k"&gt;=&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nc"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;row&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneRow&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;columnFamily&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneFamily&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;qualifier&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneQualifier&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;timestamp&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getTimestamp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;type&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;codeToType&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getTypeByte&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;value&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneValue&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;JSONObject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;_&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;()).&lt;/span&gt;&lt;span class="n"&gt;mkString&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;\n&amp;#34;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™æ®µä»£ç å¾ˆç®€å•ï¼Œå®é™…ä¸Šå°±æ˜¯ä½¿ç”¨ java HBase çš„ API è¯»å– HBase ä¸­çš„å€¼ï¼Œå°†æ‰€æœ‰çš„å€¼è½¬æ¢ä¸º String è¿”å›ï¼Œæˆ‘éœ€è¦åšçš„ï¼Œåªæ˜¯å°† value è¿™ä¸ªå­—æ®µçš„å€¼ï¼Œå…ˆä» byte[] è½¬åˆ° BigDecimalï¼Œå†è½¬æ¢ä¸º String å³å¯ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-scala" data-lang="scala"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyHBaseResultToStringConverter&lt;/span&gt; &lt;span class="k"&gt;extends&lt;/span&gt; &lt;span class="nc"&gt;Converter&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;Any&lt;/span&gt;, &lt;span class="kt"&gt;String&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="n"&gt;convert&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;Any&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="k"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;String&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="k"&gt;=&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asInstanceOf&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="k"&gt;=&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listCells&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asScala&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt; &lt;span class="k"&gt;=&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nc"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;row&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneRow&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;columnFamily&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneFamily&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;qualifier&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toStringBinary&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneQualifier&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;timestamp&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getTimestamp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;type&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;codeToType&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getTypeByte&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s"&gt;&amp;#34;value&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toBigDecimal&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;CellUtil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cloneValue&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;)).&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;JSONObject&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;_&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;()).&lt;/span&gt;&lt;span class="n"&gt;mkString&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;\n&amp;#34;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™æ ·ä»£ç å°±æ”¹å®Œäº†ï¼Œç„¶åéœ€è¦ç¼–è¯‘ï¼Œæ‰“æˆ jar åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;è£…å¥½ mavenï¼Œæˆ‘è£…çš„æ˜¯ 3.6.0ï¼Œä¸éœ€è¦é…ç½®ä»€ä¹ˆã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹è½½ spark çš„æºç ï¼Œæœ€å¼€å§‹æˆ‘ä» github ä¸Šé¢ä¸‹è½½çš„ï¼Œå‘ç°é€Ÿåº¦å¾ˆæ…¢ï¼Œç„¶åå°±å» spark å®˜ç½‘ï¼Œæ‰¾ä»“åº“ä¸­çš„æºä»£ç ä¸‹è½½ä¸‹æ¥ã€‚&lt;/p&gt;
&lt;p&gt;ç¼–è¯‘ spark-examples çš„æ—¶å€™éœ€è¦å…ˆä»æ ¹ç›®å½•ä¸­æŠŠ scalastyle-config.xml æ‹·è´åˆ° examples ç›®å½•ä¸‹å†è¿›è¡Œç¼–è¯‘&lt;/p&gt;
&lt;p&gt;cd åˆ° examples ç›®å½•ä¸‹ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¯‘ spark-examples&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mvn clean install -pl :spark-examples_2.10
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/pyspark%e4%b8%ad%e7%9a%84hbaseconverters/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;ç¼–è¯‘çš„æ—¶å€™æ²¡æœ‰é‡åˆ°é”™è¯¯ï¼Œç¼–è¯‘å¥½çš„åŒ…åœ¨åŒçº§ç›®å½•ä¸‹çš„ target ä¸­ï¼Œæœ‰ä¸ªå« spark-examples_2.10-1.6.0.jar çš„æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°±æ˜¯ä½¿ç”¨è¿™ä¸ªåŒ…è¯»å– HBase ä¸­çš„ BigDecimaläº†ï¼š&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ standalone æ¨¡å¼è¿è¡Œ pysparkï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;pyspark --master spark://host1:7077 --jars spark-examples_2.10-1.6.0.jar
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;zookeeper_host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;host1&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;hbase_table_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;testTable&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;conf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;hbase.zookeeper.quorum&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;zookeeper_host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;hbase.mapreduce.inputtable&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;hbase_table_name&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;keyConv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.spark.examples.pythonconverters.ImmutableBytesWritableToStringConverter&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# æ³¨æ„è¿™é‡Œï¼Œä½¿ç”¨è‡ªå·±å®šä¹‰çš„Converterè¯»å–&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;valueConv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.spark.examples.pythonconverters.MyHBaseResultToStringConverter&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;hbase_rdd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;newAPIHadoopRDD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.hadoop.hbase.mapreduce.TableInputFormat&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.hadoop.hbase.io.ImmutableBytesWritable&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;org.apache.hadoop.hbase.client.Result&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;keyConverter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;keyConv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;valueConverter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;valueConv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;hbase_rdd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hbase_rdd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flatMapValues&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mapValues&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loads&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;hbase_rdd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;take&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶åå°±å¯ä»¥çœ‹åˆ°ç»“æœäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸Šå°±æ˜¯å¦‚ä½•é€šè¿‡ä¿®æ”¹ HBaseConverters.scala è®© pyspark ä» HBase ä¸­è¯»å– java çš„ç‰¹æ®Šç±»å‹ã€‚&lt;/p&gt;</description></item><item><title>Revisiting Spatial-Temporal Similarity: A Deep Learning Framework for Traffic Prediction</title><link>https://davidham3.github.io/blog/p/revisiting-spatial-temporal-similarity-a-deep-learning-framework-for-traffic-prediction/</link><pubDate>Thu, 21 Mar 2019 10:43:34 +0000</pubDate><guid>https://davidham3.github.io/blog/p/revisiting-spatial-temporal-similarity-a-deep-learning-framework-for-traffic-prediction/</guid><description>&lt;p&gt;AAAI 2019ã€‚ç½‘æ ¼æµé‡é¢„æµ‹ï¼Œä¸¤ä¸ªé—®é¢˜ï¼šç©ºé—´ä¾èµ–åŠ¨æ€æ€§ï¼Œå¦ä¸€ä¸ªæ˜¯å‘¨æœŸå¹³ç§»ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="http://export.arxiv.org/abs/1803.01254" target="_blank" rel="noopener"
&gt;Revisiting Spatial-Temporal Similarity: A Deep Learning Framework for Traffic Prediction&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;ç”±äºå¤§è§„æ¨¡çš„äº¤é€šæ•°æ®è¶Šæ¥è¶Šå¤šï¼Œè€Œä¸”äº¤é€šé¢„æµ‹åœ¨å®é™…ä¸­å¾ˆé‡è¦ï¼Œäº¤é€šé¢„æµ‹åœ¨ AI é¢†åŸŸå¼•èµ·è¶Šæ¥è¶Šå¤šçš„å…³æ³¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªç²¾ç¡®çš„å‡ºç§Ÿè½¦éœ€æ±‚é¢„æµ‹å¯ä»¥ååŠ©å‡ºç§Ÿè½¦å…¬å¸é¢„åˆ†é…å‡ºç§Ÿè½¦ã€‚äº¤é€šé¢„æµ‹çš„å…³é”®åœ¨äºå¦‚ä½•å¯¹å¤æ‚çš„ç©ºé—´ä¾èµ–å’Œæ—¶é—´åŠ¨æ€æ€§å»ºæ¨¡ã€‚å°½ç®¡ä¸¤ä¸ªå› ç´ åœ¨å»ºæ¨¡çš„æ—¶å€™éƒ½ä¼šè€ƒè™‘ï¼Œå½“å‰çš„æ–¹æ³•ä»ä¼šåšå¾ˆå¼ºçš„å‡è®¾ï¼Œå³ç©ºé—´ä¾èµ–åœ¨æ—¶é—´ä¸Šæ˜¯å¹³ç¨³çš„ï¼Œæ—¶é—´ä¾èµ–æ˜¯ä¸¥æ ¼å‘¨æœŸçš„ã€‚ç„¶è€Œï¼Œå®é™…ä¸­çš„ç©ºé—´ä¾èµ–å¯èƒ½æ˜¯åŠ¨æ€çš„ï¼ˆå³éšæ—¶é—´çš„å˜åŒ–è€Œå˜åŒ–ï¼‰ï¼Œè€Œä¸”æ—¶é—´åŠ¨æ€æ€§å¯èƒ½ä»ä¸€ä¸ªæ—¶æ®µåˆ°å¦ä¸€ä¸ªæ—¶æ®µæœ‰æ³¢åŠ¨ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªé‡è¦å‘ç°ï¼šï¼ˆ1ï¼‰åŒºåŸŸé—´çš„ç©ºé—´ä¾èµ–æ˜¯åŠ¨æ€çš„ï¼›ï¼ˆ2ï¼‰æ—¶é—´ä¾èµ–è™½è¯´æœ‰å¤©å’Œå‘¨çš„æ¨¡å¼ï¼Œä½†å› ä¸ºæœ‰åŠ¨æ€æ—¶é—´å¹³ç§»ï¼Œå®ƒä¸æ˜¯ä¸¥æ ¼å‘¨æœŸçš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–°çš„æ—¶ç©ºåŠ¨æ€ç½‘ç»œï¼ˆSTDNï¼‰ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªé—¨æ§æœºåˆ¶å­¦ä¹ åŒºåŸŸé—´çš„åŠ¨æ€ç›¸ä¼¼æ€§ï¼Œç”¨ä¸€ä¸ªå‘¨æœŸæ€§å¹³ç§»çš„æ³¨æ„åŠ›æœºåˆ¶æ¥å¤„ç†é•¿æœŸå‘¨æœŸæ—¶é—´å¹³ç§»ç°è±¡ã€‚æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªåœ¨ä¸€ä¸ªç»Ÿä¸€çš„æ¡†æ¶ä¸­è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜çš„å·¥ä½œã€‚æˆ‘ä»¬çš„å®éªŒç»“æœè¯æ˜äº†æå‡ºçš„æ–¹æ³•æ˜¯æœ‰æ•ˆçš„ã€‚&lt;/p&gt;
&lt;h1 id="introduction"&gt;Introduction
&lt;/h1&gt;&lt;p&gt;äº¤é€šé¢„æµ‹æ˜¯ä¸€ä¸ªæ—¶ç©ºé¢„æµ‹é—®é¢˜ã€‚ç²¾ç¡®çš„é¢„æµ‹æ¨¡å‹å¯¹å¾ˆå¤šåº”ç”¨éƒ½å¾ˆé‡è¦ã€‚åœ¨ä¼ ç»Ÿäº¤é€šé¢„æµ‹é—®é¢˜ä¸­ï¼Œç»™å®šå†å²æ•°æ®ï¼ˆæ¯”å¦‚ä¸€ä¸ªåŒºåŸŸçš„æµé‡ï¼Œæˆ–ä¸€ä¸ªäº¤å‰å¡å‰å‡ ä¸ªæœˆæ¯å°æ—¶çš„æµé‡ï¼‰ï¼Œé¢„æµ‹æœªæ¥ä¸€æ®µæ—¶é—´çš„æ•°æ®ã€‚è¿™æ–¹é¢çš„ç ”ç©¶å·²ç»æœ‰å‡ åå¹´äº†ã€‚åœ¨æ—¶é—´åºåˆ—ç¤¾åŒºï¼ŒARIMA å’Œ Kalman filteringè¢«å¹¿æ³›åœ°åº”ç”¨åˆ°è¿™ä¸€é¢†åŸŸã€‚ç„¶è€Œè¿™äº›æ—©æœŸæ–¹æ³•æ˜¯é’ˆå¯¹æ¯ä¸ªåŒºåŸŸåˆ†åˆ«é¢„æµ‹ï¼Œæœ€è¿‘çš„æ–¹æ³•è€ƒè™‘äº†ç©ºé—´ä¿¡æ¯ï¼ˆæ¯”å¦‚é’ˆå¯¹è¿‘é‚»åŒºåŸŸå¢åŠ æ­£åˆ™é¡¹ï¼‰å’Œå¤–éƒ¨å› ç´ ï¼ˆå¦‚åœ°ç‚¹ä¿¡æ¯ï¼Œå¤©æ°”çŠ¶å†µï¼Œåœ°åŒºæ´»åŠ¨ï¼‰ã€‚ç„¶è€Œï¼Œè¿™äº›æ–¹æ³•ä»åŸºäºæœºå™¨å­¦ä¹ ä¸­çš„ä¼ ç»Ÿæ—¶é—´åºåˆ—æ¨¡å‹ï¼Œä¸èƒ½å¾ˆå¥½çš„æ•è·å¤æ‚çš„éçº¿æ€§æ—¶ç©ºä¾èµ–ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘ï¼Œæ·±åº¦å­¦ä¹ æ–¹æ³•åœ¨å¾ˆå¤šä»»åŠ¡ä¸Šå–å¾—äº†æˆåŠŸã€‚æ¯”å¦‚ï¼Œä¸€äº›ç ”ç©¶å°†åŸå¸‚äº¤é€šçœ‹ä½œæ˜¯çƒ­åŠ›å›¾çš„å›¾ç‰‡ï¼Œä½¿ç”¨ CNN å¯¹éçº¿æ€§ç©ºé—´å…³ç³»å»ºæ¨¡ã€‚ä¸ºäº†å¯¹éçº¿æ€§æ—¶é—´å…³ç³»å»ºæ¨¡ï¼Œäººä»¬æå‡ºäº†åŸºäº RNN çš„æ¡†æ¶ã€‚Yao et alã€‚ æ›´æ˜¯æå‡ºäº†ç”¨ CNN å’Œ LSTM åŒæ—¶å¤„ç†æ—¶é—´å’Œç©ºé—´ä¾èµ–çš„æ¡†æ¶ã€‚&lt;/p&gt;
&lt;p&gt;å°½ç®¡è€ƒè™‘äº†åŒæ—¶å¯¹æ—¶ç©ºå»ºæ¨¡ï¼Œç°å­˜çš„æ–¹æ³•ä¸»è¦æœ‰ä¸¤ç‚¹ä¸è¶³ã€‚é¦–å…ˆï¼ŒåŒºåŸŸé—´çš„ç©ºé—´ä¾èµ–ä¾èµ–äºå†å²æ•°æ®çš„ç›¸ä¼¼æ€§ï¼Œæ¨¡å‹å­¦ä¹ åˆ°äº†ä¸€ä¸ªé™æ€çš„ç©ºé—´ä¾èµ–ã€‚ç„¶è€Œï¼ŒåŒºåŸŸé—´çš„ä¾èµ–éšæ—¶é—´æ˜¯æ”¹å˜çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ—©ä¸Šï¼Œå±…æ°‘åŒºå’Œå•†ä¸šåŒºä¹‹é—´çš„ä¾èµ–å…³ç³»å¼ºï¼›æ·±å¤œï¼Œå…³ç³»å°±å¼±äº†ã€‚ç„¶è€Œï¼Œè¿™æ ·çš„åŠ¨æ€ä¾èµ–åœ¨ä¹‹å‰çš„ç ”ç©¶ä¸­æ²¡æœ‰è€ƒè™‘ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªé™åˆ¶æ˜¯ç°å­˜çš„ç ”ç©¶å¿½ç•¥äº†é•¿æœŸå‘¨æœŸä¾èµ–ã€‚äº¤é€šæ•°æ®åˆå¾ˆå¼ºçš„æ—¥å’Œå‘¨å‘¨æœŸæ€§ï¼ŒåŸºäºè¿™ç§å‘¨æœŸæ€§çš„ä¾èµ–å…³ç³»å¯èƒ½ç”¨äºé¢„æµ‹ã€‚ç„¶è€Œï¼Œä¸€ä¸ªæŒ‘æˆ˜æ˜¯äº¤é€šæ•°æ®ä¸æ˜¯ä¸¥æ ¼å‘¨æœŸçš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‘¨æœ«çš„é«˜å³°é€šå¸¸å‘ç”Ÿåœ¨ä¸‹åˆçš„ååŠæ®µï¼Œä¸åŒçš„æ—¥å­æ—¶é—´ä¸ä¸€è‡´ï¼Œä»4:30pmåˆ°6:00pmå˜åŒ–ã€‚å°½ç®¡ä¹‹å‰çš„ç ”ç©¶è€ƒè™‘äº†å‘¨æœŸæ€§ï¼Œä»–ä»¬æ²¡èƒ½è€ƒè™‘åºåˆ—æ€§çš„ä¾èµ–å’Œå‘¨æœŸæ€§ä¸­çš„æ—¶é—´å¹³ç§»ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§£å†³å‰é¢æå‡ºçš„é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†æ–°çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œæ—¶ç©ºåŠ¨æ€ç½‘ç»œç”¨äºäº¤é€šé¢„æµ‹ã€‚STDN æ˜¯åŸºäºæ—¶ç©ºç¥ç»ç½‘ç»œçš„ï¼Œä½¿ç”¨å±€éƒ¨ CNN å’Œ LSTM åˆ†åˆ«å¤„ç†æ—¶ç©ºä¿¡æ¯ã€‚ä¸€ä¸ªé—¨æ§å±€éƒ¨ CNN ä½¿ç”¨åŒºåŸŸé—´çš„åŠ¨æ€ç›¸ä¼¼æ€§å¯¹ç©ºé—´ä¾èµ–å»ºæ¨¡ã€‚ä¸€ä¸ªå‘¨æœŸå¹³ç§»çš„æ³¨æ„åŠ›æœºåˆ¶ç”¨æ¥å­¦ä¹ é•¿æœŸå‘¨æœŸä¾èµ–ã€‚é€šè¿‡æ³¨æ„åŠ›æœºåˆ¶å¯¹é•¿æœŸå‘¨æœŸä¿¡æ¯å’Œæ—¶é—´å¹³ç§»å»ºæ¨¡ã€‚æˆ‘ä»¬çš„æ–¹æ³•è¿˜ç”¨ LSTM ä»¥å±‚æ¬¡çš„æ–¹å¼å¤„ç†åºåˆ—ä¾èµ–ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å†å¤§å‹çš„çœŸå®æ•°æ®é›†ä¸Šåšäº†è¯„æµ‹ï¼Œçº½çº¦å‡ºç§Ÿè½¦æ•°æ®å’Œçº½çº¦çš„å…±äº«å•è½¦æ•°æ®ã€‚å’Œ state-of-the-art çš„å…¨é¢å¯¹æ¯”å±•ç¤ºäº†æˆ‘ä»¬æ¨¡å‹çš„æ€§èƒ½ã€‚æˆ‘ä»¬çš„è´¡çŒ®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæµå¼é—¨æ§æœºåˆ¶å¯¹åŠ¨æ€ç©ºé—´ç›¸ä¼¼æ€§å»ºæ¨¡ã€‚é—¨æ§åˆ¶ä¿¡æ¯åœ¨é‚»è¿‘åŒºåŸŸä¼ æ’­ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªå‘¨æœŸå¹³ç§»æ³¨æ„åŠ›æœºåˆ¶ï¼Œé€šè¿‡åŒæ—¶æ—¶å¯ç”¨é•¿æœŸå‘¨æœŸä¿¡æ¯å’Œæ—¶é—´å¹³ç§»ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬åœ¨å‡ ä¸ªçœŸå®æ•°æ®é›†ä¸Šå¼€å±•äº†å®éªŒï¼Œæ•ˆæœå¥½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="notations-and-problem-formulation"&gt;Notations and Problem Formulation
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬å°†æ•´ä¸ªåŸå¸‚åˆ†ä¸º $a \times b$ ä¸ªç½‘æ ¼ï¼Œä¸€å…± $n$ ä¸ªåŒºåŸŸï¼ˆ$n = a \times b$ï¼‰ï¼Œä½¿ç”¨ $\lbrace 1,2,\dots,n \rbrace$ è¡¨ç¤ºä»–ä»¬ã€‚æˆ‘ä»¬å°†æ•´ä¸ªæ—¶é—´å‘¨æœŸåˆ†ä¸º $m$ ä¸ªç™»åœºçš„è¿ç»­æ—¶æ®µã€‚ä»»ä½•ä¸€ä¸ªä¸ªä½“çš„ç§»åŠ¨ï¼Œå…¶æœ¬è´¨ä¸Šæ˜¯æ•´ä¸ªåŸå¸‚äº¤é€šçš„ä¸€éƒ¨åˆ†ï¼Œæ€»æ˜¯ä»ä¸€ä¸ªåŒºåŸŸå‡ºå‘ï¼Œè¿‡ä¸€æ®µæ—¶é—´åˆ°è¾¾ç›®çš„åœ°ã€‚æˆ‘ä»¬åœ¨ä¸€ä¸ªæ—¶æ®µå†…ç»™æ¯ä¸ªåŒºåŸŸå®šä¹‰ä¸€ä¸ªå¼€å§‹/ç»“æŸæµé‡ä½œä¸ºåŒºåŸŸå‡ºå‘/åˆ°è¾¾çš„ç§»åŠ¨å‘ç”Ÿæ¬¡æ•°ã€‚$y^s_{i,t}$ å’Œ $y^e_{i,t}$ è¡¨ç¤ºå¼€åŒºåŸŸ $i$ åœ¨æ—¶æ®µ $t$ çš„å¼€å§‹/ç»“æŸæµé‡ã€‚æ­¤å¤–ï¼Œå¯¹ä¸ªä½“æ—…è¡Œçš„èšåˆå½¢æˆäº¤é€šæµï¼Œæè¿°äº†åŒºåŸŸå¯¹ä¹‹é—´çš„è€ƒè™‘æ—¶é—´çš„ç§»åŠ¨ã€‚æ—¶æ®µ $t$ ä»åŒºåŸŸ $i$ å¼€å§‹çš„äº¤é€šæµåœ¨æ—¶æ®µ $\tau$ äºåŒºåŸŸ $j$ ç»“æŸï¼Œè¡¨ç¤ºä¸º $f^{j,\tau}_{i,t}$ã€‚æ˜¾ç„¶ï¼Œäº¤é€šæµåæ˜ äº†åŒºåŸŸé—´çš„è¿é€šæ€§ï¼Œä¹Ÿåæ˜ äº†ä¸ªä½“çš„ç§»åŠ¨ã€‚å›¾1ï¼ˆcï¼‰ç»™å‡ºäº†æµé‡å’ŒæµåŠ¨çš„å±•ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Problem(Traffic Volume Prediction)&lt;/strong&gt; ç»™å®šçŸ¥é“æ—¶æ®µ $t$ çš„æ•°æ®ï¼Œäº¤é€šæµé¢„æµ‹é—®é¢˜ç›®æ ‡æ˜¯é¢„æµ‹æ—¶æ®µ $t+1$ çš„èµ·å§‹å’Œç»“æŸæµé‡ã€‚&lt;/p&gt;
&lt;h1 id="spatial-temporal-dynamic-network"&gt;Spatial-Temporal Dynamic Network*
&lt;/h1&gt;&lt;p&gt;è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬è®²ä¸€ä¸‹ç»†èŠ‚ã€‚å›¾1æ˜¯æˆ‘ä»¬æ¨¡å‹çš„æ¶æ„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/revisiting-spatial-temporal-similarity-a-deep-learning-framework-for-traffic-prediction/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;h2 id="local-spatial-temporal-network"&gt;Local Spatial-Temporal Network
&lt;/h2&gt;&lt;p&gt;ä¸ºäº†æ•è·æ—¶ç©ºåºåˆ—ä¾èµ–ï¼Œåœ¨å‡ºç§Ÿè½¦éœ€æ±‚é¢„æµ‹ä¸Šï¼Œèåˆå±€éƒ¨ CNN å’Œ LSTM å±•ç¤ºå‡ºäº†éå¸¸å¥½çš„è¡¨ç°ã€‚æˆ‘ä»¬è¿™é‡Œä½¿ç”¨å±€éƒ¨ CNN å’Œ LSTM å¤„ç†ç©ºé—´å’ŒçŸ­æœŸæ—¶é—´ä¾èµ–ã€‚ä¸ºäº†æ‰‹åŠ¨åœ°æå‡ä¸¤ç§æµé‡çš„é¢„æµ‹ï¼ˆèµ·å§‹å’Œç»“æŸï¼‰ï¼Œæˆ‘ä»¬å°†ä»–ä»¬é›†æˆèµ·æ¥ã€‚è¿™éƒ¨åˆ†ç§°ä¸º Local Spatial-Temporal Network (LSTN)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Local spatial dependency&lt;/strong&gt; å·ç§¯ç¥ç»ç½‘ç»œç”¨æ¥æ•è·ç©ºé—´å…³ç³»ã€‚å°†æ•´ä¸ªåŸå¸‚çœ‹ä½œä¸€å¼ å›¾ç‰‡ï¼Œç®€å•åœ°ä½¿ç”¨ CNN ä¸èƒ½è·å¾—æœ€å¥½çš„æ€§èƒ½ã€‚åŒ…å«äº†å¼±å…³ç³»çš„åŒºåŸŸä¼šå¯¼è‡´é¢„æµ‹æ€§èƒ½ä¸‹é™ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨å±€éƒ¨ CNN å¯¹ç©ºé—´ä¾èµ–å»ºæ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ¯ä¸ªæ—¶æ®µ $t$ï¼Œæˆ‘ä»¬å°†ç›®æ ‡åŒºåŸŸ $i$ å’Œå®ƒå‘¨å›´çš„é‚»å±…çœ‹ä½œæ˜¯ $S \times S$ å¤§å°çš„å›¾ç‰‡ï¼Œä¸¤ä¸ªé€šé“ $\mathbf{Y}_{i,t} \in \mathbb{R}^{S \times S \times 2}$ã€‚ä¸€ä¸ªé€šé“åŒ…å«èµ·å§‹æµé‡ä¿¡æ¯ï¼Œå¦ä¸€ä¸ªæ˜¯ç»“æŸæµé‡ä¿¡æ¯ã€‚ç›®æ ‡åŒºåŸŸåœ¨å›¾åƒçš„ä¸­é—´ã€‚å±€éƒ¨ CNN ä½¿ç”¨ $\mathbf{Y}_{i,t}$ ä½œä¸ºè¾“å…¥ $\mathbf{Y}^{(0)}_{i,t}$ï¼Œæ¯ä¸ªå·ç§¯å±‚çš„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{1}
\mathbf{Y}^{(k)}\_{i,t} = \text{ReLU}(\mathbf{W}^{(k)} \ast \mathbf{Y}^{(k-1)}\_{i,t} + \mathbf{b}^{(k)}),
$$&lt;p&gt;å…¶ä¸­ $\mathbf{W}^{(k)}$ å’Œ $\mathbf{b}^{(k)}$ æ˜¯å‚æ•°ã€‚å †å  $K$ å±‚å·ç§¯åï¼Œç”¨ä¸€ä¸ªå…¨è¿æ¥æ¥æ¨æµ‹åŒºåŸŸ $i$ çš„ç©ºé—´è¡¨ç¤ºï¼Œè®°ä¸º $\mathbf{y}_{i,t}$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Short-term Temporal Dependency&lt;/strong&gt; æˆ‘ä»¬ä½¿ç”¨ LSTM æ•è·ç©ºé—´åºåˆ—ä¾èµ–ã€‚æˆ‘ä»¬ä½¿ç”¨åŸå§‹ç‰ˆæœ¬çš„ LSTMï¼š&lt;/p&gt;
$$\tag{2}
\mathbf{h}\_{i,t} = \text{LSTM}([\mathbf{y}\_{i,t};\mathbf{e}\_{i,t}], \mathbf{h}\_{i,t-1}),
$$&lt;p&gt;å…¶ä¸­ï¼Œ$\mathbf{h}_{i,t}$ æ˜¯åŒºåŸŸ $i$ åœ¨æ—¶æ®µ $t$ çš„è¾“å‡ºè¡¨ç¤ºã€‚$\mathbf{e}_{i,t}$ è¡¨ç¤ºå¤–éƒ¨å› ç´ ã€‚å› æ­¤ï¼Œ$\mathbf{h}_{i,t}$ åŒ…å«ç©ºé—´å’ŒçŸ­æœŸæ—¶é—´ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h2 id="spatial-dynamic-similarity-flow-gating-mechanism"&gt;Spatial Dynamic Similarity: Flow Gating Mechanism
&lt;/h2&gt;&lt;p&gt;å±€éƒ¨ CNN ç”¨äºæ•è·ç©ºé—´ä¾èµ–ã€‚CNN é€šè¿‡å±€éƒ¨è¿æ¥å’Œæƒé‡å…±äº«å¤„ç†å±€éƒ¨ç»“æ„ç›¸ä¼¼æ€§ã€‚åœ¨å±€éƒ¨ CNN ä¸­ï¼Œå±€éƒ¨ç©ºé—´ä¾èµ–ä¾é å†å²äº¤é€šæµé‡çš„ç›¸ä¼¼åº¦ã€‚ç„¶è€Œï¼Œæµé‡çš„ç©ºé—´ä¾èµ–æ˜¯å¹³ç¨³çš„ï¼Œä¸èƒ½å®Œå…¨åœ°åæ˜ ç›®æ ‡åŒºåŸŸå’Œå…¶é‚»å±…é—´çš„å…³ç³»ã€‚ä¸€ä¸ªç›´æ¥çš„è¡¨ç¤ºåŒºåŸŸé—´å…³ç³»çš„æ–¹å¼æ˜¯äº¤é€šæµã€‚å¦‚æœä¸¤ä¸ªåŒºåŸŸé—´æœ‰å¾ˆå¤šæµé‡ï¼Œé‚£ä¹ˆä»–ä»¬ä¹‹é—´çš„å…³ç³»å¼ºçƒˆï¼ˆä¹Ÿå°±æ˜¯ä»–ä»¬æ›´ç›¸ä¼¼ï¼‰ã€‚äº¤é€šæµå¯ä»¥ç”¨äºæ§åˆ¶æµé‡ä¿¡æ¯åœ¨åŒºåŸŸé—´çš„è½¬ç§»ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ª Flow Gating Mechanism (FGM)ï¼Œä»¥å±‚æ¬¡çš„æ–¹å¼å¯¹åŠ¨æ€ç©ºé—´ä¾èµ–å»ºæ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;ç±»ä¼¼å±€éƒ¨ CNNï¼Œæˆ‘ä»¬æ„å»ºäº†å±€éƒ¨ç©ºé—´æµé‡å›¾æ¥ä¿æŠ¤æµé‡çš„ç©ºé—´ä¾èµ–ã€‚ä¸€ä¸ªæ—¶æ®µå’Œä¸€ä¸ªåŒºåŸŸç›¸å…³çš„æµé‡åˆ†ä¸¤ç§ï¼Œæµå…¥å’Œæµå‡ºï¼Œä¸¤ä¸ªæµé‡çŸ©é˜µå¯ä»¥å¦‚ä¸Šæ„å»ºï¼Œæ¯ä¸ªå…ƒç´ è¡¨ç¤ºå¯¹åº”åŒºåŸŸçš„æµå…¥æµå‡ºæµé‡ã€‚å›¾1(c) ç»™äº†ä¸€ä¸ªæµå‡ºçŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªåŒºåŸŸ $i$ï¼Œæˆ‘ä»¬è·å¾—è¿‡å» $l$ ä¸ªæ—¶æ®µçš„ç›¸å…³çš„æµé‡ï¼ˆå³ä» $t-l+1$ åˆ° $t$ï¼‰ã€‚éœ€è¦çš„æµé‡çŸ©é˜µæ‹¼æ¥èµ·æ¥ï¼Œè¡¨ç¤ºä¸º $\mathbf{F}_{i,t} \in \mathbb{R}^{S \times S \times 2l}$ï¼Œ$2l$ æ˜¯æµé‡çŸ©é˜µçš„æ•°é‡ã€‚å› ä¸ºå †å çš„æµé‡çŸ©é˜µåŒ…å«äº†è¿‡å»ä¸åŒºåŸŸ $i$ ç›¸å…³çš„çŸ©é˜µï¼Œæˆ‘ä»¬ä½¿ç”¨ CNN å¯¹åŒºåŸŸé—´çš„ç©ºé—´æµé‡å…³ç³»å»ºæ¨¡ï¼Œå°† $\mathbf{F}_{i,t}$ ä½œä¸ºè¾“å…¥ $\mathbf{F}^{(0)}_{i,t}$ã€‚å¯¹äºæ¯å±‚ $k$ï¼Œå…¬å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{3}
\mathbf{F}^{(k)}\_{i,t} = \text{ReLU}(\mathbf{W}^{(k)}\_f \ast \mathbf{F}^{(k-1)}\_{i,t} + \mathbf{b}^{(k)}\_f),
$$&lt;p&gt;å…¶ä¸­ $\mathbf{W}^{(k)}_f$ å’Œ $\mathbf{b}^{(k)}_f$ æ˜¯å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ¯å±‚ï¼Œæˆ‘ä»¬ä½¿ç”¨æµé‡ä¿¡æ¯å¯¹åŒºåŸŸé—´çš„åŠ¨æ€ç›¸ä¼¼æ€§è¿›è¡Œæ•è·ï¼Œé€šè¿‡ä¸€ä¸ªæµé‡é—¨é™åˆ¶ç©ºé—´ä¿¡æ¯ã€‚ç‰¹åˆ«åœ°ï¼Œç©ºé—´è¡¨ç¤º $\mathbf{Y}^{i,k}_t$ ä½œä¸ºæ¯å±‚çš„è¾“å‡ºï¼Œå—æµé‡é—¨è°ƒæ•´ã€‚æˆ‘ä»¬é‡å†™å¼1ä¸ºï¼š&lt;/p&gt;
$$\tag{4}
\mathbf{Y}^{(k)}\_{i,t} = \text{ReLU}(\mathbf{W}^{(k)} \ast \mathbf{Y}^{(k-1)}\_{i,t} + \mathbf{b}^{(k)}) \otimes (\mathbf{F}^{i,k-1}\_t),
$$&lt;p&gt;$\otimes$ æ˜¯element-wise productã€‚&lt;/p&gt;
&lt;p&gt;$K$ ä¸ªé—¨æ§å·ç§¯å±‚åï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå…¨è¿æ¥å¾—åˆ°æµé‡é—¨æ§ç©ºé—´è¡¨ç¤º $\mathbf{y}_{i,t}$ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†å¼2ä¸­çš„ç©ºé—´è¡¨ç¤º $\mathbf{y}_{i,t}$ æ›¿æ¢ä¸º $\hat{\mathbf{y}}_{i,t}$ã€‚&lt;/p&gt;
&lt;h2 id="temporal-dynamic-similarity-periodically-shifted-attention-mechanism"&gt;Temporal Dynamic Similarity: Periodically Shifted Attention Mechanism
&lt;/h2&gt;&lt;p&gt;åœ¨ä¸Šé¢çš„å±€éƒ¨æ—¶ç©ºç½‘ç»œä¸­ï¼Œåªæœ‰å‰å‡ ä¸ªæ—¶æ®µç”¨äºé¢„æµ‹ã€‚ç„¶è€Œï¼Œè¿™ä¼šå¿½ç•¥é•¿æœŸä¾èµ–ï¼ˆå‘¨æœŸï¼‰ï¼Œä½†å‘¨æœŸåœ¨æ—¶ç©ºé¢„æµ‹é—®é¢˜ä¸­åˆå¾ˆé‡è¦ã€‚è¿™éƒ¨åˆ†æˆ‘ä»¬è€ƒè™‘é•¿æœŸä¾èµ–ã€‚&lt;/p&gt;
&lt;p&gt;è®­ç»ƒ LSTM æ¥å¤„ç†é•¿æœŸä¿¡æ¯ä¸æ˜¯ä¸€ä¸ªç®€å•çš„ä»»åŠ¡ï¼Œå› ä¸ºåºåˆ—é•¿åº¦çš„å¢åŠ å¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ï¼Œå› æ­¤ä¼šå‡å¼±å‘¨æœŸæ€§çš„å½±å“ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé¢„æµ‹ç›®æ ‡çš„ç›¸å¯¹æ—¶æ®µï¼ˆå³æ˜¨å¤©çš„è¿™ä¸ªæ—¶å€™ï¼Œå‰å¤©è¿™ä¸ªæ—¶å€™ï¼‰åº”è¯¥è¢«å»ºæ¨¡ã€‚ç„¶è€Œï¼Œå•çº¯åœ°èå…¥ç›¸å¯¹æ—¶æ®µæ˜¯ä¸å……åˆ†çš„ï¼Œä¼šå¿½ç•¥å‘¨æœŸçš„å¹³ç§»ï¼Œå³äº¤é€šæ•°æ®ä¸æ˜¯ä¸¥æ ¼å‘¨æœŸçš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‘¨æœ«çš„é«˜å³°é€šå¸¸å‘ç”Ÿåœ¨ä¸‹åˆçš„ååŠæ®µï¼Œä¸åŒçš„æ—¥å­æ—¶é—´ä¸ä¸€è‡´ï¼Œä»4:30pmåˆ°6:00pmå˜åŒ–ã€‚å‘¨æœŸçš„å¹³ç§»åœ¨äº¤é€šåºåˆ—ä¸­å¾ˆæ™®éï¼Œå› ä¸ºäº‹æ•…æˆ–å µå¡çš„å‘ç”Ÿã€‚å›¾ 2a å’Œ 2b åˆ†åˆ«æ˜¯ä¸åŒçš„å¤©å’Œå‘¨çš„æ—¶é—´å¹³ç§»çš„ä¾‹å­ã€‚è¿™ä¸¤ä¸ªæ—¶é—´åºåˆ—æ˜¯ä» NYC çš„å‡ºç§Ÿè½¦æ•°æ®ä¸­ç®—çš„ä» Javits Centerå‡ºå‘çš„æµé‡ã€‚æ˜¾ç„¶ï¼Œäº¤é€šåºåˆ—æ˜¯å‘¨æœŸæ€§çš„ï¼Œä½†æ˜¯è¿™äº›åºåˆ—çš„å³°å€¼ï¼ˆé€šè¿‡çº¢åœˆæ ‡è®°ï¼‰åœ¨ä¸åŒçš„æ—¥å­é‡Œæ—¶é—´ä¸ä¸€æ ·ã€‚æ­¤å¤–ï¼Œå¯¹æ¯”ä¸¤å¼ å›¾ï¼Œå‘¨æœŸæ€§ä¸æ˜¯ä¸¥æ ¼æŒ‰æ—¥æˆ–æŒ‰å‘¨çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ª Periodically Shifted Attention Mechanism (PSAM) æ¥è§£å†³é—®é¢˜ã€‚è¯¦ç»†çš„æ–¹æ³•å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¸“æ³¨äºè§£å†³æ—¥å‘¨æœŸçš„å¹³ç§»é—®é¢˜ã€‚å¦‚å›¾ 1(a) æ‰€ç¤ºï¼Œä»å‰ $P$ å¤©è·å¾—çš„ç›¸å¯¹æ—¶æ®µç”¨æ¥å¤„ç†å‘¨æœŸä¾èµ–ã€‚å¯¹äºæ¯å¤©ï¼Œä¸ºäº†è§£å†³æ—¶é—´å¹³ç§»é—®é¢˜ï¼Œæˆ‘ä»¬ä»æ¯å¤©ä¸­é¢å¤–çš„é€‰æ‹© $Q$ ä¸ªæ—¶æ®µã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœé¢„æµ‹çš„æ—¶é—´æ˜¯9:00-9:30pmï¼Œæˆ‘ä»¬é€‰ä¹‹å‰çš„ä¸€ä¸ªå°æ—¶å’Œä¹‹åçš„ä¸€ä¸ªå°æ—¶ï¼Œå³8:00-19:30pmï¼Œ$\vert Q \vert = 5$ã€‚è¿™äº›æ—¶æ®µ $q \in Q$ ç”¨æ¥è§£å†³æ½œåœ¨çš„æ—¶é—´å¹³ç§»é—®é¢˜ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä½¿ç”¨å¯¹æ¯å¤© $p \in P$ ä¿æŠ¤æ¯å¤©çš„åºåˆ—ä¿¡æ¯ï¼Œå…¬å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{5}
\mathbf{h}^{p,q}\_{i,t} = \text{LSTM}([\mathbf{y}^{p,q}\_{i,t}; \mathbf{e}^{p,q}\_{i,t}], \mathbf{h}^{p,q-1}\_{i,t}),
$$&lt;p&gt;å…¶ä¸­ï¼Œ$\mathbf{h}^{p,q}_{i,t}$ æ˜¯å¯¹äºåŒºåŸŸ $i$ çš„é¢„æµ‹æ—¶é—´ $t$ï¼Œæ—¶æ®µ $q$ åœ¨å‰ä¸€å¤© $p$ çš„è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç”¨äº†ä¸€ä¸ªæ³¨æ„åŠ›æœºåˆ¶æ•è·æ—¶é—´å¹³ç§»å¹¶ä¸”è·å¾—äº†å‰å‡ å¤©çš„æ¯ä¸€å¤©çš„ä¸€ä¸ªè¡¨ç¤ºã€‚å‰å‡ å¤©æ¯ä¸€å¤©çš„è¡¨ç¤º $\mathbf{h}^p_{i,t}$ æ˜¯æ—¶æ®µ $q$ æ¯ä¸€ä¸ªé€‰ä¸­æ—¶é—´çš„å¸¦æƒåŠ å’Œï¼Œå®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{6}
\mathbf{h}^p\_{i,t} = \sum\_{q \in Q} \alpha^{p,q}\_{i,t} \mathbf{h}^{p,q}\_{i,t},
$$&lt;p&gt;æƒé‡ $\alpha^{p,q}_{i,t}$ è¡¡é‡äº†åœ¨ $p \in P$ è¿™å¤©æ—¶æ®µ $q$ çš„é‡è¦æ€§ã€‚é‡è¦å€¼ $\alpha^{p,q}_{i,t}$ é€šè¿‡å¯¹æ¯”ä»çŸ­æœŸè®°å¿†ï¼ˆå¼2ï¼‰å¾—åˆ°çš„æ—¶ç©ºè¡¨ç¤ºå’Œå‰ä¸€ä¸ªéšè—çŠ¶æ€ $\mathbf{h}^{p,q}_{i,t}$ å¾—åˆ°ã€‚æƒé‡å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{7}
\alpha^{p,q}\_{i,t} = \frac{\text{exp}(\text{score}(\mathbf{h}^{p,q}\_{i,t}, \mathbf{h}\_{i,t}))} {\sum\_{q \in Q} \text{exp}(\text{score} (\mathbf{h}^{p,q}\_{i,t}, \mathbf{h}\_{i,t})}
$$&lt;p&gt;ç±»ä¼¼ (Luong, Pham and Manning 2015)ï¼Œæ³¨æ„åŠ›åˆ†æ•°çš„å®šä¹‰å¯ä»¥çœ‹ä½œæ˜¯åŸºäºå†…å®¹çš„å‡½æ•°ï¼š&lt;/p&gt;
$$\tag{8}
\text{score}(\mathbf{h}^{p,q}\_{i,t}, \mathbf{h}\_{i,t}) = \mathbf{v}^\text{T} \text{tanh} (\mathbf{W\_H} \mathbf{h}^{p,q}\_{i,t} + \mathbf{W\_X} \mathbf{h}\_{i,t} + \mathbf{b\_X}),
$$&lt;p&gt;å…¶ä¸­ï¼Œ$\mathbf{W_H}, \mathbf{W_X}, \mathbf{b_X}, \mathbf{v}$ æ˜¯å‚æ•°ï¼Œ$\mathbf{v}^\text{T}$ æ˜¯è½¬ç½®ã€‚å¯¹äºå‰é¢çš„æ¯ä¸€å¤© $p$ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªå‘¨æœŸè¡¨ç¤º $\mathbf{h}^p_{i,t}$ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨å¦ä¸€ä¸ª LSTM ç”¨è¿™äº›å‘¨æœŸè¡¨ç¤ºä½œä¸ºè¾“å…¥ï¼Œä¿å­˜åºåˆ—ä¿¡æ¯ï¼Œå³&lt;/p&gt;
$$\tag{9}
\hat{\mathbf{h}}^p\_{i,t} = \text{LSTM}(\mathbf{h}^p\_{i,t}, \hat{\mathbf{h}}^{p-1}\_{i,t}).
$$&lt;p&gt;æˆ‘ä»¬å°†æœ€åä¸€ä¸ªæ—¶æ®µçš„è¾“å‡º $\hat{\mathbf{h}}^P_{i,t}$ çœ‹ä½œæ˜¯æ—¶é—´åŠ¨æ€ç›¸ä¼¼åº¦çš„è¡¨ç¤ºï¼ˆå³é•¿æœŸå‘¨æœŸä¿¡æ¯ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id="joint-training"&gt;Joint Training
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬æ‹¼æ¥æŠŠçŸ­æœŸè¡¨ç¤º $\mathbf{h}_{i,t}$ å’Œ é•¿æœŸè¡¨ç¤º $\hat{\mathbf{h}}^P_{i,t}$ æ‹¼æ¥å¾—åˆ° $\mathbf{h}^c_{i,t}$ï¼Œå¯¹äºé¢„æµ‹åŒºåŸŸå’Œæ—¶é—´æ¥è¯´æ—¢ä¿ç•™äº†çŸ­æœŸä¾èµ–åˆä¿ç•™äº†é•¿æœŸä¾èµ–ã€‚æˆ‘ä»¬å°† $\mathbf{h}^c_{i,t}$ è¾“å…¥åˆ°å…¨è¿æ¥ä¸­ï¼Œè·å¾—æ¯ä¸ªåŒºåŸŸ $i$ æµå…¥å’Œæµå‡ºæµé‡çš„æœ€ç»ˆé¢„æµ‹å€¼ï¼Œåˆ†åˆ«è¡¨ç¤ºä¸º $y^i_{s,t+1}$ å’Œ $y^i_{e,t+1}$ã€‚æœ€ç»ˆé¢„æµ‹å‡½æ•°å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{10}
[y^i\_{s,t+1}, y^i\_{e,t+1}] = \text{tanh}(\mathbf{W}\_{fa} \mathbf{h}^c\_{i,t} + \mathbf{b}\_{fa}),
$$&lt;p&gt;å› ä¸ºæˆ‘ä»¬åšäº†å½’ä¸€åŒ–ï¼Œæ‰€ä»¥è¾“å‡ºçš„èŒƒå›´åœ¨ $(-1, 1)$ï¼Œè¾“å‡ºå€¼ä¼šæ˜ å°„å›éœ€æ±‚å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åŒæ—¶é¢„æµ‹å‡ºå‘å’Œåˆ°è¾¾æµé‡ï¼ŒæŸå¤±å‡½æ•°å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{11}
\mathcal{L} = \sum^n\_{i=1} \lambda (y^s\_{i,t+1} - \hat{y}^s\_{i, t+1})^2 + (1 - \lambda) (y^e\_{i,t+1} - \hat{y}^e\_{i, t+1})^2,
$$&lt;p&gt;$\lambda$ ç”¨æ¥å¹³è¡¡æµå…¥å’Œæµå‡ºçš„å½±å“ã€‚åŒºåŸŸ $i$ åœ¨æ—¶é—´ $t+1$ å®é™…çš„æµå…¥å’Œæµå‡ºæµé‡è¡¨ç¤ºä¸º $\hat{y}^s_{i, t+1}, \hat{y}^e_{i, t+1}$ã€‚&lt;/p&gt;
&lt;h1 id="experiment"&gt;Experiment
&lt;/h1&gt;&lt;h2 id="experiment-settings"&gt;Experiment Settings
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Datasets&lt;/strong&gt; æˆ‘ä»¬åœ¨ä¸¤ä¸ª NYC çš„å¤§å‹æ•°æ®é›†ä¸Šè¯„ä»·äº†æ¨¡å‹ã€‚æ¯ä¸ªæ•°æ®é›†åŒ…å«æ—…è¡Œè®°å½•ï¼Œè¯¦æƒ…å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;NYC-Taxiï¼š2015 å¹´ 22349490 ä¸ªå‡ºç§Ÿè½¦çš„æ—…è¡Œè®°å½•ï¼Œä» 2015å¹´1æœˆ1æ—¥åˆ°2015å¹´3æœˆ1æ—¥ã€‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨1æœˆ1æ—¥åˆ°2æœˆ10æ—¥ä½œä¸ºè®­ç»ƒï¼Œå‰©ä¸‹20å¤©æµ‹è¯•ã€‚&lt;/li&gt;
&lt;li&gt;NYC-Bikeï¼š2016 å¹´ NYC è‡ªè¡Œè½¦è½¨è¿¹æ•°æ®ï¼Œ7æœˆ1æ—¥åˆ°8æœˆ29æ—¥ï¼ŒåŒ…å«äº† 2605648 æ¡è®°å½•ã€‚å‰ 40 å¤©ç”¨æ¥è®­ç»ƒï¼Œå 20 å¤©åšæµ‹è¯•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Preprocessing&lt;/strong&gt; æˆ‘ä»¬å°†æ•´ä¸ªåŸå¸‚åˆ†æˆ $10 \times 20$ ä¸ªåŒºåŸŸã€‚æ¯ä¸ªåŒºåŸŸå¤§å°æ˜¯ $1km \times 1km$ã€‚æ—¶æ®µé•¿åº¦è®¾ä¸º 30minã€‚ä½¿ç”¨æœ€å¤§æœ€å°å½’ä¸€åŒ– volume å’Œ flow åˆ° $[0, 1]$ã€‚é¢„æµ‹åï¼Œä½¿ç”¨é€†å˜æ¢åçš„å€¼è¯„ä»·ã€‚æˆ‘ä»¬ä½¿ç”¨æ»‘åŠ¨çª—é‡‡æ ·ã€‚æµ‹è¯•æ¨¡å‹çš„æ—¶å€™ï¼Œæ»¤æ‰ volumn å°äº 10 çš„æ ·æœ¬ï¼Œè¿™æ˜¯å·¥ä¸šç•Œå’Œå­¦ç•Œå¸¸ç”¨çš„æŠ€å·§ (Yao et al. 2018)ã€‚å› ä¸ºçœŸå®æ•°æ®é›†ä¸­ï¼Œå…³æ³¨è¾ƒå°çš„äº¤é€šæ•°æ®æ²¡æœ‰å¤ªå¤§çš„æ„ä¹‰ã€‚æˆ‘ä»¬é€‰æ‹© 80% çš„æ•°æ®è®­ç»ƒï¼Œ20% éªŒè¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Evaluation Metric &amp;amp; Baselines&lt;/strong&gt; ä¸¤ä¸ªæŒ‡æ ‡ï¼šMAPE, RMSEã€‚baselinesï¼šHA, ARIMA, Ridge, Lin-UOTD (Tong el al. 2017), XGBoost, MLP, ConvLSTM, DeepSD, ST-ResNet, DMVST-Netã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hyperparameter Settings&lt;/strong&gt; æˆ‘ä»¬åŸºäºéªŒè¯é›†è®¾å®šè¶…å‚æ•°ã€‚å¯¹äºç©ºé—´ä¿¡æ¯ï¼Œ64 ä¸ªå·ç§¯æ ¸ï¼Œ$3 \times 3$ å¤§å°ã€‚æ¯ä¸ªé‚»å±…çš„å¤§å°è®¾å®šä¸º $7 \times 7$ã€‚å±‚æ•° $K = 3$ï¼Œå¯¹äº flow è€ƒè™‘çš„æ—¶é—´è·¨åº¦ $l = 2$ã€‚æ—¶é—´ä¿¡æ¯ï¼ŒçŸ­æœŸ LSTM é•¿åº¦ä¸º 7ï¼Œé•¿æœŸå‘¨æœŸä¿¡æ¯ $\vert P \vert = 3$ï¼Œå‘¨æœŸå¹³ç§»æ³¨æ„åŠ›æœºåˆ¶ $\vert Q \vert = 3$ï¼ŒLSTM ä¸­éšè—è¡¨ç¤ºçš„ç»´åº¦æ˜¯ 128ã€‚STDN é€šè¿‡ Adam ä¼˜åŒ–ï¼Œbatch size 64ï¼Œå­¦ä¹ ç‡ 0.001ã€‚LSTM ä¸­çš„ dropout 0.5ã€‚$\lambda$ å– 0.5ã€‚&lt;/p&gt;
&lt;h2 id="results"&gt;Results
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;PerformanceComparison&lt;/strong&gt; è¡¨ 1 å±•ç¤ºäº†æˆ‘ä»¬çš„æ–¹æ³•å¯¹æ¯”å…¶ä»–æ–¹æ³•åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šçš„ç»“æœã€‚æˆ‘ä»¬è·‘æ¯ä¸ª baseline 10æ¬¡ï¼Œå–äº†å¹³å‡å’Œæ ‡å‡†å·®ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿåšäº† t æ£€éªŒã€‚æˆ‘ä»¬çš„æ–¹æ³•åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸ŠæŒ‡æ ‡éƒ½å¾ˆå¥½ã€‚&lt;/p&gt;</description></item><item><title>Deep Spatio-Temporal Residual Networks for Citywide Crowd Flows Prediction</title><link>https://davidham3.github.io/blog/p/deep-spatio-temporal-residual-networks-for-citywide-crowd-flows-prediction/</link><pubDate>Fri, 08 Mar 2019 10:26:16 +0000</pubDate><guid>https://davidham3.github.io/blog/p/deep-spatio-temporal-residual-networks-for-citywide-crowd-flows-prediction/</guid><description>&lt;p&gt;AAAI 2017, ST-ResNetï¼Œç½‘æ ¼æµé‡é¢„æµ‹ï¼Œç”¨ä¸‰ä¸ªç›¸åŒç»“æ„çš„æ®‹å·®å·ç§¯ç¥ç»ç½‘ç»œå¯¹è¿‘é‚»æ—¶é—´ã€å‘¨æœŸã€è¶‹åŠ¿ï¼ˆè¿œæœŸï¼‰åˆ†åˆ«å»ºæ¨¡ã€‚ä¸ RNN ç›¸æ¯”ï¼ŒRNN æ— æ³•å¤„ç†åºåˆ—é•¿åº¦è¿‡å¤§çš„åºåˆ—ã€‚ä¸‰ç»„ä»¶çš„è¾“å‡ºç»“æœè¿›è¡Œé›†æˆï¼Œç„¶åå’Œå¤–éƒ¨å› ç´ é›†æˆï¼Œå¾—åˆ°é¢„æµ‹ç»“æœã€‚åŸæ–‡åœ°å€ï¼š&lt;a class="link" href="https://arxiv.org/abs/1610.00081" target="_blank" rel="noopener"
&gt;Deep Spatio-Temporal Residual Networks for Citywide Crowd Flows Prediction&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;å¯¹äºäº¤é€šç®¡ç†å’Œå…¬å…±å®‰å…¨æ¥è¯´ï¼Œé¢„æµ‹äººæµå¾ˆé‡è¦ï¼Œä½†è¿™ä¸ªé—®é¢˜ä¹Ÿå¾ˆæœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºæ”¶åˆ°å¾ˆå¤šå¤æ‚çš„å› ç´ å½±å“ï¼Œå¦‚åŒºåŸŸå†…çš„äº¤é€šã€äº‹ä»¶ã€å¤©æ°”ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªåŸºäºæ·±åº¦å­¦ä¹ çš„æ¨¡å‹ ST-ResNetï¼Œå¯¹åŸå¸‚å†…çš„æ¯ä¸ªåŒºåŸŸçš„äººæµçš„è¿›å‡ºä¸€èµ·é¢„æµ‹ã€‚æˆ‘ä»¬åŸºäºæ—¶ç©ºæ•°æ®ç‹¬ä¸€çš„å±æ€§ï¼Œè®¾è®¡äº†ä¸€ä¸ªç«¯åˆ°ç«¯çš„ç»“æ„ã€‚æˆ‘ä»¬ä½¿ç”¨æ®‹å·®ç¥ç»ç½‘ç»œæ¡†æ¶å¯¹æ—¶é—´è¿‘é‚»ã€å‘¨æœŸã€è¶‹åŠ¿å±æ€§å»ºæ¨¡ã€‚å¯¹æ¯ä¸ªå±æ€§ï¼Œæˆ‘ä»¬è®¾è®¡äº†æ®‹å·®å·ç§¯çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œæ¯ä¸ªåˆ†æ”¯å¯¹äººæµçš„ç©ºé—´å±æ€§å»ºæ¨¡ã€‚ST-ResNet åŸºäºæ•°æ®åŠ¨æ€åœ°èšåˆä¸‰ä¸ªæ®‹å·®ç¥ç»ç½‘ç»œçš„è¾“å‡ºï¼Œç»™ä¸åŒçš„åˆ†æ”¯å’ŒåŒºåŸŸåˆ†é…æƒé‡ã€‚èšåˆç»“æœè¿˜èåˆäº†å¤–éƒ¨å› ç´ ï¼Œåƒå¤©æ°”æˆ–æ—¥æœŸã€‚å®éªŒåœ¨åŒ—äº¬å’Œçº½çº¦ä¸¤ä¸ªæ•°æ®é›†ä¸Šå¼€å±•ã€‚&lt;/p&gt;
&lt;h1 id="introduction"&gt;Introduction
&lt;/h1&gt;&lt;p&gt;å¯¹äºäº¤é€šç®¡ç†å’Œå…¬å…±å®‰å…¨æ¥è¯´ï¼Œé¢„æµ‹äººæµå¾ˆé‡è¦ï¼ˆZheng et al. 2014ï¼‰ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œ2015å¹´æ–°å¹´å¤œï¼Œä¸Šæµ·æœ‰å¤§é‡äººç¾¤æ¶Œå…¥ä¸€ä¸ªåŒºåŸŸï¼Œå¯¼è‡´ 36 äººæ­»äº¡ã€‚2016å¹´å…­æœˆä¸­æ—¬ï¼Œæ•°ç™¾å Pokemon Go ç©å®¶å†²å…¥çº½çº¦ä¸­å¤®å…¬å›­ï¼Œä¸ºäº†æŠ“ä¸€åªç‰¹åˆ«ç¨€æœ‰çš„æ€ªï¼Œå¯¼è‡´ä¸¥é‡çš„è¸©è¸äº‹æ•…ã€‚å¦‚æœå¯ä»¥é¢„æµ‹ä¸€ä¸ªåŒºåŸŸçš„äººæµï¼Œè¿™æ ·çš„æ‚²å‰§å¯ä»¥é€šè¿‡åº”æ€¥æªæ–½é¿å…ï¼Œåƒæå‰åšäº¤é€šç®¡æ§ï¼Œå‘å¸ƒé¢„è­¦ï¼Œç–æ•£äººç¾¤ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨è¿™ç¯‡æ–‡ç« ä¸­é¢„æµ‹ä¸¤ç±»äººæµï¼ˆZhang et al. 2016)ï¼šå¦‚å›¾ 1ï¼ˆaï¼‰æ‰€ç¤ºï¼Œæµå…¥å’Œæµå‡ºã€‚æµå…¥æ˜¯åœ¨ç»™å®šæ—¶é—´æ®µï¼Œä»å…¶ä»–åŒºåŸŸè¿›å…¥åˆ°ä¸€ä¸ªåŒºåŸŸçš„äº¤é€šè¿è½½é‡ã€‚æµå‡ºè¡¨ç¤ºç»™å®šæ—¶æ®µå†…ï¼Œä»ä¸€ä¸ªåŒºåŸŸå‘å…¶ä»–åŒºåŸŸçš„äº¤é€šè¿è½½é‡ã€‚ä¸¤ä¸ªæµé‡éƒ½æ˜¯åŒºåŸŸé—´çš„äººå£æµåŠ¨ã€‚äº†è§£è¿™ä¸ªå¯¹é£é™©è¯„ä¼°å’Œäº¤é€šç®¡ç†æœ‰å¾ˆå¤§å¸®åŠ©ã€‚æµå…¥/æµå‡ºå¯ä»¥é€šè¿‡è¡Œäººæ•°é‡ã€é‚»è¿‘é“è·¯è½¦è¾†æ•°ã€å…¬å…±è¿è¾“ç³»ç»Ÿçš„äººæ•°ã€æˆ–æ˜¯æ‰€æœ‰çš„éƒ½åŠ èµ·æ¥ã€‚å›¾ 1ï¼ˆbï¼‰å±•ç¤ºäº†ä¸€ä¸ªä¾‹å­ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ‰‹æœºä¿¡å·æµ‹é‡è¡Œäººæ•°ï¼Œ$r_2$ çš„æµå…¥å’Œæµå‡ºåˆ†åˆ«ä¸º 3 å’Œ 1ã€‚ç±»ä¼¼åœ°ï¼Œä½¿ç”¨è½¦è¾† GPS è½¨è¿¹ï¼Œåˆ†åˆ«æ˜¯ 0 å’Œ 3ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deep-spatio-temporal-residual-networks-for-citywide-crowd-flows-prediction/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼ŒåŒæ—¶é¢„æµ‹åŸå¸‚æ¯ä¸ªåŒºåŸŸäººå£çš„æµå…¥å’Œæµå‡ºæ˜¯å¾ˆæœ‰éš¾åº¦çš„ï¼Œæœ‰ 3 ä¸ªå¤æ‚çš„å› ç´ ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç©ºé—´ä¾èµ–ã€‚åŒºåŸŸ $r_2$ çš„æµå…¥ï¼ˆå›¾1ï¼ˆaï¼‰ï¼‰å—é‚»è¿‘åŒºåŸŸï¼ˆåƒ $r_1$ï¼‰å’Œé¥è¿œåŒºåŸŸæµå‡ºçš„å½±å“ã€‚$r_2$ çš„æµå‡ºä¹Ÿå—å…¶ä»–åŒºåŸŸï¼ˆ$r_3$ï¼‰æµå…¥çš„å½±å“ã€‚$r_2$ çš„æµå…¥ä¹Ÿå½±å“å…¶è‡ªèº«ã€‚&lt;/li&gt;
&lt;li&gt;æ—¶é—´ä¾èµ–ã€‚ä¸€ä¸ªåŒºåŸŸçš„äººæµå—åˆ°è¿‘æœŸå’Œè¿œæœŸæ—¶é—´å½±å“ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ—©ä¸Š8ç‚¹å‘ç”Ÿçš„äº¤é€šæ‹¥å µå¯èƒ½ä¼šå½±å“åˆ° 9 ç‚¹ã€‚æ­¤å¤–ï¼Œæ—©é«˜å³°çš„äº¤é€šçŠ¶å†µå¯èƒ½åœ¨æ¥è¿çš„å‡ å¤©éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œæ¯ 24 å°æ—¶ä¸€æ¬¡ã€‚è€Œä¸”éšç€å†¬å¤©çš„åˆ°æ¥ï¼Œæ—©é«˜å³°æ—¶é—´å¯èƒ½è¶Šæ¥è¶Šæ™šã€‚æ¸©åº¦ä¸‹é™ï¼Œæ—¥åˆå˜æ™šä¼šä½¿äººä»¬èµ·åºŠæ—¶é—´å˜æ™šã€‚&lt;/li&gt;
&lt;li&gt;å¤–éƒ¨å½±å“ã€‚ä¸€äº›åƒå¤©æ°”å’Œäº‹ä»¶çš„å¤–éƒ¨å› ç´ å¯èƒ½ä¼šæ˜¾è‘—åœ°æ”¹å˜åŸå¸‚å†…ä¸åŒåŒºåŸŸçš„äººå£æµåŠ¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ·±åº¦æ·±ç©ºæ®‹å·®ç½‘ç»œ (ST-ResNet) å¯¹æ¯ä¸ªåŒºåŸŸçš„æµå…¥å’Œæµå‡ºåŒæ—¶é¢„æµ‹ã€‚æˆ‘ä»¬çš„è´¡çŒ®æœ‰ 4 ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ST-ResNet ä½¿ç”¨åŸºäºå·ç§¯çš„æ®‹å·®ç¥ç»ç½‘ç»œå¯¹åŸå¸‚å†…ä¸¤ä¸ªé‚»è¿‘çš„å’Œé¥è¿œçš„åŒºåŸŸçš„ç©ºé—´ä¾èµ–å»ºæ¨¡ï¼ŒåŒæ—¶è¿˜ç¡®ä¿¡äº†æ¨¡å‹çš„é¢„æµ‹ç²¾åº¦ä¸ä¼šå› ä¸ºæ¨¡å‹çš„æ·±åº¦å¢åŠ è€Œé™ä½ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬å°†äººå£æµåŠ¨çš„æ—¶é—´å±æ€§åˆ†ä¸ºä¸‰ç§ï¼Œæ—¶é—´è¿‘é‚»ã€å‘¨æœŸã€è¶‹åŠ¿ã€‚ST-ResNet ä½¿ç”¨ä¸‰ä¸ªæ®‹å·®ç½‘ç»œå¯¹è¿™äº›å±æ€§å»ºæ¨¡ã€‚&lt;/li&gt;
&lt;li&gt;ST-ResNet åŠ¨æ€åœ°èšåˆä¸‰ä¸ªä¸Šè¿°ç½‘ç»œçš„è¾“å‡ºï¼Œç»™ä¸åŒçš„åˆ†æ”¯å’ŒåŒºåŸŸåˆ†é…æƒé‡ã€‚èšåˆè¿˜èåˆäº†å¤–éƒ¨å› ç´ ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬ä½¿ç”¨åŒ—äº¬å‡ºç§Ÿè½¦çš„è½¨è¿¹æ•°æ®å’Œæ°”è±¡æ•°æ®ï¼Œçº½çº¦è‡ªè¡Œè½¦è½¨è¿¹æ•°æ®ã€‚ç»“æœè¡¨ç¤ºæˆ‘ä»¬çš„æ–¹æ³•æ¯” 6 ä¸ª baseline éƒ½å¥½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="preliminaries"&gt;Preliminaries
&lt;/h1&gt;&lt;p&gt;ç®€è¦å›é¡¾äººæµé¢„æµ‹é—®é¢˜ï¼ˆZhang el al. 2016; Hoang, Zheng, and Singh 2016ï¼‰ï¼Œä»‹ç»æ®‹å·®å­¦ä¹ ï¼ˆHe et al. 2016ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id="formulation-of-crowd-flows-problem"&gt;Formulation of Crowd Flows Problem
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Definition 1(Region (Zhang et al. 2016))&lt;/strong&gt; æ ¹æ®ä¸åŒç²’åº¦çº§å’Œè¯­ä¹‰ï¼Œä¸€ä¸ªåœ°ç‚¹çš„å®šä¹‰æœ‰å¾ˆå¤šã€‚æˆ‘ä»¬æ ¹æ®ç»çº¬åº¦å°†åŸå¸‚åˆ’åˆ†æˆ $I \times J$ ä¸ªç½‘æ ¼ï¼Œä¸€ä¸ªç½‘æ ¼è¡¨ç¤ºä¸€ä¸ªåŒºåŸŸï¼Œå¦‚å›¾ 2(a)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deep-spatio-temporal-residual-networks-for-citywide-crowd-flows-prediction/Fig2.JPG"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;**Definition 2(Inflow/outflow (Zhang et al. 2016)) $\mathbb{P}$ æ˜¯ç¬¬ t æ—¶æ®µçš„è½¨è¿¹é›†åˆã€‚å¯¹äºç¬¬ $i$ è¡Œç¬¬ $j$ åˆ—çš„ç½‘æ ¼ï¼Œæ—¶æ®µ $t$ æµå…¥å’Œæµå‡ºçš„äººæµåˆ†åˆ«å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$
x^{in,i,j}\_t = \sum\_{T\_r \in \mathbb{P}} \vert \lbrace k &gt; 1 \mid g\_{k-1} \not \in (i, j) \wedge g\_k \in (i,j) \rbrace \vert
\\
x^{out,i,j}\_t = \sum\_{T\_r \in \mathbb{P}} \vert \lbrace k \geq 1 \mid g\_k \in (i,j) \wedge g\_{k+1} \not \in (i,j) \rbrace \vert
$$&lt;p&gt;å…¶ä¸­ $T_r: g_1 \rightarrow g_2 \rightarrow \cdots \rightarrow g_{\vert T_r \vert}$ æ˜¯ $\mathbb{P}$ ä¸­çš„è½¨è¿¹ï¼Œ$g_k$ æ˜¯åœ°ç†åæ ‡ï¼›$g_k \in (i,j)$ è¡¨ç¤ºç‚¹ $g_k$ è½åœ¨ $(i, j)$ å†…ï¼›$\vert Â· \vert$ è¡¨ç¤ºé›†åˆåŸºæ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ—¶æ®µ $t$ ï¼Œæ‰€æœ‰åŒºåŸŸçš„æµå…¥å’Œæµå‡ºå¯ä»¥è¡¨ç¤ºæˆ $\mathbf{X}_t \in \mathbb{R}^{2 \times I \times J}$ï¼Œ$(\mathbf{X}_t)_{0,i,j}=x^{in,i,j}_t, (\mathbf{X}_t)_{1,i,j} = x^{out,i,j}_t$ã€‚æµå…¥çŸ©é˜µå¦‚å›¾2(b)ã€‚&lt;/p&gt;
&lt;p&gt;ç©ºé—´åŒºåŸŸå¯ä»¥è¡¨è¾¾æˆä¸€ä¸ª $I \times J$ çš„åŒºåŸŸï¼Œæœ‰ä¸¤ç±»æµåŠ¨ï¼Œæ‰€ä»¥è§‚æµ‹å€¼å¯ä»¥è¡¨ç¤ºä¸º $\mathbf{X} \in \mathbb{R}^{2 \times I \times J}$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Problem 1&lt;/strong&gt; ç»™å®šå†å²è§‚æµ‹å€¼ $\lbrace \mathbf{X}_t \mid t = 0,\dots,n-1 \rbrace$ï¼Œé¢„æµ‹ $\mathbf{X}_n$ã€‚&lt;/p&gt;
&lt;h2 id="deep-residual-learning"&gt;Deep Residual Learning
&lt;/h2&gt;$$\tag{1}
\mathbf{X}^{(l+1)} = \mathbf{X}^{(l)} + \mathcal{F}(\mathbf{X}^{(l)})
$$&lt;h1 id="deep-spatio-temporal-residual-networks"&gt;Deep Spatio-Temporal Residual Networks
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deep-spatio-temporal-residual-networks-for-citywide-crowd-flows-prediction/Fig3.JPG"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;å›¾ 3 å±•ç¤ºäº† ST-ResNetçš„æ¶æ„ï¼Œ4 ä¸ªéƒ¨åˆ†åˆ†åˆ«å¯¹æ—¶é—´è¿‘é‚»ã€å‘¨æœŸã€è¿œæœŸã€å¤–éƒ¨å› ç´ å»ºæ¨¡ã€‚å¦‚å›¾ 3 æ‰€ç¤ºï¼Œé¦–å…ˆå°†æµå…¥å’Œæµå‡ºä½œä¸ºä¸¤ä¸ªé€šé“æ”¾åˆ°çŸ©é˜µä¸­ï¼Œä½¿ç”¨å®šä¹‰ 1 å’Œ 2 å¼•å…¥çš„æ–¹æ³•ã€‚æˆ‘ä»¬å°†æ—¶é—´è½´åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œè¡¨ç¤ºè¿‘æœŸæ—¶é—´ã€é‚»è¿‘å†å²ã€è¿œæœŸå†å²ã€‚ä¸‰ä¸ªæ—¶æ®µçš„ä¸¤é€šé“çš„æµåŠ¨çŸ©é˜µåˆ†åˆ«è¾“å…¥ä¸Šè¿°æ¨¡å‹ï¼Œå¯¹ä¸‰ç§æ—¶é—´å±æ€§å»ºæ¨¡ã€‚è¿™ä¸‰ä¸ªç»„ä»¶ç»“æ„ç›¸åŒï¼Œéƒ½æ˜¯æ®‹å·®ç½‘ç»œã€‚è¿™æ ·çš„ç»“æ„æ•è·é‚»è¿‘å’Œé¥è¿œåŒºåŸŸé—´çš„ç©ºé—´ä¾èµ–ã€‚å¤–éƒ¨ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬æ‰‹åŠ¨çš„ä»æ•°æ®é›†ä¸­æå–äº†ç‰¹å¾ï¼Œå¦‚å¤©æ°”ã€äº‹ä»¶ç­‰ï¼Œæ”¾å…¥ä¸¤å±‚å…¨è¿æ¥ç¥ç»ç½‘ç»œä¸­ã€‚å‰ä¸‰ä¸ªç»„ä»¶çš„è¾“å‡ºåŸºäºå‚æ•°çŸ©é˜µèåˆä¸º $\mathbf{X}_{Res}$ï¼Œå‚æ•°çŸ©é˜µç»™ä¸åŒçš„åŒºåŸŸä¸åŒçš„ç»„ä»¶åˆ†é…æƒé‡ã€‚$\mathbf{X}_{Res}$ ç„¶åä¸å¤–éƒ¨ç»„ä»¶ $\mathbf{X}_{Ext}$ é›†æˆã€‚æœ€åï¼Œèšåˆç»“æœé€šè¿‡ Tanh æ˜ å°„åˆ° $[-1, 1]$ï¼Œåœ¨åå‘ä¼ æ’­ä¼šæ¯” logistic function æ”¶æ•›çš„æ›´å¿« (LeCun et al. 2012)ã€‚&lt;/p&gt;
&lt;h2 id="structures-of-the-first-three-components"&gt;Structures of the First Three Components
&lt;/h2&gt;&lt;p&gt;å¦‚å›¾ 4ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deep-spatio-temporal-residual-networks-for-citywide-crowd-flows-prediction/Fig4.JPG"
loading="lazy"
alt="Figure4"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Convolution&lt;/strong&gt;&lt;/em&gt; ä¸€ä¸ªåŸå¸‚é€šå¸¸å¾ˆå¤§ï¼ŒåŒ…å«å¾ˆå¤šè·ç¦»ä¸åŒçš„åŒºåŸŸã€‚ç›´è§‚ä¸Šæ¥è¯´ï¼Œé‚»è¿‘åŒºåŸŸçš„äººæµä¼šå½±å“å…¶ä»–åŒºåŸŸï¼Œå¯ä»¥é€šè¿‡ CNN æœ‰æ•ˆåœ°å¤„ç†ï¼ŒCNN ä¹Ÿè¢«è¯æ˜åœ¨å±‚çº§åœ°æ•è·ç©ºé—´ä¿¡æ¯æ–¹é¢å¾ˆå¼º (LeCun et al. 1998)ã€‚è€Œä¸”ï¼Œå¦‚æœä¸¤ä¸ªé¥è¿œåœ°æ–¹é€šè¿‡åœ°é“æˆ–é«˜é€Ÿå…¬è·¯è¿æ¥ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªåŒºåŸŸé—´å°±æœ‰ä¾èµ–å…³ç³»ã€‚ä¸ºäº†æ•è·ä»»ä½•åŒºåŸŸçš„ç©ºé—´ä¾èµ–ï¼Œæˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ä¸ªå¾ˆå¤šå±‚çš„ CNN æ¨¡å‹ï¼Œå› ä¸ºä¸€ä¸ªå·ç§¯å±‚åªè€ƒè™‘ç©ºé—´è¿‘é‚»ï¼Œå—é™äºå®ƒå·ç§¯æ ¸çš„å¤§å°ã€‚åŒæ ·çš„é—®é¢˜åœ¨è§†é¢‘åºåˆ—ç”Ÿæˆä»»åŠ¡ä¸­ä¹Ÿæœ‰ï¼Œå½“è¾“å…¥å’Œè¾“å‡ºæœ‰åŒæ ·çš„åˆ†è¾¨ç‡çš„æ—¶å€™(Mathieu, Couprie, and LeCun 2015)ã€‚ä¸ºäº†é¿å…ä¸‹é‡‡æ ·å¯¼è‡´çš„åˆ†è¾¨ç‡æŸå¤±å¼•å…¥äº†å‡ ç§æ–¹æ³•ï¼ŒåŒæ—¶è¿˜ä¿æŒé¥è¿œçš„ä¾èµ–å…³ç³»(Long, Shelhamer, and Darrell 2015)ã€‚ä¸ä¼ ç»Ÿçš„ CNN ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ä¸‹é‡‡æ ·ï¼Œè€Œæ˜¯åªä½¿ç”¨å·ç§¯ (Jain et al. 2007)ã€‚å¦‚å›¾ 4(a)ï¼Œå›¾ä¸­æœ‰ 3 ä¸ªå¤šçº§çš„ feature mapï¼Œé€šè¿‡ä¸€äº›å·ç§¯æ“ä½œç›¸è¿ã€‚ä¸€ä¸ªé«˜å±‚æ¬¡çš„ç»“ç‚¹ä¾èµ–äº 9 ä¸ªä¸­é—´å±‚æ¬¡çš„ç»“ç‚¹ï¼Œè¿™äº›åˆä¾èµ–äºä½å±‚æ¬¡çš„æ‰€æœ‰ç»“ç‚¹ã€‚è¿™æ„å‘³ç€ä¸€ä¸ªå·ç§¯å¯ä»¥å¾ˆè‡ªç„¶åœ°æ•è·ç©ºé—´è¿‘é‚»ä¾èµ–ï¼Œå †å å·ç§¯å¯ä»¥æ›´å¤šåœ°æ•è·é¥è¿œçš„ç©ºé—´ä¾èµ–ã€‚&lt;/p&gt;
&lt;p&gt;å›¾ 3 çš„è¿‘é‚»ç»„ä»¶ä½¿ç”¨äº†ä¸€äº› 2 é€šé“æµåŠ¨çŸ©é˜µå¯¹è¿‘é‚»æ—¶é—´ä¾èµ–å»ºæ¨¡ã€‚ä»¤æœ€è¿‘çš„éƒ¨åˆ†ä¸º $[\mathbf{X}_{t-l_c}, \mathbf{X}_{t-(l_c-1)}, \dots, \mathbf{X}_{t-1}]$ï¼Œä¹Ÿç§°ä¸ºè¿‘é‚»ä¾èµ–åºåˆ—ã€‚æˆ‘ä»¬å°†ä»–ä»¬æ²¿ç¬¬ä¸€ä¸ªè½´ï¼ˆæ—¶é—´ï¼‰æ‹¼æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå¼ é‡ $\mathbf{X}^{(0)}_c \in \mathbb{R}^{2l_c \times I \times J}$ï¼Œç„¶åä½¿ç”¨å·ç§¯ï¼ˆå›¾ 3 ä¸­çš„ Conv1ï¼‰ï¼š&lt;/p&gt;
$$\tag{2}
\mathbf{X}^{(1)}\_c = f(W^{(1)}\_c \ast \mathbf{X}^{(0)}\_c + b^{(1)}\_c)
$$&lt;p&gt;å…¶ä¸­ $\ast$ è¡¨ç¤ºå·ç§¯ï¼›$f$ æ˜¯æ¿€æ´»å‡½æ•°ï¼›$W^{(1)}_c, b^{(1)}_c$ æ˜¯å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Residual Unit.&lt;/strong&gt;&lt;/em&gt; å°½ç®¡æœ‰ ReLU èŒä¸šé‚£ä¸ªçš„æ¿€æ´»å‡½æ•°å’Œæ­£åˆ™åŒ–æŠ€å·§ï¼Œæ·±åº¦å·ç§¯ç½‘ç»œåœ¨è®­ç»ƒä¸Šè¿˜æ˜¯å¾ˆéš¾ã€‚ä½†æˆ‘ä»¬ä»ç„¶éœ€è¦æ·±åº¦ç¥ç»ç½‘ç»œæ•è·éå¸¸å¤§èŒƒå›´çš„ä¾èµ–ã€‚å¯¹äºå…¸å‹çš„æµé‡æ•°æ®ï¼Œå‡è®¾è¾“å…¥å¤§å°æ˜¯ $32 \times 32$ï¼Œå·ç§¯æ ¸å¤§å°æ˜¯ $3 \times 3$ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å¯¹åŸå¸‚èŒƒå›´çš„ä¾èµ–å»ºæ¨¡ï¼Œè‡³å°‘éœ€è¦è¿ç»­ 15 ä¸ªå·ç§¯å±‚ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨æ®‹å·®å­¦ä¹ (He et al. 2015)ï¼Œåœ¨è®­ç»ƒè¶…è¿‡ 1000 å±‚çš„ç½‘ç»œæ—¶å¾ˆæœ‰æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çš„ ST-ResNet(å¦‚å›¾ 3)ï¼Œæˆ‘ä»¬åœ¨ Conv1 ä¸Šå †å  $L$ ä¸ªæ®‹å·®å•å…ƒå¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{3}
\mathbf{X}^{(l+1)}\_c = \mathbf{X}^{(l)}\_c + \mathcal{F}(\mathbf{X}^{(l)}\_c; \theta^{(l)}\_c), l = 1, \dots, L
$$&lt;p&gt;$\mathcal{F}$ æ˜¯æ®‹å·®å‡½æ•°ï¼Œå³ ReLU + Convolutionï¼Œå¦‚å›¾ 4(b)ã€‚æˆ‘ä»¬è¿˜åœ¨ ReLU ä¹‹å‰åŠ äº† &lt;em&gt;Batch Normalization&lt;/em&gt;ã€‚åœ¨ç¬¬ $L$ ä¸ªæ®‹å·®å•å…ƒå‰ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå·ç§¯å±‚ï¼Œå›¾ 3 ä¸­çš„ Conv2ã€‚2 ä¸ªå·ç§¯å’Œ $L$ ä¸ªæ®‹å·®å•å…ƒï¼Œå›¾ 3 ä¸­çš„è¿‘é‚»ç»„ä»¶çš„è¾“å‡ºæ˜¯ $\mathbf{X}^{(l+2)}_c$ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ ·çš„ï¼Œä½¿ç”¨ä¸Šé¢çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥æ„å»º &lt;em&gt;å‘¨æœŸ&lt;/em&gt; å’Œ &lt;em&gt;è¶‹åŠ¿&lt;/em&gt; ç»„ä»¶ï¼Œå¦‚å›¾ 3ã€‚å‡è®¾æ—¶æ®µ $p$ æœ‰ $l_p$ ä¸ªæ—¶é—´é—´éš”ã€‚é‚£ä¹ˆ &lt;em&gt;æ—¶æ®µ&lt;/em&gt; ä¾èµ–åºåˆ—æ˜¯ $[\mathbf{X}_{t-l_p \cdot p}, \mathbf{X}_{t-(l_p - 1) \cdot p}, \dots, \mathbf{X}_{t-p}]$ã€‚ä½¿ç”¨å¼ 2 å’Œ å¼ 3 é‚£æ ·çš„å·ç§¯å’Œ $L$ ä¸ªæ®‹å·®å•å…ƒï¼Œ&lt;em&gt;å‘¨æœŸ&lt;/em&gt; ç»„ä»¶çš„è¾“å‡ºæ˜¯ $\mathbf{X}^{(L + 2)}_p$ã€‚åŒæ—¶ï¼Œ&lt;em&gt;è¶‹åŠ¿&lt;/em&gt; ç»„ä»¶çš„è¾“å‡ºæ˜¯ $\mathbf{X}^{(L+2)}_q$ï¼Œè¾“å…¥æ˜¯ $[\mathbf{X}_{t-l_q \cdot q}, \mathbf{X}_{t-(l_q - 1) \cdot q}, \dots, \mathbf{X}_{t-q}]$ï¼Œ$l_q$ æ˜¯&lt;em&gt;è¶‹åŠ¿&lt;/em&gt;ä¾èµ–åºåˆ—çš„é•¿åº¦ï¼Œ$q$ æ˜¯è¶‹åŠ¿è·¨åº¦ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ $p$ å’Œ $q$ æ˜¯ä¸¤ä¸ªä¸åŒç±»å‹çš„å‘¨æœŸã€‚åœ¨å®é™…çš„å®ç°ä¸­ï¼Œ$p$ ç­‰äºä¸€å¤©ï¼Œæè¿°çš„æ˜¯æ—¥å‘¨æœŸï¼Œ$q$ æ˜¯ä¸€å‘¨ï¼Œè¡¨ç¤ºå‘¨çº§åˆ«çš„è¶‹åŠ¿ã€‚&lt;/p&gt;
&lt;h2 id="the-structure-of-the-external-component"&gt;The Structure of the External Component
&lt;/h2&gt;&lt;p&gt;äº¤é€šæµä¼šè¢«å¾ˆå¤šå¤æ‚çš„å¤–éƒ¨å› ç´ æ‰€å½±å“ï¼Œå¦‚å¤©æ°”æˆ–äº‹ä»¶ã€‚å›¾ 5(a) è¡¨ç¤ºå‡æœŸï¼ˆæ˜¥èŠ‚ï¼‰æ—¶çš„äººæµå’Œå¹³æ—¶çš„äººæµå¾ˆä¸ä¸€æ ·ã€‚å›¾ 5(b) è¡¨ç¤ºç›¸æ¯”ä¸Šå‘¨çš„åŒä¸€å¤©ï¼Œçªç„¶è€Œæ¥çš„å¤§é›¨ä¼šå‡å°‘æ­¤æ—¶åŠå…¬åŒºåŸŸçš„äººæµã€‚ä»¤ $E_t$ ä¸ºç‰¹å¾å‘é‡ï¼Œè¡¨ç¤ºé¢„æµ‹çš„æ—¶æ®µ $t$ çš„å¤–éƒ¨å› ç´ ã€‚æˆ‘ä»¬çš„å®ç°ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦è€ƒè™‘å¤©æ°”ã€å‡æœŸäº‹ä»¶ã€å…ƒæ•°æ®ï¼ˆå·¥ä½œæ—¥ã€å‘¨æœ«ï¼‰ã€‚è¯¦ç»†æƒ…å†µè§è¡¨ 1ã€‚ä¸ºäº†é¢„æµ‹æ—¶æ®µ $t$ çš„äº¤é€šæµï¼Œå‡æœŸäº‹ä»¶å’Œå…ƒæ•°æ®å¯ä»¥ç›´æ¥è·å¾—ã€‚ç„¶è€Œï¼Œæœªæ¥æ—¶æ®µ $t$ çš„å¤©æ°”é¢„æŠ¥ä¸çŸ¥é“ã€‚å¯ä»¥ä½¿ç”¨æ—¶æ®µ $t$ çš„å¤©æ°”é¢„æŠ¥ï¼Œæˆ–æ˜¯ $t-1$ æ—¶æ®µçš„å¤©æ°”æ¥è¿‘ä¼¼ã€‚æˆ‘ä»¬åœ¨ $E_t$ ä¸Šå †å ä¸¤ä¸ªå…¨è¿æ¥å±‚ï¼Œç¬¬ä¸€å±‚å¯ä»¥çœ‹ä½œæ˜¯æ¯ä¸ªå­å› ç´ çš„åµŒå…¥å±‚ã€‚ç¬¬äºŒå±‚ç”¨æ¥ä»ä½ç»´æ˜ å°„åˆ°å’Œ $\mathbf{X}_t$ ä¸€æ ·çš„é«˜ç»´ä¸Šã€‚å›¾ 3 ä¸­å¤–éƒ¨ç»„ä»¶çš„è¾“å‡ºè¡¨ç¤ºä¸º $\mathbf{X}_{Ext}$ï¼Œå‚æ•°æ˜¯$\theta_{Ext}$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deep-spatio-temporal-residual-networks-for-citywide-crowd-flows-prediction/Fig5.JPG"
loading="lazy"
alt="Figure5"
&gt;&lt;/p&gt;
&lt;h2 id="fusion"&gt;Fusion
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬å…ˆç”¨ä¸€ä¸ªå‚æ•°çŸ©é˜µèåˆå‰ä¸‰ä¸ªç»„ä»¶ï¼Œç„¶åèåˆå¤–éƒ¨ç»„ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;å›¾6(a)å’Œ(d)å±•ç¤ºäº†è¡¨1å±•ç¤ºçš„åŒ—äº¬è½¨è¿¹æ•°æ®çš„æ¯”ä¾‹æ›²çº¿ï¼Œxè½´æ˜¯ä¸¤ä¸ªæ—¶æ®µçš„æ—¶é—´å·®ï¼Œyè½´æ˜¯ä»»æ„ä¸¤ä¸ªæœ‰ç›¸åŒæ—¶é—´å·®çš„æµå…¥çš„å¹³å‡æ¯”ä¾‹ã€‚ä¸¤ä¸ªä¸åŒåŒºåŸŸçš„æ›²çº¿åœ¨æ—¶é—´åºåˆ—ä¸Šè¡¨ç°å‡ºäº†æ—¶é—´è”ç³»ï¼Œä¹Ÿå°±æ˜¯è¿‘æœŸçš„æµå…¥æ¯”è¿œæœŸçš„æµå…¥æ›´ç›¸å…³ï¼Œè¡¨ç°å‡ºäº†äº‹ä»¶è¿‘é‚»æ€§ã€‚ä¸¤æ¡æ›²çº¿æœ‰ä¸¤ä¸ªä¸åŒçš„å½¢çŠ¶ï¼Œè¡¨ç°å‡ºä¸åŒåŒºåŸŸå¯èƒ½æœ‰ä¸åŒæ€§è´¨çš„è¿‘é‚»æ€§ã€‚å›¾6(b)å’Œ(e)æç»˜äº†7å¤©æ‰€æœ‰æ—¶æ®µçš„æµå…¥ã€‚æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ä¸¤ä¸ªåŒºåŸŸæ˜æ˜¾çš„æ—¥å‘¨æœŸæ€§ã€‚åœ¨åŠå…¬åŒºåŸŸï¼Œå·¥ä½œæ—¥çš„å³°å€¼æ¯”å‘¨æœ«çš„é«˜å¾ˆå¤šã€‚ä½å®…åŒºåœ¨å·¥ä½œæ—¥å’Œå‘¨æœ«æœ‰ç›¸ä¼¼çš„å³°å€¼ã€‚å›¾6(c)å’Œ(f)æè¿°äº†2015å¹´3æœˆåˆ°2015å¹´6æœˆä¸€ä¸ªç‰¹å®šæ—¶æ®µ(9:00pm-9:30pm)çš„æµå…¥ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼ŒåŠå…¬åŒºåŸŸçš„æµå…¥é€æ¸å‡å°‘ï¼Œä½å®…åŒºé€æ¸å¢åŠ ã€‚ä¸åŒçš„åŒºåŸŸè¡¨ç°å‡ºäº†ä¸åŒçš„è¶‹åŠ¿ã€‚æ€»çš„æ¥è¯´ï¼Œä¸¤ä¸ªåŒºåŸŸçš„æµå…¥å—åˆ°è¿‘é‚»ã€å‘¨æœŸã€è¶‹åŠ¿ä¸‰éƒ¨åˆ†å½±å“ï¼Œä½†æ˜¯å½±å“ç¨‹åº¦æ˜¯ä¸åŒçš„ã€‚æˆ‘ä»¬ä¹Ÿå‘ç°å…¶ä»–åŒºåŸŸä¹Ÿæœ‰åŒæ ·çš„æ€§è´¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deep-spatio-temporal-residual-networks-for-citywide-crowd-flows-prediction/Fig6.JPG"
loading="lazy"
alt="Figure6"
&gt;&lt;/p&gt;
&lt;p&gt;ç»¼ä¸Šï¼Œä¸åŒåŒºåŸŸå—è¿‘é‚»ã€å‘¨æœŸã€è¶‹åŠ¿çš„å½±å“ï¼Œä½†æ˜¯å½±å“ç¨‹åº¦ä¸åŒã€‚å—è¿™äº›è§‚å¯Ÿçš„å¯å‘ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªåŸºäºçŸ©é˜µå‚æ•°çš„èåˆæ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Parametric-matrix-based fusion.&lt;/strong&gt;&lt;/em&gt; æˆ‘ä»¬èåˆå›¾ 3 ä¸­å‰ä¸‰ä¸ªç»„ä»¶ï¼š&lt;/p&gt;
$$\tag{4}
\mathbf{X}\_{Res} = \mathbf{W}\_c \odot \mathbf{X}^{(L+2)}\_c + \mathbf{W}\_p \odot \mathbf{X}^{(L+2)}\_p + \mathbf{W}\_q \odot \mathbf{X}^{(L+2)}\_q
$$&lt;p&gt;$\odot$ æ˜¯å“ˆè¾¾ç›ä¹˜ç§¯ï¼Œ$\mathbf{W}$ æ˜¯å‚æ•°ï¼Œåˆ†åˆ«è°ƒæ•´ä¸‰ä¸ªç»„ä»¶çš„å½±å“ç¨‹åº¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Fusing the external component.&lt;/strong&gt;&lt;/em&gt; æˆ‘ä»¬ç›´æ¥åœ°å°†å‰ä¸‰ä¸ªç»„ä»¶çš„è¾“å‡ºå’Œå¤–éƒ¨ç»„ä»¶èåˆï¼Œå¦‚å›¾3ã€‚æœ€åï¼Œæ—¶æ®µ $t$ çš„é¢„æµ‹å€¼ï¼Œè¡¨ç¤ºä¸º $\hat{\mathbf{X}}_t$ å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{5}
\hat{\mathbf{X}}\_t = \mathrm{tanh}(\mathbf{X}\_{Res} + \mathbf{X}\_{Ext})
$$&lt;p&gt;æˆ‘ä»¬çš„ ST-ResNet å¯ä»¥ä»ä¸‰ä¸ªæµåŠ¨ä¸æœ•å’Œå¤–éƒ¨å› ç´ ç‰¹å¾é€šè¿‡æœ€ä¸‹æ»‘ MSE æ¥è®­ç»ƒï¼š&lt;/p&gt;
$$\tag{6}
\mathcal{L}(\theta) = \Vert \mathbf{X}\_t - \hat{\mathbf{X}}\_t \Vert^2\_2
$$&lt;h2 id="algorithm-and-optimization"&gt;Algorithm and Optimization
&lt;/h2&gt;&lt;p&gt;ç®—æ³•1æè¿°äº† ST-ResNet çš„è®­ç»ƒè¿‡ç¨‹ã€‚é¦–å…ˆä»åŸå§‹åºåˆ—æ„é€ è®­ç»ƒå®ä¾‹ã€‚ç„¶åé€šè¿‡åå‘ä¼ æ’­ï¼Œç”¨ Adam ç®—æ³•è®­ç»ƒã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deep-spatio-temporal-residual-networks-for-citywide-crowd-flows-prediction/Alg1.JPG"
loading="lazy"
alt="Algorithm1"
&gt;&lt;/p&gt;
&lt;h1 id="experiments"&gt;Experiments
&lt;/h1&gt;&lt;h2 id="settings"&gt;Settings
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Datasets.&lt;/strong&gt; æˆ‘ä»¬ä½¿ç”¨è¡¨ 1 ä¸­å±•ç¤ºçš„ä¸¤ä¸ªæ•°æ®é›†ã€‚æ¯ä¸ªæ•°æ®é›†éƒ½åŒ…å«ä¸¤ä¸ªå­é›†ï¼Œè½¨è¿¹å’Œå¤©æ°”ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;TaxiBJ: è½¨è¿¹æ•°æ®æ˜¯å‡ºç§Ÿè½¦ GPS æ•°æ®å’ŒåŒ—äº¬çš„æ°”è±¡æ•°æ®ï¼Œ2013å¹´7æœˆ1æ—¥åˆ°10æœˆ30æ—¥ï¼Œ2014å¹´5æœˆ1æ—¥åˆ°6æœˆ30æ—¥ï¼Œ2015å¹´5æœˆ1æ—¥åˆ°6æœˆ30æ—¥ï¼Œ2015å¹´11æœˆ1æ—¥åˆ°2016å¹´4æœˆ1æ—¥ã€‚ä½¿ç”¨å®šä¹‰2ï¼Œæˆ‘ä»¬è·å¾—ä¸¤ç±»äººæµã€‚æˆ‘ä»¬é€‰æ‹©æœ€åå››å‘¨ä½œä¸ºæµ‹è¯•é›†ï¼Œä¹‹å‰çš„éƒ½ä¸ºè®­ç»ƒé›†ã€‚&lt;/li&gt;
&lt;li&gt;BikeNYC: è½¨è¿¹æ•°æ®æ˜¯2014å¹´NYC Bikeç³»ç»Ÿä¸­å–çš„ï¼Œä»4æœˆ1æ—¥åˆ°9æœˆ30æ—¥ã€‚æ—…è¡Œæ•°æ®åŒ…å«ï¼šæŒç»­æ—¶é—´ã€èµ·ç‚¹ç»ˆç‚¹ç«™ç‚¹IDï¼Œèµ·å§‹ç»ˆæ­¢æ—¶é—´ã€‚åœ¨æ•°æ®ä¸­ï¼Œæœ€å10å¤©é€‰åšæµ‹è¯•é›†ï¼Œå…¶ä»–é€‰åšè®­ç»ƒé›†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deep-spatio-temporal-residual-networks-for-citywide-crowd-flows-prediction/Table1.JPG"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Baselines.&lt;/strong&gt; æˆ‘ä»¬å¯¹æ¯”äº†6ä¸ªbaselinesï¼šHA, ARIMA, SARIMA, VAR, ST-ANN, DeepST.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deep-spatio-temporal-residual-networks-for-citywide-crowd-flows-prediction/Table2.JPG"
loading="lazy"
alt="Table2"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deep-spatio-temporal-residual-networks-for-citywide-crowd-flows-prediction/Table3.JPG"
loading="lazy"
alt="Table3"
&gt;&lt;/p&gt;</description></item><item><title>T-GCN: A Temporal Graph Convolutional Network for Traffic Prediction</title><link>https://davidham3.github.io/blog/p/t-gcn-a-temporal-graph-convolutional-network-for-traffic-prediction/</link><pubDate>Thu, 07 Mar 2019 09:03:16 +0000</pubDate><guid>https://davidham3.github.io/blog/p/t-gcn-a-temporal-graph-convolutional-network-for-traffic-prediction/</guid><description>&lt;p&gt;T-GCNï¼Œarxivä¸Šé¢çš„ä¸€ç¯‡æ–‡ç« ï¼Œç”¨ GCN å¯¹ç©ºé—´å»ºæ¨¡ï¼ŒGRU å¯¹æ—¶é—´å»ºæ¨¡ï¼Œå¾ˆç®€å•çš„æ¨¡å‹ã€‚æ²¡æœ‰å¯¹æ¯”è¿‘å‡ å¹´çš„å›¾å·ç§¯åœ¨æ—¶ç©ºæ•°æ®æŒ–æ˜ä¸­çš„æ¨¡å‹ã€‚åŸæ–‡åœ°å€ï¼š&lt;a class="link" href="https://arxiv.org/abs/1811.05320" target="_blank" rel="noopener"
&gt;T-GCN: A Temporal Graph ConvolutionalNetwork for Traffic Prediction&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;ç²¾ç¡®å’Œå®æ—¶çš„äº¤é€šé¢„æµ‹åœ¨æ™ºèƒ½äº¤é€šç³»ç»Ÿä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ï¼Œå¯¹åŸå¸‚äº¤é€šè§„åˆ’ã€äº¤é€šç®¡ç†ã€äº¤é€šæ§åˆ¶èµ·ç€é‡è¦çš„ä½œç”¨ã€‚ç„¶è€Œï¼Œäº¤é€šé¢„æµ‹ç”±äºå…¶å—é™äºåŸå¸‚è·¯ç½‘ä¸”éšæ—¶é—´åŠ¨æ€å˜åŒ–ï¼Œå³æœ‰ç€ç©ºé—´ä¾èµ–ä¸æ—¶é—´ä¾èµ–ï¼Œæ—©å·²æˆä¸ºä¸€ä¸ªå…¬å¼€çš„ç§‘å­¦ç ”ç©¶é—®é¢˜ã€‚ä¸ºäº†åŒæ—¶æ•è·ç©ºé—´å’Œæ—¶é—´ä¾èµ–ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–°çš„ç¥ç»ç½‘ç»œæ–¹æ³•ï¼Œæ—¶é—´å›¾å·ç§¯ç½‘ç»œæ¨¡å‹ ï¼ˆT-GCNï¼‰ï¼Œå°†å›¾å·ç§¯å’Œé—¨æ§å¾ªç¯å•å…ƒèåˆèµ·æ¥ã€‚GCN ç”¨æ¥å­¦ä¹ å¤æ‚çš„æ‹“æ‰‘ç»“æ„æ¥æ•è·ç©ºé—´ä¾èµ–ï¼Œé—¨æ§å¾ªç¯å•å…ƒå­¦ä¹ äº¤é€šæ•°æ®çš„åŠ¨æ€å˜åŒ–æ¥æ•è·æ—¶é—´ä¾èµ–ã€‚å®éªŒè¡¨æ˜æˆ‘ä»¬çš„ T-GCN æ¨¡å‹æ¯”ä¹‹å‰çš„æ–¹æ³•è¦å¥½ã€‚æˆ‘ä»¬çš„ tf å®ç°ï¼š&lt;a class="link" href="https://github.com/lehaifeng/T-GCN" target="_blank" rel="noopener"
&gt;ä»£ç ä»“åº“åœ°å€&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 Introduction
&lt;/h1&gt;&lt;p&gt;éšç€æ™ºèƒ½äº¤é€šç³»ç»Ÿçš„å‘å±•ï¼Œäº¤é€šé¢„æµ‹å—åˆ°äº†è¶Šæ¥è¶Šå¤šçš„å…³æ³¨ã€‚äº¤é€šé¢„æµ‹æ˜¯é«˜çº§äº¤é€šç®¡ç†ç³»ç»Ÿä¸­çš„å…³é”®éƒ¨åˆ†ï¼Œæ˜¯å®ç°äº¤é€šè§„åˆ’ã€äº¤é€šç®¡ç†ã€äº¤é€šæ§åˆ¶çš„é‡è¦éƒ¨åˆ†ã€‚äº¤é€šé¢„æµ‹æ˜¯åˆ†æåŸå¸‚è·¯ç½‘ä¸Šäº¤é€šçŠ¶å†µã€åŒ…æ‹¬æµé‡ã€è½¦é€Ÿã€å¯†åº¦ï¼ŒæŒ–æ˜äº¤é€šæ¨¡å¼ï¼Œå¯¹è·¯ç½‘ä¸Šäº¤é€šè¿›è¡Œé¢„æµ‹çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚äº¤é€šé¢„æµ‹ä¸ä»…èƒ½ç»™ç®¡ç†è€…æä¾›ç§‘å­¦ä¾æ®æ¥é¢„æµ‹äº¤é€šæ‹¥æŒ¤å¹¶æå‰é™åˆ¶å‡ºè¡Œï¼Œè¿˜å¯ä»¥ç»™æ—…å®¢æä¾›é€‚å½“çš„å‡ºè¡Œè·¯çº¿å¹¶æé«˜äº¤é€šæ•ˆç‡ã€‚ç„¶è€Œï¼Œäº¤é€šç”±äºå…¶ç©ºé—´å’Œæ—¶é—´çš„ä¾èµ–è‡³ä»Šè¿˜æ˜¯ä¸€ä¸ªæœ‰éš¾åº¦çš„æŒ‘æˆ˜ï¼š&lt;/p&gt;
&lt;p&gt;ï¼ˆ1ï¼‰ç©ºé—´ä¾èµ–ã€‚æµé‡çš„æ”¹å˜ä¸»è¦å—è·¯ç½‘çš„æ‹“æ‰‘ç»“æ„æ§åˆ¶ã€‚ä¸Šæ¸¸é“è·¯çš„äº¤é€šçŠ¶æ€é€šè¿‡è½¬ç§»å½±å“ä¸‹æ¸¸çš„é“è·¯ï¼Œä¸‹æ¸¸çš„äº¤é€šçŠ¶æ€ä¼šé€šè¿‡åé¦ˆå½±å“ä¸Šæ¸¸çš„çŠ¶æ€ã€‚å¦‚å›¾ 1 æ‰€ç¤ºï¼Œç”±äºé‚»è¿‘é“è·¯çš„å¼ºçƒˆå½±å“ï¼ŒçŸ­æœŸç›¸ä¼¼æ€§ä»çŠ¶æ€ 1 ï¼ˆä¸Šæ¸¸ä¸ä¸­æ¸¸ç›¸ä¼¼ï¼‰è½¬ç§»åˆ° çŠ¶æ€ 2ï¼ˆä¸Šæ¸¸ä¸ä¸‹æ¸¸ç›¸ä¼¼ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰æ—¶é—´ä¾èµ–ã€‚æµé‡éšæ—¶é—´åŠ¨æ€æ”¹å˜ï¼Œä¸»è¦ä¼šå‡ºç°å‘¨æœŸæ€§å’Œè¶‹åŠ¿ã€‚å¦‚å›¾ 2ï¼ˆaï¼‰æ‰€ç¤ºï¼Œè·¯ 1 çš„æµé‡åœ¨ä¸€å‘¨å†…å±•ç¤ºå‡ºäº†å‘¨æœŸæ€§å˜åŒ–ã€‚å›¾ 2ï¼ˆbï¼‰ä¸­ï¼Œä¸€å¤©çš„æµé‡ä¹Ÿå‘ç”Ÿå˜æ¢ï¼›ä¸¾ä¸ªä¾‹å­ï¼Œæµé‡ä¼šè¢«å…¶å‰ä¸€æ—¶åˆ»æˆ–æ›´å‰çš„æ—¶åˆ»çš„äº¤é€šçŠ¶å†µæ‰€å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/t-gcn-a-temporal-graph-convolutional-network-for-traffic-prediction/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;
&lt;img src="https://davidham3.github.io/blog/images/t-gcn-a-temporal-graph-convolutional-network-for-traffic-prediction/Fig2.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;æœ‰å¾ˆå¤šäº¤é€šé¢„æµ‹æ–¹æ³•ï¼Œä¸€äº›è€ƒè™‘æ—¶é—´ä¾èµ–ï¼ŒåŒ…æ‹¬ ARIMAï¼ŒKalman filtering model, SVR, knn, Beyesian model, partial neural network model.ä¸Šè¿°æ–¹æ³•è€ƒè™‘äº¤é€šçŠ¶å†µåœ¨æ—¶é—´ä¸Šçš„åŠ¨æ€å˜åŒ–ï¼Œå¿½ç•¥äº†ç©ºé—´ä¾èµ–ï¼Œå¯¼è‡´ä¸èƒ½ç²¾ç¡®é¢„æµ‹ã€‚ä¸ºäº†æ›´å¥½åœ°åˆ»ç”»ç©ºé—´ç‰¹å¾ï¼Œä¸€äº›ç ”ç©¶å¼•å…¥äº†å·ç§¯ç¥ç»ç½‘ç»œå¯¹ç©ºé—´å»ºæ¨¡ï¼›ç„¶è€Œï¼Œå·ç§¯é€‚ç”¨äºæ¬§æ°ç©ºé—´çš„æ•°æ®ï¼Œå¦‚å›¾åƒã€ç½‘æ ¼ç­‰ã€‚è¿™æ ·çš„æ¨¡å‹ä¸èƒ½åœ¨åŸå¸‚è·¯ç½‘è¿™æ ·æœ‰ç€å¤æ‚æ‹“æ‰‘ç»“æ„çš„ç¯å¢ƒä¸‹å·¥ä½œï¼Œæ‰€ä»¥ä»–ä»¬ä¸èƒ½æè¿°ç©ºé—´ä¾èµ–ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†æ–°çš„äº¤é€šé¢„æµ‹æ–¹æ³•ï¼Œæ—¶é—´å›¾å·ç§¯ç½‘ç»œ ï¼ˆT-GCNï¼‰ï¼Œç”¨äºå¯¹åŸºäºåŸå¸‚è·¯ç½‘çš„äº¤é€šé¢„æµ‹ä»»åŠ¡ã€‚æˆ‘ä»¬çš„è´¡çŒ®æœ‰ä¸‰ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;ï¼ˆ1ï¼‰ æˆ‘ä»¬æå‡ºçš„æ¨¡å‹ç»“åˆäº† GCN å’Œ GRUï¼Œå›¾å·ç§¯æ•è·è·¯ç½‘çš„æ‹“æ‰‘ç»“æ„åšç©ºé—´å»ºæ¨¡ï¼ŒGRU æ•è·è·¯ç½‘ä¸Šäº¤é€šæ•°æ®çš„æ—¶é—´ä¾èµ–ã€‚T-GCN æ¨¡å‹å¯ä»¥ç”¨äºå…¶ä»–æ—¶ç©ºé¢„æµ‹ä»»åŠ¡ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰ T-GCN çš„é¢„æµ‹ç»“æœæ¯”å…¶ä»–çš„æ–¹æ³•å¥½ï¼Œè¡¨æ˜æˆ‘ä»¬çš„ T-GCN æ¨¡å‹ä¸ä»…å¯ä»¥åšçŸ­æœŸé¢„æµ‹ï¼Œä¹Ÿå¯ä»¥åšé•¿æœŸé¢„æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ3ï¼‰æˆ‘ä»¬ä½¿ç”¨æ·±åœ³å¸‚ç½—æ¹–åŒºçš„å‡ºç§Ÿè½¦é€Ÿåº¦æ•°æ®å’Œæ´›æ‰çŸ¶çº¿åœˆæ•°æ®ã€‚ç»“æœè¡¨æ˜æˆ‘ä»¬çš„é¢„æµ‹è¯¯å·®æ¯”æ‰€æœ‰çš„ baseline å°äº† 1.5%åˆ°57.8%ï¼Œè¡¨æ˜ T-GCN åœ¨äº¤é€šé¢„æµ‹ä¸Šçš„ä¼˜è¶Šæ€§ã€‚&lt;/p&gt;
&lt;h1 id="2-related-work"&gt;2 Related work
&lt;/h1&gt;&lt;p&gt;æ™ºèƒ½äº¤é€šç³»ç»Ÿäº¤é€šé¢„æµ‹æ˜¯ç°åœ¨çš„ä¸€ä¸ªé‡è¦ç ”ç©¶é—®é¢˜ã€‚ç°å­˜çš„æ–¹æ³•åˆ†ä¸¤ç±»ï¼šæ¨¡å‹é©±åŠ¨çš„æ–¹æ³•å’Œæ•°æ®é©±åŠ¨çš„æ–¹æ³•ã€‚é¦–å…ˆï¼Œæ¨¡å‹é©±åŠ¨çš„æ–¹æ³•ä¸»è¦è§£é‡Šäº¤é€šæµé‡ã€é€Ÿåº¦ã€å¯†åº¦çš„ç¬æ—¶æ€§å’Œå¹³ç¨³æ€§ã€‚è¿™æ ·çš„æ–¹æ³•éœ€è¦åŸºäºå…ˆéªŒçŸ¥è¯†çš„ç³»ç»Ÿå»ºæ¨¡ã€‚ä»£è¡¨æ–¹æ³•åŒ…æ‹¬æ’é˜Ÿè®ºæ¨¡å‹ï¼Œç»†èƒä¼ é€’æ¨¡å‹ï¼Œäº¤é€šé€Ÿåº¦æ¨¡å‹ï¼Œmicroscopic fundamental diagram model ç­‰ç­‰ã€‚å®é™…ä¸­ï¼Œäº¤é€šæ•°æ®å—å¤šç§å› ç´ å½±å“ï¼Œå¾ˆéš¾è·å¾—ä¸€ä¸ªç²¾å‡†çš„äº¤é€šæ¨¡å‹ã€‚ç°å­˜çš„æ¨¡å‹ä¸èƒ½ç²¾ç¡®åœ°æè¿°å¤æ‚çš„ç°å®ç¯å¢ƒä¸­çš„äº¤é€šæ•°æ®çš„å˜åŒ–ã€‚æ­¤å¤–ï¼Œè¿™äº›æ¨¡å‹çš„æ„å»ºéœ€è¦å¾ˆå¼ºçš„è®¡ç®—èƒ½åŠ›ï¼Œè€Œä¸”å¾ˆå®¹æ˜“æ”¶åˆ°äº¤é€šæ‰°ä¹±å’Œé‡‡æ ·ç‚¹ç©ºé—´ç­‰é—®é¢˜çš„å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;æ•°æ®é©±åŠ¨çš„æ–¹æ³•åŸºäºæ•°æ®çš„è§„å¾‹æ€§ï¼Œä»ç»Ÿè®¡å­¦æ¨æµ‹å˜åŒ–å±€åŠ¿ï¼Œç„¶åç”¨äºé¢„æµ‹ã€‚è¿™ç±»æ–¹æ³•ä¸åˆ†æç‰©ç†æ€§è´¨å’Œäº¤é€šç³»ç»Ÿçš„åŠ¨æ€è¡Œä¸ºï¼Œæœ‰å¾ˆé«˜çš„çµæ´»æ€§ã€‚æ—©æœŸçš„æ–¹æ³•åŒ…æ‹¬å†å²å‡å€¼æ¨¡å‹ï¼Œä½¿ç”¨å†å²å‘¨æœŸçš„äº¤é€šæµé‡å‡å€¼ä½œä¸ºé¢„æµ‹å€¼ã€‚è¿™ä¸ªæ–¹æ³•ä¸éœ€è¦å‡è®¾ï¼Œè®¡ç®—ç®€å•è€Œä¸”è¿˜å¿«ï¼Œä½†æ˜¯ä¸èƒ½æœ‰æ•ˆåœ°æ‹Ÿåˆæ—¶é—´ç‰¹å¾ï¼Œé¢„æµ‹çš„ç²¾å‡†åº¦ä½ã€‚éšç€ç ”ç©¶çš„æ·±å…¥ï¼Œå¾ˆå¤šé«˜ç²¾åº¦çš„æ–¹æ³•æ¶Œç°å‡ºæ¥ï¼Œä¸»è¦åˆ†ä¸ºå‚æ•°æ¨¡å‹å’Œéå‚æ•°æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;å‚æ•°æ¨¡å‹æå‰å‡è®¾å›å½’å‡½æ•°ï¼Œå‚æ•°é€šè¿‡å¯¹åŸå§‹æ•°æ®å¤„ç†å¾—åˆ°ï¼ŒåŸºäºå›å½’å‡½æ•°å¯¹äº¤é€šæµé¢„æµ‹ã€‚æ—¶é—´åºåˆ—æ¨¡å‹ï¼Œçº¿æ€§å›å½’æ¨¡å‹ï¼ŒKalman filtering model æ˜¯å¸¸ç”¨çš„æ–¹æ³•ã€‚æ—¶é—´åºåˆ—æ¨¡å‹å°†è§‚æµ‹åˆ°çš„æ—¶é—´åºåˆ—æ‹Ÿåˆè¿›ä¸€ä¸ªæ¨¡å‹ï¼Œç„¶åç”¨æ¥é¢„æµ‹ã€‚æ—©åœ¨ 1976 å¹´ï¼ŒBox and Jenkins æå‡ºäº† ARIMAï¼ŒHamed ç­‰äººä½¿ç”¨ ARIMA é¢„æµ‹åŸå¸‚å†…çš„äº¤é€šæµé‡ã€‚ä¸ºäº†æé«˜æ¨¡å‹çš„ç²¾åº¦ï¼Œä¸åŒçš„å˜ä½“ç›¸ç»§è¢«æå‡ºï¼ŒKohonen ARIMAï¼Œsubset ARIMAï¼Œseasonal ARIMA ç­‰ç­‰ã€‚Lippi ç­‰äººå¯¹æ¯”æ”¯æŒå‘é‡å›å½’å’Œ seasonal ARIMï¼Œå‘ç° SARIMA æ¨¡å‹åœ¨äº¤é€šæ‹¥å µä¸Šçš„é¢„æµ‹æœ‰æ›´å¥½çš„ç»“æœã€‚çº¿æ€§å›å½’æ¨¡å‹åŸºäºå†å²æ•°æ®æ„å»ºæ¨¡å‹æ¥é¢„æµ‹ã€‚2004 å¹´ï¼ŒSun ç­‰äººä½¿ç”¨ local linear model è§£å†³äº†åŒºé—´é¢„æµ‹ï¼Œåœ¨çœŸå®æ•°æ®é›†ä¸Šè·å¾—äº†è¾ƒå¥½çš„æ•ˆæœã€‚Kalman filtering model åŸºäºå‰ä¸€æ—¶åˆ»å’Œå½“å‰æ—¶åˆ»çš„äº¤é€šçŠ¶æ€é¢„æµ‹æœªæ¥çš„çŠ¶æ€ã€‚1984 å¹´ï¼ŒOkutani ç­‰äººä½¿ç”¨ Kalman filtering ç†è®ºå»ºç«‹äº†äº¤é€šæµçŠ¶æ€é¢„æµ‹æ¨¡å‹ã€‚åç»­ï¼Œä¸€äº›ç ”ç©¶ä½¿ç”¨ Kalman filtering æ¨¡å‹è§£å†³äº¤é€šé¢„æµ‹ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;ä¼ ç»Ÿçš„å‚æ•°æ¨¡å‹ç®—æ³•ç®€å•ï¼Œè®¡ç®—æ–¹ä¾¿ã€‚ç„¶è€Œï¼Œè¿™äº›æ–¹æ³•ä¾èµ–å¹³ç¨³å‡è®¾ï¼Œä¸èƒ½åæ˜ äº¤é€šæ•°æ®çš„éçº¿æ€§å’Œä¸ç¡®å®šæ€§ï¼Œä¹Ÿä¸èƒ½å…‹æœäº¤é€šäº‹ä»¶è¿™ç§éšæœºæ€§äº‹ä»¶ã€‚éå‚æ•°æ¨¡å‹å¾ˆå¥½åœ°è§£å†³è¿™äº›é—®é¢˜ï¼Œåªéœ€è¦è¶³å¤Ÿçš„å†å²ä¿¡æ¯èƒ½è‡ªåŠ¨åœ°ä»ä¸­å­¦åˆ°ç»Ÿè®¡è§„å¾‹å³å¯ã€‚å¸¸è§çš„éå‚æ•°æ¨¡å‹åŒ…æ‹¬ï¼škè¿‘é‚»ï¼Œæ”¯æŒå‘é‡å›å½’ï¼ŒFuzzy Logic æ¨¡å‹ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿‘äº›å¹´ï¼Œéšç€æ·±åº¦å­¦ä¹ çš„å¿«é€Ÿå‘å±•ï¼Œæ·±åº¦ç¥ç»ç½‘ç»œå¯ä»¥æ•è·äº¤é€šæ•°æ®çš„åŠ¨æ€ç‰¹å¾ï¼Œè·å¾—å¾ˆå¥½çš„æ•ˆæœã€‚æ ¹æ®æ˜¯å¦è€ƒè™‘ç©ºé—´ä¾èµ–ï¼Œæ¨¡å‹å¯ä»¥åˆ’åˆ†æˆä¸¤ç±»ã€‚ä¸€äº›æ–¹æ³•åªè€ƒè™‘æ—¶é—´ä¾èµ–ï¼Œå¦‚ Park ç­‰äººä½¿ç”¨ FNN é¢„æµ‹äº¤é€šæµã€‚Huang ç­‰äººä½¿ç”¨æ·±åº¦ç½®ä¿¡ç½‘ç»œ DBN å’Œå›å½’æ¨¡å‹åœ¨å¤šä¸ªæ•°æ®é›†ä¸Šè¯æ˜å¯ä»¥æ•è·äº¤é€šæ•°æ®ä¸­çš„éšæœºç‰¹å¾ï¼Œæå‡é¢„æµ‹ç²¾åº¦ã€‚æ­¤å¤–ï¼ŒRNN åŠå…¶å˜ä½“ LSTM, GRU å¯ä»¥æœ‰æ•ˆåœ°ä½¿ç”¨è‡ªå¾ªç¯æœºåˆ¶ï¼Œä»–ä»¬å¯ä»¥å¾ˆå¥½åœ°å­¦ä¹ åˆ°æ—¶é—´ä¾èµ–å¹¶è·å¾—æ›´å¥½çš„é¢„æµ‹ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›æ¨¡å‹è€ƒè™‘æ—¶é—´ç‰¹å¾ä½†æ˜¯å¿½ç•¥ç©ºé—´ä¾èµ–ï¼Œæ‰€ä»¥äº¤é€šæ•°æ®çš„å˜åŒ–ä¸å—åŸå¸‚è·¯ç½‘çš„é™åˆ¶ï¼Œå› æ­¤ä»–ä»¬ä¸èƒ½ç²¾ç¡®çš„é¢„æµ‹è·¯ä¸Šçš„äº¤é€šçŠ¶æ€ã€‚è§£å†³äº¤é€šé¢„æµ‹é—®é¢˜çš„å…³é”®æ˜¯å……åˆ†åˆ©ç”¨ç©ºé—´å’Œæ—¶é—´ä¾èµ–ã€‚ä¸ºäº†æ›´å¥½çš„åˆ»ç”»ç©ºé—´ç‰¹å¾ï¼Œå¾ˆå¤šç ”ç©¶å·²ç»åœ¨è¿™ä¸ªåŸºç¡€ä¸Šè¿›è¡Œäº†æå‡ã€‚Lv ç­‰äººæå‡ºäº†ä¸€ä¸ª SAE æ¨¡å‹ä»äº¤é€šæ•°æ®ä¸­æ•è·æ—¶ç©ºç‰¹å¾ï¼Œå®ç°çŸ­æœŸäº¤é€šæµçš„é¢„æµ‹ã€‚Zhang ç­‰äººæå‡ºäº†ä¸€ä¸ªå« ST-ResNet çš„æ¨¡å‹ï¼ŒåŸºäºäººå£æµåŠ¨çš„æ—¶é—´è¿‘é‚»ã€å‘¨æœŸå’Œè¶‹åŠ¿è¿™äº›ç‰¹å¾è®¾è®¡äº†æ®‹å·®å·ç§¯ç½‘ç»œï¼Œç„¶åä¸‰ä¸ªç½‘ç»œå’Œå¤–éƒ¨å› ç´ åŠ¨æ€åœ°èšåˆèµ·æ¥ï¼Œé¢„æµ‹åŸå¸‚å†…æ¯ä¸ªåŒºåŸŸäººå£çš„æµå…¥å’Œæµå‡ºã€‚Wu ç­‰äººè®¾è®¡äº†ä¸€ä¸ªç‰¹å¾èåˆæ¶æ„é€šè¿‡èåˆ CNN å’Œ LSTM è¿›è¡ŒçŸ­æœŸé¢„æµ‹ã€‚ä¸€ä¸ªä¸€ç»´çš„ CNN ç”¨äºæ•è·ç©ºé—´ä¾èµ–ï¼Œä¸¤ä¸ª LSTM ç”¨æ¥æŒ–æ˜äº¤é€šæµçš„çŸ­æœŸå˜åŒ–å’Œå‘¨æœŸæ€§ã€‚Cao ç­‰äººæå‡ºä¸€ä¸ªå« ITRCN çš„ç«¯åˆ°ç«¯æ¨¡å‹ï¼Œå°†äº¤äº’çš„ç½‘ç»œäº¤é€šè½¬æ¢ä¸ºå›¾åƒï¼Œä½¿ç”¨ CNN æ•è·äº¤é€šçš„äº¤äº’å¼åŠŸèƒ½ï¼Œç”¨ GRU æå–æ—¶é—´ç‰¹å¾ï¼Œé¢„æµ‹è¯¯å·®æ¯” GRU å’Œ CNN åˆ†åˆ«é«˜äº† 14.3% å’Œ 13.0%ã€‚Ke ç­‰äººæå‡ºä¸€ä¸ªæ–°çš„æ·±åº¦å­¦ä¹ æ–¹æ³•å«èåˆå·ç§¯é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œï¼ˆFCL-Netï¼‰ï¼Œè€ƒè™‘ç©ºé—´ä¾èµ–ã€æ—¶é—´ä¾èµ–ï¼Œä»¥åŠå¼‚è´¨ä¾èµ–ï¼Œç”¨äºçŸ­æœŸä¹˜å®¢éœ€æ±‚é¢„æµ‹ã€‚Yu ç­‰äººç”¨æ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œæ•è·ç©ºé—´ä¾èµ–ï¼Œç”¨ LSTM æ•è·æ—¶é—´åŠ¨æ€æ€§ï¼Œåœ¨åŒ—äº¬äº¤é€šç½‘ç»œæ•°æ®ä¸Šå±•ç¤ºå‡ºäº† SRCN çš„ä¼˜è¶Šæ€§ã€‚&lt;/p&gt;
&lt;p&gt;å°½ç®¡ä¸Šè¿°æ–¹æ³•å¼•å…¥äº† CNN å¯¹ç©ºé—´ä¾èµ–å»ºæ¨¡ï¼Œåœ¨äº¤é€šé¢„æµ‹ä»»åŠ¡ä¸Šæœ‰å¾ˆå¤§çš„è¿›æ­¥ï¼Œä½† CNN æœ¬è´¨ä¸Šåªé€‚ç”¨äºæ¬§æ°ç©ºé—´ï¼Œåœ¨æœ‰ç€å¤æ‚æ‹“æ‰‘ç»“æ„çš„äº¤é€šç½‘ç»œä¸Šä¸èƒ½åˆ»ç”»ç©ºé—´ä¾èµ–ã€‚å› æ­¤ï¼Œè¿™ç±»æ–¹æ³•æœ‰ç¼ºé™·ã€‚è¿‘äº›å¹´ï¼Œå›¾å·ç§¯ç½‘ç»œçš„å‘å±•ï¼Œå¯ä»¥ç”¨æ¥æ•è·å›¾ç½‘ç»œçš„ç»“æ„ç‰¹å¾ï¼Œæä¾›æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚Li ç­‰äººæå‡ºäº† DCRNN æ¨¡å‹ï¼Œé€šè¿‡å›¾ä¸Šçš„éšæœºæ¸¸èµ°æ•è·ç©ºé—´ç‰¹å¾ï¼Œé€šè¿‡ç¼–ç è§£ç ç»“æ„æ•è·æ—¶é—´ç‰¹å¾ã€‚&lt;/p&gt;
&lt;p&gt;åŸºäºè¿™ä¸ªèƒŒæ™¯ï¼Œæˆ‘ä»¬æå‡ºäº†æ–°çš„ç¥ç»ç½‘ç»œæ–¹æ³•æ•è·å¤æ‚çš„æ—¶ç©ºç‰¹å¾ï¼Œå¯ä»¥ç”¨äºåŸºäºåŸå¸‚è·¯ç½‘çš„äº¤é€šé¢„æµ‹ä»»åŠ¡ä¸Šã€‚&lt;/p&gt;
&lt;h1 id="3-methodology"&gt;3 Methodology
&lt;/h1&gt;&lt;h2 id="31-problem-definition"&gt;3.1 Problem Definition
&lt;/h2&gt;&lt;p&gt;ç›®æ ‡æ˜¯åŸºäºå†å²ä¿¡æ¯é¢„æµ‹æœªæ¥ã€‚æˆ‘ä»¬çš„æ–¹æ³•ä¸­ï¼Œäº¤é€šä¿¡æ¯æ˜¯ä¸€ä¸ªé€šç”¨çš„æ¦‚å¿µï¼Œå¯ä»¥æ˜¯é€Ÿåº¦ã€æµé‡ã€å¯†åº¦ã€‚æˆ‘ä»¬åœ¨å®éªŒçš„æ—¶å€™å°†äº¤é€šä¿¡æ¯çœ‹ä½œæ˜¯é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰1ï¼šè·¯ç½‘ $G$ã€‚æˆ‘ä»¬ç”¨å›¾ $G = (V, E)$ æè¿°è·¯ç½‘çš„æ‹“æ‰‘ç»“æ„ï¼Œæ¯æ¡è·¯æ˜¯ä¸€ä¸ªé¡¶ç‚¹ï¼Œ$V$ é¡¶ç‚¹é›†ï¼Œ$V = \lbrace v_1, v_2, \dots, v_N \rbrace$ï¼Œ$N$ æ˜¯é¡¶ç‚¹æ•°ï¼Œ$E$ æ˜¯è¾¹é›†ã€‚é‚»æ¥çŸ©é˜µ $A$ è¡¨ç¤ºè·¯çš„å…³ç³»ï¼Œ$A \in R^{N \times N}$ã€‚é‚»æ¥çŸ©é˜µåªæœ‰ 0 å’Œ 1ã€‚å¦‚æœè·¯ä¹‹é—´æœ‰è¿æ¥å°±ä¸º 1ï¼Œ å¦åˆ™ä¸º 0ã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰2ï¼šç‰¹å¾çŸ©é˜µ $X^{N \times P}$ã€‚æˆ‘ä»¬å°†äº¤é€šä¿¡æ¯çœ‹ä½œæ˜¯é¡¶ç‚¹çš„ç‰¹å¾ã€‚$P$ è¡¨ç¤ºç‰¹å¾æ•°ï¼Œ$X_t \in R^{N \times i}$ ç”¨æ¥è¡¨ç¤ºæ—¶åˆ» $i$ æ¯æ¡è·¯ä¸Šçš„é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;p&gt;æ—¶ç©ºäº¤é€šé¢„æµ‹çš„é—®é¢˜å¯ä»¥çœ‹ä½œå­¦ä¹ ä¸€ä¸ªæ˜ å°„å‡½æ•°ï¼š&lt;/p&gt;
$$\tag{1}
[X\_{t+1}, \dots, X\_{t+T}] = f(G; (X\_{t-n}, \dots, X\_{t-1}, X\_t))
$$&lt;p&gt;$n$ æ˜¯å†å²æ—¶é—´åºåˆ—çš„é•¿åº¦ï¼Œ$T$ æ˜¯éœ€è¦é¢„æµ‹çš„é•¿åº¦ã€‚&lt;/p&gt;
&lt;h2 id="32-overview"&gt;3.2 Overview
&lt;/h2&gt;&lt;p&gt;T-GCN æ¨¡å‹æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼šGCN å’Œ GRUã€‚å›¾ 3 æ‰€ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨å†å² $n$ ä¸ªæ—¶åˆ»çš„æ—¶é—´åºåˆ—æ•°æ®ä½œä¸ºè¾“å…¥ï¼Œå›¾å·ç§¯ç½‘ç»œæ•è·è·¯ç½‘æ‹“æ‰‘ç»“æ„è·å–ç©ºé—´ä¾èµ–ã€‚ç„¶åå°†å¸¦æœ‰ç©ºé—´ç‰¹å¾çš„æ—¶é—´åºåˆ—æ”¾å…¥ GRU ä¸­ï¼Œé€šè¿‡ä¿¡æ¯åœ¨å•å…ƒé—´çš„ä¼ é€’æ•è·åŠ¨æ€å˜åŒ–ï¼Œè·å¾—æ—¶é—´ç‰¹å¾ã€‚æœ€åï¼Œå°†ç»“æœé€å…¥å…¨è¿æ¥å±‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/t-gcn-a-temporal-graph-convolutional-network-for-traffic-prediction/Fig3.JPG"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;h2 id="33-methodology"&gt;3.3 Methodology
&lt;/h2&gt;&lt;h3 id="331-spatial-dependence-modeling"&gt;3.3.1 Spatial Dependence Modeling
&lt;/h3&gt;&lt;p&gt;è·å–å¤æ‚çš„ç©ºé—´ä¾èµ–åœ¨äº¤é€šé¢„æµ‹ä¸­æ˜¯ä¸€ä¸ªå…³é”®é—®é¢˜ã€‚ä¼ ç»Ÿçš„ CNN åªèƒ½ç”¨äºæ¬§æ°ç©ºé—´ã€‚åŸå¸‚è·¯ç½‘ä¸æ˜¯ç½‘æ ¼ï¼ŒCNN ä¸èƒ½åæ˜ å¤æ‚çš„æ‹“æ‰‘ç»“æ„ã€‚GCN å¯ä»¥å¤„ç†å›¾ç»“æ„ï¼Œå·²ç»å¹¿æ³›åº”ç”¨åˆ°æ–‡æ¡£åˆ†ç±»ã€åŠç›‘ç£å­¦ä¹ ã€å›¾åƒåˆ†ç±»ä¸­ã€‚GCN åœ¨å‚…é‡Œå¶åŸŸä¸­æ„å»ºæ»¤æ³¢å™¨ï¼Œä½œç”¨åœ¨é¡¶ç‚¹åŠå…¶ä¸€é˜¶é‚»å±…ä¸Šï¼Œæ•è·é¡¶ç‚¹é—´çš„ç©ºé—´ç‰¹å¾ï¼Œå¯ä»¥é€šè¿‡å †å æ„å»º GCN æ¨¡å‹ã€‚å¦‚å›¾ 4 æ‰€ç¤ºï¼Œå‡è®¾é¡¶ç‚¹ 1 æ˜¯ä¸­å¿ƒé“è·¯ï¼ŒGCN æ¨¡å‹å¯ä»¥è·å–ä¸­å¿ƒé“è·¯å’Œå®ƒå‘¨å›´é“è·¯çš„æ‹“æ‰‘å…³ç³»ï¼Œå°†è¿™ä¸ªç»“æ„å’Œé“è·¯å±æ€§ç¼–ç ï¼Œè·å¾—ç©ºé—´ä¾èµ–ã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬ç”¨ GCN æ¨¡å‹ä»äº¤é€šæ•°æ®ä¸­å­¦ä¹ ç©ºé—´ç‰¹å¾ã€‚ä¸¤å±‚ GCN è¡¨ç¤ºä¸ºï¼š&lt;/p&gt;
$$\tag{2}
f(X, A) = \sigma(\hat{A} Relu(\hat{A} X W\_0) W\_1)
$$&lt;p&gt;$\hat{A} = \tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}}$ è¡¨ç¤ºé¢„å¤„ç†ï¼Œ$\tilde{A} = A + I_N$ è¡¨ç¤ºåŠ äº†è‡ªè¿æ¥çš„é‚»æ¥çŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/t-gcn-a-temporal-graph-convolutional-network-for-traffic-prediction/Fig4.JPG"
loading="lazy"
alt="Figure4"
&gt;&lt;/p&gt;
&lt;h3 id="332-temporal-dependence-modeling"&gt;3.3.2 Temporal Dependence Modeling
&lt;/h3&gt;&lt;p&gt;å› ä¸º GRU æ¯” LSTM å‚æ•°å°‘ï¼Œè®­ç»ƒå¿«ï¼Œæˆ‘ä»¬ä½¿ç”¨ GRU è·å–äº¤é€šæ•°æ®çš„æ—¶é—´ä¾èµ–ã€‚å¦‚å›¾ 5 æ‰€ç¤ºï¼Œ$h_{t-1}$ è¡¨ç¤ºæ—¶åˆ» $t-1$ çš„éšè—çŠ¶æ€ï¼›$x_t$ è¡¨ç¤ºæ—¶åˆ» $t$ çš„äº¤é€šä¿¡æ¯ï¼›$r_t$ è¡¨ç¤ºé‡ç½®é—¨ï¼Œç”¨æ¥æ§åˆ¶å¿½ç•¥å‰ä¸€æ—¶åˆ»ä¿¡æ¯çš„ç¨‹åº¦ï¼›$u_t$ æ˜¯æ›´æ–°é—¨ï¼Œç”¨æ¥æ§åˆ¶å°†ä¿¡æ¯ä»ä¸Šä¸€æ—¶åˆ»æ‹¿åˆ°è¿™ä¸ªæ—¶åˆ»çš„ç¨‹åº¦ï¼›$c_t$ æ˜¯æ—¶åˆ» $t$ çš„è®°å¿†å†…å®¹ï¼›$h_t$ æ˜¯æ—¶åˆ» $t$ çš„è¾“å‡ºçŠ¶æ€ã€‚GRU é€šè¿‡å°†æ—¶åˆ» $t-1$ çš„éšè—çŠ¶æ€å’Œå½“å‰æ—¶åˆ»çš„äº¤é€šä¿¡æ¯ä½œä¸ºè¾“å…¥ï¼Œè·å–æ—¶åˆ» $t$ çš„äº¤é€šçŠ¶æ€ã€‚åœ¨æ•è·å½“å‰æ—¶åˆ»çš„äº¤é€šä¿¡æ¯çš„æ—¶å€™ï¼Œæ¨¡å‹ä»ä¿ç•™ç€å†å²ä¿¡æ¯ï¼Œä¸”æœ‰èƒ½åŠ›æ•è·æ—¶é—´ä¾èµ–ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/t-gcn-a-temporal-graph-convolutional-network-for-traffic-prediction/Fig5.JPG"
loading="lazy"
alt="Figure5"
&gt;&lt;/p&gt;
&lt;h3 id="333-temporal-graph-convolutional-network"&gt;3.3.3 Temporal Graph Convolutional Network
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†åŒæ—¶ä»äº¤é€šæ•°æ®ä¸­æ•è·æ—¶ç©ºä¾èµ–ï¼Œæˆ‘ä»¬æå‡ºäº†æ—¶é—´å›¾å·æç½‘ç»œï¼ˆT-GCNï¼‰ã€‚å¦‚å›¾6æ‰€ç¤ºï¼Œå·¦ä¾§æ˜¯æ—¶ç©ºäº¤é€šé¢„æµ‹çš„è¿‡ç¨‹ï¼Œå³ä¾§æ˜¯ä¸€ä¸ª T-GCN ç»†èƒçš„ç»“æ„ï¼Œ$h_{t-1}$ è¡¨ç¤º $t-1$ æ—¶åˆ»çš„è¾“å‡ºï¼ŒGC æ˜¯å›¾å·ç§¯è¿‡ç¨‹ï¼Œ$u_t, r_t$ æ˜¯æ—¶åˆ» $t$ çš„æ›´æ–°é—¨å’Œé‡ç½®é—¨ï¼Œ$h_t$ è¡¨ç¤ºæ—¶åˆ» $t$ çš„è¾“å‡ºã€‚è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ã€‚$f(A, X_t)$ è¡¨ç¤ºå›¾å·ç§¯è¿‡ç¨‹ï¼Œå¦‚å¼ 2 å®šä¹‰ã€‚$W$ å’Œ $b$ è¡¨ç¤ºè®­ç»ƒè¿‡ç¨‹çš„æƒé‡ä¸åç½®ã€‚&lt;/p&gt;
$$\tag{3}
u\_t = \sigma(W\_u[f(A, X\_t), h\_{t-1}] + b\_u)
$$$$\tag{4}
r\_t = \sigma(W\_r[f(A, X\_t), h\_{t-1}] + b\_r)
$$$$\tag{5}
c\_t = tanh(W\_c[f(A, X\_t), (r\_t \ast h\_{t-1})] + b\_c)
$$$$\tag{6}
h\_t = u\_t \ast h\_{t-1} + (1 - u\_t) \ast c\_t
$$&lt;p&gt;æ€»ä¹‹ï¼ŒT-GCN èƒ½å¤„ç†å¤æ‚çš„ç©ºé—´ä¾èµ–å’Œæ—¶é—´åŠ¨æ€æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/t-gcn-a-temporal-graph-convolutional-network-for-traffic-prediction/Fig6.JPG"
loading="lazy"
alt="Figure6"
&gt;&lt;/p&gt;
&lt;h3 id="334-loss-function"&gt;3.3.4 Loss Function
&lt;/h3&gt;&lt;p&gt;æŸå¤±å‡½æ•°å¦‚å¼ 7ã€‚ç¬¬ä¸€é¡¹ç”¨æ¥å‡å°é€Ÿåº¦çš„è¯¯å·®ã€‚ç¬¬äºŒé¡¹ $L_{reg}$ æ˜¯ä¸€ä¸ª $L2$ æ­£åˆ™é¡¹ï¼Œé¿å…è¿‡æ‹Ÿåˆï¼Œ$\lambda$ æ˜¯è¶…å‚ã€‚&lt;/p&gt;
$$\tag{7}
loss = \Vert Y\_t - \hat{Y}\_t \Vert + \lambda L\_{reg}
$$&lt;h1 id="4-experiments"&gt;4 Experiments
&lt;/h1&gt;&lt;h2 id="41-data-description"&gt;4.1 Data Description
&lt;/h2&gt;&lt;p&gt;ä¸¤ä¸ªæ•°æ®é›†ï¼Œæ·±åœ³å‡ºç§Ÿè½¦å’Œæ´›æ‰çŸ¶çº¿åœˆã€‚ä¸¤ä¸ªæ•°æ®é›†éƒ½å’Œè½¦é€Ÿæœ‰å…³ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ1ï¼‰SZ-taxiã€‚æ•°æ®æ˜¯2015å¹´1æœˆ1æ—¥åˆ°1æœˆ31æ—¥çš„æ·±åœ³å‡ºç§Ÿè½¦è½¨è¿¹æ•°æ®ã€‚æˆ‘ä»¬é€‰äº†ç½—æ¹–åŒº 156 ä¸ªä¸»è¦è·¯æ®µä½œä¸ºç ”ç©¶åŒºåŸŸã€‚å®éªŒæ•°æ®ä¸»è¦æœ‰ä¸¤éƒ¨åˆ†ã€‚ä¸€ä¸ªæ˜¯ 156 * 156 çš„é‚»æ¥çŸ©é˜µï¼Œå¦ä¸€ä¸ªæ˜¯ç‰¹å¾çŸ©é˜µï¼Œæè¿°äº†é€Ÿåº¦éšæ—¶é—´çš„å˜åŒ–ã€‚æˆ‘ä»¬å°†é€Ÿåº¦ä»¥ 15 åˆ†é’Ÿä¸ºå•ä½èšåˆã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰Los-loopã€‚æ•°æ®é›†æ˜¯æ´›æ‰çŸ¶å¿é«˜é€Ÿå…¬è·¯çº¿åœˆçš„å®æ—¶æ•°æ®ã€‚æˆ‘ä»¬é€‰äº† 207 ä¸ªç›‘æµ‹å™¨ï¼Œæ•°æ®æ˜¯ 2012å¹´5æœˆ1æ—¥åˆ°5æœˆ7æ—¥çš„æ•°æ®ã€‚æˆ‘ä»¬ä»¥5åˆ†é’Ÿä¸ºå•ä½èšåˆè½¦é€Ÿã€‚æ•°æ®ä¹Ÿæ˜¯ä¸€ä¸ªé‚»æ¥çŸ©é˜µå’Œä¸€ä¸ªç‰¹å¾çŸ©é˜µã€‚æˆ‘ä»¬ç”¨çº¿æ€§æ’å€¼å¡«è¡¥äº†ç¼ºå¤±å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†è¾“å…¥æ•°æ®å½’ä¸€åŒ–åˆ° $[0, 1]$ã€‚æ­¤å¤–ï¼Œ80% çš„æ•°æ®ç”¨æ¥è®­ç»ƒï¼Œ20% ç”¨æ¥æµ‹è¯•ã€‚æˆ‘ä»¬é¢„æµ‹æœªæ¥15ã€30ã€45ã€60åˆ†é’Ÿçš„è½¦é€Ÿã€‚&lt;/p&gt;
&lt;h2 id="42-evaluation-metrics"&gt;4.2 Evaluation Metrics
&lt;/h2&gt;&lt;p&gt;ï¼ˆ1ï¼‰RMSE:&lt;/p&gt;
$$\tag{8}
RMSE = \sqrt{\frac{1}{n} \sum^n\_{i=1} (Y\_t - \hat{Y}\_t)^2}
$$&lt;p&gt;ï¼ˆ2ï¼‰MAE:&lt;/p&gt;
$$\tag{9}
MAE = \frac{1}{n} \sum^n\_{i=1} \vert Y\_t - \hat{Y}\_t \vert
$$&lt;p&gt;ï¼ˆ3ï¼‰Accuracy:&lt;/p&gt;
$$\tag{10}
Accuracy = 1 - \frac{\Vert Y - \hat{Y} \Vert}{\Vert Y \Vert\_F}
$$&lt;p&gt;ï¼ˆ4ï¼‰Coefficient of Determination (R2):&lt;/p&gt;
$$\tag{11}
R^2 = 1 - \frac{\sum\_{i=1} (Y\_t - \hat{Y}\_t)^2}{\sum\_{i=1}(Y\_t - \bar{Y})^2}
$$&lt;p&gt;ï¼ˆ5ï¼‰Explained Variance Score(Var):&lt;/p&gt;
$$
var = 1 - \frac{Var\lbrace Y - \hat{Y}\rbrace}{Var\lbrace Y\rbrace}
$$&lt;p&gt;RMSE å’Œ MAE ç”¨æ¥è¯„ä¼°é¢„æµ‹è¯¯å·®ï¼šè¶Šå°è¶Šå¥½ã€‚ç²¾åº¦è¡¡é‡é¢„æµ‹çš„ç²¾åº¦ï¼šè¶Šå¤§è¶Šå¥½ã€‚$R^2$ å’Œ Var è®¡ç®—ç›¸å…³ç³»æ•°ï¼Œè¯„ä¼°é¢„æµ‹ç»“æœè¡¨è¾¾çœŸå®æ•°æ®çš„èƒ½åŠ›ï¼Œè¶Šå¤§è¶Šå¥½ã€‚&lt;/p&gt;
&lt;h2 id="43-model-parameters-designing"&gt;4.3 Model Parameters Designing
&lt;/h2&gt;&lt;p&gt;(1) Hyperparameter&lt;/p&gt;
&lt;p&gt;å­¦ä¹ ç‡ã€batch sizeã€è®­ç»ƒè®ºè¿°ï¼Œéšè—å±‚æ•°ã€‚æˆ‘ä»¬è®¾å®šçš„æ˜¯å­¦ä¹ ç‡0.001ï¼Œbatch size 64ï¼Œè½®æ•° 3000 è½®ã€‚&lt;/p&gt;
&lt;p&gt;éšå±‚å•å…ƒæ•°å¯¹ T-GCN æ¥è¯´æ˜¯ä¸ªé‡è¦çš„å‚æ•°ï¼Œå› ä¸ºä¸åŒçš„å•å…ƒæ•°å¯èƒ½ä¼šå½±å“é¢„æµ‹ç²¾åº¦ã€‚æˆ‘ä»¬é€šè¿‡å®éªŒé€‰å–äº†æœ€ä¼˜çš„éšè—å•å…ƒæ•°ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹ä¸ä¸‹å»äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/t-gcn-a-temporal-graph-convolutional-network-for-traffic-prediction/Fig7.JPG"
loading="lazy"
alt="Figure7"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/t-gcn-a-temporal-graph-convolutional-network-for-traffic-prediction/Table1.JPG"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;</description></item><item><title>Spatiotemporal Multi-Graph Convolution Network for Ride-hailing Demand Forecasting</title><link>https://davidham3.github.io/blog/p/spatiotemporal-multi-graph-convolution-network-for-ride-hailing-demand-forecasting/</link><pubDate>Thu, 28 Feb 2019 21:12:58 +0000</pubDate><guid>https://davidham3.github.io/blog/p/spatiotemporal-multi-graph-convolution-network-for-ride-hailing-demand-forecasting/</guid><description>&lt;p&gt;AAAI 2019ï¼Œæ»´æ»´çš„ç½‘çº¦è½¦éœ€æ±‚é¢„æµ‹ï¼Œ5ä¸ªç‚¹é¢„æµ‹1ä¸ªç‚¹ã€‚ç©ºé—´ä¾èµ–å»ºæ¨¡ä¸Šï¼šä»¥å›¾çš„å½¢å¼è¡¨ç¤ºæ•°æ®ï¼Œä»ç©ºé—´åœ°ç†å…³ç³»ã€åŒºåŸŸåŠŸèƒ½ç›¸ä¼¼åº¦ã€åŒºåŸŸäº¤é€šè¿é€šæ€§ä¸‰ä¸ªè§’åº¦æ„é€ äº†ä¸‰ä¸ªä¸åŒçš„å›¾ï¼Œæå‡ºäº†å¤šå›¾å·ç§¯ï¼Œåˆ†åˆ«ç”¨ k é˜¶ ChebNet å¯¹æ¯ä¸ªå›¾åšå›¾å·ç§¯ï¼Œç„¶åå°†å¤šä¸ªå›¾çš„å·ç§¯ç»“æœè¿›è¡Œèšåˆ(sum, average ç­‰)æˆä¸€ä¸ªå›¾ï¼›æ—¶é—´ä¾èµ–å»ºæ¨¡ä¸Šï¼šæå‡ºäº†èåˆèƒŒæ™¯ä¿¡æ¯çš„ Contextual Gated RNN (CGRNN)ï¼Œç”¨ ChebNet å¯¹æ¯ä¸ªç»“ç‚¹å·ç§¯åï¼Œå¾—åˆ°ä»–ä»¬çš„é‚»å±…è¡¨ç¤ºï¼Œå³æ¯ä¸ªç»“ç‚¹çš„èƒŒæ™¯ä¿¡æ¯è¡¨ç¤ºï¼Œä¸åŸç»“ç‚¹ç‰¹å¾æ‹¼æ¥ï¼Œç”¨ä¸€ä¸ªä¸¤å±‚å…¨è¿æ¥ç¥ç»ç½‘ç»œè®¡ç®—å‡º T ä¸ªæƒé‡ï¼Œå°†æƒé‡ä¹˜åˆ°å†å² T ä¸ªæ—¶åˆ»çš„å›¾ä¸Šï¼Œå¯¹å†å²å€¼è¿›è¡Œç¼©æ”¾ï¼Œç„¶åç”¨ä¸€ä¸ªå…±äº«çš„ RNNï¼Œé’ˆå¯¹æ¯ä¸ªç»“ç‚¹å½¢æˆçš„é•¿åº¦ä¸º T çš„æ—¶é—´åºåˆ—å»ºæ¨¡ï¼Œå¾—åˆ°æ¯ä¸ªç»“ç‚¹æ–°çš„æ—¶é—´è¡¨ç¤ºã€‚æœ€åé¢„æµ‹æ¯ä¸ªç‚¹çš„ç½‘çº¦è½¦éœ€æ±‚ã€‚åŸæ–‡åœ°å€ï¼š&lt;a class="link" href="http://www-scf.usc.edu/~yaguang/papers/aaai19_multi_graph_convolution.pdf" target="_blank" rel="noopener"
&gt;Spatiotemporal Multi-Graph Convolution Network for Ride-hailing Demand Forecasting&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;åŒºåŸŸçº§åˆ«çš„é¢„æµ‹æ˜¯ç½‘çº¦è½¦æœåŠ¡çš„å…³é”®ä»»åŠ¡ã€‚ç²¾ç¡®åœ°å¯¹ç½‘çº¦è½¦éœ€æ±‚é¢„æµ‹å¯ä»¥æŒ‡å¯¼è½¦è¾†è°ƒåº¦ã€æé«˜è½¦è¾†åˆ©ç”¨ç‡ï¼Œå‡å°‘ç”¨æˆ·çš„ç­‰å¾…æ—¶é—´ï¼Œå‡è½»äº¤é€šæ‹¥å µã€‚è¿™ä¸ªä»»åŠ¡çš„å…³é”®åœ¨äºåŒºåŸŸé—´å¤æ‚çš„æ—¶ç©ºä¾èµ–å…³ç³»ã€‚ç°å­˜çš„æ–¹æ³•ä¸»è¦å…³æ³¨ä¸´è¿‘åŒºåŸŸçš„æ¬§å¼å…³ç³»å»ºæ¨¡ï¼Œä½†æ˜¯åœ¨è·ç¦»è¾ƒè¿œçš„åŒºåŸŸé—´ç»„æˆçš„éæ¬§å¼å…³ç³»å¯¹ç²¾ç¡®é¢„æµ‹ä¹Ÿå¾ˆå…³é”®ã€‚æˆ‘ä»¬æå‡ºäº† &lt;em&gt;spatiotemporal multi-graph convolution network&lt;/em&gt; (ST-MGCN)ã€‚æˆ‘ä»¬é¦–å…ˆå°†éæ¬§çš„å…³ç³»å¯¹ç¼–ç åˆ°å¤šä¸ªå›¾ä¸­ï¼Œç„¶åä½¿ç”¨ multi-graph convolution å¯¹ä»–ä»¬å»ºæ¨¡ã€‚ä¸ºäº†åœ¨æ—¶é—´å»ºæ¨¡ä¸Šåˆ©ç”¨å…¨å±€çš„èƒŒæ™¯ä¿¡æ¯ï¼Œæˆ‘ä»¬æå‡ºäº† &lt;em&gt;contextual gated recurrent neural network&lt;/em&gt;ï¼Œç”¨ä¸€ä¸ªæ³¨æ„èƒŒæ™¯çš„é—¨æœºåˆ¶å¯¹ä¸åŒçš„å†å²è§‚æµ‹å€¼é‡æ–°åˆ†é…æƒé‡ã€‚åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šæ¯”å½“å‰çš„ state-of-the-art å¼º 10%ã€‚&lt;/p&gt;
&lt;h1 id="introduction"&gt;Introduction
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬ç ”ç©¶çš„é—®é¢˜æ˜¯åŒºåŸŸçº§åˆ«ç½‘çº¦è½¦éœ€æ±‚é¢„æµ‹ï¼Œæ˜¯æ™ºèƒ½è¿è¾“ç³»ç»Ÿçš„é‡è¦éƒ¨åˆ†ã€‚ç›®æ ‡æ˜¯é€šè¿‡å†å²è§‚æµ‹å€¼ï¼Œé¢„æµ‹ä¸€ä¸ªåŸå¸‚é‡Œé¢å„åŒºåŸŸæœªæ¥çš„éœ€æ±‚ã€‚ä»»åŠ¡çš„æŒ‘æˆ˜æ˜¯å¤æ‚çš„æ—¶ç©ºå…³ç³»ã€‚ä¸€æ–¹é¢ï¼Œä¸åŒåŒºåŸŸæœ‰ç€å¤æ‚çš„ä¾èµ–å…³ç³»ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªåŒºåŸŸçš„éœ€æ±‚é€šå¸¸å—å…¶ç©ºé—´ä¸Šä¸´è¿‘çš„åŒºåŸŸæ‰€å½±å“ï¼ŒåŒæ—¶ä¸æœ‰ç€ç›¸åŒèƒŒæ™¯çš„è¾ƒè¿œçš„åŒºåŸŸæœ‰è”ç³»ã€‚å¦ä¸€æ–¹é¢ï¼Œéçº¿æ€§çš„ä¾èµ–å…³ç³»ä¹Ÿå­˜åœ¨äºä¸åŒçš„æ—¶é—´è§‚æµ‹å€¼ä¹‹é—´ã€‚é¢„æµ‹ä¸€ä¸ªæ—¶åˆ»é€šå¸¸å’Œå¤šä¸ªå†å²çš„è§‚æµ‹å€¼ç›¸å…³ï¼Œæ¯”å¦‚ä¸€å°æ—¶å‰ã€ä¸€å¤©å‰ã€ç”šè‡³ä¸€å‘¨å‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/spatiotemporal-multi-graph-convolution-network-for-ride-hailing-demand-forecasting/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;æœ€è¿‘åœ¨æ·±åº¦å­¦ä¹ çš„è¿›æ­¥ä½¿å¾—å¯¹åŸºäºåŒºåŸŸçº§åˆ«çš„æ—¶ç©ºå…³ç³»é¢„æµ‹æœ‰äº†å¾ˆå¥½çš„ç»“æœã€‚ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œå’Œå¾ªç¯ç¥ç»ç½‘ç»œï¼Œå¾—åˆ°äº†å¾ˆå¤šéå¸¸å¥½çš„æ•ˆæœ(Shi et al. 2015; Yu et al. 2017; Shi et al. 2017; Zhang, Zheng, and Qi 2017; Zhang et al. 2018a; Ma et al. 2017; Yao et al. 2018b; 2018a)ã€‚å°½ç®¡æœ‰äº†å¾ˆå¥½çš„æ•ˆæœï¼Œä½†æ˜¯æˆ‘ä»¬è®¤ä¸ºåœ¨å¯¹æ—¶ç©ºå…³ç³»å»ºæ¨¡ä¸Šæœ‰ä¸¤ç‚¹è¢«å¿½ç•¥äº†ã€‚å…¶ä¸€ï¼Œè¿™äº›æ–¹æ³•ä¸»è¦å¯¹ä¸åŒåŒºåŸŸçš„æ¬§å¼å…³ç³»å»ºæ¨¡ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°éæ¬§å…³ç³»å¾ˆé‡è¦ã€‚å›¾ 1 æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå¯¹äºåŒºåŸŸ 1ï¼Œä»¥åŠé‚»å±…åŒºåŸŸ 2ï¼Œå¯èƒ½å’Œå¾ˆè¿œçš„åŒºåŸŸ 3 æœ‰ç›¸ä¼¼çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯ä»–ä»¬éƒ½é è¿‘å­¦æ ¡å’ŒåŒ»é™¢ã€‚æ­¤å¤–ï¼ŒåŒºåŸŸ 1 è¿˜å¯èƒ½è¢«åŒºåŸŸ 4 å½±å“ï¼ŒåŒºåŸŸ 4 æ˜¯é€šè¿‡é«˜é€Ÿå…¬è·¯ç›´æ¥ä¸åŒºåŸŸ 1 ç›¸è¿çš„ã€‚å…¶äºŒï¼šè¿™äº›æ–¹æ³•ä¸­ï¼Œåœ¨ä½¿ç”¨ RNN å¯¹æ—¶é—´å…³ç³»å»ºæ¨¡æ—¶ï¼Œæ¯ä¸ªåŒºåŸŸæ˜¯ç‹¬ç«‹å¤„ç†çš„ï¼Œæˆ–è€…åªåŸºäºå±€éƒ¨ä¿¡æ¯ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬è®¤ä¸ºå…¨å±€å’ŒèƒŒæ™¯ä¿¡æ¯ä¹Ÿå¾ˆé‡è¦ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œç½‘çº¦è½¦éœ€æ±‚çš„ä¸€ä¸ªå…¨å±€æ€§çš„å¢é•¿/å‡å°é€šå¸¸è¡¨æ˜ä¸€äº›å¯èƒ½ä¼šå½±å“æœªæ¥éœ€æ±‚çš„æ´»åŠ¨å‘ç”Ÿäº†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æå‡ºäº† ST-MGCN è§£å†³è¿™äº›é—®é¢˜ã€‚åœ¨ ST-MGCN ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†å°†åŒºåŸŸé—´éæ¬§å…³ç³»ç¼–ç è¿›å¤šä¸ªå›¾çš„æ–¹æ³•ã€‚ä¸åŒäº Yao et al. 2018b ç»™æ¯ä¸ªåŒºåŸŸä½¿ç”¨å›¾åµŒå…¥ä½œä¸ºé¢å¤–çš„ä¸å˜ç‰¹å¾ï¼Œæˆ‘ä»¬ç”¨å›¾å·ç§¯å¯¹åŒºåŸŸé—´çš„å…³ç³»å¯¹ç›´æ¥å»ºæ¨¡ã€‚å›¾å·ç§¯åœ¨é¢„æµ‹çš„æ—¶å€™å¯ä»¥èšåˆé‚»å±…ç‰¹å¾ï¼Œä¼ ç»Ÿçš„å›¾åµŒå…¥éš¾ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚æ­¤å¤–ï¼Œåœ¨å¯¹æ—¶é—´å…³ç³»å»ºæ¨¡æ—¶ï¼Œä¸ºäº†èšåˆå…¨å±€çš„èƒŒæ™¯ä¿¡æ¯ï¼Œæˆ‘ä»¬æå‡ºäº† contextual gated recurrent neural network (CGRNN)ã€‚é€šè¿‡ä¸€ä¸ªåŸºäºå…¨å±€ä¿¡æ¯è®¡ç®—çš„é—¨æœºåˆ¶å¢å¼º RNNï¼Œå¯¹ä¸åŒæ—¶é—´æ­¥çš„è§‚æµ‹å€¼é‡æ–°èµ‹æƒé‡ã€‚æˆ‘ä»¬åœ¨ä¸¤ä¸ªå¤§å‹çš„çœŸå®æ•°æ®é›†ä¸Šåšäº†æµ‹è¯•ï¼ŒST-MGCN æ¯” baselines å¥½äº†ä¸€å¤§æˆªã€‚æˆ‘ä»¬ä¸»è¦çš„è´¡çŒ®æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¯†åˆ«äº†ç½‘çº¦è½¦éœ€æ±‚é¢„æµ‹ä¸­çš„éæ¬§å…³ç³»ï¼Œå°†ä»–ä»¬ç¼–ç è¿›å¤šä¸ªå›¾ã€‚åˆ©ç”¨å¤šå›¾å·ç§¯å¯¹è¿™äº›å…³ç³»å»ºæ¨¡ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹æ—¶é—´ä¾èµ–ï¼Œæå‡ºäº† Contextual Gated RNN (CGRNN) æ¥é›†æˆå…¨å±€èƒŒæ™¯ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ä¸¤ä¸ªå¤§å‹çœŸå®æ•°æ®é›†ä¸Šåšäº†å®éªŒï¼Œæå‡ºçš„æ–¹æ³•æ¯” state-of-the-art åœ¨ç›¸å¯¹è¯¯å·®ä¸Šå°äº† 10%.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="related-work"&gt;Related work
&lt;/h1&gt;&lt;h2 id="spatiotemporal-prediction-in-urban-computing"&gt;Spatiotemporal prediction in urban computing
&lt;/h2&gt;&lt;p&gt;æ—¶ç©ºé¢„æµ‹æ˜¯æ•°æ®é©±åŠ¨çš„åŸå¸‚ç®¡ç†çš„åŸºç¡€é—®é¢˜ã€‚æœ‰å¾ˆå¤šå…³äºè¿™æ–¹é¢çš„å·¥ä½œï¼Œè‡ªè¡Œè½¦æµé‡é¢„æµ‹(Zhang, Zheng, and Qi 2017)ï¼Œå‡ºç§Ÿè½¦éœ€æ±‚(Ke et al. 2017b; Yao et al. 2018b)ï¼Œåˆ°è¾¾æ—¶é—´(Li et al. 2018b)ï¼Œé™é›¨é‡(Shi et al. 2015; 2017)ï¼Œå¯¹çŸ©å½¢åŒºåŸŸçš„èšåˆå€¼è¿›è¡Œé¢„æµ‹ï¼ŒåŒºåŸŸå…³ç³»é€šè¿‡åœ°ç†è·ç¦»å»ºæ¨¡ã€‚å…·ä½“æ¥è®²ï¼ŒåŸå¸‚æ•°æ®çš„ç©ºé—´ç»“æ„é€šè¿‡çŸ©é˜µå½¢å¼è¡¨ç¤ºï¼Œæ¯ä¸ªå…ƒç´ è¡¨ç¤ºä¸€ä¸ªçŸ©å½¢åŒºåŸŸã€‚åœ¨ä¹‹å‰çš„å·¥ä½œä¸­ï¼ŒåŒºåŸŸå’Œä»–ä»¬çš„å…³ç³»å¯¹ä¸€èˆ¬è¡¨ç¤ºæˆæ¬§å¼ç»“æ„ï¼Œä½¿å¾—å·ç§¯ç¥ç»ç½‘ç»œå¯ä»¥æœ‰æ•ˆåœ°åˆ©ç”¨è¿™ä¸ªç»“æ„æ¥é¢„æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;éæ¬§ç»“æ„çš„æ•°æ®ä¹Ÿå­˜åœ¨äºåŸå¸‚è®¡ç®—ã€‚é€šå¸¸ï¼ŒåŸºäºç«™ç‚¹æˆ–ç‚¹çš„é¢„æµ‹ä»»åŠ¡ï¼Œåƒæµé‡é¢„æµ‹(Li et al. 2018c; Yu, Yin, and Zhu 2018; Yao et al. 2018a)ï¼ŒåŸºäºç‚¹çš„å‡ºç§Ÿè½¦éœ€æ±‚é¢„æµ‹(Tong et al. 2017)ä»¥åŠåŸºäºç«™ç‚¹çš„è‡ªè¡Œè½¦æµé‡é¢„æµ‹(Chai, Wang, and Yang 2018)æ˜¯å¾ˆè‡ªç„¶çš„éæ¬§ç»“æ„ï¼Œæ•°æ®ä¸å†æ˜¯çŸ©é˜µå½¢å¼ï¼Œå·ç§¯ç¥ç»ç½‘ç»œä¹Ÿä¸é‚£ä¹ˆæœ‰æ•ˆäº†ã€‚äººå·¥å®šåˆ¶çš„ç‰¹å¾å·¥ç¨‹æˆ–å›¾å·ç§¯ç½‘ç»œæ˜¯å¤„ç†éæ¬§ç»“æ„æ•°æ®ç›®å‰æœ€å¥½çš„æ–¹æ³•ã€‚ä¸åŒäºä¹‹å‰çš„å·¥ä½œï¼ŒST-MGCN å°†åŒºåŸŸé—´çš„å…³ç³»å¯¹ç¼–ç è¿›è¯­ä¹‰å›¾ä¸­ã€‚å°½ç®¡ ST-MGCN æ˜¯å¯¹åŸºäºåŒºåŸŸçš„é¢„æµ‹è®¾è®¡çš„ï¼Œä½†æ˜¯åŒºåŸŸå…³ç³»çš„éè§„æ•´æ€§ä½¿å¾—å®ƒå®é™…æ˜¯å¯¹éæ¬§æ•°æ®è¿›è¡Œé¢„æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ (Yao et al. 2018b)ï¼Œä½œè€…æå‡º DMVST-Netï¼Œå°†åŒºåŸŸé—´å…³ç³»ç¼–ç è¿›å›¾ä¸­æ¥é¢„æµ‹å‡ºç§Ÿè½¦éœ€æ±‚ã€‚DMVST-Net ä¸»è¦ä½¿ç”¨å›¾åµŒå…¥ä½œä¸ºé¢å¤–ç‰¹å¾æ¥é¢„æµ‹ï¼Œæ²¡æœ‰ä½¿ç”¨ç›¸å…³åŒºåŸŸçš„éœ€æ±‚å€¼ï¼ˆç›®æ ‡å€¼ï¼‰ã€‚åœ¨ (Yao et al. 2018a) çš„å·¥ä½œä¸­ï¼Œä½œè€…é€šè¿‡æ³¨æ„åŠ›æœºåˆ¶å¯¹å‘¨æœŸæ€§çš„å¹³ç§»é—®é¢˜å»ºæ¨¡æå‡äº†æ€§èƒ½ã€‚ä½†æ˜¯ï¼Œè¿™äº›æ–¹æ³•éƒ½æ²¡æœ‰ç›´æ¥å¯¹åŒºåŸŸé—´çš„éæ¬§å…³ç³»å»ºæ¨¡ã€‚æˆ‘ä»¬çš„å·¥ä½œä¸­ï¼ŒST-MGCN ä½¿ç”¨æå‡ºçš„å¤šå›¾å·ç§¯ä»ç›¸å…³åŒºåŸŸèšåˆç‰¹å¾ï¼Œä»ä¸åŒè§’åº¦çš„ç›¸å…³åŒºåŸŸçš„é¢„æµ‹å€¼ä¸­åšé¢„æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘åœ¨å¯¹å¸•é‡‘æ£®çš„ç¥ç»å›¾åƒåˆ†æ (Zhang et al. 2018b) çš„ç ”ç©¶ä¸­ï¼Œå›¾å·ç§¯åœ¨ç©ºé—´ç‰¹å¾æå–ä¸Šå¾ˆæœ‰æ•ˆã€‚ä»–ä»¬ä½¿ç”¨ GCN ä»æœ€ç›¸ä¼¼çš„åŒºåŸŸä¸­å­¦ä¹ ç‰¹å¾ï¼Œæå‡ºäº†å¤šè§†å›¾ç»“æ„èåˆäº†ä¸åŒçš„ MRIã€‚ç„¶è€Œï¼Œä¸Šè¿°å·¥ä½œæ²¡æœ‰è€ƒè™‘æ—¶é—´ä¾èµ–ã€‚ST-GCN ç”¨äºåŸºäºéª¨éª¼çš„åŠ¨ä½œè¯†åˆ«(Li et al. 2018a; Yan, Xiong, and Lin 2018)ã€‚ST-GCN çš„å˜æ¢æ˜¯ä¸€ä¸ªç©ºé—´ä¾èµ–å’Œå±€éƒ¨æ—¶é—´å¾ªç¯çš„ç»„åˆã€‚ç„¶è€Œï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™äº›æ¨¡å‹ï¼Œåœ¨æ—¶é—´ä¾èµ–å»ºæ¨¡ä¸Šï¼ŒèƒŒæ™¯ä¿¡æ¯æˆ–å…¨å±€ä¿¡æ¯è¢«å¿½ç•¥äº†ã€‚&lt;/p&gt;
&lt;h2 id="graph-convolution-network"&gt;Graph convolution network
&lt;/h2&gt;&lt;p&gt;å›¾å·ç§¯ç½‘ç»œå®šä¹‰åœ¨å›¾ $\mathcal{G} = (V, \boldsymbol{A})$ ä¸Šï¼Œ$V$ æ˜¯é¡¶ç‚¹é›†ï¼Œ$\boldsymbol{A} \in \mathbb{R}^{\vert V \vert \times \vert V \vert}$ æ˜¯é‚»æ¥çŸ©é˜µï¼Œå…ƒç´ è¡¨ç¤ºé¡¶ç‚¹é—´æ˜¯å¦ç›¸è¿ã€‚GCN å¯ä»¥ç”¨ä¸åŒçš„æ„Ÿå—é‡ä»ä¸åŒçš„éæ¬§ç»“æ„ä¸­æå–å±€éƒ¨ç‰¹å¾(Hammond et al. 2011)ã€‚ä»¤ $\boldsymbol{L} = \boldsymbol{I} - \boldsymbol{D}^{-1/2} \boldsymbol{A} \boldsymbol{D}^{-1/2}$ è¡¨ç¤ºå›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼Œ$\boldsymbol{D}$ æ˜¯åº¦çŸ©é˜µï¼Œå›¾å·ç§¯æ“ä½œ (Defferrard, Bresson, and Vandergheynst 2016) å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$
\boldsymbol{X}\_{l+1} = \sigma (\sum^{K-1}\_{k=0} \alpha\_k \boldsymbol{L}^k \boldsymbol{X}\_l),
$$&lt;p&gt;$\boldsymbol{X}_l$ è¡¨ç¤ºç¬¬ $l$ å±‚çš„ç‰¹å¾ï¼Œ$\alpha_k$ è¡¨ç¤ºå¯å­¦ä¹ çš„å‚æ•°ï¼Œ$\boldsymbol{L}^k$ æ˜¯å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ $k$ æ¬¡å¹‚ï¼Œ$\sigma$ æ˜¯æ¿€æ´»å‡½æ•°ã€‚&lt;/p&gt;
&lt;h2 id="channel-wise-attention"&gt;Channel-wise attention
&lt;/h2&gt;&lt;p&gt;Channel-wise attention (Hu, Shen, and Sun 2018; Chen et al. 2017) åœ¨ cv çš„è®ºæ–‡ä¸­æå‡ºã€‚æœ¬è´¨æ˜¯ç»™æ¯ä¸ªé€šé“å­¦ä¹ ä¸€ä¸ªæƒé‡ï¼Œä¸ºäº†æ‰¾åˆ°æœ€é‡è¦çš„å¸§ï¼Œç„¶ååŸºäºä»–ä»¬æ›´é«˜çš„æƒé‡ã€‚$\boldsymbol{X} \in \mathbb{R}^{W \times H \times C}$ è¡¨ç¤ºè¾“å…¥ï¼Œ$W$ å’Œ $H$ æ˜¯è¾“å…¥å›¾åƒçš„ç»´åº¦ï¼Œ$C$ è¡¨ç¤ºé€šé“æ•°ï¼Œchannel-wise attention è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{1}
z\_c = F\_{pool}(\boldsymbol{X}\_{:,:,c}) = \frac{1}{WH} \sum^W\_{i=0} \sum^H\_{j=0} X\_{i,j,c} \quad \text{for} c=1,2,\dots,C \\
\boldsymbol{s} = \sigma(\boldsymbol{W}\_2 \delta (\boldsymbol{W}\_1 \boldsymbol{z})) \\
\tilde{\boldsymbol{X}}\_{:,:,c} = \boldsymbol{X}\_{:,:,c} \circ s\_c \quad \text{for} c=1,2,\dots,C
$$&lt;p&gt;$F_{pool}$ æ˜¯å…¨å±€æ± åŒ–æ“ä½œï¼ŒæŠŠæ¯ä¸ªé€šé“èšåˆæˆä¸€ä¸ªæ ‡é‡ $\boldsymbol{z}_c$ï¼Œ$c$ æ˜¯é€šé“çš„ä¸‹æ ‡ã€‚ç”¨ä¸€ä¸ªæ³¨æ„åŠ›æœºåˆ¶å¯¹èšåˆçš„å‘é‡ $\boldsymbol{z}$ ä½¿ç”¨éçº¿æ€§å˜æ¢ç”Ÿæˆè‡ªé€‚åº”çš„é€šé“æƒé‡ $\boldsymbol{s}$ï¼Œ$\boldsymbol{W}_1, \boldsymbol{W}_2$ æ˜¯å¯¹åº”çš„æƒé‡ï¼Œ$\delta, \sigma$ æ˜¯ ReLU å’Œ sigmoid æ¿€æ´»å‡½æ•°ã€‚$\boldsymbol{s}$ é€šè¿‡çŸ©é˜µä¹˜æ³•ä¹˜åˆ°è¾“å…¥ä¸Šã€‚æœ€åï¼Œè¾“å…¥é€šé“åŸºäºå­¦ä¹ åˆ°çš„æƒé‡å¾—åˆ°äº†ç¼©æ”¾ã€‚æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œé’ˆå¯¹ä¸€ç³»åˆ—çš„å›¾ç”Ÿæˆäº†æ—¶é—´ä¾èµ–çš„æ³¨æ„åŠ›åˆ†æ•°ã€‚&lt;/p&gt;
&lt;h1 id="methodology"&gt;Methodology
&lt;/h1&gt;&lt;h2 id="region-level-ride-hailing-demand-forecasting"&gt;Region-level ride-hailing demand forecasting
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬å°†åŸå¸‚åˆ†ä¸ºç›¸åŒå¤§å°çš„ç½‘æ ¼ï¼Œæ¯ä¸ªæ ¼å­å®šä¹‰ä¸ºä¸€ä¸ªåŒºåŸŸ $v \in V$ï¼Œ$V$ è¡¨ç¤ºåŸå¸‚å†…æ‰€æœ‰ä¸ç›¸äº¤çš„åŒºåŸŸã€‚$\boldsymbol{X}^{(t)}$ è¡¨ç¤ºç¬¬ $t$ ä¸ªæ—¶æ®µæ‰€æœ‰åŒºåŸŸçš„è®¢å•ã€‚&lt;em&gt;åŒºåŸŸçº§åˆ«çš„ç½‘çº¦è½¦éœ€æ±‚é¢„æµ‹&lt;/em&gt; é—®é¢˜å®šä¹‰ä¸ºï¼šç»™å®šä¸€ä¸ªå®šé•¿çš„è¾“å…¥ï¼Œå¯¹å•ä¸ªæ—¶é—´æ­¥è¿›è¡Œæ—¶ç©ºé¢„æµ‹ï¼Œä¹Ÿå°±æ˜¯å­¦ä¹ ä¸€ä¸ªå‡½æ•° $f: \mathbb{R}^{\vert V \vert \times T} \rightarrow \mathbb{R}^{\vert V \vert}$ï¼Œå°†æ‰€æœ‰åŒºåŸŸçš„å†å²éœ€æ±‚æ˜ å°„åˆ°ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ä¸Šã€‚&lt;/p&gt;
$$
[\boldsymbol{X}^{(t-T+1)}, \dots, \boldsymbol{X}^{(t)}]
$$&lt;p&gt;&lt;strong&gt;Framework overview&lt;/strong&gt; ST-MGCN çš„ç³»ç»Ÿæ¶æ„å¦‚å›¾2ã€‚æˆ‘ä»¬ä»ä¸åŒçš„è§’åº¦è¡¨ç¤ºåŒºåŸŸé—´çš„å…³ç³»ï¼Œé¡¶ç‚¹è¡¨ç¤ºåŒºåŸŸï¼Œè¾¹å¯¹åŒºåŸŸé—´çš„å…³ç³»ç¼–ç ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨æå‡ºçš„ CGRNNï¼Œè€ƒè™‘å…¨å±€èƒŒæ™¯ä¿¡æ¯å¯¹ä¸åŒæ—¶é—´çš„è§‚æµ‹å€¼è¿›è¡Œèšåˆã€‚ç„¶åï¼Œä½¿ç”¨å¤šå›¾å·ç§¯æ•è·åŒºåŸŸé—´ä¸åŒç±»å‹çš„å…³ç³»ã€‚æœ€åï¼Œä½¿ç”¨å…¨è¿æ¥ç¥ç»ç½‘ç»œå°†ç‰¹å¾æ˜ å°„åˆ°é¢„æµ‹ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/spatiotemporal-multi-graph-convolution-network-for-ride-hailing-demand-forecasting/Fig2.JPG"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;h2 id="spatial-dependency-modeling"&gt;Spatial dependency modeling
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ç”¨å›¾å°†åŒºåŸŸé—´å…³ç³»å»ºæ¨¡æˆä¸‰ç§ç±»å‹ï¼Œï¼ˆ1ï¼‰é‚»å±…å›¾ $\mathcal{G}_N = (V, \boldsymbol{A}_N)$ï¼Œç¼–ç äº†ç©ºé—´ç›¸è¿‘ç¨‹åº¦ï¼Œï¼ˆ2ï¼‰åŠŸèƒ½ç›¸ä¼¼åº¦å›¾ $\mathcal{G}_F = (V, \boldsymbol{A}_F)$ï¼Œç¼–ç äº†åŒºåŸŸçš„ POI çš„ç›¸ä¼¼åº¦ï¼Œï¼ˆ3ï¼‰è¿æ¥å›¾ $\mathcal{G}_T = (V, \boldsymbol{A}_T)$ï¼Œç¼–ç äº†è·ç¦»è¾ƒè¿œçš„åŒºåŸŸçš„è¿é€šæ€§ã€‚æˆ‘ä»¬çš„æ–¹æ³•å¯ä»¥è½»æ˜“åœ°æ‰©å±•åˆ°å…¶ä»–çš„å›¾ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Neighborhood&lt;/strong&gt; åŒºåŸŸçš„é‚»å±…åŸºäºç©ºé—´è¿‘é‚»ç¨‹åº¦å®šä¹‰ã€‚æˆ‘ä»¬å°† $3 \times 3$ åŒºåŸŸä¸­çš„æœ€ä¸­é—´çš„é‚£ä¸ªåŒºåŸŸä¸ä»–é‚»æ¥çš„ 8 ä¸ªåŒºåŸŸç›¸è¿ã€‚&lt;/p&gt;
$$\tag{3}
A\_{N, ij} = \begin{cases}
1, \quad v\_i \quad \text{and} \quad v\_j \quad \text{are} \quad \text{adjacent}\\
0, \quad \text{otherwise}
\end{cases}
$$&lt;p&gt;&lt;strong&gt;Functional similarity&lt;/strong&gt; å¯¹ä¸€ä¸ªåŒºåŸŸåšé¢„æµ‹çš„æ—¶å€™ï¼Œå¾ˆè‡ªç„¶çš„ä¼šæƒ³åˆ°å’Œè¿™ä¸ªåŒºåŸŸåœ¨åŠŸèƒ½ä¸Šç›¸ä¼¼çš„åŒºåŸŸä¼šæœ‰å¸®åŠ©ã€‚åŒºåŸŸåŠŸèƒ½å¯ä»¥ç”± POI åˆ»ç”»ï¼Œä¸¤ä¸ªé¡¶ç‚¹é—´çš„è¾¹å®šä¹‰ä¸º POI çš„ç›¸ä¼¼åº¦ï¼š&lt;/p&gt;
$$\tag{3}
A\_{S,i,j} = \text{sim}(P\_{v\_i}, P\_{v\_j}) \in [0, 1]
$$&lt;p&gt;å…¶ä¸­ $P_{v_i}, P_{v_j}$ æ˜¯åŒºåŸŸ $v_i$ å’Œ $v_j$ çš„ POI å‘é‡ï¼Œç»´åº¦ç­‰äº POI ç§ç±»çš„ä¸ªæ•°ï¼Œæ¯ä¸ªåˆ†é‡è¡¨ç¤ºè¿™ä¸ªåŒºåŸŸå†…è¿™ä¸ª POI ç±»å‹çš„æ•°é‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Transportation connectivity&lt;/strong&gt; è¿è¾“ç³»ç»Ÿä¹Ÿæ˜¯ä¸€ä¸ªé‡è¦å› ç´ ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™äº›ç©ºé—´è·ç¦»ä¸Šç›¸è·è¾ƒè¿œä½†æ˜¯å¯ä»¥å¾ˆæ–¹ä¾¿åˆ°è¾¾çš„åŒºåŸŸå¯ä»¥å…³è”èµ·æ¥ã€‚è¿™ç§è¿æ¥åŒ…å«é«˜é€Ÿå…¬è·¯ã€å…¬è·¯ã€åœ°é“è¿™æ ·çš„å…¬å…±è¿è¾“ã€‚æˆ‘ä»¬å®šä¹‰ï¼šå¦‚æœä¸¤ä¸ªåŒºåŸŸé—´é€šè¿‡è¿™äº›è·¯ç›´æ¥ç›¸è¿ï¼Œé‚£ä¹ˆä»–ä»¬ä¹‹é—´æœ‰è¾¹ï¼š&lt;/p&gt;
$$\tag{4}
A\_{C,i,j} = max(0, \text{conn}(v\_i, v\_j) - A\_{N,i,j}) \in \lbrace 0, 1\rbrace
$$&lt;p&gt;$\text{conn}(u, v)$ è¡¨ç¤º $v_i$ å’Œ $v_j$ ä¹‹é—´çš„è¿é€šæ€§ã€‚é‚»å±…çš„è¾¹åœ¨è¿™ä¸ªå›¾ä¸­ç§»é™¤æ‰äº†ï¼Œå‡å°‘å†—ä½™çš„å…³ç³»ï¼Œæ‰€ä»¥è¿™ä¸ªå›¾æœ€åæ˜¯ä¸€ä¸ªç¨€ç–å›¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Multi-graph convolution for spatial dependency modeling&lt;/strong&gt; æœ‰äº†è¿™äº›å›¾ï¼Œæˆ‘ä»¬æå‡ºäº†å¤šå›¾å·ç§¯å¯¹ç©ºé—´å…³ç³»å»ºæ¨¡ï¼š&lt;/p&gt;
$$\tag{5}
\boldsymbol{X}\_{l+1} = \sigma(\bigsqcup\_{\mathbf{A} \in \mathbb{A}} f(\mathbf{A; \theta\_i}) \boldsymbol{X}\_l \mathbf{W}\_l)
$$&lt;p&gt;å…¶ä¸­ $\boldsymbol{X}_l \in \mathbb{R}^{\vert V \vert \times P_l}, \boldsymbol{X}_{l+1} \in \mathbb{R}^{\vert V \vert \times P_{l+1}}$ æ˜¯ç¬¬ $l$ å’Œ $l+1$ å±‚çš„ç‰¹å¾å‘é‡ï¼Œ$\sigma$ æ˜¯æ¿€æ´»å‡½æ•°ï¼Œ$\bigsqcup$ è¡¨ç¤ºèšåˆå‡½æ•°ï¼Œå¦‚ sum, max, average etc. $\mathbb{A}$ è¡¨ç¤ºå›¾çš„é›†åˆï¼Œ$f(\mathbf{A}; \theta_i) \in \mathbb{R}^{\vert V \vert \times \vert V \vert}$ è¡¨ç¤ºå‚æ•°ä¸º $\theta_i$ çš„åŸºäºå›¾ $\mathbf{A} \in \mathbb{A}$ çš„ä¸åŒæ ·æœ¬ç»„æˆçš„çŸ©é˜µçš„èšåˆå€¼ï¼Œ$\mathbf{W}_l \in \mathbb{R}^{P_l \times P_{l+1}}$ è¡¨ç¤ºç‰¹å¾å˜æ¢çŸ©é˜µï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœ $f(\mathbf{A}, \theta_i)$ æ˜¯æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ $\mathbf{L}$ çš„å¤šé¡¹å¼ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯å¤šå›¾ä¸Šçš„ ChebNetã€‚å¦‚æœæ˜¯ $\mathbf{I}$ï¼Œé‚£å°±æ˜¯å…¨è¿æ¥ç¥ç»ç½‘ç»œã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å®ç°çš„æ˜¯ $K$ é˜¶ æ‹‰æ™®æ‹‰æ–¯ $\mathbf{L}$ å¤šé¡¹å¼ï¼Œå›¾ 3 æ˜¯ä¸€ä¸ªä¸­å¿ƒåŒºåŸŸé€šè¿‡å›¾å·ç§¯å±‚å˜æ¢åçš„ä¾‹å­ã€‚å‡è®¾é‚»æ¥çŸ©é˜µä¸­çš„å€¼ä¸æ˜¯ 0 å°±æ˜¯ 1ï¼Œ$L^k_{ij} \not = 0$ è¡¨ç¤º $v_i$ åœ¨ $k$ æ­¥å†…å¯è¾¾ $v_j$ã€‚æ ¹æ®å·ç§¯æ“ä½œï¼Œ$k$ æ˜¯ç©ºé—´ç‰¹å¾æå–æ—¶çš„æ„Ÿå—é‡èŒƒå›´ã€‚ä½¿ç”¨å›¾ 1 çš„é“è·¯è¿é€šæ€§å›¾ $\mathcal{G}_C = (V, \boldsymbol{A}_C)$ æ¥è¯´æ˜ã€‚åœ¨é‚»æ¥çŸ©é˜µ $\boldsymbol{A}_C$ ä¸­ï¼Œæˆ‘ä»¬æœ‰ï¼š&lt;/p&gt;
$$
A\_{C,1,4} = 1; A\_{C,1,6} = 0; A\_{C,4,6} = 1,
$$&lt;p&gt;åœ¨ 1 åº¦æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µä¸­å¯¹åº”çš„åˆ†é‡æ˜¯ï¼š&lt;/p&gt;
$$
L^1\_{C,1,4} \not = 0; L^1\_{C,1,6} = 0; L^1\_{C,4,6} \not = 0
$$&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/spatiotemporal-multi-graph-convolution-network-for-ride-hailing-demand-forecasting/Fig3.JPG"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„æœ€å¤§åº¦æ•° $K$ è®¾ä¸º $1$ï¼Œé‚£ä¹ˆåŒºåŸŸ 1 å˜æ¢çš„ç‰¹å¾å‘é‡ï¼Œå³ $\boldsymbol{X}_{l+1, 1,:}$ ä¸ä¼šåŒ…å«åŒºåŸŸ 6: $\boldsymbol{X}_{l,6,:}$ï¼Œå› ä¸º $L^1_{C,1,6}=0$ã€‚å½“ $K$ å¢å¤§åˆ° 2 çš„æ—¶å€™ï¼Œå¯¹åº”çš„å…ƒç´  $L^2_{C,1,6}$ å˜æˆéé›¶ï¼Œ$\boldsymbol{X}_{l+1,1,:}$ å°±å¯ä»¥åˆ©ç”¨ $\boldsymbol{X}_{l,6,:}$ çš„ä¿¡æ¯äº†ã€‚&lt;/p&gt;
&lt;p&gt;åŸºäºå¤šå›¾å·ç§¯çš„ç©ºé—´ä¾èµ–å»ºæ¨¡ä¸é™äºä¸Šè¿°ä¸‰ç§å›¾ï¼Œå¯ä»¥è½»æ˜“åœ°æ‰©å±•åˆ°å…¶ä»–çš„å›¾ä¸Šï¼Œé€‚ç”¨äºå…¶ä»–çš„æ—¶ç©ºé¢„æµ‹é—®é¢˜ä¸Šã€‚å¤šå›¾å·ç§¯å¯¹åŒºåŸŸé—´çš„å…³ç³»è¿›è¡Œç‰¹å¾æå–ã€‚æ„Ÿå—é‡å°çš„æ—¶å€™ï¼Œä¸“æ³¨äºè¿‘é‚»çš„åŒºåŸŸã€‚å¢å¤§æ‹‰æ™®æ‹‰æ–¯é˜¶æ•°ï¼Œæˆ–è€…å †å å·ç§¯å±‚å¯ä»¥å¢åŠ æ„Ÿå—é‡çš„èŒƒå›´ï¼Œé¼“åŠ±æ¨¡å‹æ•è·å…¨å±€ä¾èµ–å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;å›¾åµŒå…¥æ˜¯å¦ä¸€ç§å¯¹åŒºåŸŸé—´å…³ç³»å»ºæ¨¡çš„æ–¹æ³•ã€‚åœ¨ DMVST-Net (Yao et al. 2018b)ï¼Œä½œè€…ä½¿ç”¨å›¾åµŒå…¥è¡¨ç¤ºåŒºåŸŸé—´å…³ç³»ï¼Œç„¶åå°†åµŒå…¥ä½œä¸ºé¢å¤–ç‰¹å¾åŠ åˆ°æ¯ä¸ªåŒºåŸŸä¸Šã€‚æˆ‘ä»¬è®¤ä¸º ST-MGCN ä¸­çš„ç©ºé—´ä¾èµ–å»ºæ¨¡æ–¹æ³•æ¯”ä¹‹å‰çš„æ–¹æ³•å¥½ï¼Œå› ä¸ºï¼šST-MGCN å°†åŒºåŸŸé—´å…³ç³»ç¼–ç åˆ°å›¾ä¸­ï¼Œé€šè¿‡å›¾å·ç§¯ä»ç›¸å…³åŒºåŸŸèšåˆéœ€æ±‚å€¼ã€‚ä½†æ˜¯åœ¨ DMVST-Net ä¸­åŒºåŸŸå…³ç³»æ˜¯åµŒå…¥åˆ°ä¸€ä¸ªåŸºäºåŒºåŸŸçš„ä¸éšæ—¶é—´å˜åŒ–çš„ç‰¹å¾ä¸­ï¼Œä½œä¸ºçš„æ¨¡å‹çš„è¾“å…¥ï¼Œ&lt;/p&gt;
&lt;p&gt;å°½ç®¡ DMVST-Net ä¹Ÿæ•è·äº†æ‹“æ‰‘ç»“æ„ä¿¡æ¯ï¼Œä½†æ˜¯å®ƒå¾ˆéš¾ä»ç›¸å…³çš„åŒºåŸŸä¸­é€šè¿‡åŒºåŸŸå…³ç³»èšåˆéœ€æ±‚å€¼ã€‚è€Œä¸”ä¸å˜çš„ç‰¹å¾å¯¹æ¨¡å‹è®­ç»ƒçš„è´¡çŒ®æœ‰é™ã€‚&lt;/p&gt;
&lt;h2 id="temporal-correlation-modeling"&gt;Temporal correlation modeling
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬æå‡º Contextual Gated Recurrent Neural Network (CGRNN) å¯¹ä¸åŒæ—¶é—´æ­¥ä¸Šçš„æ ·æœ¬å»ºæ¨¡ã€‚CGRNN é€šè¿‡ä½¿ç”¨ä¸€ä¸ªä¸Šä¸‹æ–‡æ³¨æ„çš„é—¨æœºåˆ¶å¢å¼º RNN å°†èƒŒæ™¯ä¿¡æ¯é›†æˆåˆ°æ—¶é—´å»ºæ¨¡ä¸­ï¼Œç»“æ„å¦‚å›¾ 4ã€‚å‡è®¾æˆ‘ä»¬æœ‰ $T$ ä¸ªè§‚æµ‹æ ·æœ¬ï¼Œ$\boldsymbol{X}^{(t)} \in \mathbb{R}^{\vert V \vert \times P}$ è¡¨ç¤ºç¬¬ $t$ ä¸ªæ ·æœ¬ï¼Œ$P$ æ˜¯ç‰¹å¾æ•°ï¼Œå¦‚æœç‰¹å¾åªåŒ…å«è®¢å•æ•°ï¼Œé‚£å°±æ˜¯ 1ã€‚ä¸Šä¸‹æ–‡é—¨æ§æœºåˆ¶å¦‚ä¸‹ï¼š&lt;/p&gt;
$$tag{6}
\hat{\boldsymbol{X}}^{(t)} = [\boldsymbol{X}^{(t)}, F^{K'}\_\mathcal{G}(\boldsymbol{X}^{(t)})] \quad \text{for} \quad t = 1,2,\dots,T
$$&lt;p&gt;é¦–å…ˆï¼Œä¸Šä¸‹æ–‡é—¨æ§æœºåˆ¶é€šè¿‡å°†ä¸´è¿‘åŒºåŸŸçš„å†å²ä¿¡æ¯å’Œå½“å‰åŒºåŸŸæ‹¼æ¥ï¼Œå¾—åˆ°äº†åŒºåŸŸçš„æè¿°ä¿¡æ¯ã€‚ä»ç›¸é‚»åŒºåŸŸæ¥çš„ä¿¡æ¯çœ‹ä½œæ˜¯ç¯å¢ƒä¿¡æ¯ï¼Œé€šè¿‡å›¾å·ç§¯ $F^{K&amp;rsquo;}_\mathcal{G}$ ä½¿ç”¨æœ€å¤§é˜¶æ•°ä¸º $K&amp;rsquo;$ çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µæå–ã€‚ä¸Šä¸‹æ–‡é—¨æ§æœºåˆ¶ç”¨æ¥ç”¨å›¾å·ç§¯æ“ä½œé›†æˆä¸´è¿‘åŒºåŸŸçš„ä¿¡æ¯ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªæ± åŒ–ï¼š&lt;/p&gt;
$$\tag{7}
z^{(t)} = F\_{pool}(\hat{\boldsymbol{X}}^{(t)}) = \frac{1}{\vert V \vert} \sum^{\vert V \vert}\_{i=1} \hat{X}^{(t)}\_{i,:} \quad \text{for} \quad t=1,2,\dots,T
$$&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬åœ¨æ‰€æœ‰çš„åŒºåŸŸä¸Šä½¿ç”¨å…¨å±€å¹³å‡æ± åŒ– $F_{pool}$ ç”Ÿæˆæ¯ä¸ªæ—¶é—´æ­¥è§‚æµ‹å€¼çš„å¹³å‡å€¼ã€‚&lt;/p&gt;
$$tag{8}
\boldsymbol{s} = \sigma(\boldsymbol{W}\_2 \delta(\boldsymbol{W}\_1) \boldsymbol{z})
$$&lt;p&gt;ç„¶åä½¿ç”¨ä¸€ä¸ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œ$\boldsymbol{W}_1, \boldsymbol{W}_2$ æ˜¯å‚æ•°ï¼Œ$\delta, \sigma$ åˆ†åˆ«æ˜¯ ReLU å’Œ sigmoid æ¿€æ´»ã€‚&lt;/p&gt;
$$\tag{9}
\tilde{\boldsymbol{X}^{(t)}} = \boldsymbol{X}^{(t)} \circ s^{(t)} \quad \text{for} \quad t=1,2,\dots,T
$$&lt;p&gt;æœ€åï¼Œ$\boldsymbol{s}$ ç”¨æ¥å¯¹æ¯ä¸ªæ—¶é—´æ ·æœ¬è¿›è¡Œç¼©æ”¾ï¼š&lt;/p&gt;
$$tag{10}
\boldsymbol{H}\_{i,:} = \text{RNN}(\tilde{\boldsymbol{X}}^{(1)}\_{i,:}, \dots, \tilde{\boldsymbol{X}}^{(T)}\_{i,:}; \boldsymbol{W}\_3) \quad \text{for} \quad i=1,\dots,\vert V \vert
$$&lt;p&gt;åœ¨ä¸Šä¸‹æ–‡é—¨æ§ä¹‹åï¼Œä½¿ç”¨ä¸€ä¸ªå…±äº«çš„ RNN å¯¹æ‰€æœ‰çš„åŒºåŸŸè¿›è¡Œè®¡ç®—ï¼Œå°†æ¯ä¸ªåŒºåŸŸèšåˆæˆå•ç‹¬çš„å‘é‡ $\boldsymbol{H}_{i,:}$ã€‚ä½¿ç”¨å…±äº« RNN çš„åŸå› æ˜¯æˆ‘ä»¬æƒ³æ‰¾åˆ°ä¸€ä¸ªå¯¹æ‰€æœ‰åŒºåŸŸé€šç”¨çš„èšåˆè§„åˆ™ï¼Œè¿™ä¸ªè§„åˆ™é¼“åŠ±æ¨¡å‹æ³›åŒ–ä¸”å‡å°‘æ¨¡å‹çš„å¤æ‚åº¦ã€‚&lt;/p&gt;
&lt;h1 id="experiments"&gt;Experiments
&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;Dataset&lt;/strong&gt; åŒ—äº¬å’Œä¸Šæµ·ã€‚æ—¶é—´æ˜¯ä»2017å¹´5æœˆ1æ—¥åˆ°2017å¹´12æœˆ31æ—¥ã€‚5æœˆ1æ—¥åˆ°7æœˆ31æ—¥è®­ç»ƒã€8æœˆ1æ—¥åˆ°9æœˆ30æ—¥éªŒè¯ï¼Œå‰©ä¸‹çš„æµ‹è¯•ã€‚POI æ•°æ®æ˜¯2017å¹´çš„ï¼ŒåŒ…å«13ä¸ªç±»åˆ«ã€‚æ¯ä¸ªåŒºåŸŸå’Œä¸€ä¸ª POI å‘é‡ç›¸å…³ï¼Œåˆ†é‡æ˜¯è¿™ä¸ª POI ç±»å‹åœ¨è¿™ä¸ªåŒºåŸŸçš„ä¸ªæ•°ã€‚ç”¨æ¥è¯„ä¼°è¿è¾“å¯è¾¾æ€§çš„è·¯ç½‘ä½¿ç”¨çš„æ˜¯ OpenStreetMap (Haklay and Weber 2008)ã€‚&lt;/p&gt;
&lt;h2 id="experimental-settings"&gt;Experimental Settings
&lt;/h2&gt;&lt;p&gt;å­¦ä¹ ä»»åŠ¡æ˜¯ï¼š$f: \mathbb{R}^{\vert V \vert \times T} \rightarrow \mathbb{R}^{\vert V \vert}$ã€‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†åŒºåŸŸä»¥ $1km \times 1km$ çš„å¤§å°åˆ’åˆ†æˆç½‘æ ¼ã€‚åŒ—äº¬å’Œä¸Šæµ·åˆ†åˆ« 1296 å’Œ 896 ä¸ªåŒºåŸŸã€‚å°±åƒ Zhang, Zheng, and Qi 2017 åšçš„é‚£æ ·ï¼Œç½‘ç»œçš„è¾“å…¥åŒ…å« 5 ä¸ªå†å²è§‚æµ‹å€¼ï¼Œä¸‰ä¸ªæœ€è¿‘é‚»çš„éƒ¨åˆ†ï¼Œ1ä¸ªå‘¨æœŸéƒ¨åˆ†ï¼Œä¸€ä¸ªæœ€æ–°çš„è¶‹åŠ¿éƒ¨åˆ†ã€‚åœ¨æ„å»ºè¿è¾“å¯è¾¾æ€§ç½‘ç»œçš„æ—¶å€™ï¼Œæˆ‘ä»¬è€ƒè™‘äº†é«˜é€Ÿå…¬è·¯ã€å…¬è·¯ã€åœ°é“ã€‚ä¸¤ä¸ªåŒºåŸŸé—´åªè¦æœ‰è¿™æ ·çš„è·¯ç›´æ¥ç›¸è¿å°±è®¤ä¸ºæ˜¯è¿é€šçš„ã€‚&lt;/p&gt;
&lt;p&gt;$f(\mathbf{A}; \theta_i)$ é€‰æ‹©çš„æ˜¯ $K = 2$ æ—¶çš„åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼ï¼Œ$\bigsqcup$ æ˜¯ sum å‡½æ•°ã€‚éšè—å±‚ä¸º3ï¼Œæ¯å±‚ 64 ä¸ªéšè—å•å…ƒï¼ŒL2 æ­£åˆ™ï¼Œweight decay æ˜¯ $1e-4$ã€‚CGRNN ä¸­çš„å›¾å·ç§¯ $K&amp;rsquo;$ æ˜¯ 1ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ ReLU ä½œä¸ºå›¾å·ç§¯çš„æ¿€æ´»å‡½æ•°ã€‚ST-MGCN çš„å­¦ä¹ ç‡æ˜¯ $2e-3$ï¼Œä½¿ç”¨éªŒè¯é›†ä¸Šçš„æ—©åœã€‚æ‰€æœ‰çš„ç®—æ³•éƒ½ç”¨ tf å®ç°ï¼Œadam ä¼˜åŒ– RMSEã€‚ST-MGCN è®­ç»ƒæ—¶ç”¨äº† 10G å†…å­˜ï¼Œ9G GPU æ˜¾å­˜ã€‚åœ¨ Tesla P40 å•å¡ä¸Šè®­ç»ƒäº†ä¸€ä¸ªåŠå°æ—¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Methods for evaluation&lt;/strong&gt; HA, LASSO, Ridge, Auto-regressive model(VAR, STAR), Gradient boosted machine (GBM), ST-ResNet (Zhang, Zheng and Qi 2017), DMVST-Net (Yao et al. 2018b), DCRNN, ST-GCNã€‚&lt;/p&gt;
&lt;h2 id="performance-comparison"&gt;Performance comparison
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬åœ¨éªŒè¯é›†ä¸Šç”¨ç½‘æ ¼æœç´¢è°ƒæ•´äº†æ‰€æœ‰æ¨¡å‹çš„å‚æ•°ï¼Œåœ¨æµ‹è¯•é›†ä¸Šè·‘äº†å¤šæ¬¡å¾—åˆ°çš„æœ€åçš„ç»“æœã€‚æˆ‘ä»¬ä½¿ç”¨ RMSE å’Œ MAPE ä½œä¸ºè¯„ä»·æŒ‡æ ‡ã€‚è¡¨ 1 å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨ 10 æ¬¡ä»¥ä¸Šçš„é¢„æµ‹ä¸­çš„å¯¹æ¯”ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/spatiotemporal-multi-graph-convolution-network-for-ride-hailing-demand-forecasting/Table1.JPG"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šè§‚æµ‹åˆ°äº†å‡ ä¸ªç°è±¡ï¼šï¼ˆ1ï¼‰åŸºäºæ·±åº¦å­¦ä¹ çš„æ–¹æ³•èƒ½å¤Ÿå¯¹éçº¿æ€§çš„æ—¶ç©ºä¾èµ–å…³ç³»å»ºæ¨¡ï¼Œæ¯”å…¶ä»–çš„æ–¹æ³•å¥½ï¼›ï¼ˆ2ï¼‰ST-MGCN åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šæ¯”å…¶ä»–çš„æ–¹æ³•éƒ½å¥½ï¼Œæ¯”ç¬¬äºŒå¥½çš„é«˜å‡º 10%ï¼›ï¼ˆ3ï¼‰å¯¹æ¯”å…¶ä»–çš„æ·±åº¦å­¦ä¹ æ–¹æ³•ï¼ŒST-MGCN çš„æ–¹å·®æ›´å°ã€‚&lt;/p&gt;
&lt;h2 id="effect-of-spatial-dependency-modeling"&gt;Effect of spatial dependency modeling
&lt;/h2&gt;&lt;p&gt;ä¸ºäº†ç ”ç©¶ç©ºé—´å’Œæ—¶é—´ä¾èµ–å»ºæ¨¡çš„æ•ˆæœï¼Œæˆ‘ä»¬é€šè¿‡å‡å°‘æ¨¡å‹ä¸­çš„ç»„æˆéƒ¨åˆ†è¯„ä¼°äº† ST-MGCN çš„å‡ ä¸ªå˜ä½“ï¼ŒåŒ…æ‹¬ï¼šï¼ˆ1ï¼‰é‚»å±…å›¾ï¼Œï¼ˆ2ï¼‰åŠŸèƒ½ç›¸ä¼¼æ€§å›¾ï¼Œï¼ˆ3ï¼‰è¿è¾“è¿é€šæ€§å›¾ã€‚ç»“æœå¦‚è¡¨ 2 æ‰€ç¤ºã€‚ç§»é™¤ä»»ä½•ä¸€ä¸ªå›¾éƒ½ä¼šé€ æˆæ€§èƒ½æŸå¤±ï¼Œè¯æ˜äº†æ¯ç§å…³ç³»çš„é‡è¦æ€§ã€‚è¿™äº›å›¾ç¼–ç äº†é‡è¦çš„å…ˆéªŒçŸ¥è¯†ï¼Œä¹Ÿå°±æ˜¯åŒºåŸŸé—´çš„ç›¸å…³æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/spatiotemporal-multi-graph-convolution-network-for-ride-hailing-demand-forecasting/Table2.JPG"
loading="lazy"
alt="Table2"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è¯„ä¼°é›†æˆå¤šä¸ªåŒºåŸŸå…³ç³»çš„æ•ˆæœï¼Œæˆ‘ä»¬æ‰©å±•äº†åŸºäºå•ä¸ªå›¾çš„æ¨¡å‹ï¼ŒåŒ…æ‹¬ DCRNN å’Œ STGCNï¼Œåˆ†åˆ«è®°ä¸º DCRNN+ å’Œ ST-GCN+ã€‚ç»“æœå¦‚å›¾ 3ï¼Œä¸¤ä¸ªç®—æ³•éƒ½å¾—åˆ°äº†æå‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/spatiotemporal-multi-graph-convolution-network-for-ride-hailing-demand-forecasting/Table3.JPG"
loading="lazy"
alt="Table3"
&gt;&lt;/p&gt;
&lt;h2 id="effect-of-temporal-dependency-modeling"&gt;Effect of temporal dependency modeling
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ä¸åŒçš„æ–¹æ³•å¯¹æ—¶é—´å»ºæ¨¡ï¼Œè¯„ä¼° ST-GCN å¯¹æ—¶é—´å…³ç³»å»ºæ¨¡çš„æ•ˆæœã€‚ï¼ˆ1ï¼‰å¹³å‡æ± åŒ–ï¼šé€šè¿‡å¹³å‡æ± åŒ–å¯¹å†å²è§‚æµ‹å€¼è¿›è¡Œèšåˆï¼Œï¼ˆ2ï¼‰RNNï¼šä½¿ç”¨ RNN å¯¹å†å²è§‚æµ‹å€¼èšåˆï¼Œï¼ˆ3ï¼‰CGï¼šä½¿ç”¨ä¸Šä¸‹æ–‡é—¨å¯¹ä¸åŒçš„å†å²è§‚æµ‹å€¼èµ‹æƒï¼Œä¸é€‚ç”¨ RNNï¼Œï¼ˆ4ï¼‰GRNNï¼šä¸ç”¨å›¾å·ç§¯çš„ CGRNNã€‚ç»“æœå¦‚è¡¨ 4ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°äº†ä»¥ä¸‹ç°è±¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¹³å‡æ± åŒ–ä¼šç›²ç›®åœ°å¹³å‡ä¸åŒçš„æ ·æœ¬ï¼Œå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œèƒ½åšä¸Šä¸‹æ–‡ä¾èµ–éçº¿æ€§æ—¶é—´èšåˆçš„ RNN èƒ½æ˜¾è‘—åœ°æå‡æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;CGRNN å¢å¼ºäº† RNNã€‚ç§»é™¤ RNN å’Œ å›¾å·ç§¯éƒ½å¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œè¯æ˜äº†æ¯ä¸ªéƒ¨ä»¶çš„æœ‰æ•ˆæ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/spatiotemporal-multi-graph-convolution-network-for-ride-hailing-demand-forecasting/Table4.JPG"
loading="lazy"
alt="Table4"
&gt;&lt;/p&gt;
&lt;h2 id="effect-of-model-parameters"&gt;Effect of model parameters
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬è°ƒæ•´äº†ä¸¤ä¸ªæœ€é‡è¦çš„å‚æ•°æ¥çœ‹ä¸åŒå‚æ•°å¯¹æ¨¡å‹çš„å½±å“ï¼Œ$K$ å’Œå›¾å·ç§¯å±‚æ•°ã€‚å›¾ 5 å±•ç¤ºäº†æµ‹è¯•é›†ä¸Šçš„ç»“æœã€‚å¯ä»¥è§‚å¯Ÿåˆ°éšç€å±‚æ•°çš„å¢åŠ ï¼Œé”™è¯¯å…ˆé™åå¢ã€‚ä½†æ˜¯éšç€ $K$ çš„å¢åŠ ï¼Œé”™è¯¯æ˜¯å…ˆå‡å°ï¼Œåä¸å˜ã€‚è¶Šå¤§çš„ $K$ æˆ–å±‚æ•°ä½¿å¾—æ¨¡å‹èƒ½æ•è·å…¨å±€å…³è”æ€§ï¼Œä»£ä»·æ˜¯æ¨¡å‹çš„å¤æ‚åº¦ä¼šå¢åŠ ï¼Œæ›´æ˜“è¿‡æ‹Ÿåˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/spatiotemporal-multi-graph-convolution-network-for-ride-hailing-demand-forecasting/Fig5.JPG"
loading="lazy"
alt="Figure5"
&gt;&lt;/p&gt;
&lt;h1 id="conclusion-and-future-work"&gt;Conclusion and Future work
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬ç ”ç©¶çš„æ˜¯ç½‘çº¦è½¦éœ€æ±‚é¢„æµ‹ï¼Œè¦æ‰¾å¯»è¿™ä¸ªé—®é¢˜å”¯ä¸€çš„æ—¶ç©ºä¾èµ–å…³ç³»ã€‚æˆ‘ä»¬æå‡ºçš„æ·±åº¦å­¦ä¹ æ¨¡å‹ä½¿ç”¨å¤šä¸ªå›¾å¯¹åŒºåŸŸé—´çš„éæ¬§å…³ç³»å»ºæ¨¡ï¼Œä½¿ç”¨å¤šå›¾å·ç§¯æ˜æ˜¾çš„æ•è·äº†è¿™ä¸ªå…³ç³»ã€‚ç„¶åç”¨ä¸Šä¸‹æ–‡é—¨æ§æœºåˆ¶å¢å¼ºäº† RNNï¼Œåœ¨æ—¶é—´å»ºæ¨¡ä¸Šé›†æˆäº†å…¨å±€èƒŒæ™¯ä¿¡æ¯ã€‚åœ¨ä¸¤ä¸ªå¤§å‹çœŸå®æ•°æ®é›†ä¸Šè¯„ä¼°äº†æ¨¡å‹ï¼Œæ¯” state-of-the-artå¥½ã€‚æœªæ¥çš„å·¥ä½œæ˜¯ï¼šï¼ˆ1ï¼‰åœ¨å…¶ä»–çš„æ—¶ç©ºé¢„æµ‹ä»»åŠ¡ä¸Šè¯„ä¼°æ¨¡å‹ï¼›ï¼ˆ2ï¼‰å°†æå‡ºçš„æ¨¡å‹æ‰©å±•åˆ°å¤šæ­¥é¢„æµ‹ä¸Šã€‚&lt;/p&gt;</description></item><item><title>å½’å¹¶æ’åºæ”¹è¿›</title><link>https://davidham3.github.io/blog/p/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E6%94%B9%E8%BF%9B/</link><pubDate>Mon, 04 Feb 2019 15:46:31 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E6%94%B9%E8%BF%9B/</guid><description>&lt;p&gt;æœ€è¿‘åœ¨çœ‹courseraä¸Šé¢æ™®æ—æ–¯é¡¿å¤§å­¦çš„ç®—æ³•è¯¾ï¼Œå…³äºå½’å¹¶æ’åºæœ‰ä¸‰ç‚¹æ”¹è¿›æ–¹æ³•ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å½“å­åºåˆ—çš„é•¿åº¦å°äºä¸€å®šçš„é˜ˆå€¼æ—¶ï¼Œä½¿ç”¨æ’å…¥æ’åºå¯ä»¥æå‡æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨å½’å¹¶ä¸¤ä¸ªå­åºåˆ—æ—¶ï¼Œå¦‚æœå‰ä¸€ä¸ªå­åºåˆ—çš„æœ€åä¸€ä¸ªå€¼ï¼ˆæœ€å¤§å€¼ï¼‰å°äºåä¸€ä¸ªå­åºåˆ—çš„ç¬¬ä¸€ä¸ªå€¼ï¼ˆæœ€å°å€¼ï¼‰ï¼Œè¯´æ˜å½“å‰çš„ä¸¤ä¸ªå­åºåˆ—æ‹¼èµ·æ¥å·²ç»æ˜¯æœ‰åºçš„äº†ï¼Œå¯ä»¥è·³è¿‡å½’å¹¶ã€‚&lt;/li&gt;
&lt;li&gt;å› ä¸ºå½’å¹¶æ’åºéœ€è¦å¼€è¾Ÿä¸€ä¸ªæ–°çš„ä¸´æ—¶ç©ºé—´ï¼Œå¯ä»¥è®©è¿™ä¸ªä¸´æ—¶ç©ºé—´å’ŒåŸæ¥çš„ç©ºé—´äº¤æ›¿ä½¿ç”¨ï¼Œå‡å°‘å…ƒç´ ç§»åŠ¨çš„å¼€é”€ã€‚&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>Multistep Speed Prediction on Traffic Networks: A Graph Convolutional Sequence-to-Sequence Learning Approach with Attention Mechanism</title><link>https://davidham3.github.io/blog/p/multistep-speed-prediction-on-traffic-networks-a-graph-convolutional-sequence-to-sequence-learning-approach-with-attention-mechanism/</link><pubDate>Mon, 21 Jan 2019 15:17:52 +0000</pubDate><guid>https://davidham3.github.io/blog/p/multistep-speed-prediction-on-traffic-networks-a-graph-convolutional-sequence-to-sequence-learning-approach-with-attention-mechanism/</guid><description>&lt;p&gt;AGC-Seq2Seqï¼ŒæŠ•çš„æ˜¯TRCã€‚æ¸…åå¤§å­¦å’Œé«˜å¾·åœ°å›¾åˆä½œçš„ä¸€é¡¹ç ”ç©¶ã€‚ä½œè€…é‡‡ç”¨äº† GCN + Seq2Seq + Attention çš„æ··åˆæ¨¡å‹ï¼Œå°†è·¯ç½‘ä¸­çš„è¾¹æ„å»ºæˆå›¾ä¸­çš„ç»“ç‚¹ï¼Œåœ¨ GCN ä¸Šåšäº†æ”¹è¿›ï¼Œå°†é‚»æ¥çŸ©é˜µæ‰©å±•åˆ° k é˜¶å¹¶ä¸ä¸€ä¸ªæƒé‡çŸ©é˜µç›¸ä¹˜ï¼Œç±»ä¼¼ HA-GCN(2016)ï¼Œå®ç°äº†é‚»å±…ä¿¡æ¯èšåˆæ—¶æƒé‡çš„è‡ªç”±è°ƒæ•´ï¼Œå¯ä»¥å¤„ç†æœ‰å‘å›¾ã€‚æ—¶é—´å…³ç³»ä¸Šä½¿ç”¨ Seq2Seq + Attention å»ºæ¨¡ï¼Œå®Œæˆäº†åŒ—äº¬å¸‚äºŒç¯çº¿çš„å¤šæ­¥çš„è½¦é€Ÿé¢„æµ‹ï¼Œå¯¹æ¯”çš„æ–¹æ³•ä¸­æ²¡æœ‰è¿‘å‡ å¹´å‡ºç°çš„æ—¶ç©ºé¢„æµ‹æ¨¡å‹ã€‚&lt;/p&gt;
&lt;h1 id="æ‘˜è¦"&gt;æ‘˜è¦
&lt;/h1&gt;&lt;p&gt;ä¸ºäº†åœ¨å¤šæ­¥äº¤é€šé¢„æµ‹çš„ä»»åŠ¡ä¸­ï¼Œæ•è·å¤æ‚çš„éå¹³ç¨³çš„æ—¶é—´åŠ¨æ€æ€§å’Œç©ºé—´ä¾èµ–å…³ç³»ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªå«æ³¨æ„åŠ›å›¾å·ç§¯åºåˆ—åˆ°åºåˆ—æ¨¡å‹ï¼ˆAGC-Seq2Seqï¼‰ã€‚ç©ºé—´å’Œæ—¶é—´ç”¨å›¾å·ç§¯å’Œåºåˆ—åˆ°åºåˆ—æ¨¡å‹åˆ†å¼€å»ºæ¨¡ã€‚æ³¨æ„åŠ›æœºåˆ¶ç”¨æ¥è§£å†³åºåˆ—åˆ°åºåˆ—æ¨¡å‹åœ¨å¤šæ­¥é¢„æµ‹ä¸Šçš„å›°éš¾ï¼ŒåŒæ—¶æ¥æ•è·äº¤é€šæµçš„å¼‚è´¨æ€§ã€‚&lt;/p&gt;
&lt;h1 id="2-literature-review"&gt;2. LITERATURE REVIEW
&lt;/h1&gt;&lt;p&gt;å¦‚ Li et al. 2017 æ‰€è¿°ï¼Œç»Ÿè®¡æ¨¡å‹ã€shallow machine learning models å’Œ æ·±åº¦å­¦ä¹ æ¨¡å‹æ˜¯ä¸‰ä¸ªä¸»è¦çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ç»Ÿè®¡æ¨¡å‹åŸºäºè¿‡å»çš„æ—¶é—´åºåˆ—è§‚æµ‹å€¼å¯¹æœªæ¥è¿›è¡Œé¢„æµ‹ã€‚ARIMA æ¨¡å‹ï¼ŒKalman filterï¼Œè¿˜æœ‰å®ƒä»¬è¡ç”Ÿå‡ºçš„ç®—æ³•ã€‚ç„¶è€Œï¼Œç®€å•çš„æ—¶é—´åºåˆ—æ¨¡å‹é€šå¸¸ä¾èµ–å¹³ç¨³å‡è®¾ï¼Œè¿™ä¸åŸå¸‚äº¤é€šçš„åŠ¨æ€æ€§ä¸ç¬¦ã€‚ç‰¹åˆ«æ˜¯å¯¹äºå¤šæ­¥æ—¶é—´é¢„æµ‹ï¼Œåé¢çš„é¢„æµ‹å€¼æ˜¯åŸºäºå‰é¢çš„é¢„æµ‹å€¼çš„ï¼Œå› æ­¤ï¼Œé¢„æµ‹çš„è¯¯å·®ä¼šé€æ¸çš„ä¼ æ’­ã€‚ä½¿ç”¨ç®€å•çš„æ—¶é—´åºåˆ—é¢„æµ‹æ¨¡å‹å¾ˆéš¾æ»¡è¶³é«˜ç²¾åº¦çš„é¢„æµ‹éœ€æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶ï¼Œæœºå™¨å­¦ä¹ æ–¹æ³•åœ¨äº¤é€šé¢„æµ‹ç ”ç©¶ä¸­è¡¨ç°çš„å¾ˆå¥½ã€‚ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œè´å¶æ–¯ç½‘ç»œï¼Œæ”¯æŒå‘é‡æœºæ¨¡å‹ï¼ŒK è¿‘é‚»æ‘©è¥¿é‚£ä¸ªï¼Œéšæœºæ£®æ—æ¨¡å‹åœ¨äº¤é€šæµé¢„æµ‹ä¸­è¡¨ç°çš„å¾ˆå¥½ã€‚ç„¶è€Œï¼Œæœºå™¨å­¦ä¹ ç®—æ³•çš„è¡¨ç°ä¾èµ–äºæ‰‹å·¥é€‰å–ç‰¹å¾ï¼Œè€Œä¸”é€‰å–ç‰¹å¾çš„æ–¹æ³•æ˜¯ä¸å­˜åœ¨çš„ï¼Œå› ä¸ºå…³é”®ç‰¹å¾ä¸€èˆ¬å› é—®é¢˜è€Œå¼‚ã€‚å› æ­¤ï¼Œä½¿ç”¨å…ƒç´ çº§åˆ«çš„æœºå™¨å­¦ä¹ æ–¹æ³•åœ¨å¤æ‚çš„é¢„æµ‹ä»»åŠ¡ä¸Šä¸ä¼šäº§ç”Ÿå¥½çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘ï¼Œæ·±åº¦å­¦ä¹ ç®—æ³•æˆåŠŸçš„åº”ç”¨åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒåŒæ—¶ï¼Œå®ƒåœ¨è¿è¾“å­¦ç§‘ä¹Ÿå¸å¼•äº†å¾ˆå¤šäººçš„æ³¨æ„ã€‚Huang et al. 2014 ä½¿ç”¨æ·±åº¦ç½®ä¿¡ç½‘ç»œç”¨äºæ— ç›‘ç£å­¦ä¹ ï¼Œè¯æ˜äº†åœ¨äº¤é€šæµé¢„æµ‹ä¸Šçš„æœ‰æ•ˆæ€§ã€‚Lv et al. 2015 ä½¿ç”¨ä¸€ä¸ªå †å çš„è‡ªç¼–ç å™¨æ¨¡å‹å­¦ä¹ äº¤é€šæµç‰¹å¾ã€‚Ma et al 2015 ä½¿ç”¨ LSTM æœ‰æ•ˆåœ°æ•è·äº†äº¤é€šæµçš„åŠ¨æ€æ€§ã€‚Polson and Sokolov 2017 èåˆäº† $L_1$ æ­£åˆ™å’Œ $\text{tanh}$ æ¿€æ´»çš„å¤šå±‚ç½‘ç»œæ¥æ£€æµ‹äº¤é€šæµçš„æç«¯çš„éçº¿æ€§ã€‚ç„¶è€Œï¼Œè¿™äº›æ–¹æ³•ä¸»è¦èšç„¦äºå¯¹å•ä¸ªåºåˆ—å»ºæ¨¡ï¼Œä¸èƒ½åæ˜ äº¤é€šç½‘ç»œçš„ç©ºé—´å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;å·ç§¯ç¥ç»ç½‘ç»œæä¾›äº†ä¸€ä¸ªæœ‰æ•ˆçš„æ¶æ„æ¥æå–å¤§å°ºåº¦ã€é«˜ç»´çš„æ•°æ®é›†ä¸­æœ‰æ•ˆçš„ç»Ÿè®¡æ¨¡å¼ã€‚åœ¨å­¦ä¹ å±€éƒ¨å¹³ç¨³ç»“æ„ä¸­ï¼ŒCNN çš„èƒ½åŠ›åœ¨å›¾åƒå’Œè§†é¢‘è¯†åˆ«ä»»åŠ¡ä¸­è·å¾—äº†å¾ˆå¤§çš„çªç ´ã€‚åœ¨è¿è¾“é¢†åŸŸï¼Œä¹Ÿæœ‰å­¦è€…ä½¿ç”¨ CNN æ•è·äº¤é€šç½‘ç»œä¸Šçš„ç©ºé—´å…³ç³»ã€‚Ma et al. (2017) æå‡ºäº†ä¸€ä¸ªé¢„æµ‹è½¦é€Ÿçš„æ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œï¼Œå°†äº¤é€šçš„æ—¶ç©ºåŠ¨æ€æ€§è½¬æ¢æˆå›¾åƒã€‚Wang et al. (2017) å°†é«˜é€Ÿå…¬è·¯å¤„ç†æˆä¸€ä¸ª band imageï¼Œæå‡ºäº†è¯¯å·®å›ä¼ çš„å¾ªç¯å·ç§¯ç¥ç»ç½‘ç»œç»“æ„ç”¨äºè¿ç»­çš„äº¤é€šé€Ÿåº¦é¢„æµ‹ã€‚Ke et al. (2017) å°†åŸå¸‚åŒºåŸŸåˆ’åˆ†æˆå‡åŒ€çš„ç½‘æ ¼ï¼Œé€šè¿‡å°†å·ç§¯å’Œ LSTM å±‚åˆå¹¶æ¥é¢„æµ‹æ¯ä¸ªç½‘æ ¼å†…çš„ä¹˜å®¢éœ€æ±‚ã€‚ä¸Šè¿°çš„ç ”ç©¶å°†äº¤é€šç½‘ç»œè½¬æ¢ä¸ºç½‘æ ¼æ˜¯å› ä¸º CNN å—é™äºå¤„ç†æ¬§æ°ç©ºé—´çš„æ•°æ®ã€‚ç„¶è€Œï¼Œåœ¨äº¤é€šé¢„æµ‹ä¸Šï¼Œè·¯ç½‘ä¸Šçš„æ—¶é—´åºåˆ—æ˜¯åˆ†å¸ƒåœ¨ä¸€ä¸ªæ‹“æ‰‘å›¾ä¸Šè¿ç»­çš„åºåˆ—ï¼Œæ˜¯ä¸€ç§éæ¬§å¼ç»“æ„æ•°æ®çš„å…¸å‹ (Narang et al., 2013)ï¼›åŸæœ¬çš„ CNN ç»“æ„æ˜¯ä¸èƒ½ä½¿ç”¨çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒåŸºäºè°±å›¾ç†è®ºçš„å›¾å·ç§¯ç½‘ç»œ (GCN) å¯ä»¥ç”¨äºåœ¨éæ¬§å¼ç©ºé—´ä¸Šä½¿ç”¨å·ç§¯ (Kipf and Welling, 2016)ã€‚å‡ ä¸ªåˆšåˆšå‘è¡¨çš„ç ”ç©¶åœ¨äº¤é€šé¢„æµ‹ä¸Šä½¿ç”¨äº†å›¾å·ç§¯æ¨¡å‹ã€‚åŸºäºè°±çš„å›¾å·ç§¯å’Œæ—¶é—´ä¸Šçš„å·ç§¯ç›¸ç»“åˆ (Yu et al., 2017)ï¼Œè¿˜æœ‰å›¾å·ç§¯ä¸å¾ªç¯ç¥ç»ç½‘ç»œ (RNN) çš„ç»“åˆ (Li et al., 2017) æ¥ç”¨äºé¢„æµ‹äº¤é€šçŠ¶æ€ã€‚ä¹‹åï¼ŒCui et al. (2018) ä½¿ç”¨é«˜é˜¶å›¾å·ç§¯æ¥å­¦ä¹ è·¯ç½‘ä¸Šä¸åŒè·¯æ®µé—´çš„äº¤äº’å…³ç³»ã€‚ä¸Šè¿°ç ”ç©¶æ²¡æœ‰åœ¨è·¯ç½‘ä¸Šç›´æ¥å®šä¹‰å›¾å·ç§¯ï¼Œè€Œæ˜¯é€šè¿‡é«˜æ–¯æ ¸æ ¹æ®ä»»æ„ä¸¤ä¸ªç›‘æµ‹å™¨é—´çš„è·ç¦»æ„å»ºäº†ç›‘æµ‹å™¨ä¹‹é—´çš„ç½‘ç»œã€‚æ­¤å¤–ï¼Œäº¤é€šçŠ¶å†µçš„æ—¶é—´å…³è”ä¹Ÿæ²¡æœ‰è€ƒè™‘ã€‚&lt;/p&gt;
&lt;p&gt;æ€»ç»“ä¸€ä¸‹ï¼ŒåŸå¸‚è·¯ç½‘ä¸Šäº¤é€šçŠ¶å†µçš„å˜åŒ–å±•ç¤ºå‡ºäº†æ—¶ç©ºçš„ä¾èµ–æ€§ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªå®šåˆ¶ç‰ˆçš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œåœ¨ Seq2Seq æ¡†æ¶ä¸­ç»§æ‰¿äº†æ³¨æ„åŠ›æœºåˆ¶å’Œå›¾å·ç§¯æ¨¡å‹ï¼ŒåŒæ—¶æ•è·å¤æ‚çš„éå¹³ç¨³çš„ç©ºé—´åŠ¨æ€æ€§å’Œå¤šæ­¥äº¤é€šé¢„æµ‹çš„ç©ºé—´ä¾èµ–æ€§ã€‚&lt;/p&gt;
&lt;h1 id="3-agc-seq2seq-deep-learning-framework"&gt;3. AGC-SEQ2SEQ DEEP LEARNING FRAMEWORK
&lt;/h1&gt;&lt;h2 id="31-preliminaries"&gt;3.1 Preliminaries
&lt;/h2&gt;&lt;p&gt;&lt;em&gt;(1) Road network topology&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;è·¯ç½‘æ ¹æ®é©¾é©¶æ–¹å‘æ„å»ºæˆæœ‰å‘å›¾ $\mathcal{G}(\mathcal{N}, \mathcal{L})$ ï¼Œé¡¶ç‚¹é›† $\mathcal{N}$ è¡¨ç¤ºè·¯å£ (ç›‘æµ‹å™¨æˆ–é€‰æ‹©çš„é«˜é€Ÿå…¬è·¯çš„åˆ’åˆ†ç‚¹)ï¼Œè¾¹é›† $\mathcal{L}$ è¡¨ç¤ºè·¯æ®µï¼Œå¦‚å›¾1æ‰€ç¤ºã€‚$\boldsymbol{A}$ æ˜¯è¾¹é›†çš„é‚»æ¥çŸ©é˜µï¼Œ$\boldsymbol{A}(i, j)$ è¡¨ç¤ºè¾¹ $i$ å’Œ $j$ æ˜¯å¦ç›¸è¿ï¼Œå³&lt;/p&gt;
$$
\boldsymbol{A}(i, j) = \begin{cases}
1, &amp;\text{if } \quad l\_i \quad \text{and} \quad l\_j \quad \text{are} \quad \text{connected} \quad \text{along} \quad \text{driving} \quad \text{direction}\\
0, &amp;\text{if } \quad \text{otherwise}
\end{cases}
$$&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multistep-speed-prediction-on-traffic-networks-a-graph-convolutional-sequence-to-sequence-learning-approach-with-attention-mechanism/Fig1.jpg"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(2) Traffic speed&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;è·¯æ®µ $l_i (\forall l_i \in \mathcal{L})$ çš„ç¬¬ $t$ ä¸ªæ—¶æ®µï¼ˆæ¯”å¦‚ 5 åˆ†é’Ÿï¼‰å®šä¹‰ä¸ºè·¯æ®µä¸Šè¿™ä¸ªæ—¶é—´æ®µæµ®åŠ¨è½¦çš„å¹³å‡é€Ÿåº¦ï¼Œè¡¨ç¤ºä¸º $v^i_t$ã€‚è·¯ç½‘åœ¨ç¬¬ $t$ ä¸ªæ—¶æ®µçš„é€Ÿåº¦å®šä¹‰ä¸ºå‘é‡ $\boldsymbol{V}_t \in \mathbb{R}^{\vert \mathcal{L} \vert}$ï¼ˆ$\vert \mathcal{L} \vert$ æ˜¯è¾¹é›† $\mathcal{L}$ çš„åŸºæ•°ï¼‰ï¼Œç¬¬ $i$ ä¸ªå…ƒç´ æ˜¯ $(\boldsymbol{V}_t)_i = v^i_t$ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºå…¸å‹çš„æ—¶é—´åºåˆ—é¢„æµ‹é—®é¢˜ï¼Œæœ€è¿‘é‚»çš„ $m$ æ­¥è§‚æµ‹å€¼å¯ä»¥å¯¹å¤šæ­¥é¢„æµ‹æä¾›æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚é™¤äº†å®æ—¶çš„è½¦é€Ÿä¿¡æ¯ï¼Œä¸€äº›å¤–éƒ¨å˜é‡ï¼Œå¦‚æ—¶é—´ã€å·¥ä½œæ—¥è¿˜æ˜¯å‘¨æœ«ï¼Œå†å²çš„ç»Ÿè®¡ä¿¡æ¯ä¹Ÿå¯¹é¢„æµ‹æœ‰å¸®åŠ©ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(3) Time-of-day and weekday-or-weekend&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸ºè·¯æ®µçš„è½¦é€Ÿæ˜¯èšåˆ 5 åˆ†é’Ÿå¾—åˆ°çš„å¹³å‡å€¼ï¼Œæ—¶é—´ä¼šè¢«è½¬åŒ–ä¸ºä¸€ä¸ªæœ‰åºçš„å®æ•°ï¼Œæ¯”å¦‚ 00:00-00:05 è½¬åŒ–ä¸º $N_t = 1$ï¼Œ7:00-7:05 è½¬åŒ–ä¸º $N_t = 85(7 * 12 + 1)$ï¼Œå·¥ä½œæ—¥æˆ–å‘¨æœ«è¡¨ç¤ºä¸º $p_t$ï¼ŒåŒºåˆ†å·¥ä½œæ—¥å’Œå‘¨æœ«çš„ä¸åŒç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(4) Historical statistic information&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;äº¤é€šçŠ¶æ€çš„æ¯æ—¥è¶‹åŠ¿å¯ä»¥é€šè¿‡å¼•å…¥å†å²çš„ç»Ÿè®¡æ•°æ®æ•è·ã€‚å†å²çš„å¹³å‡è½¦é€Ÿï¼Œä¸­å€¼è½¦é€Ÿï¼Œæœ€å¤§è½¦é€Ÿï¼Œæœ€å°è½¦é€Ÿï¼Œè·¯æ®µ $l_i$ çš„ $t$ æ—¶æ®µçš„æ ‡å‡†å·®ï¼Œåˆ†åˆ«å®šä¹‰ä¸ºè®­ç»ƒé›†ä¸­çš„å¹³å‡å€¼ã€ä¸­ä½æ•°ã€æœ€å¤§ã€æœ€å°ã€æ ‡å‡†å·®ï¼Œè¡¨ç¤ºä¸º $v^i_{t,average}, v^i_{t,median}, v^i_{t,max}, v^i_{t,min}, d^i_t$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(5) Problem formulation&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;è½¦é€Ÿé¢„æµ‹æ˜¯ç”¨ä¹‹å‰è§‚æµ‹åˆ°çš„é€Ÿåº¦é¢„æµ‹ä¸€ä¸ªç¡®å®šæ—¶æ®µæ¯ä¸ªè·¯æ®µä¸Šçš„è½¦é€Ÿã€‚å¤šæ­¥é€Ÿåº¦é¢„æµ‹é—®é¢˜å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{1}
\hat{V}\_{t+n} = \mathop{\arg\max}\limits\_{V\_{t+n}} \text{Pr}(V\_{t+n} \mid V\_t, V\_{t-1}, \dots, V\_{t-m};\mathcal{G})
$$&lt;p&gt;å…¶ä¸­ $\hat{V}_{t+n}(n=1,2,3,\dots)$ è¡¨ç¤ºç¬¬ $n$ æ­¥çš„é¢„æµ‹é€Ÿåº¦ï¼Œ$\lbrace V_t, V_{t-1}, \dots, V_{t-m} \mid m=1,2,\dots \rbrace$ æ˜¯ä¹‹å‰è§‚æµ‹åˆ°çš„å€¼ã€‚$\text{Pr}(Â·\midÂ·)$ æ˜¯æ¡ä»¶æ¦‚ç‡ã€‚&lt;/p&gt;
&lt;h2 id="32-graph-convolution-on-traffic-networks"&gt;3.2 Graph Convolution on Traffic Networks
&lt;/h2&gt;&lt;p&gt;å›¾å·ç§¯é€šè¿‡è°±åŸŸï¼Œå°†ä¼ ç»Ÿçš„å·ç§¯ä»ç½‘æ ¼ä¸Šæ‰©å±•åˆ°äº†å›¾ä¸Šã€‚ä¸ºäº†å¼•å…¥ä¸€èˆ¬çš„ $K$ é˜¶å›¾å·ç§¯ï¼Œæˆ‘ä»¬é¦–å…ˆç»™æ¯ä¸ªè·¯æ®µ $l_i \in \mathcal{L}$ å®šä¹‰äº† $K$ é˜¶é‚»å±… $\mathcal{H}_i(K) = \lbrace l_j \in \mathcal{L} \mid d(l_i, l_j) \leq K \rbrace$ï¼Œå…¶ä¸­ $d(l_i, l_j)$ è¡¨ç¤ºæ‰€æœ‰ä» $l_i$ åˆ° $l_j$ çš„è·¯å¾„ä¸­æœ€çŸ­è·¯å¾„çš„é•¿åº¦ã€‚&lt;/p&gt;
&lt;p&gt;é‚»æ¥çŸ©é˜µå°±æ˜¯ä¸€é˜¶é‚»å±…ï¼Œ$K$ æ¬¡å¹‚å°±æ˜¯ $K$ é˜¶é‚»å±…ã€‚ä¸ºäº†æ¨¡ä»¿æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼Œæˆ‘ä»¬åœ¨å¯¹è§’çº¿ä¸ŠåŠ äº†1ï¼Œå®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{2}
\boldsymbol{A}^K\_{GC} = \text{Ci}(\boldsymbol{A}^K + \boldsymbol{I})
$$&lt;p&gt;å…¶ä¸­ $\text{Ci}(Â·)$ æ˜¯clip functionï¼Œå°†é0å…ƒç´ å˜æˆ1ï¼›å› æ­¤ $\boldsymbol{A}^K_{GC}(i, j) = 1 \quad for \quad l_j \in \mathcal{H}_i(K) \quad or \quad i = j$ï¼›å¦åˆ™ $\boldsymbol{A}^K_{GC}(i, j) = 0$ã€‚å•ä½é˜µ $\boldsymbol{I}$ å¢åŠ äº†è‡ªè¿æ¥ï¼Œå·ç§¯çš„æ—¶å€™å¯ä»¥è€ƒè™‘åˆ°è‡ªèº«ã€‚&lt;/p&gt;
&lt;p&gt;åŸºäºä¸Šè¿°çš„é‚»å±…çŸ©é˜µï¼Œä¸€ä¸ªç®€å•ç‰ˆæœ¬çš„å›¾å·ç§¯(e.g., Cui et al., 2018)å¯ä»¥å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{3}
\boldsymbol{V}\_t(K) = (\boldsymbol{W}\_{GC} \odot \boldsymbol{A}^K\_{GC})\cdot \boldsymbol{V}\_t
$$&lt;p&gt;å…¶ä¸­ $\boldsymbol{W}_{GC}$ æ˜¯ä¸€ä¸ªå’Œ $\boldsymbol{A}$ ä¸€æ ·å¤§å°çš„å¯è®­ç»ƒçš„çŸ©é˜µã€‚$\odot$ è¡¨ç¤ºå“ˆè¾¾ç›ç§¯ã€‚é€šè¿‡å“ˆè¾¾ç›ä¹˜ç§¯ï¼Œ$(\boldsymbol{W}_{GC} \odot \boldsymbol{A}^K_{GC})$ å¯ä»¥å¾—åˆ°ä¸€ä¸ªåœ¨ $K$ é˜¶é‚»å±…ä¸Šæœ‰å‚æ•°ï¼Œå…¶ä»–åœ°æ–¹ä¸º0çš„æ–°çŸ©é˜µã€‚å› æ­¤ï¼Œ$(\boldsymbol{W}_{GC} \odot \boldsymbol{A}^K_{GC})\cdot \boldsymbol{V}_t$ å¯ä»¥ç†è§£æˆæ˜¯ä¸€ä¸ªå¯¹ $\boldsymbol{V}_t$ çš„ç©ºé—´ç¦»æ•£çš„å·ç§¯ã€‚ç»“æœå°±æ˜¯ï¼Œ$\boldsymbol{V}_t(K)$ æ˜¯æ—¶é—´ $t$ çš„èåˆç©ºé—´çš„é€Ÿåº¦å‘é‡ã€‚å®ƒçš„ç¬¬ $i$ ä¸ªå…ƒç´  $v^i_t(K)$ è¡¨ç¤ºè·¯æ®µ $l_i \in \mathcal{L}$ åœ¨æ—¶é—´ $t$ çš„ç©ºé—´èåˆé€Ÿåº¦ï¼Œè¿™ä¸ªé€Ÿåº¦é›†æˆäº†å…¶é‚»å±…è·¯æ®µ $\mathcal{H}_i(K)$ çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œå¼3å¯ä»¥åˆ†è§£æˆä¸€ä¸ªä¸€ç»´å·ç§¯ã€‚&lt;/p&gt;
$$\tag{4}
v^i\_t(K) = (\boldsymbol{W}\_{GC}[i] \odot \boldsymbol{A}^K\_{GC}[i])^T \cdot \boldsymbol{V}\_t
$$&lt;p&gt;$\boldsymbol{W}_{GC}[i]$ å’Œ $\boldsymbol{A}^K_{GC}[i]$ åˆ†åˆ«æ˜¯ $\boldsymbol{W}_{GC}$ å’Œ $\boldsymbol{A}^K_{GC}$ çš„ç¬¬ $i$ è¡Œã€‚å›¾2æ˜¯è·¯ç½‘ä¸Š $\boldsymbol{A}^K_{GC}[i]$ çš„ä¸€ä¸ªä¾‹å­ï¼Œè·¯æ®µ $i$ åœ¨çº¢çº¿ï¼Œé‚»å±…æ˜¯è“çº¿ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multistep-speed-prediction-on-traffic-networks-a-graph-convolutional-sequence-to-sequence-learning-approach-with-attention-mechanism/Fig2.jpg"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;h2 id="33-attention-graph-convolutional-sequence-to-sequence-model-agc-seq2seq"&gt;3.3 Attention Graph Convolutional Sequence-to-Sequence Model (AGC-Seq2Seq)
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬æå‡ºäº† AGC-Seq2Seq æ¨¡å‹å°†æ—¶ç©ºå˜é‡å’Œå¤–éƒ¨ä¿¡æ¯é›†æˆè‡³æ·±åº¦å­¦ä¹ æ¶æ„ä¸­ï¼Œç”¨æ¥åšå¤šæ­¥è½¦è¾†é€Ÿåº¦é¢„æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ•è·æ—¶é—´åºåˆ—ç‰¹å¾å’Œè·å¾—å¤šæ­¥è¾“å‡ºï¼Œæˆ‘ä»¬ä½¿ç”¨ Seq2Seq ä½œä¸ºæ•´ä¸ªæ–¹æ³•çš„åŸºç¡€ç»“æ„ï¼Œç”±ä¸¤ä¸ªå‚æ•°ç‹¬ç«‹çš„ RNN æ¨¡å—ç»„æˆ(Sutskever et al., 2014; Cho et al., 2014)ã€‚ä¸ºäº†å…‹æœ RNN è¾“å‡ºçš„é•¿åº¦ä¸å¯å˜ï¼ŒSeq2Seq æ¨¡å‹å°†è¾“å…¥è¿›ç¼–ç å™¨çš„æ—¶é—´åºåˆ—ç¼–ç ï¼Œè§£ç å™¨ä» &lt;em&gt;context vector&lt;/em&gt; ä¸­è§£ç å‡ºé¢„æµ‹å€¼ã€‚æˆ‘ä»¬æå‡ºçš„ AGC-Seq2Seq æ¨¡å‹å¦‚å›¾3æ‰€ç¤ºã€‚é¦–å…ˆç”¨å›¾å·ç§¯æ¥æ•è·ç©ºé—´ç‰¹å¾ï¼Œç„¶åå°†æ—¶ç©ºå˜é‡ $v^i_{t-j}(K)$ å’Œå¤–éƒ¨ä¿¡æ¯ $\boldsymbol{E}_{t-j}$ï¼ˆåŒ…æ‹¬æ—¶é—´å’Œå·¥ä½œæ—¥æˆ–å‘¨æœ«ä¿¡æ¯ï¼‰èåˆæ„æˆè¾“å…¥å‘é‡ï¼Œç„¶åæ”¾å…¥ Seq2Seqçš„ç¼–ç æ¨¡å‹ä¸­ã€‚ä¸Šè¿°è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{5}
v^i\_{t-j}(K) = (\boldsymbol{W}\_{GC}[i] \odot \boldsymbol{A}^K\_{GC}[i])^T \cdot \boldsymbol{V}\_{t-j}, \quad 0 \leq j \leq m
$$$$\tag{6}
\boldsymbol{E}\_{t-j} = [N\_{t-j};p\_{t-j}]
$$$$\tag{7}
\boldsymbol{X}^i\_{t-j} = [v^i\_{t-j}(K);\boldsymbol{E}\_{t-j}]
$$&lt;p&gt;å…¶ä¸­ $N_{t-j}$ å’Œ $p_{t-j}$ å¦‚3.1èŠ‚å®šä¹‰ï¼Œ$[Â·;Â·]$ æ“ä½œæ˜¯å°†ä¸¤ä¸ªå¼ é‡æ‹¼æ¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multistep-speed-prediction-on-traffic-networks-a-graph-convolutional-sequence-to-sequence-learning-approach-with-attention-mechanism/Fig3.jpg"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;ç¼–ç éƒ¨åˆ†å¦‚å¼8-9ï¼Œåœ¨æ—¶é—´æ­¥ $t-j, j\in \lbrace 0, \dots, m \rbrace$ï¼Œå‰ä¸€ä¸ªéšè—çŠ¶æ€ $\boldsymbol{h}_{t-j-1}$ ä¼ å…¥åˆ°å½“å‰æ—¶é—´æˆ³å’Œ $\boldsymbol{X}_{t-j}$ è®¡ç®—å¾—åˆ° $\boldsymbol{h}_{t-j}$ã€‚å› æ­¤ï¼ŒèƒŒæ™¯å‘é‡ $\boldsymbol{C}$ å­˜å‚¨äº†åŒ…æ‹¬éšè—çŠ¶æ€ $(\boldsymbol{h}_{t-m}, \boldsymbol{h}_{t-m+1}, \boldsymbol{h}_{t-1})$ å’Œè¾“å…¥å‘é‡ $(\boldsymbol{X}_{t-m}, \boldsymbol{X}_{t-m+1}, \boldsymbol{X}_t)$ çš„ä¿¡æ¯ã€‚&lt;/p&gt;
$$\tag{8}
\boldsymbol{h}\_{t-j} = \begin{cases}
\text{Cell}\_{encoder}(\boldsymbol{h}\_0, \boldsymbol{X}\_{t-j}), \quad &amp;j = m\\
\text{Cell}\_{encoder}(\boldsymbol{h}\_{t-j-1}, \boldsymbol{X}\_{t-j}), \quad &amp;j \in \lbrace 0, \dots, m-1 \rbrace
\end{cases}
$$$$\tag{9}
\boldsymbol{C} = \boldsymbol{h}\_t
$$&lt;p&gt;å…¶ä¸­ $\boldsymbol{h}_0$ æ˜¯åˆå§‹éšè—çŠ¶æ€ï¼Œé€šå¸¸æ˜¯ 0 å‘é‡ï¼›$\text{Cell}_{encoder}(Â·)$ æ˜¯ç¼–ç å™¨çš„è®¡ç®—å‡½æ•°ï¼Œç”±ä½¿ç”¨çš„ RNN ç»“æ„å†³å®šã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è§£ç å™¨çš„éƒ¨åˆ†ï¼Œå…³é”®æ˜¯åˆ©ç”¨èƒŒæ™¯å‘é‡ $\boldsymbol{C}$ ä½œä¸ºåˆå§‹çš„éšè—å‘é‡ï¼Œä¸€æ­¥ä¸€æ­¥åœ°è§£ç ã€‚æ—¶é—´ $t+j, j \in \lbrace 1, \dots, n \rbrace$ æ­¥ï¼Œéšè—çŠ¶æ€ $\boldsymbol{h}_{t+j}$ ä¸ä»…åŒ…æ‹¬è¾“å…¥ä¿¡æ¯ï¼Œè¿˜è€ƒè™‘ä¹‹å‰çš„è¾“å‡ºçŠ¶æ€ $(\boldsymbol{h}_{t+1}, \boldsymbol{h}_{t+2}, \dots, \boldsymbol{h}_{t+j-1})$ã€‚&lt;/p&gt;
&lt;p&gt;è§£ç å™¨çš„è¾“å…¥ä¾èµ–äºè®­ç»ƒæ–¹æ³•ã€‚&lt;em&gt;Teacher forcing&lt;/em&gt; åœ¨ NLP ä¸­æ˜¯ä¸€ä¸ªæµè¡Œçš„è®­ç»ƒç­–ç•¥ã€‚åœ¨ teacher-forcing è®­ç»ƒç­–ç•¥ä¸­ï¼ŒçœŸå€¼åœ¨è®­ç»ƒçš„æ—¶å€™è¾“å…¥åˆ°è§£ç å™¨ï¼Œæµ‹è¯•çš„æ—¶å€™å°†é¢„æµ‹å€¼è¾“å…¥è¿›è§£ç å™¨ã€‚è¿™ç§æ–¹æ³•ä¸é€‚åˆæ—¶é—´åºåˆ—é¢„æµ‹ä¸»è¦æ˜¯å› ä¸ºåœ¨è®­ç»ƒå’Œæµ‹è¯•çš„æ—¶å€™ï¼Œè¾“å…¥åˆ°è§£ç å™¨çš„åˆ†å¸ƒä¸ä¸€è‡´ã€‚Li et al. (2017) ä½¿ç”¨ &lt;em&gt;scheduled sampling&lt;/em&gt; ç¼“è§£äº†è¿™ä¸ªé—®é¢˜ï¼Œé€šè¿‡è®¾å®šæ¦‚ç‡ $\epsilon$ï¼Œéšæœºçš„å°†çœŸå€¼æˆ–é¢„æµ‹å€¼æ”¾å…¥åˆ°è§£ç å™¨ä¸­ã€‚ä½†è¿™ä¼šå¢åŠ æ¨¡å‹çš„å¤æ‚åº¦ï¼Œç»™è®¡ç®—é€ æˆè´Ÿæ‹…ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–°çš„è®­ç»ƒç­–ç•¥ï¼Œå°†å†å²çš„ç»Ÿè®¡ä¿¡æ¯å’Œæ—¶é—´ä¿¡æ¯ä½œä¸ºè¾“å…¥ã€‚åœ¨æ—¶é—´åºåˆ—é¢„æµ‹é—®é¢˜ä¸­ï¼Œå†å²ä¿¡æ¯å¯ä»¥é€šè¿‡è®­ç»ƒå’Œæµ‹è¯•é˜¶æ®µè·å¾—ï¼›è¿™æ ·è§£ç å™¨åœ¨è®­ç»ƒå’Œæµ‹è¯•çš„æ—¶å€™ï¼Œå…¶è¾“å…¥çš„åˆ†å¸ƒå°±å¯ä»¥ç›¸äº’åŒæ­¥ï¼Œè§£å†³ &lt;em&gt;teacher forcing&lt;/em&gt; çš„é—®é¢˜ã€‚æ­¤å¤–ï¼Œå› ä¸ºå†å²ç»Ÿè®¡ä¿¡æ¯åœ¨å¤šæ­¥é¢„æµ‹ä¸­å¾ˆé‡è¦ï¼Œå¢åŠ è¿™ä¸ªå¯ä»¥æé«˜æ¨¡å‹çš„é¢„æµ‹ç²¾åº¦ã€‚ä¸‹é¢çš„ç­‰å¼ç”¨æ¥è®¡ç®— $t+j,j \in \lbrace 1, \dots, n \rbrace$ è¿™ä¸ªæ—¶é—´æ­¥è§£ç å™¨çš„éšè—çŠ¶æ€ã€‚&lt;/p&gt;
$$\tag{10}
\boldsymbol{v}^i\_{t+j}(H) = [N\_{t+j}; v^i\_{t+j, average};v^i\_{t+j, median}; v^i\_{t+j, max}; v^i\_{t+j, min}; d^i\_{t+j}]
$$$$\tag{11}
\boldsymbol{h}\_{t+j} = \begin{cases}
\text{Cell}\_{decoder}(\boldsymbol{C}, \boldsymbol{v}^i\_{t+j}(H)), \quad &amp;j = 1\\
\text{Cell}\_{decoder}(\boldsymbol{h}\_{t+j-1}, \boldsymbol{v}^i\_{t+j}(H)), \quad &amp;j \in \lbrace 2, \dots, n \rbrace
\end{cases}
$$&lt;p&gt;å…¶ä¸­ $\text{Cell}_{decoder}$ æ˜¯è§£ç å™¨çš„è®¡ç®—å…¬å¼ï¼Œä¸ç¼–ç å™¨ç±»ä¼¼ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ GRU (Chung et al., 2014) ä½œä¸ºç¼–ç å’Œè§£ç çš„ç»“æ„ï¼Œå¦‚å›¾4ã€‚å®éªŒæ•ˆæœæ¯”æ ‡å‡†çš„ LSTM å¥½å¾ˆå¤šã€‚ç¼–ç å™¨å’Œè§£ç å™¨çš„è®¡ç®—è¿‡ç¨‹å¦‚å¼12-17æ‰€ç¤ºï¼š&lt;/p&gt;
$$\tag{12}
z\_t = \sigma(\boldsymbol{W}\_z \cdot [\boldsymbol{h}\_{t-1}; x\_t] + b\_z)
$$$$\tag{13}
r\_t = \sigma(\boldsymbol{W}\_r \cdot [\boldsymbol{h}\_{t-1}; x\_t] + b\_r)
$$$$\tag{14}
c\_t = \text{tanh}(\boldsymbol{W}\_c \cdot [r\_t \odot \boldsymbol{h}\_{t-1}; x\_t] + b\_c)
$$$$\tag{15}
\boldsymbol{h}\_t = (1 - z\_t) \odot \boldsymbol{h}\_{t-1} + z\_t \odot c\_t
$$$$\tag{16}
\sigma(x) = \frac{1}{1 + e^{-x}}
$$$$\tag{17}
\text{tanh}(x) = \frac{e^x - e^{-x}}{e^x+e^{-x}}
$$&lt;p&gt;åœ¨ä¸Šå¼ä¸­ï¼Œ$z_t$ å’Œ $r_t$ åˆ†åˆ«æ˜¯æ›´æ–°é—¨å’Œé‡ç½®é—¨ã€‚$c_t$ æ˜¯å€™é€‰è¾“å‡ºï¼Œ$\sigma(\cdot)$ å’Œ $\text{tanh}(\cdot)$ æ˜¯ä¸¤ä¸ªæ¿€æ´»å‡½æ•°ã€‚$W_z$ï¼Œ$W_r$ å’Œ $W_c$ æ˜¯æƒé‡çŸ©é˜µï¼Œ$b_z$ï¼Œ$b_r$ å’Œ $b_c$ æ˜¯åç½®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multistep-speed-prediction-on-traffic-networks-a-graph-convolutional-sequence-to-sequence-learning-approach-with-attention-mechanism/Fig4.jpg"
loading="lazy"
alt="Figure4"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ•è·äº¤é€šæ¨¡å¼çš„å¤–éƒ¨ä¿¡æ¯ï¼Œæˆ‘ä»¬è¿˜é›†æˆäº†æ³¨æ„åŠ›æœºåˆ¶ (Bahdanau et al., 2014; Luong et al., 2015)ã€‚æ³¨æ„åŠ›æœºåˆ¶çš„å…³é”®åœ¨äºåœ¨æ¯ä¸ªæ—¶é—´æ­¥å¢åŠ æ•è·äº†æºä¿¡æ¯çš„ç›¸å…³æ€§çš„æ³¨æ„åŠ›å‘é‡æ¥å¸®åŠ©äº¤é€šé€Ÿåº¦ã€‚åœ¨æ—¶é—´æ­¥ $t+j, j \in \lbrace 1, \dots, n \rbrace$ï¼Œæ³¨æ„åŠ›å‡½æ•°å®šä¹‰ä¸ºå¼ 18-20ï¼Œå°† query $\boldsymbol{h}_{t+j}$ å’Œ ä¸€ç»„ key $(\boldsymbol{h}_{t-m}, \dots, \boldsymbol{t-1}, \boldsymbol{h}_t)$ æ˜ å°„èµ·æ¥ç»„æˆæ³¨æ„åŠ›å‘é‡ $\boldsymbol{S}_{t+j}$ã€‚å¦‚ä¸‹å¼ 18-20ï¼Œ$\boldsymbol{S}_{t+j}$ é€šè¿‡è®¡ç®—è¿™äº› key çš„å¸¦æƒå’Œå¾—åˆ°ï¼Œæƒé‡é€šè¿‡è®¡ç®—å¾—åˆ°ï¼š&lt;/p&gt;
$$\tag{18}
u^{t-i}\_{t+j} = \boldsymbol{q}^T \text{tanh} (\boldsymbol{h}\_{t+j} \boldsymbol{W}\_f \boldsymbol{h}\_{t-j}), \quad i = 0,1,\dots,m
$$$$\tag{19}
a^{t-i}\_{t+j} = \text{softmax}(u^{t-i}\_{t+j}) = \frac{\text{exp}(u^{t-i}\_{t+j})}{\sum^m\_{r=1} \text{exp} (u^{t-r}\_{t+j})}, \quad i=0,1,\dots,m
$$$$\tag{20}
\boldsymbol{S}\_{t+j} = \sum^m\_{i=1} a^{t-i}\_{t+j} \boldsymbol{h}\_{t-i}
$$&lt;p&gt;å…¶ä¸­ï¼Œå¼ 18 è®¡ç®—å‡ºçš„ $u^{t-i}_{t+j}$ å¯ä»¥ç”¨æ¥è¡¡é‡ $\boldsymbol{h}_{t+j}$ å’Œ $\boldsymbol{h}_{t-i}$ ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨ &lt;em&gt;Luong Attention form&lt;/em&gt; (Luong et al., 2015) ä½œä¸ºæ³¨æ„åŠ›çš„è®¡ç®—å…¬å¼ï¼Œ$\boldsymbol{W}_f$ å’Œ $\boldsymbol{q}^T$ æ˜¯å‚æ•°ï¼Œç”¨æ¥è°ƒèŠ‚ç»“æœçš„ç»´æ•°ï¼›$a^{t-i}_{t+j}$ æ˜¯ $u^{t-i}_{t+j}$ å½’ä¸€åŒ–çš„ç»“æœï¼Œç”¨ä½œå¯¹åº”ç¼–ç å™¨éšè—çŠ¶æ€ $\boldsymbol{h}_{t-i}$ çš„æƒé‡æ¥è®¡ç®— $\boldsymbol{S}_{t+j}$ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚å›¾3æ‰€ç¤ºï¼Œæ³¨æ„åŠ›éšè—çŠ¶æ€ $\tilde{\boldsymbol{h}}_{t+j}$ ç”±æ³¨æ„åŠ›å‘é‡ $\boldsymbol{S}_{t+j}$ å’ŒåŸå§‹éšè—çŠ¶æ€ $\boldsymbol{h}_{t+j}$ é€šè¿‡ä¸€ä¸ªç®€å•æ‹¼æ¥ç»„æˆï¼Œå¦‚å¼ 21 æ‰€ç¤ºã€‚å¼ 22 è¡¨ç¤ºä»éšè—çŠ¶æ€åˆ°è¾“å‡ºçš„çº¿æ€§å˜æ¢ã€‚å‚æ•° $\boldsymbol{W}_v$ å’Œ $b_v$ çš„ç»´åº¦ä¸è¾“å‡ºä¸€è‡´ã€‚&lt;/p&gt;
$$\tag{21}
\tilde{\boldsymbol{h}}\_{t+j} = \text{tanh} (\boldsymbol{W}\_h \cdot [\boldsymbol{S}\_{t+k};\boldsymbol{h}\_{t+j}])
$$$$\tag{22}
\hat{v}\_{t+j} = \boldsymbol{W}\_v \tilde{h}\_{t+j} + b\_v
$$&lt;p&gt;ä¸ºäº†å‡å°‘å¤šæ­¥é¢„æµ‹ä¸­çš„è¯¯å·®ï¼Œæˆ‘ä»¬å®šä¹‰äº†æ‰€æœ‰è¦é¢„æµ‹çš„æ—¶é—´æ­¥ä¸Šçš„å¹³å‡ç»å¯¹è¯¯å·®ï¼š&lt;/p&gt;
$$\tag{23}
loss = \frac{1}{n} \sum^n\_{j=1} \vert \hat{v}^i\_{t+j} - v^i\_{t+j} \vert
$$&lt;p&gt;æ‰€æœ‰çš„å‚æ•°é€šè¿‡éšæœºæ¢¯åº¦ä¸‹é™è®­ç»ƒã€‚&lt;/p&gt;
&lt;h1 id="4-numerical-examples"&gt;4 NUMERICAL EXAMPLES
&lt;/h1&gt;&lt;h2 id="41-dataset"&gt;4.1 Dataset
&lt;/h2&gt;&lt;p&gt;æ•°æ®é›†æ˜¯ä» A-map çš„ç”¨æˆ·æ”¶é›†çš„ï¼Œæ˜¯ä¸­å›½çš„ä¸€ä¸ªæ‰‹æœºå¯¼èˆªåº”ç”¨æä¾›çš„ (Sohu, 2018)ã€‚ç ”ç©¶èŒƒå›´é€‰æ‹©åœ¨äº†åŒ—äº¬ 2 ç¯ï¼Œæ˜¯åŒ—äº¬æœ€å µçš„åœ°æ–¹ã€‚å¦‚å›¾5(a)æ‰€ç¤ºï¼Œæˆ‘ä»¬å°† 33km é•¿çš„äºŒç¯ä»¥ 200m ä¸€æ®µåˆ†æˆ 163 ä¸ªè·¯æ®µã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬é€šè¿‡ç”¨æˆ·çš„è½¨è¿¹ç‚¹è®¡ç®—æ¯ä¸ªè·¯æ®µä¸Š 5 åˆ†é’Ÿçš„å¹³å‡é€Ÿåº¦ã€‚2ç¯ä¸Šå·¥ä½œå’Œå’Œå‘¨æœ«çš„è½¦é€Ÿå¦‚å›¾5(b)(c)æ‰€ç¤ºï¼Œx è½´æ˜¯ç»åº¦ï¼Œy è½´æ˜¯çº¬åº¦ï¼Œz è½´æ˜¯æ—¶é—´å’Œé€Ÿåº¦çš„é¢œè‰²è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multistep-speed-prediction-on-traffic-networks-a-graph-convolutional-sequence-to-sequence-learning-approach-with-attention-mechanism/Fig5_a.jpg"
loading="lazy"
alt="â€œFigure5 aâ€"
&gt;
&lt;img src="https://davidham3.github.io/blog/images/multistep-speed-prediction-on-traffic-networks-a-graph-convolutional-sequence-to-sequence-learning-approach-with-attention-mechanism/Fig5_bc.jpg"
loading="lazy"
alt="â€œFigure5 bcâ€"
&gt;&lt;/p&gt;
&lt;p&gt;æ•°æ®èŒƒå›´æ˜¯2016å¹´10æœˆ1æ—¥åˆ°2016å¹´11æœˆ30æ—¥ã€‚10æœˆ1æ—¥åˆ°11æœˆ20æ—¥åšè®­ç»ƒï¼Œ11æœˆ21æ—¥åˆ°27æ—¥åšæµ‹è¯•ã€‚é¢„æµ‹çš„èŒƒå›´æ˜¯ 06:00 åˆ° 22:00ï¼Œå› æ­¤ï¼Œæ¯æ¡è·¯æ®µæ¯å¤©åŒ…å« 192 ä¸ªæ•°æ®ç‚¹ã€‚å›¾6å±•ç¤ºäº†åˆ’åˆ†çš„æ•°æ®é›†ã€‚åœ¨æ•°æ®æ¸…ç†åï¼Œç¼ºå¤±å€¼é€šè¿‡çº¿æ€§æ’å€¼çš„æ–¹æ³•å¡«è¡¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multistep-speed-prediction-on-traffic-networks-a-graph-convolutional-sequence-to-sequence-learning-approach-with-attention-mechanism/Fig6.jpg"
loading="lazy"
alt="Figure6"
&gt;&lt;/p&gt;
&lt;h2 id="42-model-comparisons"&gt;4.2 Model comparisons
&lt;/h2&gt;&lt;p&gt;åœ¨æ¯ä¸ªéƒ¨åˆ†ï¼Œæå‡ºçš„æ¨¡å‹å¯¹æ¯”çš„æ˜¯å…¶ä»–çš„ benchmark æ¨¡å‹ï¼ŒåŒ…æ‹¬ä¼ ç»Ÿçš„æ—¶é—´åºåˆ—åˆ†ææ–¹æ³•ï¼ˆå¦‚ HA å’Œ ARIMAï¼‰ï¼Œè¿˜æœ‰ä¸€äº›å…ˆè¿›çš„æœºå™¨å­¦ä¹ æ–¹æ³•ï¼ˆANN, KNN, SVR, XGBOOSTï¼‰ï¼Œæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ˆLSTM, GCN, Seq2Seq-Attï¼‰ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;HAï¼šå†å²å‡å€¼æ¨¡å‹é€šè¿‡è®­ç»ƒé›†çš„ç»Ÿè®¡å€¼é¢„æµ‹æµ‹è¯•é›†çš„æœªæ¥è½¦é€Ÿã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè·¯æ®µ $l_i \in \mathcal{L}$ åœ¨ 8:00-8:05 çš„å¹³å‡è½¦é€Ÿé€šè¿‡è®­ç»ƒé›†åŒæ—¶æ®µåŒè·¯æ®µçš„å†å²é€Ÿåº¦å‡å€¼ä¼°è®¡ã€‚&lt;/li&gt;
&lt;li&gt;ARIMAï¼š$(p, d, q)$ æ¨¡å‹ (Box and Pierce, 1970)ï¼Œå·®åˆ†çš„é˜¶æ•°è®¾å®šä¸º $d = 1$ï¼Œè‡ªå›å½’éƒ¨åˆ†çš„é˜¶æ•°å’Œç§»åŠ¨å¹³å‡éƒ¨åˆ†çš„é˜¶æ•° $(p, q)$ é€šè¿‡è®¡ç®—å¯¹åº”çš„ Akaike information criterion å†³å®šï¼Œ$p \in [0, 2], q \in [7, 12]$ã€‚&lt;/li&gt;
&lt;li&gt;ANNï¼šæˆ‘ä»¬ç”¨äº†ä¸‰å±‚ç¥ç»ç½‘ç»œï¼Œsigmoid æ¿€æ´»ï¼Œéšè—å•å…ƒæ•°æ˜¯ç‰¹å¾æ•°çš„ 2 å€ã€‚å› ä¸º ANN ä¸èƒ½åŒºåˆ†æ—¶é—´æ­¥ä¸Šçš„å˜é‡ï¼Œæ‰€ä»¥å®ƒä¸èƒ½æ•è·æ—¶é—´ä¾èµ–ã€‚&lt;/li&gt;
&lt;li&gt;KNNï¼šk è¿‘é‚»ï¼Œè·å–è®­ç»ƒé›†ä¸­ç‰¹å¾ç©ºé—´æœ€ç›¸è¿‘çš„ k ä¸ªè§‚æµ‹å€¼ã€‚é¢„æµ‹å€¼é€šè¿‡å¯¹åº”çš„ç‰¹å¾å‘é‡è¿›è¡Œçº¿æ€§ç»„åˆå¾—åˆ°ã€‚è¶…å‚æ•° $K$ é€šè¿‡ 5 åˆ° 25 æŠ˜çš„äº¤å‰éªŒè¯é€‰å®šã€‚&lt;/li&gt;
&lt;li&gt;SVRï¼šæ”¯æŒå‘é‡å›å½’ (Suykens and Vandewalle, 1999)ï¼Œé€šè¿‡æ ¸å‡½æ•°å°†ç‰¹å¾å‘é‡æ˜ å°„åˆ°é«˜ç»´ç©ºé—´å¾—åˆ°æ‹Ÿåˆæ›²çº¿ã€‚æ ¸å‡½æ•°å’Œè¶…å‚æ•°é€šè¿‡äº¤å‰éªŒè¯é€‰å®šã€‚&lt;/li&gt;
&lt;li&gt;XGBOOSTï¼š(Chen and Guestrin, 2016) åœ¨å¾ˆå¤šæœºå™¨å­¦ä¹ ä»»åŠ¡ä¸Šè¡¨ç°å‡ºäº†å¾ˆå¥½çš„æ•ˆæœï¼›åŸºäºæ ‘ç»“æ„å¯ä»¥æ‰©å±•æˆç«¯åˆ°ç«¯çš„ç³»ç»Ÿã€‚æ‰€æœ‰çš„ç‰¹å¾ reshape åè¾“å…¥åˆ° XGBOOST æ¥è®­ç»ƒã€‚&lt;/li&gt;
&lt;li&gt;LSTMï¼š(Hochreiter and Schmidhuber, 1997)ï¼Œæ¯ä¸ªè·¯æ®µçš„æ‰€æœ‰ç‰¹å¾éƒ½ reshape æˆä¸€ä¸ªçŸ©é˜µï¼Œä¸€ä¸ªè½´æ˜¯æ—¶é—´ï¼Œå¦ä¸€ä¸ªè½´æ˜¯ç‰¹å¾ã€‚LSTM è€ƒè™‘æ—¶é—´ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰æ•è·ç©ºé—´ä¾èµ–ã€‚&lt;/li&gt;
&lt;li&gt;GCNï¼šGCN ä¸­æ‰€æœ‰çš„è·¯æ®µçš„ç‰¹å¾ reshape æˆä¸€ä¸ªçŸ©é˜µï¼Œä¸€ä¸ªè½´æ˜¯è·¯æ®µï¼Œå¦ä¸€ä¸ªè½´æ˜¯ç‰¹å¾ã€‚GCN é€šè¿‡æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µå°†å·ç§¯æ³›åŒ–åˆ°éæ¬§ç©ºé—´ï¼›å› æ­¤ï¼Œåªè€ƒè™‘äº†ç©ºé—´å…³è”ï¼Œæ²¡æœ‰æ•è·æ—¶é—´ä¾èµ–ã€‚&lt;/li&gt;
&lt;li&gt;Seq2Seq-Att: å’Œ AGC-Seq2Seq çš„åŒºåˆ«æ˜¯å›¾å·ç§¯å±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºäº†ä¿è¯å…±é¸£ï¼Œä¹‹å‰æåˆ°çš„é¢„æµ‹æ¨¡å‹éƒ½æœ‰å’Œ AGC-Seq2Seq åŒæ ·çš„è¾“å…¥ç‰¹å¾ï¼ˆç‰¹å¾ç±»å‹å’Œçª—å£é•¿åº¦ï¼‰ï¼Œå°½ç®¡ä¼ ç»Ÿçš„æ—¶é—´åºåˆ—æ¨¡å‹åˆ©ç”¨äº†è®­ç»ƒé›†çš„å…¨éƒ¨é€Ÿåº¦è®°å½•ã€‚çª—å£é•¿åº¦ä¸º 12ï¼Œä¹Ÿå°±æ˜¯ç”¨è¿‡å»ä¸€å°æ—¶é¢„æµ‹æœªæ¥ã€‚19 ç»´ç‰¹å¾å¦‚è¡¨ 1 æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multistep-speed-prediction-on-traffic-networks-a-graph-convolutional-sequence-to-sequence-learning-approach-with-attention-mechanism/Table1.jpg"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰çš„ç¬¦å·å¦‚ 3.1 èŠ‚å®šä¹‰ï¼Œ$n$ æ˜¯å®šå€¼ã€‚æˆ‘ä»¬é€šè¿‡ä¸‰ä¸ªé”™è¯¯æŒ‡æ ‡è¯„ä»·æ¨¡å‹ï¼ŒMAPE, MAE, RMSE, $\text{MAPE} = \frac{1}{Q} \sum^Q_{i=1} \frac{\vert v_i - \hat{v}_i \vert}{v_i}$, $\text{MAE} = \frac{1}{Q} \sum^Q_{i=1} \vert v_i - \hat{v}_i \vert$, $\text{RMSE} = \sqrt{\frac{1}{Q} \sum^Q_{i=1} (v_i - \hat{v}_i)^2}$ï¼Œå…¶ä¸­ $v_i$ å’Œ $\hat{v}^i$ åˆ†åˆ«æ˜¯çœŸå€¼å’Œé¢„æµ‹å€¼ï¼›$Q$ æ˜¯æµ‹è¯•é›†å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multistep-speed-prediction-on-traffic-networks-a-graph-convolutional-sequence-to-sequence-learning-approach-with-attention-mechanism/Table2_a.jpg"
loading="lazy"
alt="â€œTable2 aâ€"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multistep-speed-prediction-on-traffic-networks-a-graph-convolutional-sequence-to-sequence-learning-approach-with-attention-mechanism/Table2_b.jpg"
loading="lazy"
alt="â€œTable2 bâ€"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/multistep-speed-prediction-on-traffic-networks-a-graph-convolutional-sequence-to-sequence-learning-approach-with-attention-mechanism/Table2_c.jpg"
loading="lazy"
alt="â€œTable2 câ€"
&gt;&lt;/p&gt;</description></item><item><title>Geometric deep learning on graphs and manifolds using mixture model CNNs</title><link>https://davidham3.github.io/blog/p/geometric-deep-learning-on-graphs-and-manifolds-using-mixture-model-cnns/</link><pubDate>Tue, 18 Dec 2018 20:49:15 +0000</pubDate><guid>https://davidham3.github.io/blog/p/geometric-deep-learning-on-graphs-and-manifolds-using-mixture-model-cnns/</guid><description>&lt;p&gt;CVPR 2017. è¿™ç¯‡è®ºæ–‡æœ‰ç‚¹éš¾ï¼Œæ²¡çœ‹ä¸‹å»ã€‚ã€‚ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1611.08402.pdf" target="_blank" rel="noopener"
&gt;Geometric deep learning on graphs and manifolds using mixture model CNNs&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;å¤§éƒ¨åˆ†æ·±åº¦å­¦ä¹ å¤„ç†çš„æ˜¯ 1Dï¼Œ2Dï¼Œ3D æ¬§å¼ç»“æ„æ•°æ®ï¼ŒéŸ³é¢‘ä¿¡å·ã€å›¾åƒã€è§†é¢‘ã€‚æœ€è¿‘å¤§å®¶å¼€å§‹ç ”ç©¶åœ¨éæ¬§æ°ç©ºé—´ä¸Šçš„æ•°æ®ï¼Œå¦‚å¤æ‚ç½‘ç»œã€è®¡ç®—ç¤¾ä¼šç§‘å­¦ã€è®¡ç®—æœºå›¾å½¢å­¦ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªç»Ÿä¸€çš„æ¡†æ¶ï¼Œè®© CNN å¯ä»¥æ³›åŒ–åˆ°éæ¬§æ°ç©ºé—´ä¸Šï¼Œå­¦ä¹ å±€éƒ¨çš„ã€å¹³ç¨³çš„ã€é’ˆå¯¹ä»»åŠ¡å¯åˆ†è§£çš„ç‰¹å¾ã€‚æˆ‘ä»¬å‘ç°ä¹‹å‰æå‡ºçš„ä¸€äº›æ–¹æ³•éƒ½å¯ä»¥æ”¾åˆ°æˆ‘ä»¬çš„æ¡†æ¶ä¸­ã€‚æˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„æ–¹æ³•æ•ˆæœæ¯”å‰äººçš„æ–¹æ³•éƒ½è¦å¥½ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1. Introduction
&lt;/h1&gt;&lt;h1 id="2-deep-learning-on-graphs"&gt;2. Deep learning on graphs
&lt;/h1&gt;&lt;p&gt;æ— å‘å¸¦æƒå›¾ $\mathcal{G} = (\lbrace 1, \dots, n\rbrace, \mathcal{E}, \mathbf{W})$ï¼Œé‚»æ¥çŸ©é˜µ $\mathbf{W} = (w_{ij})$ï¼Œå…¶ä¸­ $w_{ij} = w_{ji}$ï¼Œå¦‚æœ $(i, j) \notin \mathcal{E}$ï¼Œåˆ™ $w_{ij} = 0$ï¼Œå¦åˆ™ $w_{ij} &amp;gt; 0$ã€‚æœªå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µæ˜¯ä¸ª $n \times n$ çš„ å®å¯¹ç§°åŠæ­£å®šçŸ©é˜µ $\Delta = \bf D - W$ï¼Œå…¶ä¸­ $\mathbf{D} = \text{diag}(\sum_{j = \not i} w_{ij})$ æ˜¯åº¦çŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µæœ‰ç‰¹å¾å€¼åˆ†è§£ $\bf \Delta = \Phi \Lambda \Phi^T$ï¼Œå…¶ä¸­ $\Phi = (\phi_1, \dots, \phi_n)$ æ˜¯ç›¸äº’æ­£äº¤çš„ç‰¹å¾å‘é‡ï¼Œ$\Lambda = \text{diag}(\lambda_1, &amp;hellip;, \lambda_n)$ ç‰¹å¾å€¼ç»„æˆçš„å¯¹è§’çŸ©é˜µã€‚åœ¨ä¼ ç»Ÿçš„è°æ³¢åˆ†æä¸­ï¼Œç‰¹å¾å‘é‡æ˜¯æ‹‰æ™®æ‹‰æ–¯ç®—å­ï¼Œç‰¹å¾å€¼å¯ä»¥çœ‹ä½œæ˜¯é¢‘ç‡ã€‚ç»™å®šå›¾ä¸Šçš„ä¸€ä¸ªä¿¡å· $\mathbf{f} = (f_1, \dots, f_n)^T$ï¼Œå®ƒçš„å›¾å‚…é‡Œå¶å˜æ¢æ˜¯ $\hat{\mathbf{f}} = \Phi^T \mathbf{f}$ã€‚ç»™å®šä¸¤ä¸ªä¿¡å· $\bf f, g$ï¼Œä»–ä»¬çš„è°±å·ç§¯å®šä¹‰ä¸ºå‚…é‡Œå¶å˜æ¢çš„ element-wise productï¼š&lt;/p&gt;
$$\tag{1}
\mathbf{f} \star \mathbf{g} = \Phi (\Phi^T \mathbf{f}) \odot (\Phi^T g) = \Phi \ \text{diag}(\hat{g}\_1, \dots, \hat{g}\_n) \hat{f},
$$&lt;p&gt;å¯¹åº”äº†æ¬§æ°ç©ºé—´å·ç§¯ç†è®ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…¶å®è¿™é‡Œæˆ‘æ²¡ç†è§£å•Šï¼Œæˆ‘è®°å¾—å·ç§¯çš„å®šä¹‰ä¸æ˜¯å‚…é‡Œå¶å˜æ¢çš„ä¹˜ç§¯çš„é€†å˜æ¢å—ï¼Œæ‰€ä»¥æ„Ÿè§‰è¯´çš„æœ‰ç‚¹ä¸å¯¹ï¼Œä½†å…¬å¼å€’æ˜¯å¯¹äº†ã€‚ã€‚ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Spectral CNN.&lt;/strong&gt; Bruna et al. ä½¿ç”¨å·ç§¯åœ¨è°±ä¸Šçš„å®šä¹‰å°† CNN æ³›åŒ–åˆ°å›¾ä¸Šï¼Œå¾—åˆ°ä¸€ä¸ªè°±å·ç§¯å±‚çš„å®šä¹‰ï¼š&lt;/p&gt;
$$\tag{2}
\mathbf{f}^{out}\_l = \xi (\sum^p\_{l'=1} \Phi\_k \hat{G}\_{l,l'} \Phi^T\_k \mathbf{f}^{in}\_{l'})
$$&lt;p&gt;è¿™é‡Œç»´æ•°ä¸º $n \times p$ å’Œ $n \times q$ çš„çŸ©é˜µ $\mathbf{F}^{in} = (\mathbf{f}^{in}_1, \dots, \mathbf{f}^{in}_p)$ï¼Œ$\mathbf{F}^{out} = (\mathbf{f}^{out}_1, \dots, \mathbf{f}^{out}_q)$ åˆ†åˆ«è¡¨ç¤º $p$ ç»´å’Œ $q$ ç»´çš„å›¾ä¸Šçš„è¾“å…¥å’Œè¾“å‡ºä¿¡å·ï¼Œ$\Phi = (\phi_1, \dots, \phi_k)$ æ˜¯å‰å‡ ä¸ªç‰¹å¾å‘é‡ç»„æˆçš„ $n \times k$ çš„çŸ©é˜µï¼Œ$\hat{\mathbf{G}_{l,l&amp;rsquo;}} = \text{diag}(\hat{g}_{l,l&amp;rsquo;,1}, \dots, \hat{g}_{l,l&amp;rsquo;,k})$ æ˜¯ä¸€ä¸ª $k \times k$ çš„å¯¹è§’çŸ©é˜µï¼Œè¡¨ç¤ºé¢‘åŸŸå†…ä¸€ä¸ªå¯å­¦ä¹ çš„æ»¤æ³¢å™¨ï¼Œ$\xi$ æ˜¯ä¸€ä¸ªéçº¿æ€§æ¿€æ´»å•å…ƒï¼ˆe.g. ReLUï¼‰ã€‚è¿™ä¸ªæ¡†æ¶çš„æ± åŒ–æ“ä½œåœ¨å›¾ä¸Šçš„æ¨¡æ‹Ÿæ˜¯ä¸€ä¸ªå›¾çš„ç¼©å‡æ“ä½œï¼Œç»™å®šä¸€ä¸ª $n$ ä¸ªç»“ç‚¹çš„å›¾ï¼Œç”Ÿæˆä¸€ä¸ª $n&amp;rsquo; &amp;lt; n$ ä¸ªç»“ç‚¹çš„å›¾ï¼Œå°†ä¿¡å·ä»åŸæ¥çš„å›¾ä¸Šå˜æ¢åˆ°ç¼©å‡åçš„å›¾ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ¡†æ¶æœ‰å‡ ä¸ªç¼ºç‚¹ã€‚é¦–å…ˆï¼Œè°±æ»¤æ³¢å™¨çš„ç³»æ•°æ˜¯ &lt;em&gt;basis dependent&lt;/em&gt;ï¼Œè€Œä¸”ï¼Œåœ¨ä¸€ä¸ªå›¾ä¸Šå­¦ä¹ åˆ°çš„åŸºäºè°±çš„ CNN æ¨¡å‹ä¸èƒ½åº”ç”¨åœ¨å…¶ä»–çš„å›¾ä¸Šã€‚å…¶æ¬¡ï¼Œå›¾å‚…é‡Œå¶å˜æ¢çš„è®¡ç®—å› ä¸º $\bf \Phi$ å’Œ $\bf \Phi^T$ çš„ä¹˜æ³•ï¼Œä¼šè¾¾åˆ° $\mathcal{O}(n^2)$ï¼Œå› ä¸ºè¿™é‡Œæ²¡æœ‰åƒ FFT ä¸€æ ·çš„ç®—æ³•ã€‚ç¬¬ä¸‰ï¼Œä¸èƒ½ä¿è¯åœ¨è°±åŸŸå†…çš„æ»¤æ³¢å™¨åœ¨é¡¶ç‚¹åŸŸä¸Šæ˜¯å±€éƒ¨åŒ–çš„ï¼›å‡è®¾ä½¿ç”¨ $k = O(n)$ ä¸ªå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å‘é‡ï¼Œä¸€ä¸ªè°±å·ç§¯å±‚éœ€è¦ $pqk = O(n)$ ä¸ªå‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Smooth Spectral CNN.&lt;/strong&gt; ä¹‹åï¼ŒHenaff et al. è®¤ä¸º smooth è°±æ»¤æ³¢å™¨ç³»æ•°å¯ä»¥ä½¿å¾—å·ç§¯æ ¸åœ¨ç©ºé—´ä¸Šå±€éƒ¨åŒ–ï¼Œä½¿ç”¨äº†è¿™ä¸ªå½¢å¼ï¼š&lt;/p&gt;
$$\tag{3}
\hat{g}\_i = \sum^r\_{j=1} \alpha\_i \beta\_j (\Lambda\_i)
$$&lt;p&gt;å…¶ä¸­ $\beta_1(\lambda), \dots, \beta_r(\lambda)$ æ˜¯ä¸€äº›å›ºå®šçš„æ’å€¼æ ¸ï¼Œ$\mathbb{\alpha} = (\alpha_1, \dots, \alpha_r)$ æ˜¯æ’å€¼ç³»æ•°ã€‚çŸ©é˜µå½¢å¼ä¸­ï¼Œæ»¤æ³¢å™¨å†™ä¸º $\text{diag}(\hat{G}) = \mathbf{B\alpha}$ï¼Œå…¶ä¸­ $\bf{B} = (b_{ij}) = (\beta_j (\lambda_i))$ æ˜¯ä¸€ä¸ª $k \times r$ çš„çŸ©é˜µã€‚è¿™æ ·ä¸€ä¸ªå‚æ•°åŒ–å¯ä»¥ä½¿å‚æ•°ä¿æŒåœ¨ $n$ ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Chebyshev Spectral CNN (ChebNet).&lt;/strong&gt; ä¸ºäº†å‡è½»è®¡ç®—å›¾å‚…é‡Œå¶å˜æ¢çš„ä»£ä»·ï¼ŒDefferrard et al ä½¿ç”¨äº†åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼æ¥è¡¨ç¤ºå·ç§¯æ ¸ï¼š&lt;/p&gt;
$$\tag{4}
g\_\alpha(\Delta) = \sum^{r-1}\_{j=0} \alpha\_j T\_j(\tilde{\Delta}) = \sum^{r-1}\_{j=0} \alpha\_j \Phi T\_j (\tilde{\Lambda}) \Phi^T,
$$&lt;p&gt;å…¶ä¸­ $\tilde{\Delta} = 2 \lambda^{-1}_n \Delta - \bf I$ æ˜¯ rescaled æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼Œå®ƒçš„ç‰¹å¾å€¼ $\tilde{\Lambda} = 2 \lambda^{-1}_n \Lambda - \bf I$ åœ¨åŒºé—´ $[-1, 1]$ å†…ï¼Œ$\alpha$ æ˜¯ $r$ ç»´çš„æ»¤æ³¢å™¨ä¸­çš„å¤šé¡¹å¼ç³»æ•°ï¼Œ&lt;/p&gt;
$$\tag{5}
T\_j(\lambda) = 2 \lambda T\_{j-1}(\lambda) - T\_{j-2} (\lambda),
$$&lt;p&gt;è¡¨ç¤º $j$ é˜¶åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼ï¼Œ$T_1(\lambda) = \lambda$ï¼Œ$T_0(\lambda) = 1$ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·çš„æ–¹æ³•æœ‰å‡ ä¸ªä¼˜ç‚¹ã€‚é¦–å…ˆï¼Œå®ƒä¸éœ€è¦è®¡ç®—æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å‘é‡ã€‚ç”±äºåˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼çš„é€’å½’å®šä¹‰ï¼Œè®¡ç®—æ»¤æ³¢å™¨ $g_\alpha(\Lambda) \bf f$ è¦ä½¿ç”¨æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ $r$ æ¬¡ï¼Œä¼šå¯¼è‡´ä¸€ä¸ª $\mathcal{O}(rn)$ çš„æ“ä½œã€‚å…¶æ¬¡ï¼Œå› ä¸ºæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µæ˜¯ä¸€ä¸ªå±€éƒ¨æ“ä½œï¼Œåªå½±å“é¡¶ç‚¹çš„ä¸€é˜¶é‚»å±…ï¼Œå®ƒçš„ $(r-1)$æ¬¡å¹‚å½±å“ $r$é˜¶é‚»å±…ï¼Œå¾—åˆ°çš„æ»¤æ³¢å™¨æ˜¯å±€éƒ¨åŒ–çš„ã€‚&lt;/p&gt;</description></item><item><title>A Tutorial on Spectral Clustering</title><link>https://davidham3.github.io/blog/p/a-tutorial-on-spectral-clustering/</link><pubDate>Wed, 05 Dec 2018 15:56:49 +0000</pubDate><guid>https://davidham3.github.io/blog/p/a-tutorial-on-spectral-clustering/</guid><description>&lt;p&gt;å…³äºè°±èšç±»çš„æ–‡ç« ï¼Œä¸»è¦åŒ…å«äº†è°±èšç±»å’Œæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„å†…å®¹ã€‚æœ€è¿‘ç ”ç©¶ GCN çš„åŸç†çš„æ—¶å€™å‘ç°äº†è¿™ç¯‡è®ºæ–‡ã€‚
Von Luxburg U. A tutorial on spectral clustering[J]. Statistics and Computing, 2007, 17(4): 395-416.
åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/0711.0189" target="_blank" rel="noopener"
&gt;A Tutorial on Spectral Clustering&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="2-similarity-graphs"&gt;2 Similarity graphs
&lt;/h1&gt;&lt;p&gt;ç»™å®šä¸€ç»„æ•°æ®ç‚¹ $x_1, &amp;hellip;, x_n$ è¿˜æœ‰æ•°æ®ç‚¹ $x_i$ å’Œ $x_j$ ä¹‹é—´çš„ç›¸ä¼¼æ€§ $s_{ij} \geq 0$ï¼Œèšç±»çš„ç›®æ ‡æ˜¯å°†æ ·æœ¬ç‚¹åˆ†åˆ°å‡ ä¸ªç»„ä¸­ï¼Œç»„çš„æ ·æœ¬ç›¸ä¼¼ï¼Œä¸åŒç»„çš„æ ·æœ¬ä¸ç›¸ä¼¼ã€‚å¦‚æœæ²¡æœ‰æ›´å¤šçš„ä¿¡æ¯ï¼Œä½¿ç”¨ &lt;em&gt;similarity graph&lt;/em&gt; è¡¨ç¤ºæ•°æ®æ˜¯ä¸€ä¸ªå¥½çš„æ–¹æ³•ï¼Œ$G = (V, E)$ã€‚æ¯ä¸ªé¡¶ç‚¹ $v_i$ è¡¨ç¤ºä¸€ä¸ªæ•°æ®ç‚¹ $x_i$ã€‚å¦‚æœç›¸ä¼¼åº¦ $s_{ij}$ æ˜¯æ­£çš„ï¼Œä¸”å¤§äºä¸€ä¸ªç¡®å®šçš„é˜ˆå€¼ï¼Œé‚£ä¹ˆä¸¤ä¸ªé¡¶ç‚¹ç›¸è¿ï¼Œè¾¹çš„æƒé‡ä¸º $s_{ij}$ã€‚èšç±»çš„é—®é¢˜å¯ä»¥ä½¿ç”¨ç›¸ä¼¼åº¦å›¾é‡æ–°å®šä¹‰ä¸ºï¼šæˆ‘ä»¬æƒ³æ‰¾åˆ°ä¸€ä¸ªåˆ’åˆ†æ–¹æ¡ˆï¼Œä½¿å¾—ä¸åŒç»„ä¹‹é—´çš„è¾¹æœ‰å¾ˆå°çš„æƒé‡ï¼ˆæ„å‘³ç€ä¸åŒç±»ç°‡é—´çš„æ ·æœ¬ä¸ç›¸ä¼¼ï¼‰ï¼ŒåŒç»„å†…çš„æƒé‡è¾ƒé«˜ï¼ˆæ„å‘³ç€åŒä¸€ç±»ç°‡çš„æ ·æœ¬ç›¸ä¼¼ï¼‰ã€‚æˆ‘ä»¬é¦–å…ˆå¼•å…¥ä¸€äº›ç¬¦å·å’Œæ€§è´¨ã€‚&lt;/p&gt;
&lt;h2 id="21-graph-notation"&gt;2.1 Graph notation
&lt;/h2&gt;&lt;p&gt;$G = (V, E)$ æ˜¯æ— å‘å›¾ï¼Œé¡¶ç‚¹é›† $V = \lbrace v_1, &amp;hellip;, v_n \rbrace $ã€‚æˆ‘ä»¬å‡è®¾å›¾ $G$ æ˜¯å¸¦æƒçš„ï¼Œè¾¹æœ‰éè´Ÿæƒé‡ $w_{ij} \geq 0$ã€‚å¸¦æƒçš„é‚»æ¥çŸ©é˜µæ˜¯ $W = (w_{ij})_{i,j=1,&amp;hellip;,n}$ã€‚å¦‚æœ $w_{ij} = 0$ï¼Œè¡¨ç¤ºé¡¶ç‚¹ $v_i$ å’Œ $v_j$ä¹‹é—´æ²¡æœ‰è¾¹ã€‚å› ä¸º $G$ æ˜¯æ— å‘çš„ï¼Œæ‰€ä»¥ $w_{ij} = w_{ji}$ã€‚é¡¶ç‚¹ $v_i \in V$ çš„åº¦å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$
d\_i = \sum^n\_{j = 1} w\_{ij}.
$$&lt;p&gt;äº‹å®ä¸Šï¼Œè¿™ä¸ªåŠ å’Œåªä¼šåœ¨æ‰€æœ‰å’Œ $v_i$ é‚»æ¥çš„é¡¶ç‚¹ä¸Šåšï¼Œ å› ä¸ºå’Œå…¶ä»–çš„é¡¶ç‚¹ä¹‹é—´çš„è¾¹æƒé‡ä¸º0ã€‚åº¦çŸ©é˜µ $D$ å®šä¹‰ä¸ºå¯¹è§’çŸ©é˜µï¼Œå¯¹è§’çº¿ä¸Šæ˜¯åº¦ $d_1, &amp;hellip;, d_n$ã€‚ç»™å®šé¡¶ç‚¹çš„å­é›† $A \subset V$ï¼Œå®ƒçš„è¡¥é›† $V \ \backslash \ A$ è¡¨ç¤ºä¸º $\bar{A}$ã€‚å®šä¹‰ä¸€ä¸ªæŒ‡ç¤ºå‘é‡ $1_A = (f_1, \dots f_n)&amp;rsquo; \in \mathbb{R}^n$ï¼Œå¦‚æœ $v_i \in A$ï¼Œ$f_i = 1$ï¼Œå¦åˆ™ $f_i = 0$ã€‚æˆ‘ä»¬åœ¨åšæ±‚å’Œçš„æ—¶å€™ï¼Œæ¯”å¦‚ $\sum_{i \in A} w_{ij}$ï¼Œ æŠŠ $\lbrace i \mid v_i \in A \rbrace $ ç®€è®°ä¸º $i \in A$ã€‚å¯¹äºä¸¤ä¸ªä¸ç›¸äº¤çš„é›†åˆ $A, B \subset V$ï¼Œå®šä¹‰ï¼š&lt;/p&gt;
$$
W(A, B) := \sum\_{i \in A, j \in B} w\_{ij}.
$$&lt;p&gt;æˆ‘ä»¬è€ƒè™‘ä¸¤ä¸ªä¸åŒçš„æ–¹å¼æ¥æè¿°å­é›† $A \subset V$ çš„â€œå¤§å°â€ï¼š&lt;/p&gt;
$$
\vert A \vert := A çš„é¡¶ç‚¹æ•°\\
\text{vol}(A) := \sum\_{i \in A} d\_i.
$$&lt;p&gt;ç›´è§‚ä¸Šæ¥è®²ï¼Œ$\vert A \vert$ é€šè¿‡é¡¶ç‚¹æ•°æè¿°äº† $A$ çš„å¤§å°ï¼Œä½†æ˜¯ $\text{vol}(A)$ é€šè¿‡å¯¹ $A$ ä¸­æ‰€æœ‰çš„è¾¹è¿›è¡ŒåŠ å’Œå¾—åˆ°ã€‚å¦‚æœ $A$ ä¸­çš„ä¸¤ä¸ªç»“ç‚¹å¯ä»¥é€šè¿‡ä¸€æ¡è·¯å¾„è¿æ¥ï¼Œè€Œä¸”ä¸­é—´çš„ç‚¹éƒ½åœ¨ $A$ ä¸­ï¼Œé‚£ä¹ˆç§°å­é›† $A \subset V$ æ˜¯è¿é€šçš„ã€‚å¦‚æœå­é›†æ˜¯è¿é€šçš„ï¼Œä¸”é¡¶ç‚¹é›† $A$ å’Œ $\bar{A}$ ä¹‹é—´æ²¡æœ‰ç»“ç‚¹ç›¸è¿ï¼Œé‚£ä¹ˆç§° $A$ æ˜¯ä¸€ä¸ªè¿é€šåˆ†é‡ã€‚å¦‚æœ $A_i \cap A_j = \emptyset$ ä¸” $A_1 \cup \dots \cup A_k = V$ï¼Œé‚£ä¹ˆéç©ºé›†åˆ $A_1, \dots, A_k$ æ˜¯å›¾çš„ä¸€ä¸ªåˆ’åˆ†ã€‚&lt;/p&gt;
&lt;h2 id="22-different-similarity-graphs"&gt;2.2 Different similarity graphs
&lt;/h2&gt;&lt;p&gt;æœ‰ä¸€äº›æµè¡Œçš„æ–¹æ³•å¯¹é¡¶ç‚¹é—´çš„ç›¸ä¼¼åº¦æˆ–è·ç¦»æ„å»ºå›¾ã€‚æ„å»ºç›¸ä¼¼åº¦å›¾çš„ç›®æ ‡æ˜¯å¯¹æ ·æœ¬ä¹‹é—´çš„å±€éƒ¨é‚»å±…å…³ç³»å»ºæ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;The $\varepsilon$-neighborhood graph:&lt;/strong&gt; æˆ‘ä»¬æŠŠè·ç¦»å°äº $\varepsilon$ çš„æ ·æœ¬è¿èµ·æ¥ã€‚å› ä¸ºè¿æ¥èµ·æ¥çš„æ ·æœ¬ç‚¹åŸºæœ¬æ˜¯ä¸€ä¸ªå°ºåº¦çš„ï¼Œè€ƒè™‘è¾¹çš„æƒé‡ä¸ä¼šå¢åŠ æ›´å¤šçš„ä¿¡æ¯ã€‚æ‰€ä»¥ï¼Œ$\varepsilon$-é‚»å±…å›¾é€šå¸¸æ˜¯æ— æƒå›¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;$k$-nearest neighbor graphs:&lt;/strong&gt; å¦‚æœ $v_j$ æ˜¯ $v_i$ çš„ $k$-è¿‘é‚»é‚»å±…ï¼Œé‚£ç›®æ ‡æ˜¯è¿æ¥ $v_i$ å’Œ $v_j$ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªå®šä¹‰ä¼šå¾—åˆ°ä¸€ä¸ªæœ‰å‘å›¾ï¼Œå› ä¸ºé‚»å±…é—´çš„å…³ç³»æ˜¯éå¯¹ç§°çš„ã€‚æœ‰ä¸¤ç§æ–¹æ³•å˜æˆæœ‰å‘ã€‚ç¬¬ä¸€ç§æ˜¯å¿½ç•¥è¾¹çš„æ–¹å‘ï¼Œä¹Ÿå°±æ˜¯ç”¨æ— å‘è¾¹è¿æ¥ã€‚ç»“æœé€šå¸¸ç§°ä¸º $k$-è¿‘é‚»é‚»å±…å›¾ã€‚ç¬¬äºŒç§æ–¹æ³•æ˜¯å¦‚æœä¸¤ä¸ªé¡¶ç‚¹äº’ä¸ºå¯¹æ–¹çš„ $k$-è¿‘é‚»é‚»å±…ï¼Œé‚£ä¹ˆç›¸è¿ã€‚å¾—åˆ°çš„å›¾ç§°ä¸º &lt;em&gt;mutual $k$-nearest neighbor graph&lt;/em&gt;ã€‚è¿™ä¸¤ç§å›¾çš„è¾¹éƒ½æ˜¯é¡¶ç‚¹çš„ç›¸ä¼¼åº¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;The fully connected graph:&lt;/strong&gt; æˆ‘ä»¬ç®€å•çš„è¿æ¥æœ‰ç€æ­£çš„ç›¸ä¼¼åº¦çš„é¡¶ç‚¹ï¼Œè¾¹çš„æƒé‡å°±æ˜¯ç›¸ä¼¼åº¦ $s_{ij}$ã€‚å› ä¸ºå›¾åº”è¯¥è¡¨ç¤ºå±€éƒ¨é‚»å±…å…³ç³»ï¼Œè¿™ä¸ªæ„å»ºæ–¹æ³•åªåœ¨ç›¸ä¼¼åº¦èƒ½ä½“ç°å±€éƒ¨é‚»å±…å…³ç³»æ—¶æ‰æœ‰æ•ˆã€‚ä¸¾ä¸ªç›¸ä¼¼åº¦å‡½æ•°çš„ä¾‹å­ï¼Œé«˜æ–¯ç›¸ä¼¼åº¦å‡½æ•° $s(x_i, x_j) = \exp(- \Vert x_i - x_j \Vert ^ 2 / (2 \sigma^2))$ï¼Œå‚æ•° $\sigma$ æ§åˆ¶äº†é‚»å±…çš„å®½åº¦ã€‚è¿™ä¸ªå‚æ•°å’Œ $\varepsilon$-é‚»å±…å›¾ä¸­çš„ $\varepsilon$ çš„è§’è‰²å·®ä¸å¤šã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢æåˆ°çš„å›¾æ˜¯è°±èšç±»ä¸­å¸¸ç”¨çš„ã€‚æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œç›¸ä¼¼åº¦å›¾å¦‚ä½•å½±å“è°±èšç±»çš„ç»“æœè¿˜ä¸ä¸ºæ‰€çŸ¥ã€‚ä¸åŒçš„å›¾çš„è¡¨ç°å½¢å¼æˆ‘ä»¬ä¼šåœ¨ç¬¬å…«èŠ‚è®¨è®ºã€‚&lt;/p&gt;
&lt;h1 id="3-graph-laplacians-and-their-basic-properties"&gt;3 Graph Laplacians and their basic properties
&lt;/h1&gt;&lt;p&gt;è°±èšç±»çš„ä¸»è¦å·¥å…·æ˜¯å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µã€‚æœ‰ä¸€ä¸ªé¢†åŸŸè‡´åŠ›ç ”ç©¶è¿™äº›çŸ©é˜µï¼Œç§°ä¸ºè°±å›¾ç†è®º(e.g., see Chung, 1997)ã€‚æˆ‘ä»¬è¿™èŠ‚å®šä¹‰ä¸åŒçš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼ŒæŒ‡å‡ºä»–ä»¬çš„é‡è¦æ€§è´¨ã€‚æˆ‘ä»¬ä¼šä»”ç»†çš„å¯¹æ¯”ä¸åŒçš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µã€‚æ³¨æ„ï¼Œäº‹å®ä¸Šæ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„è¯´æ³•è¯´å“ªä¸ªçŸ©é˜µå°±æ˜¯ &amp;ldquo;graph Laplacian&amp;rdquo;ã€‚é€šå¸¸ï¼Œæ¯ä¸ªä½œè€…éƒ½ç§°ä»–ä»¬ä½¿ç”¨çš„çŸ©é˜µæ˜¯æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µã€‚å› æ­¤ï¼Œåœ¨è¯»å…³äºæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„è®ºæ–‡çš„æ—¶å€™éœ€è¦æ³¨æ„ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾ $G$ æ˜¯æ— å‘å¸¦æƒå›¾ï¼Œæƒé‡çŸ©é˜µ $W$ï¼Œ$w_{ij} = w_{ji} \geq 0$ã€‚ä½¿ç”¨ä¸€ä¸ªçŸ©é˜µçš„ç‰¹å¾å‘é‡æ—¶ï¼Œæˆ‘ä»¬æ²¡æœ‰å¿…è¦å‡è®¾ä»–ä»¬æ˜¯å½’ä¸€åŒ–çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¸¸å‘é‡ $1$ å’Œä»–çš„å€æ•° $a1$ åœ¨ $a = \not 0$ çš„æ—¶å€™è¢«è®¤ä¸ºæ˜¯ç›¸åŒçš„ç‰¹å¾å‘é‡ã€‚ç‰¹å¾å€¼æ€»æ—¶å‡åºæ’åˆ—ï¼Œè€Œä¸”ä¼šæœ‰å¤šé‡æ€§ã€‚å‰ $k$ ä¸ªç‰¹å¾å€¼ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯å‰ $k$ ä¸ªæœ€å°çš„ç‰¹å¾å€¼ã€‚&lt;/p&gt;
&lt;h2 id="31-the-unnormalized-graph-laplacian"&gt;3.1 The unnormalized graph Laplacian
&lt;/h2&gt;&lt;p&gt;éå½’ä¸€åŒ–çš„å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µå®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$
L = D - W.
$$&lt;p&gt;å…³äºå®ƒçš„æ€§è´¨çš„è®ºæ–‡åœ¨ Mohar(1991, 1997)ã€‚ä¸‹é¢æ€§è´¨æ˜¯è°±èšç±»éœ€è¦çš„æ€§è´¨ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Proposition 1 (Properties of $L$)&lt;/strong&gt; æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µæ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯¹äºæ¯ä¸ªå‘é‡ $f \in \mathbb{R}^n$ï¼Œæˆ‘ä»¬æœ‰ï¼š&lt;/li&gt;
&lt;/ol&gt;
$$
f'Lf = \frac{1}{2} \sum^n\_{i,j=1} w\_{ij}(f\_i - f\_j)^2.
$$&lt;ol start="2"&gt;
&lt;li&gt;$L$ æ˜¯å¯¹ç§°ä¸”åŠæ­£å®šçš„ã€‚&lt;/li&gt;
&lt;li&gt;$L$ æœ€å°çš„ç‰¹å¾å€¼æ˜¯ $0$ï¼Œå¯¹åº”çš„ç‰¹å¾å‘é‡æ˜¯å¸¸å‘é‡ $1$ã€‚&lt;/li&gt;
&lt;li&gt;$L$ æœ‰ $n$ ä¸ªéè´Ÿå®æ•°ç‰¹å¾å€¼ $0 = \lambda_1 \leq \lambda_2 \leq \dots \lambda_n$ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;em&gt;Proof.&lt;/em&gt;
Part (1)ï¼šç”± $d_i$ çš„å®šä¹‰å¾—ï¼š&lt;/p&gt;
$$
\begin{aligned}
f'Lf &amp;= f'Df - f'Wf = \sum^n\_{i=1}d\_i f^2\_i - \sum^n\_{i,j=1} f\_i f\_j w\_{ij}\\
&amp;=\frac{1}{2} \Bigg( \sum^n\_{i=1} d\_i f^2\_i - 2 \sum^n\_{i,j=1} f\_i f\_j w\_{ij} + \sum^n\_{j=1} d\_j f^2\_j \Bigg) = \frac{1}{2} \sum^n\_{i,j=1} w\_{ij} (f\_i - f\_j)^2.
\end{aligned}
$$&lt;p&gt;Part (2)ï¼š$L$ çš„å¯¹ç§°æ€§æ˜¯å› ä¸º $W$ å’Œ $D$ æ˜¯å¯¹ç§°çš„ã€‚åŠæ­£å®šæ˜¯ Part (1) çš„ç»“æœï¼Œå¯¹äºä»»æ„çš„ $f \in \mathbb{R}^n$ï¼Œ$f&amp;rsquo;Lf \geq 0$ã€‚&lt;/p&gt;
&lt;p&gt;Part (3)ï¼šæ˜¾è€Œæ˜“è§ã€‚&lt;/p&gt;
&lt;p&gt;Part (4)ï¼šç”±(1) å’Œ (3) æ¨å‡ºã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼šéå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µä¸ä¾èµ–äºé‚»æ¥çŸ©é˜µ $W$ çš„å¯¹è§’çº¿ä¸Šçš„å…ƒç´ ã€‚é‚»æ¥çŸ©é˜µéå¯¹è§’çº¿ä¸Šçš„å…ƒç´ å¾—åˆ°éå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µã€‚å›¾ä¸­çš„è‡ªè¿æ¥ä¸ä¼šæ”¹å˜å¯¹åº”çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µã€‚
ï¼ˆè¿™é‡Œè¯´ç™½äº†å°±æ˜¯ï¼Œæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µéå¯¹è§’çº¿ä½ç½®ä¸Šçš„å…ƒç´ æ˜¯é‚»æ¥çŸ©é˜µå¯¹åº”ä½ç½®çš„å…ƒç´ çš„ç›¸åæ•°ï¼Œå¦‚æœé¡¶ç‚¹åŠ è‡ªè¿æ¥ï¼Œé‚£ä¹ˆåº¦çŸ©é˜µå°±ä¼šå¯¹åº”åœ°å¢åŠ ï¼ŒD-Wåœ¨å¯¹è§’çº¿ä¸Šè¿˜æ˜¯ä¸€æ ·çš„æ•°ï¼Œä¸ä¼šå˜ï¼‰&lt;/p&gt;
&lt;p&gt;éå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡å¯ä»¥ç”¨äºæè¿°å›¾çš„å¾ˆå¤šæ€§è´¨ï¼Œå‚è§ Mohar(1991, 1997)ã€‚å¯¹äºè°±èšç±»æ¥è¯´ä¸€ä¸ªé‡è¦çš„æ€§è´¨æ˜¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Proposition 2 (Number of connected components and the spectrum of $L$)&lt;/strong&gt; å›¾ $G$ æ˜¯æ— å‘éè´Ÿæƒé‡çš„å›¾ã€‚æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å€¼ $0$ çš„å¤šé‡æ€§ $k$ ç­‰äºå›¾ä¸­çš„è¿é€šåˆ†é‡ $A_1, \dots, A_k$ çš„æ•°é‡ã€‚ç‰¹å¾å€¼ $0$ çš„ç‰¹å¾ç©ºé—´é€šè¿‡æŒ‡ç¤ºå‘é‡ $1_{A_1}, \dots, 1_{A_k}$ ç”Ÿæˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Proof.&lt;/em&gt; æˆ‘ä»¬å…ˆä»¥ $k = 1$ ä¸ºä¾‹ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰ä¸€ä¸ªè¿é€šå›¾ã€‚å‡è®¾ $f$ æ˜¯ç‰¹å¾å€¼ $0$ å¯¹åº”çš„ç‰¹å¾å‘é‡ã€‚æˆ‘ä»¬çŸ¥é“ï¼š&lt;/p&gt;
$$
0 = f'Lf = \sum^n\_{i,j=1} w\_{ij} (f\_i - f\_j)^2.
$$&lt;p&gt;å› ä¸ºæƒé‡ $w_{ij}$ æ˜¯éè´Ÿçš„ï¼Œå¦‚æœæ‰€æœ‰çš„é¡¹ $w_{ij} (f_i - f_j)^2$ éƒ½æ¶ˆå¤±äº†ï¼Œè¿™ä¸ªå’Œå°±ä¼šå¾ˆå°ã€‚å› æ­¤ï¼Œå¦‚æœä¸¤ä¸ªé¡¶ç‚¹ç›¸è¿ï¼ˆæƒé‡å¤§äº0ï¼‰ï¼Œé‚£ä¹ˆ $f_i$ éœ€è¦ç­‰äº $f_j$ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¯¹äºæ‰€æœ‰é¡¶ç‚¹ $f$ éœ€è¦æ˜¯ä¸€ä¸ªç›¸åŒçš„å¸¸æ•°ï¼Œä¸”è¿™äº›ç‚¹å¯ä»¥é€šè¿‡ä¸€æ¡è·¯å¾„ç›¸è¿ã€‚æ­¤å¤–ï¼Œå› ä¸ºæ— å‘å›¾å†…è¿é€šåˆ†é‡æ‰€æœ‰çš„é¡¶ç‚¹å¯ä»¥é€šè¿‡ä¸€æ¡è·¯å¾„ç›¸è¿ï¼Œ$f$ å¯¹äºæ•´ä¸ªè¿é€šåˆ†é‡æ¥è¯´éœ€è¦æ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚åœ¨åªæœ‰ä¸€ä¸ªè¿é€šåˆ†é‡çš„å›¾ä¸­ï¼Œæˆ‘ä»¬å› æ­¤åªæœ‰ä¸€ä¸ªå¸¸å‘é‡ $1$ ä½œä¸ºç‰¹å¾å‘é‡ï¼Œå¯¹åº”çš„ç‰¹å¾å€¼ä¸º $0$ï¼Œæ˜¾ç„¶è¿™ä¸ªå‘é‡å°±æ˜¯è¿™ä¸ªè¿é€šåˆ†é‡çš„æŒ‡ç¤ºå‘é‡ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨è€ƒè™‘ $k$ ä¸ªè¿é€šåˆ†é‡ã€‚ä¸ºäº†ä¸å¤±ä¸€èˆ¬æ€§ï¼Œæˆ‘ä»¬å‡è®¾é¡¶ç‚¹æ˜¯æ ¹æ®è¿é€šåˆ†é‡æ’åºçš„ã€‚è¿™æ ·ï¼Œé‚»æ¥çŸ©é˜µ $W$ æœ‰ä¸€ä¸ªå—å¯¹è§’å½¢å¼ï¼Œå¯¹äºçŸ©é˜µ $L$ ä¹Ÿæ˜¯å¦‚æ­¤ï¼š&lt;/p&gt;
$$
L = \begin{pmatrix}
L\_1 &amp; &amp; &amp; \\
&amp; L\_2 &amp; &amp; \\
&amp; &amp; \ddots &amp; \\
&amp; &amp; &amp; L\_k
\end{pmatrix}
$$&lt;p&gt;æ³¨æ„ï¼šå— $L_i$ æ˜¯ä¸€ä¸ªå…³äºå®ƒè‡ªå·±çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼Œä¹Ÿå°±æ˜¯å¯¹åº”ç¬¬ $i$ ä¸ªå­å›¾çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µã€‚åœ¨è¿™ä¸ªå¯¹è§’éƒ½æ˜¯å—çŸ©é˜µçš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ $L$ çš„è°±æ˜¯æ‰€æœ‰çš„ $L_i$ çš„è°±çš„å¹¶é›†ï¼Œå¯¹åº”çš„ $L$ çš„ç‰¹å¾å‘é‡æ˜¯ $L_i$ çš„ç‰¹å¾å‘é‡ï¼Œå…¶ä»–æ–¹å—çš„ä½ç½®éƒ½æ˜¯0.å› ä¸ºæ¯ä¸ª $L_i$ æ˜¯ä¸€ä¸ªè¿é€šå›¾çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼Œæˆ‘ä»¬çŸ¥é“æ¯ä¸ª $L_i$ åœ¨ç¬¬ $i$ ä¸ªè¿é€šåˆ†é‡ä¸Šï¼Œæœ‰ç‰¹å¾å€¼ $0$ï¼Œä¸”å¤šé‡æ€§ä¸º $1$ï¼Œå¯¹åº”çš„ç‰¹å¾å‘é‡å¸¸å‘é‡ã€‚å› æ­¤ï¼ŒçŸ©é˜µ $L$ çš„ç‰¹å¾å€¼ $0$ çš„ä¸ªæ•°å°±ç­‰äºè¿é€šåˆ†é‡æ•°ï¼Œè€Œä¸”å¯¹åº”çš„ç‰¹å¾å‘é‡æ˜¯è¿é€šåˆ†é‡çš„æŒ‡ç¤ºå‘é‡ã€‚&lt;/p&gt;
&lt;h2 id="32-the-normalized-graph-laplacians"&gt;3.2 The normalized graph Laplacians
&lt;/h2&gt;&lt;p&gt;åœ¨æ–‡çŒ®ä¸­æœ‰ä¸¤ä¸ªå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µã€‚ä¸¤ä¸ªçŸ©é˜µç´§å¯†ç›¸è¿ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
$$
\begin{aligned}
&amp; L\_{sym} := D^{-1/2} L D^{-1/2} = I - D^{-1/2} W D^{-1/2}\\
&amp; L\_{rw} := D^{-1} L = I - D^{-1} W.
\end{aligned}
$$&lt;p&gt;æˆ‘ä»¬å°†ç¬¬ä¸€ä¸ªçŸ©é˜µè¡¨ç¤ºä¸º $L_{sym}$ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå¯¹ç§°é˜µï¼Œç¬¬äºŒä¸ªçŸ©é˜µè¡¨ç¤ºä¸º $L_{rw}$ï¼Œå› ä¸ºå®ƒå’Œéšæœºæ¸¸èµ°æœ‰å…³ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹è¿™ä¸¤ä¸ªçŸ©é˜µçš„æ€§è´¨ã€‚å…³äºå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„å¼•ç”¨åœ¨ Chung (1997)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Proposition 3 (Properties of $L_{sym}$ and $L_{rw}$)&lt;/strong&gt; å½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µæ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯¹äºæ¯ä¸ª $f \in \mathbb{R}^n$ï¼Œæˆ‘ä»¬æœ‰ï¼š&lt;/li&gt;
&lt;/ol&gt;
$$
f' L\_{sym} f = \frac{1}{2} \sum^n\_{i,j=1} w\_{ij} \Bigg( \frac{f\_i}{\sqrt{d\_i}} - \frac{f\_j}{\sqrt{d\_j}} \Bigg)^2.
$$&lt;ol start="2"&gt;
&lt;li&gt;$\lambda$ æ˜¯ $L_{rw}$ çš„ä¸€ä¸ªç‰¹å¾å€¼ï¼Œå¯¹åº”çš„ç‰¹å¾å‘é‡ $u$ï¼Œå½“ä¸”ä»…å½“ $\lambda$ æ˜¯ $L_{sym}$ çš„ä¸€ä¸ªç‰¹å¾å€¼ä¸”å¯¹åº”çš„ç‰¹å¾å‘é‡ $w = D^{1/2}u$ã€‚&lt;/li&gt;
&lt;li&gt;$\lambda$ æ˜¯ $L_{rw}$ çš„ä¸€ä¸ªç‰¹å¾å€¼ï¼Œå¯¹åº”çš„ç‰¹å¾å‘é‡ $u$ï¼Œå½“ä¸”ä»…å½“ $\lambda$ å’Œ $u$ æ˜¯ generalized eigenproblem $Lu = \lambda Du$ çš„è§£ã€‚&lt;/li&gt;
&lt;li&gt;$0$ æ˜¯ $L_{rw}$ çš„ç‰¹å¾å€¼ï¼Œå¸¸å‘é‡ $1$ æ˜¯ç‰¹å¾å‘é‡ã€‚$0$ æ˜¯ $L_{sym}$ çš„ç‰¹å¾å€¼ä¸”ç‰¹å¾å‘é‡æ˜¯ $D^{1/2}1$ã€‚&lt;/li&gt;
&lt;li&gt;$L_{sym}$ å’Œ $L_{rw}$ æ˜¯åŠæ­£å®šçš„ï¼Œæœ‰ $n$ ä¸ªéè´Ÿçš„å®æ•°ç‰¹å¾å€¼ $0 = \lambda_1 \leq \dots \leq \lambda_n$ã€‚&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>Layer Normalization</title><link>https://davidham3.github.io/blog/p/layer-normalization/</link><pubDate>Mon, 03 Dec 2018 15:17:12 +0000</pubDate><guid>https://davidham3.github.io/blog/p/layer-normalization/</guid><description>&lt;p&gt;Layer Normalizationï¼Œä¹‹å‰çœ‹åˆ°ä¸€ç¯‡è®ºæ–‡ç”¨äº†è¿™ä¸ªLNå±‚ï¼Œçœ‹ä¸€ä¸‹è¿™ä¸ªæ€ä¹ˆå®ç°ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1607.06450.pdf" target="_blank" rel="noopener"
&gt;Layer Normalization&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;è®­ç»ƒç¥ç»ç½‘ç»œå¾ˆè´¹æ—¶ï¼Œä¸€ä¸ªå‡å°‘è®­ç»ƒæ—¶é—´çš„æ–¹æ³•æ˜¯å¯¹ç¥ç»å…ƒçš„æ¿€æ´»å€¼å½’ä¸€åŒ–ã€‚æœ€è¿‘çš„ä¸€é¡¹æŠ€æœ¯ç§°ä¸ºå°æ‰¹é‡å½’ä¸€åŒ–ï¼Œä¹Ÿå°±æ˜¯ batch normï¼Œä½¿ç”¨ä¸€ä¸ªç¥ç»å…ƒçš„è¾“å…¥çš„åˆ†å¸ƒï¼Œåœ¨ä¸€ä¸ªæ‰¹é‡çš„æ ·æœ¬ä¸Šè®¡ç®—å‡å€¼å’Œæ–¹å·®ï¼Œç„¶ååœ¨ç¥ç»å…ƒçš„æ¯ä¸ªè®­ç»ƒæ ·ä¾‹ä¸Šåšå½’ä¸€åŒ–ã€‚è¿™ä¸ªèƒ½æå¤§åœ°ç¼©çŸ­è®­ç»ƒæ—¶é—´ã€‚ä½†æ˜¯ï¼Œbatch norm çš„æ•ˆæœå’Œ batch size æœ‰å…³ï¼Œè€Œä¸”è¿˜ä¸çŸ¥é“æ€ä¹ˆåº”ç”¨åœ¨ RNN ä¸Šã€‚æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªè®­ç»ƒæ ·ä¾‹ï¼Œå°† BN è½¬ç½®ï¼Œè®¡ç®—ä¸€ä¸ªå±‚ä¸Šé¢æ‰€æœ‰ç¥ç»å…ƒçš„è¾“å…¥çš„å‡å€¼å’Œæ–¹å·®æ¥å½’ä¸€åŒ–ã€‚å°±åƒ BN ä¸€æ ·ï¼Œæˆ‘ä»¬åœ¨å½’ä¸€åŒ–åæ¿€æ´»ä¹‹å‰ç»™æ¯ä¸ªç¥ç»å…ƒå®ƒè‡ªå·±çš„å¯é€‚åº”çš„biaså’Œgainã€‚ä¸åƒ BN çš„åœ°æ–¹æ˜¯ï¼ŒLN åœ¨è®­ç»ƒå’Œæµ‹è¯•çš„æ—¶å€™éƒ½æœ‰ï¼Œé€šè¿‡åœ¨æ¯ä¸ªæ—¶é—´æ­¥ä¸Šåšå½’ä¸€åŒ–çš„ç»Ÿè®¡ï¼ŒLN ä¹Ÿèƒ½åº”ç”¨åœ¨ RNN ä¸Šã€‚LN åœ¨ç¨³å®š RNN éšè—çŠ¶æ€çš„åŠ¨æ€æ€§ä¸Šé¢å¾ˆæœ‰æ•ˆã€‚ç»éªŒè¡¨æ˜ï¼ŒLN ä¸ä¹‹å‰çš„æŠ€æœ¯å¯¹æ¯”èƒ½æœ‰æ•ˆåœ°å‡å°‘è®­ç»ƒæ—¶é—´ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 Introduction
&lt;/h1&gt;&lt;p&gt;å¾ˆå¤šæ·±åº¦ç¥ç»ç½‘ç»œè¦è®­ç»ƒå¥½å¤šå¤©ã€‚BN é™¤äº†æå‡äº†æ”¶æ•›é€Ÿåº¦ï¼Œä»æ‰¹é‡ç»Ÿè®¡é‡å¾—åˆ°çš„éšæœºæ€§åœ¨è®­ç»ƒçš„æ—¶å€™è¿˜ä¼šä½œä¸ºä¸€ä¸ªæ­£åˆ™é¡¹ã€‚&lt;/p&gt;
&lt;p&gt;å°½ç®¡ BN ç®€å•ï¼Œä½†æ˜¯å®ƒéœ€è¦è¾“å…¥ç»Ÿè®¡é‡ä¹‹å’Œçš„å¹³å‡å€¼ã€‚åœ¨å®šé•¿çš„ FNN ä¸­ï¼ŒæŠŠæ¯ä¸ªå±‚çš„ BN å­˜èµ·æ¥å°±è¡Œã€‚ä½†æ˜¯ï¼ŒRNN çš„å¾ªç¯å•å…ƒçš„è¾“å…¥é€šå¸¸éšåºåˆ—é•¿åº¦è€Œå˜åŒ–ï¼Œæ‰€ä»¥å°† BN åº”ç”¨åœ¨ RNN ä¸Šé¢ï¼Œä¸åŒæ—¶é—´æ­¥éœ€è¦ä¸åŒçš„ç»Ÿè®¡é‡ã€‚æ­¤å¤–ï¼ŒBN ä¸èƒ½åº”ç”¨åœ¨åœ¨çº¿å­¦ä¹ ç­‰ä»»åŠ¡ä¸Šï¼Œæˆ–æ˜¯éå¸¸å¤§çš„åˆ†å¸ƒå¼æ¨¡å‹ä¸Šï¼Œå› ä¸º minibatch ä¼šå¾ˆå°ã€‚&lt;/p&gt;
&lt;h1 id="2-background"&gt;2 Background
&lt;/h1&gt;&lt;p&gt;å‰å‘ç¥ç»ç½‘ç»œæ˜¯ä»è¾“å…¥æ¨¡å¼ $\rm{x}$ æ˜ å°„åˆ°è¾“å‡ºå‘é‡ $y$ çš„éçº¿æ€§å˜æ¢ã€‚åœ¨æ·±åº¦å‰å‘ç¥ç»ç½‘ç»œä¸­çš„ç¬¬ $l$ ä¸ªéšè—å±‚ï¼Œ$a^l$ è¡¨ç¤ºè¿™å±‚ç¥ç»å…ƒçš„è¾“å…¥ã€‚æ±‡æ€»åçš„è¾“å…¥é€šè¿‡ä¸€ä¸ªçº¿æ€§æ˜ å°„è®¡ç®—å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{1}
a^l\_i = {w^l\_i}^\text{T} h^l\\
h^{l+1}\_i = f(a^l\_i + b^l\_i)
$$&lt;p&gt;å…¶ä¸­ $f(\cdot)$ æ˜¯æ¿€æ´»å‡½æ•°ï¼Œ$w^l_i$ å’Œ $b^l_i$ åˆ†åˆ«æ˜¯ç¬¬ $l$ ä¸ªéšè—å±‚çš„æƒé‡å’Œåç½®å‚æ•°ã€‚å‚æ•°é€šè¿‡åŸºäºæ¢¯åº¦çš„å­¦ä¹ æ–¹æ³•å¾—åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;æ·±åº¦å­¦ä¹ çš„ä¸€ä¸ªæŒ‘æˆ˜æ˜¯ï¼šæŸä¸€å±‚æƒé‡çš„æ¢¯åº¦å’Œä¸Šä¸€å±‚çš„è¾“å‡ºé«˜åº¦ç›¸å…³ï¼Œå°¤å…¶æ˜¯å½“è¿™äº›è¾“å‡ºä»¥ä¸€ç§é«˜åº¦ç›¸å…³çš„æ–¹å¼å˜åŒ–çš„æ—¶å€™ã€‚BN æå‡ºæ¥æ˜¯å‡å°‘è¿™ç§ä¸å¸Œæœ›çš„ covariate shift ç°è±¡ã€‚è¿™ç§æ–¹æ³•åœ¨è¾“å…¥æ ·ä¾‹åœ¨æ¯ä¸ªéšè—å•å…ƒçš„è¾“å…¥ä¸Šåšè®¡ç®—ã€‚è¯¦ç»†æ¥è¯´ï¼Œå¯¹äºç¬¬ $l$ å±‚çš„ç¬¬ $i$ ä¸ªè¾“å…¥ï¼ŒBN æ ¹æ®ä»–ä»¬åœ¨æ•°æ®ä¸­çš„åˆ†å¸ƒï¼Œå°†è¾“å…¥ç¼©æ”¾äº†ï¼š&lt;/p&gt;
$$\tag{2}
\bar{a}^l\_i = \frac{g^l\_i}{\sigma^l\_i}(a^l\_i - \mu^l\_i)\\
\mu^l\_i = \mathbb{E}\_{\mathrm{x} \sim P(\mathrm{x})}[a^l\_i]\\
\sigma^l\_i = \sqrt{\mathbb{E}\_{\mathrm{x} \sim P(\mathrm{x})}[(a^l\_i - \mu^l\_i)^2]}
$$&lt;p&gt;å…¶ä¸­ $\bar{a}^l_i$ æ˜¯ç¬¬ $l$ å±‚ç¬¬ $i$ ä¸ªè¾“å…¥çš„å½’ä¸€åŒ–ç»“æœï¼Œ$g_i$ æ˜¯åœ¨éçº¿æ€§æ¿€æ´»å‡½æ•°ä¹‹å‰çš„ä¸€ä¸ªå¢ç›Šå‚æ•°ï¼Œå¯¹å½’ä¸€åŒ–æ¿€æ´»å€¼è¿›è¡Œç¼©æ”¾ã€‚æ³¨æ„ï¼ŒæœŸæœ›æ˜¯åœ¨æ‰€æœ‰è®­ç»ƒæ•°æ®ä¸Šçš„ã€‚äº‹å®ä¸Šè®¡ç®—å¼2ä¸­çš„æœŸæœ›æ˜¯ä¸å®é™…çš„ï¼Œå› ä¸ºè¿™éœ€è¦ç”¨å½“å‰çš„å‚æ•°ï¼Œå‰å‘ä¼ æ’­è¿‡æ‰€æœ‰çš„è®­ç»ƒé›†ã€‚å®é™…ä¸­æ˜¯ç”¨å½“å‰çš„ mini-batch æ¥ä¼°è®¡ $\mu$ å’Œ $\sigma$ã€‚è¿™å°±ç»™ batch size å¢åŠ äº†é™åˆ¶ï¼Œè€Œä¸”å¾ˆéš¾åº”ç”¨åˆ° RNN ä¸Šã€‚&lt;/p&gt;
&lt;h1 id="3-layer-normalization"&gt;3 Layer normalization
&lt;/h1&gt;&lt;p&gt;å±‚å½’ä¸€åŒ–ç”¨æ¥å…‹æœæ‰¹é‡å½’ä¸€åŒ–çš„ä¸€äº›ç¼ºç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªå±‚è¾“å‡ºçš„å˜æ¢å€¾å‘äºå¯¼è‡´ä¸‹ä¸€å±‚çš„è¾“å…¥ä¹‹é—´æœ‰ç€å…³è”åº¦å¾ˆé«˜çš„å˜åŒ–ï¼Œå°¤å…¶æ˜¯ä½¿ç”¨ ReLU æ¿€æ´»åï¼Œè¿™äº›è¾“å‡ºçš„å˜åŒ–å¾ˆå¤šã€‚è¿™è¡¨æ˜ covariate shift é—®é¢˜å¯ä»¥é€šè¿‡å›ºå®šæ¯å±‚çš„è¾“å…¥çš„å‡å€¼å’Œæ–¹å·®è§£å†³ã€‚å› æ­¤ï¼Œåœ¨åŒä¸€å±‚ä¸­æ‰€æœ‰éšè—å•å…ƒçš„å±‚å½’ä¸€åŒ–ç»Ÿè®¡é‡å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{3}
\mu^l = \frac{1}{H} \sum^H\_{i = 1}a^l\_i\\
\sigma^l = \sqrt{\frac{1}{H} \sum^H\_{i=1} (a^l\_i - \mu^l)^2}
$$&lt;p&gt;å…¶ä¸­ $H$ è¡¨ç¤ºå±‚å†…çš„éšè—å•å…ƒæ•°ã€‚å¼2å’Œå¼3çš„åŒºåˆ«æ˜¯åœ¨å±‚å½’ä¸€åŒ–ä¹‹ä¸‹ï¼Œå±‚å†…æ‰€æœ‰éšè—å•å…ƒå…±äº«ç›¸åŒçš„å½’ä¸€åŒ–é¡¹ $\mu$ å’Œ $\sigma$ï¼Œä½†æ˜¯ä¸åŒçš„æ ·æœ¬æœ‰ç€ä¸åŒçš„å½’ä¸€åŒ–é¡¹ã€‚ä¸åƒ BNï¼Œå±‚å½’ä¸€åŒ–ä¸ä¼šæœ‰ batch size çš„é™åˆ¶ï¼Œè€Œä¸”å¯ä»¥ä½¿ç”¨åœ¨ batch size è®¾ä¸º1çš„æ—¶å€™çš„åœ¨çº¿å­¦ä¹ ä¸Šã€‚&lt;/p&gt;
&lt;h2 id="31-layer-normalized-recurrent-neural-networks"&gt;3.1 Layer normalized recurrent neural networks
&lt;/h2&gt;&lt;p&gt;æœ€è¿‘çš„åºåˆ—åˆ°åºåˆ—æ¨¡å‹ [Sutskever et al., 2014] åˆ©ç”¨äº†ç´§è‡´çš„ RNN æ¥è§£å†³ NLP ä¸­çš„åºåˆ—é¢„æµ‹é—®é¢˜ã€‚åœ¨ NLP ä»»åŠ¡ä¸­ä¸åŒçš„è®­ç»ƒæ ·ä¾‹é•¿åº¦ä¸ä¸€è‡´æ˜¯å¾ˆå¸¸è§çš„ã€‚RNN åœ¨æ¯ä¸ªæ—¶é—´æ­¥ä½¿ç”¨çš„å‚æ•°éƒ½æ˜¯ç›¸åŒçš„ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨ BN æ¥å¤„ç† RNN æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—å¹¶å­˜å‚¨åºåˆ—ä¸­æ¯ä¸ªæ—¶é—´æ­¥çš„ç»Ÿè®¡é‡ã€‚å¦‚æœä¸€ä¸ªæµ‹è¯•çš„åºåˆ—æ¯”ä»»ä½•è®­ç»ƒçš„åºåˆ—éƒ½é•¿ï¼Œé‚£å°±ä¼šå‡ºé—®é¢˜äº†ã€‚å±‚å½’ä¸€åŒ–ä¸ä¼šæœ‰è¿™æ ·çš„é—®é¢˜ï¼Œå› ä¸ºå®ƒçš„å½’ä¸€åŒ–é¡¹åªä¾èµ–äºå½“å‰æ—¶é—´æ­¥å±‚çš„è¾“å…¥ã€‚å®ƒåœ¨æ‰€æœ‰çš„æ—¶é—´æ­¥ä¸Šä¹Ÿæœ‰ä¸€ç»„å…±äº«çš„ gain å’Œ bias å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ ‡å‡†çš„ RNN ä¸­ï¼Œå¾ªç¯å±‚çš„è¾“å…¥é€šè¿‡å½“å‰çš„è¾“å…¥ $\mathrm{x}^t$ å’Œå‰ä¸€å±‚çš„éšè—çŠ¶æ€ $\mathrm{h}^{t-1}$ï¼Œå¾—åˆ° $\mathrm{a}^t = W_{hh}h^{t-1} + W_{xh} \mathrm{x}^t$ã€‚å±‚å½’ä¸€åŒ–åçš„å¾ªç¯å±‚ä¼šå°†å®ƒçš„æ¿€æ´»å€¼ä½¿ç”¨åƒå¼3ä¸€æ ·çš„å½’ä¸€åŒ–é¡¹ç¼©æ”¾åˆ°ï¼š&lt;/p&gt;
$$\tag{4}
\mathrm{h}^t = f[\frac{\mathrm{g}}{\sigma^t} \odot (\mathrm{a}^t - \mu^t) + b]\\
\mu^t = \frac{1}{H} \sum^H\_{i=1}a^t\_i\\
\sigma^t = \sqrt{\frac{1}{H} \sum^H\_{i=1}(a^t\_i - \mu^t)^2}
$$&lt;p&gt;å…¶ä¸­ $W_{hh}$ æ˜¯å¾ªç¯éšè—åˆ°éšè—çš„æƒé‡ï¼Œ$W_{xh}$ æ˜¯è¾“å…¥åˆ°éšè—çš„æƒé‡ï¼Œ$\odot$ æ˜¯element-wise multiplicationã€‚$\rm b$ å’Œ $\rm g$æ˜¯å’Œ $\mathrm{h}^t$ åŒç»´åº¦çš„ bias å’Œ gain å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ ‡å‡†çš„ RNN ä¸­ï¼Œæ¯ä¸ªæ—¶é—´æ­¥çš„å¾ªç¯å•å…ƒçš„è¾“å…¥çš„æ•°é‡çº§å€¾å‘äºå¢å¤§æˆ–å‡å°ï¼Œå¯¼è‡´æ¢¯åº¦çš„çˆ†ç‚¸æˆ–æ¶ˆå¤±é—®é¢˜ã€‚åœ¨ä¸€ä¸ªå±‚å½’ä¸€åŒ–çš„ RNN é‡Œï¼Œå½’ä¸€åŒ–é¡¹ä½¿å®ƒå¯¹ä¸€ä¸ªå±‚çš„è¾“å…¥çš„ç¼©æ”¾ä¸å‘ç”Ÿå˜åŒ–ï¼Œä½¿å¾—éšè—åˆ°éšè—åŠ¨æ€æ€§æ›´ç¨³å®šã€‚&lt;/p&gt;</description></item><item><title>Deeper Insights into Graph Convolutional Networks for Semi-Supervised Learning</title><link>https://davidham3.github.io/blog/p/deeper-insights-into-graph-convolutional-networks-for-semi-supervised-learning/</link><pubDate>Wed, 31 Oct 2018 21:58:41 +0000</pubDate><guid>https://davidham3.github.io/blog/p/deeper-insights-into-graph-convolutional-networks-for-semi-supervised-learning/</guid><description>&lt;p&gt;AAAI 2018ã€‚è¿™ç¯‡è®ºæ–‡å¾ˆæœ‰è¶£ï¼Œè®²çš„æ˜¯ GCN å †å¾—è¿‡å¤šäº†ä¹‹åï¼Œæ•ˆæœä¼šå˜å·®çš„é—®é¢˜ã€‚ä½œè€…åˆ†æäº†ä¸€ä¸‹ä¸ºä»€ä¹ˆä¼šå˜å·®ï¼Œä¸»è¦æ˜¯å› ä¸º GCN çš„æœ¬è´¨å®é™…ä¸Šæ˜¯å¯¹æ¯ä¸ªç»“ç‚¹çš„é‚»å±…ç‰¹å¾å’Œè‡ªèº«ç‰¹å¾åšçº¿æ€§ç»„åˆï¼Œæƒé‡å’Œé‚»æ¥çŸ©é˜µç›¸å…³ï¼Œæ‰€ä»¥å¯¹äºé¡¶ç‚¹åˆ†ç±»é—®é¢˜æ¥è¯´ï¼Œå¦‚æœå †å¾—å±‚æ•°å¤šäº†ï¼Œå°±ä¼šè®©ä¸€ä¸ªç»“ç‚¹çš„ç‰¹å¾èšåˆè¶Šæ¥è¶Šå¤šé‚»å±…çš„ç‰¹å¾ï¼Œè®©å¤§å®¶éƒ½å˜å¾—ç›¸ä¼¼ï¼Œä»è€Œä½¿å¾—ç±»é—´çš„ç›¸ä¼¼åº¦å¢å¤§ï¼Œè‡ªç„¶åˆ†ç±»æ•ˆæœå°±å·®äº†ã€‚ä½œè€…æå‡ºäº†ä¸¤ä¸ªæ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç®—è®­ç»ƒä¸Šçš„ trick å§ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1801.07606" target="_blank" rel="noopener"
&gt;Deeper Insights into Graph Convolutional Networks for Semi-Supervised Learning&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;æœºå™¨å­¦ä¹ ä¸­å¾ˆå¤šæœ‰è¶£çš„é—®é¢˜æ­£åœ¨ç”¨æ·±åº¦å­¦ä¹ å·¥å…·æ¥é‡æ–°å®¡è§†ã€‚å¯¹äºåŸºäºå›¾çš„åŠç›‘ç£å­¦ä¹ é—®é¢˜ï¼Œæœ€æ–°çš„ä¸€ä¸ªé‡è¦è¿›å±•å°±æ˜¯å›¾å·ç§¯ç¥ç»ç½‘ç»œ (GCNs)ï¼Œè¿™ä¸ªæ¨¡å‹å¯ä»¥å¾ˆå¥½çš„å°†é¡¶ç‚¹å±€éƒ¨ç‰¹å¾å’Œå›¾çš„æ‹“æ‰‘ç»“æ„æ•´åˆè¿›å·ç§¯å±‚å†…ã€‚å°½ç®¡ GCN æ¨¡å‹å’Œå…¶ä»–çš„ state-of-the-art æ–¹æ³•ç›¸æ¯”æ•ˆæœæ›´å¥½ï¼Œä½†æ˜¯å®ƒçš„æœºç†ç›®å‰è¿˜ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œè€Œä¸”éœ€è¦å¾ˆå¤šçš„æ ‡è®°æ•°æ®ç”¨äºéªŒè¯ä»¥åŠæ¨¡å‹é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œæˆ‘ä»¬æ·±å…¥äº† GCN æ¨¡å‹ï¼Œè§£å†³äº†å®ƒçš„åº•å±‚é™åˆ¶ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å‘ç° GCN æ¨¡å‹çš„å›¾å·ç§¯å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ‹‰æ™®æ‹‰æ–¯å¹³æ»‘çš„ç‰¹æ®Šå½¢å¼ï¼Œè¿™æ˜¯ GCN å·¥ä½œçš„å…³é”®åŸå› ï¼Œä½†æ˜¯è¿™ä¹Ÿä¼šç»™å¾ˆå¤šå·ç§¯å±‚å¸¦æ¥æ½œåœ¨çš„å±å®³ã€‚å…¶æ¬¡ï¼Œä¸ºäº†å…‹æœ GCN å±‚æ•°å°‘çš„é™åˆ¶ï¼Œæˆ‘ä»¬æå‡ºäº†ååŒè®­ç»ƒå’Œè‡ªè®­ç»ƒæ–¹æ³•æ¥è®­ç»ƒ GCNsã€‚æˆ‘ä»¬çš„æ–¹æ³•æ˜¾è‘—åœ°æå‡äº† GCNs åœ¨æ ‡è®°æ ·æœ¬å°‘çš„æƒ…å†µä¸‹çš„å­¦ä¹ ï¼Œå¹¶ä¸”è®©ä»–ä»¬é¿å…äº†ä½¿ç”¨é¢å¤–çš„æ ‡è®°ç”¨æ¥éªŒè¯ã€‚å¤§é‡çš„å®éªŒè¯æ˜äº†æˆ‘ä»¬çš„ç†è®ºå’Œæ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 Introduction
&lt;/h1&gt;&lt;p&gt;æ·±åº¦å­¦ä¹ ä¸­çš„çªç ´ä½¿å¾—äººå·¥æ™ºèƒ½å’Œæœºå™¨å­¦ä¹ ä¸­æ­£åœ¨å‘ç”ŸèŒƒå¼å˜åŒ–ã€‚ä¸€æ–¹é¢ï¼Œå¾ˆå¤šè€é—®é¢˜é€šè¿‡æ·±åº¦ç¥ç»ç½‘ç»œé‡æ–°å®¡è§†ï¼Œå¾ˆå¤šåŸæ¥çœ‹èµ·æ¥åœ¨ä»»åŠ¡ä¸­æ— æ³•å®Œæˆçš„å·¨å¤§è¿›æ­¥ç°åœ¨ä¹Ÿåœ¨å‘ç”Ÿç€ï¼Œå¦‚æœºå™¨ç¿»è¯‘å’Œè®¡ç®—æœºè§†è§‰ã€‚å¦ä¸€æ–¹é¢ï¼Œåƒå‡ ä½•æ·±åº¦å­¦ä¹  (Bronstein et al. 2017) è¿™æ ·çš„æŠ€æœ¯æ­£åœ¨å‘å±•ï¼Œå¯èƒ½ä¼šå°†æ·±åº¦ç¥ç»æ¨¡å‹æ³›åŒ–åˆ°æ–°çš„æˆ–éä¼ ç»Ÿçš„é¢†åŸŸã€‚&lt;/p&gt;
&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ï¼Œæ·±åº¦å­¦ä¹ æ¨¡å‹ä¸€èˆ¬éœ€è¦å¤§é‡çš„æ ‡è®°æ•°æ®ï¼Œåœ¨å¾ˆå¤šæ ‡è®°è®­ç»ƒæ•°æ®ä»£ä»·å¾ˆå¤§çš„åœºæ™¯å°±æ— æ³•æ»¡è¶³è¿™æ ·çš„è¦æ±‚ã€‚ä¸ºäº†å‡å°‘ç”¨äºè®­ç»ƒçš„æ•°æ®çš„æ•°é‡ï¼Œæœ€è¿‘çš„ç ”ç©¶å¼€å§‹å…³æ³¨ few-shot learning (Lake, Salakhutdinov, and Tenenbaum 2015; Rezende et al. 2016)â€”â€”ä»æ¯ä¸ªç±»åªæœ‰å¾ˆå°‘çš„æ ·æœ¬ä¸­å­¦ä¹ ä¸€ä¸ªåˆ†ç±»æ¨¡å‹ã€‚å’Œ few-shot learning ç›¸è¿‘çš„æ˜¯åŠç›‘ç£å­¦ä¹ ï¼Œå…¶ä¸­æœ‰å¤§é‡çš„æœªæ ‡è®°æ ·æœ¬å¯ä»¥ç”¨æ¥å’Œå¾ˆå°‘é‡çš„æ ‡è®°æ ·æœ¬ä¸€èµ·ç”¨äºè®­ç»ƒã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆå¤šç ”ç©¶è€…å·²ç»è¯å®äº†å¦‚æœä½¿ç”¨æ°å½“ï¼Œåœ¨è®­ç»ƒä¸­åˆ©ç”¨æœªæ ‡è®°æ ·æœ¬å¯ä»¥æ˜¾è‘—åœ°æå‡å­¦ä¹ çš„ç²¾åº¦ (Zhu and Goldberg 2009)ã€‚å…³é”®é—®é¢˜æ˜¯æœ€å¤§åŒ–æœªæ ‡è®°æ ·æœ¬çš„ç»“æ„å’Œç‰¹å¾ä¿¡æ¯çš„æœ‰æ•ˆåˆ©ç”¨ã€‚ç”±äºå¼ºåŠ›çš„ç‰¹å¾æŠ½å–èƒ½åŠ›å’Œæ·±åº¦å­¦ä¹ è¿‘äº›å¹´çš„æˆåŠŸæ¡ˆä¾‹ï¼Œå·²ç»æœ‰å¾ˆå¤šäººä½¿ç”¨åŸºäºç¥ç»ç½‘ç»œçš„æ–¹æ³•å¤„ç†åŠç›‘ç£å­¦ä¹ ï¼ŒåŒ…æ‹¬ ladder network (Rasmus et al. 2015), åŠç›‘ç£åµŒå…¥ (Weston et al. 2008)ï¼Œplanetoid (Yang, Cohen, and Salakhutdinov 2016)ï¼Œå›¾å·ç§¯ç½‘ç»œ (Kipf and Welling 2017)ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘å‘å±•çš„å›¾å·ç§¯ç¥ç»ç½‘ç»œ (GCNNs) (Defferrard, Bresson, and Vandergheynst 2016) æ˜¯ä¸€ä¸ªå°†æ¬§æ°ç©ºé—´ä¸­ä½¿ç”¨çš„å·ç§¯ç¥ç»ç½‘ç»œ (CNNs) æ³›åŒ–åˆ°å¯¹å›¾ç»“æ„æ•°æ®å»ºæ¨¡çš„æˆåŠŸå°è¯•ã€‚åœ¨ä»–ä»¬çš„åˆæœŸå·¥ä½œ (Kipf and Welling 2017)ï¼ŒKifp and Welling æå‡ºäº†ä¸€ä¸ª GCNNs çš„ç®€åŒ–ç±»å‹ï¼Œç§°ä¸ºå›¾å·ç§¯ç½‘ç»œ (GCNs)ï¼Œåº”ç”¨äºåŠç›‘ç£åˆ†ç±»ã€‚GCN æ¨¡å‹å¾ˆè‡ªç„¶åœ°å°†å›¾ç»“æ„æ•°æ®çš„è¿æ¥æ¨¡å¼å’Œç‰¹å¾å±æ€§é›†æˆèµ·æ¥ï¼Œè€Œä¸”æ¯”å¾ˆå¤š state-of-the-art æ–¹æ³•åœ¨ benchmarks ä¸Šå¥½å¾ˆå¤šã€‚å°½ç®¡å¦‚æ­¤ï¼Œå®ƒä¹Ÿæœ‰å¾ˆå¤šå…¶ä»–åŸºäºç¥ç»ç½‘ç»œçš„æ¨¡å‹é‡åˆ°çš„é—®é¢˜ã€‚ç”¨äºåŠç›‘ç£å­¦ä¹ çš„ GCN æ¨¡å‹çš„å·¥ä½œæœºç†è¿˜ä¸æ¸…æ¥šï¼Œè€Œä¸”è®­ç»ƒ GCNs ä»ç„¶éœ€è¦å¤§é‡çš„æ ‡è®°æ ·æœ¬ç”¨äºè°ƒå‚å’Œæ¨¡å‹é€‰æ‹©ï¼Œè¿™å°±å’ŒåŠç›‘ç£å­¦ä¹ çš„ç†å¿µç›¸è¿èƒŒã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œæˆ‘ä»¬å¼„æ¸…æ¥šäº†ç”¨äºåŠç›‘ç£å­¦ä¹ çš„ GCN æ¨¡å‹ã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬å‘ç° GCN æ¨¡å‹ä¸­çš„å›¾å·ç§¯æ˜¯æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œè¿™ä¸ªå¹³æ»‘å¯ä»¥æ··åˆä¸€ä¸ªé¡¶ç‚¹å’Œå®ƒå‘¨å›´é¡¶ç‚¹çš„ç‰¹å¾ã€‚è¿™ä¸ªå¹³æ»‘æ“ä½œä½¿å¾—åŒä¸€ç±»ç°‡å†…é¡¶ç‚¹çš„ç‰¹å¾ç›¸ä¼¼ï¼Œå› æ­¤ä½¿åˆ†ç±»ä»»åŠ¡å˜å¾—ç®€å•ï¼Œè¿™ä½¿ä¸ºä»€ä¹ˆ GCNs è¡¨ç°çš„è¿™ä¹ˆå¥½çš„å…³é”®åŸå› ã€‚ç„¶è€Œï¼Œè¿™ä¹Ÿä¼šå¸¦æ¥ over-smoothing çš„é—®é¢˜ã€‚å¦‚æœ GCN æœ‰å¾ˆå¤šå·ç§¯å±‚åå˜æ·±äº†ï¼Œé‚£ä¹ˆè¾“å‡ºçš„ç‰¹å¾å¯èƒ½ä¼šå˜å¾—è¿‡åº¦å¹³æ»‘ï¼Œä¸”æ¥è‡ªä¸åŒç±»ç°‡çš„é¡¶ç‚¹å¯èƒ½å˜å¾—æ— æ³•åŒºåˆ†ã€‚è¿™ç§æ··åˆåœ¨å°çš„æ•°æ®é›†ï¼Œä¸”åªæœ‰å¾ˆå°‘çš„å·ç§¯å±‚ä¸Šå‘ç”Ÿçš„å¾ˆå¿«ï¼Œå°±åƒå›¾2å±•ç¤ºçš„é‚£æ ·ã€‚è€Œä¸”ï¼Œç»™ GCN æ¨¡å‹å¢åŠ æ›´å¤šçš„å±‚ä¹Ÿä¼šä½¿å®ƒå˜å¾—éš¾ä»¥è®­ç»ƒã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œä¸€ä¸ªæµ…å±‚çš„ GCN æ¨¡å‹ï¼Œåƒ Kipf &amp;amp; Welling 2017 ä½¿ç”¨çš„ä¸¤å±‚ GCN æœ‰å®ƒè‡ªèº«çš„é™åˆ¶ã€‚é™¤æ­¤ä»¥å¤–å®ƒè¿˜éœ€è¦å¾ˆå¤šé¢å¤–çš„æ ‡è®°ç”¨æ¥éªŒè¯ï¼Œå®ƒä¹Ÿä¼šé‡åˆ°å·ç§¯æ ¸å±€éƒ¨æ€§ç­‰é—®é¢˜ã€‚å½“åªæœ‰å°‘æ•°æ ‡è®°çš„æ—¶å€™ï¼Œä¸€ä¸ªæµ…å±‚çš„ GCN æ¨¡å‹ä¸èƒ½æœ‰æ•ˆçš„å°†æ ‡è®°ä¼ æ’­åˆ°æ•´ä¸ªå›¾ä¸Šã€‚å¦‚å›¾1æ‰€ç¤ºï¼ŒGCNs çš„è¡¨ç°ä¼šéšç€è®­ç»ƒé›†çš„å‡å°‘æ€¥é€Ÿä¸‹é™ï¼Œç”šè‡³æœ‰500ä¸ªé¢å¤–æ ‡è®°ç”¨æ¥éªŒè¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å…‹æœé™åˆ¶å¹¶ç†è§£ GCN æ¨¡å‹çš„å…¨éƒ¨æ½œèƒ½ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§ååŒè®­ç»ƒæ–¹æ³•å’Œä¸€ä¸ªè‡ªè®­ç»ƒæ–¹æ³•æ¥è®­ç»ƒ GCNsã€‚é€šè¿‡ä½¿ç”¨éšæœºæ¸¸èµ°æ¨¡å‹æ¥ååŒè®­ç»ƒä¸€ä¸ª GCNï¼Œéšæœºæ¸¸èµ°æ¨¡å‹å¯ä»¥è¡¥å…… GCN æ¨¡å‹åœ¨è·å–æ•´ä¸ªå›¾æ‹“æ‰‘ç»“æ„ä¸Šçš„èƒ½åŠ›ã€‚é€šè¿‡è‡ªè®­ç»ƒä¸€ä¸ª GCNï¼Œæˆ‘ä»¬å¯ä»¥æŒ–æ˜å®ƒçš„ç‰¹å¾æå–èƒ½åŠ›æ¥å…‹æœå®ƒçš„å±€éƒ¨ç‰¹æ€§ã€‚èåˆååŒè®­ç»ƒå’Œè‡ªè®­ç»ƒæ–¹æ³•å¯ä»¥ä»æœ¬è´¨ä¸Šæå‡ GCN æ¨¡å‹åœ¨åŠç›‘ç£å­¦ä¹ ä¸Šåªæœ‰å°‘é‡æ ‡è®°çš„æ•ˆæœï¼Œè€Œä¸”ä½¿å®ƒä¸ç”¨ä½¿ç”¨é¢å¤–çš„æ ‡è®°æ ·æœ¬ç”¨æ¥éªŒè¯ã€‚å¦‚å›¾1æ‰€ç¤ºï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ¯” GCNs å¥½äº†ä¸€å¤§æˆªã€‚&lt;/p&gt;
&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼Œè¿™ç¯‡è®ºæ–‡çš„å…³é”®åˆ›æ–°æœ‰ï¼š1) å¯¹åŠç›‘ç£å­¦ä¹ çš„ GCN æ¨¡å‹æä¾›äº†æ–°çš„è§†è§’å’Œæ–°çš„åˆ†æï¼›2) æå‡ºäº†å¯¹åŠç›‘ç£å­¦ä¹ çš„ GCN æ¨¡å‹æå‡çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h1 id="2-preliminaries-and-related-works"&gt;2 Preliminaries and Related Works
&lt;/h1&gt;&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€äº›ç¬¦å·ã€‚å›¾è¡¨ç¤ºä¸º $\mathcal{G} = (\mathcal{V}, \mathcal{E})$ï¼Œå…¶ä¸­ $\mathcal{V}$ æ˜¯é¡¶ç‚¹é›†ï¼Œ$\vert \mathcal{V} \vert = n$ï¼Œ$\mathcal{E}$ æ˜¯è¾¹é›†ã€‚åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘çš„æ˜¯æ— å‘å›¾ã€‚$A = [a_{ij}] \in \mathbb{R}^{n \times n}$ æ˜¯é‚»æ¥çŸ©é˜µï¼Œä¸”ä¸ºéè´Ÿçš„ã€‚$D = \mathrm{diag}(d_1, d_2, &amp;hellip;, d_n)$ è¡¨ç¤ºåº¦çŸ©é˜µï¼Œ$d_i = \sum_j a_{ij}$ æ˜¯é¡¶ç‚¹ $i$ çš„åº¦ã€‚å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ (Chung 1997) å®šä¹‰ä¸º $L := D - A$ï¼Œå½’ä¸€åŒ–çš„å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ä¸¤ä¸ªç‰ˆæœ¬åˆ†åˆ«å®šä¹‰ä¸ºï¼š$L_{sym} := D^{-\frac{1}{2}} L D^{-\frac{1}{2}}$ å’Œ $L_{rw} := D^{-1}L$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Graph-Based Semi-Supervised Learning&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™ç¯‡è®ºæ–‡ä¸­æˆ‘ä»¬è€ƒè™‘çš„é—®é¢˜æ˜¯å›¾ä¸Šçš„åŠç›‘ç£åˆ†ç±»ä»»åŠ¡ã€‚ç»™å®šä¸€ä¸ªå›¾ $\mathcal{G} = (\mathcal{V}, \mathcal{E}, X)$ï¼Œå…¶ä¸­ $X = \mathrm{[x_1, x_2, &amp;hellip;, x_n]^T} \in R^{n \times c}$ æ˜¯ç‰¹å¾çŸ©é˜µï¼Œ$\mathrm{x}_i \in R^c$ æ˜¯é¡¶ç‚¹ $i$ çš„ $c$ ç»´ç‰¹å¾å‘é‡ã€‚å‡è®¾ç»™å®šäº†ä¸€ç»„é¡¶ç‚¹ $\mathcal{V}_l$ çš„æ ‡è®°ï¼Œç›®æ ‡æ˜¯é¢„æµ‹å…¶ä½™é¡¶ç‚¹ $\mathcal{V}_u$ çš„æ ‡è®°ã€‚&lt;/p&gt;
&lt;p&gt;åŸºäºå›¾çš„åŠç›‘ç£å­¦ä¹ åœ¨è¿‡å»çš„äºŒåå¹´æˆä¸ºäº†ä¸€ä¸ªæµè¡Œçš„ç ”ç©¶é¢†åŸŸã€‚é€šè¿‡æŒ–æ˜å›¾æˆ–æ•°æ®çš„æµå½¢ç»“æ„ï¼Œæ˜¯å¯ä»¥é€šè¿‡å°‘é‡æ ‡è®°è¿›è¡Œå­¦ä¹ çš„ã€‚å¾ˆå¤šåŸºäºå›¾çš„åŠç›‘ç£å­¦ä¹ æ–¹æ³•å½¢æˆäº†ç±»ç°‡å‡è®¾ (cluster assumption) (Chapelle and Zien 2005)ï¼Œå‡è®¾äº†ä¸€ä¸ªå›¾ä¸Šä¸´è¿‘çš„é¡¶ç‚¹å€¾å‘äºæœ‰å…±åŒçš„æ ‡è®°ã€‚é¡ºç€è¿™æ¡è·¯çº¿çš„ç ”ç©¶åŒ…æ‹¬ min-cuts (Blum and Chawla 2001) å’Œ randomized min-cuts (Blum et al. 2004)ï¼Œspectral graph transducer (Joachims 2003)ï¼Œlabel propagation (Zhu, Ghahramani, and Lafferty 2003) and its variants (Zhou et al. 2004; Bengio, Delalleau, and Le Roux 2006)ï¼Œmodified adsorption (Talukdar and Crammer 2009)ï¼Œè¿˜æœ‰ iterative classification algorithm (Sen et al. 2008)ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å›¾åªè¡¨ç¤ºæ•°æ®çš„ç»“æ„ä¿¡æ¯ã€‚åœ¨å¾ˆå¤šåº”ç”¨ï¼Œæ•°æ®çš„æ ·æœ¬æ˜¯ä»¥åŒ…å«ä¿¡æ¯çš„ç‰¹å¾å‘é‡è¡¨ç¤ºï¼Œè€Œä¸æ˜¯åœ¨å›¾ä¸­è¡¨ç°ã€‚æ¯”å¦‚ï¼Œåœ¨å¼•æ–‡ç½‘ç»œä¸­ï¼Œæ–‡æ¡£ä¹‹é—´çš„å¼•ç”¨é“¾æ¥æè¿°äº†å¼•ç”¨å…³ç³»ï¼Œä½†æ˜¯æ–‡æ¡£æ˜¯ç”± bag-of-words å‘é‡è¡¨ç¤ºçš„ï¼Œè¿™äº›å‘é‡æè¿°çš„å†…å®¹æ˜¯æ–‡æ¡£çš„å†…å®¹ã€‚å¾ˆå¤šåŠç›‘ç£å­¦ä¹ æ–¹æ³•å¯»æ±‚å¯¹å›¾ç»“æ„å’Œæ•°æ®çš„ç‰¹å¾å±æ€§å…±åŒå»ºæ¨¡ã€‚ä¸€ä¸ªå¸¸è§çš„æƒ³æ³•æ˜¯ä½¿ç”¨ä¸€äº›æ­£åˆ™é¡¹å¯¹ä¸€ä¸ªç›‘ç£çš„å­¦ä¹ å™¨è¿›è¡Œæ­£åˆ™åŒ–ã€‚æ¯”å¦‚ï¼Œmanifold regularization (LapSVM) (Belkin, Niyogi, and Sindhwani 2006) ä½¿ç”¨ä¸€ä¸ªæ‹‰æ™®æ‹‰æ–¯æ­£åˆ™é¡¹å¯¹ SVM è¿›è¡Œæ­£åˆ™åŒ–ã€‚æ·±åº¦åŠç›‘ç£åµŒå…¥ (Weston et al. 2008) ä½¿ç”¨ä¸€ä¸ªåŸºäºåµŒå…¥çš„æ­£åˆ™é¡¹å¯¹æ·±åº¦ç¥ç»ç½‘ç»œè¿›è¡Œæ­£åˆ™åŒ–ã€‚Planetoid (Yang, Cohen, and Salakhutdinov 2016) ä¹Ÿé€šè¿‡å…±åŒåœ°å¯¹ç±»æ ‡è®°å’Œæ ·æœ¬çš„ä¸Šä¸‹æ–‡é¢„æµ‹å¯¹ç¥ç»ç½‘ç»œè¿›è¡Œæ­£åˆ™åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Graph Convolutional Networks&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å›¾å·ç§¯ç¥ç»ç½‘ç»œ (GCNNs) å°†ä¼ ç»Ÿçš„å·ç§¯ç¥ç»ç½‘ç»œæ³›åŒ–åˆ°å›¾åŸŸä¸­ã€‚ä¸»è¦æœ‰ä¸¤ç±» GCNNs (Bronstein et al. 2017): spatial GCNNs å’Œ spectral GCNNsã€‚ç©ºé—´ GCNNs å°†å·ç§¯çœ‹ä½œæ˜¯ &amp;ldquo;patch operator&amp;rdquo;ï¼Œå¯¹æ¯ä¸ªé¡¶ç‚¹ä½¿ç”¨å®ƒçš„é‚»å±…ä¿¡æ¯æ„å»ºæ–°çš„ç‰¹å¾å‘é‡ã€‚è°± GCNNs é€šè¿‡å¯¹å›¾ä¿¡å· $\bf{s} \in \mathcal{R}^n$ åœ¨è°±åŸŸä¸Šè¿›è¡Œåˆ†è§£ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªåœ¨è°±æˆåˆ†ä¸Šçš„è°±å·ç§¯æ ¸ $g_\theta$ (æ˜¯ $L_{sym}$ çš„ç‰¹å¾å€¼çš„ä¸€ä¸ªå‡½æ•°) (Bruna et al. 2014; Sandryhaila and Moura 2013; Shuman et al. 2013)ã€‚ç„¶è€Œè¿™ä¸ªæ¨¡å‹éœ€è¦è®¡ç®—å‡ºæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å‘é‡ï¼Œè¿™å¯¹äºå¤§å°ºåº¦çš„å›¾æ¥è¯´æ˜¯ä¸å¤ªå®é™…çš„ã€‚ä¸€ç§ç¼“è§£è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•æ˜¯é€šè¿‡å°†è°±å·ç§¯æ ¸ $g_\theta$ é€šè¿‡åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼è¶‹è¿‘åˆ° $K^{th}$ é˜¶ (Hammond, Vandergheynst, and Gribonval 2011)ã€‚åœ¨ (Defferrard, Bresson, and Vandergheynst 2016)ï¼ŒDefferrard et al. ä½¿ç”¨è¿™ä¸ªæ„å»ºäº† $K$ é˜¶ ChebNetï¼Œå·ç§¯å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{1}
g\_\theta \star \mathbf{s} \approx \sum^K\_{k=0} \theta'\_k T\_k (L\_{sym}) \mathbf{s},
$$&lt;p&gt;å…¶ä¸­ $\bf{s} \in \mathcal{R}^n$ æ˜¯å›¾ä¸Šçš„ä¿¡å·ï¼Œ$g_\theta$æ˜¯è°±æ»¤æ³¢å™¨ï¼Œ$\star$ æ˜¯å·ç§¯æ“ä½œï¼Œ$T_k$ æ˜¯åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼ï¼Œ$\theta&amp;rsquo; \in \mathcal{R}^K$ æ˜¯åˆ‡æ¯”é›ªå¤«ç³»æ•°å‘é‡ã€‚é€šè¿‡è¿™ç§è¶‹è¿‘ï¼ŒChebNet åŸŸè°±æ— å…³ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ (Kipf and Welling 2017) ä¸­ï¼ŒKipf and Welling å°†ä¸Šé¢çš„æ¨¡å‹é€šè¿‡è®© $K = 1$ è¿›è¡Œäº†ç®€åŒ–ï¼Œå°† $L_{sym}$ çš„æœ€å¤§ç‰¹å¾å€¼è¶‹è¿‘ä¸º2.åœ¨è¿™ç§å½¢å¼ä¸­ï¼Œå·ç§¯å˜æˆï¼š&lt;/p&gt;
$$\tag{2}
g\_\theta \star \mathbf{s} = \theta(I + D^{-\frac{1}{2}} A D^{-\frac{1}{2}}) \mathbf{s},
$$&lt;p&gt;å…¶ä¸­ $\theta$ æ˜¯åˆ‡æ¯”é›ªå¤«ç³»æ•°ã€‚ç„¶åå¯¹å·ç§¯çŸ©é˜µä½¿ç”¨ä¸€ç§æ­£åˆ™åŒ–çš„æŠ€å·§ï¼š&lt;/p&gt;
$$\tag{3}
I + D^{-\frac{1}{2}} A D^{-\frac{1}{2}} \rightarrow \tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}},
$$&lt;p&gt;å…¶ä¸­ $\tilde{A} = A + I$ï¼Œ$\tilde{D} = \sum_j \tilde{A}_{ij}$.&lt;/p&gt;
&lt;p&gt;å°†å·ç§¯æ³›åŒ–åˆ°å¸¦æœ‰ $c$ ä¸ªé€šé“çš„å›¾ä¿¡å·ä¸Šï¼Œä¹Ÿå°±æ˜¯ $X \in \mathcal{R}^{n \times c}$ (æ¯ä¸ªé¡¶ç‚¹æ˜¯ä¸€ä¸ª $c$ ç»´ç‰¹å¾å‘é‡)ï¼Œä½¿ç”¨ $f$ è°±å·ç§¯æ ¸ï¼Œç®€åŒ–åçš„æ¨¡å‹çš„ä¼ æ’­è§„åˆ™æ˜¯ï¼š&lt;/p&gt;
$$\tag{4}
H^{(l + 1)} = \sigma(\tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}} H^{(l)} \Theta^{(l)}),
$$&lt;p&gt;å…¶ä¸­ï¼Œ$H^{(l)}$ æ˜¯ç¬¬ $l$ å±‚çš„æ¿€æ´»å€¼çŸ©é˜µï¼Œ$H^{(0)} = X$ï¼Œ$\Theta^{(l)} \in \mathcal{R}^{c \times f}$ æ˜¯ç¬¬ $l$ å±‚å¯è®­ç»ƒçš„æƒé‡çŸ©é˜µï¼Œ$\sigma$ æ˜¯æ¿€æ´»å‡½æ•°ï¼Œæ¯”å¦‚ $ReLU(\cdot) = max(0, \cdot)$ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªç®€åŒ–çš„æ¨¡å‹ç§°ä¸ºå›¾å·ç§¯ç½‘ç»œ (GCNs)ï¼Œæ˜¯æˆ‘ä»¬è¿™ç¯‡è®ºæ–‡å…³æ³¨çš„é‡ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Semi-Supervised Classification with GCNs&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ Kipf and Welling 2017 ä¸­ï¼ŒGCN æ¨¡å‹ä»¥ä¸€ç§ä¼˜é›…çš„æ–¹å¼åšåŠç›‘ç£åˆ†ç±»ä»»åŠ¡ã€‚æ¨¡å‹æ˜¯ä¸€ä¸ªä¸¤å±‚ GCNï¼Œåœ¨è¾“å‡ºæ—¶ä½¿ç”¨ä¸€ä¸ª softmaxï¼š&lt;/p&gt;
$$\tag{5}
Z = \mathrm{softmax}(\hat{A} ReLU (\hat{A} X \Theta^{(0)}) \Theta^{(1)} ),
$$&lt;p&gt;å…¶ä¸­ $\hat{A} = \tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}}$ï¼Œ$\mathrm{softmax}(x_i) = \frac{1}{\mathcal{Z}} exp(x_i)$ï¼Œ$\mathcal{Z} = \sum_i exp(x_i)$ã€‚æŸå¤±å‡½æ•°æ˜¯æ‰€æœ‰æ ‡è®°æ ·æœ¬ä¸Šçš„äº¤å‰ç†µï¼š&lt;/p&gt;
$$\tag{6}
\mathcal{L} := - \sum\_{i \in \mathcal{V}\_l} \sum^F\_{f=1} Y\_{if} \mathrm{ln} Z\_{if},
$$&lt;p&gt;å…¶ä¸­ $\mathcal{V}_l$ æ˜¯æ ‡è®°é¡¶ç‚¹çš„ä¸‹æ ‡ï¼Œ$F$ æ˜¯è¾“å‡ºç‰¹å¾çš„ç»´æ•°ï¼Œç­‰ä»·äºç±»åˆ«æ•°ã€‚$Y \in \mathcal{R}^{\vert \mathcal{V}_l \vert \times F}$ æ˜¯æ ‡è®°çŸ©é˜µã€‚æƒé‡å‚æ•° $\Theta^{(0)}$ å’Œ $\Theta^{(1)}$ å¯ä»¥é€šè¿‡æ¢¯åº¦ä¸‹é™è®­ç»ƒã€‚&lt;/p&gt;
&lt;p&gt;GCN æ¨¡å‹åœ¨å·ç§¯ä¸­è‡ªç„¶åœ°èåˆäº†å›¾çš„ç»“æ„å’Œé¡¶ç‚¹çš„ç‰¹å¾ï¼Œæœªæ ‡è®°çš„é¡¶ç‚¹çš„ç‰¹å¾å’Œä¸´è¿‘çš„æ ‡è®°é¡¶ç‚¹çš„æ··åˆåœ¨ä¸€èµ·ï¼Œç„¶åé€šè¿‡å¤šä¸ªå±‚åœ¨ç½‘ç»œä¸Šä¼ æ’­ã€‚GCNs åœ¨ Kipf &amp;amp; Welling 2017 ä¸­æ¯”å¾ˆå¤š state-of-the-art æ–¹æ³•éƒ½å¥½å¾ˆå¤šï¼Œæ¯”å¦‚åœ¨å¼•æ–‡ç½‘ç»œä¸Šã€‚&lt;/p&gt;
&lt;h1 id="3-analysis"&gt;3 Analysis
&lt;/h1&gt;&lt;p&gt;å°½ç®¡å®ƒçš„æ€§èƒ½å¾ˆå¥½ï¼Œä½†æ˜¯ç”¨äºåŠç›‘ç£å­¦ä¹ çš„ GCN æ¨¡å‹çš„æœºç†è¿˜æ²¡æœ‰å¼„æ˜ç™½ã€‚åœ¨è¿™éƒ¨åˆ†æˆ‘ä»¬ä¼šèµ°è¿‘ GCN æ¨¡å‹ï¼Œåˆ†æå®ƒä¸ºä»€ä¹ˆå¥½ä½¿ï¼Œå¹¶æŒ‡å‡ºå®ƒçš„é™åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Why GCNs Work&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°† GCN å’Œæœ€ç®€å•çš„å…¨è¿æ¥ç¥ç»ç½‘ç»œ (FCN) è¿›è¡Œæ¯”è¾ƒï¼Œä¼ æ’­è§„åˆ™æ˜¯ï¼š&lt;/p&gt;
$$\tag{7}
H^{(l + 1)} = \sigma(H^{(l)} \Theta^{(l)}).
$$&lt;p&gt;GCN å’Œ FCN ä¹‹é—´çš„å”¯ä¸€ä¸€ä¸ªåŒºåˆ«æ˜¯å›¾å·ç§¯çŸ©é˜µ $\hat{A} = \tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}}$ (å¼5)ç”¨åœ¨ç‰¹å¾çŸ©é˜µ $X$ çš„å·¦è¾¹ã€‚æˆ‘ä»¬åœ¨ Cora æ•°æ®é›†ä¸Šï¼Œæ¯ç±» 20 ä¸ª æ ‡ç­¾ï¼Œåšäº†åŠç›‘ç£åˆ†ç±»çš„æµ‹è¯•ã€‚å¦‚è¡¨1æ‰€ç¤ºã€‚å³ä¾¿æ˜¯åªæœ‰ä¸€å±‚çš„ GCN ä¹Ÿæ¯”ä¸€å±‚çš„ FCN å¥½å¾ˆå¤šã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deeper-insights-into-graph-convolutional-networks-for-semi-supervised-learning/Table1.JPG"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Laplacian Smoothing.&lt;/strong&gt; è€ƒè™‘ä¸€ä¸ªä¸€å±‚çš„ GCNã€‚å®é™…æœ‰ä¸¤æ­¥ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä»çŸ©é˜µ $X$ é€šè¿‡ä¸€ä¸ªå›¾å·ç§¯å¾—åˆ°æ–°çš„ç‰¹å¾çŸ©é˜µ $Y$ï¼š&lt;/li&gt;
&lt;/ol&gt;
$$\tag{8}
Y = \tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}}X.
$$&lt;ol start="2"&gt;
&lt;li&gt;å°†æ–°çš„ç‰¹å¾çŸ©é˜µ $Y$ æ”¾åˆ°ä¸€ä¸ªå…¨è¿æ¥å±‚ã€‚å¾ˆæ˜æ˜¾ï¼Œå›¾å·ç§¯æ˜¯æ€§èƒ½æå‡çš„å…³é”®ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æˆ‘ä»¬æ¥è‡ªå·±çš„æ£€æŸ¥ä¸€ä¸‹å›¾å·ç§¯ã€‚å‡è®¾æˆ‘ä»¬ç»™å›¾ä¸­çš„æ¯ä¸ªç»“ç‚¹å¢åŠ ä¸€ä¸ªè‡ªè¿æ¥ï¼Œæ–°çš„å›¾çš„é‚»æ¥çŸ©é˜µå°±æ˜¯ $\tilde{A} = A + I$ã€‚è¾“å…¥ç‰¹å¾çš„æ¯ä¸ªé€šé“çš„æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ (Taubin 1995) å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$\tag{9}
\hat{\mathrm{y}}\_i = (1 - \gamma) \mathrm{x}\_i + \gamma \sum\_j \frac{\tilde{a}\_{ij}}{d\_i} \mathrm{x}\_j \quad (\text{for} \quad 1 \leq i \leq n),
$$&lt;p&gt;å…¶ä¸­ $0 &amp;lt; \gamma &amp;lt; 1$ æ˜¯æ§åˆ¶å½“å‰ç»“ç‚¹çš„ç‰¹å¾å’Œå®ƒçš„é‚»å±…çš„ç‰¹å¾ä¹‹é—´çš„æƒé‡ã€‚æˆ‘ä»¬å¯ä»¥å°†æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘å†™æˆçŸ©é˜µå½¢å¼ï¼š&lt;/p&gt;
$$\tag{10}
\hat{Y} = X - \gamma \tilde{D}^{-1} \tilde{L} X = (I - \gamma \tilde{D}^{-1} \tilde{L})X,
$$&lt;p&gt;å…¶ä¸­ $\tilde{L} = \tilde{D} - \tilde{A}$ã€‚é€šè¿‡è®¾å®š $\gamma = 1$ï¼Œä¹Ÿå°±æ˜¯åªä½¿ç”¨é‚»å±…çš„ç‰¹å¾ï¼Œå¯å¾— $\hat{Y} = \tilde{D}^{-1} \tilde{A} X$ï¼Œä¹Ÿå°±æ˜¯æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘çš„æ ‡å‡†å½¢å¼ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å¦‚æœæˆ‘ä»¬æŠŠå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ $\tilde{D}^{-1} \tilde{L}$ æ›¿æ¢æˆå¯¹é˜µçš„å½’ä¸€åŒ–æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ $\tilde{D}^{-\frac{1}{2}} \tilde{L} \tilde{D}^{-\frac{1}{2}}$ï¼Œè®© $\gamma = 1$ï¼Œå¯å¾— $\hat{Y} = \tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}} X$ï¼Œè¿™æ°å¥½å°±æ˜¯å¼8ä¸­çš„å›¾å·ç§¯ã€‚æˆ‘ä»¬å› æ­¤ç§°å›¾å·ç§¯æ˜¯ä¸€ç§ç‰¹æ®Šå½¢å¼çš„æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘â€”â€”å¯¹ç§°æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ã€‚æ³¨æ„ï¼Œå¹³æ»‘ä»ç„¶ä¼šåŒ…å«é¡¶ç‚¹ç‰¹å¾ï¼Œå› ä¸ºæ¯ä¸ªé¡¶ç‚¹æœ‰ä¸€ä¸ªè‡ªè¿æ¥ï¼Œè¿˜æœ‰å®ƒè‡ªå·±çš„é‚»å±…ã€‚&lt;/p&gt;
&lt;p&gt;æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘è®¡ç®—äº†é¡¶ç‚¹çš„æ–°çš„ç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯é¡¶ç‚¹è‡ªèº«å’Œé‚»å±…çš„åŠ æƒå¹³å‡ã€‚å› ä¸ºåŒä¸€ç±»ç°‡çš„é¡¶ç‚¹å€¾å‘äºè¿æ¥çš„æ›´ç´§å¯†ï¼Œè¿™ä½¿å¾—åˆ†ç±»ä»»åŠ¡å˜å¾—æ›´ç®€å•ã€‚å› ä¸ºæˆ‘ä»¬å¯ä»¥ä»è¡¨1çœ‹å‡ºåªä½¿ç”¨ä¸€æ¬¡å¹³æ»‘å°±å¾ˆæœ‰æ•ˆäº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Multi-layer Structure.&lt;/strong&gt; æˆ‘ä»¬å¯ä»¥ä»è¡¨1çœ‹å‡ºå°½ç®¡ä¸¤å±‚çš„ FCN æ¯” ä¸€å±‚çš„ FCN æœ‰äº†äº›è®¸çš„æå‡ï¼Œä¸¤å±‚çš„ GCN å´æ¯” ä¸€å±‚çš„ GCN å¥½äº†å¾ˆå¤šã€‚è¿™æ˜¯å› ä¸ºåœ¨ç¬¬ä¸€å±‚çš„æ¿€æ´»å€¼ä¸Šå†ä½¿ç”¨å¹³æ»‘ä½¿å¾—åŒä¸€ä¸ªç±»ç°‡ä¸­çš„é¡¶ç‚¹ç‰¹å¾å˜å¾—æ›´åƒå››äº†ï¼Œä½¿åˆ†ç±»ä»»åŠ¡æ›´ç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;When GCNs Fail&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»è¯æ˜äº†å›¾å·ç§¯æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ç§æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ã€‚é‚£ GCN ä¸­åº”è¯¥æ”¾å¤šå°‘å±‚å‘¢ï¼Ÿå½“ç„¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ã€‚GCN å±‚å¤šäº†ä¼šä¸å¥½è®­ç»ƒã€‚è€Œä¸”é‡å¤ä½¿ç”¨æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘å¯èƒ½ä¼šæ··åˆä¸åŒç±»ç°‡ä¸­çš„é¡¶ç‚¹çš„ç‰¹å¾ï¼Œä½¿å¾—ä»–ä»¬åŒºåˆ†ä¸æ¸…ã€‚æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ Zachary çš„ karate club dataset (Zachary 1977) ä¸Šè·‘å‡ ä¸ªå±‚æ•°ä¸åŒçš„æ¨¡å‹ã€‚è¿™ä¸ªæ•°æ®é›†æœ‰ 34 ä¸ªç»“ç‚¹ï¼Œä¸¤ç±»ï¼Œ78 æ¡è¾¹ã€‚GCN çš„å‚æ•°åƒ (Glorot and Bengio 2010) ä¸­çš„ä¸€æ ·éšæœºåˆå§‹åŒ–ã€‚éšè—å±‚çš„ç»´æ•°æ˜¯ 16ï¼Œè¾“å‡ºå±‚çš„ç»´åº¦æ˜¯2ã€‚æ¯ä¸ªç»“ç‚¹çš„ç‰¹å¾å‘é‡æ˜¯ä¸€ä¸ª one-hot å‘é‡ã€‚æ¯ä¸ª GCN çš„è¾“å‡ºç»˜åˆ¶åœ¨å›¾2ä¸­ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å›¾å·ç§¯çš„å½±å“ï¼ˆå›¾2aï¼‰ã€‚ä½¿ç”¨ä¸¤æ¬¡å¹³æ»‘ï¼Œåˆ†ç±»æ•ˆæœç›¸å¯¹è¾ƒå¥½ã€‚å†æ¬¡ä½¿ç”¨å¹³æ»‘ï¼Œç‚¹å°±ä¼šæ··åˆï¼ˆå›¾2cï¼Œ2dï¼Œ2eï¼‰ã€‚å› ä¸ºè¿™æ˜¯ä¸ªå°çš„æ•°æ®é›†ï¼Œä¸¤ç±»ä¹‹é—´çš„é¡¶ç‚¹æœ‰å¾ˆå¤šè¿æ¥ï¼Œæ‰€ä»¥å¾ˆå¿«å°±å‘ç”Ÿäº†æ··åˆã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¼šè¯æ˜é‡å¤ä½¿ç”¨æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ï¼Œé¡¶ç‚¹çš„ç‰¹å¾ä»¥åŠå›¾çš„æ¯ä¸ªè¿é€šåˆ†é‡ä¼šæ”¶æ•›åˆ°ç›¸åŒçš„å€¼ã€‚å¯¹äºå¯¹ç§°çš„æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ï¼Œä»–ä»¬æ”¶æ•›åˆ°çš„å€¼ä¸é¡¶ç‚¹åº¦æ•°çš„äºŒåˆ†ä¹‹ä¸€æ¬¡å¹‚æˆæ­£æ¯”ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾å›¾ $\mathcal{G}$ æœ‰ $k$ ä¸ªè¿é€šåˆ†é‡ $\lbrace C_i\rbrace ^k_{i=1}$ï¼Œå¯¹äºç¬¬ $i$ ä¸ªè¿é€šåˆ†é‡çš„æŒ‡ç¤ºå‘é‡è¡¨ç¤ºä¸º $\mathbf{1}^{(i)} \in \mathbb{R}^n$ã€‚è¿™ä¸ªå‘é‡è¡¨ç¤ºé¡¶ç‚¹æ˜¯å¦åœ¨åˆ†é‡ $C_i$ä¸­ï¼Œå³ï¼š&lt;/p&gt;
$$\tag{11}
\mathbf{1}^{(i)}\_j = \begin{cases}
1, v\_j \in C\_i,\\
0, v\_j \notin C\_i
\end{cases}
$$&lt;p&gt;**Theorem 1. ** å¦‚æœä¸€ä¸ªå›¾æ²¡æœ‰äºŒåˆ†çš„è¿é€šåˆ†é‡ï¼Œé‚£ä¹ˆå¯¹äºä»»æ„ $\mathrm{w} \in \mathbb{R}^n$ï¼Œ$\alpha \in (0, 1]$ï¼Œ&lt;/p&gt;
$$
\lim\_{m \rightarrow + \infty} (I - \alpha L\_{rw})^m \mathrm{w} = [\mathbf{1}^{(1)}, \mathbf{1}^{(2)}, ..., \mathbf{1}^{(k)}]\theta\_1,
$$$$
\lim\_{m \rightarrow + \infty} (I - \alpha L\_{sym})^m \mathrm{w} = D^{-\frac{1}{2}}[\mathbf{1}^{(1)}, \mathbf{1}^{(2)}, ..., \mathbf{1}^{(k)}]\theta\_2,
$$&lt;p&gt;å…¶ä¸­ $\theta_1 \in \mathbb{R}^k, \theta_2 \in \mathbb{R}^k$ï¼Œä¹Ÿå°±æ˜¯ä»–ä»¬åˆ†åˆ«æ”¶æ•›åˆ° $\lbrace \mathbf{1}^{(i)}\rbrace ^k_{i=1}$ å’Œ $\lbrace D^{-\frac{1}{2}} \mathbf{1}^{(i)} \rbrace ^k_{i=1}$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Proof.&lt;/em&gt; $L_{rw}$ å’Œ $L_{sym}$ æœ‰ç›¸åŒçš„ $n$ ä¸ªç‰¹å¾å€¼ï¼Œä¸åŒçš„ç‰¹å¾å‘é‡ (Von Luxbury 2007)ã€‚å¦‚æœä¸€ä¸ªå›¾æ²¡æœ‰äºŒåˆ†çš„è¿é€šåˆ†é‡ï¼Œé‚£ä¹ˆç‰¹å¾å€¼å°±ä¼šåœ¨ $[0, 2)$ åŒºé—´å†… (Chung 1997)ã€‚åé¢å°±æ²¡çœ‹æ‡‚äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h1 id="4-solutions"&gt;4. Solutions
&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;Co-Train a GCN with a Random Walk Model&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ä¸€ä¸ª partially absorbing random walks (Wu et al. 2012) æ¥æ•è·ç½‘ç»œçš„å…¨å±€ç»“æ„ã€‚æ–¹æ³•å°±æ˜¯è®¡ç®—å½’ä¸€åŒ–çš„å¸æ”¶æ¦‚ç‡çŸ©é˜µ $P = (L + \alpha \Lambda)^{-1}$ï¼Œ$P_{i, j}$ æ˜¯ä»é¡¶ç‚¹ $i$ å‡ºå‘è¢«å¸æ”¶åˆ°é¡¶ç‚¹ $j$ çš„æ¦‚ç‡ï¼Œè¡¨ç¤º $i$ å’Œ $j$ æœ‰å¤šå¤§çš„å¯èƒ½æ€§å±äºåŒä¸€ç±»ã€‚ç„¶åæˆ‘ä»¬å¯¹æ¯ç±» $k$ï¼Œè®¡ç®—å¯ä¿¡å‘é‡ $\mathbf{p} = \sum_{j \in S_k} P_{:, j}$ï¼Œå…¶ä¸­ $\mathbf{p} \in \mathbb{R}^n$ï¼Œ$p_i$ æ˜¯é¡¶ç‚¹ $i$ å±äºç±» $k$ çš„æ¦‚ç‡ã€‚æœ€åï¼Œæ‰¾åˆ° $t$ ä¸ªæœ€å¯ä¿¡çš„é¡¶ç‚¹æŠŠä»–ä»¬åŠ åˆ°è®­ç»ƒé›†çš„ç±» $k$ ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deeper-insights-into-graph-convolutional-networks-for-semi-supervised-learning/Alg1.JPG"
loading="lazy"
alt="Alg1"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;GCN Self-Training&lt;/strong&gt;
å¦ä¸€ç§æ–¹æ³•å°±æ˜¯å…ˆè®­ç»ƒä¸€ä¸ª GCNï¼Œç„¶åä½¿ç”¨è¿™ä¸ª GCN å»é¢„æµ‹ï¼Œæ ¹æ®é¢„æµ‹ç»“æœçš„ $\text{softmax}$ åˆ†æ•°é€‰æ‹©å¯ä¿¡çš„æ ·æœ¬ï¼ŒåŠ å…¥åˆ°è®­ç»ƒé›†ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/deeper-insights-into-graph-convolutional-networks-for-semi-supervised-learning/Alg2.JPG"
loading="lazy"
alt="Alg2"
&gt;&lt;/p&gt;</description></item><item><title>Dynamic Bike Reposition: A Spatio-Temporal Reinforcement Learning Approach</title><link>https://davidham3.github.io/blog/p/dynamic-bike-reposition-a-spatio-temporal-reinforcement-learning-approach/</link><pubDate>Mon, 08 Oct 2018 21:28:18 +0000</pubDate><guid>https://davidham3.github.io/blog/p/dynamic-bike-reposition-a-spatio-temporal-reinforcement-learning-approach/</guid><description>&lt;p&gt;KDD 2018.å¼ºåŒ–å­¦ä¹ å¤„ç†å…±äº«å•è½¦è°ƒåº¦é—®é¢˜ã€‚&lt;/p&gt;
&lt;h1 id="abstract"&gt;ABSTRACT
&lt;/h1&gt;&lt;p&gt;å…±äº«å•è½¦ç³»ç»Ÿåœ¨å¾ˆå¤šåŸå¸‚éƒ½å¼€å§‹ä½¿ç”¨äº†ï¼Œå°½ç®¡æ‹¥æŒ¤å’Œç©ºçš„ç«™ç‚¹éƒ½ä¼šå¯¼è‡´å®¢æˆ·çš„æµå¤±ã€‚å½“å‰ï¼Œè¿è¥è€…è¯•å›¾åœ¨ç³»ç»Ÿè¿è¡Œä¸­ä¸æ–­åœ°åœ¨ç«™ç‚¹é—´è°ƒåº¦è½¦è¾†ã€‚ç„¶è€Œï¼Œå¦‚ä½•åœ¨ä¸€ä¸ªé•¿æ—¶é—´çš„èŒƒå›´å†…æœ‰æ•ˆåœ°è°ƒåº¦è‡ªè¡Œè½¦ä½¿å¾—ä¹˜å®¢çš„æµå¤±æœ€å°‘è¿˜æ²¡æœ‰å¾—åˆ°è§£å†³ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªåŸºäºæ—¶ç©ºå¼ºåŒ–å­¦ä¹ æ–¹æ³•çš„è‡ªè¡Œè½¦è°ƒåº¦æ¨¡å‹è§£å†³è¿™ä¸ªé—®é¢˜ã€‚é¦–å…ˆï¼Œä¸€ä¸ªäº’ç›¸ä¾èµ–ä¸”å†…éƒ¨å¹³è¡¡çš„èšç±»ç®—æ³•ç”¨æ¥å¯¹ç«™ç‚¹èšç±»ã€‚ç±»ç°‡æœ‰ä¸¤ç‚¹å±æ€§ï¼Œæ¯ä¸ªç±»ç°‡ç±»å†…å¹³è¡¡è€Œä¸”ç±»é—´ç‹¬ç«‹ã€‚å› ä¸ºåœ¨å¾ˆå¤§çš„ç³»ç»Ÿä¸­æœ‰å¾ˆå¤šä¸‰è½®è½¦è°ƒæ•´è‡ªè¡Œè½¦ï¼Œèšç±»å¯¹äºå‡å°‘é—®é¢˜çš„å¤æ‚åº¦æ¥è¯´å¾ˆé‡è¦ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬ç»™æ¯ä¸ªç±»ç°‡åˆ†é…äº†å¤šè¾†ä¸‰è½®è½¦ï¼Œå¯¹ç±»å†…è‡ªè¡Œè½¦è¿›è¡Œè°ƒåº¦ã€‚æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªæ—¶ç©ºå¼ºåŒ–å­¦ä¹ æ¨¡å‹å¯¹æ¯ä¸ªç±»ç°‡è¿›è¡Œç­–ç•¥çš„å­¦ä¹ ï¼Œç›®æ ‡æ˜¯åœ¨é•¿æ—¶é—´èŒƒå›´å†…é™ä½ç”¨æˆ·çš„æµå¤±ã€‚ä¸ºäº†å­¦ä¹ æ¯ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œæ¥ä¼°è®¡å®ƒçš„æœ€ä¼˜é•¿æœŸä»·å€¼å‡½æ•°ï¼Œæœ€ä¼˜ç­–ç•¥å¯ä»¥ä»è¿™ä¸ªå‡½æ•°ä¸­è½»æ¾åœ°æ¨å¯¼å‡ºæ¥ã€‚é™¤äº†å°†æ¨¡å‹å®šä¹‰æˆå¤šæ™ºèƒ½ä½“çš„æ–¹å¼ï¼Œæˆ‘ä»¬è¿˜é€šè¿‡ä¸¤ä¸ªæ—¶ç©ºå‰ªæè§„åˆ™å‡å°‘äº†è®­ç»ƒçš„å¤æ‚åº¦ã€‚å…¶ä¸‰ï¼Œæˆ‘ä»¬åŸºäºä¸¤ä¸ªé¢„æµ‹å…¶è®¾è®¡äº†ä¸€ä¸ªç³»ç»Ÿæ¨¡æ‹Ÿå™¨æ¥é¢„æµ‹è®­ç»ƒå’Œè¯„ä¼°è°ƒåº¦æ¨¡å‹ã€‚åœ¨Citi Bikeçš„çœŸå®æ•°æ®é›†ä¸Šçš„å®éªŒéªŒè¯äº†æˆ‘ä»¬çš„æ¨¡å‹çš„æœ‰æ•ˆæ€§ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 INTRODUCTION
&lt;/h1&gt;&lt;p&gt;å…±äº«å•è½¦ç³»ç»Ÿç»™å…¬æ°‘æä¾›äº†ä¾¿åˆ©çš„å‡ºè¡Œæ–¹å¼ã€‚ç”¨æˆ·å¯ä»¥åœ¨ä¸€ä¸ªéšæœºçš„ç«™ç‚¹ç§Ÿæˆ–è¿”è¿˜è‡ªè¡Œè½¦ï¼Œé€šè¿‡åˆ·å¡ï¼Œç”Ÿæˆä¸€æ¡å•è½¦ä½¿ç”¨è®°å½•ã€‚ç„¶è€Œï¼Œå› ä¸ºåœ¨ä¸€ä¸ªåŸå¸‚å†…çš„å•è½¦ä½¿ç”¨æ˜¯éå¸¸ä¸å¹³è¡¡çš„ï¼Œç³»ç»Ÿä¸­ç»å¸¸å‡ºç°æ²¡æœ‰è½¦çš„ç©ºç«™ç‚¹ä»¥åŠç¼ºå°‘å¯ç”¨åœè½¦ä½çš„æ‹¥æŒ¤ç«™ç‚¹ï¼Œå¯¼è‡´ä¹˜å®¢çš„æµå¤±ã€‚å½“å‰ï¼Œç³»ç»Ÿè¿è¥è€…ä½¿ç”¨ &lt;em&gt;dynamic bike reposition&lt;/em&gt; æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ï¼Œåœ¨ç³»ç»Ÿè¿è¡Œä¸­ä½¿ç”¨ä¸‰è½®è½¦ä¸æ–­çš„åœ¨ç«™ç‚¹é—´è°ƒæ•´è½¦è¾†ã€‚ç„¶è€Œï¼Œå¦‚ä½•åœ¨é•¿æ—¶é—´èŒƒå›´å†…è°ƒæ•´è½¦è¾†ä½¿å¾—é¡¾å®¢æµå¤±æœ€å°‘è¿˜æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚å®æ—¶ç›‘æµ‹å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„æ–¹æ¡ˆï¼Œå› ä¸ºåœ¨è§‚æµ‹åˆ°ä¸å¹³è¡¡åå¯¹è½¦è¾†é‡æ–°åˆ†é…å¤ªæ™šäº†ã€‚ä»…ä»…åŸºäºå•è½¦ä½¿ç”¨é¢„æµ‹æ¥è°ƒåº¦åªä¼šå¯¼è‡´ä¸€ä¸ªè´ªå¿ƒä¸”çŸ­è§†çš„ç­–ç•¥ï¼Œåœ¨é•¿æ—¶é—´æ¥çœ‹ä¸ä¼šæ˜¯æœ€ä¼˜çš„ã€‚æˆ‘ä»¬æ€»ç»“äº†è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸‰ä¸ªæŒ‘æˆ˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;A bike-sharing system is complex and dynamic.&lt;/strong&gt;&lt;/em&gt; ç³»ç»Ÿä¸­ç»å¸¸æœ‰å‡ åè¾†ä¸‰è½®è½¦åœ¨å‡ ç™¾ä¸ªç«™ç‚¹é—´è°ƒåº¦è½¦è¾†ã€‚åœ¨è¿™ä¹ˆä¸€ä¸ªå¤§çš„ç³»ç»Ÿå†…ååŒè°ƒåº¦å¾ˆå¤æ‚ï¼Œæ›´ä¸ç”¨è¯´ç³»ç»Ÿæ˜¯åœ¨è¿è¡Œä¸­ä¿æŒåŠ¨æ€çš„æƒ…å†µäº†ã€‚éš¾ä»¥é¢„æµ‹ç³»ç»Ÿçš„åŠ¨æ€æ€§æœ‰ä¸‰ç‚¹åŸå› ï¼š1) å›¾1. A å±•ç¤ºå‡ºäº†ä¸€ä¸ªæœˆæ¯ä¸ªå°æ—¶çš„ç§Ÿè½¦éœ€æ±‚ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ¯å¤©çš„ç§Ÿç”¨æ¨¡å¼å˜åŒ–å¾—å¾ˆå‰§çƒˆï¼Œå—å¤šä¸ªå¤æ‚çš„å› ç´ å½±å“ï¼Œæ¯”å¦‚å¤©æ°”ã€äº‹ä»¶ä»¥åŠç«™ç‚¹é—´çš„ç›¸å…³æ€§ã€‚2) å¾ˆå¤šç§»åŠ¨çœ‹èµ·æ¥æ˜¯éšæœºçš„ã€‚å›¾1. Bçš„ç¬¬ä¸€å¼ å›¾è¡¨ç¤ºå‡ºäº†å†å²é€šå‹¤ï¼Œä¹Ÿå°±æ˜¯2016å¹´4æœˆåˆ°10æœˆæ¯ä¸ªå·¥ä½œæ—¥çš„æ—©ä¸Šè¿™æ®µæœŸé—´ï¼Œå¹³å‡è‡³å°‘å‘ç”Ÿä¸€æ¬¡çš„ç§»åŠ¨ï¼Œåªå äº†18%ã€‚æˆ‘ä»¬ç”¨å›¾1. Cçš„ä¾‹å­è§£é‡Šäº†è¿™ç§ç°è±¡ï¼šä»Aåˆ°Bï¼Œç«™ç‚¹é—´çš„ç§»åŠ¨æœ‰12ç§å¯èƒ½ï¼Œç”¨æˆ·ä¸€èˆ¬ä¼šæ ¹æ®å“ªä¸ªç«™ç‚¹æœ‰å¯ç”¨çš„è½¦è¾†æˆ–è½¦ä½ï¼Œé€‰æ‹©éšæœºçš„ä¸€æ¡è·¯çº¿ï¼Œä½¿12æ¡è·¯çº¿ä¸­çš„ä¸€æ¡å˜æˆå¯èƒ½çš„é¢‘ç¹ç§»åŠ¨è·¯çº¿ã€‚3) å½±å“è½¦è¾†ä½¿ç”¨çš„å¤–éƒ¨å› ç´ éå¸¸ä¸å¹³è¡¡ï¼Œæ¯”å¦‚ï¼Œæ™´å¤©æ—¶é•¿è¦æ¯”é›¨å¤©æ—¶é•¿å¤šå¾ˆå¤šã€‚å› æ­¤ï¼Œåœ¨æ¯ä¸ªæ¡ä»¶ä¸‹è®­ç»ƒä¸€ä¸ªå­¦ä¹ å™¨ä¸èƒ½ä¿è¯åœ¨æ¬¡è¦æ¡ä»¶ä¸‹çš„å‡†ç¡®æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/dynamic-bike-reposition-a-spatio-temporal-reinforcement-learning-approach/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;A single bike reposition has long-term effect.&lt;/strong&gt;&lt;/em&gt; ä¸€ä¸ªç®€å•çš„è°ƒåº¦æ˜¯å¥½æ˜¯åä¸æ˜¯é‚£ä¹ˆç®€å•å°±èƒ½åˆ¤æ–­çš„ã€‚æˆ‘ä»¬å°†ç”¨å›¾2çš„ä¸¤ä¸ªä¾‹å­è¯¦ç»†æè¿°ä¸€ä¸‹ï¼Œçº¢åœˆè¡¨ç¤ºæ²¡æœ‰å¯ç”¨è½¦ä½çš„ç«™ç‚¹ï¼Œç»¿åœˆè¡¨ç¤ºä¸€ä¸ªç©ºçš„ç«™ç‚¹ï¼›å¸¦æœ‰ä¸€ä¸ªæ•°å­—å’Œä¸€ä¸ªæ—¶é—´æ ‡è®°çš„å®çº¿ç®­å¤´è¡¨ç¤ºåœ¨é‚£ä¸ªæ—¶æ®µä¼šæœ‰å¤šå°‘è¾†è½¦ä»èµ·ç‚¹ç§Ÿç”¨å¹¶è¿”è¿˜åˆ°ç›®çš„åœ°ï¼›è™šçº¿ç®­å¤´è¡¨ç¤ºäº†ä¸€ä¸ªä¸‰è½®è½¦çš„è°ƒåº¦æ˜¯å¦‚ä½•è¿›è¡Œçš„ï¼›$t_0 &amp;lt; t_1 &amp;lt; t_2$ã€‚é¦–å…ˆï¼Œä¸€ä¸ªç®€å•çš„è°ƒåº¦ä¼šå½±å“ç³»ç»Ÿå†…çš„è½¦è¾†ä½¿ç”¨å¾ˆé•¿çš„ä¸€æ®µæ—¶é—´ã€‚å¦‚å›¾2. A) æ‰€ç¤ºï¼Œå¦‚æœä¸€ä¸ªä¸‰è½®è½¦åˆ°äº†ç©ºç«™ç‚¹ $s_1$ï¼Œåœ¨ $t_0$ æ—¶æ®µæ”¾äº†5è¾†è½¦ï¼Œåœ¨ $s_1$ çš„å¯ç”¨è½¦è¾†å°±å˜æˆäº†$5$ï¼Œåœ¨ $t_1$ æ—¶æ®µ $s_1$ å¯ä»¥æœåŠ¡ $5$ ä½å³å°†åˆ°æ¥çš„ç§Ÿè½¦è€…ï¼›è¿™5ä¸ªç§Ÿè½¦è€…éª‘è½¦åˆ° $s_2$ åœ¨ $t_1 &amp;lt; t_2$ è¿˜è½¦ï¼Œ4ä½åˆ°æ¥çš„ç§Ÿè½¦è€…åœ¨ $t_2$ æ—¶æ®µ $s_2$ è½¦ç«™æƒ³ç§Ÿè½¦çš„ä¹Ÿå¯ä»¥ä½¿ç”¨é‚£äº›è¿˜å›æ¥çš„è½¦ã€‚å› æ­¤ï¼Œä¸€ä¸ªè°ƒåº¦å¯ä»¥æœåŠ¡çš„é¢å¤–ç”¨æˆ·çš„æ•°é‡å¾ˆéš¾ä¼°è®¡ã€‚å…¶æ¬¡ï¼Œå½“å‰çš„è°ƒåº¦ä¼šå½±å“ä»¥ä¸‹æƒ…å†µã€‚å¦‚å›¾2. B) æ‰€ç¤ºï¼Œå¦‚æœä¸€ä¸ªä¸‰è½®è½¦åˆ°ç«™ç‚¹ $s_1$ åœ¨ $t_0$ æ—¶æ®µå¸¦èµ°äº† 9 è¾†è‡ªè¡Œè½¦ï¼Œé‚£é‡Œçš„å¯ç”¨è½¦ä½å°±å˜æˆäº† 9ï¼Œå› æ­¤9ä¸ªç”¨æˆ·å°±å¯ä»¥åœ¨ $t_1$ æ—¶æ®µæŠŠä»–ä»¬çš„è‡ªè¡Œè½¦è¿˜åˆ° $s_1$ã€‚ç„¶è€Œï¼Œå› ä¸º $s_1$ ç¦» $s_3$ å¤ªè¿œï¼Œåœ¨å®Œæˆpicking upä¹‹åï¼Œè¿™è¾†ä¸‰è½®è½¦ä¸èƒ½åœ¨ $t_2$ æ—¶æ®µä¹‹å‰å°†5è¾†è‡ªè¡Œè½¦è¿é€åˆ°ç©ºç«™ç‚¹ $s_3$ï¼Œæ¥æœåŠ¡5ä½å³å°†åˆ°æ¥çš„ç§Ÿå®¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/dynamic-bike-reposition-a-spatio-temporal-reinforcement-learning-approach/Fig2.JPG"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Uncertainties in partical reposition.&lt;/strong&gt;&lt;/em&gt; åœ¨å®é™…çš„è°ƒåº¦è¿‡ç¨‹ä¸­æœ‰å¾ˆå¤šä¸ç¡®å®šå› ç´ ã€‚å°½ç®¡æˆ‘ä»¬å¯ä»¥é¢„æµ‹ç³»ç»Ÿçš„åŠ¨æ€ï¼Œæˆ‘ä»¬ä¸èƒ½ä¿è¯é¢„æµ‹ä¸å®é™…å®Œå…¨ä¸€æ ·ï¼Œå› ä¸ºæ¨¡å‹ä¼šæœ‰é”™è¯¯ä»¥åŠéšæœºå™ªå£°ã€‚æ­¤å¤–ï¼Œå®Œæˆä¸€æ¬¡è°ƒåº¦çš„æ—¶é—´ä¹Ÿæ˜¯ä¸åŒçš„ï¼Œæ¯”å¦‚ï¼Œä» $s_1$ è¿é€è½¦è¾†åˆ° $s_2$ ä»Šå¤©å¯èƒ½éœ€è¦10åˆ†é’Ÿï¼Œæ˜å¤©å¯èƒ½å°±è¦15åˆ†é’Ÿï¼Œå°½ç®¡æ–¹æ³•å¯èƒ½ä¸€æ ·ã€‚è¿™å¯èƒ½æ˜¯ç”±äºå˜åŒ–çš„å¤–éƒ¨å› ç´ å¯¼è‡´ï¼Œæ¯”å¦‚ï¼Œæ¶åŠ£çš„å¤©æ°”çŠ¶å†µä»¥åŠäº¤é€šçš„æ‹¥æŒ¤ç¨‹åº¦ï¼Œæˆ–æ˜¯éšæœºå™ªå£°ã€‚å› ä¸ºåŠ¨æ€è°ƒåº¦æ˜¯åœ¨ç³»ç»Ÿè¿è¡Œçš„æ—¶å€™å·¥ä½œçš„ï¼Œæ—¶é—´å¾ˆé‡è¦ï¼Œè¿™ä¹Ÿå¯ä»¥ä»ä¸Šé¢ä¸¤ä¸ªä¾‹å­çœ‹å‡ºæ¥ã€‚è¿™äº›ä¸ç¡®å®šå› ç´ ï¼Œè¿˜æœ‰é•¿æœŸå½±å“ï¼Œä½¿å¾—ä¼˜åŒ–æ¨¡å‹éå¸¸å¤æ‚ï¼Œç”šè‡³æ˜¯æ— æ³•å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªåŸºäºæ—¶ç©ºå¼ºåŒ–å­¦ä¹ çš„åŠ¨æ€è°ƒåº¦æ¨¡å‹æ¥è§£å†³è¿™ä¸‰ä¸ªæŒ‘æˆ˜ã€‚æˆ‘ä»¬çš„è´¡çŒ®å¯ä»¥å½’çº³ä¸º4ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªä¸¤æ­¥èšç±»ç®—æ³•ï¼Œç§°ä¸º Inter-Independent Inner-Balanceç®—æ³•ï¼Œç®€ç§° IIIBã€‚è¿™ä¸ªç®—æ³•é¦–å…ˆåœ¨ç³»ç»Ÿä¸­è¿­ä»£åœ°å°†ç‹¬ç«‹çš„ç«™ç‚¹èšç±»ç”Ÿæˆå°çš„åŠŸèƒ½åŒºåŸŸï¼Œä¿è¯æ¯ä¸ªåŒºåŸŸæ›´ç¨³å®šçš„ç§Ÿè½¦éœ€æ±‚ä»¥åŠè½¦è¾†ç§»åŠ¨æ¨¡å¼ã€‚å…¶æ¬¡ï¼Œè¿™ä¸ªç®—æ³•æ ¹æ®åŒºåŸŸé—´çš„ç§»åŠ¨ï¼Œå°†è¿™äº›åŒºåŸŸèšç±»æˆç»„ï¼Œä¿è¯æ¯ä¸ªç±»ç°‡æ˜¯ç±»å†…å¹³è¡¡ä¸”ç±»é—´ç‹¬ç«‹çš„ã€‚å°†æ•´ä¸ªç³»ç»Ÿåˆ†ä¸ºå„ä¸ªç±»ç°‡ï¼Œæå¤§åœ°å‡å°‘äº†é—®é¢˜çš„å¤æ‚ç¨‹åº¦ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬åŸºäºä¸¤ä¸ªé¢„æµ‹å™¨ç”Ÿæˆäº†ä¸€ä¸ªç³»ç»Ÿæ¨¡æ‹Ÿå™¨ã€‚ä¸€ä¸ªæ˜¯O-Modelï¼Œé€šè¿‡ä¸€ä¸ªåŸºäºç›¸ä¼¼åº¦çš„KNNæ¨¡å‹é¢„æµ‹æ¯ä¸ªåŒºåŸŸçš„ç§Ÿè½¦éœ€æ±‚ï¼Œè€ƒè™‘å¤æ‚çš„å½±å“å› ç´ ï¼Œè§£å†³äº†ä¸å¹³è¡¡æ ·æœ¬çš„é—®é¢˜ã€‚å¦ä¸€ä¸ªæ¨¡å‹æ˜¯I-Modelï¼Œé€šè¿‡ä¸€ä¸ªåŸºäºè½¦è¾†ç§»åŠ¨çš„æ¨æ–­æ–¹æ³•ï¼Œé¢„æµ‹æ¯ä¸ªåŒºåŸŸçš„è¿˜è½¦éœ€æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ—¶ç©ºå¼ºåŒ–å­¦ä¹ æ¨¡å‹ï¼ŒSTRLï¼Œä¸ºæ¯ä¸ªç±»ç°‡å­¦ä¹ ä¸€ä¸ªæœ€ä¼˜çš„ç±»å†…è°ƒåº¦ç­–ç•¥ã€‚STRLçš„çŠ¶æ€é€šè¿‡æ•è·ç³»ç»ŸåŠ¨æ€æ€§ä»¥åŠå®æ—¶çš„ä¸ç¡®å®šæ€§ä»”ç»†åœ°è®¾è®¡å‡ºæ¥ã€‚å› ä¸ºçŠ¶æ€ä»¥åŠè¡ŒåŠ¨ç©ºé—´å¾ˆå¤§ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œä¸ºæ¯ä¸ªSTRLä¼°è®¡æœ€ä¼˜çš„é•¿æœŸä»·å€¼å‡½æ•°ï¼Œé€šè¿‡è¿™ä¸ªå¯ä»¥æ¨æ–­å‡ºå®ƒçš„æœ€ä¼˜è°ƒåº¦ç­–ç•¥ã€‚é™¤äº†å°†æ¨¡å‹å®šä¹‰æˆå¤šæ™ºèƒ½ä½“çš„æ–¹å¼ï¼Œæˆ‘ä»¬è¿˜é€šè¿‡ä¸¤ä¸ªæ—¶ç©ºå‰ªæè§„åˆ™å‡å°‘äº†è®­ç»ƒçš„å¤æ‚åº¦ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬åœ¨Citi Biki 2016å¹´4æœˆåˆ°10æœˆçš„æ•°æ®é›†ä¸Šè¯æ˜äº†æˆ‘ä»¬çš„æ¨¡å‹æ¯”baselinesæ›´æœ‰æ•ˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="2-overview"&gt;2 OVERVIEW
&lt;/h1&gt;&lt;p&gt;è¿™éƒ¨åˆ†å®šä¹‰äº†ç¬¦å·ä»¥åŠç›¸å…³æœ¯è¯­&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/dynamic-bike-reposition-a-spatio-temporal-reinforcement-learning-approach/Table1.JPG"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;h2 id="21-preliminary"&gt;2.1 Preliminary
&lt;/h2&gt;&lt;p&gt;&lt;em&gt;Definition 1&lt;/em&gt; Transition. ä¸€ä¸ªç§»åŠ¨ $f_{ij} = (s_i, s_j, \tau_i, \tau_j)$ æ˜¯ä¸€è¾†è‡ªè¡Œè½¦çš„ä½¿ç”¨è®°å½•ï¼Œæè¿°äº†ä¸€è¾†è‡ªè¡Œè½¦ä»åœ°ç‚¹ $S_i$ åœ¨æ—¶åˆ» $\tau_i$ è¢«ç§Ÿç”¨ä»¥åŠåœ¨åœ°ç‚¹ $s_j$ æ—¶åˆ» $\tau_j$ è¿”è¿˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Definition 2&lt;/em&gt; Demand. æ—¶æ®µ $t$ çš„åœ°ç‚¹ $s_i$ çš„ç§Ÿç”¨éœ€æ±‚ $o_{i,t}$ æ˜¯æƒ³åœ¨ $s_i$ æ—¶æ®µ $t$ å†…ç§Ÿç”¨è‡ªè¡Œè½¦çš„é¡¾å®¢çš„ä¸ªæ•°ï¼ŒåŒ…æ‹¬æˆåŠŸä»¥åŠå¤±è´¥çš„ã€‚æ—¶æ®µ $t$ å†…åœ°ç‚¹ $s_i$ çš„è¿”è¿˜éœ€æ±‚ $r_{i,t}$çš„å®šä¹‰ç±»ä¼¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Definition 3&lt;/em&gt; Episode. ä¸€ä¸ªæ—¶æ®µ $E$ æ˜¯ä¸€å¤©çš„ä¸€ä¸ªé•¿æ—¶æ®µï¼Œåœ¨è¿™ä¸ªæ—¶æ®µä¸­ï¼Œæˆ‘ä»¬æƒ³æœ€å°åŒ–æ€»çš„å®¢æˆ·æµå¤±ã€‚æˆ‘ä»¬åœ¨3.1.2ä¸­è¯¦ç»†åœ°å®šä¹‰äº†æˆ‘ä»¬é—®é¢˜ä¸­çš„ Episodesï¼Œä¿è¯äº†ä¸€äº›çº¦æŸï¼Œè€Œä¸æ˜¯éšæœºé€‰å–çš„ã€‚&lt;/p&gt;
&lt;h2 id="22-framework"&gt;2.2 Framework
&lt;/h2&gt;&lt;p&gt;å¦‚å›¾3æ‰€ç¤ºï¼Œæˆ‘ä»¬çš„æ¨¡å‹åŒ…æ‹¬äº†ä¸€ä¸ªç¦»çº¿å­¦ä¹ è¿‡ç¨‹ä»¥åŠä¸€ä¸ªåœ¨çº¿è°ƒåº¦è¿‡ç¨‹ã€‚è¿™ä¸ªå­¦ä¹ è¿‡ç¨‹æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯IIIBèšç±»ç®—æ³•ï¼Œç³»ç»Ÿæ¨¡æ‹Ÿå™¨ç”Ÿæˆè¿‡ç¨‹ä»¥åŠæ¯ä¸ªç±»ç°‡çš„STRLæ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;IIIB Clustering Algorithm.&lt;/strong&gt;&lt;/em&gt; ä¸ºäº†è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç³»ç»Ÿå¾ˆå¤§ä¸”å¾ˆå¤æ‚ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªä¸¤æ­¥IIIBèšç±»ç®—æ³•ã€‚é¦–å…ˆå¯¹é‚£äº›ç›¸è¿‘ä¸”æœ‰ç›¸ä¼¼ç§»åŠ¨æ¨¡å¼çš„ç«™ç‚¹èšç±»ï¼Œåœ¨ç³»ç»Ÿä¸­ç”Ÿæˆå°çš„åŠŸèƒ½åŒºåŸŸã€‚ç„¶ååŸºäºä»–ä»¬åŒºåŸŸé—´çš„è¿ç§»è§„å¾‹ï¼Œå°†åŒºåŸŸèšç±»æˆç»„ã€‚ç»™æ¯ä¸ªç±»ç°‡åˆ†é…å¤šè¾†ä¸‰è½®è½¦å®Œæˆç±»ç°‡å†…åŒºåŸŸé—´çš„è°ƒåº¦ï¼Œè€Œä¸æ˜¯ç±»é—´çš„è‡ªè¡Œè½¦è°ƒåº¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Simulator Generation.&lt;/strong&gt;&lt;/em&gt; ä¸ºäº†è®­ç»ƒå’Œè¯„ä¼°è°ƒåº¦æ¨¡å‹ï¼Œæˆ‘ä»¬åŸºäºä¸¤ä¸ªé¢„æµ‹å™¨ç”Ÿæˆäº†ä¸€ä¸ªç³»ç»Ÿæ¨¡æ‹Ÿå™¨ï¼Œä¹Ÿå°±æ˜¯åˆ†åˆ«é¢„æµ‹æ¯ä¸ªåŒºåŸŸçš„ç§Ÿè½¦éœ€æ±‚å’Œè¿˜è½¦éœ€æ±‚çš„O-Modelå’ŒI-Modelã€‚å¯¹äºä¸€ä¸ªæŒ‡å®šçš„æ—¶æ®µï¼Œæ¯”å¦‚å‘¨å…­æ—©ä¸Š7ç‚¹åˆ°7ç‚¹åŠï¼Œæˆ‘ä»¬å…ˆæ ¹æ®å†å²çš„å¤©æ°”ç»Ÿè®¡ç»“æœç”Ÿæˆä¸€ä¸ªå¯èƒ½çš„å¤©æ°”çŠ¶å†µï¼Œæ¯”å¦‚æ™´å¤©ï¼Œç„¶åO-Modelé¢„æµ‹æ¯ä¸ªåŒºåŸŸå‘¨å…­æ—©ä¸Š7ç‚¹åˆ°7ç‚¹åŠæ™´å¤©çš„ç§Ÿè½¦éœ€æ±‚ã€‚åŸºäºè¿™äº›é¢„æµ‹ï¼Œæ¯ä¸ªåŒºåŸŸçš„ç§Ÿè½¦éœ€æ±‚ç”±æ³Šæ¾è¿‡ç¨‹æ¨¡æ‹Ÿã€‚æ¯æ¬¡ä¸€è¾†è‡ªè¡Œè½¦è¢«ç§Ÿç”¨ï¼ŒI-Modelå°±ä¼šä¼°è®¡å®ƒçš„ç›®çš„åœ°åŒºåŸŸä»¥åŠåˆ°è¾¾æ—¶é—´ï¼Œå¹¶ä¸”è¿½è¸ªå®ƒã€‚æ¯ä¸ªåŒºåŸŸçš„è¿˜è½¦äº‹ä»¶é€šè¿‡è¿ç»­åœ°æ£€æŸ¥è‡ªè¡Œè½¦æ˜¯å¦åˆ°è¾¾é‚£é‡Œæ¥ç”Ÿæˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;STRL Model.&lt;/strong&gt;&lt;/em&gt; æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªSTRLæ¨¡å‹ï¼Œå¯¹æ¯ä¸ªç±»ç°‡å­¦ä¹ ä¸€ä¸ªæœ€ä¼˜çš„ç±»å†…è°ƒåº¦æ–¹æ¡ˆã€‚æˆ‘ä»¬è¿™ä¸ªåŸºäºå¼ºåŒ–å­¦ä¹ çš„æ¨¡å‹æ˜¯å¤šæ™ºèƒ½ä½“å½¢å¼ã€‚æ¯æ¬¡ä¸€ä¸ªä¸‰è½®è½¦å®Œæˆå®ƒæœ€åçš„è°ƒåº¦ï¼Œå®ƒä¼šä¸ç­‰å¾…å…¶ä»–è°ƒåº¦çš„å®Œæˆï¼Œç´§æ¥ç€å¼€å§‹ä¸€ä¸ªç”±æ–¹æ¡ˆç”Ÿæˆçš„æ–°çš„è°ƒåº¦ã€‚æ–°çš„è°ƒåº¦åŸºäºå½“å‰çŠ¶æ€ç”Ÿæˆï¼Œè¿™ä¸ªè°ƒåº¦ä¼šå¾ˆä»”ç»†åœ°å®šä¹‰ï¼Œæ¥æ•è·ç³»ç»ŸåŠ¨æ€æ€§å’Œå®æ—¶çš„ä¸ç¡®å®šæ€§ã€‚ä¸€ä¸ªçŠ¶æ€åŒ…å«å¤šä¸ªå› ç´ ï¼Œå¦‚ï¼Œæ¯ä¸ªåŒºåŸŸå½“å‰è‡ªè¡Œè½¦å’Œè½¦åº“çš„å¯ç”¨æ€§ï¼›å®æ—¶é¢„æµ‹çš„ç§Ÿè½¦å’Œè¿˜è½¦éœ€æ±‚ï¼›ä¸‰è½®è½¦çš„çŠ¶æ€ï¼ŒåŒ…å«å®ƒè‡ªèº«çš„ä»¥åŠå…¶ä»–çš„ï¼›å½“å‰çš„æ—¶é—´ï¼Œç­‰ç­‰ã€‚æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œä¸ºæ¯ä¸ªSTRLä¼°è®¡æœ€ä¼˜çš„é•¿æœŸä»·å€¼å‡½æ•°ï¼Œé€šè¿‡è¿™ä¸ªæˆ‘ä»¬èƒ½æ¨å¯¼å‡ºæœ€ä¼˜çš„è°ƒåº¦ç­–ç•¥ã€‚ç½‘ç»œåœ¨ç³»ç»Ÿæ¨¡æ‹Ÿå™¨è¿­ä»£åœ°è®­ç»ƒå‡ºæ¥ï¼Œåœ¨å›¾3ä¸­ç”¨ç°è‰²é«˜äº®äº†å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/dynamic-bike-reposition-a-spatio-temporal-reinforcement-learning-approach/Fig3.JPG"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Online Reposition.&lt;/strong&gt;&lt;/em&gt; åœ¨å­¦ä¹ è¿‡ç¨‹ä¹‹åï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªç±»ç°‡ä¸Šä¼šè·å¾—ä¸€ä¸ªç¥ç»ç½‘ç»œã€‚åœ¨åœ¨çº¿è¿‡ç¨‹ä¸­ï¼Œå½“ä¸€ä¸ªä¸‰è½®è½¦éœ€è¦ä¸€ä¸ªæ–°çš„è°ƒåº¦æ—¶ï¼Œæˆ‘ä»¬å…ˆç¡®å®šå®ƒåœ¨å“ªä¸ªç±»ç°‡ä¸­ï¼Œé€šè¿‡Oæ¨¡å‹å’ŒIæ¨¡å‹ç”Ÿæˆå®ƒçš„å½“å‰çŠ¶æ€ã€‚ç„¶åï¼Œå¯¹åº”çš„ç½‘ç»œç»™å½“å‰çŠ¶æ€ä¸­æ¯ä¸ªå¯èƒ½çš„è°ƒåº¦ä¼°è®¡æœ€ä¼˜çš„é•¿æœŸä»·å€¼ã€‚é€‰æ‹©æœ€å¤§ä»·å€¼çš„è°ƒåº¦å¹¶è¿”å›ã€‚&lt;/p&gt;
&lt;h1 id="3-methodology"&gt;3 METHODOLOGY
&lt;/h1&gt;&lt;h2 id="31-iiib-clustering-algorithm"&gt;3.1 IIIB Clustering Algorithm
&lt;/h2&gt;&lt;h3 id="311-region-generation"&gt;3.1.1 Region Generation
&lt;/h3&gt;&lt;p&gt;å¦‚å›¾1. C)æ‰€ç¤ºçš„ä¾‹å­ï¼Œç«™ç‚¹é—´çš„éšæœºè¿ç§»ä½¿å¾—è½¦ç«™é—´çš„å•è½¦è°ƒåº¦ä¸æ˜¯é‚£ä¹ˆæœ‰æ„ä¹‰ï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦ä¿è¯åœ¨ $s_1$ æˆ– $s_2$ æˆ– $s_3$ æœ‰å¯ç”¨çš„è‡ªè¡Œè½¦ï¼Œåœ¨ $s_4$ æˆ– $s_5$ æˆ– $s_6$ æˆ– $s_7$ æœ‰å¯ç”¨çš„è½¦ä½ã€‚è€ƒè™‘æ¯ä¸ªç«™ç‚¹çš„è½¦è¾†å’Œè½¦ä½çš„å¯ç”¨æ€§ï¼Œä» $A$ åˆ° $B$ çš„ç”¨æˆ·å¯ä»¥é€‰æ‹©åœ¨å“ªé‡Œç§Ÿè½¦å¹¶ä¸”è¿˜è½¦ã€‚å—åˆ°è¿™ä¸ªç°è±¡çš„å¯å‘ï¼Œæˆ‘ä»¬å¯¹è¿™ä¸ªåŒºåŸŸå‘¨å›´çš„å‡ ä¸ªè½¦ç«™èšç±»ï¼Œå¯¹ç›®æ ‡åŒºåŸŸå‘¨å›´çš„è½¦ç«™è¿›è¡Œèšç±»ï¼Œç”Ÿæˆä¸¤ä¸ªå°çš„åŒºåŸŸï¼Œä¹Ÿå°±æ˜¯ $s_1$ï¼Œ$s_2$ å’Œ $s_3$ å½¢æˆäº†ä¸€ä¸ªåŒºåŸŸï¼Œ$s_4$ï¼Œ$s_5$ï¼Œ$s_6$ å’Œ $s_7$ å½¢æˆäº†å¦ä¸€ä¸ªåŒºåŸŸã€‚ç„¶åï¼Œæˆ‘ä»¬åªéœ€è¦ä¿è¯æ¯ä¸ªåŒºåŸŸè½¦è¾†å’Œè½¦ä½çš„å¯ç”¨æ€§å³å¯ã€‚æˆ‘ä»¬è®¤ä¸ºä¸€ä¸ªåŒºåŸŸçš„ç§Ÿè½¦éœ€æ±‚æ¯”ä¸€ä¸ªå•ç‹¬çš„è½¦ç«™æ›´ç¨³å®šï¼Œæ›´è§„å¾‹ï¼›è€Œä¸”ï¼Œä¸¤ä¸ªåŒºåŸŸé—´çš„è¿ç§»æ¯”ä¸¤ä¸ªç«™ç‚¹é—´çš„è¿ç§»æ›´é¢‘ç¹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ­£å¼åœ°é˜è¿°è¿™ä¸ªæƒ³æ³•ï¼Œæˆ‘ä»¬åŸºäºä¸¤ä¸ªçº¦æŸåœ¨ä¸€ä¸ªç³»ç»Ÿä¸­ç”Ÿæˆäº†ä¸€äº›åŒºåŸŸã€‚1) ä¸€ä¸ªåŒºåŸŸçš„ç«™ç‚¹åº”è¯¥å’Œå…¶ä»–çš„ç«™ç‚¹ç›¸è¿‘ï¼Œä¿è¯è¿™ä¸ªåŒºåŸŸå†…é¡¾å®¢çš„æ–¹ä¾¿ã€‚2) ä¸€ä¸ªåŒºåŸŸå†…çš„ç«™ç‚¹åº”è¯¥æœ‰ç›¸ä¼¼çš„ODåŒºåŸŸï¼Œä½¿å¾—åŒºåŸŸé—´çš„è¿ç§»æ›´ä¸“ä¸€ä¸”æ›´é¢‘ç¹ã€‚ç”Ÿæˆè¿™äº›çš„åŒºåŸŸçš„æ–¹æ³•æ˜¯ä¸€ä¸ªè¿­ä»£çš„æ–¹æ³•ï¼Œç§°ä¸ºäºŒéƒ¨èšç±»ç®—æ³•[2]ï¼Œè¿™ä¸ªç®—æ³•ä¼šåŸºäºè½¦ç«™çš„ä½ç½®å’Œè¿ç§»æ¨¡å¼è¿›è¡Œèšç±»ã€‚&lt;/p&gt;
&lt;p&gt;åŸºäºè·å¾—çš„è¿™äº›åŒºåŸŸï¼Œæˆ‘ä»¬åˆ†æäº† Citi Bike ä¸­å†å²çš„è½¦è¾†ä½¿ç”¨æ•°æ®ï¼Œè¯å®äº†ä¸Šè¿°çš„ä¸¤ä¸ªä¼˜åŠ¿ã€‚å¦‚å›¾1. A)åº•éƒ¨æ‰€ç¤ºï¼Œä¸€ä¸ªåŒºåŸŸçš„ç§Ÿè½¦éœ€æ±‚æ›´ç¨³å®šï¼Œæ›´è§„å¾‹ï¼Œå› æ­¤æ›´å®¹æ˜“åœ°ç²¾ç¡®é¢„æµ‹ã€‚éšæœºè¿ç§»çš„é—®é¢˜ä¹Ÿå¯ç”¨å¾—åˆ°è§£å†³ã€‚å›¾1. B)å³å›¾å±•ç¤ºäº†2016å¹´4æœˆåˆ°10æœˆå·¥ä½œæ—¥çš„æ—©ä¸ŠåŒºåŸŸé—´çš„é€šå‹¤ï¼Œå äº†56%ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå¾—åˆ°çš„åŒºåŸŸé—´è¿ç§»æ¨¡å¼æ›´ç®€å•ï¼Œä½¿å¾—è¿˜è½¦éœ€æ±‚é¢„æµ‹æ›´ç®€å•ä¸”æ›´ç²¾ç¡®ã€‚è¿™é‡Œè·å¾—çš„åŒºåŸŸå¯ç”¨çœ‹ä½œæ˜¯åŸå¸‚ä¸­å°çš„åŠŸèƒ½åŒºï¼Œæ¯”å¦‚å±…æ°‘åŒºå‘¨å›´çš„è½¦ç«™å¾ˆå¯èƒ½ç»„æˆä¸€ä¸ªåŒºåŸŸï¼Œè€Œåœ¨å·¥ä½œåŒºå‘¨å›´çš„å¯èƒ½å½¢æˆå¦ä¸€ä¸ªã€‚æˆ‘ä»¬å¯¹è¿™äº›åŒºåŸŸèšç±»æˆç»„ï¼Œè€Œä¸æ˜¯åœ¨æ•´ä¸ªç³»ç»Ÿä¸­çš„è¿™äº›å±ˆå±…é—´ç›´æ¥è°ƒåº¦ï¼Œè€Œä¸”å› ä¸ºä¸¤ä¸ªåŸå› ï¼Œæˆ‘ä»¬åªåœ¨ç±»ç°‡å†…å¼€å±•è°ƒåº¦ã€‚1) èšç±»å¯ç”¨è¿›ä¸€æ­¥å‡å°‘é—®é¢˜çš„å¤æ‚åº¦ã€‚2) å¸æœºä¸€èˆ¬åªå¯¹åŸå¸‚å†…çš„ä¸€ä¸ªåŒºåŸŸæ¯”è¾ƒç†Ÿæ‚‰ã€‚&lt;/p&gt;
&lt;h3 id="312-iiib-clustering-insight"&gt;3.1.2 IIIB Clustering Insight
&lt;/h3&gt;&lt;p&gt;è·å¾—åˆ°çš„ç±»ç°‡åº”è¯¥æœ‰ä¸¤ä¸ªæ€§è´¨ï¼Œæ¯ä¸ªç±»ç°‡çš„å†…éƒ¨å¹³è¡¡ä»¥åŠç±»ç°‡é—´çš„ç›¸äº’ä¾èµ–ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Inner-Balance.&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;</description></item><item><title>Convolutional LSTM Network: A Machine Learning Approach for Precipitation Nowcasting</title><link>https://davidham3.github.io/blog/p/convolutional-lstm-network-a-machine-learning-approach-for-precipitation-nowcasting/</link><pubDate>Thu, 27 Sep 2018 15:11:55 +0000</pubDate><guid>https://davidham3.github.io/blog/p/convolutional-lstm-network-a-machine-learning-approach-for-precipitation-nowcasting/</guid><description>&lt;p&gt;NIPS 2015. å°† FC-LSTM ä¸­çš„å…¨è¿æ¥æ¢æˆäº†å·ç§¯ï¼Œä¹Ÿå°±æ˜¯å°†æ™®é€šçš„æƒé‡ä¸çŸ©é˜µç›¸ä¹˜ï¼Œæ¢æˆäº†å·ç§¯æ ¸å¯¹è¾“å…¥å’Œéšè—çŠ¶æ€çš„å·ç§¯ï¼Œä¸ºäº†èƒ½æ•è·ç©ºé—´ä¿¡æ¯ï¼Œå°†è¾“å…¥å˜æˆäº†4ç»´çš„çŸ©é˜µï¼Œåä¸¤ç»´è¡¨ç¤ºç©ºé—´ä¿¡æ¯ã€‚ä¸¤ä¸ªæ•°æ®é›†ï¼šMoving-MNIST å’Œ é›·è¾¾äº‘å›¾æ•°æ®é›†ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1506.04214" target="_blank" rel="noopener"
&gt;Convolutional LSTM Network: A Machine Learning Approach for Precipitation Nowcasting&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;é™é›¨é‡é¢„æµ‹çš„ç›®æ ‡æ˜¯é¢„æµ‹æœªæ¥ä¸€ä¸ªå±€éƒ¨åŒºåŸŸå†ç›¸å¯¹çŸ­çš„ä¸€ä¸ªæ—¶é—´æ®µçš„é™é›¨å¯†åº¦ã€‚ä¹‹å‰å‡ ä¹æ²¡æœ‰ç ”ç©¶ä»æœºå™¨å­¦ä¹ è§’åº¦ç ”ç©¶è¿™ä¸ªé‡è¦è€Œä¸”å¾ˆæœ‰æŒ‘æˆ˜çš„é—®é¢˜ã€‚åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œæˆ‘ä»¬å°†é™é›¨é‡é¢„æµ‹é—®é¢˜å®šä¹‰æˆä¸€ä¸ªæ—¶ç©ºåºåˆ—é¢„æµ‹é—®é¢˜ï¼Œè¾“å…¥å’Œé¢„æµ‹éƒ½æ˜¯æ—¶ç©ºåºåˆ—ã€‚é€šè¿‡æ‰©å±• &lt;em&gt;fully connected LSTM&lt;/em&gt; (FC-LSTM)ï¼Œåœ¨è¾“å…¥åˆ°éšè—ä¸éšè—åˆ°éšè—çš„å˜æ¢éƒ½åŠ å…¥å·ç§¯ç»“æ„ï¼Œæˆ‘ä»¬æå‡ºäº† &lt;em&gt;convolutional LSTM&lt;/em&gt; (ConvLSTM)ï¼Œç”¨å®ƒåšäº†ä¸€ä¸ªç«¯åˆ°ç«¯çš„æ¨¡å‹æ¥é¢„æµ‹é™é›¨é‡ã€‚å®éªŒè¡¨æ˜æˆ‘ä»¬çš„ ConvLSTM ç½‘ç»œæ¯” FC-LSTM ä»¥åŠæœ€å…ˆè¿›çš„ ROVER ç®—æ³•åœ¨é™æ°´é‡é¢„æµ‹ä¸Šèƒ½æ›´å¥½åœ°æ•è·æ—¶ç©ºå…³ç³»ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1. Introduction
&lt;/h1&gt;&lt;h1 id="2-preliminaries"&gt;2. Preliminaries
&lt;/h1&gt;&lt;h2 id="21-forumulation-of-precipitation-nowcasting-problem"&gt;2.1 Forumulation of Precipitation Nowcasting Problem
&lt;/h2&gt;&lt;p&gt;é™æ°´é‡é¢„æµ‹çš„ç›®æ ‡æ˜¯ä½¿ç”¨ä¹‹å‰çš„é›·è¾¾å£°æ³¢åºåˆ—é¢„æµ‹ä¸€ä¸ªåŒºåŸŸï¼ˆå¦‚é¦™æ¸¯ã€çº½çº¦ã€ä¸œäº¬ï¼‰æœªæ¥å®šé•¿ï¼ˆæ—¶é—´ï¼‰çš„é›·è¾¾å›¾ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé›·è¾¾å›¾é€šå¸¸ä»æ°”å€™é›·è¾¾æ¯6åˆ°10åˆ†é’Ÿè·å¾—ä¸€æ¬¡ï¼Œç„¶åé¢„æµ‹æœªæ¥1åˆ°6å°æ—¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé¢„æµ‹6åˆ°60å¸§ã€‚ä»æœºå™¨å­¦ä¹ çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥çœ‹ä½œæ˜¯æ—¶ç©ºåºåˆ—é¢„æµ‹é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬åœ¨ä¸€ä¸ªç©ºé—´åŒºåŸŸè§‚æµ‹äº†ä¸€ä¸ªåŠ¨æ€ç³»ç»Ÿï¼Œç”±ä¸€ä¸ª $M \times N$ çš„ç½‘æ ¼ç»„æˆï¼Œ$M$ è¡Œ $N$ åˆ—ã€‚åœ¨ç½‘æ ¼çš„æ¯ä¸ªå•å…ƒæ ¼å†…éƒ¨éšç€æ—¶é—´çš„å˜åŒ–ï¼Œæœ‰ $P$ ä¸ªæµ‹é‡å€¼ã€‚å› æ­¤ï¼Œè§‚æµ‹å€¼åœ¨ä»»æ„æ—¶åˆ»å¯ä»¥è¡¨ç¤ºæˆä¸€ä¸ªå¼ é‡ $\mathcal{X} \in \mathbf{R}^{P \times M \times N}$ï¼Œå…¶ä¸­ $\mathbf{R}$ è¡¨ç¤ºè§‚æµ‹åˆ°çš„ç‰¹å¾çš„å®šä¹‰åŸŸã€‚å¦‚æœæˆ‘ä»¬å‘¨æœŸæ€§çš„è®°å½•è§‚æµ‹å€¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªåºåˆ— $\hat{\mathcal{X}_1}, \hat{\mathcal{X}_2}, &amp;hellip;, \hat{\mathcal{X}_t}$ã€‚è¿™ä¸ªæ—¶ç©ºåºåˆ—é¢„æµ‹é—®é¢˜æ˜¯ç»™å®šå‰ $J$ ä¸ªè§‚æµ‹å€¼ï¼Œé¢„æµ‹æœªæ¥é•¿åº¦ä¸º $K$ çš„åºåˆ—ï¼š&lt;/p&gt;
$$\tag{1}
\tilde{\mathcal{X}}\_{t+1}, ..., \tilde{\mathcal{X}}\_{t+K} = \mathop{\arg \max}\_{\mathcal{X}\_{t+1}, ...\mathcal{X}\_{t+K}} p(\mathcal{X}\_{t+1}, ..., \mathcal{X}\_{t+K} \mid \hat{\mathcal{X}}\_{t-J+1}, \hat{\mathcal{X}}\_{t-J+2}, ..., \hat{\mathcal{X}}\_t)
$$&lt;p&gt;å¯¹äºé™é›¨é‡é¢„æµ‹ï¼Œæ¯ä¸ªæ—¶é—´æˆ³çš„è§‚æµ‹å€¼æ˜¯ä¸€ä¸ª2Dé›·è¾¾åœ°å›¾ã€‚å¦‚æœæˆ‘ä»¬å°†åœ°å›¾åˆ†åˆ°å¹³é“ºä¸”ä¸é‡åˆçš„éƒ¨åˆ†ï¼Œå°†æ¯ä¸ªéƒ¨åˆ†å†…çš„åƒç´ çœ‹ä½œæ˜¯å®ƒçš„è§‚æµ‹å€¼ï¼ˆå›¾1ï¼‰ï¼Œé¢„æµ‹é—®é¢˜å°±ä¼šè‡ªç„¶åœ°å˜æˆä¸€ä¸ªæ—¶ç©ºåºåˆ—é¢„æµ‹é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/convolutional-lstm-network-a-machine-learning-approach-for-precipitation-nowcasting/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ³¨æ„åˆ°æˆ‘ä»¬çš„æ—¶ç©ºåºåˆ—é¢„æµ‹é—®é¢˜ä¸ä¸€æ­¥æ—¶é—´åºåˆ—é¢„æµ‹é—®é¢˜ä¸åŒï¼Œå› ä¸ºæˆ‘ä»¬é—®é¢˜çš„é¢„æµ‹ç›®æ ‡æ˜¯ä¸€ä¸ªåŒ…å«æ—¶é—´å’Œç©ºé—´ç»“æ„çš„åºåˆ—ã€‚å°½ç®¡é•¿åº¦ä¸º$K$çš„åºåˆ—ä¸­çš„è‡ªç”±å˜é‡çš„æ•°é‡å¯ä»¥è¾¾åˆ°$O(M^KN^KP^K)$ï¼Œå®é™…ä¸Šæˆ‘ä»¬å¯ä»¥æŒ–æ˜å¯èƒ½çš„é¢„æµ‹å€¼çš„ç©ºé—´ç»“æ„ï¼Œå‡å°ç»´åº¦ï¼Œä½¿é—®é¢˜å˜å¾—å®¹æ˜“å¤„ç†ã€‚&lt;/p&gt;
&lt;h2 id="22-long-short-term-memory-for-sequence-modeling"&gt;2.2 Long Short-Term Memory for Sequence Modeling
&lt;/h2&gt;&lt;p&gt;è¿™ç¯‡è®ºæ–‡ï¼Œæˆ‘ä»¬ä½¿ç”¨ FC-LSTM çš„å…¬å¼[11]&lt;/p&gt;
$$\tag{2}
\begin{aligned}
i\_t &amp;= \sigma ( W\_{xi} x\_t + W\_{hi} h\_{t-1} + W\_{ci} \circ c\_{t-1} + b\_i) \\
f\_t &amp;= \sigma ( W\_{xf} x\_t + W\_{hf} h\_{t-1} + W\_{cf} \circ c\_{t-1} + b\_f) \\
c\_t &amp;= f\_t \circ c\_{t-1} + i\_t \circ \mathrm{tanh}(W\_{xc} x\_t + W\_{hc} h\_{t-1} + b\_c) \\
o\_t &amp;= \sigma ( W\_{xo} x\_t + W\_{ho} h\_{t-1} + W\_{co} \circ c\_t + b\_o ) \\
h\_t &amp;= o\_t \circ \mathrm{tanh}(c\_t)
\end{aligned}
$$&lt;p&gt;å¤šä¸ª LSTM å¯ä»¥å †å ï¼Œå¯¹å¤æ‚çš„ç»“æ„åœ¨æ—¶é—´ä¸Šæ‹¼æ¥ã€‚&lt;/p&gt;
&lt;h1 id="3-the-model"&gt;3 The Model
&lt;/h1&gt;&lt;p&gt;å°½ç®¡ FC-LSTM å±‚å·²ç»åœ¨æ—¶é—´å…³ç³»ä¸Šè¡¨ç°çš„å¾ˆæœ‰æ•ˆäº†ï¼Œä½†æ˜¯åœ¨ç©ºé—´æ•°æ®ä¸Šæœ‰å¾ˆå¤šçš„å†—ä½™ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº† FC-LSTM çš„æ‰©å±•ï¼Œåœ¨è¾“å…¥åˆ°éšè—ï¼Œä»¥åŠéšè—åˆ°éšè—çš„å˜æ¢ä¸Šæœ‰äº†å·ç§¯çš„ç»“æ„ã€‚é€šè¿‡å †å å¤šä¸ª ConvLSTM å±‚ï¼Œå½¢æˆä¸€ä¸ª encoding-forecasting ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªä¸ä»…å¯ä»¥å¤„ç†é™é›¨é‡é¢„æµ‹é—®é¢˜ï¼Œè¿˜å¯ä»¥å¤„ç†æ›´ä¸€èˆ¬çš„æ—¶ç©ºåºåˆ—é¢„æµ‹é—®é¢˜çš„æ¨¡å‹ã€‚&lt;/p&gt;
&lt;h2 id="31-convolutional-lstm"&gt;3.1 Convolutional LSTM
&lt;/h2&gt;&lt;p&gt;FC-LSTM çš„ä¸»è¦é—®é¢˜æ˜¯å¤„ç†æ—¶ç©ºæ•°æ®çš„æ—¶å€™ï¼Œå®ƒçš„å…¨è¿æ¥å±‚æ²¡æœ‰å¯¹ç©ºé—´ä¿¡æ¯è¿›è¡Œç¼–ç ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬çš„è®¾è®¡ä¸­çš„ä¸€ä¸ªç‰¹å¾å°±æ˜¯ï¼Œæ‰€æœ‰çš„è¾“å…¥ $\mathcal{X}_1, &amp;hellip;, \mathcal{X}_t$ï¼Œç»†èƒçŠ¶æ€ $\mathcal{C}_1, &amp;hellip;, \mathcal{C}_t$ï¼Œéšè—çŠ¶æ€ $\mathcal{H}_1, &amp;hellip; \mathcal{H}_t$ï¼Œè¿˜æœ‰é—¨ $i_t, f_t, o_t$ éƒ½æ˜¯ä¸‰ç»´çš„å¼ é‡ï¼Œè€Œä¸”åä¸¤ç»´éƒ½æ˜¯ç©ºé—´ç»´ï¼ˆè¡Œå’Œåˆ—ï¼‰ã€‚ä¸ºäº†æ›´å¥½çš„ç†è§£è¾“å…¥å’ŒçŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬æƒ³è±¡æˆåœ¨ç©ºé—´ç½‘æ ¼ç«™ç«‹çš„å‘é‡ã€‚ConvLSTM é€šè¿‡è¾“å…¥å’Œå±€éƒ¨é‚»å±…çš„ä¸Šä¸€ä¸ªçŠ¶æ€å†³å®šäº†ä¸€ä¸ªç‰¹å®šç»†èƒçš„æœªæ¥çŠ¶æ€ã€‚é€šè¿‡åœ¨è¾“å…¥åˆ°éšè—ï¼Œéšè—åˆ°éšè—ä¸­ä½¿ç”¨ä¸€ä¸ªå·ç§¯æ“ä½œå™¨å°±å¯ä»¥è½»æ¾çš„å®ç°ï¼ˆå›¾2ï¼‰ã€‚ConvLSTMçš„é‡è¦çš„å…¬å¼å¦‚ï¼ˆ3ï¼‰æ‰€ç¤ºï¼ˆä¸‹é¢çš„å…¬å¼ï¼‰ï¼Œ$\ast$è¡¨ç¤ºå·ç§¯æ“ä½œï¼Œ$\circ$è¡¨ç¤ºHadamardç§¯ï¼š&lt;/p&gt;
$$\tag{3}
\begin{aligned}
i\_t &amp;= \sigma( W\_{xi} \ast \mathcal{X}\_t + W\_{hi} \ast \mathcal{H}\_{t-1} + W\_{ci} \circ \mathcal{C}\_{t-1} + b\_i )\\
f\_t &amp;= \sigma( W\_{xf} \ast \mathcal{X}\_t + W\_{hf} \ast \mathcal{H}\_{t-1} + W\_{cf} \circ \mathcal{C}\_{t-1} + b\_f )\\
\mathcal{C}\_t &amp;= f\_t \circ \mathcal{C}\_{t-1} + i\_t \circ \mathrm{tanh}(W\_{xc} \ast \mathcal{X}\_t + W\_{hc} \ast \mathcal{H}\_{t-1} + b\_c)\\
o\_t &amp;= \sigma( W\_{xo} \ast \mathcal{X}\_t + W\_{ho} \ast \mathcal{H}\_{t-1} + W\_{co} \circ \mathcal{C}\_t + b\_o )\\
\mathcal{H}\_t &amp;= o\_t \circ \mathrm{tanh}(\mathcal{C}\_t)
\end{aligned}
$$&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/convolutional-lstm-network-a-machine-learning-approach-for-precipitation-nowcasting/Fig2.JPG"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å°†çŠ¶æ€çœ‹ä½œæ˜¯ç§»åŠ¨ç‰©ä½“çš„éšè—è¡¨ç¤ºï¼Œå¸¦æœ‰ä¸€ä¸ªæ›´å¤§çš„å˜æ¢å·ç§¯æ ¸çš„ ConvLSTM åº”è¯¥èƒ½æ•è·æ›´å¿«çš„ç§»åŠ¨ï¼Œè€Œå°çš„æ ¸èƒ½æ•è·æ…¢çš„ç§»åŠ¨ã€‚åŒæ—¶ï¼Œå¦‚æœæˆ‘ä»¬ç”¨[16]çš„è§’åº¦æ¥çœ‹ï¼Œç”±å¼2è¡¨ç¤ºçš„ä¼ ç»Ÿçš„ FC-LSTM çš„è¾“å…¥ã€ç»†èƒè¾“å‡ºä»¥åŠéšè—çŠ¶æ€å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªåä¸¤ç»´éƒ½æ˜¯1çš„ä¸‰ç»´å¼ é‡ã€‚è¿™æ ·çš„è¯ï¼ŒFC-LSTMå®é™…ä¸Šæ˜¯æ‰€æœ‰ç‰¹å¾éƒ½ç«™ç«‹åœ¨ä¸€ä¸ªå•ç‹¬ç»†èƒä¸Š ConvLSTM çš„ä¸€ä¸ªç‰¹ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ç¡®ä¿çŠ¶æ€å’Œè¾“å…¥æœ‰ç›¸åŒä¸ªæ•°çš„è¡Œå’Œåˆ—ï¼Œéœ€è¦åœ¨å·ç§¯æ“ä½œä¹‹å‰åŠ å…¥ padding æ“ä½œã€‚è¿™é‡Œéšè—çŠ¶æ€åœ¨è¾¹ç•Œç‚¹çš„ padding å¯ä»¥çœ‹ä½œæ˜¯ä½¿ç”¨ &lt;em&gt;state of the outside world&lt;/em&gt; æ¥è®¡ç®—ã€‚é€šå¸¸ï¼Œåœ¨ç¬¬ä¸€ä¸ªè¾“å…¥æ¥ä¹‹å‰ï¼Œæˆ‘ä»¬å°† LSTM çš„æ‰€æœ‰çŠ¶æ€åˆå§‹åŒ–ä¸º0ï¼Œå¯¹åº”æœªæ¥çš„ â€œtotal ignoranceâ€ã€‚ç›¸ä¼¼åœ°ï¼Œå¦‚æœæˆ‘ä»¬åœ¨éšè—çŠ¶æ€ä¸Šç”¨ zero-paddingï¼Œæˆ‘ä»¬å®é™…ä¸Šå°† &lt;em&gt;state of the outside world&lt;/em&gt; è®¾å®šä¸º0ï¼Œè€Œä¸”å‡è®¾æ²¡æœ‰å…³äºå¤–éƒ¨çš„å…ˆéªŒçŸ¥è¯†ã€‚é€šè¿‡åœ¨çŠ¶æ€ä¸ŠåŠ  paddingï¼Œæˆ‘ä»¬å¯ä»¥ä¸åŒåœ°å¯¹å¾…è¾¹ç•Œç‚¹ï¼Œå¾ˆå¤šæ—¶å€™è¿™éƒ½æ˜¯æœ‰ç”¨çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬çš„ç³»ç»Ÿæ­£åœ¨è§‚æµ‹ä¸€ä¸ªè¢«å¢™ç¯ç»•çš„ç§»åŠ¨çš„çƒã€‚å°½ç®¡æˆ‘ä»¬ä¸èƒ½çœ‹åˆ°è¿™äº›å¢™ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡è§‚å¯Ÿçƒçš„ä¸€æ¬¡æ¬¡åå¼¹æ¨æµ‹å®ƒä»¬çš„å­˜åœ¨ï¼Œå¦‚æœè¾¹ç•Œç‚¹åƒå†…éƒ¨çš„ç‚¹ä¸€æ ·æœ‰ç›¸åŒçš„çŠ¶æ€å˜åŒ–åŠ¨æ€æ€§ï¼Œé‚£è¿™å°±å‡ ä¹ä¸å¯èƒ½äº†ã€‚&lt;/p&gt;
&lt;h2 id="32-encoding-forecasting-structure"&gt;3.2 Encoding-Forecasting Structure
&lt;/h2&gt;&lt;p&gt;å°±åƒ FC-LSTMï¼ŒConvLSTM å¯ä»¥ä½¿ç”¨å—å¯¹å¤æ‚çš„ç»“æ„å»ºæ¨¡ã€‚å¯¹äºæˆ‘ä»¬çš„æ—¶ç©ºåºåˆ—é¢„æµ‹é—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨å›¾3è¿™æ ·çš„ç»“æ„ï¼Œç”±ä¸¤ä¸ªç½‘ç»œç»„æˆï¼Œä¸€ä¸ªç¼–ç ç½‘ç»œï¼Œä¸€ä¸ªé¢„æµ‹ç½‘ç»œã€‚å°±åƒ[21]ï¼Œé¢„æµ‹ç½‘ç»œçš„åˆå§‹çŠ¶æ€å’Œç»†èƒè¾“å‡ºä»ç¼–ç ç½‘ç»œçš„æœ€åä¸€ä¸ªçŠ¶æ€å¤åˆ¶è¿‡æ¥ã€‚ä¸¤ä¸ªç½‘ç»œéƒ½é€šè¿‡å †å å¤šä¸ª ConvLSTM å±‚æ„æˆã€‚å› ä¸ºæˆ‘ä»¬çš„é¢„æµ‹ç›®æ ‡ä¸è¾“å…¥çš„ç»´åº¦ç›¸åŒï¼Œæˆ‘ä»¬å°†é¢„æµ‹ç½‘ç»œæ‰€æœ‰çš„çŠ¶æ€æ‹¼æ¥ï¼Œæ”¾åˆ°ä¸€ä¸ª $1 \times 1$ çš„å·ç§¯å±‚ä¸­ï¼Œç”Ÿæˆæœ€åçš„é¢„æµ‹ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/convolutional-lstm-network-a-machine-learning-approach-for-precipitation-nowcasting/Fig3.JPG"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨åƒ[23]ä¸€æ ·çš„è§‚ç‚¹è§£é‡Šè¿™ä¸ªç»“æ„ã€‚ç¼–ç  LSTM å°†æ•´ä¸ªè¾“å…¥åºåˆ—å‹ç¼©åˆ°ä¸€ä¸ªéšè—çŠ¶æ€çš„å¼ é‡ä¸­ï¼Œé¢„æµ‹ LSTM è§£å‹äº†è¿™ä¸ªçŠ¶æ€ï¼Œç»™å‡ºäº†æœ€åçš„é¢„æµ‹ï¼š&lt;/p&gt;
$$\tag{4}
\begin{aligned}
\tilde{\mathcal{X}\_{t+1}}, ..., \tilde{\mathcal{X}\_{t+K}} &amp;= \mathop{\arg \max}\_{\mathcal{X}\_{t+1}, ..., \mathcal{X}\_{t+K}} p(\mathcal{X}\_{t+1}, ..., \mathcal{X}\_{t+K} \mid \hat{\mathcal{X}}\_{t-J+1}, \hat{\mathcal{X}}\_{t-J+2}, ..., \hat{\mathcal{X}}\_t) \\
&amp;\approx \mathop{\arg \max}\_{\mathcal{X}\_{t+1}, ..., \mathcal{X}\_{t+K}} p(\mathcal{X}\_{t+1}, ..., \mathcal{X}\_{t+K} \mid f\_{encoding} (\hat{\mathcal{X}}\_{t-J+1}, \hat{\mathcal{X}}\_{t-J+2}, ..., \hat{\mathcal{X}}\_t)) \\
&amp;\approx g\_{forecasting}(f\_{encoding}(\hat{\mathcal{X}}\_{t-J+1}, \hat{\mathcal{X}}\_{t-J+2}, ..., \hat{\mathcal{X}}\_t))
\end{aligned}
$$&lt;p&gt;è¿™ä¸ªç»“æ„ä¸[21]ä¸­çš„ LSTM æœªæ¥é¢„æµ‹æ¨¡å‹ç›¸ä¼¼ï¼Œé™¤äº†æˆ‘ä»¬çš„è¾“å…¥å’Œè¾“å‡ºå…ƒç´ éƒ½æ˜¯ä¸‰ç»´çš„å¼ é‡ï¼Œä¿ç•™äº†æ‰€æœ‰çš„ç©ºé—´ä¿¡æ¯ã€‚å› ä¸ºç½‘ç»œå †å äº†å¤šä¸ª ConvLSTM å±‚ï¼Œå®ƒç”±å¾ˆå¼ºçš„è¡¨ç¤ºèƒ½åŠ›å¯ä»¥åœ¨å¤æ‚çš„åŠ¨æ€ç³»ç»Ÿä¸­ç»™å‡ºé¢„æµ‹ï¼Œå¦‚é™é›¨é‡é¢„æµ‹é—®é¢˜ã€‚&lt;/p&gt;
&lt;h1 id="4-experiments"&gt;4. Experiments
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬å°†æˆ‘ä»¬çš„æ¨¡å‹ ConvLSTM ä¸ FC-LSTM åœ¨ä¸€ä¸ªäººå·¥ç”Ÿæˆçš„ Moving-MNIST æ•°æ®é›†ä¸Šåšäº†å¯¹æ¯”ï¼Œå¯¹æˆ‘ä»¬çš„æ¨¡å‹è¿›è¡Œä¸€ä¸ªåˆæ­¥çš„äº†è§£ã€‚æˆ‘ä»¬ä½¿ç”¨äº†ä¸åŒçš„å±‚æ•°ä»¥åŠä¸åŒçš„å·ç§¯æ ¸å¤§å°ï¼Œä¹Ÿç ”ç©¶äº†ä¸€äº› &amp;ldquo;out-of-domain&amp;rdquo; çš„æƒ…å†µï¼Œå¦‚[21]ã€‚ä¸ºäº†éªŒè¯æˆ‘ä»¬çš„æ¨¡å‹åœ¨æ›´æœ‰æŒ‘æˆ˜çš„é™é›¨é‡é¢„æµ‹é—®é¢˜ä¸Šçš„æœ‰æ•ˆæ€§ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªæ–°çš„é›·è¾¾å£°æ³¢å›¾ï¼Œåœ¨å‡ ä¸ªé™é›¨é‡é¢„æµ‹çš„æŒ‡æ ‡ä¸Šï¼Œæ¯”è¾ƒäº†æˆ‘ä»¬çš„æ¨¡å‹å’Œå½“å‰æœ€å…ˆè¿›çš„ ROVER ç®—æ³•ã€‚ç»“æœæ˜¾ç¤ºè¿™ä¸¤ä¸ªæ•°æ®é›†ä¸Šï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ConvLSTM æ¯” FC-LSTM åœ¨å¤„ç†æ—¶ç©ºå…³ç³»æ—¶æ›´å¥½&lt;/li&gt;
&lt;li&gt;éšè—çŠ¶æ€åˆ°éšè—çŠ¶æ€çš„å·ç§¯æ ¸çš„å°ºå¯¸å¤§äº1å¯¹äºæ•è·æ—¶ç©ºè¿åŠ¨æ¨¡å¼æ¥è¯´å¾ˆé‡è¦&lt;/li&gt;
&lt;li&gt;æ·±ã€ä¸”å‚æ•°å°‘çš„æ¨¡å‹èƒ½ç”Ÿæˆæ›´å¥½çš„ç»“æœ&lt;/li&gt;
&lt;li&gt;ConvLSTM æ¯” ROVER åœ¨é™é›¨é‡é¢„æµ‹ä¸Šè¡¨ç°çš„æ›´å¥½ã€‚&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>Pixie: A System for Recommending 3+ Billion Items to 200+ Million Users in Real-Time</title><link>https://davidham3.github.io/blog/p/pixie-a-system-for-recommending-3-billion-items-to-200-million-users-in-real-time/</link><pubDate>Fri, 21 Sep 2018 10:46:01 +0000</pubDate><guid>https://davidham3.github.io/blog/p/pixie-a-system-for-recommending-3-billion-items-to-200-million-users-in-real-time/</guid><description>&lt;p&gt;WWW 2018. å¯¹éšæœºæ¸¸èµ°è¿›è¡Œäº†æ”¹è¿›ï¼Œæå‡ºäº†Pixieéšæœºæ¸¸èµ°ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæœ‰åçš„éšæœºæ¸¸èµ°ï¼Œæ ¹æ®ç›¸ä¼¼åº¦è¿›è¡Œåç¦»ï¼Œä»è€Œå®ç°ä¸ªæ€§åŒ–æ¨èï¼Œè€Œä¸”ä½¿ç”¨äº†æ—©åœç­–ç•¥ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1711.07601" target="_blank" rel="noopener"
&gt;Pixie: A System for Recommending 3+ Billion Items to 200+ Million Users in Real-Time&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;ç°ä»£å†…å®¹æŒ–æ˜åº”ç”¨ä¸­ï¼Œç”¨æˆ·ä½“éªŒä¾èµ–äºé«˜è´¨é‡çš„ä¸ªæ€§åŒ–æ¨èã€‚ä½†æ˜¯æ„å»ºä¸€ä¸ªèƒ½æä¾›è¿™ç§æ¨èçš„ç³»ç»Ÿç”±äºå•†å“å’Œç”¨æˆ·çš„æ•°é‡å¤ªå¤§ï¼Œä»¥åŠæ¨èç»“æœéœ€è¦å¯¹ç”¨æˆ·çš„å®æ—¶æ“ä½œè¿›è¡Œå“åº”ç­‰é—®é¢˜å˜å¾—æ¯”è¾ƒå›°éš¾ã€‚æˆ‘ä»¬æå‡ºäº†Pixieï¼Œä¸€ä¸ªåŸºäºå›¾çš„ï¼Œå¯æ‰©å±•çš„å®æ—¶æ¨èç³»ç»Ÿï¼Œéƒ¨ç½²åœ¨äº†Pinterestä¸Šã€‚ç»™å®šä¸€ç»„ç”¨æˆ·æŒ‡å®šçš„pinsä½œä¸ºæŸ¥è¯¢ï¼ŒPixieä¼šå®æ—¶åœ°ä»åäº¿ä¸ªå¯èƒ½çš„pinsä¸­é€‰æ‹©é‚£äº›ä¸æŸ¥è¯¢çš„queryæœ€ç›¸å…³çš„pinsã€‚æˆ‘ä»¬ä½¿ç”¨Pixieéšæœºæ¸¸èµ°ç®—æ³•ï¼Œåˆ©ç”¨Pinterestå›¾ä¸­çš„30äº¿ä¸ªé¡¶ç‚¹ä»¥åŠ170äº¿æ¡è¾¹æ¥ç”Ÿæˆæ¨èã€‚å®éªŒè¡¨æ˜ï¼Œæˆ‘ä»¬çš„ç®—æ³•å¯¹æ¯”ä¹‹å‰åŸºäºhadoopçš„æ¨èç³»ç»Ÿï¼Œæå‡äº†50%ä»¥ä¸Šçš„user engagementã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ç§å›¾å‰ªæç­–ç•¥ä½¿å¾—æ¨èæ€§èƒ½æå‡äº†58%ã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨ç³»ç»Ÿå±‚é¢ä¸Šè®¨è®ºäº†Pixieï¼Œå•å°æœåŠ¡å™¨æ¯ç§’åœ¨å»¶æ—¶60æ¯«ç§’çš„æƒ…å†µä¸‹å¯ä»¥å¤„ç†1200ä¸ªæ¨èè¯·æ±‚ã€‚ç°åœ¨ï¼Œè¿™ä¸ªç³»ç»Ÿä¸ºPinterestæä¾›äº†è¶…è¿‡80%çš„è´¡çŒ®ã€‚&lt;/p&gt;
&lt;h1 id="related-work"&gt;Related Work
&lt;/h1&gt;&lt;p&gt;æ¨èç³»ç»Ÿæ˜¯ä¸€ä¸ªå¤§ä¸”ç»å……åˆ†ç ”ç©¶çš„ç ”ç©¶é¢†åŸŸã€‚æˆ‘ä»¬æ€»ç»“äº†ä»¥ä¸‹ç›¸å…³å·¥ä½œï¼Œèšç„¦äºå¤§è§„æ¨¡çš„å·¥ä¸šç•Œæ¨èç³»ç»Ÿã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Web-scale recommender systems.&lt;/strong&gt; ä¸€äº›åŸºäºwebçš„ç”Ÿäº§ç³»ç»Ÿåˆšæ‰å·²ç»æåˆ°äº†[1, 7, 21]ã€‚ä¸åƒPixieï¼Œä»–ä»¬ä¸æ˜¯å®æ—¶çš„ï¼Œä»–ä»¬çš„æ¨èç»“æœéƒ½æ˜¯æå‰è®¡ç®—å‡ºæ¥çš„ã€‚å®é™…ä¸­ï¼Œå“åº”æ—¶é—´å°äº100æ¯«ç§’çš„å°±å¯ä»¥ç®—ä½œæ˜¯å®æ—¶ï¼Œå› ä¸ºè¿™æ ·çš„ç³»ç»Ÿå¯ä»¥å’Œå®æ—¶çš„æœåŠ¡æµç›¸ç»“åˆã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æ¨èä¸€ä¸ªç»“æœéœ€è¦1ç§’é’Ÿï¼Œç”¨æˆ·å°±å¾—ç­‰å¤ªé•¿çš„æ—¶é—´äº†ã€‚è¿™äº›ç³»ç»Ÿçš„æ¨èç»“æœéƒ½æ˜¯æå‰è®¡ç®—å‡ºæ¥çš„ï¼Œæ¯”å¦‚æå‰ä¸€å¤©ï¼Œç„¶åå­˜å‚¨æˆkey-valueå¯¹ã€‚ä½†è€æ—§çš„æ¨èç³»ç»Ÿéƒ½ä¸æ€ä¹ˆå¥½ã€‚å®æ—¶æ¨èç³»ç»Ÿå› ä¸ºå®ƒèƒ½å¯¹ç”¨æˆ·çš„ååº”å®æ—¶çš„ååº”ï¼Œæ‰€ä»¥å˜å¾—å¾ˆé‡è¦ã€‚å¯¹ç”¨æˆ·è¡Œä¸ºçš„å®æ—¶ååº”å¯ä»¥æä¾›æ›´å¥½çš„æ¨èç»“æœã€‚æˆ‘ä»¬çš„å®éªŒè¡¨æ˜å®æ—¶æ¨èç³»ç»Ÿè¡¨ç°çš„æ¯”éœ€è¦å‡ å¤©æˆ–å‡ ä¸ªå°æ—¶æ‰èƒ½æ›´æ–°çš„æ¨èç³»ç»Ÿå¥½30-50%ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä»–çš„å®æ—¶æ¨èç³»ç»ŸåŒ…æ‹¬æ–°é—»æ¨è[9, 26]ã€‚ç„¶è€Œï¼Œè¿™æ ·çš„ç³»ç»Ÿåªæ¨èæœ€æ–°çš„å†…å®¹ã€‚æˆ‘ä»¬è¿™é‡Œçš„ä¸»è¦å·®åˆ«æ˜¯è§„æ¨¡ï¼ŒPinterestçš„ç›®å½•æ¯”ä¼ ç»Ÿçš„æ¨èç³»ç»Ÿå¤šäº†1000å€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Random-walk-based approaches.&lt;/strong&gt; å¾ˆå¤šç®—æ³•ä½¿ç”¨éšæœºæ¸¸èµ°åˆ©ç”¨å›¾ç»“æ„è¿›è¡Œæ¨è[2, 3, 28]ã€‚æˆ–è®¸ï¼Œæˆ‘ä»¬çš„å·¥ä½œå’ŒTwiiterçš„&amp;quot;who to follow&amp;quot;ç³»ç»Ÿæœ€ç›¸è¿‘[14, 15]ï¼Œå®ƒä»¬çš„ç³»ç»Ÿå°†æ•´ä¸ªå›¾æ”¾åˆ°ä¸€å°æœºå™¨ä¸­ï¼Œè¿è¡Œä¸€ä¸ªä¸ªæ€§åŒ–çš„SALSAç®—æ³•[19]ã€‚è¿™äº›è’™ç‰¹å¡æ´›æ–¹æ³•è€ƒè™‘äº†ä¸€ä¸ªé¡¶ç‚¹ç›¸å¯¹äºå…¶ä»–é¡¶ç‚¹çš„é‡è¦æ€§ï¼Œæ¨èç»“æœä¼šæ ¹æ®è¿™äº›åˆ†æ•°ç”Ÿæˆ[13]ã€‚æˆ‘ä»¬å¼€å‘äº†ä¸€ç§æ–°çš„éšæœºæ¸¸èµ°æ–¹æ³•ï¼Œæ›´å¿«ï¼Œæ•ˆæœæ›´å¥½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Traditional collaborative filtering approaches.&lt;/strong&gt; æ›´ä¸€èˆ¬åœ°æ¥è®²ï¼Œæˆ‘ä»¬çš„æ–¹æ³•ä¸ååŒè¿‡æ»¤ç›¸å…³ï¼ŒååŒè¿‡æ»¤é€šè¿‡æŒ–æ˜ç”¨æˆ·å›¾å’Œå•†å“å›¾ä¹‹é—´çš„äº¤é›†éƒ¨åˆ†ï¼ŒåŒ¹é…ç”¨æˆ·ä¸ç›¸ä¼¼çš„å•†å“åå¥½æ¥ç”Ÿæˆæ¨èç»“æœã€‚ç³»ç»Ÿè¿‡æ»¤ä¾èµ–äºç”¨æˆ·-å•†å“çŸ©é˜µçš„çŸ©é˜µåˆ†è§£ï¼Œç”Ÿæˆè¡¨ç¤ºç”¨æˆ·å’Œå•†å“çš„éšå‘é‡[16, 17, 25, 30]ã€‚ç„¶è€Œï¼ŒåŸºäºçŸ©é˜µåˆ†è§£çš„ååŒè¿‡æ»¤ç®—æ³•çš„æ—¶é—´ä¸ç©ºé—´å¤æ‚åº¦æœ€ä½æ˜¯ç”¨æˆ·-å•†å“å›¾ä¸­é¡¶ç‚¹æ•°çš„çº¿æ€§å…³ç³»ï¼Œä½¿å¾—ä½¿ç”¨è¿™äº›ç®—æ³•åœ¨æ•°åäº¿çš„å•†å“ä»¥åŠç™¾äº¿ç”¨æˆ·çš„é—®é¢˜ä¸Šå˜å¾—å¾ˆæœ‰æŒ‘æˆ˜ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæˆ‘ä»¬çš„éšæœºæ¸¸èµ°æ¨èç®—æ³•ä¸æ•°æ®é›†çš„å¤§å°æ— å…³ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Content-based methods.&lt;/strong&gt; åœ¨çº¯åŸºäºå†…å®¹çš„æ¨èç³»ç»Ÿä¸­ï¼Œå¯¹å•†å“çš„è¡¨ç¤ºåªä¾èµ–äºå®ƒä»¬çš„å†…å®¹ç‰¹å¾[24]ã€‚è®¸å¤šå…ˆè¿›çš„å¤§è§„æ¨¡æ¨èç³»ç»Ÿæ˜¯åŸºäºå†…å®¹çš„ï¼Œç»å¸¸ä½¿ç”¨æ·±åº¦ç¥ç»ç½‘ç»œ[6, 8, 11, 29]ã€‚å°½ç®¡è¿™äº›ç®—æ³•å‡­å€Ÿç€å‚æ•°ç©ºé—´çš„ç»´åº¦åªä¾èµ–äºç‰¹å¾ç©ºé—´çš„ç»´åº¦ï¼Œèƒ½æ‰©å±•åˆ°å¤§çš„æ•°æ®é›†ä¸Šï¼Œè¿™äº›æ–¹æ³•å¹¶ä¸èƒ½åˆ©ç”¨å›¾ç»“æ„çš„ä¿¡æ¯ï¼Œè€Œè¿™ç‚¹ï¼ˆå›¾ç»“æ„ä¿¡æ¯ï¼‰å¯¹Pinterestå¾ˆé‡è¦ã€‚&lt;/p&gt;
&lt;h1 id="3-proposed-method"&gt;3. Proposed Method
&lt;/h1&gt;&lt;p&gt;Pinterestæ˜¯ä¸€ä¸ªç”¨æˆ·ä¸pinsäº¤äº’çš„å¹³å°ã€‚ç”¨æˆ·å¯ä»¥ä¿å­˜ç›¸å…³çš„pinsåˆ°boardä¸­ã€‚è¿™äº›boardæ˜¯ç›¸ä¼¼pinsçš„é›†åˆä½“ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªç”¨æˆ·å¯ä»¥åˆ›å»ºä¸€ä¸ªå…³äºé£Ÿè°±çš„boardï¼Œå°†é£Ÿç‰©ç›¸å…³çš„pinsæ”¾è¿›å»ã€‚Pinterestå¯ä»¥çœ‹ä½œæ˜¯ä¸€äº›boardsï¼Œæ¯ä¸ªboardæ˜¯ä¸€ç»„pinsï¼Œæ¯ä¸ªpinåˆç»„æˆäº†æˆåƒä¸Šä¸‡ä¸åŒçš„boardsã€‚å½¢å¼åŒ–æ¥è¯´ï¼ŒPinterestå¯ä»¥ç»„æˆä¸€ä¸ªæ— å‘äºŒåˆ†å›¾ $G = (P, B, E)^2$ ã€‚å…¶ä¸­ï¼Œ$P$ è¡¨ç¤ºä¸€ç»„pinsï¼Œ$B$ è¡¨ç¤ºboardsçš„é›†åˆã€‚é›†åˆ $P \cup B$æ˜¯ $G$ çš„é¡¶ç‚¹é›†ã€‚å¦‚æœç”¨æˆ· $p$ ä¿å­˜äº† $b$ï¼Œé‚£ä¹ˆåœ¨pin $p \in P$ ä¸ board $b \in B$ ä¹‹é—´å°±æœ‰ä¸€æ¡è¾¹ $e \in E$ã€‚æˆ‘ä»¬ä½¿ç”¨ $E(p)$ è¡¨ç¤ºè¿æ¥åˆ°pin $p$ çš„boardé¡¶ç‚¹ï¼Œ$E(b)$ è¡¨ç¤ºè¿æ¥åˆ° $b$ çš„pinsã€‚æˆ‘ä»¬è®¤ä¸ºå›¾ $G$ æ˜¯è¿é€šçš„ï¼Œåœ¨å®é™…ä¸­ä¹Ÿæ˜¯è¿™æ ·çš„ã€‚&lt;/p&gt;
&lt;p&gt;Pixieæ¥å—çš„è¾“å…¥æ˜¯ä¸€ç»„å¸¦æƒçš„pins $Q = \lbrace (q, w_q) \rbrace$ï¼Œå…¶ä¸­ $q$ æ˜¯æŸ¥è¯¢çš„pinï¼Œ$w_q$æ˜¯åœ¨æŸ¥è¯¢é›†åˆä¸­çš„é‡è¦åº¦ã€‚æŸ¥è¯¢é›†åˆ $Q$ æ˜¯ç”¨æˆ·æŒ‡å®šçš„ï¼Œå¹¶ä¸”åœ¨æ¯æ¬¡ç”¨æˆ·çš„è¡Œä¸ºååŠ¨æ€ç”Ÿæˆçš„ï¼Œæœ€è¿‘æ“ä½œçš„pinsæœ‰é«˜çš„æƒé‡ï¼Œéšç€æ—¶é—´çš„å¢é•¿ï¼Œæƒé‡ä¼šé™ä½ã€‚ç»™å®šæŸ¥è¯¢ $Q$ Pixieä¼šé€šè¿‡æ¨¡æ‹Ÿæ–°å¼çš„æœ‰é‡å¯çš„æœ‰åéšæœºæ¸¸èµ°æ¥ç”Ÿæˆæ¨èç»“æœã€‚&lt;/p&gt;
&lt;h1 id="31-pixie-random-walk"&gt;3.1 Pixie Random Walk
&lt;/h1&gt;&lt;p&gt;ä¸ºäº†æ›´å¥½çš„è§£é‡ŠPixieï¼Œæˆ‘ä»¬é¦–å…ˆè§£é‡Šæœ€ç®€å•çš„éšæœºæ¸¸èµ°ï¼Œç„¶åè®¨è®ºå¦‚ä½•å°†å®ƒæ‰©å±•åˆ°Pixesä½¿ç”¨çš„æ–°çš„éšæœºæ¸¸èµ°ç®—æ³•ä¸Šã€‚æ‰€æœ‰åŸºäºåŸºæœ¬éšæœºæ¸¸èµ°çš„åˆ›æ–°å¯¹äºPixieæå‡æ€§èƒ½æ¥è¯´éƒ½æ˜¯è‡³å…³é‡è¦çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Basic Random Walk.&lt;/strong&gt; è€ƒè™‘ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œç”¨æˆ·æŒ‡å®šäº†æŸ¥è¯¢ $Q$ï¼ŒåŒ…å«ä¸€ä¸ªpin $q$ã€‚ç»™å®šä¸€ä¸ªè¾“å…¥pin $q$ï¼Œå¯ä»¥åœ¨ $G$ ä¸Šæ¨¡æ‹Ÿå‡ºå¾ˆå¤šçŸ­çš„éšæœºæ¸¸èµ°ï¼Œéƒ½æ˜¯ä» $q$ å¼€å§‹çš„ï¼Œè®°å½•æ¯ä¸ªpin $p$ çš„è®¿é—®æ¬¡æ•°(visit count)ï¼Œè¡¨ç¤ºéšæœºæ¸¸èµ°è®¿é—®åˆ° $p$ çš„æ¬¡æ•°ã€‚å¦‚æœä¸€ä¸ªpinè¢«è®¿é—®çš„æ¬¡æ•°è¶Šå¤šï¼Œé‚£ä¹ˆè¿™ä¸ª $q$ å°±å’Œå®ƒè¶Šç›¸å…³ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ç®—æ³•1ä¸­æè¿°äº†æœ€åŸºæœ¬çš„éšæœºæ¸¸èµ° $\rm BASICRANDOMWALK$ [28]ã€‚æ¯ä¸ªéšæœºæ¸¸èµ°ç”Ÿæˆäº†ä¸€ä¸ª &lt;em&gt;steps&lt;/em&gt; çš„åºåˆ—ã€‚æ¯ä¸ª step ç”±3ä¸ªæ“ä½œç»„æˆã€‚é¦–å…ˆï¼Œç»™å®šå½“å‰pin $p$ï¼Œ(åˆå§‹ä¸º $q$ )ï¼Œæˆ‘ä»¬ä» $E(p)$ ä¸­é€‰æ‹©ä¸€æ¡è¿æ¥ $q$ å’Œ $b$ çš„è¾¹ $e$ã€‚ç„¶åæˆ‘ä»¬é€šè¿‡ä» $E(b)$ ä¸­é‡‡æ ·ä¸€æ¡è¿æ¥ $b$ å’Œ $p&amp;rsquo;$ çš„ä¸€æ¡è¾¹ï¼Œå¾—åˆ°pin $pin&amp;rsquo;$ã€‚ç¬¬ä¸‰æ­¥ï¼Œå½“å‰çš„pinæ›´æ–°åˆ° $p&amp;rsquo;$ï¼Œç„¶åé‡å¤ä¹‹å‰çš„æ­¥éª¤ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/pixie-a-system-for-recommending-3-billion-items-to-200-million-users-in-real-time/Alg1.JPG"
loading="lazy"
alt="Algorithm1"
&gt;&lt;/p&gt;
&lt;p&gt;æ¸¸èµ°çš„é•¿åº¦ç”±å‚æ•° $\alpha$ å†³å®šã€‚æ‰€æœ‰çš„ è¿™æ ·çš„éšæœºæ¸¸èµ°çš„ steps çš„æ•°é‡å†³å®šäº†è¿™ä¸ªæ­¥éª¤çš„æ—¶é—´å¤æ‚åº¦ï¼Œæˆ‘ä»¬ç”¨ $N$ è¡¨ç¤ºè¿™ä¸ªå’Œã€‚æˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ª &lt;em&gt;counter&lt;/em&gt; $V$ ç”¨æ¥æ˜ å°„ pin å’Œè®¿é—®æ¬¡æ•°ã€‚ä¸ºäº†è·å¾—æ¨èçš„pinsï¼Œæˆ‘ä»¬å¯ä»¥ä»è¿”å›çš„ counter æå–è®¿é—®æ¬¡æ•°æœ€é«˜çš„pinsï¼Œå°†å®ƒä»¬è¿”å›ä½œä¸ºæ¨èç»“æœã€‚è¿™ä¸ªè¿‡ç¨‹çš„æ—¶é—´å¤æ‚åº¦æ˜¯å›ºå®šçš„ï¼Œä¸å›¾çš„å¤§å°æ— å…³ã€‚&lt;/p&gt;
&lt;p&gt;Pixieéšæœºæ¸¸èµ°ç®—æ³•ç”±ç®—æ³•2å’Œç®—æ³•3ç»„æˆï¼Œåœ¨åŸºç¡€éšæœºæ¸¸èµ°ä¸Šæœ‰ä»¥ä¸‹æå‡ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯¹ç”¨æˆ·æŒ‡å®šçš„pinçš„æœ‰åéšæœºæ¸¸èµ°&lt;/li&gt;
&lt;li&gt;å¤šä¸ªæŸ¥è¯¢çš„pinï¼Œæ¯ä¸ªéƒ½æœ‰ä¸åŒçš„æƒé‡&lt;/li&gt;
&lt;li&gt;multi-hit boosterå¯¹å¤šä¸ªæŸ¥è¯¢pinsçš„å¢å¼º&lt;/li&gt;
&lt;li&gt;åœ¨ä¿æŒé¢„æµ‹æ€§èƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨æ—©åœå‡å°‘éšæœºæ¸¸èµ°çš„æ­¥æ•°&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/pixie-a-system-for-recommending-3-billion-items-to-200-million-users-in-real-time/Alg2.JPG"
loading="lazy"
alt="Algorithm2"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/pixie-a-system-for-recommending-3-billion-items-to-200-million-users-in-real-time/Alg3.JPG"
loading="lazy"
alt="Algorithm3"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;(1)Biasing the Pixie Random Walk.&lt;/strong&gt; é’ˆå¯¹ç”¨æˆ·å¯¹éšæœºæ¸¸èµ°è¿›è¡Œåç¦»å¾ˆé‡è¦ã€‚å¯¹äºåŒæ ·çš„æŸ¥è¯¢é›†åˆ $Q$ï¼Œæ¨èç»“æœå¯¹äºä¸åŒçš„ç”¨æˆ·åº”è¯¥ä¸åŒã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒPinterestå›¾åŒ…å«äº†ä¸åŒè¯­è¨€ã€ä¸åŒä¸»é¢˜ï¼Œä»¥åŠä¸åŒå…´è¶£çš„ç”¨æˆ·çš„pinså’Œboardsï¼Œç»™ç”¨æˆ·ä½¿ç”¨çš„è¯­è¨€ä»¥åŠä»–ä»¬å…´è¶£ç›¸å…³çš„æ¨èæ˜¯éå¸¸é‡è¦çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬é€šè¿‡ä½¿ç”¨åŸºäºç”¨æˆ·ç‰¹å¾çš„éšæœºçš„è¾¹é€‰æ‹©æ–¹æ³•è§£å†³äº†æœ‰åéšæœºæ¸¸èµ°çš„é—®é¢˜ã€‚éšæœºæ¸¸èµ°å€¾å‘äºéå†å’Œç”¨æˆ·ç›¸å…³çš„è¾¹ã€‚å¯ä»¥çœ‹ä½œè¿™äº›è¾¹å¯¹äºå›¾ä¸­çš„å…¶ä»–è¾¹æœ‰æ›´é«˜çš„æƒé‡/é‡è¦æ€§ã€‚æˆ‘ä»¬å°†éšæœºæ¸¸èµ°åœ¨å›¾çš„ä¸€ä¸ªç‰¹å®šåŒºåŸŸå†…è¿›è¡Œåç¦»ï¼Œä½¿å¾—å®ƒå¯ä»¥ä¸“æ³¨äºpinsçš„ä¸€ä¸ªå­é›†ã€‚è¿™ä¸ªä¿®æ”¹åœ¨æé«˜ä¸ªæ€§åŒ–ã€è´¨é‡ã€ä»¥åŠæ¨èå†…å®¹çš„è¯é¢˜æ€§ä¸Šçš„æå‡å¾ˆé‡è¦ï¼Œå¾—åˆ°äº†æ›´é«˜çš„ç”¨æˆ·æ»¡æ„åº¦ã€‚&lt;/p&gt;
&lt;p&gt;Pixieç®—æ³•ä½¿ç”¨ä¸€ç»„ç”¨æˆ·ç‰¹å¾ $U$ ä½œä¸ºç‰¹å¾ï¼ˆç®—æ³•2ï¼‰ã€‚æ³¨æ„ï¼Œä¸åŒçš„Pixieè°ƒç”¨ä¸åŒçš„ç”¨æˆ·å’ŒæŸ¥è¯¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠ¨æ€åŸºäºç”¨æˆ·å’Œè¾¹çš„ç‰¹å¾çš„æœ‰åè¾¹é€‰æ‹©æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥æé«˜Pixieæ¨èç»“æœçš„çµæ´»æ€§ã€‚ç‰¹åˆ«åœ°ï¼Œ $\rm PIXIERANDOMWALK$ ä½¿ç”¨ $\rm PersonalizedNeighbor(E, U)$ é€‰æ‹©å¯¹ç”¨æˆ· $U$ é‡è¦çš„è¾¹ã€‚è¿™èƒ½ä½¿è¾¹åŒ¹é…ç”¨æˆ·çš„ç‰¹å¾/åå¥½ï¼Œæ¯”å¦‚è¯­è¨€æˆ–è¯é¢˜ã€‚ä»æ¦‚å¿µä¸Šæ¥çœ‹ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬åœ¨é’ˆå¯¹ç”¨æˆ·è¿›è¡Œæ¸¸èµ°åç¦»æ—¶å¯ä»¥è·å¾—æœ€å°çš„å­˜å‚¨ä»¥åŠè®¡ç®—å¼€é”€ã€‚æœ¬è´¨ä¸Šæ¥çœ‹ï¼Œå¯ä»¥å°†è¿™ç§æ–¹æ³•çœ‹ä½œæ˜¯é’ˆå¯¹æ¯ä¸ªç”¨æˆ·ï¼Œä½¿ç”¨ä¸€ä¸ªä¸åŒçš„å›¾ï¼Œè¿™ä¸ªå›¾çš„è¾¹æƒé‡æ˜¯é’ˆå¯¹è¿™ä¸ªç”¨æˆ·å®šåˆ¶çš„ï¼ˆä½†æ˜¯ä¸éœ€è¦å­˜å‚¨èµ·æ¥ï¼‰ã€‚åœ¨å®é™…æƒ…å†µä¸­ï¼Œç”±äºæ€§èƒ½åŸå› ï¼Œæˆ‘ä»¬å°†æƒé‡é™åˆ¶åœ¨äº†ä¸€ä¸ªå¯èƒ½å€¼ç»„æˆçš„ç¦»æ•£é›†åˆå†…ã€‚æˆ‘ä»¬é¿å…äº†åœ¨å†…å­˜ä¸­å­˜å‚¨ç›¸ä¼¼è¯­è¨€å’Œè¯é¢˜çš„çš„è¾¹å¯¼è‡´çš„å¼€é”€ï¼Œå› æ­¤ $\rm PersonalizedNeighbor(E, U)$ æ˜¯ä¸€ä¸ªå­èŒƒå›´æ“ä½œå™¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;(2) Multiple Query Pins with Weights.&lt;/strong&gt; ä¸ºäº†å…¨é¢åœ°å¯¹ç”¨æˆ·å»ºæ¨¡ï¼ŒåŸºäºç»™å®šç”¨æˆ·çš„å…¨éƒ¨å†å²ä¿¡æ¯æ˜¯å¾ˆé‡è¦çš„ã€‚æˆ‘ä»¬é€šè¿‡åŸºäºå¤šä¸ªpinsï¼Œè€Œä¸æ˜¯ä¸€ä¸ªpinçš„æŸ¥è¯¢æ–¹å¼å®Œæˆäº†è¿™ä¸ªè¦æ±‚ã€‚æŸ¥è¯¢é›†åˆ $Q$ ä¸­çš„æ¯ä¸ªpin $q$ è¢«åˆ†é…äº†ä¸€ä¸ªä¸åŒçš„æƒé‡ $w_q$ã€‚æƒé‡åŸºäºç”¨æˆ·å¯¹è¿™ä¸ªpinè¿›è¡Œæ“ä½œä¹‹åçš„æ—¶é—´ï¼Œä»¥åŠè¿™ä¸ªæ“ä½œçš„ç±»å‹ã€‚æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ç”Ÿæˆä¸€ç»„æŸ¥è¯¢ $Q$ çš„æ¨èç»“æœã€‚æˆ‘ä»¬å¯¹ $q \in Q$ ä½¿ç”¨Pixie Random Walkï¼ˆç®—æ³•2ï¼‰ï¼Œä½¿ç”¨ç›¸äº’ç‹¬ç«‹çš„è®¡æ•°å™¨ï¼Œå¦‚ pin $p$ çš„è®¡æ•°å™¨ $V_q[p]$ å¯¹æ¯ä¸ªæŸ¥è¯¢ pin $q$ è¿›è¡Œè®°å½•ã€‚æœ€åï¼Œé€šè¿‡ä½¿ç”¨ä¸€ä¼šå„¿è¦æåˆ°çš„æ–°çš„å…¬å¼èåˆè®¿é—®æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæœ‰ä¸ªé‡è¦çš„è§è§£ï¼Œè·å–æœ‰æ„ä¹‰çš„è®¿é—®æ¬¡æ•°éœ€è¦çš„stepsçš„æ•°é‡ä¾èµ–äºpinçš„åº¦ã€‚ä»ä¸€ä¸ªé«˜åº¦çš„pinï¼Œä¹Ÿå°±æ˜¯å‡ºç°åœ¨å¾ˆå¤šboardsä¸­çš„pinçš„æ¨èç»“æœéœ€è¦çš„æ­¥æ•°è¦è¿œå¤šäºä»ä¸€ä¸ªä½åº¦çš„pinã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç»™æ¯ä¸ªpinåˆ†é…çš„æ­¥æ•°æ­£æ¯”äºå®ƒçš„åº¦ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬çº¿æ€§çš„åˆ†é…æ­¥æ•°ç»™æ¯ä¸ªpinï¼Œé‚£æœ€åæœ‰å¯èƒ½ç»™ä½åº¦çš„pinè¿ä¸€æ­¥éƒ½åˆ†é…ä¸äº†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åŸºäºä¸€ä¸ªæ ¹æ®åº¦æ•°äºšçº¿æ€§å¢é•¿çš„å‡½æ•°æ¥åˆ†é…æ­¥æ•°ï¼Œé€šè¿‡ä¸€ä¸ªç¼©æ”¾å› å­ $s_q$ ç»™æ¯ä¸ªpinçš„æƒé‡ $w_q$è¿›è¡Œç¼©æ”¾ã€‚æˆ‘ä»¬ç»™æ¯ä¸ª pin æ„å»ºå¦‚ä¸‹çš„ç¼©æ”¾å› å­ï¼š&lt;/p&gt;
$$\tag{1}
s\_q = \vert E(q) \vert \cdot (C - \log{\vert E(q) \vert})
$$&lt;p&gt;å…¶ä¸­ $s_q$ æ˜¯ pin $q \in Q$ çš„ç¼©æ”¾å› å­ï¼Œ$\vert E(q) \vert$ æ˜¯ $q$ çš„åº¦ï¼Œ$C = max_{p \in P}(E(p))$ æ˜¯ pin åº¦çš„æœ€å¤§å€¼ã€‚è¿™ä¸ªå‡½æ•°ä¸ä¼šä¸æˆæ¯”ä¾‹åœ°ç»™æµè¡Œçš„pinsé«˜çš„æƒé‡ã€‚æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„å…¬å¼åˆ†é…æ­¥æ•°ï¼š&lt;/p&gt;
$$\tag{2}
N\_q = w\_q N \frac{s\_q}{\sum\_{r \in Q} s\_r}
$$&lt;p&gt;å…¶ä¸­ï¼Œ$N_q$æ˜¯åˆ†é…ç»™ä»pin $q$ èµ·å§‹çš„éšæœºæ¸¸èµ°çš„æ€»æ­¥æ•°ã€‚è¿™ä¸ªåˆ†å¸ƒæœ‰æˆ‘ä»¬æƒ³è¦çš„æ€§è´¨ï¼šç»™é«˜åº¦æ•°çš„pinsæ›´å¤šçš„æ­¥æ•°ï¼Œç»™ä½åº¦æ•°çš„pinå……åˆ†çš„æ­¥æ•°ã€‚æˆ‘ä»¬åœ¨ç®—æ³•3çš„ç¬¬äºŒè¡Œå®ç°äº†è¿™ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;(3) Multi-hit Booster.&lt;/strong&gt; Pixieç®—æ³•çš„å¦ä¸€ä¸ªåˆ›æ–°æ˜¯ï¼Œé€šå¸¸æ¥è¯´å¯¹äºæŸ¥è¯¢é›†åˆ $Q$ï¼Œæˆ‘ä»¬æƒ³è¦çš„æ¨èç»“æœæ˜¯ä¸ $Q$ ä¸­çš„å¤šä¸ª pins ç›¸å…³çš„ç»“æœã€‚ç›´è§‚ä¸Šæ¥çœ‹ï¼Œå€™é€‰çš„æŸ¥è¯¢ä¸è¶Šå¤šçš„ pins ç›¸å…³ï¼Œé‚£ä¹ˆè¿™ä¸ªå€™é€‰é¡¹ä¸æ•´ä¸ªæŸ¥è¯¢å°±è¶Šç›¸å…³ã€‚æ¢å¥è¯è¯´ï¼Œä»å¤šä¸ª pins å¾—æ¥çš„å…·æœ‰é«˜è®¿é—®æ¬¡æ•°çš„å€™é€‰é¡¹æ¯”ä»å•ä¸€ pin å¾—æ¥çš„å…·æœ‰å¾ˆé«˜çš„è®¿é—®æ¬¡æ•°çš„å€™é€‰é¡¹å¯¹äºè¿™ä¸ªæŸ¥è¯¢æ›´ç›¸å…³ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬çš„è§è§£æ˜¯ï¼šè®©Pixieå¢å¼ºä»å¤šä¸ªæŸ¥è¯¢ pins å¾—åˆ°çš„å€™é€‰ pins çš„åˆ†æ•°ã€‚æˆ‘ä»¬é€šè¿‡ä¸€ç§æ–°çš„æ–¹æ³•èšåˆä¸€ä¸ªç»™å®šçš„ pin $p$ çš„è®¿é—®æ¬¡æ•° $V_q[p]$ã€‚è€Œä¸æ˜¯ç®€å•çš„å¯¹æ‰€æœ‰çš„æŸ¥è¯¢ pins $q \in Q$ï¼ŒåŠ å’Œç»™å®š pin $p$ çš„è®¿é—®æ¬¡æ•° $V_q[p]$ï¼Œæˆ‘ä»¬å°†ä»–ä»¬å˜æ¢ï¼Œè¿™ç§æ–¹å¼ä¼šå¥–åŠ±é‚£äº›ä»å¤šä¸ªä¸åŒçš„æŸ¥è¯¢ pins $q$ å¤šæ¬¡è®¿é—®çš„ pinsï¼š&lt;/p&gt;
$$\tag{3}
V[p] = ( \sum\_{q \in Q} \sqrt{V\_q[p]})^2
$$&lt;p&gt;å…¶ä¸­ï¼Œ$V[p]$ æ˜¯ pin $p$åˆå¹¶åçš„è®¿é—®æ¬¡æ•°ã€‚æ³¨æ„ï¼Œå½“ä¸€ä¸ªå€™é€‰ pin $p$é€šè¿‡æ¸¸èµ°ä»ä¸€ä¸ªå•ç‹¬çš„æŸ¥è¯¢ pin $q$ èµ·å§‹åè®¿é—®åˆ°æ—¶ï¼Œè®¿é—®æ¬¡æ•°æ˜¯ä¸å˜çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœå€™é€‰ pin ä»å¤šä¸ªæŸ¥è¯¢ pins è®¿é—®åˆ°ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼å°±ä¼šå¢å¼ºã€‚å°±ä¼šå¯¼è‡´ï¼Œé€‰æ‹©è®¡æ•°å™¨ $V$ å¾—åˆ°çš„æœ€é«˜çš„è®¿é—® pins æ—¶ï¼Œmulti-hit pins çš„æ¯”ä¾‹ä¼šæ›´é«˜ã€‚æˆ‘ä»¬åœ¨ç®—æ³•3çš„ç¬¬5è¡Œå®ç°äº†è¿™ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;(4) Early Stopping.&lt;/strong&gt; æˆ‘ä»¬åˆšæ‰æè¿°çš„æ­¥éª¤ä¼šè·‘ä¸€ä¸ªå›ºå®š steps ä¸ªæ•° $N_q$ çš„éšæœºæ¸¸èµ°ã€‚ç„¶è€Œï¼Œå› ä¸º Pixie çš„è¿è¡Œæ—¶é—´ä¾èµ–äº steps çš„ä¸ªæ•°ï¼Œæˆ‘ä»¬å¸Œæœ›è·‘å°½å¯èƒ½å°‘çš„æ­¥æ•°ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹æŸ¥è¯¢ $q$ è°ƒæ•´æ­¥æ•° $N_q$ï¼Œè€Œä¸æ˜¯å¯¹æ‰€æœ‰çš„æŸ¥è¯¢ä½¿ç”¨å›ºå®šçš„ $N_q$ æ¥å‡å°‘è¿è¡Œæ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆæ˜¯ä¸€æ—¦å‰å‡ ä¸ªå€™é€‰é¡¹ç¨³å®šåå°±åœæ­¢æ¸¸èµ°ã€‚å› ä¸º Pixie æ¨èå‡ åƒä¸ª
pinsï¼Œå¦‚æœæœ´ç´ åœ°å®ç°ï¼Œè¿™ä¸ªç›‘æ§ï¼ˆåˆ¤æ–­å€™é€‰é¡¹å˜ä¸å˜ï¼‰ä¼šæ¯”éšæœºæ¸¸èµ°æœ¬èº«è¿˜è´¹æ—¶ã€‚æˆ‘ä»¬çš„æ–¹æ³•é€šè¿‡ä¸¤ä¸ªå®æ•° $n_p$ å’Œ $n_v$ å…‹æœäº†è¿™ä¸ªå›°éš¾ã€‚è‡³å°‘ $n_p$ ä¸ªå€™é€‰é¡¹è¢«è®¿é—®äº†è‡³å°‘ $n_v$ æ¬¡å°±åœæ­¢æ¸¸èµ°ã€‚è¿™ä¸ªç›‘æ§ç®€å•è€Œä¸”é«˜æ•ˆï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªè®¡æ•°å™¨æ¥è¿½è¸ªå€™é€‰é¡¹æ˜¯å¦è¢«è®¿é—®äº† $n_v$ å³å¯ï¼ˆç®—æ³•2çš„12åˆ°15è¡Œï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨4.2èŠ‚å±•ç¤ºäº†æ—©åœç­–ç•¥ä¸é•¿çš„éšæœºæ¸¸èµ°å·®ä¸å¤šçš„ç»“æœï¼Œä½†æ˜¯å·®ä¸å¤šå°‘äº†ä¸€èˆ¬çš„æ­¥æ•°ï¼ŒåŠ é€Ÿäº†ä¸€å€å·¦å³ã€‚&lt;/p&gt;
&lt;h2 id="32-graph-pruning"&gt;3.2 Graph Pruning
&lt;/h2&gt;&lt;p&gt;å¦ä¸€ä¸ªé‡è¦çš„åˆ›æ–°æ˜¯å›¾çš„æ¸…ç†ä¸å‰ªæã€‚å›¾å‰ªææå‡äº†æ¨èè´¨é‡ï¼Œä¹Ÿå‡å°‘äº†å›¾çš„å°ºå¯¸ï¼Œæ‰€ä»¥è¿™ä¸ªç®—æ³•å¯ä»¥åœ¨æ›´å°çš„å›¾ã€æ›´ä¾¿å®œçš„æœºå™¨ä¸Šï¼Œæä¾›æ›´å¥½çš„ç¼“å­˜è¡¨ç°ã€‚&lt;/p&gt;
&lt;p&gt;åŸå§‹çš„Pinterestå›¾æœ‰70äº¿ä¸ªé¡¶ç‚¹å’Œè¶…è¿‡1000äº¿æ¡è¾¹ã€‚ä½†æ˜¯ï¼Œä¸æ˜¯æ‰€æœ‰çš„ boards éƒ½æ˜¯æœ‰ä¸»é¢˜çš„ã€‚å¤§çš„å¤šæ ·çš„boardsä¼šè®©æ¸¸èµ°å‘å¤šä¸ªæ–¹å‘æ‰©æ•£ï¼Œä½¿å¾—æ¨èç»“æœè´¨é‡ä¸‹é™ã€‚ç›¸ä¼¼åœ°ï¼Œå¾ˆå¤š pins è¢«é”™è¯¯çš„åˆ†åˆ°å…¶ä»–çš„ boards ä¸­ã€‚å›¾å‰ªæè¿‡ç¨‹ä¼šæ¸…ç†å›¾ï¼Œå¹¶ä¸”è®©å®ƒå˜å¾—ä¸»é¢˜æ›´ä¸“ä¸€ã€‚å¦ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå›¾å‰ªæä¹Ÿä¼šè®©å›¾å˜å°ï¼Œå¯ä»¥æ”¾åˆ°å•å°æœºå™¨çš„å†…å­˜ä¸­ã€‚ä¸éœ€è¦å°†å›¾åˆ†å¸ƒåˆ°å¤šå°æœºå™¨ä¸Šå°±å¯ä»¥å¾—åˆ°å¾ˆå¥½çš„æ€§èƒ½ï¼Œå› ä¸ºéšæœºæ¸¸èµ°ä¸éœ€è¦åœ¨ä¸åŒçš„æœºå™¨ä¸Šâ€œè·³è·ƒâ€ã€‚&lt;/p&gt;
&lt;p&gt;æ­¥éª¤å¦‚ä¸‹ï¼šé¦–å…ˆï¼Œé€šè¿‡è®¡ç®— boards çš„ä¸»é¢˜åˆ†å¸ƒçš„ç†µï¼Œé‡åŒ–æ¯ä¸ª board çš„å†…å®¹å¤šæ ·æ€§ã€‚ç„¶ååœ¨æ¯ä¸ª pin çš„æè¿°ä¸Šä½¿ç”¨LDAä¸»é¢˜æ¨¡å‹è·å–æ¦‚ç‡ä¸»é¢˜å‘é‡ã€‚ä½¿ç”¨åŠ å…¥åˆ° board ä¸­æœ€æ–°çš„ pins çš„ä¸»é¢˜å‘é‡ä½œä¸ºè¾“å…¥ä¿¡å·ï¼Œè®¡ç®— board çš„ç†µã€‚åˆ é™¤æ‰æœ‰å¾ˆå¤§çš„ç†µçš„ boards ä»¥åŠä»–ä»¬çš„è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªæŒ‘æˆ˜æ˜¯ï¼ŒçœŸå®ç¯å¢ƒçš„æ•°æ®é›†æœ‰å¾ˆåçš„é•¿å°¾åˆ†å¸ƒã€‚åœ¨ Pinterestä¸­ï¼Œæ„å‘³ç€ä¸€äº› pins éå¸¸æµè¡Œï¼Œæœ‰å¯èƒ½è¢«å­˜å…¥äº†å‡ ç™¾ä¸‡ä¸ª boards ä¸­ã€‚å¯¹äºè¿™æ ·çš„é¡¶ç‚¹ï¼Œéšæœºæ¸¸èµ°éœ€è¦è¿è¡Œå¾ˆå¤šæ­¥ï¼Œå› ä¸ºå®ƒéœ€è¦åœ¨ä¸€ä¸ªæœ‰å¤§é‡é‚»å±…çš„ç½‘ç»œä¸­æ‰©æ•£ã€‚æˆ‘ä»¬é€šè¿‡æœ‰ç³»ç»Ÿæ€§åœ°ä¸¢å¼ƒé«˜åº¦ pins çš„è¾¹è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä¸¢å¼ƒäº†é‚£ç§ pin çš„ä¸»é¢˜ä¸å±äºé‚£ä¸ª board çš„è¾¹ï¼Œè€Œä¸æ˜¯éšæœºåœ°ä¸¢å¼ƒè¾¹ã€‚æˆ‘ä»¬ä½¿ç”¨å’Œä¸Šé¢åŒæ ·çš„ä¸»é¢˜å‘é‡ï¼Œä½¿ç”¨ç‰¹å¾å‘é‡çš„ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—ä¸€ä¸ª pin å¯¹äºä¸€ä¸ª board çš„ç›¸ä¼¼åº¦ï¼Œç„¶ååªä¿ç•™å…·æœ‰é«˜ç›¸ä¼¼åº¦çš„è¾¹ã€‚å®é™…ä¸Šï¼Œå‰ªæçš„ç¨‹åº¦å–å†³äº $pruning \ factor \ \delta$ã€‚æˆ‘ä»¬å°†æ¯ä¸ª pin $p$ çš„åº¦æ›´æ–°ä¸º $\vert E(p) \vert ^ \delta$ï¼Œä¸¢å¼ƒè¿æ¥ $p$ å’Œ ä¸ $p$ ç›¸ä¼¼åº¦ä½çš„ boards çš„è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å‰ªæåï¼Œå›¾åŒ…å«äº†10äº¿ä¸ª boardsï¼Œ20äº¿ä¸ª pinsï¼Œ170äº¿æ¡è¾¹ã€‚æ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯ï¼Œæˆ‘ä»¬å‘ç°å‰ªææœ‰ä¸¤ä¸ªä¼˜ç‚¹ï¼š1. å›¾çš„å¤§å°å‡å°äº†6å€ï¼ˆå†…å­˜å¼€é”€ï¼‰ï¼›2. å¾—åˆ°äº†58%çš„ç›¸å…³æ¨èç»“æœã€‚&lt;/p&gt;</description></item><item><title>Large-Scale Learnable Graph Convolutional Networks</title><link>https://davidham3.github.io/blog/p/large-scale-learnable-graph-convolutional-networks/</link><pubDate>Mon, 17 Sep 2018 15:22:43 +0000</pubDate><guid>https://davidham3.github.io/blog/p/large-scale-learnable-graph-convolutional-networks/</guid><description>&lt;p&gt;KDD 2018.å°†å›¾ç»“æ„æ•°æ®å˜æ¢åˆ°ç½‘æ ¼çŠ¶æ•°æ®ä¸­ï¼Œä½¿ç”¨ä¼ ç»Ÿçš„ä¸€ç»´å·ç§¯è¿›è¡Œå·ç§¯ã€‚å˜æ¢çš„æ–¹å¼æ˜¯ï¼šé’ˆå¯¹æ¯ä¸ªç‰¹å¾çš„å¤§å°ï¼Œå¯¹é‚»å±…ç»“ç‚¹è¿›è¡Œæ’åºï¼Œå–è¿™ä¸ªç‰¹å¾å‰kå¤§çš„æ•°ä½œä¸ºå®ƒé‚»å±…è¿™åˆ—ç‰¹å¾çš„kä¸ªå€¼ã€‚å¦‚æœé‚»å±…ä¸å¤Ÿï¼Œé‚£å°±ç”¨0æ¥è¡¥ã€‚è¿™æ ·å°±èƒ½å¾—åˆ°è¯¥é¡¶ç‚¹çš„é‚»å±…ä¿¡æ¯ï¼Œç»„æˆä¸€ä¸ªçŸ©é˜µï¼Œç„¶åä½¿ç”¨ä¸€ç»´å·ç§¯ã€‚ä½†æ˜¯ä½œè€…æ²¡è¯´ä¸ºä»€ä¹ˆéè¦å–æœ€å¤§çš„kä¸ªæ•°ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1808.03965?context=stat.ML" target="_blank" rel="noopener"
&gt;Large-Scale Learnable Graph Convolutional Networks&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="æ‘˜è¦"&gt;æ‘˜è¦
&lt;/h1&gt;&lt;p&gt;å·ç§¯ç¥ç»ç½‘ç»œåœ¨ç½‘æ ¼æ•°æ®ä¸Šå–å¾—äº†å¾ˆå¤§çš„æˆåŠŸï¼Œä½†æ˜¯åœ¨å­¦ä¹ åƒå›¾è¿™æ ·çš„æ•°æ®çš„æ—¶å€™å°±é¢ä¸´ç€å¾ˆå¤šçš„æŒ‘æˆ˜ã€‚CNNä¸­ï¼Œå¯å­¦ä¹ çš„å±€éƒ¨æ»¤æ³¢å™¨å¯ä»¥è‡ªåŠ¨åœ°æ•è·é«˜å±‚æ¬¡çš„ç‰¹å¾ã€‚æ»¤æ³¢å™¨çš„è®¡ç®—éœ€è¦æ„Ÿå—é‡å†…æœ‰å›ºå®šæ•°é‡çš„å•å…ƒã€‚ç„¶è€Œï¼Œåœ¨å›¾ç»“æ„ä¸­ï¼Œé‚»å±…å•å…ƒçš„æ•°é‡ä¸å›ºå®šï¼Œè€Œä¸”é‚»å±…ä¹Ÿä¸æœ‰åºï¼Œæ‰€ä»¥é˜»ç¢äº†å·ç§¯çš„æ“ä½œã€‚æˆ‘ä»¬æå‡ºäº†å¯å­¦ä¹ å›¾å·ç§¯å±‚(learnable graph convolutional layer LGCL)æ¥è§£å†³è¿™äº›æŒ‘æˆ˜ã€‚åŸºäºå€¼çš„æ’åºï¼ŒLGCLä¸ºæ¯ä¸ªç‰¹å¾è‡ªåŠ¨åœ°é€‰æ‹©å›ºå®šæ•°é‡çš„é‚»å±…ç»“ç‚¹ï¼Œä»¥æ­¤å°†å›¾ç»“æ„æ•°æ®å˜æ¢åˆ°1ç»´çš„ç½‘æ ¼ç»“æ„ä¸­ï¼Œç„¶åå°±å¯ä»¥åœ¨å›¾ä¸Šä½¿ç”¨å¸¸è§„çš„å·ç§¯æ“ä½œäº†ã€‚ä¸ºäº†èƒ½è®©æ¨¡å‹åœ¨å¤§å°ºåº¦çš„å›¾ä¸Šè®­ç»ƒï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªå­å›¾è®­ç»ƒæ–¹æ³•æ¥å‡å°‘è¿‡å¤šçš„å†…å­˜å’Œè®¡ç®—èµ„æºçš„å¼€é”€ã€‚åœ¨é¡¶ç‚¹åˆ†ç±»ä»»åŠ¡ä¸Šï¼Œä¸è®ºæ˜¯transductive è¿˜æ˜¯ inductiveï¼Œè¡¨ç°å¾—éƒ½æ›´å¥½ä¸€äº›ã€‚æˆ‘ä»¬çš„ç»“æœå±•ç¤ºå‡ºäº†æˆ‘ä»¬çš„å­å›¾è®­ç»ƒæ–¹æ³•æ¯”å‰äººçš„æ–¹æ³•æ›´é«˜æ•ˆã€‚&lt;/p&gt;
&lt;h1 id="3-methods"&gt;3. methods
&lt;/h1&gt;&lt;h2 id="31-challenges-of-applying-convolutional-operations-on-graph-data"&gt;3.1 Challenges of Applying Convolutional Operations on Graph Data
&lt;/h2&gt;&lt;p&gt;ä¸ºäº†è®©ä¼ ç»Ÿçš„å·ç§¯æ“ä½œå¯ä»¥åº”ç”¨åœ¨å›¾ä¸Šï¼Œéœ€è¦è§£å†³ä¸¤ä¸ªå›¾ç»“æ„æ•°æ®å’Œç½‘æ ¼æ•°æ®çš„å·®å¼‚ã€‚é¦–å…ˆï¼Œé¡¶ç‚¹çš„é‚»å±…æ•°é‡é€šå¸¸ä¼šå˜åŒ–ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬ä¸èƒ½å¯¹é‚»å±…é¡¶ç‚¹è¿›è¡Œæ’åºï¼Œå› ä¸ºä»–ä»¬æ²¡æœ‰å¯ä¾›æ’åºçš„ä¿¡æ¯ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œç¤¾äº¤ç½‘ç»œä¸­ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªé¡¶ç‚¹ï¼Œè¾¹è¡¨ç¤ºäººä¸äººä¹‹é—´çš„å…³ç³»ã€‚æ˜¾ç„¶ï¼Œæ¯ä¸ªé¡¶ç‚¹çš„é‚»å±…é¡¶ç‚¹æ•°é‡æ˜¯ä¸åŒçš„ï¼Œå› ä¸ºäººä»¬å¯ä»¥æœ‰ä¸åŒæ•°é‡çš„æœ‹å‹ã€‚è€Œä¸”ï¼Œå¦‚æœæ²¡æœ‰é¢å¤–çš„ä¿¡æ¯ï¼Œå¾ˆéš¾å¯¹ä»–ä»¬è¿›è¡Œæ’åºã€‚&lt;/p&gt;
&lt;p&gt;ç½‘æ ¼æ•°æ®å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§ç‰¹æ®Šçš„å›¾ç»“æ„æ•°æ®ï¼Œæ¯ä¸ªé¡¶ç‚¹æœ‰å›ºå®šæ•°é‡çš„é‚»å±…ã€‚å› ä¸ºå·ç§¯æ“ä½œæ˜¯ç›´æ¥åº”ç”¨åœ¨å›¾åƒè¿™æ ·çš„ç½‘æ ¼æ•°æ®ä¸Šã€‚ä¸ºäº†çœ‹æ¸…æ¥šå›ºå®šé‚»å±…æ•°é‡ä»¥åŠæ’åºä¿¡æ¯çš„é‡è¦æ€§ï¼Œæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼Œæœ‰ä¸€ä¸ª$3 \times 3$çš„å·ç§¯æ ¸ï¼Œæ‰«æä¸€å¼ å›¾åƒã€‚æˆ‘ä»¬å°†è¿™å¼ å›¾ç‰‡è€ƒè™‘æˆä¸€ä¸ªç‰¹æ®Šçš„å›¾ï¼Œæ¯ä¸ªåƒç´ æ˜¯ä¸€ä¸ªé¡¶ç‚¹ã€‚åœ¨æ‰«æçš„è¿‡ç¨‹ä¸­ï¼Œè®¡ç®—åŒ…æ‹¬äº†ä¸­å¿ƒç»“ç‚¹å’Œå‘¨å›´8ä¸ªé‚»å±…ç»“ç‚¹çš„è®¡ç®—ã€‚è¿™8ä¸ªé¡¶ç‚¹åœ¨è¿™ä¸ªç‰¹æ®Šçš„å›¾ä¸­é€šè¿‡è¾¹è¿æ¥åˆ°ä¸­å¿ƒç»“ç‚¹ã€‚ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ä»–ä»¬å’Œä¸­å¿ƒç»“ç‚¹çš„ç›¸å¯¹ä½ç½®å¯¹ä»–ä»¬æ’åºï¼Œè¿™å¯¹äºå·ç§¯æ“ä½œå¾ˆé‡è¦ï¼Œå› ä¸ºåœ¨æ‰«æçš„è¿‡ç¨‹ä¸­ï¼Œæ»¤æ³¢å™¨çš„æƒé‡å’Œå›¾ä¸­çš„é¡¶ç‚¹è¦ä¸€ä¸€å¯¹åº”ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ$3 \times 3$çš„å·ç§¯æ ¸ï¼Œå·¦ä¸Šè§’çš„æƒé‡åº”è¯¥æ€»æ˜¯å¯¹åº”ä¸­å¿ƒèŠ‚ç‚¹å·¦ä¸Šæ–¹çš„é‚»å±…ç»“ç‚¹ã€‚æ²¡æœ‰è¿™æ ·çš„æ’åºä¿¡æ¯ï¼Œå·ç§¯çš„è¾“å‡ºç»“æœå°±ä¸å†æ˜¯ç¡®å®šçš„ã€‚ä»åˆšæ‰çš„è®¨è®ºä¸­å¯ä»¥çœ‹åˆ°ä¼ ç»Ÿå·ç§¯åœ¨å›¾ç»“æ„æ•°æ®ä¸Šåº”ç”¨çš„æŒ‘æˆ˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸¤ä¸ªæŒ‘æˆ˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–¹æ³•å°†å›¾ç»“æ„æ•°æ®å˜æ¢åˆ°ç½‘æ ¼æ•°æ®å†…ã€‚&lt;/p&gt;
&lt;h2 id="32-learnable-graph-convolutional-layers"&gt;3.2 learnable Graph Convolutional Layers
&lt;/h2&gt;&lt;p&gt;ä¸ºäº†è®©ä¼ ç»Ÿå·ç§¯å¯ä»¥åœ¨å›¾ä¸Šå¯ç”¨ï¼Œæˆ‘ä»¬æå‡ºäº†LGCLã€‚LGCLçš„layer-wiseä¼ æ’­è§„åˆ™å†™ä¸ºï¼š&lt;/p&gt;
$$\tag{3}
\tilde{X}\_l = g(X\_l, A, k),\\
X\_{l+1} = c(\tilde{X}\_l)
$$&lt;p&gt;å…¶ä¸­ï¼Œ$A$æ˜¯é‚»æ¥çŸ©é˜µï¼Œ$g(\cdot)$ä½¿ç”¨äº†$k$-largest Node Selectionï¼Œå°†å›¾ç»“æ„æ•°æ®æ˜ å°„åˆ°ç½‘æ ¼ç»“æ„ï¼Œ$c(\cdot)$è¡¨ç¤º1ç»´å¸¸è§„çš„CNNï¼Œå°†é¡¶ç‚¹ä¿¡æ¯èšåˆï¼Œä¸ºæ¯ä¸ªé¡¶ç‚¹è¾“å‡ºäº†ä¸€ä¸ªæ–°çš„ç‰¹å¾å‘é‡ã€‚æˆ‘ä»¬ä¼šåœ¨ä¸‹é¢åˆ†å¼€è®¨è®º$g(\cdot)$å’Œ$c(\cdot)$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;$k$-largest Node Selection&lt;/strong&gt;. æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–°çš„æ–¹æ³•ç§°ä¸º$k$-largest Node Selectionï¼Œå°†å›¾ç»“æ„æ˜ å°„åˆ°ç½‘æ ¼æ•°æ®ä¸Šï¼Œå…¶ä¸­$k$æ˜¯LGCLçš„è¶…å‚æ•°ã€‚åœ¨è¿™ä¸ªæ“ä½œä¹‹åï¼Œæ¯ä¸ªé¡¶ç‚¹çš„é‚»å±…ä¿¡æ¯èšåˆï¼Œè¡¨ç¤ºæˆä¸€ä¸ªæœ‰$(k+1)$ä¸ªä½ç½®çš„1ç»´çš„ç½‘æ ¼çŠ¶ã€‚å˜æ¢åçš„æ•°æ®ä¼šè¾“å…¥åˆ°CNNä¸­æ¥ç”Ÿæˆæ–°çš„ç‰¹å¾å‘é‡ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æœ‰è¡Œå‘é‡$x^1_l, x^2_l, &amp;hellip;, x^N_l$çš„$X_l \in \mathbb{R}^{N \times C}$ï¼Œè¡¨ç¤º$N$ä¸ªé¡¶ç‚¹çš„å›¾ï¼Œæ¯ä¸ªé¡¶ç‚¹æœ‰$C$ä¸ªç‰¹å¾ã€‚é‚»æ¥çŸ©é˜µ$A \in \mathbb{N}^{N \times N}$ï¼Œ$k$ä¸ºå®šå€¼ã€‚é¡¶ç‚¹$i$çš„ç‰¹å¾å‘é‡æ˜¯$x^i_l$ï¼Œå®ƒæœ‰$n$ä¸ªé‚»å±…ã€‚é€šè¿‡åœ¨$A$ä¸­çš„ä¸€ä¸ªç®€å•æŸ¥æ‰¾ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—è¿™äº›é‚»å±…ç»“ç‚¹çš„ä¸‹æ ‡ï¼Œ$i_1, i_2, &amp;hellip;, i_n$ã€‚å¯¹å®ƒä»¬å¯¹åº”çš„ç‰¹å¾å‘é‡$x^{i_1}_l, x^{i_2}_l, &amp;hellip;, x^{i_n}_l$è¿›è¡Œæ‹¼æ¥ï¼Œå¾—åˆ°$M^i_l \in \mathbb{R}^{n \times C}$ã€‚å‡è®¾$n \geq k$ï¼Œå°±æ²¡æœ‰æ³›åŒ–ä¸Šçš„æŸå¤±ã€‚å¦‚æœ$n &amp;lt; k$ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¨ä¸º0çš„åˆ—ï¼Œç»™$M^i_l$åŠ paddingã€‚$k$-largest node selectionæ˜¯åœ¨$M^i_l$ä¸Šåšçš„ï¼šä¹Ÿå°±æ˜¯ï¼Œå¯¹äºæ¯åˆ—ï¼Œæˆ‘ä»¬æ’å‡º$n$ä¸ªå€¼ï¼Œç„¶åé€‰æœ€å¤§çš„$k$ä¸ªæ•°ã€‚æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ª$k \times C$çš„è¾“å‡ºçŸ©é˜µã€‚å› ä¸º$M^i_l$è¡¨ç¤ºç‰¹å¾ï¼Œè¿™ä¸ªæ“ä½œç­‰ä»·äºä¸ºæ¯ä¸ªç‰¹å¾é€‰æ‹©$k$ä¸ªæœ€å¤§å€¼ã€‚é€šè¿‡åœ¨ç¬¬ä¸€è¡Œæ’å…¥$x^i_l$ï¼Œè¾“å‡ºå˜ä¸º$\tilde{M}^i_l \in \mathbb{R}^{(k+1) \times C}$ã€‚å¦‚å›¾2å·¦éƒ¨åˆ†ã€‚é€šè¿‡å¯¹æ¯ä¸ªé¡¶ç‚¹é‡å¤è¿™ä¸ªæ“ä½œï¼Œ$g(\cdot)$å°†$X_l$å˜ä¸º$\tilde{X}_l \in \mathbb{R}^{N \times (k + 1) \times C}$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/large-scale-learnable-graph-convolutional-networks/Fig2.JPG"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼Œå¦‚æœå°†$N$ï¼Œ$(k+1)$ï¼Œ$C$åˆ†åˆ«çœ‹ä½œæ˜¯batch sizeï¼Œspatial sizeï¼Œé€šé“æ•°ï¼Œé‚£ä¹ˆ$\tilde{X}_l$å¯ä»¥çœ‹ä½œæ˜¯1ç»´ç½‘æ ¼çŠ¶çš„ç»“æ„ã€‚å› æ­¤ï¼Œ$k$ä¸ªæœ€å¤§é¡¶ç‚¹é€‰æ‹©å‡½æ•°$g(\cdot)$æˆåŠŸåœ°å°†å›¾ç»“æ„å˜æ¢ä¸ºç½‘æ ¼ç»“æ„ã€‚è¿™ä¸ªæ“ä½œå……åˆ†åˆ©ç”¨äº†å®æ•°çš„è‡ªç„¶é¡ºåºä¿¡æ¯ï¼Œä½¿å¾—æ¯ä¸ªé¡¶ç‚¹æœ‰å›ºå®šæ•°é‡çš„æœ‰åºé‚»å±…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1-D Convolutional Neural Networks&lt;/strong&gt;. å°±åƒ3.1èŠ‚è®¨è®ºçš„ï¼Œä¼ ç»Ÿçš„å·ç§¯æ“ä½œå¯ä»¥ç›´æ¥åº”ç”¨åˆ°ç½‘æ ¼çŠ¶çš„æ•°æ®ä¸Šã€‚$\tilde{X}_l \in \mathbb{R}^{N \times (k + 1) \times C}$æ˜¯1ç»´çš„æ•°æ®ï¼Œæˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªä¸€ç»´CNNæ¨¡å‹$c(\cdot)$ã€‚LGCLåŸºæœ¬çš„åŠŸèƒ½æ˜¯èšåˆé‚»å±…ä¿¡æ¯ï¼Œä¸ºæ¯ä¸ªé¡¶ç‚¹æ›´æ–°ç‰¹å¾ã€‚åç»­çš„è¯ï¼Œå®ƒéœ€è¦$X_{l + 1} \in \mathbb{R}^{N \times D}$ï¼Œå…¶ä¸­$D$æ˜¯æ›´æ–°åçš„ç‰¹å¾ç©ºé—´çš„ç»´åº¦ã€‚ä¸€ç»´CNN $c(\cdot)$ ä½¿ç”¨$\tilde{X}_l \in \mathbb{R}^{N \times (k + 1) \times C}$ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºä¸€ä¸ª$N \times D$çš„çŸ©é˜µï¼Œæˆ–æ˜¯$N \times 1 \times D$çš„çŸ©é˜µã€‚$c(\cdot)$å¯ä»¥å°†ç©ºé—´ç»´åº¦ä»$(k+1)$å‡å°åˆ°$1$ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼Œ$N$çœ‹ä½œæ˜¯batch sizeï¼Œä¸$c(\cdot)$çš„è®¾è®¡æ— å…³ã€‚ç»“æœå°±æ˜¯ï¼Œæˆ‘ä»¬åªèšç„¦äºä¸€ä¸ªæ ·æœ¬ï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çš„ä¸€ä¸ªé¡¶ç‚¹ã€‚å¯¹äºé¡¶ç‚¹$i$ï¼Œå˜æ¢å¾—åˆ°çš„è¾“å‡ºæ˜¯$\tilde{M}^i_l \in \mathbb{R}^{(k + 1) \times C}$ï¼Œæ˜¯$c(\cdot)$çš„è¾“å…¥ã€‚ç”±äºä»»ä½•ä¸€ä¸ªå·ç§¯æ ¸å¤§äº1ä¸”æ²¡æœ‰paddingçš„å·ç§¯éƒ½ä¼šå‡å°‘ç©ºé—´çš„å¤§å°ï¼Œæœ€ç®€å•çš„$c(\cdot)$åªæœ‰ä¸€ä¸ªå·ç§¯æ ¸å¤§å°ä¸º$(k+1)$çš„å·ç§¯ï¼Œæ²¡æœ‰paddingã€‚è¾“å…¥å’Œè¾“å‡ºçš„é€šé“æ•°åˆ†åˆ«ä¸º$C$å’Œ$D$ã€‚åŒæ—¶ï¼Œå¯ä»¥éƒ¨ç½²ä»»æ„ä¸€ä¸ªå¤šå±‚CNNï¼Œå¾—åˆ°æœ€åçš„è¾“å‡ºçš„ç»´åº¦æ˜¯$1 \times D$ã€‚å›¾2å³ä¾§å±•ç¤ºäº†ä¸€ä¸ªä¸¤å±‚CNNçš„ä¾‹å­ã€‚å†å¯¹æ‰€æœ‰çš„$N$ä¸ªé¡¶ç‚¹ä½¿ç”¨ä¸€æ¬¡$c(\cdot)$ï¼Œè¾“å‡º$X_{l+1} \in \mathbb{R}^{N \times D}$ã€‚æ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„LGCLä½¿ç”¨$k$æœ€å¤§é¡¶ç‚¹é€‰æ‹©ä»¥åŠä¼ ç»Ÿçš„ä¸€ç»´CNNï¼Œå°†å›¾ç»“æ„å˜æ¢åˆ°ç½‘æ ¼æ•°æ®ï¼Œå®ç°äº†å¯¹æ¯ä¸ªé¡¶ç‚¹è¿›è¡Œçš„ç‰¹å¾èšåˆå’Œç‰¹å¾è¿‡æ»¤ã€‚&lt;/p&gt;
&lt;h2 id="33-å¯å­¦ä¹ çš„å›¾å·ç§¯ç½‘ç»œ"&gt;3.3 å¯å­¦ä¹ çš„å›¾å·ç§¯ç½‘ç»œ
&lt;/h2&gt;&lt;p&gt;è¶Šæ·±çš„ç½‘ç»œä¸€èˆ¬ä¼šäº§ç”Ÿè¶Šå¥½çš„ç»“æœã€‚ç„¶è€Œï¼Œä¹‹å‰åœ¨å›¾ä¸Šçš„æ·±åº¦æ¨¡å‹ï¼Œå¦‚GCNï¼Œåªæœ‰ä¸¤å±‚ã€‚å°½ç®¡éšç€æ·±åº¦çš„å¢åŠ ï¼Œå®ƒä»¬çš„æ€§èƒ½æœ‰æœ‰æ‰€ä¸‹é™[Kipf &amp;amp; Welling 2017]ï¼Œæˆ‘ä»¬çš„LGCLå¯ä»¥æ„é€ çš„å¾ˆæ·±ï¼Œæ„é€ å‡ºå›¾é¡¶ç‚¹åˆ†ç±»çš„å¯å­¦ä¹ çš„å›¾å·ç§¯ç½‘ç»œã€‚æˆ‘ä»¬åŸºäºdensely connected convolutional networks(DCNNs)ï¼Œæ„é€ äº†LGCNsï¼Œå‰è€…è·å¾—äº†ImageNetåˆ†ç±»ä»»åŠ¡æœ€å¥½çš„æˆç»©ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨LGCNä¸­ï¼Œæˆ‘ä»¬å…ˆç”¨ä¸€ä¸ªå›¾åµŒå…¥å±‚æ¥ç”Ÿæˆé¡¶ç‚¹çš„ä½ç»´è¡¨ç¤ºï¼Œå› ä¸ºåŸå§‹è¾“å…¥ä¸€èˆ¬éƒ½æ˜¯é«˜ç»´ç‰¹å¾ï¼Œæ¯”å¦‚Coraæ•°æ®é›†ã€‚ç¬¬ä¸€å±‚çš„å›¾åµŒå…¥å±‚æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œè¡¨ç¤ºä¸ºï¼š&lt;/p&gt;
$$\tag{4}
X\_1 = X\_0 W\_0
$$&lt;p&gt;å…¶ä¸­ï¼Œ$X_0 \in \mathbb{R}^{N \times C_0}$è¡¨ç¤ºé«˜ç»´çš„è¾“å…¥ï¼Œ$W_0 \in \mathbb{R}^{C_0 \times C_1}$å°†ç‰¹å¾ç©ºé—´ä»$C_0$æ˜ å°„åˆ°äº†$C_1$ã€‚ç»“æœå°±æ˜¯ï¼Œ$X_1 \in \mathbb{R}^{N \times C_1}$å’Œ$C_1 &amp;lt; C_0$ã€‚æˆ–è€…ï¼Œä½¿ç”¨ä¸€ä¸ªGCNå±‚æ¥åšå›¾åµŒå…¥ã€‚å¦‚ç¬¬äºŒéƒ¨åˆ†æè¿°çš„ï¼ŒGCNå±‚ä¸­çš„å‚æ•°æ•°é‡ç­‰ä»·äºä¼ ç»Ÿçš„å›¾åµŒå…¥å±‚ä¸­å‚æ•°çš„æ•°é‡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å›¾åµŒå…¥å±‚åï¼Œæˆ‘ä»¬å †å å¤šä¸ªLGCLï¼Œå¤šå°‘ä¸ªå–å†³äºæ•°æ®çš„å¤æ‚ç¨‹åº¦ã€‚å› ä¸ºæ¯ä¸ªLGCLåªèƒ½èšåˆä¸€é˜¶é‚»å±…çš„ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥ç›¸è¿çš„é‚»å±…é¡¶ç‚¹ï¼Œå †å LGCLå¯ä»¥ä»ä¸€ä¸ªæ›´å¤§çš„é¡¶ç‚¹é›†ä¸­è·å¾—ä¿¡æ¯ï¼Œè¿™ä¹Ÿæ˜¯ä¼ ç»ŸCNNçš„åŠŸèƒ½ã€‚ä¸ºäº†æå‡æ¨¡å‹çš„æ€§èƒ½ï¼Œå¸®åŠ©è®­ç»ƒè¿‡ç¨‹ï¼Œæˆ‘ä»¬ä½¿ç”¨skip connectionsæ¥æ‹¼æ¥LGCLçš„è¾“å…¥å’Œè¾“å‡ºã€‚æœ€åï¼Œåœ¨softmaxæ¿€æ´»å‰ä½¿ç”¨ä¸€ä¸ªå…¨è¿æ¥å±‚ã€‚&lt;/p&gt;
&lt;p&gt;å°±åƒLGCNçš„è®¾è®¡ç†å¿µï¼Œ$k$ä»¥åŠå †å çš„LGCLçš„æ•°é‡æ˜¯æœ€é‡è¦çš„è¶…å‚æ•°ã€‚é¡¶ç‚¹çš„å¹³å‡åº¦æ˜¯é€‰æ‹©$k$çš„ä¸€ä¸ªé‡è¦å‚æ•°ã€‚LGCLçš„æ•°é‡åº”è¯¥ä¾èµ–ä»»åŠ¡çš„å¤æ‚åº¦ï¼Œæ¯”å¦‚ç±»åˆ«çš„ä¸ªæ•°ï¼Œå›¾çš„é¡¶ç‚¹æ•°ç­‰ã€‚è¶Šå¤æ‚çš„æ¨¡å‹éœ€è¦è¶Šæ·±çš„æ¨¡å‹ã€‚&lt;/p&gt;
&lt;h2 id="34-sub-graph-training-on-large-scale-data"&gt;3.4 Sub-Graph Training on Large-Scale Data
&lt;/h2&gt;&lt;p&gt;å¤§éƒ¨åˆ†å›¾ä¸Šçš„æ·±åº¦å­¦ä¹ æ¨¡å‹éƒ½æœ‰å¦ä¸€ä¸ªé™åˆ¶ã€‚åœ¨è®­ç»ƒçš„æ—¶å€™ï¼Œè¾“å…¥çš„æ˜¯æ‰€æœ‰é¡¶ç‚¹çš„ç‰¹å¾å‘é‡ä»¥åŠæ•´ä¸ªå›¾çš„é‚»æ¥çŸ©é˜µã€‚å›¾çš„å°ºå¯¸å¤§çš„æ—¶å€™è¿™ä¸ªçŸ©é˜µå°±ä¼šå˜å¤§ã€‚è¿™äº›æ–¹æ³•åœ¨å°å°ºåº¦çš„å›¾ä¸Šè¡¨ç°çš„è¿˜å¯ä»¥ã€‚ä½†æ˜¯å¯¹äºå¤§å°ºåº¦çš„å›¾ï¼Œè¿™äº›æ–¹æ³•ä¸€èˆ¬éƒ½ä¼šå¯¼è‡´å†…å­˜å’Œè®¡ç®—èµ„æºæå¤§çš„å¼€é”€ï¼Œé™åˆ¶äº†è¿™äº›æ¨¡å‹çš„ä¸€äº›åº”ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä»–ç±»å‹çš„æ•°æ®é›†ä¹Ÿæœ‰ç›¸ä¼¼çš„é—®é¢˜ï¼Œæ¯”å¦‚ç½‘æ ¼æ•°æ®ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå›¾åƒåˆ†å‰²ä¸Šçš„æ·±åº¦æ¨¡å‹é€šå¸¸ä½¿ç”¨éšæœºåˆ‡ç‰‡çš„æ–¹å¼æ¥å¤„ç†å¤§çš„å›¾ç‰‡ã€‚å—åˆ°è¿™ç§ç­–ç•¥çš„å¯å‘ï¼Œæˆ‘ä»¬éšæœºçš„å°†å›¾â€œåˆ‡åˆ†â€ï¼Œä½¿ç”¨å¾—åˆ°çš„å°å›¾è¿›è¡Œè®­ç»ƒã€‚ç„¶è€Œï¼Œå°½ç®¡ä¸€å¼ å›¾ç‰‡çš„ä¸€ä¸ªçŸ©å½¢éƒ¨åˆ†å¾ˆè‡ªç„¶åœ°åŒ…å«äº†åƒç´ çš„é‚»å±…ä¿¡æ¯ã€‚å¦‚ä½•å¤„ç†å›¾ä¸­é¡¶ç‚¹çš„ä¸è§„åˆ™è¿æ¥è¿˜æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æå‡ºäº†å­å›¾é€‰æ‹©ç®—æ³•æ¥è§£å†³å¤§å°ºåº¦å›¾ä¸Šè®¡ç®—èµ„æºçš„é—®é¢˜ï¼Œå¦‚ç®—æ³•1æ‰€ç¤ºã€‚ç»™å®šä¸€ä¸ªå›¾ï¼Œæˆ‘ä»¬å…ˆé‡‡æ ·å‡ºä¸€äº›åˆå§‹é¡¶ç‚¹ã€‚ä»å®ƒä»¬å¼€å§‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³•ï¼Œè¿­ä»£åœ°å°†é‚»æ¥é¡¶ç‚¹æ‰©å……åˆ°å­å›¾å†…ã€‚ç»è¿‡ä¸€å®šæ¬¡æ•°çš„è¿­ä»£åï¼Œåˆå§‹é¡¶ç‚¹çš„é«˜é˜¶é‚»å±…é¡¶ç‚¹å°±ä¼šè¢«åŠ è¿›å»ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨ç®—æ³•1ä¸­ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å‚æ•°$N_m$ã€‚å®é™…ä¸Šåœ¨æ¯ä¸ªè¿­ä»£ä¸­ï¼Œæˆ‘ä»¬å°†$N_m$è®¾ç½®ä¸ºäº†ä¸åŒçš„å€¼ã€‚å›¾4ç»™å‡ºäº†å­å›¾é€‰æ‹©è¿‡ç¨‹çš„ä¸€ä¸ªä¾‹å­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/large-scale-learnable-graph-convolutional-networks/Alg1.JPG"
loading="lazy"
alt="Algorithm1"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/large-scale-learnable-graph-convolutional-networks/Fig4.JPG"
loading="lazy"
alt="Figure4"
&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ ·éšæœºçš„åˆ‡åˆ†å­å›¾ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¤§å°ºåº¦çš„å›¾ä¸Šè®­ç»ƒæ·±å±‚æ¨¡å‹ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥å……åˆ†åˆ©ç”¨mini-batchè®­ç»ƒæ–¹æ³•æ¥åŠ é€Ÿå­¦ä¹ è¿‡ç¨‹ã€‚åœ¨æ¯è½®è®­ç»ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å­å›¾è®­ç»ƒæ–¹æ³•é‡‡æ ·å¤šä¸ªå­å›¾ï¼Œç„¶åæŠŠå®ƒä»¬æ”¾åˆ°batchä¸­ã€‚å¯¹åº”çš„ç‰¹å¾å‘é‡å’Œé‚»æ¥çŸ©é˜µç»„æˆäº†ç½‘ç»œçš„è¾“å…¥ã€‚&lt;/p&gt;
&lt;h1 id="4-experimental-studies"&gt;4. Experimental studies
&lt;/h1&gt;&lt;p&gt;ä»£ç ï¼š&lt;a class="link" href="https://github.com/divelab/lgcn/" target="_blank" rel="noopener"
&gt;https://github.com/divelab/lgcn/&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="42-experimental-setup"&gt;4.2 Experimental Setup
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Transduction Learning.&lt;/strong&gt; åœ¨transductive learning ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬åƒå›¾3ä¸€æ ·éƒ¨ç½²LGCNæ¨¡å‹ã€‚å› ä¸ºtransductive learningæ•°æ®é›†ä½¿ç”¨é«˜ç»´çš„è¯è¢‹è¡¨ç¤ºä½œä¸ºé¡¶ç‚¹çš„ç‰¹å¾å‘é‡ï¼Œè¾“å…¥é€šè¿‡ä¸€ä¸ªå›¾åµŒå…¥å±‚æ¥é™ç»´ã€‚æˆ‘ä»¬è¿™é‡Œä½¿ç”¨GCNå±‚ä½œä¸ºå›¾åµŒå…¥å±‚ã€‚&lt;/p&gt;</description></item><item><title>å†³ç­–æ ‘å®ç°</title><link>https://davidham3.github.io/blog/p/%E5%86%B3%E7%AD%96%E6%A0%91%E5%AE%9E%E7%8E%B0/</link><pubDate>Thu, 13 Sep 2018 21:40:03 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E5%86%B3%E7%AD%96%E6%A0%91%E5%AE%9E%E7%8E%B0/</guid><description>&lt;p&gt;æœ€è¿‘ç»™æœ¬ç§‘ç”Ÿå½“åŠ©æ•™ï¼Œå‡ºäº†ä¸€é“å®ç°å†³ç­–æ ‘çš„é¢˜ï¼Œè¿˜æœ‰ä¸€ä¸ªé¢„å‰ªæçš„é¢˜ï¼Œè‡ªå·±ä¹Ÿé¡ºä¾¿å®ç°ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å®ç°çš„è¿™ä¸ªå†³ç­–æ ‘ä¸»è¦æ˜¯å‚ç…§äº†C4.5ç®—æ³•ã€‚æ²¡åŠ å…¥å‰ªæã€‚å®ç°çš„å…¶å®å¾ˆç®€å•ï¼Œåªé’ˆå¯¹ç¦»æ•£ç‰¹å¾ï¼Œåšäº†ä¸€ä¸ªäºŒå‰å†³ç­–æ ‘ã€‚ä¹Ÿå°±æ˜¯å°†æ‰€æœ‰ç‰¹å¾å…ˆåšone-hotï¼Œè¿™æ ·æ‰€æœ‰çš„ç‰¹å¾éƒ½å˜æˆ0å’Œ1äº†ï¼Œç„¶åå¯¹å…¶è¿›è¡ŒäºŒåˆ†ã€‚&lt;/p&gt;
&lt;p&gt;åŸç†å…¶å®å¾ˆç®€å•ï¼Œé€‰æ‹©ä¸€ç§åˆ’åˆ†æŒ‡æ ‡ï¼Œéå†æ‰€æœ‰çš„ç‰¹å¾ï¼Œæ‰¾åˆ°æœ€ä¼˜åˆ’åˆ†ç‰¹å¾ï¼Œç„¶ååˆ†å‰²è®­ç»ƒé›†ï¼Œä»å‰©ä½™ç‰¹å¾ä¸­åˆ é™¤å½“å‰çš„æœ€ä¼˜ç‰¹å¾ï¼Œç„¶ååˆ†å·¦å­æ ‘å’Œå³å­æ ‘é€’å½’åœ°ç»§ç»­åˆ›å»ºç»“ç‚¹å³å¯ã€‚æ— éæ˜¯é€’å½’çš„ç»ˆæ­¢æ¡ä»¶ï¼Œé€’å½’çš„ç»ˆæ­¢æ¡ä»¶æœ‰ä¸‰ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¦‚æœå½“å‰ç»“ç‚¹å†…æ‰€æœ‰çš„æ ·æœ¬åŒå±ä¸€ç±»ï¼Œåˆ™ç›´æ¥åšå¶å­ç»“ç‚¹&lt;/li&gt;
&lt;li&gt;å¦‚æœå½“å‰æ·±åº¦è¾¾åˆ°æœ€å¤§æ·±åº¦ï¼Œç›´æ¥åšå¶å­ç»“ç‚¹&lt;/li&gt;
&lt;li&gt;å¦‚æœæ— å‰©ä½™ç‰¹å¾å¯ä¾›åˆ’åˆ†ï¼Œç›´æ¥åšå¶å­èŠ‚ç‚¹&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="ç¬¬ä¸‰é¢˜å®ç°å†³ç­–æ ‘"&gt;ç¬¬ä¸‰é¢˜ï¼šå®ç°å†³ç­–æ ‘
&lt;/h1&gt;&lt;p&gt;å®éªŒå†…å®¹ï¼š&lt;br&gt;
ä½¿ç”¨LendingClub Safe Loansæ•°æ®é›†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å®ç°ä¿¡æ¯å¢ç›Šã€ä¿¡æ¯å¢ç›Šç‡ã€åŸºå°¼æŒ‡æ•°ä¸‰ç§åˆ’åˆ†æ ‡å‡†&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ç»™å®šçš„è®­ç»ƒé›†å®Œæˆä¸‰ç§å†³ç­–æ ‘çš„è®­ç»ƒè¿‡ç¨‹&lt;/li&gt;
&lt;li&gt;è®¡ç®—ä¸‰ç§å†³ç­–æ ‘åœ¨æœ€å¤§æ·±åº¦ä¸º10æ—¶åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šçš„ç²¾åº¦ï¼ŒæŸ¥å‡†ç‡ï¼ŒæŸ¥å…¨ç‡ï¼ŒF1å€¼&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åœ¨è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¼šå®ç°ä¸€ä¸ªå¾ˆç®€å•çš„äºŒå‰å†³ç­–æ ‘&lt;/p&gt;
&lt;h2 id="1-è¯»å–æ•°æ®"&gt;1. è¯»å–æ•°æ®
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# å¯¼å…¥ç±»åº“&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# å¯¼å…¥æ•°æ®&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;loans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data/lendingclub/lending-club-data.csv&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;low_memory&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ•°æ®ä¸­æœ‰ä¸¤åˆ—æ˜¯æˆ‘ä»¬æƒ³é¢„æµ‹çš„æŒ‡æ ‡ï¼Œä¸€é¡¹æ˜¯safe_loansï¼Œä¸€é¡¹æ˜¯bad_loansï¼Œåˆ†åˆ«è¡¨ç¤ºæ­£ä¾‹å’Œè´Ÿä¾‹ï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œå¤„ç†ï¼Œå°†æ­£ä¾‹çš„safe_loansè®¾ä¸º1ï¼Œè´Ÿä¾‹è®¾ä¸º-1ï¼Œåˆ é™¤bad_loansè¿™åˆ—&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼Œå°†safe_loansä½œä¸ºæ ‡è®°&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;loans&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;safe_loans&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;loans&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;bad_loans&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;loans&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;bad_loans&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬åªä½¿ç”¨grade, term, home_ownership, emp_lengthè¿™å››åˆ—ä½œä¸ºç‰¹å¾ï¼Œsafe_loansä½œä¸ºæ ‡è®°ï¼Œåªä¿ç•™loansä¸­çš„è¿™äº”åˆ—&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;features&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;grade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;# grade of the loan&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;term&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;# the term of the loan&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;home_ownership&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;# home_ownership status: own, mortgage or rent&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;emp_length&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;# number of years of employment&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;safe_loans&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;loans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;loans&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;features&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id="2-åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†"&gt;2. åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†
&lt;/h2&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.utils&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;shuffle&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;loans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;shuffle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;loans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;random_state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;split_line&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;loans&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mf"&gt;0.6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;train_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;loans&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt; &lt;span class="n"&gt;split_line&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;test_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;loans&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;split_line&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id="3-ç‰¹å¾é¢„å¤„ç†"&gt;3. ç‰¹å¾é¢„å¤„ç†
&lt;/h2&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„ç‰¹å¾éƒ½æ˜¯ç¦»æ•£ç±»å‹çš„ç‰¹å¾ï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼Œä½¿ç”¨one-hotç¼–ç å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;one-hotç¼–ç çš„æ€æƒ³å°±æ˜¯å°†ç¦»æ•£ç‰¹å¾å˜æˆå‘é‡ï¼Œå‡è®¾ç‰¹å¾$A$æœ‰ä¸‰ç§å–å€¼$\lbrace a, b, c\rbrace$ï¼Œè¿™ä¸‰ç§å–å€¼ç­‰ä»·ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨1,2,3ä¸‰ä¸ªæ•°å­—è¡¨ç¤ºè¿™ä¸‰ç§å–å€¼ï¼Œé‚£ä¹ˆåœ¨è®¡ç®—æ—¶å°±ä¼šäº§ç”Ÿåå·®ï¼Œæœ‰ä¸€äº›æ¶‰åŠè·ç¦»åº¦é‡çš„ç®—æ³•ä¼šè®¤ä¸ºï¼Œ2å’Œ1ç¦»å¾—è¿‘ï¼Œ3å’Œ1ç¦»å¾—è¿œï¼Œä½†è¿™ä¸‰ä¸ªå€¼åº”è¯¥æ˜¯ç­‰ä»·çš„ï¼Œè¿™ç§è¡¨ç¤ºæ–¹æ³•ä¼šé€ æˆæ¨¡å‹åœ¨åˆ¤æ–­ä¸Šå‡ºç°åå·®ã€‚è§£å†³æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨ä¸€ä¸ªä¸‰ç»´å‘é‡è¡¨ç¤ºä»–ä»¬ï¼Œç”¨$[1, 0, 0]$è¡¨ç¤ºaï¼Œ$[0, 1, 0]$è¡¨ç¤ºbï¼Œ$[0, 0, 1]$è¡¨ç¤ºcï¼Œè¿™æ ·ä¸‰ä¸ªå‘é‡ä¹‹é—´çš„è·ç¦»å°±éƒ½æ˜¯ç›¸ç­‰çš„äº†ï¼Œä»»æ„ä¸¤ä¸ªå‘é‡åœ¨æ¬§å¼ç©ºé—´çš„è·ç¦»éƒ½æ˜¯$\sqrt{2}$ã€‚è¿™å°±æ˜¯one-hotç¼–ç æ˜¯æ€æƒ³ã€‚&lt;/p&gt;
&lt;p&gt;pandasä¸­ä½¿ç”¨get_dummiesç”Ÿæˆone-hotå‘é‡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;one_hot_encoding&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;features_categorical&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; Parameter
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>ç¥ç»ç½‘ç»œåŸºç¡€</title><link>https://davidham3.github.io/blog/p/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/</link><pubDate>Tue, 11 Sep 2018 14:12:30 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/</guid><description>&lt;p&gt;æœ€è¿‘ç»™æœ¬ç§‘ç”Ÿå½“æœºå™¨å­¦ä¹ è¯¾ç¨‹çš„åŠ©æ•™ï¼Œç»™ä»–ä»¬å‡ºçš„ä½œä¸šé¢˜éœ€è¦çœ‹è¿™äº›å›¾ï¼Œæ‡’å¾—æ”¾æœ¬åœ°äº†ï¼Œç›´æ¥æ”¾åšå®¢é‡Œã€‚å‘ç°jupyterå¯¼å‡ºmarkdownå¥½æ–¹ä¾¿ï¼Œæ”¾åˆ°åšå®¢é‡Œé¢æ­£å¥½ï¼Œæ”¹éƒ½ä¸ç”¨æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;åŸæ¥å°±æƒ³è¿‡ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆæˆ‘å†™å‡ºæ¥çš„ç¥ç»ç½‘ç»œä¸æ”¶æ•›ï¼Œlossä¼šåƒç«ç®­ä¸€æ ·ç›´æ¥é£äº†ã€‚åæ¥çœ‹äº†ä¸€äº›æ•™ç¨‹ï¼Œå‘ç°æœ‰äººåœ¨åšæ¢¯åº¦ä¸‹é™çš„æ—¶å€™ï¼ŒæŠŠæ¢¯åº¦é™¤ä»¥äº†æ¢¯åº¦çš„äºŒèŒƒæ•°ï¼Œæˆ‘å°è¯•ä¹‹åå‘ç°è¿˜çœŸå¥½ä½¿äº†ï¼Œåœ¨å®éªŒçš„æ—¶å€™å‘ç°æ˜¯å› ä¸ºæ²¡æœ‰å¯¹æ•°æ®é›†è¿›è¡Œå½’ä¸€åŒ–ï¼Œå¦‚æœæ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯å¾ˆå¤§çš„æ•°ï¼Œé‚£ä¹ˆåœ¨åå‘ä¼ æ’­çš„æ—¶å€™ï¼Œè®¡ç®—å‡ºæ¥çš„æ¢¯åº¦çš„æ•°é‡çº§ä¼šå¾ˆå¤§ï¼Œè¿™å°±å¯¼è‡´æ›´æ–°å¾—åˆ°çš„å‚æ•°çš„æ•°é‡çº§ä¹Ÿå¾ˆå¤§ï¼Œé¢„æµ‹å‡ºçš„åå·®å°±æ›´å¤§äº†ï¼Œç„¶åå¾ªç¯å¾€å¤ï¼Œå¦‚æœç»™æ¢¯åº¦é™¤ä»¥ä¸€ä¸ªæ¢¯åº¦çš„äºŒèŒƒæ•°ï¼Œå…¶å®å°±ç›¸å½“äºæŠŠæ¢¯åº¦çš„æ•°é‡çº§é™äº†ï¼Œè¿™æ ·å°±å¯ä»¥è®­ç»ƒäº†ã€‚ä½†å®é™…ä¸Šè¿˜æ˜¯å°†åŸå§‹æ•°æ®å½’ä¸€åŒ–æ¯”è¾ƒå¥½ï¼Œå¯¹åŸå§‹æ•°æ®å½’ä¸€åŒ–è¿˜èƒ½è®©æ¢¯åº¦ä¸‹é™çš„æ–¹å‘æ›´å¤šã€‚å¦‚æœæ•°æ®éƒ½æ˜¯æ­£æ•°ï¼Œé‚£ä¸‹é™æ–¹å‘ä¼šå°‘å¾ˆå¤šï¼Œä¸‹é™çš„æ—¶å€™ä¼šå‡ºç°zig-zagç°è±¡ã€‚&lt;/p&gt;
&lt;h1 id="ç¬¬äºŒé¢˜ç¥ç»ç½‘ç»œçº¿æ€§å›å½’"&gt;ç¬¬äºŒé¢˜ï¼šç¥ç»ç½‘ç»œï¼šçº¿æ€§å›å½’
&lt;/h1&gt;&lt;p&gt;å®éªŒå†…å®¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å­¦ä¼šæ¢¯åº¦ä¸‹é™çš„åŸºæœ¬æ€æƒ³&lt;/li&gt;
&lt;li&gt;å­¦ä¼šä½¿ç”¨æ¢¯åº¦ä¸‹é™æ±‚è§£çº¿æ€§å›å½’&lt;/li&gt;
&lt;li&gt;äº†è§£å½’ä¸€åŒ–å¤„ç†çš„ä½œç”¨&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="çº¿æ€§å›å½’"&gt;çº¿æ€§å›å½’
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/logistic-regression/Fig0.png"
loading="lazy"
alt="Figure0"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥å®Œæˆæœ€ç®€å•çš„çº¿æ€§å›å½’ï¼Œä¸Šå›¾æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„ç¥ç»ç½‘ç»œï¼Œä¸€ä¸ªè¾“å…¥å±‚ï¼Œä¸€ä¸ªè¾“å‡ºå±‚ï¼Œæ²¡æœ‰æ¿€æ´»å‡½æ•°ã€‚&lt;br&gt;
æˆ‘ä»¬è®°è¾“å…¥ä¸º$X \in \mathbb{R}^{n \times m}$ï¼Œè¾“å‡ºä¸º$Z \in \mathbb{R}^{n}$ã€‚è¾“å…¥åŒ…å«äº†$n$ä¸ªæ ·æœ¬ï¼Œ$m$ä¸ªç‰¹å¾ï¼Œè¾“å‡ºæ˜¯å¯¹è¿™$n$ä¸ªæ ·æœ¬çš„é¢„æµ‹å€¼ã€‚&lt;br&gt;
è¾“å…¥å±‚åˆ°è¾“å‡ºå±‚çš„æƒé‡å’Œåç½®ï¼Œæˆ‘ä»¬è®°ä¸º$W \in \mathbb{R}^{m}$å’Œ$b \in \mathbb{R}$ã€‚&lt;br&gt;
è¾“å‡ºå±‚æ²¡æœ‰æ¿€æ´»å‡½æ•°ï¼Œæ‰€ä»¥ä¸Šé¢çš„ç¥ç»ç½‘ç»œçš„å‰å‘ä¼ æ’­è¿‡ç¨‹å†™ä¸ºï¼š&lt;/p&gt;
$$
Z = XW + b
$$&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨å‡æ–¹è¯¯å·®ä½œä¸ºæ¨¡å‹çš„æŸå¤±å‡½æ•°&lt;/p&gt;
$$
\mathrm{loss}(y, \hat{y}) = \frac{1}{n} \sum^n\_{i=1}(y\_i - \hat{y\_i})^2
$$&lt;p&gt;æˆ‘ä»¬é€šè¿‡è°ƒæ•´å‚æ•°$W$å’Œ$b$æ¥é™ä½å‡æ–¹è¯¯å·®ï¼Œæˆ–è€…è¯´æ˜¯ä»¥é™ä½å‡æ–¹è¯¯å·®ä¸ºç›®æ ‡ï¼Œå­¦ä¹ å‚æ•°$W$å’Œå‚æ•°$b$ã€‚å½“å‡æ–¹è¯¯å·®ä¸‹é™çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®¤ä¸ºå½“å‰çš„æ¨¡å‹çš„é¢„æµ‹å€¼$Z$ä¸çœŸå€¼$y$è¶Šæ¥è¶Šæ¥è¿‘ï¼Œä¹Ÿå°±æ˜¯è¯´æ¨¡å‹æ­£åœ¨å­¦ä¹ å¦‚ä½•è®©è‡ªå·±çš„é¢„æµ‹å€¼å˜å¾—æ›´å‡†ç¡®ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å‰é¢çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»å­¦ä¹ äº†è¿™ç§çº¿æ€§å›å½’æ¨¡å‹å¯ä»¥ä½¿ç”¨æœ€å°äºŒä¹˜æ³•æ±‚è§£ï¼Œæœ€å°äºŒä¹˜æ³•åœ¨æ±‚è§£æ•°æ®é‡è¾ƒå°çš„é—®é¢˜çš„æ—¶å€™å¾ˆæœ‰æ•ˆï¼Œä½†æ˜¯æœ€å°äºŒä¹˜æ³•çš„æ—¶é—´å¤æ‚åº¦å¾ˆé«˜ï¼Œä¸€æ—¦æ•°æ®é‡å˜å¤§ï¼Œæ•ˆç‡å¾ˆä½ï¼Œå®é™…åº”ç”¨ä¸­æˆ‘ä»¬ä¼šä½¿ç”¨æ¢¯åº¦ä¸‹é™ç­‰åŸºäºæ¢¯åº¦çš„ä¼˜åŒ–ç®—æ³•æ¥æ±‚è§£å‚æ•°$W$å’Œå‚æ•°$b$ã€‚&lt;/p&gt;
&lt;h2 id="æ¢¯åº¦ä¸‹é™"&gt;æ¢¯åº¦ä¸‹é™
&lt;/h2&gt;&lt;p&gt;æ¢¯åº¦ä¸‹é™æ˜¯ä¸€ç§å¸¸ç”¨çš„ä¼˜åŒ–ç®—æ³•ï¼Œé€šä¿—æ¥è¯´å°±æ˜¯è®¡ç®—å‡ºå‚æ•°çš„æ¢¯åº¦ï¼ˆæŸå¤±å‡½æ•°å¯¹å‚æ•°çš„åå¯¼æ•°çš„å¯¼æ•°å€¼ï¼‰ï¼Œç„¶åå°†å‚æ•°å‡å»å‚æ•°çš„æ¢¯åº¦ä¹˜ä»¥ä¸€ä¸ªå¾ˆå°çš„æ•°ï¼ˆä¸‹é¢çš„å…¬å¼ï¼‰ï¼Œæ¥æ”¹å˜å‚æ•°ï¼Œç„¶åé‡æ–°è®¡ç®—æŸå¤±å‡½æ•°ï¼Œå†æ¬¡è®¡ç®—æ¢¯åº¦ï¼Œå†æ¬¡è¿›è¡Œè°ƒæ•´ï¼Œé€šè¿‡ä¸€å®šæ¬¡æ•°çš„è¿­ä»£ï¼Œå‚æ•°å°±ä¼šæ”¶æ•›åˆ°æœ€ä¼˜ç‚¹é™„è¿‘ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çš„è¿™ä¸ªçº¿æ€§å›å½’é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬çš„å‚æ•°æ˜¯$W$å’Œ$b$ï¼Œä½¿ç”¨ä»¥ä¸‹çš„ç­–ç•¥æ›´æ–°å‚æ•°ï¼š&lt;/p&gt;
$$
W := W - \alpha \frac{\partial \mathrm{loss}}{\partial W}
$$$$
b := b - \alpha \frac{\partial \mathrm{loss}}{\partial b}
$$&lt;p&gt;å…¶ä¸­ï¼Œ$\alpha$ æ˜¯å­¦ä¹ ç‡ï¼Œä¸€èˆ¬è®¾ç½®ä¸º0.1ï¼Œ0.01ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šæ±‚è§£æŸå¤±å‡½æ•°å¯¹å‚æ•°çš„åå¯¼æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æŸå¤±å‡½æ•°MSEè®°ä¸ºï¼š&lt;/p&gt;
$$
\mathrm{loss}(y, Z) = \frac{1}{n} \sum^n\_{i = 1} (y\_i - Z\_i)^2
$$&lt;p&gt;å…¶ä¸­ï¼Œ$Z \in \mathbb{R}^{n}$æ˜¯æˆ‘ä»¬çš„é¢„æµ‹å€¼ï¼Œä¹Ÿå°±æ˜¯ç¥ç»ç½‘ç»œè¾“å‡ºå±‚çš„è¾“å‡ºå€¼ã€‚è¿™é‡Œæˆ‘ä»¬æœ‰$n$ä¸ªæ ·æœ¬ï¼Œå®é™…ä¸Šæ˜¯å°†$n$ä¸ªæ ·æœ¬çš„é¢„æµ‹å€¼ä¸ä»–ä»¬çš„çœŸå€¼ç›¸å‡ï¼Œå–å¹³æ–¹ååŠ å’Œã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è®¡ç®—æŸå¤±å‡½æ•°å¯¹å‚æ•°$W$çš„åå¯¼æ•°ï¼Œæ ¹æ®é“¾å¼æ³•åˆ™ï¼Œå¯ä»¥å°†åå¯¼æ•°æ‹†æˆä¸¤é¡¹ï¼Œåˆ†åˆ«æ±‚è§£åç›¸ä¹˜ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿™é‡Œæˆ‘ä»¬ä»¥çŸ©é˜µçš„å½¢å¼å†™å‡ºæ¨å¯¼è¿‡ç¨‹ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å°è¯•ä½¿ç”¨å•ä¸ªæ ·æœ¬è¿›è¡Œæ¨åˆ°ï¼Œç„¶åæ¨å¹¿åˆ°çŸ©é˜µå½¢å¼&lt;/strong&gt;&lt;/p&gt;
$$\begin{aligned}
\frac{\partial \mathrm{loss}}{\partial W} &amp;= \frac{\partial \mathrm{loss}}{\partial Z} \frac{\partial Z}{\partial W}\\
&amp;= - \frac{2}{n} X^\mathrm{T} (y - Z)\\
&amp;= \frac{2}{n} X^\mathrm{T} (Z - y)
\end{aligned}$$&lt;p&gt;åŒç†ï¼Œæ±‚è§£æŸå¤±å‡½æ•°å¯¹å‚æ•°$b$çš„åå¯¼æ•°:&lt;/p&gt;
$$\begin{aligned}
\frac{\partial \mathrm{loss}}{\partial b} &amp;= \frac{\partial \mathrm{loss}}{\partial Z} \frac{\partial Z}{\partial b}\\
&amp;= - \frac{2}{n} \sum^n\_{i=1}(y\_i - Z\_i)\\
&amp;= \frac{2}{n} \sum^n\_{i=1}(Z\_i - y\_i)
\end{aligned}$$&lt;p&gt;&lt;strong&gt;å› ä¸ºå‚æ•°$b$å¯¹æ¯ä¸ªæ ·æœ¬çš„æŸå¤±å€¼éƒ½æœ‰è´¡çŒ®ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†æ‰€æœ‰æ ·æœ¬çš„åå¯¼æ•°éƒ½åŠ å’Œã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œ$\frac{\partial \mathrm{loss}}{\partial W} \in \mathbb{R}^{m}$ï¼Œ$\frac{\partial \mathrm{loss}}{\partial b} \in \mathbb{R}$ï¼Œæ±‚è§£å¾—åˆ°çš„æ¢¯åº¦çš„ç»´åº¦ä¸å‚æ•°ä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;å®Œæˆä¸Šå¼ä¸¤ä¸ªæ¢¯åº¦çš„è®¡ç®—åï¼Œå°±å¯ä»¥ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•å¯¹å‚æ•°è¿›è¡Œæ›´æ–°äº†ã€‚&lt;/p&gt;
&lt;p&gt;è®­ç»ƒç¥ç»ç½‘ç»œçš„åŸºæœ¬æ€è·¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆå¯¹å‚æ•°è¿›è¡Œåˆå§‹åŒ–ï¼Œå¯¹å‚æ•°è¿›è¡Œéšæœºåˆå§‹åŒ–ï¼ˆä¹Ÿå°±æ˜¯å–éšæœºå€¼ï¼‰&lt;/li&gt;
&lt;li&gt;å°†æ ·æœ¬è¾“å…¥ç¥ç»ç½‘ç»œï¼Œè®¡ç®—ç¥ç»ç½‘ç»œé¢„æµ‹å€¼ $Z$&lt;/li&gt;
&lt;li&gt;è®¡ç®—æŸå¤±å€¼MSE&lt;/li&gt;
&lt;li&gt;é€šè¿‡ $Z$ å’Œ $y$ ï¼Œä»¥åŠ $X$ ï¼Œè®¡ç®—å‚æ•°çš„æ¢¯åº¦&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ›´æ–°å‚æ•°&lt;/li&gt;
&lt;li&gt;å¾ªç¯1-5æ­¥ï¼Œ&lt;strong&gt;åœ¨åå¤è¿­ä»£çš„è¿‡ç¨‹ä¸­å¯ä»¥çœ‹åˆ°æŸå¤±å€¼ä¸æ–­å‡å°çš„ç°è±¡ï¼Œå¦‚æœæ²¡æœ‰ä¸‹é™è¯´æ˜å‡ºäº†é—®é¢˜&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç°è¿™ä¸ªæœ€ç®€å•çš„ç¥ç»ç½‘ç»œã€‚&lt;/p&gt;
&lt;h2 id="1-å¯¼å…¥æ•°æ®"&gt;1. å¯¼å…¥æ•°æ®
&lt;/h2&gt;&lt;p&gt;ä½¿ç”¨kaggleæˆ¿ä»·æ•°æ®ï¼Œé€‰3åˆ—ä½œä¸ºç‰¹å¾&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;matplotlib&lt;/span&gt; &lt;span class="n"&gt;inline&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# è¯»å–æ•°æ®&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data/kaggle_house_price_prediction/kaggle_hourse_price_train.csv&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# ä½¿ç”¨è¿™3åˆ—ä½œä¸ºç‰¹å¾&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;features&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;LotArea&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;BsmtUnfSF&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;GarageArea&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;SalePrice&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;features&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id="2-æ•°æ®é¢„å¤„ç†"&gt;2. æ•°æ®é¢„å¤„ç†
&lt;/h2&gt;&lt;p&gt;40%åšæµ‹è¯•é›†ï¼Œ60%åšè®­ç»ƒé›†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.model_selection&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;train_test_split&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;trainX&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;testX&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trainY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;testY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;train_test_split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;features&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;test_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;random_state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è®­ç»ƒé›†876ä¸ªæ ·æœ¬ï¼Œ3ä¸ªç‰¹å¾ï¼Œæµ‹è¯•é›†584ä¸ªæ ·æœ¬ï¼Œ3ä¸ªç‰¹å¾&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;trainX&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trainY&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;testX&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;testY&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id="3-å‚æ•°åˆå§‹åŒ–"&gt;3. å‚æ•°åˆå§‹åŒ–
&lt;/h2&gt;&lt;p&gt;è¿™é‡Œï¼Œæˆ‘ä»¬è¦åˆå§‹åŒ–å‚æ•°$W$å’Œ$b$ï¼Œå…¶ä¸­$W \in \mathbb{R}^m$ï¼Œ$b \in \mathbb{R}$ï¼Œåˆå§‹åŒ–çš„ç­–ç•¥æ˜¯å°†$W$åˆå§‹åŒ–æˆä¸€ä¸ªéšæœºæ•°çŸ©é˜µï¼Œå‚æ•°$b$ä¸º0ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;initialize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; å‚æ•°åˆå§‹åŒ–ï¼Œå°†Wåˆå§‹åŒ–æˆä¸€ä¸ªéšæœºå‘é‡ï¼Œbæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º1çš„å‘é‡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; Parameters
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>å†³ç­–æ ‘ä¸ºä»€ä¹ˆè¦å¼•å…¥éšæœºæ•°</title><link>https://davidham3.github.io/blog/p/%E5%86%B3%E7%AD%96%E6%A0%91%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%BC%95%E5%85%A5%E9%9A%8F%E6%9C%BA%E6%95%B0/</link><pubDate>Sat, 01 Sep 2018 14:40:52 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E5%86%B3%E7%AD%96%E6%A0%91%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%BC%95%E5%85%A5%E9%9A%8F%E6%9C%BA%E6%95%B0/</guid><description>&lt;p&gt;æœ€è¿‘åœ¨ä½¿ç”¨scikit-learnçš„å†³ç­–æ ‘çš„æ—¶å€™å‘ç°æ¯æ¬¡ç”Ÿæˆçš„æ ‘éƒ½ä¸ä¸€æ ·ã€‚å‘ç°å†³ç­–æ ‘é‡Œé¢çš„æœ‰ä¸ªrandom_stateçš„å‚æ•°ï¼Œä½†æ˜¯æ²¡æƒ³æ˜ç™½ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¹ˆä¸ªå‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘ç»™æœ¬ç§‘ç”Ÿçš„æœºå™¨å­¦ä¹ è¯¾ç¨‹åšåŠ©æ•™ï¼Œéœ€è¦ç»™ä»–ä»¬å‡ºä½œä¸šé¢˜ï¼Œæƒ³åšä¸€ä¸ªå†³ç­–æ ‘ç›¸å…³çš„ç»ƒä¹ ï¼Œç”Ÿæˆäº†ä¸€æ‰¹éšæœºæ•°æ®ï¼Œç„¶åç”»å‡ºå†³ç­–æ ‘çš„decision boundaryï¼Œç»“æœå‘ç°ï¼Œè¿™ä¸ªè¾¹ç•Œæ¯æ¬¡éƒ½ä¸ä¸€æ ·ï¼Œç„¶åå°±æ²¡æƒ³æ˜ç™½ï¼Œå†³ç­–æ ‘æ¯æ¬¡ç”Ÿæˆçš„ä¸åº”è¯¥æ˜¯ä¸€æ ·çš„æ ‘å—ï¼Œä¸ºä»€ä¹ˆè¾¹ç•Œä¼šå˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;æŸ¥äº†ä¸€ä¸‹ä¹‹åï¼Œå‘ç°å¦‚æœå†³ç­–æ ‘å¯¹è¿ç»­æ€§å˜é‡è¿›è¡Œåˆ†ç±»çš„æ—¶å€™ï¼Œéœ€è¦å–ä¸€ä¸ªä¸­é—´å€¼ï¼Œè¿™ä¸ªä¸­é—´å€¼ä¸€èˆ¬è¦åŠ å…¥éšæœºå› ç´ ï¼Œè¿™æ ·ç”Ÿæˆçš„æ ‘å°±ä¸ä¸€æ ·äº†ã€‚&lt;/p&gt;</description></item><item><title>Scheduled Sampling for Sequence Prediction with Recurrent Neural Networks</title><link>https://davidham3.github.io/blog/p/scheduled-sampling-for-sequence-prediction-with-recurrent-neural-networks/</link><pubDate>Sat, 11 Aug 2018 10:14:13 +0000</pubDate><guid>https://davidham3.github.io/blog/p/scheduled-sampling-for-sequence-prediction-with-recurrent-neural-networks/</guid><description>&lt;p&gt;NIPS 2015. åœ¨è®­ç»ƒseq2seqçš„æ—¶å€™ï¼Œæ¯”å¦‚åƒæœºå™¨ç¿»è¯‘ï¼Œè®­ç»ƒçš„æ—¶å€™ï¼Œæ¯ä¸ªè¾“å‡ºyï¼Œå®ƒæ‰€ä¾æ®çš„å‰ä¸€ä¸ªè¯ï¼Œéƒ½æ˜¯æ­£ç¡®çš„ã€‚ä½†æ˜¯åœ¨é¢„æµ‹çš„æ—¶å€™ï¼Œè¾“å‡ºçš„è¿™ä¸ªè¯ä¾ç…§çš„ä¸Šä¸€ä¸ªè¯ï¼Œæ˜¯æ¨¡å‹è¾“å‡ºçš„è¯ï¼Œæ— æ³•ä¿è¯æ˜¯æ­£ç¡®çš„ï¼Œè¿™å°±ä¼šé€ æˆæ¨¡å‹çš„è¾“å…¥å’Œé¢„æµ‹çš„åˆ†å¸ƒä¸ä¸€è‡´ï¼Œå¯èƒ½ä¼šé€ æˆé”™è¯¯çš„ç´¯ç§¯ã€‚æœ¬æ–‡æå‡ºäº†scheduled samplingæ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1506.03099" target="_blank" rel="noopener"
&gt;Scheduled Sampling for Sequence Prediction with Recurrent Neural Networks&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;å¾ªç¯ç¥ç»ç½‘ç»œå¯ä»¥è®­ç»ƒæˆç»™å®šä¸€äº›è¾“å…¥ï¼Œè¾“å‡ºä¸€äº›tokençš„æ¨¡å‹ï¼Œæ¯”å¦‚æœ€è¿‘çš„æœºå™¨ç¿»è¯‘å’Œå›¾åƒæè¿°ã€‚ç°åœ¨è®­ç»ƒè¿™äº›çš„æ–¹æ³•åŒ…æ‹¬ç»™å®šå½“å‰çŠ¶æ€å’Œä¹‹å‰çš„tokenï¼Œæœ€å¤§åŒ–åºåˆ—ä¸­æ¯ä¸ªtokençš„ä¼¼ç„¶ã€‚åœ¨æ¨ç†é˜¶æ®µï¼ŒæœªçŸ¥çš„tokenä¼šè¢«æ¨¡å‹ç”Ÿæˆçš„tokenæ›¿ä»£ã€‚è¿™ç§åœ¨è®­ç»ƒå’Œæ¨æ–­ä¹‹é—´çš„å·®å¼‚ï¼Œä¼šåœ¨ç”Ÿæˆåºåˆ—æ—¶äº§ç”Ÿå¿«é€Ÿç§¯ç´¯çš„è¯¯å·®ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªé€’è¿›å­¦ä¹ ç­–ç•¥(curriculum learning strategy)è½»å¾®åœ°å°†è®­ç»ƒè¿‡ç¨‹è¿›è¡Œä¸€äº›æ”¹å˜ï¼Œä»ä¹‹å‰çš„å®Œå…¨ä½¿ç”¨ä¸€ä¸ªçœŸå®çš„tokenè¿›è¡Œå¼•å¯¼çš„ç­–ç•¥ï¼Œå˜æˆäº†åŸºæœ¬ä½¿ç”¨ç”Ÿæˆçš„tokenæ¥å¼•å¯¼çš„ç­–ç•¥ã€‚åœ¨å‡ ä¸ªåºåˆ—é¢„æµ‹çš„å®éªŒä¸Šè¡¨æ˜æˆ‘ä»¬çš„æ–¹æ³•æœ‰å¾ˆå¤§çš„æå‡ã€‚æ­¤å¤–ï¼Œå®ƒæˆåŠŸçš„åœ¨MSCOCOå›¾åƒæè¿°2015ä»»åŠ¡ä¸Šè·å¾—å† å†›ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 Introduction
&lt;/h1&gt;&lt;p&gt;å¾ªç¯ç¥ç»ç½‘ç»œå¯ä»¥ç”¨äºå¤„ç†åºåˆ—ï¼Œè¦ä¹ˆè¾“å…¥ï¼Œè¦ä¹ˆè¾“å‡ºï¼Œæˆ–è€…éƒ½å¯ä»¥ã€‚å°½ç®¡ä»–ä»¬å¾ˆéš¾åœ¨é•¿æœŸä¾èµ–çš„æ•°æ®ä¸Šè®­ç»ƒï¼Œä¸€äº›å¦‚LSTMçš„ç‰ˆæœ¬å¯ä»¥æ›´å¥½çš„é€‚åº”è¿™ç§é—®é¢˜ã€‚äº‹å®æ˜¯ï¼Œæœ€è¿‘åœ¨ä¸€äº›åºåˆ—é¢„æµ‹é—®é¢˜ä¸Šï¼ŒåŒ…æ‹¬æœºå™¨ç¿»è¯‘ï¼Œcontextual parsingï¼Œå›¾åƒæè¿°ç”šè‡³è§†é¢‘æè¿°ä¸Šï¼Œè¿™äº›æ¨¡å‹è¡¨ç°çš„å¾ˆå¥½ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘ç”Ÿæˆå¯å˜å¤§å°çš„tokençš„åºåˆ—çš„é—®é¢˜ï¼Œæ¯”å¦‚æœºå™¨ç¿»è¯‘ï¼Œç›®æ ‡æ˜¯ç»™å®šæºè¯­è¨€ç¿»è¯‘æˆç›®æ ‡è¯­è¨€ã€‚æˆ‘ä»¬ä¹Ÿè€ƒè™‘å½“è¾“å…¥ä¸æ˜¯ä¸€ä¸ªåºåˆ—çš„é—®é¢˜ï¼Œå¦‚å›¾åƒæè¿°é—®é¢˜ï¼Œç›®æ ‡æ˜¯å¯¹ç»™å®šçš„å›¾åƒç”Ÿæˆä¸€ä¸ªæ–‡æœ¬æè¿°ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸¤ç§æƒ…å†µï¼Œå¾ªç¯ç¥ç»ç½‘ç»œä¸€èˆ¬éƒ½æ˜¯é€šè¿‡ç»™å®šçš„è¾“å…¥ï¼Œæœ€å¤§åŒ–ç”Ÿæˆç›®æ ‡åºåˆ—çš„ä¼¼ç„¶ã€‚å®é™…ä¸Šï¼Œè¿™ä¸ªæ˜¯é€šè¿‡ç»™å®šå½“å‰æ¨¡å‹çš„çŠ¶æ€å’Œä¹‹å‰çš„ç›®æ ‡tokenï¼Œæœ€å¤§åŒ–æ¯ä¸ªç›®æ ‡tokençš„ä¼¼ç„¶ï¼Œè¿™ä½¿å¾—æ¨¡å‹å¯ä»¥åœ¨ç›®æ ‡tokenä¸Šå­¦ä¹ ä¸€ç§è¯­è¨€æ¨¡å‹ã€‚ç„¶è€Œï¼Œåœ¨æ¨æ–­è¿‡ç¨‹ä¸­ï¼ŒçœŸçš„&lt;em&gt;previous&lt;/em&gt;ç›®æ ‡tokenæ˜¯æ— æ³•è·å–çš„ï¼Œè¿™å°±ä½¿å¾—æ¨¡å‹éœ€è¦ç”¨å®ƒè‡ªå·±ç”Ÿæˆçš„tokenï¼Œå¯¼è‡´æ¨¡å‹åœ¨è®­ç»ƒå’Œé¢„æµ‹æ—¶ä¼šæœ‰å·®å¼‚ã€‚é€šè¿‡ä½¿ç”¨beam searchå¯å‘å¼çš„ç”Ÿæˆå‡ ä¸ªç›®æ ‡åºåˆ—å¯ä»¥ç¼“è§£è¿™ç§å·®å¼‚ï¼Œä½†æ˜¯å¯¹äºè¿ç»­çš„çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼Œå¦‚RNNï¼Œä¸å­˜åœ¨åŠ¨æ€è§„åˆ’çš„æ–¹æ³•ï¼Œæ‰€ä»¥å³ä¾¿æ˜¯ä½¿ç”¨beam searchï¼Œè€ƒè™‘çš„åºåˆ—çš„æ•°é‡ä»ç„¶ä¼šå¾ˆå°ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦é—®é¢˜æ˜¯ï¼Œåœ¨ç”Ÿæˆåºåˆ—æ—¶è¶Šæ—©å‡ºç°é”™è¯¯ï¼Œä¼šå¯¼è‡´å°†è¿™ä¸ªé”™è¯¯è¾“å…¥è¿›æ¨¡å‹ï¼Œç„¶åä¼šæ‰©å¤§æ¨¡å‹çš„è¯¯å·®ï¼Œå› ä¸ºæ¨¡å‹ä¼šå°†å®ƒåœ¨è®­ç»ƒæ—¶æœªè§è¿‡çš„é”™è¯¯è€ƒè™‘åˆ°çŠ¶æ€ç©ºé—´å†…ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªé€’è¿›å­¦ä¹ æ–¹æ³•ï¼Œåœ¨å¯¹åºåˆ—é¢„æµ‹ä»»åŠ¡ä¸Šä½¿ç”¨RNNçš„è®­ç»ƒå’Œæ¨æµ‹æ—¶æ„å»ºäº†æ¡¥æ¢ã€‚æˆ‘ä»¬æå‡ºï¼Œæ”¹å˜è®­ç»ƒè¿‡ç¨‹ï¼Œä¸ºäº†é€æ¸åœ°ä½¿æ¨¡å‹å¤„ç†å®ƒçš„é”™è¯¯ï¼Œä½¿å®ƒåœ¨æ¨æ–­æ—¶ä¹Ÿå¯ä»¥è¿›è¡Œã€‚è¿™æ ·ï¼Œæ¨¡å‹åœ¨è®­ç»ƒæ—¶ä¼šæ¢ç´¢æ›´å¤šçš„æƒ…å†µï¼Œå› æ­¤åœ¨æ¨æ–­æ—¶ä¼šæ›´é²æ£’çš„çº æ­£å®ƒçš„é”™è¯¯ï¼Œå› ä¸ºå®ƒåœ¨è®­ç»ƒæ—¶å°±å­¦ä¹ è¿‡è¿™ä¸ªã€‚æˆ‘ä»¬ä¼šå±•ç¤ºè¿™ä¸ªæ–¹æ³•åœ¨å‡ ä¸ªåºåˆ—é¢„æµ‹é—®é¢˜ä¸Šçš„ç»“æœã€‚&lt;/p&gt;
&lt;h1 id="2-proposed-approach"&gt;2 Proposed Approach
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªç›‘ç£å­¦ä¹ ä»»åŠ¡ï¼Œè®­ç»ƒé›†æ˜¯ç»™å®šçš„ $N$ ä¸ªæ ·æœ¬çš„è¾“å…¥è¾“å‡ºå¯¹ï¼Œ$\lbrace X^i, Y^i \rbrace^N_{i=1}$ï¼Œ$X^i$ æ˜¯è¾“å…¥ï¼Œè¦ä¹ˆé™æ€ï¼ˆå›¾åƒï¼‰ï¼Œè¦ä¹ˆåŠ¨æ€ï¼ˆåºåˆ—ï¼‰ï¼Œè¾“å‡º $Y^i$ æ˜¯ä¸€ä¸ªå¯å˜æ•°é‡çš„tokençš„åºåˆ— $y^i_1, y^i_2, &amp;hellip;, y^i_{T_i}$ï¼Œtokenå±äºä¸€ä¸ªå·²çŸ¥çš„è¯å…¸ã€‚&lt;/p&gt;
&lt;h2 id="21-model"&gt;2.1 Model
&lt;/h2&gt;&lt;p&gt;ç»™å®šä¸€ä¸ªè¾“å…¥/è¾“å‡ºå¯¹å„¿ $(X, Y)$ï¼Œlog æ¦‚ç‡ $P(Y \mid X)$ å¯ç”±ä¸‹å¼è®¡ç®—ï¼š&lt;/p&gt;
$$\tag{1}
\begin{aligned}
\mathrm{log} P(Y \mid X) &amp;= \mathrm{log} P(y^T\_1 \mid X) \\
&amp;= \sum^T\_{t = 1} \mathrm{log} P(y\_t \mid y^{t-1}\_1, X)
\end{aligned}
$$&lt;p&gt;å…¶ä¸­ï¼Œ$Y$ æ˜¯é•¿åº¦ä¸º $T$ çš„åºåˆ—ï¼Œ$y_1, y_2, &amp;hellip;, y_T$ã€‚åœ¨å‰é¢çš„ç­‰å¼ä¸­ï¼Œåé¢çš„é¡¹é€šè¿‡ä¸€ä¸ªå‚æ•°ä¸º $\theta$ çš„å¾ªç¯ç¥ç»ç½‘ç»œï¼Œé€šè¿‡ä¸€ä¸ªçŠ¶æ€å‘é‡ $h_t$ä¼°è®¡å¾—åˆ°ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å‰ä¸€ä¸ªè¾“å‡º $y_{t-1}$ å’Œå‰ä¸€ä¸ªçŠ¶æ€ $h_{t-1}$ä¼°è®¡å¾—åˆ°ï¼š&lt;/p&gt;
$$\tag{2}
\mathrm{log} P(y\_t \mid y^{t-1}\_1, X; \theta) = \mathrm{log} P(y\_t \mid h\_t; \theta)
$$&lt;p&gt;å…¶ä¸­ï¼Œ$h_t$ é€šè¿‡å¦‚ä¸‹çš„ä¸€ä¸ªå¾ªç¯ç¥ç»ç½‘ç»œè®¡ç®—å¾—åˆ°ï¼š&lt;/p&gt;
$$\tag{3}
h\_t = \begin{cases}
f(X; \theta) \ \ \mathrm{if} t = 1\\
f(h\_{t-1}, y\_{t-1}; \theta) \mathrm{otherwise}.
\end{cases}
$$&lt;p&gt;$P(y_t \mid h_t; \theta)$ ç»å¸¸é€šè¿‡çŠ¶æ€å‘é‡ $h_t$ çš„ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œå˜æ¢åˆ°ä¸€ä¸ª vector of scores å®ç°ï¼Œè¿™ä¸ªå‘é‡æ˜¯è¾“å‡ºå­—å…¸çš„æ¯ä¸ªtokençš„åˆ†æ•°ï¼Œç„¶åç”¨ä¸€ä¸ª softmax ç¡®ä¿åˆ†æ•°é€‚å½“çš„å½’ä¸€åŒ–ã€‚$f(h, y)$é€šå¸¸æ˜¯ä¸€ä¸ªéçº¿æ€§å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°èåˆäº†ä¹‹å‰çš„çŠ¶æ€å’Œä¹‹å‰çš„è¾“å‡ºæ¥ç”Ÿæˆå½“å‰çš„çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ„å‘³ç€æ¨¡å‹ä¸“æ³¨äºç»™å®šæ¨¡å‹å½“å‰çŠ¶æ€ï¼Œå­¦ä¹ é¢„æµ‹ä¸‹ä¸€ä¸ªè¾“å‡ºã€‚å› æ­¤ï¼Œæ¨¡å‹ä¼šä»¥æœ€æ™®é€šçš„å½¢å¼è¡¨ç¤ºåºåˆ—çš„æ¦‚ç‡åˆ†å¸ƒâ€”â€”ä¸åƒæ¡ä»¶éšæœºåœºä»¥åŠå…¶ä»–çš„æ¨¡å‹ï¼Œåœ¨ç»™å®šéšå˜é‡çŠ¶æ€åï¼Œå‡è®¾ä¸åŒæ—¶é—´æ­¥çš„è¾“å‡ºç›¸äº’ç‹¬ç«‹ã€‚æ¨¡å‹çš„å®¹é‡åªä¼šè¢«å¾ªç¯å±‚å’Œå‰å‘ä¼ æ’­å±‚çš„è¡¨ç¤ºå®¹é‡é™åˆ¶ã€‚LSTMï¼Œå› ä¸ºä»–ä»¬èƒ½å­¦ä¹ é•¿èŒƒå›´çš„ç»“æ„ï¼Œæ‰€ä»¥å¯¹è¿™ç§é—®é¢˜æ¥è¯´éå¸¸é€‚åˆï¼Œä¹Ÿå°±å¯ä»¥å­¦ä¹ åºåˆ—ä¸Šçš„rich distributionsã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å­¦ä¹ è¾¹é•¿åºåˆ—ï¼Œä¸€ä¸ªç‰¹æ®Šçš„tokenï¼Œ&lt;EOS&gt;ï¼Œè¡¨ç¤ºåºåˆ—çš„ç»“æŸè¢«æ·»åŠ è¿›å­—å…¸å’Œæ¨¡å‹ä¸­ã€‚åœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œ&lt;EOS&gt;ä¼šæ‹¼æ¥åœ¨æ¯ä¸ªåºåˆ—çš„ç»“å°¾å¤„ã€‚åœ¨æ¨ç†çš„æ—¶å€™ï¼Œæ¨¡å‹ä¼šç”Ÿæˆtokensç›´åˆ°å®ƒç”Ÿæˆäº†&lt;EOS&gt;ã€‚&lt;/p&gt;
&lt;h2 id="22-training"&gt;2.2 Training
&lt;/h2&gt;&lt;p&gt;è®­ç»ƒå¾ªç¯ç¥ç»ç½‘ç»œæ¥è§£å†³è¿™æ ·çš„é—®é¢˜é€šå¸¸é€šè¿‡mini-batchéšæœºæ¢¯åº¦ä¸‹é™æ±‚è§£ï¼Œé€šè¿‡ç»™å®šè¾“å…¥æ•°æ® $X^i$ï¼Œä¸ºæ‰€æœ‰çš„è®­ç»ƒå¯¹å„¿ $(X^i, Y^i)$æœ€å¤§åŒ–ç”Ÿæˆæ­£ç¡®çš„ç›®æ ‡åºåˆ— $Y^i$ çš„ä¼¼ç„¶ï¼Œæ‰¾åˆ°ä¸€ç»„å‚æ•°$\theta^*$ã€‚&lt;/p&gt;
$$\tag{4}
\theta^* = \mathop{\arg \max\_\theta} \sum\_{(X^i, Y^i)} \mathrm{log} P(Y^i \mid X^i; \theta)
$$&lt;h2 id="23-inference"&gt;2.3 Inference
&lt;/h2&gt;&lt;p&gt;åœ¨æ¨ç†çš„è¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹å¯ä»¥åœ¨ç»™å®š $X$ çš„æƒ…å†µä¸‹é€šè¿‡ä¸€æ¬¡ç”Ÿæˆä¸€ä¸ªtokenï¼Œç”Ÿæˆæ•´ä¸ªåºåˆ— $y^T_1$ã€‚ç”Ÿæˆä¸€ä¸ª &lt;EOS&gt; åï¼Œå®ƒæ ‡å¿—ç€åºåˆ—çš„ç»“æŸã€‚å¯¹äºè¿™ä¸ªè¿‡ç¨‹ï¼Œåœ¨æ—¶é—´ $t$ï¼Œæ¨¡å‹ä¸ºäº†ç”Ÿæˆ $y_t$ï¼Œéœ€è¦ä»æœ€åä¸€ä¸ªæ—¶é—´æˆ³è®²è¾“å‡ºçš„token $y_{t-1}$ ä½œä¸ºè¾“å…¥ã€‚å› ä¸ºæˆ‘ä»¬æ²¡æ³•çŸ¥é“çœŸæ­£çš„ä¸Šä¸€ä¸ªtokenæ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥è¦ä¹ˆé€‰æ‹©æ¨¡å‹ç»™å‡ºçš„æœ€å¯èƒ½çš„é‚£ä¸ªï¼Œè¦ä¹ˆæ ¹æ®è¿™ä¸ªæ¥æŠ½æ ·ã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®š $X$ æœç´¢æœ€å¤§æ¦‚ç‡çš„åºåˆ— $Y$ éå¸¸è´¹æ—¶ï¼Œå› ä¸ºåºåˆ—çš„é•¿åº¦æ˜¯ç»„åˆåœ°ä¸Šå‡çš„ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªbeam searchæ¥ç”Ÿæˆ $k$ ä¸ªæœ€å¥½çš„åºåˆ—ã€‚æˆ‘ä»¬é€šè¿‡ç»´æŠ¤ $m$ ä¸ªæœ€ä¼˜å€™é€‰åºåˆ—ç»„æˆçš„ä¸€ä¸ªå †æ¥åšè¿™ä¸ªã€‚æ¯æ¬¡é€šè¿‡ç»™æ¯ä¸ªå€™é€‰åºåˆ—æ‰©å……ä¸€ä¸ªtokenå¹¶æŠŠå®ƒå¢åŠ åˆ°å †å†…ï¼Œéƒ½èƒ½å¾—åˆ°ä¸€ä¸ªæ–°çš„å€™é€‰åºåˆ—ã€‚åœ¨è¿™æ­¥çš„ç»“å°¾ï¼Œå †é‡æ–°åœ°å‰ªæåˆ°åªæœ‰ $m$ ä¸ªå€™é€‰åºåˆ—ã€‚beam searchingåœ¨æ²¡æœ‰æ–°çš„åºåˆ—å¢åŠ çš„æ—¶å€™å°±ä¼šæˆªæ–­ï¼Œç„¶åè¿”å› $k$ ä¸ªæœ€ä¼˜çš„åºåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;å°½ç®¡beam searché€šå¸¸ç”¨äºåŸºäºHMMè¿™æ ·çš„æ¨¡å‹çš„ç¦»æ•£çŠ¶æ€ï¼Œè¿™äº›æ¨¡å‹å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’ï¼Œä½†æ˜¯å¯¹äºåƒRNNè¿™æ ·çš„è¿ç»­çŠ¶æ€æ¨¡å‹å°±å¾ˆéš¾äº†ï¼Œå› ä¸ºæ²¡æœ‰åŠæ³•å†è¿ç»­ç©ºé—´å†…factor the followed state pathsï¼Œå› æ­¤åœ¨beam searchè§£ç çš„æ—¶å€™ï¼Œå¯ä»¥æ§åˆ¶çš„å€™é€‰åºåˆ—çš„å®é™…æ•°é‡æ˜¯å¾ˆå°çš„ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ‰€æœ‰çš„æƒ…å†µé‡Œï¼Œå¦‚æœåœ¨æ—¶é—´ $t-1$ æœ‰ä¸€ä¸ªé”™è¯¯ç”Ÿæˆï¼Œé‚£ä¹ˆæ¨¡å‹å°±ä¼šåœ¨ä¸€ä¸ªå’Œè®­ç»ƒåˆ†å¸ƒä¸åŒçš„çŠ¶æ€ç©ºé—´ä¸­ï¼Œè€Œä¸”å®ƒä¼šåœ¨è¿™ä¸ªç©ºé—´ä¸­ä¸çŸ¥æ‰€æªã€‚æ›´ç³Ÿçš„æ˜¯ï¼Œè¿™ä¼šå¯¼è‡´æ¨¡å‹åœ¨å†³ç­–çš„æ—¶å€™å¯¼è‡´ä¸å¥½çš„å†³ç­–çš„ç´¯è®¡â€”â€”a classic problem in sequential Gibbs sampling type appraoches to sampling, where future samples can have no influence on the past.&lt;/p&gt;
&lt;h2 id="24-bridging-the-gap-with-scheduled-sampling"&gt;2.4 Bridging the Gap with Scheduled Sampling
&lt;/h2&gt;&lt;p&gt;åœ¨é¢„æµ‹token $y_t$ æ—¶ï¼Œè®­ç»ƒå’Œæ¨æ–­çš„ä¸»è¦å·®åˆ«æ˜¯æˆ‘ä»¬æ˜¯å¦ä½¿ç”¨å‰ä¸€ä¸ªçœŸå®çš„token $y_{t-1}$ï¼Œè¿˜æ˜¯ä½¿ç”¨ä¸€ä¸ªä»æ¨¡å‹å¾—åˆ°çš„ä¼°è®¡å€¼ $\hat{y}_{t-1}$ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨è¿™é‡Œæå‡ºäº†ä¸€ä¸ªé‡‡æ ·æœºåˆ¶ï¼Œä¼šåœ¨è®­ç»ƒçš„æ—¶å€™ï¼Œéšæœºåœ°é€‰æ‹© $y_{t-1}$ æˆ– $\hat{y}_{t-1}$ã€‚å‡è®¾æˆ‘ä»¬ä½¿ç”¨mini-batchéšæœºæ¢¯åº¦ä¸‹é™ï¼Œå¯¹äºè®­ç»ƒç®—æ³•çš„ç¬¬ $i$ ä¸ªmini-batchä¸­é¢„æµ‹ $y_t \in Y$ çš„æ¯ä¸ªtokenï¼Œæˆ‘ä»¬æå‡ºç”¨æŠ›ç¡¬å¸çš„æ–¹æ³•ï¼Œè®¾ä½¿ç”¨çœŸå®tokençš„æ¦‚ç‡ä¸º$\epsilon_i$ï¼Œä½¿ç”¨å®ƒä¼°è®¡çš„tokençš„æ¦‚ç‡ä¸º$(1 - \epsilon_i)$ã€‚æ¨¡å‹çš„ä¼°è®¡å€¼å¯ä»¥æ ¹æ®æ¨¡å‹çš„æ¦‚ç‡åˆ†å¸ƒ$P(y_{t-1} \mid h_{t-1})$ æ¥é‡‡æ ·è·å¾—ï¼Œæˆ–æ˜¯å– $\mathop{\arg \max_s} P(y_{t-1} = s \mid h_{t-1})$ã€‚è¿™ä¸ªè¿‡ç¨‹ç”±å›¾1æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;div align=center&gt;![Figure1](/blog/images/scheduled-sampling-for-sequence-prediction-with-recurrent-neural-networks/Fig1.jpg)
&lt;p&gt;å½“ $\epsilon_i = 1$ æ—¶ï¼Œæ¨¡å‹å°±åƒä¹‹å‰ä¸€æ ·è®­ç»ƒï¼Œä½†æ˜¯å½“ $\epsilon_i = 0$ æ—¶ï¼Œæ¨¡å‹å°±ä¼šå’Œæ¨æ–­æ—¶ä¸€æ ·è®­ç»ƒã€‚æˆ‘ä»¬è¿™é‡Œæå‡ºäº†ä¸€ä¸ªé€’è¿›å­¦ä¹ ç­–ç•¥ï¼Œåœ¨è®­ç»ƒçš„å¼€å§‹æ¥æ–­ï¼Œä»æ¨¡å‹å¯èƒ½ç”Ÿæˆçš„tokenä¸­è¿›è¡Œé‡‡æ ·ï¼Œå› ä¸ºæ­¤æ—¶æ¨¡å‹è¿˜æ²¡æœ‰è®­ç»ƒå¥½ï¼Œè¿™å¯èƒ½ä¼šä½¿æ¨¡å‹çš„æ”¶æ•›é€Ÿåº¦å˜æ…¢ï¼Œæ‰€ä»¥è¿™é‡Œé€‰æ‹©è¾ƒå¤šçš„çœŸå®tokenä¼šå¸®åŠ©è®­ç»ƒï¼›å¦ä¸€æ–¹é¢ï¼Œåœ¨è®­ç»ƒå¿«ç»“æŸçš„æ—¶å€™ï¼Œ$\epsilon_i$ åº”è¯¥æ›´å€¾å‘äºä»æ¨¡å‹çš„ç”Ÿæˆç»“æœä¸­é‡‡æ ·ï¼Œå› ä¸ºè¿™ä¸ªå¯¹åº”äº†æ¨æµ‹çš„åœºæ™¯ï¼Œè¿™æ—¶æˆ‘ä»¬ä¼šæœŸæœ›æ¨¡å‹å·²ç»æœ‰è¶³å¤Ÿå¥½çš„èƒ½åŠ›æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”é‡‡æ ·å‡ºæœ‰æ•ˆçš„tokensã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤æˆ‘ä»¬æå‡ºä½¿ç”¨ä¸€ä¸ªè§„åˆ™æ¥å‡å°‘ $\epsilon_i$ æ¥ä½œä¸º $i$ çš„å‡½æ•°ï¼Œå°±åƒç°åœ¨å¾ˆå¤šéšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•é‚£æ ·é™ä½å­¦ä¹ ç‡ä¸€æ ·ã€‚è¿™æ ·çš„è§„åˆ™å¦‚å›¾2æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;Â· Linear decay: $\epsilon_i = \mathrm{max} (\epsilon, k - ci)$ï¼Œå…¶ä¸­ $0 \leq \epsilon &amp;lt; 1$ æ˜¯ç»™æ¨¡å‹çš„çœŸå€¼æœ€å°çš„æ•°é‡ï¼Œ$k$ å’Œ $c$ æä¾›äº†è¡°å‡çš„æˆªè·å’Œæ–œç‡ï¼Œè¿™äº›ä¾èµ–äºæ”¶æ•›é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;p&gt;Â· Exponential decay: $\epsilon_i = k^i$ï¼Œå…¶ä¸­ $k &amp;lt; 1$ æ˜¯ä¸€ä¸ªä¾èµ–äºæœŸæœ›æ”¶æ•›é€Ÿåº¦çš„å¸¸é‡ã€‚&lt;/p&gt;
&lt;p&gt;Â· Inverse sigmoid decay: $\epsilon_i = k/(k + \mathrm{exp}(i/k))$ï¼Œå…¶ä¸­ $k \geq 1$ ä¾èµ–äºæœŸæœ›æ”¶æ•›é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„æ–¹æ³•å‘½åä¸º &lt;em&gt;Scheduled Sampling&lt;/em&gt;ã€‚éœ€è¦æ³¨æ„çš„æ˜¯åœ¨æ¨¡å‹è®­ç»ƒæ—¶ä»å®ƒçš„è¾“å‡ºé‡‡æ ·åˆ°å‰ä¸€ä¸ªtoken $\hat{y}_{t-1}$æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ—¶é—´ $t \rightarrow T$ å†…è¿›è¡Œæ¢¯åº¦çš„åå‘ä¼ æ’­ã€‚åœ¨å®éªŒä¸­æˆ‘ä»¬æ²¡æœ‰å°è¯•ï¼Œä¼šåœ¨æœªæ¥çš„å·¥ä½œä¸­å°è¯•ã€‚&lt;/p&gt;
&lt;div align=center&gt;![Figure2](/blog/images/scheduled-sampling-for-sequence-prediction-with-recurrent-neural-networks/Fig2.jpg)</description></item><item><title>The Emerging Field of Signal Processing on Graphs</title><link>https://davidham3.github.io/blog/p/the-emerging-field-of-signal-processing-on-graphs/</link><pubDate>Fri, 03 Aug 2018 11:06:12 +0000</pubDate><guid>https://davidham3.github.io/blog/p/the-emerging-field-of-signal-processing-on-graphs/</guid><description>&lt;p&gt;IEEE Signal Processing Magazine 2013, åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1211.0053" target="_blank" rel="noopener"
&gt;The Emerging Field of Signal Processing on Graphs: Extending High-Dimensional Data Analysis to Networks and Other Irregular Domains&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;ç¤¾äº¤ã€èƒ½æºã€è¿è¾“ã€ä¼ æ„Ÿå™¨ã€ç¥ç»ç½‘ç»œã€é«˜ç»´æ•°æ®å¾ˆå¤šéƒ½å¾ˆè‡ªç„¶åœ°ä¾èµ–äºå¸¦æƒå›¾çš„é¡¶ç‚¹ã€‚æ–°å…´çš„å›¾ä¿¡å·å¤„ç†é¢†åŸŸèåˆäº†ä»£æ•°ã€è°±å›¾ç†è®ºä¸è®¡ç®—è°æ³¢åˆ†ææ¥å¤„ç†å›¾ä¸Šçš„ä¿¡å·ã€‚åœ¨è¿™ç¯‡æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬åˆ—å‡ºäº†è¿™ä¸ªé¢†åŸŸçš„ä¸»è¦æŒ‘æˆ˜ï¼Œè®¨è®ºäº†å®šä¹‰å›¾è°±åŸŸçš„ä¸åŒæ–¹æ³•ï¼Œç‚¹æ˜äº†èåˆå›¾æ•°æ®åŸŸä¸­ä¸è§„åˆ™çš„ç»“æ„åœ¨å¤„ç†å›¾ä¿¡å·æ—¶çš„é‡è¦æ€§ã€‚ç„¶åå›é¡¾äº†å°†åŸºç¡€çš„æ“ä½œï¼Œå¦‚filtering, translation, modulation, dilation, downsamplingç­‰æŠ€æœ¯æ³›åŒ–åˆ°å›¾ä¸Šçš„æ–¹æ³•ï¼Œå¯¹å·²ç»æå‡ºçš„é«˜æ•ˆåœ°ä»å›¾ä¸­çš„é«˜ç»´æ•°æ®æå–ä¿¡æ¯çš„localized, multisacle transformsè¿›è¡Œäº†æ€»ç»“ã€‚æœ€åå¯¹ä¸€äº›é—®é¢˜ä»¥åŠæœªæ¥çš„æ‰©å±•åšäº†ä¸€äº›è®¨è®ºã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1. Introduction
&lt;/h1&gt;&lt;p&gt;å›¾æ˜¯å¾ˆå¤šæ•°æ®çš„è¡¨ç¤ºå½¢å¼ï¼Œåœ¨æè¿°å¾ˆå¤šåº”ç”¨çš„å‡ ä½•ç»“æ„æ—¶å¾ˆæœ‰ç”¨ï¼Œå¦‚ç¤¾äº¤ã€èƒ½æºã€è¿è¾“ã€ä¼ æ„Ÿå™¨ã€ç¥ç»ç½‘ç»œç­‰ã€‚å›¾ä¸­æ¯æ¡è¾¹çš„æƒé‡ï¼Œç»å¸¸è¡¨ç¤ºä¸ºä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚è¿æ¥æ€§å’Œè¾¹æƒé‡è¦ä¹ˆç”±é—®é¢˜çš„ç‰©ç†æ€§è´¨æŒ‡æ˜ï¼Œè¦ä¹ˆä»æ•°æ®ä¸­æ¨æ–­å‡ºæ¥ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè¾¹æƒé‡å¯èƒ½ä¸ç½‘ç»œä¸­ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´çš„è·ç¦»æˆåæ¯”ã€‚è¿™äº›å›¾çš„æ•°æ®å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ ·æœ¬çš„æœ‰é™é›†åˆï¼Œæ¯ä¸ªé¡¶ç‚¹ä¸€ä¸ªæ ·æœ¬ã€‚æˆ‘ä»¬ç§°è¿™äº›æ ·æœ¬ä¸ºä¸€ä¸ªå›¾ä¿¡å·ã€‚ä¸€ä¸ªå›¾ä¿¡å·çš„ä¾‹å­å¦‚å›¾1æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/the-emerging-field-of-signal-processing-on-graphs/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿è¾“ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬å…³å¿ƒåˆ†ææè¿°ç–¾ç—…ä¼ æ’­çš„ä¼ æŸ“ç—…æ•°æ®ï¼Œæè¿°ç”¨æˆ·è¿ç§»çš„äººå£æ•°æ®ï¼Œæˆ–æ˜¯æè¿°è´§ç‰©ä»“åº“çš„åå‹¤æ•°æ®ã€‚ç°åœ¨ï¼Œåœ¨å¤§è„‘å›¾åƒä¸­ï¼Œæ¨æ–­å¤§è„‘çš®å±‚ä¸Šç‹¬ç‰¹çš„åŠŸèƒ½åŒºç»“æ„ä¸Šçš„è¿æ¥æ€§å˜ä¸ºå¯èƒ½ï¼Œè¿™ç§è¿æ¥å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªå¸¦æƒå›¾ï¼Œé¡¶ç‚¹ä»£è¡¨äº†åŠŸèƒ½åŒºã€‚å› æ­¤ï¼Œnoisy fMRIå›¾åƒå¯ä»¥çœ‹ä½œæ˜¯å¸¦æƒå›¾ä¸Šçš„ä¿¡å·ã€‚å¸¦æƒå›¾ä¸€èˆ¬ç”¨æ¥è¡¨ç¤ºç»Ÿè®¡å­¦ä¹ é—®é¢˜ä¸­æ•°æ®ç‚¹ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œå¦‚è®¡ç®—æœºè§†è§‰å’Œæ–‡æœ¬åˆ†ç±»é—®é¢˜ã€‚äº‹å®ä¸Šï¼Œå¾ˆå¤šç ”ç©¶å›¾æ•°æ®åˆ†æçš„è®ºæ–‡æ˜¯ä»ç»Ÿè®¡å­¦ä¹ ç¤¾åŒºä¸­å‘è¡¨å‡ºæ¥çš„ï¼Œå› ä¸ºåŸºäºå›¾çš„æ–¹æ³•åœ¨åŠç›‘ç£å­¦ä¹ é—®é¢˜ä¸­å˜å¾—éå¸¸æµè¡Œï¼Œè¿™äº›é—®é¢˜çš„ç›®æ ‡æ˜¯ç”¨ä¸€äº›æ ‡è®°æ ·æœ¬å¯¹æœªçŸ¥çš„æ ·æœ¬è¿›è¡Œåˆ†ç±»ã€‚åœ¨å›¾åƒå¤„ç†ï¼Œå¯¹å›¾åƒçš„åƒç´ æ„é€ éå±€éƒ¨å’ŒåŠå±€éƒ¨è¿æ¥çš„å›¾çš„è¿™ç§ï¼ŒåŸºäºå›¾çš„filtering methodsçªç„¶æµè¡Œäº†èµ·æ¥ï¼Œè¿™äº›æ–¹æ³•ä¸ä»…åŸºäºåƒç´ é—´çš„ç‰©ç†ç›¸ä¼¼æ€§ï¼Œè¿˜æœ‰è¦å¤„ç†çš„å›¾åƒçš„nosiy versionsã€‚è¿™äº›æ–¹æ³•ç»å¸¸èƒ½æ›´å¥½åœ°è¯†åˆ«å¹¶è€ƒè™‘å›¾åƒçš„è¾¹å’Œæè´¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›åº”ç”¨ä¸­å¸¸è§çš„æ•°æ®å¤„ç†ä»»åŠ¡æœ‰filtering, denoising, inpainting, compressing graph signalsã€‚å¦‚ä½•åœ¨ä¸è§„åˆ™çš„åŸŸä¸­å¤„ç†ä»–ä»¬ï¼Œæ¯”å¦‚åœ¨ä»»æ„ç»“æ„çš„å›¾ä¸Šé¢ï¼Ÿå¯¹æ•°æ®çš„å­˜å‚¨ï¼Œé€šä¿¡ï¼Œåˆ†ææœ€æœ‰æ•ˆçš„ä»é«˜ç»´æ•°æ®ä¸­æå–ä¿¡æ¯çš„æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Œç»Ÿè®¡ä¸å¯è§†åŒ–ï¼Ÿä¼ ç»Ÿçš„ä¿¡å·å¤„ç†çš„æ“ä½œæˆ–ç®—æ³•å¯ä»¥ä½¿ç”¨å—ï¼Ÿåœ¨å›¾ä¸Šçš„ä¿¡å·å¤„ç†é¢†åŸŸè¿˜æœ‰ä¸€äº›è¿™æ ·çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;A. The Main Challenges of Signal Processing on Graphs&lt;/em&gt;&lt;br&gt;
å°æ³¢ï¼Œæ—¶é¢‘ï¼Œæ›²æ³¢å’Œå…¶ä»–å±€éƒ¨å˜åŒ–æ¥ç¨€ç–åœ°è¡¨ç¤ºä¸åŒç±»åˆ«çš„é«˜ç»´æ•°æ®ï¼Œå¦‚æ¬§æ°ç©ºé—´ä¸­çš„éŸ³é¢‘å’Œå›¾åƒä¿¡å·ï¼Œè¿™ç§è¡¨ç¤ºèƒ½åŠ›åœ¨ä¹‹å‰æåˆ°çš„ä¿¡å·å¤„ç†ä»»åŠ¡ä¸­å–å¾—äº†å¾ˆå¤šçš„æˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;$N$ä¸ªé¡¶ç‚¹çš„å›¾ä¿¡å·å’Œä¸€ä¸ªä¼ ç»Ÿçš„$N$ä¸ªæ ·æœ¬çš„ç¦»æ•£æ—¶åŸŸä¿¡å·å¯ä»¥çœ‹ä½œæ˜¯$\mathbb{R}^N$ä¸­çš„å‘é‡ã€‚ç„¶è€Œï¼Œä¼ ç»Ÿä¿¡å·å¤„ç†æ–¹æ³•åº”ç”¨åˆ°å›¾æ•°æ®ä¸Šçš„ä¸€ä¸ªä¸»è¦éšœç¢æ˜¯ç”¨ç¦»æ•£æ—¶åŸŸä¿¡å·çš„å¤„ç†æ–¹å¼å¤„ç†å›¾ä¿¡å·æ—¶å¿½ç•¥äº†ä¸è§„æ•´çš„æ•°æ®åŸŸå†…çš„å…³é”®ä¾èµ–ã€‚æ­¤å¤–ï¼Œä¼ ç»Ÿä¿¡å·å¤„ç†æŠ€æœ¯ä¸­çš„å¾ˆå¤šå¾ˆç®€å•çš„åŸºç¡€æ¦‚å¿µåœ¨å›¾ä¿¡å·ä¸­å˜å¾—å¾ˆæœ‰æŒ‘æˆ˜æ€§ï¼š
Â·ä¸ºäº†è®©ä¸€ä¸ªæ¨¡æ‹Ÿä¿¡å·$f(t)$å‘å³ç§»åŠ¨3ï¼Œæˆ‘ä»¬åªè¦ç®€å•çš„æ”¹å˜å˜é‡ï¼Œè€ƒè™‘$f(t-3)$å³å¯ã€‚ç„¶è€Œï¼ŒæŠŠä¸€ä¸ªå›¾ä¿¡å·å‘å³ç§»åŠ¨3çš„æ„ä¹‰å°±ä¸æ˜¯å¾ˆæ¸…æ™°äº†ã€‚æ”¹å˜å˜é‡çš„æ–¹æ³•ä¸ä¼šæœ‰æ•ˆå› ä¸º$f(\circ - 3)$æ²¡æœ‰æ„ä¹‰ã€‚ä¸€ä¸ªæœ´ç´ çš„æ–¹æ³•æ˜¯å°†é¡¶ç‚¹ä»$1$æ ‡åˆ°$N$ï¼Œå®šä¹‰$f(\circ - 3) := f(\mathrm{mod}(\circ - 3, N))$ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸ªå˜æ¢ä¾èµ–äºé¡¶ç‚¹çš„é¡ºåºçš„è¯ï¼Œè¿™ä¸ªæ–¹æ³•å°±ä¸æ˜¯å¾ˆæœ‰ç”¨äº†ã€‚ä¸å¯é¿å…çš„æ˜¯ï¼Œå¸¦æƒå›¾æ˜¯ä¸è§„åˆ™çš„ç»“æ„ï¼Œè¿™ç§ç»“æ„ç¼ºå°‘ä¸€ç§å˜æ¢çš„å¹³ç§»ä¸å˜æ€§çš„æ€§è´¨ã€‚
Â·é€šè¿‡ä¹˜ä»¥ä¸€ä¸ªå¤æ‚çš„æŒ‡æ•°é¡¹åœ¨å®æ•°çº¿ä¸Šå¯¹ä¿¡å·å»ºæ¨¡å¯¹åº”äº†å‚…é‡Œå¶åŸŸä¸­çš„å˜æ¢ã€‚ç„¶è€Œï¼Œå›¾é—®é¢˜ä¸­çš„æ¨¡æ‹Ÿè°±æ˜¯ç¦»æ•£ä¸”ä¸è§„åˆ™çš„ï¼Œå› æ­¤æ²¡æœ‰å¥½çš„æ–¹æ³•å®šä¹‰ä¸€ç§å¯¹åº”å›¾è°±åŸŸä¸­çš„å˜æ¢ã€‚
Â·ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å‡­ç›´è§‰æ¯éš”ä¸€ä¸ªæ•°æ®ç‚¹åˆ é™¤ä¸€ä¸ªæ•°æ®ç‚¹ï¼Œå¯¹ç¦»æ•£æ—¶åŸŸä¿¡å·åšä¸‹é‡‡æ ·ã€‚ä½†æ˜¯åœ¨å›¾1ä¸­çš„å›¾ä¿¡å·ä¸­è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿå¸¦æƒå›¾ä¸­çš„â€œæ¯éš”ä¸€ä¸ªé¡¶ç‚¹â€æ²¡æœ‰æ˜ç¡®çš„å«ä¹‰ã€‚
Â·ç”šè‡³æˆ‘ä»¬åšä¸€ä¸ªå›ºå®šçš„ä¸‹é‡‡æ ·ï¼Œä¸ºäº†åœ¨å›¾ä¸Šåšä¸€ä¸ªå¤šåˆ†è¾¨ç‡ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç”Ÿæˆç²—ç³™ç‰ˆæœ¬çš„å›¾çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥æ•è·åŸå§‹å›¾ä¸­åµŒå…¥çš„ç»“æ„å±æ€§ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œå¤„ç†æ•°æ®åŸŸçš„ä¸è§„åˆ™æ€§ï¼Œå›¾ç»“æ„åœ¨ä¹‹å‰æåˆ°çš„åº”ç”¨ä¸­ï¼Œå¯ä»¥è¡¨ç¤ºå¾ˆå¤šé¡¶ç‚¹çš„ç‰¹å¾ã€‚ä¸ºäº†èƒ½å¾ˆå¥½åœ°å¯¹æ•°æ®çš„å°ºåº¦è¿›è¡Œç¼©æ”¾ï¼Œå¯¹äºå›¾ä¿¡å·çš„å¤„ç†æŠ€æœ¯åº”è¯¥ä½¿ç”¨å±€éƒ¨æ“ä½œï¼Œé€šè¿‡å¯¹æ¯ä¸ªé¡¶ç‚¹ï¼Œè®¡ç®—é¡¶ç‚¹çš„é‚»å±…ï¼Œæˆ–æ˜¯å’Œå®ƒå¾ˆè¿‘çš„é¡¶ç‚¹çš„ä¿¡æ¯å¾—åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œå›¾ä¿¡å·å¤„ç†çš„ä¸»è¦æŒ‘æˆ˜æ˜¯ï¼š1. æœ‰äº›ä»»åŠ¡ä¸­å›¾æ²¡æœ‰ç›´æ¥ç»™å‡ºï¼Œéœ€è¦å†³å®šå¦‚ä½•æ„å»ºå¯ä»¥æ•è·æ•°æ®å‡ ä½•ç»“æ„çš„å¸¦æƒå›¾ï¼›2. å°†å›¾ç»“æ„æ•´åˆåˆ°å±€éƒ¨å˜æ¢æ“ä½œä¸­ï¼›3. åŒæ—¶åˆ©ç”¨è¿™äº›å¹´æ¥ä¿¡å·å¤„ç†åœ¨æ¬§æ°ç©ºé—´å‘å±•å‡ºçš„ç†è®ºæˆæœï¼›4. ç ”ç©¶å±€éƒ¨å˜æ¢çš„é«˜æ•ˆå®ç°ï¼Œä»é«˜ç»´çš„å›¾ç»“æ„æ•°æ®æˆ–å…¶ä»–ä¸è§„åˆ™æ•°æ®åŸŸä¸­æå–ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæ–°å…´çš„å›¾ä¿¡å·å¤„ç†é¢†åŸŸå°†ä»£æ•°å’Œè°±å›¾ç†è®ºçš„æ¦‚å¿µä¸è®¡ç®—è°æ³¢åˆ†æèåˆäº†èµ·æ¥ã€‚è¿™æ˜¯åœ¨ä»£æ•°å›¾ç†è®ºå’Œè°±å›¾ç†è®ºä¸­çš„æ‰©å±•ï¼›ä½†æ˜¯ï¼Œæ—©äºåå¹´å‰çš„ç ”ç©¶ä¸»è¦æ˜¯èšç„¦äºåˆ†æå›¾ï¼Œè€Œä¸æ˜¯åˆ†æå›¾çš„ä¿¡å·ã€‚&lt;/p&gt;
&lt;h1 id="2-the-graph-spectral-domains"&gt;2. The Graph Spectral Domains
&lt;/h1&gt;&lt;p&gt;è°±å›¾ç†è®ºæ˜¯èšç„¦äºæ„å»ºã€åˆ†æã€æ“ä½œå›¾çš„ï¼Œä¸æ˜¯å›¾ä¸Šçš„ä¿¡å·ã€‚åœ¨æ„å»ºæ‰©å±•å›¾ã€å›¾çš„å¯è§†åŒ–ã€è°±èšç±»ã€ç€è‰²é—®é¢˜ã€è¿˜æœ‰è®¸å¤šå¦‚åŒ–å­¦ã€ç‰©ç†ã€è®¡ç®—ç§‘å­¦é¢†åŸŸçš„é—®é¢˜ä¸Šéƒ½å¾ˆæœ‰æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;å›¾ä¿¡å·å¤„ç†é¢†åŸŸï¼Œè°±å›¾ç†è®ºè¢«ç”¨ä½œä¸€ä¸ªå®šä¹‰é¢‘è°±å’Œå›¾å‚…é‡Œå¶å˜æ¢çš„åŸºçš„æ‰©å±•çš„å·¥å…·ã€‚è¿™éƒ¨åˆ†æˆ‘ä»¬ä¼šå›é¡¾ä¸€äº›è°±å›¾ç†è®ºåŸºæœ¬çš„å®šä¹‰ä¸ç¬¦å·ï¼Œç ”ç©¶å®ƒå¦‚ä½•ä½¿å¾—ä»ä¼ ç»Ÿçš„å‚…é‡Œå¶åˆ†ææ‰©å±•å‡ºå¾ˆå¤šé‡è¦çš„æ•°å­¦ç†è®ºåˆ°å›¾è®ºä¸Šã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;A. Weighted Graphs and Graph Signals&lt;/em&gt;&lt;br&gt;
æˆ‘ä»¬åˆ†ææ— å‘ã€è¿é€šå›¾$\mathcal{G} = \lbrace \mathcal{V}, \mathcal{E}, \mathbf{W} \rbrace$ä¸Šçš„ä¿¡å·ã€‚è¾¹$e = (i, j)$è¿æ¥äº†é¡¶ç‚¹$i$å’Œ$j$ï¼Œ$W_{i,j}$è¡¨ç¤ºè¾¹çš„æƒé‡ï¼Œå¦åˆ™$w_{i,j} = 0$ã€‚å¦‚æœ$\mathcal{G}$æœ‰$M$ä¸ªè¿é€šåˆ†é‡ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¿¡å·åˆ†ä¸º$M$ä»½ï¼Œç„¶åå°†æ¯ä»½çœ‹ä½œæ˜¯ä¸€ä¸ªå­å›¾è¿›è¡Œå¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;å½“è¾¹çš„æƒé‡æ²¡æœ‰ç»™å‡ºçš„æ—¶å€™ï¼Œä¸€ç§å¸¸ç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªå¸¦é˜ˆå€¼çš„é«˜æ–¯æ ¸æƒé‡å‡½æ•°ï¼š
&lt;/p&gt;
$$\tag{1}
W\_{i,j} = \begin{cases}
\exp{(-\frac{[dist(i,j)]^2}{2\theta^2})} \quad &amp;\text{if } dist(i, j) \leq \kappa \\
0 \quad &amp;\text{otherwise}
\end{cases},
$$&lt;p&gt;
å‚æ•°æ˜¯$\theta$å’Œ$\kappa$ã€‚å¼1ä¸­ï¼Œ$dist(i, j)$è¡¨ç¤ºé¡¶ç‚¹$i$å’Œ$j$ä¹‹é—´çš„ç‰©ç†è·ç¦»ï¼Œæˆ–æ˜¯ä¸¤ä¸ªé¡¶ç‚¹çš„ç‰¹å¾å‘é‡çš„æ¬§æ°ç©ºé—´ä¸­çš„è·ç¦»ï¼Œåè€…åœ¨åŠç›‘ç£å­¦ä¹ ä»»åŠ¡ä¸­å¾ˆå¸¸ç”¨ã€‚å¦ä¸€ä¸ªå¸¸ç”¨çš„æ–¹æ³•æ˜¯åŸºäºç‰©ç†è·ç¦»æˆ–ç‰¹å¾ç©ºé—´è·ç¦»ï¼Œå°†é¡¶ç‚¹ä¸å®ƒçš„$k$æœ€è¿‘é‚»é¡¶ç‚¹ç›¸è¿ã€‚å…¶ä»–æ„å»ºå›¾çš„æ–¹æ³•ï¼Œè§ç¬¬å››ç« ï¼Œ14ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªå®šä¹‰åœ¨å›¾çš„é¡¶ç‚¹ä¸Šçš„ä¿¡å·æˆ–å‡½æ•°$f: \mathcal{V} \rightarrow \mathbb{R}$å¯èƒ½è¡¨ç¤ºæˆä¸€ä¸ªå‘é‡$\mathbf{f} \in \mathbb{R}^N$ï¼Œç¬¬$i$ä¸ªåˆ†é‡è¡¨ç¤ºé¡¶ç‚¹é›†$\mathcal{V}$ä¸­çš„ç¬¬$i$ä¸ªé¡¶ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;B. The Non-Normalized Graph Laplacian&lt;/em&gt;
éå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼Œä¹Ÿç§°ä¸ºç»„åˆæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ(combinatorial graph Laplacian)ï¼Œå®šä¹‰ä¸º$\bf L := D - W$ï¼Œ$\bf{D}$æ˜¯å¯¹è§’çŸ©é˜µï¼Œå¯¹è§’çº¿ä¸Šçš„ç¬¬$i$ä¸ªå…ƒç´ ç­‰äºä¸é¡¶ç‚¹$i$ç›¸å…³çš„è¾¹çš„æƒé‡ä¹‹å’Œã€‚æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µæ˜¯ä¸€ä¸ªå·®æ“ä½œï¼Œå› ä¸ºå¯¹äºä»»æ„ä¸€ä¸ªä¿¡å·$\mathbf{f} \in \mathbb{R}^N$ï¼Œå®ƒæ»¡è¶³ï¼š
&lt;/p&gt;
$$
(\mathbf{L}f)(i) = \sum\_{j \in \mathcal{N}\_i} W\_{i,j}[f(i) - f(j)],
$$&lt;p&gt;
é‚»å±…$\mathcal{N}_i$æ˜¯ä¸é¡¶ç‚¹$i$é€šè¿‡ä¸€æ¡è¾¹ç›¸è¿çš„é¡¶ç‚¹é›†åˆã€‚æˆ‘ä»¬ç”¨$\mathcal{N}(i, k)$è¡¨ç¤ºé€šè¿‡$k$æ­¥æˆ–å°äº$k$æ­¥è¿æ¥åˆ°é¡¶ç‚¹$i$çš„é¡¶ç‚¹é›†åˆã€‚
å› ä¸ºå›¾çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ$L$æ˜¯å®å¯¹ç§°çŸ©é˜µï¼Œå®ƒçš„ç‰¹å¾å‘é‡ç›¸äº’æ­£äº¤ï¼Œæˆ‘ä»¬è¡¨ç¤ºä¸º$\lbrace \mathbf{u}_l \rbrace_{l=0,1,&amp;hellip;,N-1}$ã€‚è¿™äº›ç‰¹å¾å‘é‡å¯¹åº”éè´Ÿçš„ç‰¹å¾å€¼$\lbrace \lambda_l\rbrace_{l=0,1,&amp;hellip;,N-1}$ï¼Œæ»¡è¶³$L \mathbf{u}_l = \lambda_l \mathbf{u}_l$ï¼Œ$l = 0,1,&amp;hellip;,N-1$ã€‚é›¶ä½œä¸ºç‰¹å¾å€¼,å…¶å¤šé‡æ€§ç­‰äºå›¾çš„è¿é€šåˆ†é‡æ•°ï¼Œå› ä¸ºæˆ‘ä»¬è€ƒè™‘çš„æ˜¯è¿é€šå›¾ï¼Œæˆ‘ä»¬å‡è®¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å€¼çš„é¡ºåºä¸ºï¼š$0 = \lambda_0 &amp;lt; \lambda_1 \leq \lambda_2 &amp;hellip; \leq \lambda_{N-1} := \lambda_{\text{max}}$ã€‚æˆ‘ä»¬å°†æ•´ä¸ªè°±è¡¨ç¤ºä¸º$\sigma(L) = \lbrace \lambda_0, \lambda_1, &amp;hellip;, \lambda_{N-1}\rbrace$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;C. A Graph Fourier Transform and Notion of Frequency&lt;/em&gt;
ä¼ ç»Ÿçš„å‚…é‡Œå¶å˜æ¢
&lt;/p&gt;
$$
\hat{f}(\xi) := \langle f, e^{2\pi i \xi t} \rangle = \int\_\mathbb{R} f(t) e^{-2\pi i \xi t}dt
$$&lt;p&gt;
æ˜¯å‡½æ•°$f$æ ¹æ®å¤æŒ‡æ•°çš„æ‰©å±•ï¼Œæ˜¯ä¸€ç»´æ‹‰æ™®æ‹‰æ–¯ç®—å­çš„ç‰¹å¾å‡½æ•°ï¼š
&lt;/p&gt;
$$\tag{2}
-\Delta(e^{2\pi i \xi t}) = -\frac{\partial^2}{\partial t^2} e^{2\pi i \xi t} = (2 \pi \xi)^2 e^{2\pi i \xi t}.
$$&lt;p&gt;ç±»æ¯”è¿™ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä»»ä½•ä¸€ä¸ªåœ¨å›¾$\mathcal{G}$çš„é¡¶ç‚¹ä¸Šçš„å‡½æ•°$\mathbf{f} \in \mathbb{R}^N$çš„å›¾å‚…é‡Œå¶å˜æ¢$\hat{\mathbf{f}}$ï¼Œæ ¹æ®å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å‘é‡å¯¹$\mathbf{f}$çš„æ‰©å±•ï¼š
&lt;/p&gt;
$$\tag{3}
\hat{f}(\lambda\_l) := \langle \mathbf{f}, \mathbf{u}\_l \rangle = \sum^N\_{i = 1} f(i) u^*\_l (i).
$$&lt;p&gt;
é€†å›¾å‚…é‡Œå¶å˜æ¢ä¸ºï¼š
&lt;/p&gt;
$$\tag{4}
f(i) = \sum^{N - 1}\_{l = 0} \hat{f}(\lambda\_l) u\_l(i).
$$&lt;p&gt;ä¼ ç»Ÿçš„å‚…é‡Œå¶åˆ†æä¸­ï¼Œå¼2ä¸­çš„ç‰¹å¾å€¼$\lbrace (2 \pi \xi )^2 \rbrace_{\xi \in \mathbb{R}}$å¯¹é¢‘ç‡æœ‰ç‰¹æ®Šæ€§ï¼šå¯¹äº$\xi$æ¥è¿‘0ï¼ˆä½é¢‘ï¼‰ï¼Œå¯¹åº”çš„å¤æŒ‡æ•°ç‰¹å¾å‡½æ•°æ˜¯å¹³æ»‘çš„ï¼Œéœ‡è¡æ…¢çš„å‡½æ•°ï¼Œè€Œ$\xi$è¿œç¦»0ï¼ˆé«˜é¢‘ï¼‰çš„å¯¹åº”çš„å¤æŒ‡æ•°ç‰¹å¾å‡½æ•°éœ‡è¡çš„å¾ˆå¿«ã€‚åœ¨å›¾ä»»åŠ¡ä¸­ï¼Œå›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡åœ¨é¢‘ç‡ä¸Šæä¾›äº†ç›¸ä¼¼çš„ç‰¹ç‚¹ã€‚å¯¹äºè¿é€šå›¾ï¼Œæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„å¯¹åº”ç‰¹å¾å€¼ä¸º0çš„ç‰¹å¾å‘é‡$\mathbf{u}_0$æ˜¯ä¸å˜çš„ï¼Œä¸”æ¯ä¸ªé¡¶ç‚¹çš„å€¼ä¸º$\frac{1}{\sqrt{N}}$ã€‚å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å‘é‡ä¸­å¯¹åº”ä½é¢‘çš„$\lambda_l$åœ¨å›¾ä¸Šå˜åŒ–çš„æ…¢ï¼›ä¹Ÿå°±æ˜¯ï¼Œå¦‚æœä¸¤ä¸ªé¡¶ç‚¹é€šè¿‡ä¸€æ¡æƒé‡å¾ˆå¤§çš„è¾¹è¿æ¥ï¼Œè¿™äº›åœ°æ–¹çš„ç‰¹å¾å‘é‡çš„å€¼å°±ä¼šå˜å¾—æ¯”è¾ƒç›¸ä¼¼ã€‚å¯¹åº”å¤§çš„ç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡åœ¨å›¾ä¸Šå˜åŒ–çš„æ›´å¿«ï¼Œä¸”è¾¹çš„æƒé‡è¶Šé«˜ï¼Œè¿™äº›é¡¶ç‚¹ä¸Šçš„å€¼è¶Šä¸ç›¸ä¼¼ã€‚å›¾2ç»™å‡ºäº†ä¸åŒçš„éšæœºçš„sensorç½‘ç»œçš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å‘é‡ï¼Œå›¾3å±•ç¤ºäº†æ¯ä¸ªç‰¹å¾å‘é‡zero crossingçš„æ•°é‡$\vert Z_\mathcal{G}(\cdot) \vert$ã€‚ä¸€ä¸ªä¿¡å·$\bf{f}$åœ¨å›¾$\mathcal{G}$çš„zero crossingçš„é›†åˆå®šä¹‰ä¸ºï¼š
&lt;/p&gt;
$$
Z\_\mathcal{G}(\mathbf{f}) := \lbrace e = (i, j) \in \Large\varepsilon \normalsize : f(i)f(j) &lt; 0 \rbrace;
$$&lt;p&gt;
ä¹Ÿå°±æ˜¯ï¼Œè¿æ¥ä¸€ä¸ªæ­£ä¿¡å·å’Œä¸€ä¸ªè´Ÿä¿¡å·çš„è¾¹çš„é›†åˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/the-emerging-field-of-signal-processing-on-graphs/Fig2.JPG"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/the-emerging-field-of-signal-processing-on-graphs/Fig3.JPG"
loading="lazy"
alt="Figure3"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;D. Graph Signal Representations in Two Domains&lt;/em&gt;&lt;br&gt;
å›¾å‚…é‡Œå¶å˜æ¢(3)å’Œå®ƒçš„é€†(4)ç»™äº†æˆ‘ä»¬ä¸€ç§æ–¹å¼åœ¨ä¸¤ä¸ªä¸åŒçš„åŸŸä¸­ç­‰ä»·çš„è¡¨ç¤ºä¸€ä¸ªä¿¡å·ï¼šé¡¶ç‚¹åŸŸå’Œå›¾è°±åŸŸã€‚å°½ç®¡æˆ‘ä»¬ç»å¸¸ä»é¡¶ç‚¹åŸŸçš„ä¸€ä¸ªä¿¡å·$\bf{g}$å¼€å§‹ï¼Œç›´æ¥åœ¨å›¾è°±åŸŸä¸­å®šä¹‰ä¸€ä¸ªä¿¡å·$\hat{\bf{g}}$å¯èƒ½ä»ç„¶æ˜¯æœ‰ç”¨çš„ã€‚æˆ‘ä»¬ç§°è¿™æ ·çš„ä¿¡å·ä¸º&lt;em&gt;æ ¸(kernels)&lt;/em&gt;ã€‚å›¾4aå’Œå›¾4bä¸­ï¼Œä¸€ä¸ªè¿™æ ·çš„æ ¸ï¼Œä¸€ä¸ªheat kernelï¼Œåˆ†åˆ«å±•ç¤ºäº†åœ¨ä¸¤ä¸ªåŸŸä¸­çš„æ•ˆæœã€‚ç±»æ¯”ä¼ ç»Ÿçš„æ¨¡æ‹Ÿæƒ…å†µï¼Œå›¾4ä¸­å±•ç¤ºçš„ä¸€ä¸ªå¹³ç¼“çš„ä¿¡å·å›¾å‚…é‡Œå¶ç³»æ•°è¡°å‡çš„å¾ˆå¿«ã€‚è¿™æ ·çš„ä¿¡å·æ˜¯&lt;em&gt;å¯å‹ç¼©çš„(compressible)&lt;/em&gt;ï¼Œå› ä¸ºå¯ä»¥é€šè¿‡è°ƒæ•´ä¸€äº›å›¾å‚…é‡Œå¶ç³»æ•°æ¥è¶‹è¿‘ä»–ä»¬ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/the-emerging-field-of-signal-processing-on-graphs/Fig4.JPG"
loading="lazy"
alt="Figure4"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;E. Discrete Calculus and Signal Smoothness with Respect to the Intrinsic Structure of the Graph&lt;/em&gt;&lt;br&gt;
åˆ†æä¿¡å·æ—¶ï¼Œéœ€è¦å¼ºè°ƒä¸€ç‚¹æ˜¯ï¼Œå±æ€§ï¼ˆå¦‚smoothnessï¼‰ä¸æ•°æ®åŸŸçš„å†…åœ¨ç»“æ„ç›¸å¯¹åº”ï¼Œåœ¨æˆ‘ä»¬è®¨è®ºçš„ç¯å¢ƒä¸­ï¼Œå°±æ˜¯å¸¦æƒå›¾ã€‚å°½ç®¡å¾®åˆ†å‡ ä½•æä¾›äº†æ–¹æ³•å°†æ½œåœ¨æµå½¢çš„å‡ ä½•ç»“æ„æ•´åˆè¿›å¯å¾®åˆ†æµå½¢ä¸Šè¿ç»­ä¿¡å·çš„åˆ†æä¸­ï¼Œ*ç¦»æ•£å¾®ç§¯åˆ†(discrete calculus)*æä¾›äº†ä¸€ç»„å¯ä»¥åœ¨æœ‰é™ç¦»æ•£ç©ºé—´ä¸­æ“ä½œçš„å¤šå˜é‡å¾®ç§¯åˆ†çš„å®šä¹‰ä¸å¯å¾®åˆ†æ“ä½œå™¨ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å¢åŠ smoothnesså¯¹åº”å›¾çš„å†…åœ¨ç»“æ„çš„é—®é¢˜ï¼Œæˆ‘ä»¬ç®€å•çš„æä¸€äº›ç¦»æ•£å¯å¾®åˆ†æ“ä½œã€‚ä¸€ä¸ªä¿¡å·$\bf{f}$åœ¨é¡¶ç‚¹$i$ï¼Œå¯¹äºè¾¹$e = (i, j)$çš„&lt;em&gt;è¾¹å¯¼æ•°&lt;/em&gt;(edge derivative)å®šä¹‰ä¸ºï¼š
&lt;/p&gt;
$$
\left. \frac{\partial \mathbf{f}}{\partial e} \right|\_i := \sqrt{W\_{i,j}}[f(j) - f(i)],
$$&lt;p&gt;
é¡¶ç‚¹$i$å¤„$\bf{f}$çš„å›¾æ¢¯åº¦æ˜¯ï¼š
&lt;/p&gt;
$$
\nabla\_i \mathbf{f} := [\lbrace \left. \frac{\partial f}{\partial b} \right|\_i \rbrace\_{e \in \varepsilon \ \text{s.t.} \ e=(i,j) \ \text{for some} \ j \in \mathcal{V}}].
$$&lt;p&gt;é¡¶ç‚¹$i$çš„&lt;em&gt;local variation&lt;/em&gt;
&lt;/p&gt;
$$
\begin{aligned}
\Vert \nabla\_i \mathbf{f} \Vert\_2 : &amp; = [\sum\_{e \in \varepsilon \ \text{s.t.} \ e =(i, j) \ \text{for some} \ j \in \mathcal{V}} (\left. \frac{\partial \mathbf{f}}{\partial e} \right|\_i)^2]^{\frac{1}{2}} \\
&amp; = [\sum\_{j \in \mathcal{N}\_i} W\_{i, j} [f(j) - f(i)]^2]^{\frac{1}{2}}
\end{aligned}
$$&lt;p&gt;
å¯ä»¥åº¦é‡é¡¶ç‚¹$i$å‘¨å›´çš„$\bf{f}$çš„local smoothenessï¼Œå½“é¡¶ç‚¹$i$å’Œå®ƒçš„é‚»å±…$j$çš„$\bf{f}$æœ‰ç›¸è¿‘çš„å€¼æ—¶è¿™ä¸ªå€¼è¾ƒå°ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºglobal smoothnessï¼Œ$\bf{f}$çš„&lt;em&gt;discrete p-Dirichlet form&lt;/em&gt;å®šä¹‰ä¸ºï¼š
&lt;/p&gt;
$$\tag{5}
S\_p(\mathbf{f}) := \frac{1}{p} \sum\_{i \in V} \Vert \nabla\_i \mathbf{f} \Vert^p\_2 = \frac{1}{p} \sum\_{i \in V}\LARGE[ \normalsize \sum\_{j \in \mathcal{N}\_i} W\_{i,j} [f(j) - f(i)]^2 \LARGE]^{\normalsize \frac{p}{2}}.
$$&lt;p&gt;å½“$p=1$æ—¶ï¼Œ$S_1(\mathbf{f})$æ˜¯ä¿¡å·å¯¹å›¾çš„&lt;em&gt;total variation&lt;/em&gt;ã€‚å½“$p = 2$æ—¶ï¼š
&lt;/p&gt;
$$\tag{6}
\begin{aligned}
S\_2(\mathbf{f}) &amp;= \frac{1}{2}\sum\_{i \in V} \sum\_{j \in \mathcal{N}\_i} W\_{i,j} [f(j) - f(i)]^2 \\
&amp;= \sum\_{(i,j) \in \varepsilon} W\_{i,j} [f(j) - f(i)]^2 = \mathbf{f^TLf}.
\end{aligned}
$$&lt;p&gt;$S_2(\mathbf{f})$è¢«ç§°ä¸ºå›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„äºŒæ¬¡å‹ï¼Œsemi-norm $\bf \Vert f \Vert_L$å®šä¹‰ä¸ºï¼š
&lt;/p&gt;
$$
\Vert \mathbf{f} \Vert\_\mathbf{L} := \Vert \mathbf{L}^{\frac{1}{2}} \mathbf{f} \Vert\_2 = \sqrt{\mathbf{f^TLf}} = \sqrt{S\_2(\mathbf{f})}.
$$&lt;p&gt;æ³¨æ„å¼6ï¼ŒäºŒæ¬¡å‹$S_2(\mathbf{f})$ç­‰äº0å½“ä¸”ä»…å½“$\bf{f}$åœ¨æ‰€æœ‰é¡¶ç‚¹ä¸Šéƒ½ä¸ºå¸¸æ•°ï¼ˆwhich is why $\Vert \mathbf{f} \Vert_L$ is only a semi-formï¼‰ï¼Œè€Œä¸”ï¼Œæ›´ä¸€èˆ¬åœ°ï¼Œå½“ä¿¡å·$\bf{f}$åœ¨é‚£äº›é€šè¿‡å¤§æƒé‡çš„è¾¹è¿æ¥çš„é‚»å±…é¡¶ç‚¹ä¸Šæœ‰ç›¸ä¼¼å€¼æ—¶ï¼Œ$S_2(\mathbf{f})$çš„å€¼è¾ƒå°ï¼›ä¹Ÿå°±æ˜¯å½“å®ƒå¹³æ»‘çš„æ—¶å€™ã€‚&lt;/p&gt;
&lt;p&gt;å›åˆ°æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ä¸Šï¼ŒCourant-Fischer TheoremæŒ‡å‡ºï¼Œä»–ä»¬ä¹Ÿå¯ä»¥é€šè¿‡Rayleigh quotientå®šä¹‰ä¸ºï¼š
&lt;/p&gt;
$$\tag{7}
\lambda\_0 = \min\_{ \mathbf{f} \in \mathbb{R}^N, \Vert \mathbf{f} \Vert\_2 = 1} \lbrace \mathbf{f^TLf} \rbrace,
$$&lt;p&gt;
&lt;/p&gt;
$$\tag{8}
\text{and} \ \lambda\_l = \min\_{ \mathbf{f} \in \mathbb{R}^N, \Vert \mathbf{f} \Vert\_2 = 1, \mathbf{f} \perp span\lbrace \mathbf{u}\_0, ..., \mathbf{u}\_{l-1} \rbrace} \lbrace \mathbf{f^TLf} \rbrace, \ l = 1, 2, ..., N-1.
$$&lt;p&gt;
å…¶ä¸­ï¼Œç‰¹å¾å‘é‡$\mathbf{u}_l$æ˜¯ç¬¬$l$ä¸ªé—®é¢˜çš„æœ€å°åŒ–é—®é¢˜çš„è§£ã€‚ä»å¼6å’Œå¼7ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡çœ‹å‡ºä¸ºä»€ä¹ˆ$\mathbf{u}_0$å¯¹äºè¿é€šå›¾æ¥è¯´æ˜¯å¸¸æ•°ã€‚å¼8è§£é‡Šäº†ä¸ºä»€ä¹ˆæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µä¸­å¯¹åº”å°çš„ç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡æ›´å¹³æ»‘ï¼Œä¹Ÿæä¾›äº†å¦ä¸€ä¸ªå¯¹ä¸ºä»€ä¹ˆæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„è°±åæ˜ äº†é¢‘ç‡çš„è§£é‡Šã€‚&lt;/p&gt;
&lt;p&gt;æ€»ç»“ä¸€ä¸‹ï¼Œå›¾çš„è¿é€šæ€§ç¼–ç è¿›äº†æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼Œæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µé€šå¸¸ç”¨äºå®šä¹‰å›¾å‚…é‡Œå¶å˜æ¢ï¼ˆé€šè¿‡ç‰¹å¾å‘é‡ï¼‰ï¼Œå¹³æ»‘æ€§çš„ä¸åŒè¡¨ç¤ºã€‚Example 1å±•ç¤ºäº†smoothnesså’Œä¸€ä¸ªå›¾ä¿¡å·çš„è°±å†…å®¹æ˜¯å¦‚ä½•ä¾èµ–äºå›¾çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/the-emerging-field-of-signal-processing-on-graphs/Example1.JPG"
loading="lazy"
alt="â€œExample 1â€"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;F. Other Graph Matrices&lt;/em&gt;
å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„åŸº$\lbrace \mathbf{u}_l \rbrace_{l = 0, 1, &amp;hellip;, N - 1}$åªæ˜¯åœ¨æ­£å‘(3)å’Œé€†å‘(4)å›¾å‚…é‡Œå¶å˜æ¢ä¸­ä½¿ç”¨çš„ä¸€ç»„å¯èƒ½çš„åŸºã€‚ç¬¬äºŒä¸ªå¸¸ç”¨çš„normalizeæ¯ä¸ªæƒé‡$W_{i,j}$çš„æ–¹æ³•æ˜¯ä¹˜ä»¥$\frac{1}{\sqrt{d_i d_j}}$ã€‚è¿™æ ·å¯ä»¥å¯¹å›¾çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µå½’ä¸€åŒ–ï¼Œå®šä¹‰ä¸º$\bf\tilde{L} := D^{-\frac{1}{2}} L D^{-\frac{1}{2}}$ï¼Œç­‰ä»·äºï¼š
&lt;/p&gt;
$$
(\tilde{L}f)(i) = \frac{1}{\sqrt{d\_i}} \sum\_{j \in \mathcal{N}\_i} W\_{i,j} \LARGE[\normalsize \frac{f(i)}{\sqrt{d\_i}} - \frac{f(j)}{\sqrt{d\_j}} \LARGE].
$$&lt;p&gt;è¿é€šå›¾$\mathcal{G}$çš„å½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å€¼$\lbrace \tilde{\lambda}_l \rbrace_{l=0,1,&amp;hellip;,N-1}$æ»¡è¶³ï¼š
&lt;/p&gt;
$$
0 = \tilde{\lambda}\_0 &lt; \tilde{\lambda}\_1 \leq ... \leq \tilde{\lambda}\_{\text{max}} \leq 2,
$$&lt;p&gt;
å½“ä¸”ä»…å½“$\mathcal{G}$æ˜¯äºŒåˆ†å›¾æ—¶ï¼Œ$\tilde{\lambda}_{\text{max}} = 2$ã€‚æˆ‘ä»¬å°†å½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µè¡¨ç¤ºä¸º$\lbrace \mathbf{\tilde{u}}_l \rbrace_{l = 0,1,&amp;hellip;N-1}$ã€‚å›¾3bä¸­ï¼Œ$\tilde{L}$çš„è°±å’Œé¢‘ç‡ä¹Ÿæœ‰å…³ç³»ï¼Œå¯¹åº”å¤§çš„ç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡ä¸€èˆ¬æœ‰ç€æ›´å¤šçš„zero crossingã€‚ç„¶è€Œï¼Œä¸åƒ$\mathbf{u}_0$ï¼Œå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µä¸­å¯¹åº”ç‰¹å¾å€¼ä¸º0çš„$\tilde{\mathbf{u}}_0$ä¸æ˜¯ä¸€ä¸ªå¸¸å‘é‡ã€‚&lt;/p&gt;
&lt;p&gt;å½’ä¸€åŒ–å’Œéå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µéƒ½æ˜¯&lt;em&gt;generalized graph Laplacians&lt;/em&gt;çš„ä¾‹å­ï¼Œä¹Ÿç§°ä¸º&lt;em&gt;discrete SchrÃ¶dinger operators&lt;/em&gt;ã€‚ä¸€ä¸ªå›¾$\mathcal{G}$çš„æ³›åŒ–æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µæ˜¯ä»»æ„çš„å¯¹é˜µçŸ©é˜µï¼Œå¦‚æœè¿™ä¸ªçŸ©é˜µä¸­æœ‰è¾¹è¿æ¥é¡¶ç‚¹$i$å’Œé¡¶ç‚¹$j$ï¼Œé‚£ä¹ˆè¿™ä¸ªçŸ©é˜µçš„$(i, j)$æ˜¯è´Ÿçš„ï¼Œå¦‚æœ$i \not = j$ï¼Œè€Œä¸”$i$ä¸$j$ä¸ç›¸è¿ï¼Œé‚£ä¹ˆä¸º$0$ï¼Œå¦‚æœ$i = j$ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½æ˜¯ä»»ä½•å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰ä¸ªå¸¸ç”¨çš„çŸ©é˜µï¼Œç»å¸¸åœ¨å›¾ä¿¡å·çš„é™ç»´æŠ€æœ¯ä¸­ä½¿ç”¨ï¼Œæ˜¯&lt;em&gt;random walk matrix&lt;/em&gt;ï¼Œ$\bf{P := D^{-1}W}$ã€‚æ¯ä¸ªå€¼$P_{i,j}$è¡¨ç¤ºåœ¨å›¾$\mathcal{G}$ä¸Šä»é¡¶ç‚¹$i$åˆ°é¡¶ç‚¹$j$é€šè¿‡ä¸€æ­¥é©¬å°”å¯å¤«éšæœºæ¸¸èµ°çš„æ¦‚ç‡ã€‚å¯¹äºè¿é€šçš„ã€éå‘¨æœŸçš„å›¾ï¼Œ$\mathbf{P}^t$åœ¨$t$è¶‹è¿‘äºæ— ç©·æ—¶ï¼Œæ”¶æ•›è‡³å¹³ç¨³åˆ†å¸ƒã€‚ä¸éšæœºæ¸¸èµ°çŸ©é˜µå¯†åˆ‡ç›¸å…³çš„æ˜¯éå¯¹ç§°æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼Œå®šä¹‰ä¸º $\mathbf{L}_a := \mathbf{I}_N - \mathbf{P}$ï¼Œå…¶ä¸­$\mathbf{I}_N$è¡¨ç¤º$N \times N$çš„å•ä½é˜µã€‚æ³¨æ„$\mathbf{L}_a$æœ‰ç€å’Œ$\tilde{\mathbf{L}}$åŒæ ·çš„ç‰¹å¾å€¼é›†åˆï¼Œå¦‚æœ$\tilde{\mathbf{u}}_l$æ˜¯å¯¹åº”$\tilde{L}$çš„ç‰¹å¾å€¼$\tilde{\lambda}_l$çš„ç‰¹å¾å‘é‡ï¼Œåˆ™$\bf{D}^{-\frac{1}{2}} \tilde{\mathbf{u}}_l$æ˜¯å¯¹åº”$\mathbf{L}_a$çš„ç‰¹å¾å€¼$\tilde{\lambda}_l$çš„ç‰¹å¾å‘é‡ã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¦‚ä¸‹ä¸€èŠ‚è¦è®¨è®ºçš„ï¼Œå½’ä¸€åŒ–å’Œéå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µéƒ½èƒ½ç”¨äºfilteringã€‚æ²¡æœ‰æ˜ç¡®çš„è§„å®šè¦æ±‚ä»€ä¹ˆæ—¶å€™å¿…é¡»ä½¿ç”¨å½’ä¸€åŒ–çš„ï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨éå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å‘é‡ï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨å…¶ä»–çš„åŸºã€‚å½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µæœ‰å¾ˆå¥½çš„æ€§è´¨ï¼Œå®ƒçš„è°±æ€»æ—¶åœ¨$[0, 2]$åŒºé—´å†…ï¼Œè€Œä¸”å¯¹äºäºŒåˆ†å›¾ï¼Œspectral folding phenomenonå¯ä»¥ç ”ç©¶ã€‚ç„¶è€Œï¼Œéå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µä¸­å¯¹åº”ç‰¹å¾å€¼ä¸º0çš„ç‰¹å¾å‘é‡æ˜¯å¸¸å‘é‡ï¼Œè¿™åœ¨ä»ä¼ ç»Ÿfilteringç†è®ºæ‰©å±•å…³äºä¿¡å·çš„DC componentsä¸Šæ˜¯ä¸€ä¸ªæœ‰ç”¨çš„æ€§è´¨ã€‚&lt;/p&gt;
&lt;h1 id="3-generalized-operators-for-signals-on-graphs"&gt;3. Generalized Operators For Signals on Graphs
&lt;/h1&gt;&lt;p&gt;åœ¨è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¼šå›é¡¾ä¸åŒçš„æ–¹å¼æ¥æ³›åŒ–åŸºæœ¬æ“ä½œåˆ°å›¾ä¸Šï¼Œå¦‚filtering, translation, modulation, dilation, downsamplingã€‚è¿™äº›æ³›åŒ–çš„æ“ä½œæ˜¯ç¬¬å››éƒ¨åˆ†è¦è®¨è®ºçš„localized, multiscale transformsçš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;A. Filtering&lt;/em&gt;
ç¬¬ä¸€ä¸ªæ³›åŒ–çš„æ“ä½œæ˜¯filteringã€‚æˆ‘ä»¬ä»æ‰©å±•é¢‘ç‡æ»¤æ³¢çš„æ¦‚å¿µåˆ°å›¾ä¸Šå¼€å§‹ï¼Œç„¶åè®¨è®ºé¡¶ç‚¹åŸŸä¸Šçš„å±€éƒ¨æ»¤æ³¢ã€‚&lt;/p&gt;
&lt;h2 id="1-frequency-filtering"&gt;1. Frequency Filtering:
&lt;/h2&gt;&lt;p&gt;åœ¨ä¼ ç»Ÿçš„ä¿¡å·å¤„ç†ä¸­ï¼Œé¢‘ç‡æ»¤æ³¢æ˜¯å°†è¾“å…¥ä¿¡å·è¡¨ç¤ºæˆä¸€ä¸ªå¤æŒ‡æ•°çš„çº¿æ€§ç»„åˆï¼Œæ‰©å¤§æˆ–ç¼©å°ä¸€äº›å¤æŒ‡æ•°è´¡çŒ®çš„è¿‡ç¨‹
&lt;/p&gt;
$$\tag{9}
\hat{f}\_{out}(\xi) = \hat{f}\_{in}(\xi) \hat{h}(\xi),
$$&lt;p&gt;
å…¶ä¸­ï¼Œ$\hat{h}(\cdot)$æ˜¯æ»¤æ³¢å™¨çš„ä¼ é€’å‡½æ•°ã€‚å–å¼9çš„é€†å‚…é‡Œå¶å˜æ¢ï¼Œå‚…é‡Œå¶åŸŸä¸­çš„ä¹˜æ³•å¯¹åº”äº†æ—¶åŸŸä¸­çš„å·ç§¯ï¼š
&lt;/p&gt;
$$\tag{10}
f\_{out}(t) = \int\_\mathbb{R} \hat{f}\_{in}(\xi) \hat{h}(\xi)e^{2 \pi i \xi t} d\xi
$$&lt;p&gt;
&lt;/p&gt;
$$\tag{11}
=\intop\_\mathbb{R} f\_{in}(\tau) h(t-\tau)d\tau =: (f\_in * h)(t).
$$&lt;p&gt;
ä¸€æ—¦æˆ‘ä»¬fixä¸€ä¸ªå›¾è°±è¡¨ç¤ºï¼Œæˆ‘ä»¬çš„å›¾å‚…é‡Œå¶å˜æ¢çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†å¼9æ³›åŒ–åˆ°å®šä¹‰é¢‘ç‡æ»¤æ³¢ä¸Šï¼Œæˆ–&lt;em&gt;å›¾è°±æ»¤æ³¢&lt;/em&gt;(graph spectral filtering)ä¸Šï¼š
&lt;/p&gt;
$$\tag{12}
\hat{f}\_{out}(\lambda\_l) = \hat{f}\_{in}(\lambda\_l) \hat{h}(\lambda\_l),
$$&lt;p&gt;
æˆ–è€…ï¼Œç­‰ä»·çš„ï¼Œå–é€†å›¾å‚…é‡Œå¶å˜æ¢ï¼Œ
&lt;/p&gt;
$$\tag{13}
f\_{out}(i) = \sum^{N-1}\_{l=0} \hat{f}\_{in}(\lambda\_l) \hat{h}(\lambda\_l) u\_l(i).
$$&lt;p&gt;æ¥ç”¨matrix functions[38]ç†è®ºä¸­çš„ç¬¦å·ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¼12å’Œå¼13å†™æˆ$\mathbf{f}_{out} = \hat{h}(\mathbf{L})\mathbf{f}_{in}$ï¼Œå…¶ä¸­
&lt;/p&gt;
$$\tag{14}
\hat{h}(\mathbf{L}) := \mathbf{U} \begin{bmatrix}
\hat{h}(\lambda\_0) &amp; &amp; 0 \\
&amp; \ddots &amp; \\
0 &amp; &amp;\hat{h}(\lambda\_{N-1})
\end{bmatrix}\mathbf{U^T}
$$&lt;p&gt;åŸºç¡€çš„å›¾è°±æ»¤æ³¢å¯ä»¥ç”¨æ¥å®ç°è¿ç»­æ»¤æ³¢æŠ€æœ¯çš„ç¦»æ•£ç‰ˆï¼Œå¦‚é«˜æ–¯å¹³æ»‘ï¼ŒåŒè¾¹æ»¤æ³¢ï¼Œtotal variation filteringï¼Œanisotropic diffusionï¼Œnon-local means filteringã€‚ç‰¹åˆ«åœ°ï¼Œè¿™äº›æ»¤æ³¢å™¨ä¸­çš„å¾ˆå¤šæˆä¸ºäº†è§£å†³variational problemsçš„æ–¹æ³•ï¼Œå¯¹ill-posed inverse problemsè¿›è¡Œæ­£åˆ™åŒ–ï¼Œè¿™äº›é—®é¢˜å¦‚denoisingï¼Œinpaintingï¼Œsuper-resolutionã€‚ä¸¾ä¸ªä¾‹å­ï¼Œç¦»æ•£æ­£åˆ™æ¡†æ¶ï¼š
&lt;/p&gt;
$$\tag{15}
\min\_\mathbf{f}\lbrace \Vert \mathbf{f} - \mathbf{y} \Vert^2\_2 + \gamma S\_p(\mathbf{f}) \rbrace,
$$&lt;p&gt;
å…¶ä¸­ï¼Œ$S_p(\mathbf{f})$æ˜¯å¼5çš„p-Dirichlet formã€‚åœ¨Example 2ä¸­ï¼Œæˆ‘ä»¬ä¸¾äº†ä¸ªå¼15çš„$p = 2$æ—¶å¤„ç†å›¾åƒå»å™ªçš„é—®é¢˜çš„ä¾‹å­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/the-emerging-field-of-signal-processing-on-graphs/Example2.JPG"
loading="lazy"
alt="Example2"
&gt;&lt;/p&gt;
&lt;h2 id="2-filtering-in-the-vertex-domain"&gt;2. Filtering in the Vertex Domain:
&lt;/h2&gt;&lt;p&gt;åœ¨é¡¶ç‚¹åŸŸä¸­filterä¸€ä¸ªä¿¡å·ï¼Œåªè¦ç®€å•çš„å°†é¡¶ç‚¹$i$çš„è¾“å‡º$f_{out}(i)$å†™æˆä¸€ä¸ªé¡¶ç‚¹$i$çš„$K-hop$å±€éƒ¨é‚»å±…ä¸Šè¾“å…¥ä¿¡å·å„åˆ†é‡çš„çº¿æ€§ç»„åˆï¼š
&lt;/p&gt;
$$\tag{18}
f\_{out}(i) = b\_{i, i} f\_{in}(i) + \sum\_{j \in \mathcal{N}(i, K)} b\_{i,j} f\_{in}(j),
$$&lt;p&gt;
$\lbrace b_{i,j} \rbrace_{i,j \in \mathcal{V}}$æ˜¯å¸¸æ•°ã€‚å¼18åªè¯´æ˜äº†é¡¶ç‚¹åŸŸä¸Šçš„æ»¤æ³¢æ˜¯ä¸€ä¸ªå±€éƒ¨çš„çº¿æ€§å˜æ¢ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç°åœ¨ç®€å•åœ°å°†å›¾è°±åŸŸä¸Šçš„æ»¤æ³¢å…³è”åˆ°äº†é¡¶ç‚¹åŸŸçš„æ»¤æ³¢ä¸Šã€‚å½“å¼12ä¸­çš„é¢‘ç‡æ»¤æ³¢æ˜¯$K$é˜¶å¤šé¡¹å¼$\hat{h}(\lambda_l) = \sum^K_{k=0} a_k \lambda^k_l$æ—¶ï¼Œå…¶ä¸­$\lbrace a_k\rbrace_{k=0,1,&amp;hellip;K}$æ˜¯å¸¸æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å¼12åœ¨é¡¶ç‚¹åŸŸä¸­è§£é‡Šã€‚ç”±å¼13ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š
&lt;/p&gt;
$$\tag{19}
\begin{aligned}
f\_{out}(i) &amp; = \sum^{N-1}\_{l=0} \hat{f}\_{in}(\lambda\_l) \hat{h}(\lambda\_l) u\_l(i) \\
&amp; = \sum^N\_{j=1} f\_{in}(j) \sum^K\_{k=0} a\_k \sum^{N-1}\_{l=0} \lambda^k\_l u^*\_l(j) u\_l(i) \\
&amp; = \sum^N\_{j=1} f\_{in}(j) \sum^K\_{k=0} a\_k(\mathbf{L}^k)\_{i,j}.
\end{aligned}
$$&lt;p&gt;ç„¶è€Œï¼Œåœ¨é¡¶ç‚¹$i$åˆ°é¡¶ç‚¹$j$ä¹‹é—´çš„æœ€çŸ­è·¯å¾„è·ç¦»$d_\mathcal{G}(i,j)$å¤§äº$k$æ—¶ï¼Œ$(\mathbf{L}^k)_{i,j} = 0$ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¼19å†™æˆå¼18ï¼Œå¸¸æ•°å®šä¹‰ä¸ºï¼š
&lt;/p&gt;
$$
b\_{i,j} := \sum^K\_{k=d\_\mathcal{G}(i,j)} a\_k (\mathbf{L}^k)\_{i,j}.
$$&lt;p&gt;
æ‰€ä»¥å½“é¢‘ç‡æ»¤æ³¢æ˜¯ä¸€ä¸ª$K$é˜¶å¤šé¡¹å¼æ—¶ï¼Œé¡¶ç‚¹$i$ä¸Šé¢‘ç‡æ»¤æ³¢åçš„ä¿¡å·ï¼Œ$f_{out}(i)$ï¼Œæ˜¯é¡¶ç‚¹$i$çš„$K-hop$é‚»å±…ä¸Šçš„è¾“å…¥ä¿¡å·çš„çº¿æ€§ç»„åˆã€‚è¿™ä¸ªæ€§è´¨åœ¨å…³è”ä¸€ä¸ªå·ç§¯æ ¸çš„å¹³æ»‘æ€§ä¸é¡¶ç‚¹åŸŸä¸­æ»¤æ³¢åä¿¡å·çš„å±€éƒ¨åŒ–ä¹‹é—´å¾ˆæœ‰ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;B. Convolution&lt;/em&gt;
æˆ‘ä»¬ä¸èƒ½ç›´æ¥å°†å·ç§¯çš„å®šä¹‰ï¼ˆ11ï¼‰æ³›åŒ–åˆ°å›¾ä¸Šï¼Œå› ä¸º$h(t - \tau)$ã€‚ç„¶è€Œï¼Œä¸€ç§å®šä¹‰å›¾ä¸Šçš„å·ç§¯çš„æ–¹å¼æ˜¯æ›¿æ¢å¼10ä¸­çš„å¤æŒ‡æ•°ä¸ºæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å‘é‡ï¼š
&lt;/p&gt;
$$\tag{20}
(f * h)(i) := \sum^{N-1}\_{l=0} \hat{f}(\lambda\_l) \hat{h}(\lambda\_l) u\_l(i),
$$&lt;p&gt;
è¿™ä¸ªä½¿å¾—åœ¨é¡¶ç‚¹åŸŸä¸Šçš„å·ç§¯ç­‰ä»·äºåœ¨å›¾è°±åŸŸçš„ä¹˜æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;C. Translation&lt;/em&gt;&lt;/p&gt;</description></item><item><title>Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting</title><link>https://davidham3.github.io/blog/p/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/</link><pubDate>Tue, 31 Jul 2018 14:37:10 +0000</pubDate><guid>https://davidham3.github.io/blog/p/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/</guid><description>&lt;p&gt;ICLR 2018ï¼ŒDCRNNï¼Œæ¨¡å‹å€Ÿé‰´äº†&lt;a class="link" href="https://davidham3.github.io/blog/2018/07/23/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/" target="_blank" rel="noopener"
&gt;Structured Sequence Modeling With Graph Convolutional Recurrent Networks (ICLR 2017 reject)&lt;/a&gt;é‡Œé¢çš„DCRNNï¼Œå°†è¯¥æ¨¡å‹åº”ç”¨äºäº†äº¤é€šé¢„æµ‹ä¸Šã€‚è€Œä¸”åè€…çš„è®ºæ–‡ä½¿ç”¨çš„å·ç§¯æ˜¯Defferrardæå‡ºçš„å›¾å·ç§¯ï¼Œè¿™ç¯‡è®ºæ–‡ä¸­ä½¿ç”¨çš„æ˜¯æ‰©æ•£å·ç§¯ï¼Œè¿™ç§æ‰©æ•£å·ç§¯ä½¿ç”¨çš„æ˜¯éšæœºæ¸¸èµ°ï¼Œä¸&lt;a class="link" href="https://davidham3.github.io/blog/2018/07/19/diffusion-convolutional-neural-networks/" target="_blank" rel="noopener"
&gt;Diffusion-Convolutional Neural Networks (NIPS 2016)&lt;/a&gt;çš„æ‰©æ•£å·ç§¯è¿˜ä¸ä¸€æ ·ã€‚æ„é€ å‡ºæ¥çš„DCRNNä½¿ç”¨äº†&lt;a class="link" href="https://davidham3.github.io/blog/2018/07/23/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/" target="_blank" rel="noopener"
&gt;Structured Sequence Modeling With Graph Convolutional Recurrent Networks (ICLR 2017 reject)&lt;/a&gt;ä¸¤ç§å½¢å¼ä¸­çš„æ¨¡å‹2ï¼Œå³ä½¿ç”¨æ‰©æ•£å·ç§¯å­¦ä¹ å‡ºç©ºé—´è¡¨ç¤ºåï¼Œæ”¾å…¥GRUä¸­è¿›è¡Œæ—¶é—´ä¸Šçš„å»ºæ¨¡ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="http://arxiv.org/abs/1707.01926" target="_blank" rel="noopener"
&gt;Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="æ‘˜è¦"&gt;æ‘˜è¦
&lt;/h1&gt;&lt;p&gt;äº¤é€šé¢„æµ‹çš„æŒ‘æˆ˜ï¼š1. å¯¹è·¯ç½‘å¤æ‚çš„ç©ºé—´ä¾èµ–å…³ç³»ï¼Œ 2. è·¯å†µå˜æ¢ä¸éçº¿æ€§çš„æ—¶é—´åŠ¨æ€æ€§ï¼Œ 3. é•¿æœŸé¢„æµ‹çš„å›°éš¾æ€§ã€‚æˆ‘ä»¬æå‡ºäº†åœ¨æœ‰å‘å›¾ä¸Šå¯¹äº¤é€šæµä»¥æ‰©æ•£å½¢å¼è¿›è¡Œå»ºæ¨¡çš„æ–¹æ³•ï¼Œä»‹ç»äº† &lt;em&gt;Diffusion Convolutional Recurrent Neural Network&lt;/em&gt; (DCRNN)ï¼Œç”¨äºäº¤é€šé¢„æµ‹çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ŒåŒæ—¶é›†æˆäº†äº¤é€šæµä¸­çš„ç©ºé—´ä¸æ—¶é—´ä¾èµ–ã€‚DCRNN ä½¿ç”¨å›¾ä¸Šçš„åŒå‘éšæœºæ¸¸èµ°æ•è·äº†ç©ºé—´ä¾èµ–ï¼Œä½¿ç”¨ç¼–ç è§£ç æ¡†æ¶ä»¥åŠ scheduled sampling æ•è·æ—¶é—´ä¾èµ–ã€‚æˆ‘ä»¬åœ¨ä¸¤ä¸ªçœŸå®çš„äº¤é€šæ•°æ®é›†ä¸Šè¯„ä¼°äº†æ¨¡å‹ï¼Œæ¯” state-of-the-art å¼ºäº†12%-15%ã€‚&lt;/p&gt;
&lt;h1 id="1-å¼•è¨€"&gt;1 å¼•è¨€
&lt;/h1&gt;&lt;p&gt;å¯¹ä¸€ä¸ªåœ¨åŠ¨æ€ç³»ç»Ÿä¸­è¿è¡Œçš„å­¦ä¹ ç³»ç»Ÿæ¥è¯´ï¼Œæ—¶ç©ºé¢„æµ‹æ˜¯ä¸€ä¸ªå¾ˆå…³é”®çš„ä»»åŠ¡ã€‚è‡ªåŠ¨é©¾é©¶ã€ç”µç½‘ä¼˜åŒ–ã€ä¾›åº”é“¾ç®¡ç†ç­‰éƒ½æ˜¯å®ƒçš„åº”ç”¨ã€‚æˆ‘ä»¬ç ”ç©¶äº†ä¸€ä¸ªé‡è¦çš„ä»»åŠ¡ï¼šè·¯ç½‘ä¸Šçš„äº¤é€šé¢„æµ‹ï¼Œè¿™æ˜¯æ™ºèƒ½äº¤é€šç³»ç»Ÿä¸­çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚ç›®æ ‡æ˜¯ç»™å®šå†å²è½¦é€Ÿä¸è·¯ç½‘æ•°æ®ï¼Œé¢„æµ‹æœªæ¥çš„è½¦é€Ÿã€‚&lt;/p&gt;
&lt;p&gt;ä»»åŠ¡æœ‰æŒ‘æˆ˜æ€§çš„åŸå› æ˜¯å¤æ‚çš„æ—¶ç©ºä¾èµ–å…³ç³»ä»¥åŠé•¿æœŸé¢„æµ‹çš„ä¸Šçš„éš¾åº¦ã€‚ä¸€æ–¹é¢ï¼Œäº¤é€šæ•°æ®åºåˆ—è¡¨ç°å‡ºäº†å¼ºçƒˆçš„æ—¶é—´åŠ¨æ€æ€§(temporal dynamics)ã€‚åå¤çš„äº‹ä»¶å¦‚é«˜å³°æœŸæˆ–äº¤é€šäº‹æ•…å¯¼è‡´äº†æ•°æ®çš„éå¹³ç¨³æ€§ï¼Œä½¿å¾—é•¿æœŸé¢„æµ‹å¾ˆå›°éš¾ã€‚å¦ä¸€æ–¹é¢ï¼Œè·¯ç½‘ä¸Šçš„ç›‘æµ‹å™¨åŒ…å«äº†å¤æ‚ä½†æ˜¯å”¯ä¸€çš„ç©ºé—´è”ç³»(spatial correlations)ã€‚å›¾1å±•ç¤ºäº†ä¸€ä¸ªä¾‹å­ã€‚è·¯1å’Œè·¯2æ˜¯ç›¸å…³è”çš„ï¼Œä½†æ˜¯è·¯1å’Œè·¯3æ²¡æœ‰å…³è”ã€‚å°½ç®¡è·¯1å’Œè·¯3åœ¨æ¬§æ°ç©ºé—´ä¸­å¾ˆè¿‘ï¼Œä½†æ˜¯ä»–ä»¬è¡¨ç°å‡ºäº†ä¸åŒçš„å½¢å¼ã€‚æ­¤å¤–ï¼Œæœªæ¥çš„è½¦é€Ÿæ›´å®¹æ˜“å—åˆ°ä¸‹æ¸¸äº¤é€šçš„å½±å“ï¼Œè€Œéä¸Šæ¸¸ã€‚è¿™å°±æ„å‘³ç€äº¤é€šä¸Šçš„ç©ºé—´ç»“æ„ä¸æ˜¯æ¬§æ°ç©ºé—´çš„ï¼Œè€Œæ˜¯æœ‰å‘çš„ã€‚&lt;/p&gt;
&lt;div align="center"&gt;![Figure1](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig1.JPG)
&lt;p&gt;äº¤é€šé¢„æµ‹å·²ç»ç ”ç©¶äº†å‡ åå¹´ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦ç±»åˆ«ï¼šçŸ¥è¯†é©±åŠ¨çš„æ–¹æ³•å’Œæ•°æ®é©±åŠ¨çš„æ–¹æ³•ã€‚åœ¨è¿è¾“å’Œæ“ä½œç ”ç©¶ä¸­ï¼ŒçŸ¥è¯†é©±åŠ¨çš„æ–¹æ³•ç»å¸¸ä½¿ç”¨æ’é˜Ÿè®ºï¼Œæ¨¡æ‹Ÿäº¤é€šä¸­çš„ç”¨æˆ·è¡Œä¸º(Cascetta, 2013)ã€‚æ—¶é—´åºåˆ—ç¤¾åŒºä¸­ï¼Œæ•°æ®é©±åŠ¨çš„æ–¹æ³•å¦‚ Auto-Regressive Integrated Moving Average(ARIMA) æ¨¡å‹ï¼ŒKalman filtering è¿˜æ˜¯å¾ˆæµè¡Œçš„(Liu et al., 2011; Lippi et al., 2013)ã€‚ç„¶è€Œï¼Œç®€å•çš„æ—¶é—´åºåˆ—æ¨¡å‹é€šå¸¸ä¾èµ–å¹³ç¨³å‡è®¾ï¼Œè¿™ç»å¸¸ä¸å®é™…äº¤é€šæ•°æ®ä¸ç¬¦ã€‚æœ€è¿‘å¼€å§‹åœ¨äº¤é€šé¢„æµ‹ä¸Šåº”ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹ (Lv et al., 2015; Yu et al., 2017b) ï¼Œä½†æ˜¯æ²¡æœ‰è€ƒè™‘ç©ºé—´ç»“æ„ã€‚Wu &amp;amp; Tan 2016å’ŒMa et al. 2017 ä½¿ç”¨ CNN å¯¹ç©ºé—´å…³ç³»è¿›è¡Œå»ºæ¨¡ï¼Œä½†æ˜¯åœ¨æ¬§æ°ç©ºé—´ä¸­çš„ã€‚Bruna et al. 2014ï¼ŒDefferrard et al. 2016 ç ”ç©¶äº†å›¾å·ç§¯ï¼Œä½†æ˜¯åªèƒ½å¤„ç†æ— å‘å›¾ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæœ‰å‘å›¾æ¥è¡¨ç¤º pair-wise spatial correlationsã€‚å›¾çš„é¡¶ç‚¹æ˜¯sensorsï¼Œè¾¹æ˜¯æƒé‡ï¼Œé€šè¿‡è·¯ç½‘ä¸Š sensor ä¹‹é—´çš„è·ç¦»å¾—åˆ°ã€‚æˆ‘ä»¬ä½¿ç”¨æ‰©æ•£å·ç§¯ (diffusion convolution) æ“ä½œæ¥æ•è·ç©ºé—´ä¾èµ–å…³ç³»ï¼Œä»¥æ‰©æ•£æ€§æ˜¯å¯¹äº¤é€šæµçš„åŠ¨æ€æ€§å»ºæ¨¡ã€‚æå‡ºäº† &lt;em&gt;Diffusion Convolutional Recurrent Neural Network&lt;/em&gt; (DCRNN)ï¼Œæ•´åˆäº† &lt;em&gt;diffusion convolution&lt;/em&gt; å’Œ &lt;em&gt;sequence to sequence&lt;/em&gt; æ¶æ„ä»¥åŠ &lt;em&gt;scheduled sampling&lt;/em&gt; æŠ€æœ¯ã€‚åœ¨çœŸå®æ•°æ®é›†ä¸Šè¡¡é‡æ¨¡å‹æ—¶ï¼ŒDCRNN æ¯”state-of-the-artå¥½å¾ˆå¤šã€‚
Â· æˆ‘ä»¬ç ”ç©¶äº†äº¤é€šé¢„æµ‹é—®é¢˜ï¼Œåœ¨æœ‰å‘å›¾ä¸Šå¯¹äº¤é€šçš„ç©ºé—´ä¾èµ–ä»¥æ‰©æ•£å½¢å¼å»ºæ¨¡ã€‚æå‡ºäº† &lt;em&gt;diffusion convolution&lt;/em&gt;ï¼Œæœ‰ç€ç›´è§‚çš„è§£é‡Šä»¥åŠé«˜æ•ˆçš„è®¡ç®—ã€‚
Â· æˆ‘ä»¬æå‡ºäº† &lt;em&gt;Diffusion Convolutional Recurrent Neural Network&lt;/em&gt; (DCRNN)ï¼Œä½¿ç”¨ &lt;em&gt;diffusion convolution&lt;/em&gt;ï¼Œ&lt;em&gt;sequence to sequence&lt;/em&gt;ï¼Œ&lt;em&gt;scheduled sampling&lt;/em&gt; åŒæ—¶å¯¹æ—¶é—´å’Œç©ºé—´ä¾èµ–å…³ç³»è¿›è¡Œæ•è·çš„æ–¹æ³•ã€‚DCRNN ä¸é™äºè¿è¾“é¢†åŸŸï¼Œå¯ä»¥åº”ç”¨åˆ°å…¶ä»–çš„æ—¶ç©ºé¢„æµ‹é—®é¢˜ä¸Šã€‚
Â· åšäº†å¾ˆå¤šå®éªŒï¼Œæ•ˆæœå¾ˆå¥½ã€‚&lt;/p&gt;
&lt;h1 id="2-methodology"&gt;2 Methodology
&lt;/h1&gt;&lt;h2 id="21-traffic-forecasting-problem"&gt;2.1 Traffic Forecasting Problem
&lt;/h2&gt;&lt;p&gt;$N$ ä¸ªsensorsã€‚æ£€æµ‹å™¨ç½‘ç»œè¡¨ç¤ºæˆå¸¦æƒæœ‰å‘å›¾ $\mathcal{G} = (\mathcal{V}, \mathcal{E}, \boldsymbol{W})$ï¼Œ$\mathcal{V}$ æ˜¯é¡¶ç‚¹é›†ï¼Œ$\vert \mathcal{V} \vert = N$ï¼Œ$\mathcal{E}$ æ˜¯è¾¹é›†ï¼Œ$\boldsymbol{W} \in \mathbb{R}^{N \times N}$ æ˜¯å¸¦æƒé‚»æ¥çŸ©é˜µï¼Œè¡¨ç¤ºé¡¶ç‚¹ç›¸ä¼¼æ€§ï¼ˆå¦‚è·¯ç½‘è·ç¦»çš„ä¸€ä¸ªå‡½æ•°ï¼‰ã€‚å›¾ä¿¡å·çŸ©é˜µ$\boldsymbol{X} \in \mathbb{R}^{N \times P}$ï¼Œ$P$ æ˜¯æ¯ä¸ªé¡¶ç‚¹çš„ç‰¹å¾æ•°ã€‚$\boldsymbol{X}^{(t)}$ è¡¨ç¤ºæ—¶é—´ $t$ è§‚æµ‹åˆ°çš„å›¾ä¿¡å·ï¼Œäº¤é€šé¢„æµ‹é—®é¢˜ç›®çš„æ˜¯å­¦ä¹ ä¸€ä¸ªå‡½æ•° $h(\cdot)$ï¼Œå°† $T&amp;rsquo;$ ä¸ªå†å²çš„å›¾ä¿¡å·æ˜ å°„åˆ°æœªæ¥çš„ $T$ ä¸ªå›¾ä¿¡å·ä¸Šï¼Œç»™å®šå›¾ $\mathcal{G}$:
&lt;/p&gt;
$$[\boldsymbol{X}^{(t-T'+1)}, ..., \boldsymbol{X}^{(t)}; \mathcal{G}] \xrightarrow{h(\cdot)} [\boldsymbol{X}^{(t+1)}, ..., \boldsymbol{X}^{(t+T)}]$$&lt;h2 id="22-spatial-dependency-modeling"&gt;2.2 Spatial Dependency Modeling
&lt;/h2&gt;&lt;p&gt;æ‰©æ•£å½¢å¼ä»¥ $\mathcal{G}$ ä¸Šçš„éšæœºæ¸¸èµ°æ¥åˆ»ç”»ï¼Œé‡å¯æ¦‚ç‡ $\alpha \in [0, 1]$ï¼ŒçŠ¶æ€è½¬ç§»çŸ©é˜µ $\boldsymbol{D}^{-1}_O \boldsymbol{W}$ã€‚è¿™é‡Œï¼Œ$\boldsymbol{D}_{\boldsymbol{O}} = \mathrm{diag}(\boldsymbol{W1})$ æ˜¯å‡ºåº¦çš„å¯¹è§’çŸ©é˜µï¼Œ$\mathbf{1} \in \mathbb{R}^N$ è¡¨ç¤ºæ‰€æœ‰éƒ½ä¸º1çš„å‘é‡ã€‚å¤šä¸ªæ—¶é—´æ­¥ä¹‹åï¼ŒMarkov process ä¼šæ”¶æ•›åˆ°å¹³ç¨³åˆ†å¸ƒ $\mathcal{P} \in \mathbb{R}^{N \times N}$ä¸Šï¼Œç¬¬ $i$ è¡Œ $\mathcal{P}_{i,:} \in \mathbb{R}^N$ è¡¨ç¤ºä»é¡¶ç‚¹ $v_i \in \mathcal{V}$ æ‰©æ•£çš„å¯èƒ½æ€§ï¼Œä¹Ÿå°±æ˜¯å¯¹é¡¶ç‚¹ $v_i$ çš„ proximityã€‚ä¸‹é¢çš„å¼•ç†æ˜¯å¹³ç¨³åˆ†å¸ƒçš„é—­å¼è§£ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Lemma 2.1&lt;/strong&gt; (Teng et al., 2016) æ‰©æ•£è¿‡ç¨‹çš„å¹³ç¨³åˆ†å¸ƒå¯ä»¥è¡¨ç¤ºä¸ºå›¾ä¸Šçš„æ— é™éšæœºæ¸¸èµ°çš„å¸¦æƒç»„åˆï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å¼å­è®¡ç®—ï¼š
&lt;/p&gt;
$$\tag{1}
\mathcal{P} = \sum^\infty\_{k=0} \alpha(1 - \alpha)^k (\boldsymbol{D}^{-1}\_O \boldsymbol{W})^k
$$&lt;p&gt;
å…¶ä¸­ $k$ æ˜¯diffusion stepã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨æœ‰é™çš„ $K$ é˜¶æ‰©æ•£è¿‡ç¨‹ï¼Œç»™æ¯ä¸€æ­¥åˆ†é…ä¸€ä¸ªå¯è®­ç»ƒçš„æƒé‡ã€‚æˆ‘ä»¬ä¹Ÿèå…¥åå‘æ‰©æ•£è¿‡ç¨‹ï¼Œå› ä¸ºåŒå‘æ‰©æ•£å¯ä»¥è®©æ¨¡å‹æ›´çµæ´»åœ°å»æ•è·ä¸Šæ¸¸å’Œä¸‹æ¸¸äº¤é€šå¸¦æ¥çš„å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Diffusion Convolution&lt;/strong&gt; å›¾ä¿¡å· $\boldsymbol{X} \in \mathbb{R}^{N \times P}$ å’Œæ»¤æ³¢å™¨ $f_\theta$ çš„æ‰©æ•£å·ç§¯æ“ä½œçš„ç»“æœæ˜¯ï¼š
&lt;/p&gt;
$$\tag{2}
\boldsymbol{X}\_{:,p} \star\_{\mathcal{G}} f\_\theta = \sum^{K-1}\_{k=0} (\theta\_{k,1} (\boldsymbol{D}^{-1}\_O \boldsymbol{W})^k + \theta\_{k,2}(\boldsymbol{D}^{-1}\_I \boldsymbol{W}^T)^k) \boldsymbol{X}\_{:,p} \ \ \ \ \mathrm{for} \ \ p \in \lbrace 1, ..., P \rbrace
$$&lt;p&gt;
å…¶ä¸­ $\theta \in \mathbb{R}^{K \times 2}$ è¡¨ç¤ºå·ç§¯æ ¸å‚æ•°ï¼Œ$\boldsymbol{D}^{-1}_O \boldsymbol{W}$ å’Œ $\boldsymbol{D}^{-1}_I \boldsymbol{W}^T$ è¡¨ç¤ºæ‰©æ•£è¿‡ç¨‹å’Œåå‘æ‰©æ•£çš„è½¬ç§»æ¦‚ç‡çŸ©é˜µã€‚ä¸€èˆ¬ï¼Œè®¡ç®—å·ç§¯æ˜¯å¾ˆè€—æ—¶çš„ã€‚ç„¶è€Œï¼Œå¦‚æœ $\mathcal{G}$ æ˜¯ç¨€ç–çš„ï¼Œå¼2å¯ä»¥é€šè¿‡é€’å½’çš„å¤æ‚åº¦ä¸º $O(K)$ çš„sparse-denseçŸ©é˜µä¹˜æ³•é«˜æ•ˆçš„è®¡ç®—ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ä¸º $O(K \vert \mathcal{E} \vert) \ll O(N^2)$ã€‚é™„å½•Bæœ‰è¯¦ç»†çš„æè¿°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Diffusion Convolutional Layer&lt;/strong&gt; å¼2å®šä¹‰çš„å·ç§¯æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªæ‰©æ•£å·ç§¯å±‚ï¼Œå°† $P$ ç»´ç‰¹å¾æ˜ å°„åˆ° $Q$ ç»´è¾“å‡ºä¸Šã€‚å°†å‚æ•°è¡¨ç¤ºä¸º $\mathbf{\Theta} \in \mathbb{R}^{Q \times P \times K \times 2} = [ \boldsymbol{\theta} ]_{q, p}$ï¼Œå…¶ä¸­ $\mathbf{\Theta}_{q,p,:,:} \in \mathbb{R}^{K \times 2}$ æ˜¯ç¬¬ $p$ ä¸ªè¾“å…¥å’Œ $q$ ä¸ªè¾“å‡ºçš„å‚æ•°ã€‚æ‰©æ•£å·ç§¯å±‚ä¸ºï¼š
&lt;/p&gt;
$$\tag{3}
\boldsymbol{H}\_{:,q} = \boldsymbol{a}(\sum^P\_{p=1} \boldsymbol{X}\_{:,p} \star\_{\mathcal{G}} f\_{\mathbf{\Theta}\_{q,p,:,:}}) \ \ \ \ \mathrm{for} \ q \in \lbrace 1, ..., Q \rbrace
$$&lt;p&gt;
å…¶ä¸­ï¼Œ$\boldsymbol{X} \in \mathbb{R}^{N \times P}$ æ˜¯è¾“å…¥ï¼Œ$\boldsymbol{H} \in \mathbb{R}^{N \times Q}$ æ˜¯è¾“å‡ºï¼Œ$\lbrace f_{\mathbf{\Theta}_{q,p,:,:}} \rbrace $ æ˜¯æ»¤æ³¢å™¨ï¼Œ$a$ æ˜¯æ¿€æ´»å‡½æ•°ã€‚æ‰©æ•£å·ç§¯å±‚å­¦ä¹ å›¾ç»“æ„æ•°æ®çš„è¡¨ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŸºäºéšæœºæ¢¯åº¦çš„æ–¹æ³•è®­ç»ƒå®ƒã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Relation with Spectral Graph Convolution:&lt;/strong&gt; æ‰©æ•£å·ç§¯æ˜¯å®šä¹‰åœ¨æœ‰å‘å’Œæ— å‘å›¾ä¸Šçš„ã€‚å½“ä½¿ç”¨åœ¨æ— å‘å›¾ä¸Šæ—¶ï¼Œæˆ‘ä»¬å‘ç°å¾ˆå¤šç°å­˜çš„å›¾ç»“æ„å·ç§¯æ“ä½œï¼ŒåŒ…æ‹¬æµè¡Œçš„æ™®å›¾å·ç§¯ï¼ŒChebNetï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ‰©æ•£å·ç§¯çš„ç‰¹ä¾‹ã€‚ä»¤ $\boldsymbol{D}$ è¡¨ç¤ºåº¦çŸ©é˜µï¼Œ$\boldsymbol{L} = \boldsymbol{D}^{-\frac{1}{2}}(\boldsymbol{D} - \boldsymbol{W}) \boldsymbol{D}^{-\frac{1}{2}}$ æ˜¯å›¾å½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼Œæ¥ä¸‹æ¥çš„Propositionè§£é‡Šäº†è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Proposition 2.2.&lt;/strong&gt; è°±å›¾å·ç§¯çš„å®šä¹‰ï¼š
&lt;/p&gt;
$$
\boldsymbol{X}\_{:,p} \star\_{\mathcal{G}} f\_\boldsymbol{\theta} = \Phi F(\boldsymbol{\theta}) \Phi^T \boldsymbol{X}\_{:,p}
$$&lt;p&gt;
ç‰¹å¾å€¼åˆ†è§£ $\boldsymbol{L} = \Phi \Lambda \Phi^T$ï¼Œå½“å›¾ $\mathcal{G}$æ˜¯æ— å‘å›¾æ—¶ï¼Œ$F(\boldsymbol{\theta}) = \sum^{K-1}_0 \theta_k \Lambda^k$ï¼Œç­‰ä»·äºå›¾çš„æ‰©æ•£å·ç§¯ã€‚
è¯æ˜è§åè®°Cã€‚&lt;/p&gt;
&lt;h2 id="23-temporal-dynamics-modeling"&gt;2.3 Temporal Dynamics Modeling
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬åˆ©ç”¨ RNN å¯¹æ—¶é—´ä¾èµ–å»ºæ¨¡ã€‚æˆ‘ä»¬ä½¿ç”¨ GRUï¼Œç®€å•æœ‰æ•ˆçš„ RNN å˜ä½“ã€‚æˆ‘ä»¬å°† GRU ä¸­çš„çŸ©é˜µä¹˜æ³•æ¢æˆäº†æ‰©æ•£å·ç§¯ï¼Œå¾—åˆ°äº†æˆ‘ä»¬çš„æ‰©æ•£å·ç§¯é—¨æ§å¾ªç¯å•å…ƒ &lt;em&gt;Diffusion Convolutional Gated Recurrent Unit(DCGRU)&lt;/em&gt;.
&lt;/p&gt;
$$
\boldsymbol{r}^{(t)} = \sigma(\mathbf{\Theta}\_r \star\_\mathcal{G} [\boldsymbol{X}^{(t)}, \boldsymbol{H}^{(t-1)}] + \boldsymbol{b}\_r) \\
\boldsymbol{u}^{(t)} = \sigma( \mathbf{\Theta}\_u \star\_\mathcal{G} [\boldsymbol{X}, \boldsymbol{H}^{(t-1)}] + \boldsymbol{b}\_u) \\
\boldsymbol{C}^{(t)} = \mathrm{tanh}(\mathbf{\Theta}\_C \star\_\mathcal{G} [\boldsymbol{X}^{(t)}, (\boldsymbol{r}^{(t)} \odot \boldsymbol{H}^{(t-1)})] + \boldsymbol{b}\_c) \\
\boldsymbol{H}^{(t)} = \boldsymbol{u}^{(t)} \odot \boldsymbol{H}^{(t-1)} + (1 - \boldsymbol{u}^{(t)}) \odot \boldsymbol{C}^{(t)}
$$&lt;p&gt;
å…¶ä¸­ $\boldsymbol{X}^{(t)}, \boldsymbol{H}^{(t)}$ è¡¨ç¤ºæ—¶é—´ $t$ çš„è¾“å…¥å’Œè¾“å‡ºï¼Œ$\boldsymbol{r}^{(t)}, \boldsymbol{u}^{(t)}$ è¡¨ç¤ºæ—¶é—´ $t$ çš„reset gateå’Œ update gateã€‚$\star_\mathcal{G}$ è¡¨ç¤ºå¼2ä¸­å®šä¹‰çš„æ··åˆå·ç§¯ï¼Œ$\mathbf{\Theta}_r, \mathbf{\Theta}_u, \mathbf{\Theta}_C$ è¡¨ç¤ºå¯¹åº”çš„æ»¤æ³¢å™¨çš„å‚æ•°ã€‚ç±»ä¼¼ GRUï¼ŒDCGRU å¯ä»¥ç”¨æ¥æ„å»ºå¾ªç¯ç¥ç»ç½‘ç»œå±‚ï¼Œä½¿ç”¨ BPTT è®­ç»ƒã€‚&lt;/p&gt;
&lt;div align="center"&gt;![Figure2](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig2.JPG)
&lt;p&gt;åœ¨å¤šæ­¥é¢„æµ‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ &lt;em&gt;Sequence to Sequence&lt;/em&gt; æ¶æ„ã€‚ç¼–ç è§£ç å™¨éƒ½æ˜¯ DCGRUã€‚è®­ç»ƒæ—¶ï¼Œæˆ‘ä»¬æŠŠå†å²çš„æ—¶é—´åºåˆ—æ”¾åˆ°ç¼–ç å™¨ï¼Œä½¿ç”¨æœ€ç»ˆçŠ¶æ€åˆå§‹åŒ–è§£ç å™¨ã€‚è§£ç å™¨ç”Ÿæˆé¢„æµ‹ç»“æœã€‚æµ‹è¯•æ—¶ï¼Œground truth æ›¿æ¢æˆæ¨¡å‹æœ¬èº«ç”Ÿæˆçš„é¢„æµ‹ç»“æœã€‚è®­ç»ƒå’Œæµ‹è¯•è¾“å…¥çš„åˆ†å¸ƒçš„å·®å¼‚ä¼šå¯¼è‡´æ€§èƒ½çš„ä¸‹é™ã€‚ä¸ºäº†å‡è½»è¿™ä¸ªé—®é¢˜çš„å½±å“ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† &lt;em&gt;scheduled sampling&lt;/em&gt; (Bengio et al., 2015)ï¼Œåœ¨è®­ç»ƒçš„ç¬¬ $i$ è½®æ—¶ï¼Œæ¨¡å‹çš„è¾“å…¥è¦ä¹ˆæ˜¯æ¦‚ç‡ä¸º $\epsilon_i$ çš„ ground truthï¼Œè¦ä¹ˆæ˜¯æ¦‚ç‡ä¸º $1 - \epsilon_i$ çš„é¢„æµ‹ç»“æœã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œ$\epsilon_i$ é€æ¸çš„å‡å°ä¸º0ï¼Œä½¿å¾—æ¨¡å‹å¯ä»¥å­¦ä¹ åˆ°æµ‹è¯•é›†çš„åˆ†å¸ƒã€‚&lt;/p&gt;
&lt;p&gt;å›¾2å±•ç¤ºäº† DCRNN çš„æ¶æ„ã€‚æ•´ä¸ªç½‘ç»œé€šè¿‡ BPTT å¾ªç¯ç”Ÿæˆç›®æ ‡æ—¶é—´åºåˆ—çš„æœ€å¤§ä¼¼ç„¶å¾—åˆ°ã€‚DCRNN å¯ä»¥æ•è·æ—¶ç©ºä¾èµ–å…³ç³»ï¼Œåº”ç”¨åˆ°å¤šç§æ—¶ç©ºé¢„æµ‹é—®é¢˜ä¸Šã€‚&lt;/p&gt;
&lt;h1 id="3-related-work"&gt;3 Related Work
&lt;/h1&gt;&lt;p&gt;è¿è¾“é¢†åŸŸå’Œè¿ç­¹å­¦ä¸­äº¤é€šé¢„æµ‹æ˜¯ä¼ ç»Ÿé—®é¢˜ï¼Œä¸»è¦ä¾èµ–äºæ’é˜Ÿè®ºå’Œä»¿çœŸ(Drew, 1968)ã€‚æ•°æ®é©±åŠ¨çš„äº¤é€šé¢„æµ‹æ–¹æ³•æœ€è¿‘å—åˆ°äº†å¾ˆå¤šçš„å…³æ³¨ï¼Œè¯¦æƒ…å¯ä»¥çœ‹è¿‘äº›å¹´çš„ paper (Vlahogianni et al., 2014)ã€‚ç„¶è€Œï¼Œç°å­˜çš„æœºå™¨å­¦ä¹ æ¨¡å‹è¦ä¹ˆæœ‰ç€å¾ˆå¼ºçš„å‡è®¾ï¼ˆå¦‚ auto-regressive model ï¼‰è¦ä¹ˆä¸èƒ½è€ƒè™‘éçº¿æ€§çš„æ—¶é—´ä¾èµ–ï¼ˆå¦‚ latent space model Yu et al. 2016; Deng et al. 2016ï¼‰ã€‚æ·±åº¦å­¦ä¹ æ¨¡å‹ä¸ºè§£å†³æ—¶é—´åºåˆ—é¢„æµ‹é—®é¢˜æä¾›äº†æ–°çš„æ–¹æ³•ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ Yu et al. 2017b; Laptev et al. 2017 çš„å·¥ä½œä¸­ï¼Œä½œè€…ä½¿ç”¨æ·±åº¦å¾ªç¯ç¥ç»ç½‘ç»œç ”ç©¶æ—¶é—´åºåˆ—é¢„æµ‹é—®é¢˜ã€‚å·ç§¯ç¥ç»ç½‘ç»œå·²ç»è¢«åº”ç”¨åˆ°äº¤é€šé¢„æµ‹ä¸Šã€‚Zhang et al. 2016; 2017 å°†è·¯ç½‘è½¬æ¢æˆäº† 2D ç½‘æ ¼ï¼Œä½¿ç”¨ä¼ ç»Ÿçš„ CNN é¢„æµ‹äººæµã€‚Cheng et al. 2017 æå‡ºäº†DeepTransportï¼Œé€šè¿‡å¯¹æ¯æ¡è·¯æ”¶é›†ä¸Šä¸‹æ¸¸é‚»å±…è·¯æ®µå¯¹ç©ºé—´ä¾èµ–å»ºæ¨¡ï¼Œåœ¨è¿™äº›é‚»å±…ä¸Šåˆ†åˆ«ä½¿ç”¨å·ç§¯æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘ï¼ŒCNN åŸºäºè°±å›¾ç†è®ºå·²ç»æ³›åŒ–åˆ°ä»»æ„çš„å›¾ç»“æ„ä¸Šã€‚å›¾å·ç§¯ç¥ç»ç½‘ç»œç”± Bruna et al. 2014 é¦–æ¬¡æå‡ºï¼Œåœ¨æ·±åº¦ç¥ç»ç½‘ç»œå’Œè°±å›¾ç†è®ºä¹‹é—´å»ºç«‹äº†æ¡¥æ¢ã€‚Defferrard et al. 2016 æå‡ºäº† ChebNetï¼Œä½¿ç”¨å¿«é€Ÿå±€éƒ¨å·ç§¯æ»¤æ³¢å™¨æå‡äº† GCNã€‚Kipf &amp;amp; Welling 2017 ç®€åŒ–äº† ChebNetï¼Œåœ¨åŠç›‘ç£åˆ†ç±»ä»»åŠ¡ä¸Šè·å¾—äº† state-of-the-art çš„è¡¨ç°ã€‚Seo et al. 2016 èåˆäº† ChebNet å’Œ RNN ç”¨äºç»“æ„åºåˆ—å»ºæ¨¡ã€‚Yu et al. 2017a å¯¹æ£€æµ‹å™¨ç½‘ç»œä»¥æ— å‘å›¾çš„å½¢å¼ï¼Œä½¿ç”¨ Chebnet å’Œå·ç§¯åºåˆ—æ¨¡å‹ (Gehring et al. 2017) è¿›è¡Œå»ºæ¨¡åšé¢„æµ‹ã€‚è¿™äº›æåŠçš„åŸºäºè°±çš„ç†è®ºçš„é™åˆ¶ä¹‹ä¸€æ˜¯ï¼Œä»–ä»¬éœ€è¦å›¾æ˜¯æ— å‘çš„ï¼Œæ¥è®¡ç®—æœ‰æ„ä¹‰çš„è°±åˆ†è§£ã€‚ä»è°±åŸŸåˆ°é¡¶ç‚¹åŸŸï¼ŒAtwood &amp;amp; Towsley 2016 æå‡ºäº†æ‰©æ•£å·ç§¯ç¥ç»ç½‘ç»œ (DCNN)ï¼Œä»¥å›¾ç»“æ„ä¸­æ¯ä¸ªé¡¶ç‚¹çš„æ‰©æ•£è¿‡ç¨‹å®šä¹‰äº†å·ç§¯ã€‚Hechtlinger et al. 2017 æå‡ºäº† GraphCNN å¯¹æ¯ä¸ªé¡¶ç‚¹çš„ $p$ ä¸ªæœ€è¿‘é‚»é‚»å±…è¿›è¡Œå·ç§¯ï¼Œå°†å·ç§¯æ³›åŒ–åˆ°å›¾ä¸Šã€‚ç„¶è€Œï¼Œè¿™äº›æ–¹æ³•æ²¡æœ‰è€ƒè™‘æ—¶é—´çš„åŠ¨æ€æ€§ï¼Œä¸»è¦å¤„ç†çš„æ˜¯é™æ€å›¾ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„æ–¹æ³•ä¸åŒäºè¿™äº›æ–¹æ³•ï¼Œå› ä¸ºé—®é¢˜çš„è®¾å®šä¸ä¸€æ ·ï¼Œè€Œä¸”å›¾å·ç§¯çš„å…¬å¼ä¸åŒã€‚æˆ‘ä»¬å°† sensor network å»ºç«‹æˆä¸€ä¸ªå¸¦æƒæœ‰å‘å›¾ï¼Œæ¯”ç½‘æ ¼å’Œæ— å‘å›¾æ›´çœŸå®ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æå‡ºçš„å·ç§¯æ“ä½œä½¿ç”¨åŒå‘å›¾éšæœºæ¸¸èµ°æ¥å®šä¹‰ï¼Œé›†æˆäº†åºåˆ—åˆ°åºåˆ—æ¨¡å‹ä»¥åŠ scheduled sampling ï¼Œå¯¹é•¿æ—¶é—´çš„æ—¶é—´ä¾èµ–å»ºæ¨¡ã€‚&lt;/p&gt;
&lt;h1 id="4-experiments"&gt;4 Experiments
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šåšäº†å®éªŒï¼šï¼ˆ1ï¼‰&lt;strong&gt;METR-LA&lt;/strong&gt; è¿™ä¸ªäº¤é€šæ•°æ®é›†åŒ…å«äº†æ´›æ‰çŸ¶é«˜é€Ÿå…¬è·¯çº¿åœˆæ”¶é›†çš„æ•°æ® (Jagadish et al., 2014)ã€‚æˆ‘ä»¬é€‰æ‹©äº†207ä¸ªæ£€æµ‹å™¨ï¼Œæ”¶é›†äº†ä»2012å¹´3æœˆ1æ—¥åˆ°2012å¹´6æœˆ30æ—¥4ä¸ªæœˆçš„æ•°æ®ç”¨äºå®éªŒã€‚ï¼ˆ2ï¼‰&lt;strong&gt;PEMS_BAY&lt;/strong&gt; è¿™ä¸ªäº¤é€šæ•°æ®é›†ç”± California Transportation Agencies(CalTrans)Performance Measurement System (PeMS) æ”¶é›†ã€‚æˆ‘ä»¬é€‰äº† Bay Area çš„325ä¸ªæ£€æµ‹å™¨ï¼Œæ”¶é›†äº†ä»2017å¹´1æœˆ1æ—¥åˆ°2017å¹´5æœˆ31æ—¥6ä¸ªæœˆçš„æ•°æ®ç”¨äºå®éªŒã€‚ä¸¤ä¸ªæ•°æ®é›†ç›‘æµ‹å™¨çš„åˆ†å¸ƒå¦‚å›¾8æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªæ•°æ®é›†ï¼Œæˆ‘ä»¬å°†è½¦é€Ÿèšåˆåˆ°äº†5åˆ†é’Ÿçš„çª—å£å†…ï¼Œä½¿ç”¨äº† Z-Score normalizationã€‚70%çš„æ•°ç”¨äºè®­ç»ƒï¼Œ20%ç”¨äºæµ‹è¯•ï¼Œ10%ç”¨äºéªŒè¯ã€‚ä¸ºäº†æ„å»ºæ£€æµ‹å™¨ç½‘ç»œï¼Œæˆ‘ä»¬è®¡ç®—äº†ä»»æ„ä¸¤ä¸ª sensor çš„è·ç¦»ï¼Œä½¿ç”¨äº† thresholded Gaussian kernel æ¥æ„å»ºé‚»æ¥çŸ©é˜µ(Shuman et al., 2013)ã€‚$W_{ij} = \exp{(-\frac{\mathrm{dist}(v_i, v_j)^2}{\sigma^2})} \ \text{if} \ \text{dist}(v_i, v_j) \leq \mathcal{\kappa}, \mathrm{otherwise} \ 0$ï¼Œå…¶ä¸­ $W_{ij}$ è¡¨ç¤ºäº†æ£€æµ‹å™¨ $v_i$ å’Œ $v_j$ ä¹‹é—´çš„æƒé‡ï¼Œ$\mathrm{dist}(v_i, v_j)$ è¡¨ç¤ºæ£€æµ‹å™¨ $v_i$ åˆ° $v_j$ ä¹‹é—´çš„è·ç¦»ã€‚$\sigma$ è¡¨ç¤ºè·ç¦»çš„æ ‡å‡†å·®ï¼Œ$\kappa$ è¡¨ç¤ºé˜ˆå€¼ã€‚&lt;/p&gt;
&lt;div align="center"&gt;![Figure8](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig8.JPG)
&lt;div align="center"&gt;![Table](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Table1.JPG)
&lt;h2 id="41-experimental-settings"&gt;4.1 Experimental Settings
&lt;/h2&gt;&lt;p&gt;Baselines 1. $\rm{HA}$ï¼šå†å²å‡å€¼ï¼Œå°†äº¤é€šæµå»ºæ¨¡æˆå‘¨æœŸæ€§è¿‡ç¨‹ï¼Œä½¿ç”¨ä¹‹å‰çš„å‘¨æœŸçš„åŠ æƒå¹³å‡ä½œä¸ºé¢„æµ‹ã€‚2. $\mathrm{ARIMA}_{kal}$ï¼šAuto-Regressive Integrated Moving Average model with Kalman filterï¼Œå¹¿æ³›åœ°åº”ç”¨äºæ—¶é—´åºåˆ—é¢„æµ‹ä¸Šã€‚3. $\rm{VAR}$: Vector Auto-Regression(Hamilton, 1994)ã€‚4. $\rm{SVR}$ï¼šSupport Vector Regressionï¼Œä½¿ç”¨çº¿æ€§æ”¯æŒå‘é‡æœºç”¨äºå›å½’ä»»åŠ¡ã€‚5. Feed forward Neural network (FNN)ï¼šå‰å‘ä¼ æ’­ç¥ç»ç½‘ç»œï¼Œä¸¤ä¸ªéšè—å±‚ï¼ŒL2æ­£åˆ™åŒ–ã€‚6. Recurrent Neural Network with fully connected LSTM hidden units (FC-LSTM)(Sutskever et al., 2014).&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰çš„ç¥ç»ç½‘ç»œæ–¹æ³•éƒ½æ˜¯ç”¨ Tensorflow å®ç°ï¼Œä½¿ç”¨ Adam ä¼˜åŒ–å™¨ï¼Œå­¦ä¹ ç‡è¡°å‡ã€‚ä½¿ç”¨ Tree-structured Parzen Estimator(TPE)(Bergstra et al., 2011) åœ¨éªŒè¯é›†ä¸Šé€‰æ‹©æœ€å¥½çš„è¶…å‚æ•°ã€‚DCRNN çš„è¯¦ç»†å‚æ•°è®¾ç½®å’Œ baselines çš„è¶…å‚æ•°è®¾ç½®è§é™„å½•Eã€‚&lt;/p&gt;
&lt;h2 id="42-traffic-forecasting-performance-comparison"&gt;4.2 Traffic Forecasting Performance Comparison
&lt;/h2&gt;&lt;p&gt;è¡¨1å±•ç¤ºäº†ä¸åŒçš„æ–¹æ³•åœ¨15åˆ†é’Ÿï¼Œ30åˆ†é’Ÿï¼Œ1å°æ—¶åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šé¢„æµ‹çš„å¯¹æ¯”ã€‚è¿™äº›æ–¹æ³•åœ¨ä¸‰ç§å¸¸ç”¨çš„ metrics ä¸Šè¿›è¡Œäº†è¯„ä¼°ï¼ŒåŒ…æ‹¬1. MAEï¼Œ 2. MAPEï¼ˆMean Absolute Percentage Errorï¼‰ï¼Œ 3. RMSEã€‚è¿™äº› metrics ä¸­çš„ç¼ºå¤±å€¼è¢«æ’é™¤å‡ºå»ã€‚è¿™äº›å…¬å¼åœ¨åè®°E.2ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°è¿™ä¸¤ä¸ªæ•°æ®é›†ä¸Šæœ‰ä»¥ä¸‹ç°è±¡ï¼š1. RNN-based methodsï¼ŒåŒ…æ‹¬FC-LSTMå’ŒDCRNNï¼Œä¸€èˆ¬æ¯”å…¶ä»–çš„æ–¹æ³•è¡¨ç°å¾—å¥½ï¼Œè¿™å¼ºè°ƒå¯¹æ—¶é—´ä¾èµ–çš„å»ºæ¨¡çš„é‡è¦æ€§ã€‚2. DCRNNåœ¨æ‰€æœ‰çš„ forecasting horizons ä¸­çš„æ‰€æœ‰ metrics ä¸Šéƒ½è·å¾—äº†æœ€å¥½çš„è¡¨ç°ï¼Œè¿™è¯´æ˜å¯¹ç©ºé—´ä¾èµ–å»ºæ¨¡çš„æœ‰æ•ˆæ€§ã€‚3. æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ŒåŒ…æ‹¬ FNNï¼ŒFC-LSTMï¼ŒDCRNN åœ¨é•¿æœŸé¢„æµ‹ä¸Šï¼Œå€¾å‘äºæ¯”çº¿æ€§çš„ baseline æœ‰æ›´å¥½çš„ç»“æœã€‚æ¯”å¦‚ï¼Œ1å°æ—¶ã€‚è¿™æ˜¯å› ä¸ºéšç€ horizon çš„å¢é•¿ï¼Œæ—¶é—´ä¾èµ–å˜å¾—æ›´åŠ éçº¿æ€§ã€‚æ­¤å¤–ï¼Œéšç€å†å²å‡å€¼ä¸ä¾èµ–çŸ­æœŸæ•°æ®ï¼Œå®ƒçš„è¡¨ç°å¯¹äº forecasting horizon çš„å°å¢é•¿æ˜¯ä¸å˜çš„ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒMETR-LAï¼ˆLos Angelesï¼Œæœ‰å¾ˆå¤æ‚çš„äº¤é€šç¯å¢ƒï¼‰æ•°æ®æ¯” PEMS-BAY æ›´æœ‰æŒ‘æˆ˜æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬å°† METR-LA çš„æ•°æ®ä½œä¸ºä»¥ä¸‹å®éªŒçš„é»˜è®¤æ•°æ®é›†ã€‚&lt;/p&gt;
&lt;h2 id="43-effect-of-spatial-dependency-modeling"&gt;4.3 Effect of Spatial Dependency Modeling
&lt;/h2&gt;&lt;p&gt;ä¸ºäº†ç»§ç»­æ·±å…¥å¯¹ç©ºé—´ä¾èµ–å»ºæ¨¡çš„å½±å“ï¼Œæˆ‘ä»¬å¯¹æ¯”äº† DCRNN å’Œä»¥ä¸‹å˜ä½“ï¼š 1. DCRNN-NoConvï¼Œè¿™ä¸ªé€šè¿‡ä½¿ç”¨å•ä½é˜µæ›¿æ¢æ‰©æ•£å·ç§¯ï¼ˆå¼2ï¼‰ä¸­çš„è½¬ç§»çŸ©é˜µï¼Œå¿½ç•¥äº†ç©ºé—´ä¾èµ–ã€‚è¿™å°±æ„å‘³ç€é¢„æµ‹åªèƒ½é€šè¿‡å†å²å€¼é¢„æµ‹ã€‚ 2. DCRNN-UniConvï¼Œæ‰©æ•£å·ç§¯ä¸­åªä½¿ç”¨å‰å‘éšæœºæ¸¸èµ°ï¼›å›¾3å±•ç¤ºäº†è¿™ä¸‰ä¸ªæ¨¡å‹ä½¿ç”¨å¤§ä½“ç›¸åŒæ•°é‡çš„å‚æ•°æ—¶çš„å­¦ä¹ æ›²çº¿ã€‚æ²¡æœ‰æ‰©æ•£å·ç§¯ï¼ŒDCRNN-NoConv æœ‰ç€æ›´å¤§çš„ validation errorã€‚æ­¤å¤–ï¼ŒDCRNNè·å¾—äº†æœ€ä½çš„ validation errorï¼Œè¯´æ˜äº†ä½¿ç”¨åŒå‘éšæœºæ¸¸èµ°çš„æœ‰æ•ˆæ€§ã€‚è¿™ä¸ªå‘Šè¯‰æˆ‘ä»¬åŒå‘éšæœºæ¸¸èµ°èµ‹äºˆäº†æ¨¡å‹æ•è·ä¸Šä¸‹æ¸¸äº¤é€šå½±å“çš„èƒ½åŠ›ä¸çµæ´»æ€§ã€‚&lt;/p&gt;
&lt;div align="center"&gt;![Figure3](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig3.JPG)
&lt;p&gt;ä¸ºäº†ç ”ç©¶å›¾çš„æ„å»ºæ–¹æ³•çš„å½±å“ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªæ— å‘å›¾ï¼Œ$\widehat{W}_{ij} = \widehat{W}_{ji} = \max(W_{ij}, W_{ji})$ï¼Œå…¶ä¸­ $\widehat{\boldsymbol{W}}$ æ˜¯æ–°çš„å¯¹ç§°æƒé‡çŸ©é˜µã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨äº† DCRNN çš„ä¸€ä¸ªå˜ä½“ï¼Œè¡¨ç¤ºæˆ GCRNNï¼Œä½¿ç”¨ &lt;em&gt;ChebNet&lt;/em&gt; å·ç§¯çš„åºåˆ—åˆ°åºåˆ—å­¦ä¹ ï¼Œå¹¶ç”¨å¤§ä½“ç›¸åŒçš„å‚æ•°æ•°é‡ã€‚è¡¨2å±•ç¤ºäº† DCRNN å’Œ GCRNN åœ¨ METR-LA æ•°æ®é›†ä¸Šçš„å¯¹æ¯”ã€‚DCRNN éƒ½æ¯” GCRNN å¥½ã€‚è¿™è¯´æ˜æœ‰å‘å›¾èƒ½æ›´å¥½çš„æ•è·äº¤é€šæ£€æµ‹å™¨ä¹‹é—´çš„éå¯¹ç§°å…³ç³»ã€‚å›¾4å±•ç¤ºäº†ä¸åŒå‚æ•°çš„å½±å“ã€‚$K$ å¤§ä½“å¯¹åº”äº†å·ç§¯æ ¸æ„Ÿå—é‡çš„å¤§å°ï¼Œå•å…ƒæ•°å¯¹åº”äº†å·ç§¯æ ¸æ•°ã€‚è¶Šå¤§çš„ $K$ è¶Šèƒ½ä½¿æ¨¡å‹æ•è·æ›´å®½çš„ç©ºé—´ä¾èµ–ï¼Œä»£ä»·æ˜¯å¢åŠ äº†å­¦ä¹ çš„å¤æ‚åº¦ã€‚æˆ‘ä»¬è§‚æµ‹åˆ°éšç€ $K$ çš„å¢åŠ ï¼ŒéªŒè¯é›†ä¸Šçš„è¯¯å·®å…ˆæ˜¯å¿«é€Ÿä¸‹é™ï¼Œç„¶åå¾®å¾®ä¸Šå‡ã€‚æ”¹å˜ä¸åŒæ•°é‡çš„å•å…ƒä¹Ÿä¼šæœ‰ç›¸ä¼¼çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;div align="center"&gt;![Table2](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Table2.JPG)
&lt;div align="center"&gt;![Figure4](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig4.JPG)
&lt;h2 id="44-effect-of-temporal-dependency-modeling"&gt;4.4 Effect of Temporal Dependency Modeling
&lt;/h2&gt;&lt;p&gt;ä¸ºäº†è¡¡é‡æ—¶é—´å»ºæ¨¡çš„å½±å“ï¼ŒåŒ…æ‹¬åºåˆ—åˆ°åºåˆ—æ¡†æ¶ä»¥åŠ scheduled sampling æŠ€æœ¯ï¼Œæˆ‘ä»¬è®¾è®¡ DCRNN çš„ä¸‰ç§å˜ä½“ï¼š1. DCNNï¼šæˆ‘ä»¬æ‹¼æ¥å†å²çš„è§‚æµ‹å€¼ä¸ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„å‘é‡ï¼Œå°†å®ƒæ”¾åˆ°å †å çš„æ‰©æ•£å·ç§¯å±‚ä¸­ï¼Œé¢„æµ‹æœªæ¥çš„æ—¶é—´åºåˆ—ã€‚æˆ‘ä»¬è®­ç»ƒä¸€ä¸ªæ¨¡å‹åªé¢„æµ‹ä¸€æ­¥ï¼Œå°†ä¹‹å‰çš„é¢„æµ‹ç»“æœæ”¾åˆ°æ¨¡å‹ä¸­ä½œä¸ºè¾“å…¥ï¼Œä½¿ç”¨å¤šæ­¥å‰å‘é¢„æµ‹ã€‚2. DCRNN-SEQï¼šä½¿ç”¨ç¼–ç è§£ç åºåˆ—åˆ°åºåˆ—å­¦ä¹ æ¡†æ¶åšå¤šæ­¥é¢„æµ‹ã€‚3. DCRNNï¼šç±»ä¼¼ DCRNN-SEQ ï¼Œé™¤äº†å¢åŠ äº† scheduled samplingã€‚&lt;/p&gt;
&lt;p&gt;å›¾5å±•ç¤ºäº†è¿™å››ç§æ–¹æ³•é’ˆå¯¹ MAE çš„å¯¹æ¯”ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼š1. DCRNN-SEQ æ¯” DCNN å¥½å¾ˆå¤šï¼Œç¬¦åˆäº†å¯¹æ—¶é—´å»ºæ¨¡çš„é‡è¦æ€§ã€‚2. DCRNN è¾¾åˆ°äº†æœ€å¥½çš„æ•ˆæœï¼Œéšç€é¢„æµ‹ horizon çš„å¢åŠ ï¼Œå®ƒçš„å…ˆè¿›æ€§å˜å¾—è¶Šæ¥è¶Šæ˜æ˜¾ã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºæ¨¡å‹åœ¨è®­ç»ƒçš„æ—¶å€™å°±åœ¨å¤„ç†å¤šæ­¥é¢„æµ‹æ—¶å‡ºç°çš„è¯¯å·®ï¼Œå› æ­¤ä¼šå¾ˆå°‘çš„å—åˆ°è¯¯å·®åå‘ä¼ æ’­çš„å½±å“ã€‚æˆ‘ä»¬ä¹Ÿè®­ç»ƒäº†ä¸€ä¸ªæ€»æ˜¯å°†è¾“å‡ºä½œä¸ºè¾“å…¥æ‰”åˆ°æ¨¡å‹ä¸­çš„æ¨¡å‹ã€‚ä½†æ˜¯å®ƒçš„è¡¨ç°æ¯”è¿™ä¸‰ç§å˜ä½“éƒ½å·®ï¼Œè¿™å°±å¼ºè°ƒäº† scheduled sampling çš„é‡è¦æ€§ã€‚&lt;/p&gt;
&lt;div align="center"&gt;![Figure5](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig5.JPG)
&lt;h2 id="45-æ¨¡å‹çš„è§£é‡Šæ€§"&gt;4.5 æ¨¡å‹çš„è§£é‡Šæ€§
&lt;/h2&gt;&lt;p&gt;ä¸ºäº†æ›´å¥½çš„ç†è§£æ¨¡å‹ï¼Œæˆ‘ä»¬å¯¹é¢„æµ‹ç»“æœå’Œå­¦ä¹ åˆ°çš„æ»¤æ³¢å™¨è¿›è¡Œæ€§äº†å¯è§†åŒ–ã€‚å›¾6å±•ç¤ºäº†é¢„æµ‹1å°æ—¶çš„æ•ˆæœã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°äº†ä»¥ä¸‹æƒ…å†µï¼š1. DCRNN åœ¨äº¤é€šæµé€Ÿåº¦ä¸­å­˜åœ¨å°çš„éœ‡è¡æ—¶ï¼Œç”¨å‡å€¼ç”Ÿæˆäº†å¹³æ»‘çš„é¢„æµ‹ç»“æœï¼ˆå›¾6aï¼‰ã€‚è¿™åæ˜ äº†æ¨¡å‹çš„é²æ£’æ€§ã€‚2. DCRNN æ¯” baseline æ–¹æ³•ï¼ˆå¦‚FC-LSTMï¼‰æ›´å€¾å‘äºç²¾ç¡®çš„é¢„æµ‹å‡ºçªå˜ã€‚å›¾6bå±•ç¤ºäº† DCRNN é¢„æµ‹äº†é«˜å³°æ—¶æ®µçš„èµ·å§‹å’Œç»ˆæ­¢ã€‚è¿™æ˜¯å› ä¸º DCRNN æ•è·äº†ç©ºé—´ä¾èµ–ï¼Œèƒ½å¤Ÿåˆ©ç”¨é‚»å±…æ£€æµ‹å™¨é€Ÿåº¦çš„å˜æ¢æ¥ç²¾ç¡®é¢„æµ‹ã€‚å›¾7å±•ç¤ºäº†ä»¥ä¸åŒé¡¶ç‚¹ä¸ºä¸­å¿ƒå­¦ä¹ åˆ°çš„æ»¤æ³¢å™¨çš„æ ·ä¾‹ã€‚æ˜Ÿè¡¨ç¤ºä¸­å¿ƒï¼Œé¢œè‰²è¡¨ç¤ºæƒé‡ã€‚æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°æƒé‡æ›´å¥½çš„åœ¨ä¸­å¿ƒå‘¨å›´å±€éƒ¨åŒ–ï¼Œè€Œä¸”æƒé‡åŸºäºè·¯ç½‘è·ç¦»è¿›è¡Œæ‰©æ•£ã€‚æ›´å¤šçš„å¯è§†åŒ–åœ¨é™„å½•Fã€‚&lt;/p&gt;
&lt;div align="center"&gt;![Figure6](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig6.JPG)
&lt;div align="center"&gt;![Figure7](/blog/images/diffusion-convolutional-recurrent-neural-network-data-driven-traffic-forecasting/Fig7.JPG)
&lt;h1 id="5-conclusion"&gt;5 Conclusion
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬å¯¹è·¯ç½‘ä¸Šçš„äº¤é€šé¢„æµ‹åšäº†æ—¶ç©ºä¸Šçš„å»ºæ¨¡ï¼Œæå‡ºäº† &lt;em&gt;diffusion convolutional recurrent neural network&lt;/em&gt;ï¼Œå¯ä»¥æ•è·æ—¶ç©ºä¾èµ–ã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬ä½¿ç”¨åŒå‘éšæœºæ¸¸èµ°ï¼Œå¯¹ç©ºé—´ä¾èµ–å»ºæ¨¡ï¼Œä½¿ç”¨å¾ªç¯ç¥ç»ç½‘ç»œæ•è·æ—¶é—´çš„åŠ¨æ€æ€§ã€‚è¿˜ç»§æ‰¿äº†ç¼–ç è§£ç æ¶æ„å’Œ scheduled sampling æŠ€æœ¯æ¥æå‡é•¿æœŸé¢„æµ‹çš„æ€§èƒ½ã€‚åœ¨ä¸¤ä¸ªçœŸå®çš„æ•°æ®é›†ä¸Šè¯„ä¼°äº†æ€§èƒ½ï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ¯” baselines å¥½å¾ˆå¤šã€‚æœªæ¥çš„å·¥ä½œï¼Œ1. ä½¿ç”¨æå‡ºçš„ç½‘ç»œè§£å†³å…¶ä»–çš„æ—¶ç©ºé¢„æµ‹é—®é¢˜ï¼›2. å¯¹ä¸æ–­æ¼”åŒ–çš„å›¾ç»“æ„çš„æ—¶ç©ºä¾èµ–å…³ç³»å»ºæ¨¡ã€‚&lt;/p&gt;
&lt;h1 id="appendix"&gt;Appendix
&lt;/h1&gt;&lt;h2 id="b-efficient-calculation-of-equation"&gt;B Efficient Calculation Of Equation
&lt;/h2&gt;&lt;p&gt;å¼2å¯ä»¥åˆ†è§£æˆä¸¤ä¸ªæœ‰ç›¸åŒæ—¶é—´å¤æ‚åº¦çš„éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯ $\boldsymbol{D}^{-1}_O \boldsymbol{W}$ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯ $\boldsymbol{D}^{-1}_I \boldsymbol{W}^T$ã€‚å› æ­¤æˆ‘ä»¬åªç ”ç©¶ç¬¬ä¸€éƒ¨åˆ†çš„æ—¶é—´å¤æ‚åº¦ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ $T_k(x) = (\boldsymbol{D}^{-1}_O \boldsymbol{W})^k \boldsymbol{x}$ï¼Œå¼2çš„ç¬¬ä¸€éƒ¨åˆ†å¯ä»¥é‡å†™ä¸ºï¼š
&lt;/p&gt;
$$\tag{4}
\sum^{K-1}\_{k=0} \theta\_k T\_k (X\_{:,p})
$$&lt;p&gt;
å› ä¸º $T_{k+1}(x) = \boldsymbol{D}^{-1}_O \boldsymbol{W} T_k(\boldsymbol{x})$ å’Œ $\boldsymbol{D}^{-1}_O \boldsymbol{W}$ æ˜¯ç¨€ç–çš„ï¼Œå¯ä»¥å¾ˆå®¹æ˜“çœ‹å‡ºå¼4å¯ä»¥é€šè¿‡ $O(K)$ çš„é€’å½’ç¨€ç–-ç¨ å¯†çŸ©é˜µä¹˜æ³•ï¼Œæ¯æ¬¡æ—¶é—´å¤æ‚åº¦ä¸º $O(\vert \varepsilon \vert)$ å¾—åˆ°ã€‚ç„¶åï¼Œå¼2å’Œå¼4çš„æ—¶é—´å¤æ‚åº¦éƒ½ä¸º $O(K\vert \varepsilon \vert)$ã€‚å¯¹äºç¨ å¯†å›¾ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ spectral sparsification(Cheng et al., 2015) ä½¿å…¶ç¨€ç–ã€‚&lt;/p&gt;
&lt;h2 id="c-relation-with-spectral-graph-convolution"&gt;C Relation With Spectral Graph Convolution
&lt;/h2&gt;&lt;p&gt;&lt;em&gt;Proof.&lt;/em&gt; è°±å›¾å·ç§¯åˆ©ç”¨å½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ $\boldsymbol{L = D^{-\frac{1}{2}}(D - W)D^{\frac{1}{2}}} = \mathbf{\Phi \Lambda \Phi^T}$ã€‚ChebNet ä½¿ $f_\theta$ å‚æ•°åŒ–ä¸ºä¸€ä¸ª $\Lambda$ çš„ $K$ é˜¶å¤šé¡¹å¼ï¼Œä½¿ç”¨ç¨³å®šçš„åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼åŸºè®¡ç®—è¿™ä¸ªå€¼ã€‚
&lt;/p&gt;
$$\tag{5}
\boldsymbol{X}\_{:,p} \star\_\mathcal{G} f\_\theta = \mathbf{\Phi} (\sum^{K-1}\_{k=0} \theta\_k \mathbf{\Lambda}^k) \mathbf{\Phi^T X}\_{:,p} = \sum^{K-1}\_{k=0} \theta\_k \boldsymbol{L}^k \boldsymbol{X}\_{:,p} = \sum^{K-1}\_{k=0} \tilde{\theta}\_k T\_k(\tilde{\boldsymbol{L}})\boldsymbol{X}\_{:,p}
$$&lt;p&gt;
å…¶ä¸­ $T_0(x)=1, T_1(x)=x, T_k(x) = xT_{k-1}(x) - T_{k-2}(x)$ æ˜¯åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼çš„åŸºã€‚ä»¤ $\lambda_{\mathrm{max}}$ è¡¨ç¤º $\boldsymbol{L}$ æœ€å¤§çš„ç‰¹å¾å€¼ï¼Œ$\tilde{\boldsymbol{L}} = \frac{2}{\lambda_{\text{max}}} \boldsymbol{L - I}$ è¡¨ç¤ºå°†æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç¼©æ”¾ï¼Œå°†ç‰¹å¾å€¼ä» $[0, \lambda_{\text{max}}]$ æ˜ å°„åˆ° $[-1, 1]$ï¼Œå› ä¸ºåˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼ç”Ÿæˆäº†ä¸€ä¸ªåœ¨ $[-1, 1]$ å†…æ­£äº¤çš„åŸºã€‚å¼5å¯ä»¥çœ‹æˆä¸€ä¸ªå…³äº $\tilde{\boldsymbol{L}}$ çš„å¤šé¡¹å¼ï¼Œæˆ‘ä»¬ä¸€ä¼šå„¿å¯ä»¥çœ‹åˆ°ï¼ŒChebNet å·ç§¯çš„è¾“å‡ºå’Œæ‰©æ•£å·ç§¯åˆ°å¸¸æ•°ç¼©æ”¾å› å­çš„è¾“å‡ºç›¸ä¼¼ã€‚å‡è®¾ $\lambda_{\text{max}} = 2$ï¼Œæ— å‘å›¾ $\boldsymbol{D}_I = \boldsymbol{D}_O = \boldsymbol{D}$ã€‚
&lt;/p&gt;
$$\tag{6}
\tilde{\boldsymbol{L}} = \boldsymbol{D}^{-\frac{1}{2}}(\boldsymbol{D} - \boldsymbol{W}) \boldsymbol{D}^{-\frac{1}{2}} - \boldsymbol{I} = - \boldsymbol{D}^{-\frac{1}{2}} \boldsymbol{W} \boldsymbol{D}^{-\frac{1}{2}} \sim - \boldsymbol{D}^{-1} \boldsymbol{W}
$$&lt;p&gt;
$\tilde{\boldsymbol{L}}$ å’Œè´Ÿçš„éšæœºæ¸¸èµ°è½¬ç§»çŸ©é˜µç›¸ä¼¼ï¼Œå› æ­¤å¼5çš„è¾“å‡ºä¹Ÿå’Œå¼2ç›´åˆ°å¸¸æ•°ç¼©æ”¾å› å­çš„è¾“å‡ºç›¸ä¼¼ã€‚&lt;/p&gt;</description></item><item><title>Structured Sequence Modeling With Graph Convolutional Recurrent Networks</title><link>https://davidham3.github.io/blog/p/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/</link><pubDate>Mon, 23 Jul 2018 10:59:15 +0000</pubDate><guid>https://davidham3.github.io/blog/p/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/</guid><description>&lt;p&gt;ICLR 2017(reject)ï¼Œä¸¤ä¸ªæ¨¡å‹ï¼Œç¬¬ä¸€ä¸ªæ˜¯å°†æ•°æ®æ‰”åˆ°Defferrardçš„å›¾å·ç§¯é‡Œé¢ï¼Œç„¶åå°†è¾“å‡ºæ‰”åˆ°LSTMé‡Œé¢ã€‚ç¬¬äºŒä¸ªæ¨¡å‹æ˜¯å°†RNNä¸­çš„çŸ©é˜µä¹˜æ³•æ¢æˆäº†å›¾å·ç§¯æ“ä½œï¼Œæœ€åå¯¹åŠ¨æ€çš„mnistè¿›è¡Œäº†è¯†åˆ«ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1612.07659v1" target="_blank" rel="noopener"
&gt;Structured Sequence Modeling With Graph Convolutional Recurrent Networks&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="æ‘˜è¦"&gt;æ‘˜è¦
&lt;/h1&gt;&lt;p&gt;GCRN(Graph Convolutional Recurrent Network)ï¼Œä¸€ä¸ªå¯ä»¥é¢„æµ‹ç»“æ„åŒ–åºåˆ—æ•°æ®çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚GCRNæ˜¯ä¼ ç»Ÿçš„å¾ªç¯ç¥ç»ç½‘ç»œçš„åœ¨ä»»æ„çš„å›¾ç»“æ„ä¸Šçš„ä¸€ç§æ³›åŒ–å½¢å¼ã€‚è¿™æ ·çš„ç»“æ„åŒ–æ•°æ®å¯ä»¥è¡¨ç¤ºæˆè§†é¢‘ä¸­çš„ä¸€ç³»åˆ—å¸§ï¼Œæ£€æµ‹å™¨ç»„æˆçš„ç½‘ç»œç›‘æµ‹åˆ°çš„æ—¶ç©ºç›‘æµ‹å€¼ï¼Œæˆ–æ˜¯ç”¨äºè‡ªç„¶è¯­è¨€å»ºæ¨¡çš„è¯ç½‘ä¸­çš„éšæœºæ¸¸èµ°ã€‚æˆ‘ä»¬æå‡ºçš„æ¨¡å‹åˆå¹¶äº†å›¾ä¸Šçš„CNNæ¥è¾¨è¯†ç©ºé—´ç»“æ„ï¼ŒRNNå¯»æ‰¾åŠ¨æ€æ¨¡å‹ã€‚æˆ‘ä»¬ç ”ç©¶äº†ä¸¤ç§GCRNï¼Œå¯¹Penn Treebankæ•°æ®é›†è¿›è¡Œå»ºæ¨¡ã€‚å®éªŒæ˜¾ç¤ºåŒæ—¶æŒ–æ˜å›¾çš„ç©ºé—´ä¸åŠ¨æ€ä¿¡æ¯å¯ä»¥åŒæ—¶æå‡precisionå’Œå­¦ä¹ é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 Introduction
&lt;/h1&gt;&lt;p&gt;å¾ˆå¤šå·¥ä½œï¼ŒDonahue et al. 2015; Karpathy &amp;amp; Fei-Fei 2015; Vinyals et al. 2015ï¼Œåˆ©ç”¨CNNå’ŒRNNçš„ç»„åˆæ¥æŒ–æ˜æ—¶ç©ºè§„å¾‹æ€§ã€‚è¿™äº›æ¨¡å‹é‚£ä¸ªå¤„ç†æ—¶é—´å˜åŒ–çš„è§†è§‰è¾“å…¥æ¥åšå˜é•¿çš„é¢„æµ‹ã€‚è¿™äº›ç½‘ç»œæ¶æ„ç”±è§†è§‰ç‰¹å¾æå–çš„CNNï¼Œå’Œä¸€ä¸ªåœ¨CNNåé¢ï¼Œç”¨äºåºåˆ—å­¦ä¹ çš„RNNç»„æˆã€‚è¿™æ ·çš„æ¶æ„æˆåŠŸåœ°ç”¨äºè§†é¢‘æ´»åŠ¨è¯†åˆ«ï¼Œå›¾åƒæ³¨é‡Šç”Ÿæˆä»¥åŠè§†é¢‘æè¿°ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘ï¼Œå¤§å®¶å¼€å§‹å¯¹æ—¶ç©ºåºåˆ—å»ºæ¨¡æ—¶èåˆCNNå’ŒRNNæ„Ÿå…´è¶£ã€‚å—åˆ°è¯­è¨€æ¨¡å‹çš„å¯å‘ï¼ŒRanzato et al. 2014æå‡ºäº†é€šè¿‡å‘ç°æ—¶ç©ºç›¸å…³æ€§çš„èƒ½è¡¨ç¤ºå¤æ‚å˜å½¢å’ŒåŠ¨ä½œæ¨¡å¼çš„æ¨¡å‹ã€‚ä»–ä»¬çš„å®éªŒè¡¨æ˜åœ¨é€šè¿‡quantizing the image patchesè·å¾—åˆ°çš„visual wordsä¸Šï¼Œä½¿ç”¨RNNå»ºæ¨¡ï¼Œå¯ä»¥å¾ˆå¥½çš„é¢„æµ‹è§†é¢‘çš„ä¸‹ä¸€å¸§ä»¥åŠä¸­é—´å¸§ã€‚ä»–ä»¬çš„è¡¨ç°æœ€å¥½çš„æ¨¡å‹æ˜¯recursive CNN(rCNN)ï¼Œå¯¹è¾“å…¥å’ŒçŠ¶æ€åŒæ—¶ä½¿ç”¨å·ç§¯ã€‚Shi et al. 2015ä¹‹åæå‡ºäº†å·ç§¯LSTM(convLSTM)ï¼Œä¸€ä¸ªä½¿ç”¨2Då·ç§¯åˆ©ç”¨è¾“å…¥æ•°æ®çš„ç©ºé—´ç›¸å…³æ€§ï¼Œç”¨äºæ—¶ç©ºåºåˆ—å»ºæ¨¡çš„RNNæ¨¡å‹ã€‚ä»–ä»¬æˆåŠŸçš„å¯¹é™é›¨ä¸´è¿‘é¢„æŠ¥çš„é›·è¾¾å›æ³¢å›¾çš„æ¼”åŒ–è¿›è¡Œäº†é¢„æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆå¤šé‡è¦é—®é¢˜ä¸­ï¼Œç©ºé—´ç»“æ„ä¸æ˜¯ç®€å•çš„ç½‘æ ¼çŠ¶ã€‚æ°”è±¡ç«™å°±ä¸æ˜¯ç½‘æ ¼çŠ¶ã€‚è€Œä¸”ç©ºé—´ç»“æ„ä¸ä¸€å®šæ˜¯ç©ºé—´ä¸Šçš„ï¼Œå¦‚ç¤¾äº¤ç½‘ç»œæˆ–ç”Ÿç‰©ç½‘ç»œã€‚æœ€åï¼ŒMikolov et al. 2013ç­‰äººè®¤ä¸ºï¼Œå¥å­å¯ä»¥è§£é‡Šæˆåœ¨è¯ç½‘ä¸Šçš„éšæœºæ¸¸èµ°ï¼Œä½¿å¾—æˆ‘ä»¬è½¬å‘äº†åˆ†æå›¾ç»“æ„çš„å¥å­å»ºæ¨¡é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„å·¥ä½œåˆ©ç”¨äº†è¿‘æœŸçš„æ¨¡å‹â€”â€”Defferrard et al. 2016; Ranzato et al. 2014; Shi et al. 2015â€”â€”æ¥è®¾è®¡GCRNæ¨¡å‹å¯¹æ—¶é—´å˜åŒ–çš„å›¾ç»“æ„æ•°æ®å»ºæ¨¡å’Œé¢„æµ‹ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯èåˆå›¾ç»“æ„ä¸Šçš„CNNå’ŒRNNæ¥åŒæ—¶è¾¨è¯†ç©ºé—´ç»“æ„å’ŒåŠ¨æ€æ¨¡å¼ã€‚å›¾1ç»™å‡ºäº†GCRNçš„æ¶æ„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;h1 id="2-preliminaries"&gt;2 Preliminaries
&lt;/h1&gt;&lt;h2 id="21-structured-sequence-modeling"&gt;2.1 Structured Sequence Modeling
&lt;/h2&gt;&lt;p&gt;åºåˆ—å»ºæ¨¡æ˜¯ç»™å®šå‰$J$ä¸ªè§‚æµ‹å€¼ï¼Œå¯¹æœªæ¥æœ€å¯èƒ½çš„é•¿åº¦ä¸º$K$çš„åºåˆ—è¿›è¡Œé¢„æµ‹ï¼š
&lt;/p&gt;
$$\tag{1}
\hat{x}\_{t+1},...,\hat{x}\_{t+K} = \mathop{\mathrm{argmax}}\limits\_{x\_{t+1},...,x\_{t+K}}P(x\_{t+1},...,x\_{t+K} \mid x\_{t-J+1},...,x\_t),
$$&lt;p&gt;
$x_t \in \mathbf{D}$æ˜¯æ—¶é—´$t$çš„è§‚æµ‹å€¼ï¼Œ$\mathbf{D}$è¡¨ç¤ºè§‚æµ‹åˆ°çš„ç‰¹å¾çš„åŸŸã€‚åŸå‹åº”ç”¨æ˜¯$n-\mathrm{gram}$æ¨¡å‹$(n = J + 1)$ï¼Œ$P(x_{t+1} \mid x_{t-J+1},&amp;hellip;,x_t)$å¯¹åœ¨å¥å­ä¸­ç»™å®šè¿‡å»$J$ä¸ªè¯æ—¶$x_{t+1}$å‡ºç°çš„æ¦‚ç‡è¿›è¡Œå»ºæ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯ç‰¹åˆ«çš„ç»“æ„åŒ–çš„å¥å­ï¼Œä¹Ÿå°±æ˜¯å¥å­ä¸­$x_t$çš„ç‰¹å¾ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œè€Œæ˜¯æœ‰ç€ä¸¤ä¸¤ç›¸è¿çš„å…³ç³»ã€‚è¿™æ ·çš„å…³ç³»å¹¿ä¹‰ä¸Šé€šè¿‡å¸¦æƒå›¾å»ºæ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;$x_t$å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå›¾ä¿¡å·ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå®šä¹‰åœ¨æ— å‘å¸¦æƒå›¾$\mathcal{G} = ( \mathcal{V}, \Large{\varepsilon}, \normalsize{A )}$ï¼Œå…¶ä¸­$\mathcal{V}$æ˜¯$\vert \mathcal{V} \vert = n$ä¸ªé¡¶ç‚¹çš„æœ‰é™é›†ï¼Œ$\Large{\varepsilon}$æ˜¯è¾¹é›†ï¼Œ$A \in \mathbb{R}^{n \times n}$æ˜¯å¸¦æƒé‚»æ¥çŸ©é˜µï¼Œç¼–ç äº†ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´çš„è¿æ¥æƒé‡ã€‚å®šä¹‰åœ¨å›¾çš„é¡¶ç‚¹ä¸Šçš„ä¿¡å·$x_t: \mathcal{V} \rightarrow \mathbb{R}^{d_x}$å¯ä»¥å½“ä½œæ˜¯ä¸€ä¸ªçŸ©é˜µ$x_t \in \mathbb{R}^{n \times d_x}$ï¼Œåˆ—$i$æ˜¯$d_x$ç»´å‘é‡ï¼Œè¡¨ç¤º$x_t$åœ¨ç¬¬$i$ä¸ªé¡¶ç‚¹çš„å€¼ã€‚å°½ç®¡è‡ªç”±å˜é‡çš„æ•°é‡åœ¨é•¿åº¦ä¸º$K$çš„ç»“æ„åŒ–åºåˆ—ä¸­æœ¬è´¨ä¸Šæ˜¯$\mathcal{O}(n^K{d_x}^K)$ï¼Œæˆ‘ä»¬ä»ç„¶è¯•å›¾å»æŒ–æ˜å¯èƒ½çš„é¢„æµ‹ç»“æœçš„ç©ºé—´ç»“æ„ä»¥å‡å°‘ç»´åº¦ï¼Œæ¥ä½¿è¿™äº›é—®é¢˜å˜å¾—å®¹æ˜“è§£å†³ã€‚&lt;/p&gt;
&lt;h2 id="22-long-short-term-memory"&gt;2.2 Long Short-Term Memory
&lt;/h2&gt;&lt;p&gt;é˜²æ­¢æ¢¯åº¦è¿‡å¿«æ¶ˆå¤±ï¼Œç”±Hochreiter &amp;amp; Schmidhuber 1997å‘æ˜çš„ä¸€ç§RNNï¼ŒLSTMã€‚è¿™ä¸ªæ¨¡å‹å·²ç»è¢«è¯æ˜åœ¨å„ç§åºåˆ—å»ºæ¨¡ä»»åŠ¡ä¸­ï¼Œå¯¹é•¿æœŸä¾èµ–å…³ç³»æ˜¯ç¨³å®šä¸”å¼ºåŠ²çš„æ¨¡å‹(Graves, 2013; Srivastava et al., 2015; Sutskever et al., 2014)ã€‚å…¨è¿æ¥LSTM(FC-LSTM)å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå¤šå˜é‡ç‰ˆæœ¬çš„LSTMï¼Œå…¶ä¸­$x_t \in \mathbb{R}^d_x$æ˜¯è¾“å…¥ï¼Œ$h_t \in [-1, 1]^{d_h}$æ˜¯ç»†èƒçŠ¶æ€ï¼Œ$c_t \in \mathbb{R}^{d_h}$æ˜¯éšè—çŠ¶æ€ï¼Œä»–ä»¬éƒ½æ˜¯å‘é‡ã€‚æˆ‘ä»¬ä½¿ç”¨Graves 2013çš„FC-LSTMï¼š
&lt;/p&gt;
$$\tag{2}
i = \sigma(W\_{xi} x\_t + W\_{hi}h\_{t-1} + w\_{ci} \odot c\_{t-1} + b\_i),\\
f = \sigma(W\_{xf} x\_t + W\_{hf} h\_{t-1} + w\_{cf} \odot c\_{t-1} + b\_f),\\
c\_t = f\_t \odot c\_{t-1} + i\_t \odot \mathrm{tanh}(W\_{xc} x\_t + W\_{hc} h\_{t-1} + b\_c),\\
o = \sigma(W\_{xo} x\_t + W\_{ho} h\_{t-1} + w\_{co} \odot c\_t + b\_o),\\
h\_t = o \odot \mathrm{tanh}(c\_t),
$$&lt;p&gt;
å…¶ä¸­$\odot$è¡¨ç¤ºHadamard productï¼Œ$\sigma(\cdot)$è¡¨ç¤ºsigmoid function $\sigma(x) = 1/(1+e^{-x})$ï¼Œ$i,f,o \in [0, 1]^{d_h}$æ˜¯è¾“å…¥é—¨ï¼Œé—å¿˜é—¨ï¼Œè¾“å‡ºé—¨ã€‚æƒé‡$W_{x\cdot} \in \mathbb{R}^{d_h \times d_x}$ï¼Œ$W_{h\cdot} \in \mathbb{R}^{d_h \times d_h}$ï¼Œ$w_{c\cdot} \in \mathbb{R}^{d_h}$ï¼Œåç½®$b_i,b_f,b_c,b_o \in \mathbb{R}^{d_h}$æ˜¯æ¨¡å‹å‚æ•°ã€‚è¿™ä¸ªæ¨¡å‹ä¹‹æ‰€ä»¥ç§°ä¸ºå…¨è¿æ¥æ˜¯å› ä¸º$W_{x\cdot}$å’Œ$W_{h\cdot}$ä¸$x$å’Œ$h$æ‰€æœ‰åˆ†é‡è¿›è¡Œçº¿æ€§ç»„åˆã€‚ç”±Gers &amp;amp; Schmidhuber 2000å¼•å…¥å¯é€‰çš„peephole connections $w_{c\cdot} \odot c_t$ï¼Œåœ¨æŸäº›ç‰¹å®šä»»åŠ¡ä¸Šå¯ä»¥æå‡æ€§èƒ½ã€‚&lt;/p&gt;
&lt;h2 id="23-convolutional-neural-networks-on-graphs"&gt;2.3 Convolutional Neural Networks On Graphs
&lt;/h2&gt;&lt;p&gt;Defferrard et al., 2016é€‰æ‹©äº†è°±ä¸Šçš„å·ç§¯æ“ä½œï¼š
&lt;/p&gt;
$$\tag{3}
y = g\_\theta \ast\_\mathcal{G} x = g\_\theta (L)x = g\_\theta (U \Lambda U^T)x = U g\_\theta (\Lambda) U^T x \in \mathbb{R}^{n \times d\_x},
$$&lt;p&gt;
å¯¹äºå½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ$L = I_n - D^{-1/2} A D^{-1/2} = U \Lambda U^T \in \mathbb{R}^{n \times n}$æ¥è¯´ï¼Œ$U \in \mathbb{R}^{n \times n}$æ˜¯çŸ©é˜µçš„ç‰¹å¾å‘é‡ï¼Œ$\Lambda \in \mathbb{R}^{n \times n}$æ˜¯ç‰¹å¾å€¼çš„å¯¹è§’çŸ©é˜µã€‚å¼3çš„æ—¶é—´å¤æ‚åº¦å¾ˆé«˜ï¼Œå› ä¸º$U$çš„ä¹˜æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯$\mathcal{O}(n^2)$ã€‚æ­¤å¤–ï¼Œè®¡ç®—$L$çš„ç‰¹å¾å€¼åˆ†è§£å¯¹äºå¤§çš„å›¾æ¥è¯´å¾ˆæ…¢ã€‚Defferrard et al., 2016ä½¿ç”¨åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼ï¼š
&lt;/p&gt;
$$\tag{4}
g\_\theta(\Lambda) = \sum^{K-1}\_{k=0} \theta\_k T\_k(\tilde{\Lambda}),
$$&lt;p&gt;
å‚æ•°$\theta \in \mathbb{R}^K$æ˜¯åˆ‡æ¯”é›ªå¤«ç³»æ•°çš„å‘é‡ï¼Œ$T_k(\tilde{\Lambda}) \in \mathbb{R}^{n \times n}$æ˜¯åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼çš„ké˜¶é¡¹åœ¨$\tilde{\Lambda} = 2\Lambda/\lambda_{max} - I_n$çš„å€¼ã€‚å›¾å·ç§¯æ“ä½œå¯ä»¥å†™ä¸ºï¼š
&lt;/p&gt;
$$\tag{5}
y = g\_\theta \ast\_{\mathcal{G}} x = g\_\theta (L) x = \sum^{K-1}\_{k=0} \theta\_k T\_k (\tilde{L})x,
$$&lt;p&gt;
$T_0 = 1$ï¼Œ$T_1 = x$ï¼Œ$T_k(x) = 2xT_{k-1}(x)-T_{k-2}(x)$ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯$\mathcal{O}(K \vert \Large{\varepsilon} \normalsize \vert)$ï¼Œä¹Ÿå°±æ˜¯å’Œè¾¹æ•°ç›¸å…³ã€‚è¿™ä¸ªå›¾å·ç§¯æ˜¯$K$é˜¶å±€éƒ¨åŒ–çš„ã€‚&lt;/p&gt;
&lt;h1 id="3-related-works"&gt;3 Related Works
&lt;/h1&gt;&lt;p&gt;Shi et al. 2015æå‡ºäº†é’ˆå¯¹å¸¸è§„ç½‘æ ¼ç»“æ„çš„åºåˆ—çš„æ¨¡å‹ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å›¾æ˜¯å›¾åƒç½‘æ ¼ä¸”é¡¶ç‚¹æœ‰åºçš„ç‰¹æ®Šæƒ…å†µã€‚ä»–ä»¬çš„æ¨¡å‹æœ¬è´¨ä¸Šæ˜¯FC-LSTMï¼Œ$W$çš„ä¹˜æ³•æ›¿æ¢ä¸ºå·ç§¯æ ¸$W$ï¼š
&lt;/p&gt;
$$\tag{6}
i = \sigma(W\_{xi} \ast x\_t + W\_{hi} \ast h\_{t-1} + w\_{ci} \odot c\_{t-1} + b\_i),\\
f = \sigma(W\_{xf} \ast x\_t + W\_{hf} \ast h\_{t-1} + w\_{cf} \odot c\_{t-1} + b\_f),\\
c\_t = f\_t \odot c\_{t-1} + i\_t \odot \mathrm{tanh}(W\_{xc} \ast x\_t + W\_{hc} \ast h\_{t-1} + b\_c),\\
o = \sigma(W\_{xo} \ast x\_t + W\_{ho} \ast h\_{t-1} + w\_{co} \odot c\_t + b\_o),\\
h\_t = o \odot \mathrm{tanh}(c\_t),
$$&lt;p&gt;
$\ast$è¡¨ç¤ºä¸€ç»„å·ç§¯æ ¸çš„2Då·ç§¯ã€‚åœ¨ä»–ä»¬çš„è®¾å®šä¸­$x_t \in \mathbb{R}^{n_r \times n_c \times d_x}$æ˜¯ä¸€ä¸ªåŠ¨æ€ç³»ç»Ÿä¸­ï¼Œæ—¶é—´$t$çš„$d_x$çš„è§‚æµ‹å€¼ï¼Œè¿™ä¸ªåŠ¨æ€ç³»ç»Ÿå»ºç«‹åœ¨ä¸€ä¸ªè¡¨ç¤ºä¸º$n_r$è¡Œ$n_c$åˆ—çš„ç©ºé—´åŒºåŸŸä¸Šã€‚æ¨¡å‹æœ‰ç€ç©ºé—´åˆ†å¸ƒçš„éšè—æ ¸ç»†èƒçŠ¶æ€ï¼Œå¤§å°æ˜¯$d_h$ï¼Œç”±å¼ é‡$c_t$ä½“ç°ï¼Œ$h_t \in \mathbb{R}^{n_r \times n_c \times d_h}$ã€‚å·ç§¯æ ¸$W_{h\cdot} \in \mathbb{R}^{m \times m \times d_h \times d_h}$å’Œ$W_{x\cdot} \in \mathbb{R}^{m \times m \times d_h \times d_x}$çš„å°ºå¯¸$m$å†³å®šäº†å‚æ•°çš„æ•°é‡ï¼Œä¸ç½‘æ ¼å¤§å°$n_r \times n_c$æ— å…³ã€‚æ›´æ—©ä¸€ç‚¹ï¼ŒRanzato et al. 2014æå‡ºäº†ç›¸ä¼¼çš„RNNå˜ä½“ï¼Œä½¿ç”¨å·ç§¯å±‚è€Œä¸æ˜¯å…¨è¿æ¥å±‚ã€‚æ—¶é—´$t$çš„éšè—çŠ¶æ€ï¼š
&lt;/p&gt;
$$\tag{7}
h\_t = \mathrm{tanh}(\sigma(W\_{x2} \ast \sigma(W\_{x1} \ast x\_t)) + \sigma(W\_h \ast h\_{t-1})),
$$&lt;p&gt;
å·ç§¯æ ¸$W_h \in \mathbb{R}^{d_h \times d_h}$å—é™åˆ°$1 \times 1$çš„å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;è§‚å¯Ÿåˆ°è‡ªç„¶è¯­è¨€è¡¨ç¤ºå‡ºè¯­æ³•æ€§è´¨ï¼Œè‡ªç„¶çš„å°†è¯èå…¥çŸ­è¯­ä¸­ï¼ŒTai et al. 2015æå‡ºäº†ä¸€ä¸ªå¤„ç†æ ‘ç»“æ„çš„æ¨¡å‹ï¼Œæ¯ä¸ªLSTMå¯ä»¥è·å–ä»–ä»¬çš„å­©å­çš„çŠ¶æ€ã€‚ä»–ä»¬åœ¨semantic relatedness and sentiment classificationä¸Šè·å¾—äº†state-of-the-artçš„ç»“æœã€‚Liang et al. 2016åœ¨ä¹‹åæå‡ºäº†åœ¨å›¾ä¸Šçš„å˜ä½“ã€‚ä»–ä»¬å¤æ‚çš„ç½‘ç»œç»“æ„åœ¨4ä¸ªæ•°æ®é›†ä¸Šè·å¾—äº†semantic object parsingçš„state-of-the-artç»“æœã€‚è¿™äº›æ¨¡å‹ä¸­ï¼ŒçŠ¶æ€é€šè¿‡ä¸€ä¸ªå¯è®­ç»ƒçš„æƒé‡çŸ©é˜µçš„å¸¦æƒåŠ å’Œä»é‚»å±…ä¸Šèšé›†ã€‚ç„¶è€Œè¿™äº›æƒé‡å¹¶ä¸åœ¨å›¾ä¸Šå…±äº«ï¼Œå¦åˆ™éœ€è¦å¯¹é¡¶ç‚¹æ’åºï¼Œå°±åƒå…¶ä»–å›¾å·ç§¯çš„ç©ºé—´å®šä¹‰ä¸€æ ·ã€‚æ­¤å¤–ï¼Œä»–ä»¬çš„å…¬å¼å—é™äºå½“å‰é¡¶ç‚¹çš„ä¸€é˜¶é‚»å±…ï¼Œç»™å…¶ä»–çš„é‚»å±…ç›¸åŒçš„æƒé‡ã€‚&lt;/p&gt;
&lt;p&gt;å—åˆ°å¦‚äººä½“åŠ¨ä½œå’Œç‰©ä½“äº¤äº’ç­‰æ—¶ç©ºä»»åŠ¡çš„å¯å‘ï¼ŒJain et al 2016æå‡ºäº†ä¸€ä¸ªæ–¹æ³•å°†æ—¶ç©ºå›¾çœ‹ä½œæ˜¯ä¸€ä¸ªå¯ŒRNNçš„æ··åˆï¼Œæœ¬è´¨ä¸Šæ˜¯å°†ä¸€ä¸ªRNNè¿æ¥åˆ°æ¯ä¸ªé¡¶ç‚¹ä¸æ¯æ¡è¾¹ä¸Šã€‚åŒæ ·çš„ï¼Œé€šä¿¡å—é™äºç›´æ¥è¿æ¥çš„é¡¶ç‚¹ä¸è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;å’Œæˆ‘ä»¬çš„å·¥ä½œæœ€ç›¸å…³çš„æ¨¡å‹å¯èƒ½æ˜¯Li et al 2015æå‡ºçš„æ¨¡å‹ï¼Œåœ¨program verificationä¸Šè¡¨ç°å‡ºäº†æœ€å¥½çš„ç»“æœã€‚å°½ç®¡ä»–ä»¬ä½¿ç”¨Scarselli et al. 2009æå‡ºçš„GNNï¼Œä»¥è¿­ä»£çš„æ­¥éª¤ä¼ æ’­é¡¶ç‚¹çš„è¡¨ç¤ºï¼Œç›´åˆ°æ”¶æ•›ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯Defferrard et al. 2016æå‡ºçš„GCNåœ¨é¡¶ç‚¹é—´æ‰©æ•£ä¿¡æ¯ã€‚å°½ç®¡ä»–ä»¬çš„åŠ¨æœºå’Œæˆ‘ä»¬å¾ˆä¸ä¸€æ ·ï¼Œè¿™äº›æ¨¡å‹çš„å…³è”æ˜¯ä½¿ç”¨$K$é˜¶å¤šé¡¹å¼å®šä¹‰çš„è°±æ»¤æ³¢å™¨å¯ä»¥å®ç°æˆä¸€ä¸ª$K$å±‚çš„GNNã€‚&lt;/p&gt;
&lt;h1 id="4-proposed-gcrn-models"&gt;4 Proposed GCRN Models
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬æå‡ºäº†ä¸¤ç§GCRNæ¶æ„&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Model 1.&lt;/strong&gt;
&lt;/p&gt;
$$\tag{8}
x^{\mathrm{CNN}}\_t = \mathrm{CNN}\_\mathcal{G}(x\_t)\\
i = \sigma(W\_{xi} x^{\mathrm{CNN}}\_t + W\_{hi}h\_{t-1} + w\_{ci} \odot c\_{t-1} + b\_i),\\
f = \sigma(W\_{xf} x^{\mathrm{CNN}}\_t + W\_{hf} h\_{t-1} + w\_{cf} \odot c\_{t-1} + b\_f),\\
c\_t = f\_t \odot c\_{t-1} + i\_t \odot \mathrm{tanh}(W\_{xc} x^{\mathrm{CNN}}\_t + W\_{hc} h\_{t-1} + b\_c),\\
o = \sigma(W\_{xo} x^{\mathrm{CNN}}\_t + W\_{ho} h\_{t-1} + w\_{co} \odot c\_t + b\_o),\\
h\_t = o \odot \mathrm{tanh}(c\_t).
$$&lt;p&gt;
æˆ‘ä»¬ç®€å•åœ°å†™æˆ$x^{\mathrm{CNN}}_t = W^{\mathrm{CNN}} \ast_\mathcal{G} x_t$ï¼Œå…¶ä¸­$W^{\mathrm{CNN}} \in \mathbb{R}^{K \times d_x \times d_x}$æ˜¯åˆ‡æ¯”é›ªå¤«ç³»æ•°ã€‚Peepholesç”±$w_{c\cdot} \in \mathbb{R}^{n \times d_h}$æ§åˆ¶ã€‚è¿™æ ·çš„æ¶æ„å¯èƒ½è¶³ä»¥æ•è·æ•°æ®çš„åˆ†å¸ƒï¼Œé€šè¿‡æŒ–æ˜å±€éƒ¨é™æ­¢æ€§ä»¥åŠæ€§è´¨çš„ç»„åˆæ€§ï¼Œè¿˜æœ‰åŠ¨æ€å±æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Model 2.&lt;/strong&gt;
&lt;/p&gt;
$$\tag{9}
i = \sigma(W\_{xi} \ast\_\mathcal{G} x\_t + W\_{hi} \ast\_\mathcal{G} h\_{t-1} + w\_{ci} \odot c\_{t-1} + b\_i),\\
f = \sigma(W\_{xf} \ast\_\mathcal{G} x\_t + W\_{hf} \ast\_\mathcal{G} h\_{t-1} + w\_{cf} \odot c\_{t-1} + b\_f),\\
c\_t = f\_t \odot c\_{t-1} + i\_t \odot \mathrm{tanh}(W\_{xc} \ast\_\mathcal{G} x\_t + W\_{hc} \ast\_\mathcal{G} h\_{t-1} + b\_c),\\
o = \sigma(W\_{xo} \ast\_\mathcal{G} x\_t + W\_{ho} \ast\_\mathcal{G} h\_{t-1} + w\_{co} \odot c\_t + b\_o),\\
h\_t = o \odot \mathrm{tanh}(c\_t),
$$&lt;p&gt;
å›¾å·ç§¯æ ¸æ˜¯åˆ‡æ¯”é›ªå¤«ç³»æ•°$W_{h\cdot} \in \mathbb{R}^{K \times d_h \times d_h}$ï¼Œ$W_{x\cdot} \in \mathbb{R}^{K \times d_h \times d_x}$å†³å®šäº†å‚æ•°çš„æ•°ç›®ï¼Œä¸é¡¶ç‚¹æ•°$n$æ— å…³ã€‚
è¿™ç§RNNå’ŒCNNçš„æ··åˆï¼Œä¸é™äºLSTMã€‚æ™®é€šçš„RNN $h_t = \mathrm{tanh}(W_x x_t + W_h h_{t-1})$å¯ä»¥å†™ä¸ºï¼š
&lt;/p&gt;
$$\tag{10}
h\_t = \mathrm{tanh}(W\_x \ast\_\mathcal{G} x\_t + W\_h \ast\_\mathcal{G} h\_{t-1}),
$$&lt;p&gt;
GRUçš„ç‰ˆæœ¬å¯ä»¥å†™ä¸ºï¼š
&lt;/p&gt;
$$\tag{11}
z = \sigma(W\_{xz} \ast\_\mathcal{G} x\_t + W\_{hz} \ast\_\mathcal{G} h\_{t-1}),\\
r = \sigma(W\_{xr} \ast\_\mathcal{G} x\_t + W\_{hr} \ast\_\mathcal{G} h\_{t-1}),\\
\tilde{h} = \mathrm{tanh}(W\_{xh} \ast\_\mathcal{G} x\_t + W\_{hh} \ast\_\mathcal{G} (r \odot h\_{t-1})),\\
h\_t = z \odot h\_{t-1} + (1 - z) \odot \tilde{h}.
$$&lt;h1 id="5-experiments"&gt;5 Experiments
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/Table1.JPG"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;p&gt;æ•°æ®é›†æ˜¯moving-MNIST(Shi et al., 2015)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/structured-sequence-modeling-with-graph-convolutional-recurrent-networks/Fig3.JPG"
loading="lazy"
alt="â€œFigure3 &amp; Figure4â€"
&gt;&lt;/p&gt;</description></item><item><title>GCNè®ºæ–‡æ±‡æ€»</title><link>https://davidham3.github.io/blog/p/gcn%E8%AE%BA%E6%96%87%E6%B1%87%E6%80%BB/</link><pubDate>Mon, 23 Jul 2018 09:29:28 +0000</pubDate><guid>https://davidham3.github.io/blog/p/gcn%E8%AE%BA%E6%96%87%E6%B1%87%E6%80%BB/</guid><description>&lt;p&gt;å¯¹çœ‹è¿‡çš„å›¾ç¥ç»ç½‘ç»œåšä¸ªæ€»ç»“ï¼Œç›®å‰ä¸»è¦æ˜¯GCNã€‚&lt;/p&gt;
&lt;p&gt;Semi-Supervised Classification With Graph Convolutional Networks. Kipf &amp;amp; Welling 2017&lt;br&gt;
ICLR 2017ã€‚ä½¿ç”¨åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼çš„1é˜¶è¿‘ä¼¼å®Œæˆäº†é«˜æ•ˆçš„å›¾å·ç§¯æ¶æ„ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: center"&gt;ä¼˜ç‚¹&lt;/th&gt;
&lt;th style="text-align: center"&gt;ç¼ºç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;1é˜¶è¿‘ä¼¼ï¼Œæ¯”ké˜¶è¿‘ä¼¼é«˜æ•ˆ&lt;/td&gt;
&lt;td style="text-align: center"&gt;å·ç§¯éœ€ä½¿ç”¨æ•´ä¸ªå›¾çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼Œå›¾ä¸èƒ½æ‰©å±•&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Convolution on Graph: A High-Order and Adaptive Approach.&lt;br&gt;
NIPS 2016ï¼Œé‡æ–°å®šä¹‰äº†å·ç§¯çš„å®šä¹‰ï¼Œåˆ©ç”¨ké˜¶é‚»æ¥çŸ©é˜µï¼Œå®šä¹‰è€ƒè™‘ké˜¶é‚»å±…çš„å·ç§¯ï¼Œåˆ©ç”¨é‚»æ¥çŸ©é˜µå’Œç‰¹å¾çŸ©é˜µæ„å»ºèƒ½åŒæ—¶è€ƒè™‘é¡¶ç‚¹ç‰¹å¾å’Œå›¾ç»“æ„ä¿¡æ¯çš„å·ç§¯æ ¸ã€‚åœ¨é¢„æµ‹é¡¶ç‚¹ã€é¢„æµ‹å›¾ã€ç”Ÿæˆå›¾ä¸‰ä¸ªä»»åŠ¡ä¸ŠéªŒè¯äº†æ¨¡å‹çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: center"&gt;ä¼˜ç‚¹&lt;/th&gt;
&lt;th style="text-align: center"&gt;ç¼ºç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Graph Convolutional Neural Networks for Web-Scale Recommender Systems.&lt;br&gt;
KDD 2018ã€‚ä½¿ç”¨å›¾å·ç§¯å¯¹é¡¶ç‚¹è¿›è¡Œè¡¨ç¤ºï¼Œå­¦ä¹ é¡¶ç‚¹çš„embeddingï¼Œé€šè¿‡å·ç§¯å°†è¯¥é¡¶ç‚¹çš„é‚»å±…ä¿¡æ¯èå…¥åˆ°å‘é‡ä¸­ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: center"&gt;ä¼˜ç‚¹&lt;/th&gt;
&lt;th style="text-align: center"&gt;ç¼ºç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;è¶…å¤§è§„æ¨¡çš„å›¾&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Diffusion-Convolutional Neural Networks.&lt;br&gt;
NIPS 2016ã€‚åœ¨å·ç§¯æ“ä½œä¸­èå…¥äº†h-hopè½¬ç§»æ¦‚ç‡çŸ©é˜µï¼Œé€šè¿‡å¯¹æ¯ä¸ªé¡¶ç‚¹è®¡ç®—è¯¥é¡¶ç‚¹åˆ°å…¶ä»–æ‰€æœ‰é¡¶ç‚¹çš„è½¬ç§»æ¦‚ç‡ä¸ç‰¹å¾çŸ©é˜µçš„ä¹˜ç§¯ï¼Œæ„é€ é¡¶ç‚¹æ–°çš„ç‰¹å¾è¡¨ç¤ºï¼Œå³diffusion-convolutional representationï¼Œè¡¨å¾é¡¶ç‚¹ä¿¡æ¯çš„æ‰©æ•£ï¼Œç„¶åä¹˜ä»¥æƒé‡çŸ©é˜µWï¼ŒåŠ æ¿€æ´»å‡½æ•°ï¼Œå¾—åˆ°å·ç§¯çš„å®šä¹‰ã€‚åœ¨é¡¶ç‚¹åˆ†ç±»å’Œå›¾åˆ†ç±»ä¸Šåšäº†æµ‹è¯•ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: center"&gt;ä¼˜ç‚¹&lt;/th&gt;
&lt;th style="text-align: center"&gt;ç¼ºç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;æ²¡æœ‰å¢åŠ æ¨¡å‹çš„å¤æ‚åº¦&lt;/td&gt;
&lt;td style="text-align: center"&gt;ç©ºé—´å¤æ‚åº¦é«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;ä½¿ç”¨è½¬ç§»æ¦‚ç‡çŸ©é˜µ&lt;/td&gt;
&lt;td style="text-align: center"&gt;æ¨¡å‹ä¸èƒ½æ•è·å°ºåº¦è¾ƒå¤§çš„ç©ºé—´ä¾èµ–å…³ç³»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;&lt;/td&gt;
&lt;td style="text-align: center"&gt;ä¸åŒçš„åˆ†ç±»ä»»åŠ¡ï¼ˆé¡¶ç‚¹ã€å›¾ï¼‰æœ‰ä¸åŒçš„å·ç§¯è¡¨è¾¾å¼&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Graph Attention Networks.&lt;br&gt;
ICLR 2018ã€‚å›¾æ³¨æ„åŠ›ç½‘ç»œï¼Œä½¿ç”¨self-attentionæ¥æ„å»ºgraph attentional layerï¼Œattentionä¼šè€ƒè™‘å½“å‰é¡¶ç‚¹æ‰€æœ‰çš„é‚»å±…å¯¹å®ƒçš„é‡è¦åº¦ï¼ŒåŸºäºè°±ç†è®ºçš„æ¨¡å‹ä¸èƒ½åº”ç”¨åˆ°å…¶ä»–ä¸åŒç»“æ„çš„å›¾ä¸Šï¼Œè€Œè¿™ä¸ªåŸºäºattentionçš„æ–¹æ³•èƒ½æœ‰æ•ˆçš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;Inductive Representation Learning on Large Graphs.&lt;br&gt;
NIPS 2017ã€‚æå‡ºçš„æ–¹æ³•å«GraphSAGEï¼Œé’ˆå¯¹çš„é—®é¢˜æ˜¯ä¹‹å‰çš„NRLæ˜¯transductiveï¼Œä½œè€…æå‡ºçš„GraphSAGEæ˜¯inductiveã€‚ä¸»è¦è€ƒè™‘äº†å¦‚ä½•èšåˆé¡¶ç‚¹çš„é‚»å±…ä¿¡æ¯ï¼Œå¯¹é¡¶ç‚¹æˆ–å›¾è¿›è¡Œåˆ†ç±»ã€‚&lt;/p&gt;
&lt;p&gt;åº”ç”¨ï¼š&lt;/p&gt;
&lt;p&gt;Spatio-Temporal Graph Convolutional Networks: A Deep Learning Framework for Traffic.&lt;br&gt;
IJCAI 2018ï¼Œå¤§ä½“æ€è·¯ï¼šä½¿ç”¨Kipf &amp;amp; Welling 2017çš„è¿‘ä¼¼è°±å›¾å·ç§¯å¾—åˆ°çš„å›¾å·ç§¯ä½œä¸ºç©ºé—´ä¸Šçš„å·ç§¯æ“ä½œï¼Œæ—¶é—´ä¸Šä½¿ç”¨ä¸€ç»´å·ç§¯å¯¹æ‰€æœ‰é¡¶ç‚¹è¿›è¡Œå·ç§¯ï¼Œä¸¤è€…äº¤æ›¿è¿›è¡Œï¼Œç»„æˆäº†æ—¶ç©ºå·ç§¯å—ï¼Œåœ¨åŠ å·PeMSå’ŒåŒ—äº¬å¸‚çš„ä¸¤ä¸ªæ•°æ®é›†ä¸Šåšäº†éªŒè¯ã€‚&lt;/p&gt;
&lt;p&gt;Spatial Temporal Graph Convolutional Networks for Skeleton-Based Action Recognition.&lt;br&gt;
AAAI 2018ï¼Œä»¥äººä½“å…³èŠ‚ä¸ºå›¾çš„é¡¶ç‚¹ï¼Œæ„å»ºç©ºé—´ä¸Šçš„å›¾ï¼Œç„¶åé€šè¿‡æ—¶é—´ä¸Šçš„å…³ç³»ï¼Œè¿æ¥è¿ç»­å¸§ä¸Šç›¸åŒçš„å…³èŠ‚ï¼Œæ„æˆä¸€ä¸ªä¸‰ç»´çš„æ—¶ç©ºå›¾ã€‚é’ˆå¯¹æ¯ä¸ªé¡¶ç‚¹ï¼Œå¯¹å…¶é‚»å±…è¿›è¡Œå­é›†åˆ’åˆ†ï¼Œæ¯ä¸ªå­é›†ä¹˜ä»¥å¯¹åº”çš„æƒé‡å‘é‡ï¼Œå¾—åˆ°æ—¶ç©ºå›¾ä¸Šçš„å·ç§¯å®šä¹‰ã€‚å®ç°æ—¶ä½¿ç”¨Kipf &amp;amp; Welling 2017çš„æ–¹æ³•å®ç°ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: center"&gt;ä¼˜ç‚¹&lt;/th&gt;
&lt;th style="text-align: center"&gt;ç¼ºç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;å°†ç©ºé—´å’Œæ—¶é—´ä¸€ä½“åŒ–&lt;/td&gt;
&lt;td style="text-align: center"&gt;å®ç°ä¸Šä»æ˜¯Kipf &amp;amp; Wellingçš„æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</description></item><item><title>å¤æ‚ç½‘ç»œåŸºç¡€</title><link>https://davidham3.github.io/blog/p/%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/</link><pubDate>Sat, 21 Jul 2018 18:10:09 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/</guid><description>&lt;p&gt;è§‰å¾—æœ€è¿‘åº”è¯¥æŠŠå¤æ‚ç½‘ç»œçš„åŸºç¡€çŸ¥è¯†æ¡ä¸€æ¡ï¼Œå»å¹´ä¸Šè¯¾è™½ç„¶å­¦è¿‡ï¼Œä¸è¿‡åŸºæœ¬éƒ½å¿˜äº†ï¼Œä»€ä¹ˆbetweenessï¼Œéƒ½ä¸çŸ¥é“æ˜¯ä»€ä¹ˆäº†ã€‚æœ€è¿‘è¦åšå¤æ‚ç½‘ç»œæ–¹é¢çš„ç ”ç©¶ï¼Œè¿™äº›çŸ¥è¯†æ˜¯å¿…éœ€çš„ã€‚æ‰“ç®—çœ‹ä¸€ä¸‹Newmançš„ä¹¦&amp;quot;Networks an Introduction&amp;quot;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯¹å¤æ‚ç½‘ç»œæ„Ÿå…´è¶£ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆå¤šç³»ç»Ÿéƒ½æ˜¯ç”±ç½‘ç»œç»„æˆçš„ã€‚å› ç‰¹ç½‘ï¼Œäººç±»ç¤¾ä¼šéƒ½æ˜¯ã€‚æœ‰äººç ”ç©¶ä¸ªä½“ç»„æˆï¼Œå³é¡¶ç‚¹çš„æ€§è´¨ï¼Œæœ‰äººç ”ç©¶å…³ç³»ï¼Œå³è¿æ¥ï¼Œè¿˜æœ‰äººç ”ç©¶è¿™äº›ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯componentså’Œconnectionsä¹‹é—´çš„&lt;em&gt;pattern&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹æ®Šçš„æ¨¡å¼ä¼šåœ¨ç³»ç»Ÿä¸­äº§ç”Ÿå¾ˆå¤§å½±å“ã€‚é™¤éæˆ‘ä»¬çŸ¥é“ç½‘ç»œç»“æ„ï¼Œå¦åˆ™å¾ˆéš¾å®Œå…¨ç†è§£æ•´ä¸ªç³»ç»Ÿå¦‚ä½•å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;ç½‘ç»œæ˜¯å¯¹ä¸€ä¸ªç³»ç»Ÿçš„ç®€å•è¡¨ç¤ºï¼Œåªæœ‰åŸºæœ¬çš„è¿æ¥æ¨¡å¼å’Œå…¶ä»–çš„ä¸€ç‚¹ä¸œè¥¿ã€‚é¡¶ç‚¹å’Œè¾¹å¯ä»¥æ ‡è®°ä¸Šé¢å¤–çš„ä¿¡æ¯ï¼Œæ¥è¯¦ç»†æè¿°è¿™ä¸ªç³»ç»Ÿï¼Œä½†æ˜¯åœ¨è¡¨ç¤ºç½‘ç»œçš„æ—¶å€™é€šå¸¸ä¼šä¸¢å¤±ä¿¡æ¯ã€‚è¿™å°±æ˜¯å®ƒçš„ç¼ºç‚¹ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¼˜ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›å¹´æ¥ï¼Œç§‘å­¦å®¶ä»¬ä½¿ç”¨æ•°å­¦ã€è®¡ç®—æœºã€ç»Ÿè®¡å­¦æ–¹æ³•å¯¹å¤æ‚ç½‘ç»œè¿›è¡Œåˆ†æã€å»ºæ¨¡ã€ç†è§£ã€‚å¾ˆå¤šå·¥å…·ä»ä¸€ä¸ªç®€å•çš„ç½‘ç»œè¡¨ç¤ºå¼€å§‹ï¼Œä¸€ç»„é¡¶ç‚¹å’Œè¾¹ï¼Œåœ¨é€‚å½“çš„è®¡ç®—åä¼šå¾—åˆ°ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯ï¼šæ¯”å¦‚å“ªä¸ªæ˜¯æœ€å¥½çš„é¡¶ç‚¹ï¼Œæˆ–æ˜¯ä¸€ä¸ªé¡¶ç‚¹åˆ°å¦ä¸€ä¸ªé¡¶ç‚¹çš„è·¯å¾„é•¿åº¦ã€‚å…¶ä»–å·¥å…·ä½¿ç”¨å¯ä»¥åšé¢„æµ‹çš„ç½‘ç»œçš„å½¢å¼ï¼Œæ¯”å¦‚äº’è”ç½‘æµé‡æˆ–ä¼ æŸ“ç—…åœ¨ç¤¾åŒºå†…æ‰©æ•£çš„é€”å¾„ã€‚å› ä¸ºè¿™äº›å·¥å…·æ˜¯åœ¨æŠ½è±¡å½¢å¼ä¸‹å·¥ä½œï¼Œæ‰€ä»¥ç†è®ºä¸Šå¯ä»¥åº”ç”¨åˆ°ä»»ä½•å¯ä»¥è¡¨ç¤ºæˆç½‘ç»œçš„ç³»ç»Ÿä¸Šã€‚å› æ­¤å¦‚æœä½ æ„Ÿå…´è¶£çš„ç³»ç»Ÿå¯ä»¥è¡¨ç¤ºæˆç½‘ç»œï¼Œé‚£å°±æœ‰å¾ˆå¤šå·¥å…·å¯ä»¥ä½¿ç”¨ã€‚å½“ç„¶ä¸æ˜¯æ‰€æœ‰çš„å·¥å…·éƒ½èƒ½ç»™å‡ºæœ‰æ•ˆçš„ç»“æœï¼Œæœ‰äº›æ–¹æ³•æ˜¯ç”¨åœ¨ç‰¹å®šé—®é¢˜ä¸Šçš„ã€‚ä½†æ˜¯å¦‚æœä½ æœ‰ä¸€ä¸ªå…³äºç½‘ç»œçš„well-posed questionï¼Œå¤§å¤šæ•°å‹æ¡†æ¶ï¼Œè¿˜æ˜¯æœ‰ä¸€ä¸ªå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜çš„å·¥å…·çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸€äº›ç½‘ç»œçš„ä¾‹å­&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/%e5%a4%8d%e6%9d%82%e7%bd%91%e7%bb%9c%e5%9f%ba%e7%a1%80/Fig1.1.JPG"
loading="lazy"
alt="Figure1"
&gt;
&lt;img src="https://davidham3.github.io/blog/images/%e5%a4%8d%e6%9d%82%e7%bd%91%e7%bb%9c%e5%9f%ba%e7%a1%80/Fig1.1-2.JPG"
loading="lazy"
alt="Figure1"
&gt;
æœ€å‡ºåçš„ä¸”å¹¿æ³›ç ”ç©¶çš„ç½‘ç»œä¹‹ä¸€å°±æ˜¯å¥½è®ºæ–‡ã€‚è®¡ç®—æœºç»„æˆçš„ç½‘ç»œï¼Œè®¡ç®—æœºæ˜¯é¡¶ç‚¹ï¼Œç‰©ç†æ•°æ®è¿æ¥æ˜¯è¾¹ï¼Œå¦‚å…‰çº¤æˆ–ç”µè¯çº¿ã€‚å›¾1.1å±•ç¤ºäº†äº’è”ç½‘çš„ç»“æ„ï¼Œ2003å¹´çš„ä¸€ä¸ªsnapshotï¼Œé€šè¿‡æ•°æ®åŒ…çš„æµé€šæ„å»ºçš„ç½‘ç»œã€‚å°½ç®¡äº’è”ç½‘æ˜¯äººå·¥åˆ¶é€ çš„ï¼Œè€Œä¸”æ˜¯å¾ˆç»†è‡´çš„å·¥ç¨‹ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“å®ƒçš„ç»“æ„æ˜¯ä»€ä¹ˆï¼Œå› ä¸ºå®ƒæ˜¯ç”±å¾ˆå¤šä¸åŒçš„äººç¾¤æ„å»ºå‡ºæ¥çš„ï¼Œå¤§å®¶å¹¶ä¸äº†è§£å…¶ä»–äººçš„è¡ŒåŠ¨ï¼Œå¾ˆå°‘æœ‰ä¸­å¤®æ§åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å¾ˆå¤šä»¤äººæ¿€åŠ¨çš„å®ç”¨åŸå› è®©æˆ‘ä»¬æƒ³ç ”ç©¶å› ç‰¹ç½‘çš„ç»“æ„ã€‚å› ç‰¹ç½‘çš„åŠŸèƒ½æ˜¯åœ¨ä¸åŒåœ°æ–¹çš„è®¡ç®—æœºä¹‹é—´ä¼ æ’­æ•°æ®ï¼Œä»–ä»¬ä¼šå°†æ•°æ®åˆ†æˆç‰‡æˆ–åŒ…ï¼Œç„¶åå†ç½‘ç»œä¸­çš„é¡¶ç‚¹é—´ä¼ é€ï¼Œç›´åˆ°è¿™äº›åŒ…åˆ°è¾¾ä»–ä»¬çš„ç›®çš„åœ°ã€‚ç½‘ç»œçš„ç»“æ„ä¼šå½±å“ä»–ä»¬å®Œæˆè¿™äº›ä»»åŠ¡çš„æ•ˆç‡ï¼Œè€Œä¸”å¦‚æœæˆ‘ä»¬ç›´åˆ°ç½‘ç»œçš„ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥è§£å†³å¾ˆå¤šå®é™…é—®é¢˜ã€‚æˆ‘ä»¬åº”è¯¥é€‰æ‹©å“ªä¸ªè·¯ç”±æ¥ä¼ è¾“æ•°æ®ï¼Ÿæœ€çŸ­è·¯å¾„æ€»æ˜¯æœ€å¿«çš„å—ï¼Ÿå¦‚æœä¸æ˜¯ï¼Œæ€ä¹ˆæ‰èƒ½æ‰¾åˆ°æœ€å¿«çš„ï¼Ÿæˆ‘ä»¬æ€ä¹ˆé¿å…bottleneckä½¿æµé‡é˜»å¡ï¼Ÿå½“ä¸€ä¸ªé¡¶ç‚¹æˆ–ä¸€æ¡è¾¹æŒ‚æ‰æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿç­‰ç­‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å› ç‰¹ç½‘ç»“æ„çš„çŸ¥è¯†åœ¨ç ”å‘æ–°çš„é€šè®¯æ ‡å‡†ä¸­æ˜¯è‡³å…³é‡è¦çš„ã€‚æ–°çš„æ ‡å‡†å’Œåè®®è¿˜æ˜¯ä¸ºå› ç‰¹ç½‘æ‰€è®¾è®¡ï¼Œè€çš„ä¼šè¢«ç¿»æ–°ã€‚åè®®çš„å‚æ•°ä¼šä¸ºäº†ç½‘ç»œçš„ç»“æ„è€Œä¼˜åŒ–ã€‚åœ¨ç½‘ç»œçš„æ—©äº›æ—¶å€™ï¼Œä¸æ˜¯ç½‘ç»œç»“æ„çš„ä¸»è¦æ¨¡å‹åœ¨è°ƒæ•´è¿‡ç¨‹ä¸­ä½¿ç”¨ï¼Œè€Œæ˜¯é‚£äº›æ›´å¥½çš„ç»“æ„æ•°æ®å˜å¾—å¯è·å¾—åï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½çš„ç†è§£è¿™äº›æ•°æ®å¹¶ä¸”æå‡æ¨¡å‹çš„æ€§èƒ½ã€‚&lt;/p&gt;</description></item><item><title>Inductive Representation Learning on Large Graphs</title><link>https://davidham3.github.io/blog/p/inductive-representation-learning-on-large-graphs/</link><pubDate>Thu, 19 Jul 2018 18:53:17 +0000</pubDate><guid>https://davidham3.github.io/blog/p/inductive-representation-learning-on-large-graphs/</guid><description>&lt;p&gt;NIPS 2017ã€‚æå‡ºçš„æ–¹æ³•å« GraphSAGEï¼Œé’ˆå¯¹çš„é—®é¢˜æ˜¯ä¹‹å‰çš„ NRL æ˜¯ transductiveï¼Œä¸èƒ½æ³›åŒ–åˆ°æ–°ç»“ç‚¹ä¸Šï¼Œè€Œä½œè€…æå‡ºçš„ GraphSAGE æ˜¯ inductiveã€‚ä¸»è¦è€ƒè™‘äº†å¦‚ä½•èšåˆé¡¶ç‚¹çš„é‚»å±…ä¿¡æ¯ï¼Œå¯¹é¡¶ç‚¹æˆ–å›¾è¿›è¡Œåˆ†ç±»ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1706.02216" target="_blank" rel="noopener"
&gt;Inductive Representation Learning on Large Graphs&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;ç°å­˜çš„æ–¹æ³•éœ€è¦å›¾ä¸­æ‰€æœ‰çš„é¡¶ç‚¹åœ¨è®­ç»ƒ embedding çš„æ—¶å€™éƒ½å‡ºç°ï¼›è¿™äº›å‰äººçš„æ–¹æ³•æœ¬è´¨æ˜¯ &lt;em&gt;transductive&lt;/em&gt;ï¼Œä¸èƒ½è‡ªç„¶åœ°æ³›åŒ–åˆ°æœªè§è¿‡çš„é¡¶ç‚¹ä¸Šã€‚æˆ‘ä»¬æå‡ºäº† GraphSAGEï¼Œä¸€ä¸ª &lt;em&gt;inductive&lt;/em&gt; æ¡†æ¶ï¼Œåˆ©ç”¨é¡¶ç‚¹ç‰¹å¾ä¿¡æ¯ï¼ˆæ¯”å¦‚æ–‡æœ¬å±æ€§ï¼‰æ¥é«˜æ•ˆåœ°ä¸ºæ²¡æœ‰è§è¿‡çš„é¡¶ç‚¹ç”Ÿæˆ embeddingã€‚ä¸å…¶ä¸ºæ¯ä¸ªé¡¶ç‚¹è®­ç»ƒå•ç‹¬çš„ embeddingï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ˜¯å­¦ä¹ ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°é€šè¿‡ä»ä¸€ä¸ªé¡¶ç‚¹çš„å±€éƒ¨é‚»å±…é‡‡æ ·å¹¶èšåˆé¡¶ç‚¹ç‰¹å¾ã€‚æˆ‘ä»¬çš„ç®—æ³•åœ¨ä¸‰ä¸ª inductive é¡¶ç‚¹åˆ†ç±»æ•°æ®é›†ä¸Šè¶…è¶Šäº†é‚£äº›å¾ˆå¼ºçš„ baselineï¼šåœ¨ citation å’Œ Reddit post æ•°æ®çš„æ¼”åŒ–çš„ä¿¡æ¯å›¾ä¸­å¯¹æœªè§è¿‡çš„é¡¶ç‚¹åˆ†ç±»ï¼Œåœ¨ PPI å¤šå›¾æ•°æ®é›†ä¸Šå¯ä»¥æ³›åŒ–åˆ°å®Œå…¨æœªè§è¿‡çš„å›¾ä¸Šã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 Introduction
&lt;/h1&gt;&lt;p&gt;é¡¶ç‚¹åµŒå…¥çš„åŸºæœ¬æ€æƒ³æ˜¯ä½¿ç”¨é™ç»´æŠ€æœ¯ä»é«˜ç»´ä¿¡æ¯ä¸­æç‚¼ä¸€ä¸ªé¡¶ç‚¹çš„é‚»å±…ä¿¡æ¯ï¼Œå­˜åˆ°ä½ç»´å‘é‡ä¸­ã€‚è¿™äº›é¡¶ç‚¹åµŒå…¥ä¹‹åä¼šä½œä¸ºåç»­çš„æœºå™¨å­¦ä¹ ç³»ç»Ÿçš„è¾“å…¥ï¼Œè§£å†³åƒé¡¶ç‚¹åˆ†ç±»ã€èšç±»ã€é“¾æ¥é¢„æµ‹è¿™æ ·çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œå‰äººçš„å·¥ä½œä¸“æ³¨äºå¯¹ä¸€ä¸ªå›ºå®šçš„å›¾ä¸­çš„é¡¶ç‚¹è¿›è¡Œè¡¨ç¤ºï¼Œå¾ˆå¤šçœŸå®çš„åº”ç”¨éœ€è¦å¾ˆå¿«çš„å¯¹æœªè§è¿‡çš„é¡¶ç‚¹æˆ–æ˜¯å…¨æ–°çš„å›¾ï¼ˆå­å›¾ï¼‰ç”Ÿæˆ embeddingã€‚è¿™ä¸ªæ¨æ–­çš„èƒ½åŠ›å¯¹äºé«˜ååçš„æœºå™¨å­¦ä¹ ç³»ç»Ÿæ¥è¯´å¾ˆé‡è¦ï¼Œè¿™äº›ç³»ç»Ÿéƒ½è¿ä½œåœ¨ä¸æ–­æ¼”åŒ–çš„å›¾ä¸Šï¼Œè€Œä¸”æ—¶åˆ»éƒ½ä¼šé‡åˆ°æœªè§è¿‡çš„é¡¶ç‚¹ï¼ˆæ¯”å¦‚ Reddit ä¸Šçš„æ–‡ç« ï¼ŒYoutube ä¸Šçš„ç”¨æˆ·æˆ–è§†é¢‘ï¼‰ã€‚ä¸€ä¸ªç”Ÿæˆé¡¶ç‚¹ embedding çš„æ¨æ–­æ–¹æ³•ä¹Ÿä¼šå¸®åŠ©åœ¨æ‹¥æœ‰åŒæ ·å½¢å¼ç‰¹å¾çš„å›¾ä¸Šè¿›è¡Œæ³›åŒ–ï¼šä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸€ä¸ªæœ‰æœºç‰©å¾—åˆ°çš„ PPI å›¾ä¸Šè®­ç»ƒä¸€ä¸ª embedding ç”Ÿæˆå™¨ï¼Œç„¶åå¾ˆç®€å•çš„ä½¿ç”¨è¿™ä¸ªæ¨¡å‹åˆ©ç”¨æ–°çš„æœ‰æœºç‰©ä¸Šæ”¶é›†çš„æ•°æ®ç”Ÿæˆä»–ä»¬çš„é¡¶ç‚¹åµŒå…¥ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹æ¯” transductive é—®é¢˜ï¼Œæ¨æ–­é¡¶ç‚¹åµŒå…¥é—®é¢˜å¾ˆå›°éš¾ï¼Œå› ä¸ºæ³›åŒ–æœªè§è¿‡çš„é¡¶ç‚¹éœ€è¦å°†æ–°è§‚æµ‹åˆ°çš„å­å›¾â€œå¯¹é½â€åˆ°ç®—æ³•å·²ç»ä¼˜åŒ–å¥½çš„é¡¶ç‚¹åµŒå…¥ä¸Šã€‚ä¸€ä¸ªæ¨æ–­æ¨¡å‹å¿…é¡»å­¦ä¹ åˆ°å¯ä»¥è¯†åˆ«ä¸€ä¸ªé¡¶ç‚¹é‚»å±…çš„ç»“æ„æ€§è´¨ï¼Œè¿™ä¸ªæ€§è´¨æ—¢åæ˜ äº†é¡¶ç‚¹åœ¨å›¾ä¸­çš„å±€éƒ¨è§’è‰²ï¼Œä¹Ÿåæ˜ äº†å®ƒçš„å…¨å±€ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆå¤šç°å­˜çš„ç”Ÿæˆé¡¶ç‚¹åµŒå…¥çš„æ–¹æ³•æ˜¯ç»§æ‰¿äº transductiveã€‚è¿™äº›æ–¹æ³•çš„ä¸»æµæ˜¯ç›´æ¥ä½¿ç”¨çŸ©é˜µåˆ†è§£ç›®æ ‡å‡½æ•°å¯¹æ¯ä¸ªé¡¶ç‚¹çš„ embedding è¿›è¡Œä¼˜åŒ–ï¼Œå› ä¸ºä»–ä»¬åœ¨ä¸€ä¸ªå›ºå®šçš„å•ä¸ªå›¾ä¸Šçš„é¡¶ç‚¹åšé¢„æµ‹ï¼Œæ‰€ä»¥ä¸èƒ½è‡ªç„¶åœ°æ³›åŒ–åˆ°æœªè§è¿‡çš„æ•°æ®ã€‚è¿™äº›æ–¹æ³•å¯ä»¥è¢«ä¿®æ”¹ç„¶ååœ¨ inductive é—®é¢˜ä¸Šè¿è¡Œï¼Œä½†æ˜¯è¿™äº›ä¿®æ”¹å¾€å¾€è®¡ç®—å¤æ‚åº¦é«˜ï¼Œåœ¨æ–°çš„é¢„æµ‹ä¹‹å‰éœ€è¦é¢å¤–çš„æ¢¯åº¦ä¸‹é™ä¼˜åŒ–ã€‚å½“ç„¶ä¹Ÿæœ‰ä¸€äº›åœ¨å›¾ç»“æ„ä¸Šä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œçš„æ–¹æ³•ï¼Œåœ¨ embedding ä¸Šè¡¨ç°çš„å¾ˆå¥½ã€‚è¿„ä»Šä¸ºæ­¢ï¼ŒGCN åªåœ¨å›ºå®šçš„å›¾ä¸Šçš„ transductive é—®é¢˜ä¸Šåº”ç”¨è¿‡ã€‚æˆ‘ä»¬å·¥ä½œæ˜¯æ‰©å±•äº† GCN åˆ°æ— ç›‘ç£æ¨æ–­ä»»åŠ¡ä¸Šï¼ŒåŒæ—¶è¿˜æå‡ºäº†ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥è®© GCN ä½¿ç”¨å¯è®­ç»ƒçš„èšåˆå‡½æ•°ï¼ˆå¹¶ä¸æ˜¯åªæœ‰ç®€å•çš„å·ç§¯ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Present work.&lt;/strong&gt; æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªé€šç”¨çš„æ¡†æ¶ï¼Œå« GraphSAGE(SAmple and aggreGatE)ï¼Œç”¨äºå­¦ä¹  inductive node embeddingã€‚ä¸åƒåŸºäºçŸ©é˜µåˆ†è§£çš„åµŒå…¥æ–¹æ³•ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†é¡¶ç‚¹ç‰¹å¾ï¼ˆæ¯”å¦‚æ–‡æœ¬å±æ€§ï¼Œé¡¶ç‚¹ä¿¡æ¯ï¼Œé¡¶ç‚¹çš„åº¦ï¼‰æ¥å­¦ä¹ å¯ä»¥ç”Ÿæˆæœªè§è¿‡çš„é¡¶ç‚¹çš„åµŒå…¥çš„å‡½æ•°ã€‚é€šè¿‡åœ¨ç®—æ³•ä¸­ç»“åˆé¡¶ç‚¹ä¿¡æ¯ï¼Œæˆ‘ä»¬åŒæ—¶å­¦ä¹ äº†æ¯ä¸ªé¡¶ç‚¹é‚»å±…çš„æ‹“æ‰‘ç»“æ„å’Œé¡¶ç‚¹ç‰¹å¾åœ¨é‚»å±…ä¸­çš„åˆ†å¸ƒã€‚å°½ç®¡æˆ‘ä»¬çš„ç ”ç©¶æ›´ä¸“æ³¨äºå¯Œç‰¹å¾çš„å›¾ï¼ˆå¦‚æœ‰æ–‡æœ¬ä¿¡æ¯çš„å¼•æ–‡ç½‘ç»œï¼Œæœ‰åŠŸèƒ½/åˆ†å­ç»„æˆçš„ç”Ÿç‰©æ•°æ®ï¼‰ï¼Œæˆ‘ä»¬çš„æ–¹æ³•ä»èƒ½å……åˆ†åˆ©ç”¨æ‰€æœ‰å›¾å±•ç°çš„ç»“æ„ç‰¹å¾ï¼ˆæ¯”å¦‚é¡¶ç‚¹çš„åº¦ï¼‰ã€‚å› æ­¤æˆ‘ä»¬çš„ç®—æ³•å¯ä»¥åº”ç”¨åœ¨æ²¡æœ‰é¡¶ç‚¹ç‰¹å¾çš„å›¾ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/inductive-representation-learning-on-large-graphs/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ²¡æœ‰å¯¹æ¯ä¸ªé¡¶ç‚¹éƒ½è®­ç»ƒä¸€ä¸ªå•ç‹¬çš„ embedddingï¼Œæˆ‘ä»¬è®­ç»ƒäº†ä¸€ç»„ &lt;em&gt;aggregator functions&lt;/em&gt;ï¼Œè¿™äº›å‡½æ•°å­¦ä¹ å¦‚ä½•ä»ä¸€ä¸ªé¡¶ç‚¹çš„å±€éƒ¨é‚»å±…èšåˆç‰¹å¾ä¿¡æ¯ï¼ˆå›¾1ï¼‰ã€‚æ¯ä¸ªèšåˆå‡½æ•°ä»ä¸€ä¸ªé¡¶ç‚¹çš„ä¸åŒæœç´¢æ·±åº¦èšåˆä¿¡æ¯ã€‚æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ–æ˜¯è¯´æ¨æ–­çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬è®­ç»ƒçš„ç³»ç»Ÿæ¥å¯¹å®Œå…¨æœªè§è¿‡çš„é¡¶ç‚¹ï¼Œé€šè¿‡ä½¿ç”¨å­¦ä¹ åˆ°çš„èšåˆå‡½æ•°æ¥ç”Ÿæˆ embeddingã€‚è·Ÿéšç€å‰äººåœ¨ç”Ÿæˆé¡¶ç‚¹ä¸Šçš„å·¥ä½œï¼Œæˆ‘ä»¬è®¾è®¡äº†æ— ç›‘ç£çš„æŸå¤±å‡½æ•°ï¼Œä½¿å¾— GraphSAGE å¯ä»¥åœ¨æ²¡æœ‰ä»»åŠ¡ç›‘ç£çš„æƒ…å†µä¸‹è®­ç»ƒã€‚æˆ‘ä»¬ä¹Ÿå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ç›‘ç£çš„æ–¹æ³•è®­ç»ƒ GraphSAGEã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ä¸‰ä¸ªé¡¶ç‚¹åˆ†ç±»æ•°æ®é›†ä¸Šè¯„ä¼°äº†æˆ‘ä»¬çš„ç®—æ³•ï¼Œæµ‹è¯•äº† GraphSAGE åœ¨æœªè§è¿‡çš„æ•°æ®ä¸Šç”Ÿæˆæœ‰æ•ˆ embedding çš„èƒ½åŠ›ã€‚ä½¿ç”¨äº†ä¸¤ä¸ªåŸºäº citation æ•°æ®å’Œ Reddit post æ•°æ®çš„æ¼”åŒ–ç½‘ç»œï¼ˆåˆ†åˆ«é¢„æµ‹ paper å’Œ post ç±»åˆ«ï¼‰ï¼Œè¿˜æœ‰ä¸€ä¸ªåŸºäº PPI çš„å¤šå›¾æ³›åŒ–å®éªŒï¼ˆé¢„æµ‹è›‹ç™½è´¨åŠŸèƒ½ï¼‰ã€‚æˆ‘ä»¬çš„æ–¹æ³•æ•ˆæœå¾ˆå¥½ï¼Œè·¨é¢†åŸŸï¼Œç›‘ç£çš„æ–¹æ³•åœ¨ F1 å€¼ä¸Šå¯¹æ¯”åªä½¿ç”¨é¡¶ç‚¹ç‰¹å¾çš„æ–¹æ³•å¹³å‡æé«˜äº† 51%ï¼Œè€Œä¸” GraphSAGE ä¸€ç›´éƒ½æ¯” transductive baseline å¼ºå¾ˆå¤šï¼Œå°½ç®¡ baseline åœ¨æœªè§è¿‡çš„é¡¶ç‚¹ä¸Šçš„è¿è¡Œæ—¶é—´è¦é•¿ 100 å€ä»¥ä¸Šã€‚æˆ‘ä»¬æå‡ºçš„æ–°çš„èšåˆç»“æ„æ¯”å—å›¾å·ç§¯å¯å‘çš„èšåˆå‡½æ•°æ›´å¥½ï¼ˆå¹³å‡æå‡äº† 7.4%ï¼‰ã€‚æœ€åæˆ‘ä»¬é€šè¿‡å®éªŒè¯æ˜äº†æˆ‘ä»¬æ–¹æ³•çš„è¡¨è¾¾èƒ½åŠ›ï¼Œå°½ç®¡ GraphSAGE æ˜¯åŸºäºç‰¹å¾çš„ï¼Œå®ƒå´èƒ½å­¦ä¹ åˆ°ä¸€ä¸ªé¡¶ç‚¹åœ¨ä¸€ä¸ªå›¾ä¸­çš„ç»“æ„ä¿¡æ¯ï¼Œï¼ˆç¬¬ 5 éƒ¨åˆ†ï¼‰ã€‚&lt;/p&gt;
&lt;h1 id="2-related-work"&gt;2 Related work
&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;Factorization-based embedding approaches.&lt;/strong&gt; æœ€è¿‘çš„ node embedding æ–¹æ³•ä½¿ç”¨éšæœºæ¸¸èµ°çš„ç»Ÿè®¡å’ŒçŸ©é˜µåˆ†è§£çš„ç›®æ ‡å‡½æ•°ã€‚è¿™äº›æ–¹æ³•å’Œä¼ ç»Ÿçš„æ–¹æ³•å¦‚è°±èšç±»ï¼Œmulti-dimensional scalingï¼ŒPageRank å…³ç³»å¾ˆè¿‘ã€‚å› ä¸ºè¿™äº›åµŒå…¥æ–¹æ³•å¯¹æ¯ä¸ªé¡¶ç‚¹ç›´æ¥è®­ç»ƒ embeddingï¼Œæœ¬è´¨ä¸Šæ˜¯ transductiveï¼Œè€Œä¸”éœ€è¦å¤§é‡çš„é¢å¤–è®­ç»ƒï¼ˆå¦‚éšæœºæ¢¯åº¦ä¸‹é™ï¼‰ä½¿ä»–ä»¬èƒ½é¢„æµ‹æ–°çš„é¡¶ç‚¹ã€‚æ­¤å¤–ï¼Œè¿™äº›æ–¹æ³•ä¸­çš„å¤§éƒ¨åˆ†æ–¹æ³•ï¼Œç›®æ ‡å‡½æ•°å¯¹äº embedding çš„æ­£äº¤å˜æ¢æ˜¯ä¸å˜çš„ï¼Œæ„å‘³ç€åµŒå…¥ç©ºé—´ä¸èƒ½è‡ªç„¶åœ°åœ¨å›¾ä¹‹é—´æ³›åŒ–ï¼Œè€Œä¸”åœ¨å†æ¬¡è®­ç»ƒçš„æ—¶å€™ä¼š driftã€‚ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ä¾‹å¤–æ˜¯ Yang et al. çš„ Planetoid-I ç®—æ³•ï¼Œæ˜¯ä¸€ä¸ª inductive çš„æ–¹æ³•ï¼ŒåŸºäºåµŒå…¥çš„åŠç›‘ç£å­¦ä¹ ã€‚ç„¶è€Œï¼ŒPlanetoid-I åœ¨æ¨æ–­çš„æ—¶å€™ä¸ä½¿ç”¨ä»»ä½•å›¾ç»“æ„ä¿¡æ¯ï¼Œè€Œåœ¨è®­ç»ƒçš„æ—¶å€™å°†å›¾ç»“æ„ä½œä¸ºä¸€ç§æ­£åˆ™åŒ–çš„å½¢å¼ã€‚ä¸åŒäºå‰é¢æåˆ°çš„è¿™äº›æ–¹æ³•ï¼Œæˆ‘ä»¬æ˜¯åˆ©ç”¨ç‰¹å¾ä¿¡æ¯è®­ç»ƒå¯ä»¥å¯¹æœªè§è¿‡çš„é¡¶ç‚¹ç”Ÿæˆ embedding çš„æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Supervised learning over graphs.&lt;/strong&gt; é™¤äº†é¡¶ç‚¹åµŒå…¥æ–¹æ³•ï¼Œè¿˜æœ‰å¾ˆå¤šåœ¨å›¾ç»“æ„æ•°æ®ä¸Šçš„ç›‘ç£å­¦ä¹ æ–¹æ³•ã€‚åŒ…æ‹¬å¾ˆå¤šæ ¸æ–¹æ³•ï¼Œå›¾çš„ç‰¹å¾å‘é‡ä»å¤šä¸ªå›¾çš„æ ¸å¾—åˆ°ã€‚æœ€è¿‘æœ‰å¾ˆå¤šç”¨äºå›¾ç»“æ„çš„ç›‘ç£å­¦ä¹ çš„ç¥ç»ç½‘ç»œæ–¹æ³•ã€‚æˆ‘ä»¬çš„æ–¹æ³•ä»æ¦‚å¿µä¸Šæ˜¯å—åˆ°äº†è¿™äº›æ–¹æ³•çš„å¯å‘ã€‚ç„¶è€Œï¼Œè¿™äº›æ–¹æ³•è¯•å›¾å¯¹æ•´ä¸ªå›¾ï¼ˆæˆ–å­å›¾ï¼‰è¿›è¡Œåˆ†ç±»ï¼Œæˆ‘ä»¬çš„å·¥ä½œå…³æ³¨çš„æ˜¯å¦‚ä½•å¯¹å•ä¸ªé¡¶ç‚¹ç”Ÿæˆæœ‰æ•ˆçš„è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Graph convolutional networks.&lt;/strong&gt; è¿‘äº›å¹´ï¼Œä¸€äº›ç”¨äºå›¾çš„å·ç§¯ç¥ç»ç½‘ç»œè¢«ç›¸ç»§æå‡ºã€‚è¿™äº›æ–¹æ³•ä¸­çš„å¤§éƒ¨åˆ†ä¸èƒ½æ‰©å±•åˆ°å¤§çš„å›¾ä¸Šï¼Œæˆ–è€…æ˜¯ä¸ºäº†æ•´ä¸ªå›¾çš„åˆ†ç±»è€Œè®¾è®¡ï¼ˆæˆ–æ˜¯ä¸¤ç‚¹éƒ½æœ‰ï¼‰ã€‚æˆ‘ä»¬çš„æ–¹æ³•ä¸ Kipf et al. æå‡ºçš„å›¾å·ç§¯å¾ˆç›¸å…³ï¼ŒGCN åœ¨è®­ç»ƒçš„æ—¶å€™éœ€è¦æ•´ä¸ªå›¾çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µã€‚æˆ‘ä»¬ç®—æ³•çš„ä¸€ä¸ªç®€å•çš„å˜ä½“å¯ä»¥çœ‹ä½œæ˜¯ GCN æ¡†æ¶åœ¨ inductive setting ä¸Šçš„æ‰©å±•ï¼Œæˆ‘ä»¬ä¼šåœ¨ 3.3 è¯´æ˜ã€‚&lt;/p&gt;
&lt;h1 id="3-graphsage"&gt;3 GraphSAGE
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬çš„æ ¸å¿ƒæ€æƒ³åœ¨äºå¦‚ä½•ä»ä¸€ä¸ªé¡¶ç‚¹çš„å±€éƒ¨é‚»å±…èšåˆç‰¹å¾ä¿¡æ¯ï¼ˆæ¯”å¦‚åº¦æˆ–è¿‘é‚»é¡¶ç‚¹çš„æ–‡æœ¬ç‰¹å¾ï¼‰ã€‚3.1 æè¿° embedding çš„ç”Ÿæˆç®—æ³•ã€‚3.2 æè¿°éšæœºæ¢¯åº¦ä¸‹é™å­¦ä¹ å‚æ•°ã€‚&lt;/p&gt;
&lt;h2 id="31-embedding-generation-ie-forward-propagation-algorithm"&gt;3.1 Embedding generation (i.e., forward propagation) algorithm
&lt;/h2&gt;&lt;p&gt;å‡è®¾å·²ç»å­¦ä¹ åˆ°äº† $K$ ä¸ªèšåˆå‡½æ•°ï¼ˆè¡¨ç¤ºä¸º $AGGERGATE_k, \forall k \in \lbrace 1,&amp;hellip;,K\rbrace$ ï¼‰çš„å‚æ•°ï¼Œå¯¹é¡¶ç‚¹çš„ä¿¡æ¯èšåˆï¼Œè¿˜æœ‰ä¸€ç»„æƒé‡çŸ©é˜µ $\mathbf{W}^k, \forall k \in \lbrace 1,&amp;hellip;,K\rbrace$ï¼Œç”¨æ¥åœ¨æ¨¡å‹çš„ä¸åŒå±‚æˆ–æœç´¢æ·±åº¦é—´ä¼ æ’­ä¿¡æ¯ã€‚ä¸‹ä¸€èŠ‚æè¿°å‚æ•°æ˜¯æ€ä¹ˆè®­ç»ƒçš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/inductive-representation-learning-on-large-graphs/Alg1.JPG"
loading="lazy"
alt="Algo1"
&gt;&lt;/p&gt;
&lt;p&gt;ç®—æ³• 1 çš„æ€è·¯æ˜¯åœ¨æ¯æ¬¡è¿­ä»£ï¼Œæˆ–æ¯ä¸€ä¸ªæœç´¢æ·±åº¦ï¼Œé¡¶ç‚¹ä»ä»–ä»¬çš„å±€éƒ¨é‚»å±…èšåˆä¿¡æ¯ï¼Œè€Œä¸”éšç€è¿™ä¸ªè¿‡ç¨‹çš„è¿­ä»£ï¼Œé¡¶ç‚¹ä¼šä»è¶Šæ¥è¶Šè¿œçš„åœ°æ–¹è·å¾—ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ç®—æ³• 1 æè¿°äº†åœ¨å„æ•´ä¸ªå›¾ä¸Šç”Ÿæˆ embedding çš„è¿‡ç¨‹ï¼Œ$\mathcal{G} = \left( \mathcal{V}, \Large{\varepsilon} \right)$ï¼Œä»¥åŠæ‰€æœ‰é¡¶ç‚¹çš„ç‰¹å¾$X_v, \forall v \in \mathcal{V}$ä½œä¸ºè¾“å…¥ã€‚åœ¨ç®—æ³• 1 æœ€å¤–å±‚å¾ªç¯çš„æ¯ä¸€æ­¥å¦‚ä¸‹ï¼Œ$k$ è¡¨ç¤ºå¤–å¾ªç¯ï¼ˆæˆ–æœç´¢æ·±åº¦ï¼‰çš„å½“å‰æ­¥ï¼Œ$\mathbf{h}^k$ è¡¨ç¤ºå½“å‰è¿™æ­¥çš„ä¸€ä¸ªé¡¶ç‚¹çš„è¡¨ç¤ºï¼šé¦–å…ˆï¼Œæ¯ä¸ªé¡¶ç‚¹ $v \in \mathcal{V}$èšåˆäº†åœ¨å®ƒåœ¨ä¸­é—´é‚»å±…çš„è¡¨ç¤ºï¼Œ$\lbrace \mathbf{h}^{k-1}_u, \forall u \in \mathcal{N}(u) \rbrace$ï¼Œèšåˆåˆ°å‘é‡$\mathbf{h}^{k-1}_{\mathcal{N}(v)}$ä¸­ã€‚æ³¨æ„ï¼Œè¿™ä¸ªèšåˆæ­¥éª¤ä¾èµ–äºå¤–å¾ªç¯å‰ä¸€æ¬¡è¿­ä»£ç”Ÿæˆçš„è¡¨ç¤ºï¼ˆæ¯”å¦‚$k - 1$ï¼‰ï¼Œ$k = 0$è¡¨ç¤ºè¾“å…¥çš„é¡¶ç‚¹ç‰¹å¾ã€‚èšåˆé‚»å±…ç‰¹å¾å‘é‡åï¼ŒGraphSAGEä¹‹åæ‹¼æ¥äº†é¡¶ç‚¹å½“å‰çš„è¡¨ç¤ºï¼Œ$\mathbf{h}^{k-1}_v$ï¼Œæ ¸èšåˆçš„é‚»å±…å‘é‡ä¸€èµ·ï¼Œ$\mathbf{h}^{k-1}_{\mathcal{N}(v)}$ï¼Œæ‹¼æ¥åçš„å‘é‡è¾“å…¥åˆ°äº†æ¿€æ´»å‡½æ•°ä¸º$\sigma$çš„å…¨è¿æ¥å±‚ä¸­ï¼Œå°†è¡¨ç¤ºå˜æ¢ä¸ºä¸‹ä¸€æ­¥ä½¿ç”¨çš„å½¢å¼ï¼ˆ$\mathbf{h}^k_v, \forall v \in \mathcal{V}$ï¼‰ã€‚ä¸ºäº†è®°å·çš„ç®€å•ï¼Œæˆ‘ä»¬å°†æ·±åº¦ä¸º$K$çš„è¾“å‡ºè¡¨ç¤ºè®°ä¸º$\mathbf{z} \equiv \mathbf{h}^K_v, \forall v \in \mathcal{V}$ã€‚é‚»å±…è¡¨ç¤ºçš„èšåˆå¯ä»¥é€šè¿‡å¤šä¸ªèšåˆæ¶æ„å¾—åˆ°ï¼ˆåœ¨ç®—æ³•1ä¸­è¡¨ç¤ºä¸º$\mathrm{AGGERGATE}$ï¼‰ï¼Œæˆ‘ä»¬ä¼šåœ¨3.3è®¨è®ºä¸åŒçš„æ¶æ„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å°†ç®—æ³•1æ‰©å±•åˆ°minibatchè®¾å®šä¸Šï¼Œç»™å®šä¸€ç»„è¾“å…¥é¡¶ç‚¹ï¼Œæˆ‘ä»¬å…ˆé‡‡æ ·é‡‡å‡ºéœ€è¦çš„é‚»å±…é›†åˆï¼ˆåˆ°æ·±åº¦$K$ï¼‰ï¼Œç„¶åè¿è¡Œå†…éƒ¨å¾ªç¯ï¼ˆç®—æ³•1çš„ç¬¬ä¸‰è¡Œï¼‰ï¼Œä½†ä¸æ˜¯è¿­ä»£æ‰€æœ‰çš„é¡¶ç‚¹ï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªæ·±åº¦åªè®¡ç®—å¿…é¡»æ»¡è¶³çš„è¡¨ç¤ºï¼ˆåè®°AåŒ…æ‹¬äº†å®Œæ•´çš„minibatchä¼ªä»£ç ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id="32-learning-the-parameters-of-graphsage"&gt;3.2 Learning the parameters of GraphSAGE
&lt;/h2&gt;&lt;p&gt;ä¸ºäº†åœ¨åŠç›‘ç£è®¾å®šä¸‹å­¦ä¹ ä¸€ä¸ªæœ‰æ•ˆçš„è¡¨ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨åŸºäºå›¾çš„æŸå¤±å‡½æ•°æ¥è¾“å‡ºè¡¨ç¤º$\mathbf{z}_u, \forall u \in \mathcal{V}$ï¼Œè°ƒæ•´æƒé‡çŸ©é˜µ$\mathbf{W}^k, \forall k \in \lbrace 1,&amp;hellip;,K\rbrace$ï¼Œèšåˆå‡½æ•°çš„å‚æ•°é€šè¿‡éšæœºæ¢¯åº¦ä¸‹é™è®­ç»ƒã€‚åŸºäºå›¾çš„æŸå¤±å‡½æ•°å€¾å‘äºä½¿å¾—ç›¸é‚»çš„é¡¶ç‚¹æœ‰ç›¸ä¼¼çš„è¡¨ç¤ºï¼Œå°½ç®¡è¿™ä¼šä½¿ç›¸äº’è¿œç¦»çš„é¡¶ç‚¹çš„è¡¨ç¤ºå¾ˆä¸ä¸€æ ·ï¼š
&lt;/p&gt;
$$\tag{1}
J\mathcal{G}(\mathbf{z}\_u) = -\log(\sigma(\mathbf{z}^T\_u \mathbf{z}\_v)) - Q \cdot \mathbb{E}\_{v\_n \sim P\_n(v)} \log(\sigma(-\mathbf{z}^T\_u \mathbf{z}\_{v\_n})),
$$&lt;p&gt;
å…¶ä¸­$v$æ˜¯é€šè¿‡å®šé•¿éšæœºæ¸¸èµ°å¾—åˆ°çš„$u$æ—è¾¹çš„å…±ç°é¡¶ç‚¹ï¼Œ$\sigma$æ˜¯sigmoidå‡½æ•°ï¼Œ$P_n$æ˜¯è´Ÿé‡‡æ ·åˆ†å¸ƒï¼Œ$Q$å®šä¹‰äº†è´Ÿæ ·æœ¬çš„æ•°ç›®ã€‚é‡è¦çš„æ˜¯ï¼Œä¸åƒä¹‹å‰çš„é‚£äº›æ–¹æ³•ï¼Œæˆ‘è¾“å…¥åˆ°æŸå¤±å‡½æ•°çš„è¡¨ç¤º$\mathbf{z}_u$æ˜¯ä»åŒ…å«ä¸€ä¸ªé¡¶ç‚¹å±€éƒ¨é‚»å±…çš„ç‰¹å¾ç”Ÿæˆå‡ºæ¥çš„ï¼Œè€Œä¸æ˜¯å¯¹æ¯ä¸ªé¡¶ç‚¹è®­ç»ƒä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„embeddingï¼ˆé€šè¿‡ä¸€ä¸ªembeddingæŸ¥è¯¢è¡¨ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ— ç›‘ç£è®¾å®šæ¨¡æ‹Ÿäº†é¡¶ç‚¹ç‰¹å¾æä¾›ç»™åç»­æœºå™¨å­¦ä¹ åº”ç”¨çš„æƒ…å†µã€‚åœ¨é‚£äº›è¡¨ç¤ºåªåœ¨åç»­çš„ä»»åŠ¡ä¸­ä½¿ç”¨çš„æƒ…å†µä¸‹ï¼Œæ— ç›‘ç£æŸå¤±ï¼ˆå¼1ï¼‰å¯ä»¥è¢«æ›¿æ¢æˆ–æ”¹è‰¯ï¼Œé€šè¿‡ä¸€ä¸ªä»¥ä»»åŠ¡ä¸ºå¯¼å‘çš„ç›®æ ‡å‡½æ•°ï¼ˆæ¯”å¦‚cross-entropyï¼‰ã€‚&lt;/p&gt;
&lt;h2 id="33-èšåˆæ¶æ„"&gt;3.3 èšåˆæ¶æ„
&lt;/h2&gt;&lt;p&gt;ä¸åƒåœ¨$N$ç»´ç½‘æ ¼ï¼ˆå¦‚å¥å­ã€å›¾åƒã€$3\rm{D}$ï¼‰ä¸Šçš„æœºå™¨å­¦ä¹ ï¼Œä¸€ä¸ªé¡¶ç‚¹çš„é‚»å±…æ˜¯æ— åºçš„ï¼›å› æ­¤ï¼Œç®—æ³•1ä¸­çš„èšåˆå‡½æ•°å¿…é¡»åœ¨ä»¥ä¸€ä¸ªæ— åºçš„å‘é‡ä¸Šè¿è¡Œã€‚ç†æƒ³ä¸Šæ¥è¯´ï¼Œä¸€ä¸ªèšåˆå‡½æ•°éœ€è¦æ˜¯å¯¹ç§°çš„ï¼ˆä¹Ÿå°±æ˜¯å¯¹å®ƒè¾“å…¥çš„å…¨æ’åˆ—æ¥è¯´æ˜¯ä¸å˜çš„ï¼‰ï¼Œè€Œä¸”è¿˜è¦å¯è®­ç»ƒï¼Œä¸”ä¿æŒè¡¨ç¤ºçš„èƒ½åŠ›ã€‚èšåˆå‡½æ•°çš„å¯¹ç§°æ€§ä¹‹ç¡®ä¿äº†æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œæ¨¡å‹å¯ä»¥è¢«è®­ç»ƒä¸”å¯ä»¥åº”ç”¨äºä»»æ„é¡ºåºçš„é¡¶ç‚¹é‚»å±…ç‰¹å¾é›†åˆä¸Šã€‚æˆ‘ä»¬æ£€éªŒäº†ä¸‰ç§èšåˆå‡½æ•°ï¼š
&lt;strong&gt;Mean aggregator.&lt;/strong&gt; ç¬¬ä¸€ä¸ªèšåˆå‡½æ•°æ˜¯å‡å€¼èšåˆï¼Œæˆ‘ä»¬ç®€å•çš„å–$\lbrace \mathbf{h}^{k-1}_u, \forall v \in \mathcal{N}(v) \rbrace$ä¸­çš„å‘é‡çš„element-wiseå‡å€¼ã€‚å‡å€¼èšåˆè¿‘ä¼¼ç­‰ä»·åœ¨transducttive GCNæ¡†æ¶[17]ä¸­çš„å·ç§¯ä¼ æ’­è§„åˆ™ã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ›¿æ¢ç®—æ³•1ä¸­çš„4è¡Œå’Œ5è¡Œä¸ºä»¥ä¸‹å†…å®¹å¾—åˆ°GCNçš„inductiveå˜å½¢ï¼š
&lt;/p&gt;
$$\tag{2}
\mathbf{h}^k\_v \leftarrow \sigma(\mathbf{W} \cdot \mathrm{MEAN}(\lbrace \mathbf{h}^{k-1}\_v \rbrace \cup \lbrace \mathbf{h}^{k-1}\_u, \forall u \in \mathcal{N}(v) \rbrace)).
$$&lt;p&gt;
æˆ‘ä»¬ç§°è¿™ä¸ªä¿®æ”¹åçš„åŸºäºå‡å€¼çš„èšåˆå™¨æ˜¯&lt;em&gt;convolutional&lt;/em&gt;ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªç²—ç•¥çš„ï¼Œå±€éƒ¨åŒ–è°±å·ç§¯çš„çš„çº¿æ€§è¿‘ä¼¼[17]ã€‚è¿™ä¸ªå·ç§¯èšåˆå™¨å’Œæˆ‘ä»¬çš„å…¶ä»–èšåˆå™¨çš„é‡è¦ä¸åŒåœ¨äºå®ƒæ²¡æœ‰ç®—æ³•1ä¸­ç¬¬5è¡Œçš„æ‹¼æ¥æ“ä½œâ€”â€”å·ç§¯èšåˆå™¨æ²¡æœ‰å°†é¡¶ç‚¹å‰ä¸€å±‚çš„è¡¨ç¤º$\mathbf{h}^{k-1}_v$å’Œèšåˆçš„é‚»å±…å‘é‡$\mathbf{h}^k_{\mathcal{N}(v)}$æ‹¼æ¥èµ·æ¥ã€‚æ‹¼æ¥æ“ä½œå¯ä»¥çœ‹ä½œä¸€ä¸ªæ˜¯åœ¨ä¸åŒçš„æœç´¢æ·±åº¦æˆ–å±‚ä¹‹é—´çš„ç®€å•çš„skip connectionçš„å½¢å¼ï¼Œå®ƒä½¿å¾—æ¨¡å‹è·å¾—äº†å·¨å¤§çš„æå‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;LSTM aggregator.&lt;/strong&gt; æˆ‘ä»¬ä¹Ÿæ£€éªŒäº†ä¸€ä¸ªåŸºäºLSTMçš„å¤æ‚çš„èšåˆå™¨ã€‚å¯¹æ¯”å‡å€¼èšåˆå™¨ï¼ŒLSTMæœ‰æ›´å¼ºçš„è¡¨è¾¾èƒ½åŠ›ã€‚ç„¶è€Œï¼ŒLSTMä¸æ˜¯å¯¹ç§°çš„è¿™ä¸ªéœ€è¦æ³¨æ„ï¼Œå› ä¸ºä»–ä»¬å¤„ç†ä»–ä»¬çš„è¾“å…¥æ˜¯ä»¥ä¸€ä¸ªåºåˆ—çš„æ–¹å¼ã€‚æˆ‘ä»¬ç®€å•åœ°å°†LSTMåº”ç”¨åœ¨ä¸€ä¸ªé¡¶ç‚¹é‚»å±…çš„éšæœºåºåˆ—ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pooling aggregator.&lt;/strong&gt; æˆ‘ä»¬æ£€éªŒçš„æœ€åä¸€ä¸ªèšåˆå™¨æ—¢æ˜¯å¯¹ç§°çš„ï¼Œåˆæ˜¯å¯è®­ç»ƒçš„ã€‚åœ¨è¿™ä¸ª&lt;em&gt;æ± åŒ–&lt;/em&gt;æ–¹æ³•ç§ï¼Œæ¯ä¸ªé‚»å±…çš„å‘é‡éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹è¾“å…¥åˆ°å…¨è¿æ¥ç¥ç»ç½‘ç»œä¸­çš„ï¼›éšç€è¿™ç§å˜åŒ–ï¼Œä¸€ä¸ªelement-wiseæœ€å¤§æ± åŒ–æ“ä½œåº”ç”¨åœ¨é‚»å±…é›†åˆä¸Šæ¥èšåˆä¿¡æ¯ï¼š
&lt;/p&gt;
$$\tag{3}
\mathrm{AGGREGATE}^{pool}\_k = \mathrm{max}(\lbrace \sigma (\mathbf{W}\_{pool} \mathbf{h}^k\_{u\_i} + \mathbf{b}), \forall u\_i \in \mathcal{N}(v) \rbrace),
$$&lt;p&gt;
å…¶ä¸­ï¼Œ$\mathrm{max}$è¡¨ç¤ºelement-wiseæœ€å¤§å€¼æ“ä½œï¼Œ$\sigma$æ˜¯éçº¿æ€§æ¿€æ´»å‡½æ•°ã€‚åŸåˆ™ä¸Šï¼Œåœ¨æœ€å¤§æ± åŒ–ä½¿ç”¨ä¹‹å‰ï¼Œå‡½æ•°å¯ä»¥æ˜¯ä»»æ„çš„æ·±åº¦å¤šå±‚æ„ŸçŸ¥æœºï¼Œä½†æ˜¯æˆ‘ä»¬å…³æ³¨çš„æ˜¯å•ä¸ªçš„å•å±‚ç»“æ„ã€‚æ–¹æ³•æ˜¯æœåˆ°äº†æœ€è¿‘çš„ç¥ç»ç½‘ç»œæ¶æ„åœ¨å­¦ä¹ general point setsä¸Šçš„å¯å‘[29]ã€‚ç›´è§‰ä¸Šæ¥è¯´ï¼Œå¤šå±‚æ„ŸçŸ¥æœºå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç»„å‡½æ•°ï¼Œè¿™ç»„å‡½æ•°ä¸ºé‚»å±…é›†åˆä¸­çš„æ¯ä¸ªé¡¶ç‚¹è®¡ç®—è¡¨ç¤ºã€‚é€šè¿‡å¯¹æ¯ä¸ªè®¡ç®—å¾—åˆ°çš„ç‰¹å¾ä½¿ç”¨æœ€å¤§æ± åŒ–æ“ä½œï¼Œæ¨¡å‹æœ‰æ•ˆåœ°æ•è·äº†é‚»å±…é›†åˆçš„ä¸åŒæ–¹é¢ã€‚æ³¨æ„ï¼ŒåŸåˆ™ä¸Šï¼Œä»»ä½•å¯¹ç§°çš„å‘é‡å‡½æ•°éƒ½å¯ä»¥æ›¿æ¢$\mathrm{max}$æ“ä½œå™¨ï¼ˆæ¯”å¦‚element-wise meanï¼‰ã€‚æˆ‘ä»¬å‘ç°æœ€å¤§æ± åŒ–å’Œå‡å€¼æ± åŒ–åœ¨æµ‹è¯•æ—¶æ²¡æœ‰å¤ªå¤§çš„å·®åˆ«ï¼Œæ‰€ä»¥ä½¿ç”¨äº†æœ€å¤§æ± åŒ–å®Œæˆäº†åç»­çš„å®éªŒã€‚&lt;/p&gt;
&lt;h1 id="4-å®éªŒ"&gt;4 å®éªŒ
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬åœ¨ä¸‰ä¸ªbenchmarkä¸Šæµ‹è¯•äº†GraphSAGEï¼š1. ä½¿ç”¨Web of Science citation datasetå¯¹ä¸åŒçš„å­¦æœ¯æ–‡ç« è¿›è¡Œä¸»é¢˜åˆ†ç±»ã€‚2. å¯¹å±äºä¸åŒç¤¾åŒºçš„Reddit postsè¿›è¡Œåˆ†ç±»ï¼Œ3. å¯¹å¤šä¸ªPPIå›¾è¿›è¡Œè›‹ç™½è´¨åŠŸèƒ½åˆ†ç±»ã€‚åœ¨æ‰€æœ‰çš„å®éªŒä¸­ï¼Œæˆ‘ä»¬åœ¨è®­ç»ƒæ—¶æ²¡æœ‰è§è¿‡çš„é¡¶ç‚¹ä¸Šåšé¢„æµ‹ï¼Œå¯¹PPIä¸Šå¯¹å®Œå…¨æœªè§è¿‡çš„å›¾åšé¢„æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Experimental set-up.&lt;/strong&gt; ä¸ºäº†åœ¨inductive benchmarkä¸Šé¢å°†ç»éªŒç»“æœç½®äºä¸Šä¸‹æ–‡ä¸­è€ƒè™‘ï¼Œæˆ‘ä»¬å¯¹æ¯”äº†å››ä¸ªbaselineï¼šéšå³åˆ†ç±»å™¨ï¼ŒåŸºäºç‰¹å¾çš„é€»è¾‘å›å½’ï¼Œraw featureså’ŒDeepWalk embeddingæ‹¼æ¥çš„embeddingã€‚æˆ‘ä»¬ä¹Ÿæ¯”è¾ƒäº†GraphSAGEçš„å››ä¸ªå˜ä½“ï¼Œåˆ†åˆ«ä½¿ç”¨ä¸åŒçš„èšåˆå‡½æ•°ï¼ˆ3.3éƒ¨åˆ†ï¼‰ã€‚å› ä¸ºï¼ŒGraphSAGEçš„å·ç§¯å˜ä½“æ˜¯ä¸€ç§æ‰©å±•å½¢å¼ï¼Œæ˜¯Kipf et al. åŠç›‘ç£GCNçš„inductive versionï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªå˜ä½“ä¸ºGraphSAGE-GCNã€‚æˆ‘ä»¬æµ‹è¯•äº†æ ¹æ®å¼1çš„æŸå¤±å‡½æ•°è®­ç»ƒçš„GraphSAGEå˜ä½“ï¼Œè¿˜æœ‰åœ¨cross-entropyä¸Šè®­ç»ƒçš„ç›‘ç£å˜ä½“ã€‚å¯¹äºæ‰€æœ‰çš„GraphSAGEå˜ä½“æˆ‘ä»¬ä½¿ç”¨ReLUä½œä¸ºæ¿€æ´»ï¼Œ$K = 2$ï¼Œé‚»å±…é‡‡æ ·å¤§å°$S_1 = 25$ï¼Œ$S_2 = 10$ï¼ˆè¯¦æƒ…è§4.4èŠ‚ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºRedditå’Œcitationæ•°æ®é›†ï¼Œæˆ‘ä»¬ä½¿ç”¨&amp;quot;online&amp;quot;æ¥è®­ç»ƒDeepWalkï¼Œå¦‚Perozzi et al. æåˆ°çš„é‚£æ ·ï¼Œæˆ‘ä»¬åœ¨åšé¢„æµ‹å‰ï¼Œè·‘ä¸€è½®æ–°çš„SGDæ¥åµŒå…¥æ–°çš„æµ‹è¯•é¡¶ç‚¹ï¼ˆè¯¦æƒ…è§åè®°ï¼‰ã€‚åœ¨å¤šå›¾è®¾å®šä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨DeepWalkï¼Œå› ä¸ºé€šè¿‡DeepWalkåœ¨ä¸åŒä¸ç›¸äº¤çš„å›¾ä¸Šè¿è¡Œåç”Ÿæˆçš„åµŒå…¥ç©ºé—´å¯¹å…¶ä»–æ¥è¯´å¯ä»¥æ˜¯arbitrarily rotatedï¼ˆåè®°Dï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰çš„æ¨¡å‹éƒ½æ˜¯ç”¨tfå®ç°çš„ï¼Œç”¨Adamä¼˜åŒ–ï¼ˆé™¤äº†DeepWalkï¼Œä½¿ç”¨æ¢¯åº¦ä¸‹é™æ•ˆæœæ›´å¥½ï¼‰ã€‚æˆ‘ä»¬è®¾è®¡çš„å®éªŒç›®æ ‡æ˜¯1. éªŒè¯GraphSAGEæ¯”å…¶ä»–æ–¹æ³•å¥½ã€‚ 2. ä¸¥æ ¼å¯¹æ¯”é›†ä¸­èšåˆæ¶æ„ï¼Œä¸ºäº†ä¸¥æ ¼å¯¹æ¯”ï¼Œæ‰€æœ‰çš„æ–¹æ³•ä½¿ç”¨ç›¸åŒçš„å®ç°ï¼Œå¦‚minibatchè¿­ä»£å™¨ï¼ŒæŸå¤±å‡½æ•°å’Œé‚»å±…é‡‡æ ·ï¼ˆå¦‚æœå¯ä»¥çš„è¯ï¼‰ã€‚æ­¤å¤–ï¼Œä¸ºäº†é˜²æ­¢å¯¹æ¯”èšåˆå™¨æ—¶éæœ‰æ„çš„&amp;quot;hyperparameter hacking&amp;quot;ï¼Œæˆ‘ä»¬æ£€æŸ¥äº†æ‰€æœ‰GraphSAGEå˜ä½“çš„è¶…å‚æ•°é›†åˆï¼ˆä¸ºæ¯ä¸ªå˜ä½“æ ¹æ®ä»–ä»¬åœ¨éªŒè¯é›†ä¸Šçš„è¡¨ç°é€‰æ‹©æœ€å¥½çš„è®¾å®šï¼‰ã€‚å¯èƒ½çš„è¶…å‚æ•°é›†åˆåœ¨æ—©æœŸçš„éªŒè¯é›†ä¸Šå†³å®šï¼Œè¿™ä¸ªéªŒè¯é›†æ˜¯citationå’ŒRedditçš„å­é›†ï¼Œåç»­å°±ä¸¢æ‰äº†ã€‚åè®°åŒ…å«äº†å®ç°çš„ç»†èŠ‚ã€‚&lt;/p&gt;</description></item><item><title>Diffusion-Convolutional Neural Networks</title><link>https://davidham3.github.io/blog/p/diffusion-convolutional-neural-networks/</link><pubDate>Thu, 19 Jul 2018 11:17:40 +0000</pubDate><guid>https://davidham3.github.io/blog/p/diffusion-convolutional-neural-networks/</guid><description>&lt;p&gt;NIPS 2016ã€‚DCNNsï¼Œå†™çš„äº‘é‡Œé›¾é‡Œçš„ï¼Œä¸æ˜¯å¾ˆæ‡‚åœ¨å¹²ä»€ä¹ˆã€‚ã€‚ã€‚å°±çŸ¥é“æ˜¯èå…¥äº†è½¬ç§»æ¦‚ç‡çŸ©é˜µï¼Œå’Œé¡¶ç‚¹çš„ç‰¹å¾çŸ©é˜µç›¸ä¹˜ï¼Œç®—å‡ºæ¯ä¸ªé¡¶ç‚¹åˆ°å…¶ä»–æ‰€æœ‰é¡¶ç‚¹çš„ $j$ æ­¥è½¬ç§»çš„ç‰¹å¾ä¸è½¬ç§»æ¦‚ç‡çš„ä¹˜ç§¯ï¼Œæˆä¸ºæ–°çš„é¡¶ç‚¹è¡¨ç¤ºï¼Œç§°ä¸ºdiffusion-convolutional representationï¼Œç„¶åä¹˜ä»¥ä¸€ä¸ªå·ç§¯æ ¸ï¼Œå¥—ä¸€ä¸ªæ¿€æ´»ï¼Œå·ç§¯å°±å®šä¹‰å¥½äº†ã€‚åº”ç”¨è¿˜æ˜¯åœ¨é¡¶ç‚¹åˆ†ç±»ä¸å›¾åˆ†ç±»ä¸Šã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1511.02136" target="_blank" rel="noopener"
&gt;Diffusion-Convolutional Neural Networks&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h1 id="æ‘˜è¦"&gt;æ‘˜è¦
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬æå‡ºäº†diffusion-convolutional neural networks(DCNNs)ï¼Œæ˜¯å›¾ç»“æ„æ•°æ®ä¸Šçš„æ–°æ¨¡å‹ã€‚å¼•å…¥diffusion-convolutionæ“ä½œï¼Œå¯ä»¥ä»å›¾ç»“æ„æ•°æ®ä¸­å¾—åˆ°åŸºäºæ‰©æ•£æ€§è´¨çš„è¡¨ç¤ºï¼Œç”¨äºé¡¶ç‚¹åˆ†ç±»ã€‚DCNNè¿˜æœ‰å‡ ä¸ªæ€§è´¨ï¼Œå…³äºä¸€ä¸ªå›¾æ•°æ®çš„éšå«è¡¨ç¤ºï¼Œè¿˜æœ‰å¤šé¡¹å¼æ—¶é—´å¤æ‚åº¦çš„é¢„æµ‹ä»¥åŠé«˜æ•ˆçš„GPUå®ç°ã€‚é€šè¿‡å¤šä¸ªçœŸå®æ•°æ®é›†çš„å®éªŒï¼ŒDCNNè¡¨ç°å‡ºäº†åœ¨å…³ç³»é¡¶ç‚¹åˆ†ç±»ä»»åŠ¡ä¸Šè¶…è¶Šæ¦‚ç‡å…³ç³»æ¨¡å‹ä»¥åŠkernel-on-graphçš„ç»“æœã€‚&lt;/p&gt;
&lt;h1 id="1-å¼•è¨€"&gt;1 å¼•è¨€
&lt;/h1&gt;&lt;p&gt;å¤„ç†ç»“æ„åŒ–æ•°æ®å¾ˆéš¾ã€‚ä¸€æ–¹é¢æ˜¯æ‰¾åˆ°æ­£ç¡®çš„æ–¹å¼è¡¨ç¤ºå¹¶æŒ–æ˜æ•°æ®çš„ç»“æ„å¯ä»¥æå‡é¢„æµ‹çš„æ€§èƒ½ï¼›å¦ä¸€æ–¹é¢ï¼Œæ‰¾åˆ°è¿™æ ·çš„è¡¨ç¤ºå¾ˆéš¾ï¼Œå¢åŠ ç»“æ„ä¿¡æ¯åˆ°æ¨¡å‹ä¸­ä¼šæ€¥å‰§åœ°å¢åŠ é¢„æµ‹å’Œå­¦ä¹ çš„å¤æ‚åº¦ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„å·¥ä½œæ˜¯ä¸ºä¸€ç±»ç»“æ„åŒ–æ•°æ®è®¾è®¡ä¸€ä¸ªçµæ´»çš„æ¨¡å‹ï¼Œè¿™ä¸ªæ¨¡å‹å¢å¼ºé¢„æµ‹èƒ½åŠ›ä¸”é¿å…å¤æ‚åº¦çš„å¢åŠ ã€‚ä¸ºäº†å®Œæˆè¿™ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬é€šè¿‡å¼•å…¥&amp;quot;diffusion-convolution&amp;quot;æ“ä½œå°†å·ç§¯ç¥ç»ç½‘ç»œæ‰©å±•åˆ°å›¾ç»“æ„æ•°æ®ä¸Šã€‚ç®€å•åœ°è¯´ï¼Œå¹¶ä¸æ˜¯åƒæ ‡å‡†å·ç§¯æ“ä½œä¸€æ ·æ‰«æä¸€ä¸ªçŸ©å½¢çš„å‚æ•°ï¼Œdiffusion-convolutionæ“ä½œé€šè¿‡æ‰©æ•£æ€§çš„è¿‡ç¨‹æ‰«æå›¾ç»“æ„è¾“å…¥ä¸­æ¯ä¸ªé¡¶ç‚¹ï¼Œæ„å»ºä¸€ä¸ªéšå«è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„å—åˆ°çš„å¯å‘æ˜¯ï¼šæ•è·äº†å›¾æ‰©æ•£æ€§çš„è¡¨ç¤ºåœ¨é¢„æµ‹ä¸Šå¯ä»¥æä¾›æ¯”å›¾æœ¬èº«æ›´å¥½çš„ç»“æœã€‚å›¾æ‰©æ•£æ€§å¯ä»¥è¡¨è¾¾æˆçŸ©é˜µçš„å¹‚åºåˆ—ï¼Œæä¾›äº†ä¸€ä¸ªç®€å•çš„æœºåˆ¶æ¥åŒ…å«å…³äºå®ä½“çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿™äº›å®ä½“å¯ä»¥åœ¨å¤šé¡¹å¼æ—¶é—´å¤æ‚åº¦å†…è®¡ç®—å‡ºæ¥ï¼Œå¹¶åœ¨GPUä¸Šå®ç°ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æå‡ºäº†diffusion-convolutionalç¥ç»ç½‘ç»œ(DCNN)ï¼Œåœ¨å›¾æ•°æ®çš„å„ç§å„æ ·çš„åˆ†ç±»ä»»åŠ¡ä¸Šæµ‹è¯•äº†æ€§èƒ½ã€‚åœ¨åˆ†ç±»ä»»åŠ¡ä¸­å¾ˆå¤šæŠ€æœ¯åŒ…å«äº†ç»“æ„çš„ä¿¡æ¯ï¼Œæ¯”å¦‚æ¦‚ç‡å…³ç³»æ¨¡å‹å’Œæ ¸æ–¹æ³•ï¼›DCNNæä¾›äº†ä¸€ä¸ªè¡¥å……çš„æ–¹æ³•ï¼Œåœ¨é¡¶ç‚¹åˆ†ç±»ä¸Šè·å¾—äº†å·¨å¤§çš„æå‡ã€‚&lt;/p&gt;
&lt;p&gt;DCNNçš„ä¼˜åŠ¿ï¼š
Â·&lt;strong&gt;ç²¾åº¦ï¼š&lt;/strong&gt; DCNNæ¯”å…¶ä»–æ–¹æ³•åœ¨é¡¶ç‚¹åˆ†ç±»ä»»åŠ¡ä¸Šç²¾åº¦æ›´é«˜ï¼Œå›¾åˆ†ç±»ä¸Šè¡¨ç°çš„ä¹Ÿä¸é”™ã€‚
Â·&lt;strong&gt;çµæ´»æ€§ï¼š&lt;/strong&gt; DCNNæä¾›äº†å›¾æ•°æ®çš„çµæ´»è¡¨ç¤ºï¼Œä½¿ç”¨ç®€å•çš„å¤„ç†å¯¹é¡¶ç‚¹ç‰¹å¾ã€è¾¹ç‰¹å¾ä»¥åŠç»“æ„ä¿¡æ¯è¿›è¡Œç¼–ç ã€‚DCNNå¯ä»¥ç”¨äºå¾ˆå¤šåˆ†ç±»ä»»åŠ¡ï¼ŒåŒ…æ‹¬é¡¶ç‚¹åˆ†ç±»ï¼Œè¾¹åˆ†ç±»ï¼Œå›¾åˆ†ç±»ã€‚
Â·&lt;strong&gt;é€Ÿåº¦ï¼š&lt;/strong&gt; DCNNçš„é¢„æµ‹å¯ä»¥è¡¨ç¤ºæˆä¸€ç³»åˆ—å¤šé¡¹å¼æ—¶é—´å¤æ‚åº¦çš„tensoræ“ä½œï¼Œæ¨¡å‹å¯ä»¥åœ¨GPUä¸Šå®ç°ã€‚&lt;/p&gt;
&lt;h1 id="2-æ¨¡å‹"&gt;2 æ¨¡å‹
&lt;/h1&gt;&lt;p&gt;é•¿åº¦ä¸º $T$ çš„ä¸€ä¸ªå›¾çš„é›†åˆ $\mathcal{G} = \lbrace G_t \mid t \in 1&amp;hellip;T \rbrace $ã€‚æ¯ä¸ªå›¾ $G_t = (V_t, E_t)$ ç”±é¡¶ç‚¹ $V_t$ å’Œè¾¹ $E_t$ ç»„æˆã€‚é¡¶ç‚¹ä¸€èµ·è¡¨ç¤ºä¸ºä¸€ä¸ª $N_t \times F$ çš„ç‰¹å¾çŸ©é˜µ $X_t$ï¼Œå…¶ä¸­ $N_t$ æ˜¯ $G_t$ çš„é¡¶ç‚¹æ•°ï¼Œè¾¹ $E_t$ é€šè¿‡ä¸€ä¸ª $N_t \times N_t$ çš„é‚»æ¥çŸ©é˜µ $A_t$ ç¼–ç ï¼Œé€šè¿‡è¿™ä¸ªæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºä¸€ä¸ªåº¦å½’ä¸€åŒ–çš„è½¬ç§»çŸ©é˜µ $P_t$ï¼Œè¿™ä¸ªçŸ©é˜µç»™å‡ºäº†ä»é¡¶ç‚¹ $i$ ä¸€æ­¥è½¬ç§»åˆ° $j$ çš„æ¦‚ç‡ã€‚å›¾ $G_t$ æ²¡æœ‰é™åˆ¶ï¼Œæœ‰å‘æ— å‘ï¼Œå¸¦æƒä¸å¸¦æƒéƒ½å¯ä»¥ã€‚å¯¹äºæˆ‘ä»¬çš„ä»»åŠ¡æ¥è¯´ï¼Œè¦ä¹ˆæ˜¯é¡¶ç‚¹ã€è¾¹æœ‰æ ‡ç­¾ $Y$ï¼Œè¦ä¹ˆæ˜¯å›¾æœ‰æ ‡ç­¾ $Y$ï¼Œä¸åŒæƒ…å†µä¸‹ $Y$ çš„ç»´åº¦ä¸åŒã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœ $T=1$ï¼Œä¹Ÿå°±æ˜¯åªæœ‰ä¸€ä¸ªå›¾ï¼Œæ ‡ç­¾æ˜¯é¡¶ç‚¹æˆ–è¾¹ï¼Œé‚£ä¹ˆé¢„æµ‹æ ‡ç­¾ $Y$ å°±è½¬æ¢ä¸ºäº†åŠç›‘ç£åˆ†ç±»é—®é¢˜äº†ï¼›å¦‚æœè¾“å…¥ä¸­æ²¡æœ‰è¾¹çš„è¡¨ç¤ºï¼Œå°±å˜æˆäº†æ ‡å‡†çš„ç›‘ç£é—®é¢˜ã€‚å¦‚æœ $T&amp;gt;1$ï¼Œæ ‡ç­¾æ˜¯æ¯ä¸ªå›¾çš„æ ‡ç­¾ï¼Œé‚£å°±æ˜¯ç›‘ç£å›¾åˆ†ç±»é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/diffusion-convolutional-neural-networks/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;DCNNæ¥å— $\mathcal{G}$ ä½œä¸ºè¾“å…¥ï¼Œè¿”å›ä¸€ä¸ª $Y$ çš„hard predictionæˆ–æ˜¯æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $\mathbb{P}(Y \mid X)$ã€‚æ¯ä¸ªå®ä½“ï¼ˆé¡¶ç‚¹ã€å›¾ã€æˆ–è¾¹ï¼‰è¢«è½¬æ¢ä¸ºæ‰©æ•£å·ç§¯è¡¨ç¤ºï¼Œç”± $F$ ä¸ªç‰¹å¾ä¸Š $H$ æ­¥æ‰©æ•£çš„ç»´åº¦ä¸º $H \times F$ çš„å®æ•°çŸ©é˜µå®šä¹‰ï¼Œæ¯ä¸ªå®ä½“æ˜¯ç”± $H \times F$ çš„å®æ•°çŸ©é˜µ $W^c$ å’Œä¸€ä¸ªéçº¿æ€§å¯å¾®åˆ†å‡½æ•° $f$ è®¡ç®—æ¿€æ´»å®šä¹‰çš„ã€‚æ‰€ä»¥å¯¹äºé¡¶ç‚¹åˆ†ç±»ä»»åŠ¡ï¼Œå›¾ $t$ çš„æ‰©æ•£å·ç§¯(diffusion-convolutional)è¡¨ç¤º $Z_t$ï¼Œæ˜¯ä¸€ä¸ª $N_t \times H \times F$ çš„tensorï¼Œå¦‚å›¾1aæ‰€ç¤ºï¼›å¯¹äºå›¾æˆ–è¾¹åˆ†ç±»ä»»åŠ¡ï¼Œ$Z_t$ æ˜¯ä¸€ä¸ª $H \times F$ æˆ– $N_t \times H \times F$ çš„çŸ©é˜µï¼Œå¦‚å›¾1bå’Œå›¾1cã€‚(åŸæ–‡é‡Œé¢å†™çš„æ˜¯ $M_t \times H \times F$ï¼Œæˆ‘è§‰å¾—æ˜¯å†™é”™äº†)&lt;/p&gt;
&lt;p&gt;æœ¯è¯­&amp;quot;diffusion-convolution&amp;quot;çš„æ„æ€æ˜¯å”¤èµ·å·ç§¯ç¥ç»ç½‘ç»œçš„ç‰¹å¾çš„ç‰¹å¾ï¼šfeature learning, parameter tying, invarianceã€‚DCNNæ ¸å¿ƒæ“ä½œæ˜¯ä»é¡¶ç‚¹å’Œä»–ä»¬çš„ç‰¹å¾æ˜ å°„åˆ°ä»é‚£ä¸ªé¡¶ç‚¹å¼€å§‹çš„æ‰©æ•£è¿‡ç¨‹çš„ç»“æœä¸Šã€‚ä¸åŒäºæ ‡å‡†çš„CNNï¼ŒDCNNå‚æ•°æ ¹æ®æœç´¢çš„æ·±åº¦è€Œä¸æ˜¯ä»–ä»¬åœ¨ç½‘æ ¼ä¸­çš„ä½ç½®è€Œç»‘å®šèµ·æ¥ã€‚æ‰©æ•£å·ç§¯è¡¨ç¤ºå¯¹äºé¡¶ç‚¹çš„indexæ˜¯ä¸å˜çš„ï¼Œè€Œä¸æ˜¯ä»–ä»¬çš„ä½ç½®ï¼›æ¢å¥è¯è¯´ï¼Œä¸¤ä¸ªåŒè´¨çš„å›¾çš„æ‰©æ•£å·ç§¯æ¿€æ´»ä¼šæ˜¯ä¸€æ ·çš„ã€‚ä¸åƒæ ‡å‡†çš„CNNï¼ŒDCNNæ²¡æœ‰æ± åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é¡¶ç‚¹åˆ†ç±»&lt;/strong&gt; $P^\ast_t$ æ˜¯ä¸€ä¸ª $N_t \times H \times N_t$ çš„tensorï¼ŒåŒ…å«äº† $P_t$ çš„å¹‚åºåˆ—ï¼Œå¯¹é¡¶ç‚¹ $i$ï¼Œ$j$ æ­¥ï¼Œå›¾ $t$ çš„ç‰¹å¾ $k$ çš„æ‰©æ•£å·ç§¯çš„æ¿€æ´»å€¼ $Z_{tijk}$ æ˜¯ï¼š
&lt;/p&gt;
$$\tag{1}
Z\_{tijk} = f(W^c\_{jk} \cdot \sum^{N\_t}\_{l=1}P^*\_{tijl}X\_{tlk})
$$&lt;p&gt;æ¿€æ´»ä½¿ç”¨çŸ©é˜µå½¢å¼å¯ä»¥å†™æˆï¼š
&lt;/p&gt;
$$\tag{2}
Z\_t = f(W^c \odot P^\ast\_t X\_t)
$$&lt;p&gt;å…¶ä¸­ $\odot$ è¡¨ç¤ºelement-wiseä¹˜æ³•ï¼›å›¾1aã€‚æ¨¡å‹åªæœ‰ $O(H \times F)$ ä¸ªå‚æ•°ï¼Œä½¿å¾—éšæ‰©æ•£å·ç§¯è¡¨ç¤ºçš„å‚æ•°æ•°é‡ä¸è¾“å…¥å¤§å°æ— å…³ã€‚&lt;/p&gt;
&lt;p&gt;æ¨¡å‹é€šè¿‡ä¸€ä¸ªè¿æ¥ $Z$ å’Œ $Y$ çš„dense layerå®Œæˆã€‚å¯¹äº $Y$ çš„hard predictionï¼Œè¡¨ç¤ºä¸º $\hat{Y}$ï¼Œå¯ä»¥é€šè¿‡æœ€å¤§çš„æ¿€æ´»å€¼å¾—åˆ°ï¼Œæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $\mathbb{P}(Y \mid X)$ å¯ä»¥é€šè¿‡ä½¿ç”¨softmaxå¾—åˆ°ï¼š
&lt;/p&gt;
$$\tag{3}
\hat{Y} = \arg\max(f(W^d \odot Z))
$$&lt;p&gt;
&lt;/p&gt;
$$\tag{4}
\mathbb{P}(Y \mid X) = \mathrm{softmax}(f(W^d \odot Z))
$$&lt;p&gt;&lt;strong&gt;å›¾åˆ†ç±»&lt;/strong&gt; DCNNå¯ä»¥é€šè¿‡åœ¨é¡¶ç‚¹ä¸Šå–å‡å€¼æ¿€æ´»æ‰©å±•æˆå›¾åˆ†ç±»
&lt;/p&gt;
$$\tag{5}
Z\_t = f(W^c \odot 1^T\_{N\_t} P^\ast\_t X\_t / N\_t)
$$&lt;p&gt;
å…¶ä¸­ $1_{N_t}$ æ˜¯ä¸€ä¸ª $N_t \times 1$ çš„å‘é‡ï¼Œå¦‚å›¾1bæ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å­¦ä¹ &lt;/strong&gt; DCNNä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™è®­ç»ƒã€‚æ¯è½®ï¼Œé¡¶ç‚¹çš„indexéšæœºçš„åˆ†åˆ°å‡ ä¸ªbatchesä¸­ã€‚æ¯ä¸ªbatchçš„erroré€šè¿‡å–taking slices of the graph definition power seriesï¼Œç„¶åæ­£å‘ã€åå‘ã€æ¢¯åº¦ä¸Šå‡æ›´æ–°æƒé‡ã€‚ä¹Ÿä½¿ç”¨äº†windowed early stoppingï¼Œå¦‚æœvalidation errorå¤§äºå‰å‡ è½®çš„å¹³å‡å€¼ï¼Œå°±stopã€‚&lt;/p&gt;</description></item><item><title>leetcode algorithms #5</title><link>https://davidham3.github.io/blog/p/leetcode-algorithms-%235/</link><pubDate>Wed, 18 Jul 2018 21:31:18 +0000</pubDate><guid>https://davidham3.github.io/blog/p/leetcode-algorithms-%235/</guid><description>&lt;p&gt;leetcode algorithms #5. Title: Longest Palindromic Substring&lt;/p&gt;
&lt;p&gt;Given a string s, find the longest palindromic substring in s. You may assume that the maximum length of s is 1000.&lt;/p&gt;
&lt;p&gt;Example 1:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Input: &amp;#34;babad&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Output: &amp;#34;bab&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Note: &amp;#34;aba&amp;#34; is also a valid answer.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Example 2:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Input: &amp;#34;cbbd&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Output: &amp;#34;bb&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;é¦–å…ˆéœ€è¦çŸ¥é“ä»€ä¹ˆæ˜¯å›æ–‡ä¸²ï¼š
å¦‚æœä¸€ä¸ªå­—ç¬¦ä¸²reverseåå’ŒåŸæ¥ä¸€æ ·ï¼Œé‚£å°±æ˜¯å›æ–‡ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;è§£æ³•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1. æšä¸¾&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;éå†æ‰€æœ‰çš„å­—ä¸²ï¼Œå¯¹æ¯ä¸ªå­—ä¸²åˆ¤æ–­æ˜¯å¦ä¸ºå›æ–‡ä¸²ã€‚
æ—¶é—´å¤æ‚åº¦$O(n^3)$ã€‚å› ä¸ºå­—ä¸²çš„ä¸ªæ•°ä¸º
&lt;/p&gt;
$$
n + (n - 1) + Â·Â·Â· + 1 = \frac{n(n+1)}{2},
$$&lt;p&gt;
æ‰€ä»¥éå†æ‰€æœ‰çš„å­—ä¸²çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(n^2)$ï¼Œæ£€æŸ¥æ¯ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ˜¯å›æ–‡ä¸²ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(n)$ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸º$O(n^3)$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. åŠ¨æ€è§„åˆ’&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;$P(i)$è¡¨ç¤ºå­—ç¬¦ä¸²$S$çš„ç¬¬$i$ä¸ªå­—ç¬¦ï¼Œ$P(i,j)$è¡¨ç¤ºç¬¬$i$ä¸ªå­—ç¬¦åˆ°ç¬¬$j$ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œå‡è®¾å­—ç¬¦ä¸²$S$é•¿åº¦ä¸º$n$ï¼Œå¦‚æœ$P(2, n-1)$æ˜¯å›æ–‡ä¸²ï¼Œä¸”$P(1) == P(n)$ï¼Œåˆ™å­—ç¬¦ä¸²$S$ä¹Ÿæ˜¯å›æ–‡ä¸²ã€‚è¿™ä¸ªä¸éœ€è¦è¯æ˜å§ã€‚æ‰€ä»¥å³å¯ç”¨åŠ¨æ€è§„åˆ’çš„æ€è·¯æ±‚è§£ã€‚é¦–å…ˆï¼Œæ¯ä¸ªå•ä¸ªå­—ç¬¦éƒ½æ˜¯å›æ–‡ä¸²ï¼Œç„¶ååˆ¤æ–­é•¿åº¦ä¸º2çš„å­—ç¬¦ä¸²æ˜¯å¦æ˜¯å›æ–‡ä¸²ï¼Œæ˜¯çš„è¯å¯ä»¥å­˜åˆ°hashè¡¨é‡Œé¢ã€‚ç„¶ååˆ¤æ–­é•¿åº¦ä¸º3çš„å­—ç¬¦ä¸²ï¼Œæå¤´å»å°¾åçœ‹ä¸­é—´çš„æ˜¯ä¸æ˜¯å›æ–‡ä¸²ï¼Œå¦‚æœä¸æ˜¯ï¼Œç›´æ¥è·³è¿‡ï¼Œæ˜¯çš„è¯åˆ¤æ–­é¦–å°¾ä¸¤ä¸ªå­—ç¬¦æ˜¯å¦ç›¸åŒï¼Œä¸ç›¸åŒå°±è·³è¿‡ï¼Œæ¯æ¬¡éƒ½è®°å½•å½“å‰å·²ç»åˆ¤æ–­çš„å›æ–‡ä¸²çš„æœ€å¤§é•¿åº¦ï¼Œæœ€åå³å¯å¾—åˆ°æœ€é•¿çš„å›æ–‡ä¸²é•¿åº¦ã€‚&lt;/p&gt;</description></item><item><title>leetcode algorithms #4</title><link>https://davidham3.github.io/blog/p/leetcode-algorithms-%234/</link><pubDate>Tue, 17 Jul 2018 16:56:52 +0000</pubDate><guid>https://davidham3.github.io/blog/p/leetcode-algorithms-%234/</guid><description>&lt;p&gt;leetcode algorithms #4. Title: ä¸¤ä¸ªæ’åºæ•°ç»„çš„ä¸­ä½æ•°.è¿™é¢˜è¿˜æ²¡æ&lt;/p&gt;
&lt;p&gt;There are two sorted arrays nums1 and nums2 of size m and n respectively.&lt;/p&gt;
&lt;p&gt;Find the median of the two sorted arrays. The overall run time complexity should be $O(\log{(m+n)})$.&lt;/p&gt;
&lt;p&gt;Example 1:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;nums1 = [1, 3]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;nums2 = [2]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;The median is 2.0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Example 2:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;nums1 = [1, 2]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;nums2 = [3, 4]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;The median is (2 + 3)/2 = 2.5
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>Convolution on Graph: A High-Order and Adaptive Approach</title><link>https://davidham3.github.io/blog/p/convolution-on-graph-a-high-order-and-adaptive-approach/</link><pubDate>Mon, 16 Jul 2018 11:01:00 +0000</pubDate><guid>https://davidham3.github.io/blog/p/convolution-on-graph-a-high-order-and-adaptive-approach/</guid><description>&lt;p&gt;é‡æ–°å®šä¹‰äº†å·ç§¯çš„å®šä¹‰ï¼Œåˆ©ç”¨$k$é˜¶é‚»æ¥çŸ©é˜µï¼Œå®šä¹‰è€ƒè™‘$k$é˜¶é‚»å±…çš„å·ç§¯ï¼Œåˆ©ç”¨é‚»æ¥çŸ©é˜µå’Œç‰¹å¾çŸ©é˜µæ„å»ºèƒ½åŒæ—¶è€ƒè™‘é¡¶ç‚¹ç‰¹å¾å’Œå›¾ç»“æ„ä¿¡æ¯çš„å·ç§¯æ ¸ã€‚åœ¨é¢„æµ‹é¡¶ç‚¹ã€é¢„æµ‹å›¾ã€ç”Ÿæˆå›¾ä¸‰ä¸ªä»»åŠ¡ä¸ŠéªŒè¯äº†æ¨¡å‹çš„æ•ˆæœã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1706.09916" target="_blank" rel="noopener"
&gt;Graph Convolution: A High-Order and Adaptive Approach&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="æ‘˜è¦"&gt;æ‘˜è¦
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬æå‡ºäº†ä¸¤ä¸ªæ–°çš„æ¨¡å—ä¸ºå›¾ç»“æ„æ•°æ®è€Œè®¾è®¡ï¼šké˜¶å·ç§¯å™¨å’Œè‡ªé€‚åº”æ»¤æ³¢æ¨¡å—ã€‚é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬çš„æ¡†æ¶(HA-GCN)æ˜¯ä¸€ç§é€šç”¨æ¡†æ¶ï¼Œå¯ä»¥åœ¨é¡¶ç‚¹å’Œå›¾ä¸Šé€‚åº”å¤šç§åº”ç”¨ï¼Œè¿˜æœ‰å›¾ç”Ÿæˆæ¨¡å‹ã€‚æˆ‘ä»¬çš„å®éªŒæ•ˆæœå¾ˆå¥½ã€‚åœ¨é¡¶ç‚¹åˆ†ç±»å’Œåˆ†å­å±æ€§é¢„æµ‹ä¸Šè¶…è¶Šäº†state-of-the-artã€‚ç”Ÿæˆäº†è¶…è¿‡32%çš„çœŸå®åˆ†å­ï¼Œåœ¨ææ–™è®¾è®¡å’Œè¯ç‰©ç­›é€‰ä¸Šå¾ˆæœ‰æ•ˆã€‚&lt;/p&gt;
&lt;h1 id="å¼•è¨€"&gt;å¼•è¨€
&lt;/h1&gt;&lt;p&gt;å›¾å·ç§¯ç½‘ç»œé€šå¸¸åº”ç”¨åœ¨ä¸¤ä¸ªå­¦ä¹ ä»»åŠ¡ä¸Šï¼š
Â·ä»¥é¡¶ç‚¹ä¸ºä¸­å¿ƒï¼šé¢„æµ‹ä»»åŠ¡ä¸é¡¶ç‚¹ç›¸å…³ã€‚GCNå¯¹å›¾ä¸­çš„æ¯ä¸ªé¡¶ç‚¹è¾“å‡ºä¸€ä¸ªç‰¹å¾å‘é‡ï¼Œæœ‰æ•ˆåœ°åæ˜ é¡¶ç‚¹å±æ€§å’Œé‚»å±…ç»“æ„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œç¤¾äº¤ç½‘ç»œä¸­ï¼Œå‘é‡ç”¨äºé¡¶ç‚¹åˆ†ç±»å’Œé“¾è·¯é¢„æµ‹ã€‚æœ‰æ—¶ä¹Ÿå’Œé¡¶ç‚¹è¡¨ç¤ºå­¦ä¹ æœ‰å…³ã€‚
Â·ä»¥å›¾ä¸ºä¸­å¿ƒï¼šé¢„æµ‹ä»»åŠ¡å’Œå›¾ç›¸å…³ã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒåŒ–å­¦é¢†åŸŸä¸­ï¼Œåˆ†å­å¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªå›¾ï¼ŒåŸå­ä½œé¡¶ç‚¹ï¼ŒåŒ–å­¦é”®æ˜¯è¾¹ã€‚æ ¹æ®åˆ†å­çš„ç‰©ç†å’ŒåŒ–å­¦æ€§è´¨ï¼Œæ„å»ºå›¾å·ç§¯ç½‘ç»œå¯¹åˆ†å­è¿›è¡Œæœ‰æ„ä¹‰åœ°ç¼–ç ã€‚è¿™äº›ä»»åŠ¡å¯¹å¾ˆå¤šç”Ÿæ´»ä¸­çš„åº”ç”¨å¦‚ææ–™è®¾è®¡ã€è¯ç‰©ç­›é€‰å¾ˆé‡è¦ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå›¾å·ç§¯é€šå¸¸å¯¹å›¾è¿›è¡Œç¼–ç ï¼Œä½¿ç”¨ç¼–ç è¿›è¡Œå›¾çš„é¢„æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;å’Œæˆ‘ä»¬çš„å·¥ä½œæœ€ç›¸å…³çš„æ˜¯Kipf &amp;amp; Welling 2016aï¼Œä»–ä»¬çš„å·ç§¯åªè€ƒè™‘äº†ä¸€é˜¶é‚»å±…ã€‚æˆ‘ä»¬çš„é«˜é˜¶æ“ä½œå™¨æœ‰ç€åˆ°è¾¾ké˜¶é‚»å±…çš„é«˜æ•ˆè®¾è®¡ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¼•å…¥äº†è‡ªé€‚åº”æ¨¡å—åŠ¨æ€åœ°åŸºäºå±€éƒ¨å›¾çš„è¿æ¥å’Œé¡¶ç‚¹å±æ€§è°ƒæ•´æƒé‡ã€‚å¯¹æ¯”Li et al., 2015ï¼Œä»–ä»¬å°†LSTMå¼•å…¥å›¾ä¸­ï¼Œæˆ‘ä»¬çš„è‡ªé€‚åº”æ¨¡å—å¯ä»¥è§£é‡ŠæˆXu et al., 2015æå‡ºçš„æ³¨æ„åŠ›æœºåˆ¶ã€‚ä¸åƒå‰äººè®¾è®¡çš„æ¨¡å‹è¦ä¹ˆæ˜¯ä»¥é¡¶ç‚¹ä¸ºé‡ï¼Œè¦ä¹ˆæ˜¯ä»¥å›¾ä¸ºä¸­å¿ƒï¼Œæˆ‘ä»¬çš„HA-GCNæ¡†æ¶æ˜¯ä¸ªé€šç”¨çš„æ¨¡å‹ã€‚é™¤æ­¤ä»¥å¤–ï¼Œæˆ‘ä»¬ç”¨HA-GCNæ„å»ºäº†é’ˆå¯¹åˆ†å­ç”Ÿæˆçš„å›¾ç”Ÿæˆæ¨¡å‹ï¼Œæ¯”state-of-the-artçš„æ•ˆæœæé«˜äº†å¾ˆå¤šã€‚&lt;/p&gt;
&lt;p&gt;è´¡çŒ®æœ‰ä¸¤ç‚¹ï¼š
Â·å¼•å…¥ä¸¤ä¸ªæ¨¡å—ï¼Œæ„å»ºæ–°çš„å›¾å·ç§¯ç½‘ç»œæ¶æ„HA-GCN
Â·æå‡ºäº†å¯ä»¥åº”ç”¨åˆ°ä»¥é¡¶ç‚¹ä¸ºä¸­å¿ƒã€å›¾ä¸ºä¸­å¿ƒçš„é€šç”¨æ¡†æ¶å’Œå›¾ç”Ÿæˆæ¨¡å‹ã€‚åœ¨æ‰€æœ‰çš„ä»»åŠ¡ä¸Šè·å¾—äº†state-of-the-artçš„æ•ˆæœã€‚&lt;/p&gt;
&lt;h1 id="preliminaries"&gt;Preliminaries
&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;The Graph Model&lt;/strong&gt;
ä¸€ä¸ªå›¾$\mathcal{G}$è¡¨ç¤ºä¸ºä¸€ä¸ªå¯¹$(V, E)$ï¼Œ$V = \lbrace v_1, &amp;hellip;, v_n \rbrace $æ˜¯é¡¶ç‚¹é›†ï¼Œ$E \in V \times V$æ˜¯è¾¹é›†ã€‚æˆ‘ä»¬ä¸åŒºåˆ†æœ‰å‘å’Œæ— å‘ï¼Œå› ä¸ºæˆ‘ä»¬çš„æ¨¡å‹éƒ½èƒ½åšã€‚æ¯ä¸ªå›¾å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ª$n \times n$çš„é‚»æ¥çŸ©é˜µ$A$ï¼Œå¦‚æœ$v_i$åˆ°$v_j$æœ‰è¾¹ï¼Œ$A_{i,j} = 1$å¦åˆ™ä¸º$0$ã€‚åŸºäºé‚»æ¥çŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è·ç¦»å‡½æ•°$d(v_i, v_j)$è¡¨ç¤º$v_i$åˆ°$v_j$çš„è·ç¦»ï¼ˆæœ€çŸ­è·ç¦»ï¼‰ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è®¤ä¸ºæ¯ä¸ªé¡¶ç‚¹$v_i$ä¸ä¸€ä¸ªç‰¹å¾å‘é‡$X_i \in \mathcal{R}^m$ç›¸å…³ï¼Œæˆ‘ä»¬ä½¿ç”¨$X = (X^T_1, X^T_2, &amp;hellip;, X^T_n) \in \mathcal{R}^{n \times m}$è¡¨ç¤ºç‰¹å¾çŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Graph Convolutional Networks (GCNs)&lt;/strong&gt;
é¦–å…ˆï¼Œä¸€ä¸ªé¡¶ç‚¹$v_j$åœ¨å›¾$\mathcal{G}$ä¸Šçš„å·ç§¯æ“ä½œå¯ä»¥è¡¨ç¤ºä¸ºï¼š
&lt;/p&gt;
$$
L\_{conv}(j) = \sum\_{i \in \mathcal{N}\_j} w\_{ij} X\_i + b\_j
$$&lt;p&gt;
å…¶ä¸­$X_i \in R_m$æ˜¯é¡¶ç‚¹$v_i$çš„è¾“å…¥ç‰¹å¾ï¼Œ$b_j$æ˜¯åç½®ï¼Œ$w_{ij}$æ˜¯æƒé‡ï¼Œå¯¹$j$æ˜¯éå¹³ç¨³ä¸”å˜åŒ–çš„ã€‚é›†åˆ$\mathcal{N}_j$è¡¨ç¤ºscope of convolutionã€‚å¯¹äºä¼ ç»Ÿçš„åº”ç”¨ï¼ŒCNNé€šå¸¸è®¾è®¡æˆä½ç»´åº¦çš„ç½‘æ ¼ä¸”å¯¹æ¯ä¸ªé¡¶ç‚¹æœ‰ç€ç›¸åŒçš„è¿æ¥ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå›¾åƒå¯ä»¥çœ‹ä½œäºŒç»´ç½‘æ ¼ï¼Œå›¾$\mathcal{G}$é€šè¿‡é‚»æ¥çš„åƒç´ ç»„æˆã€‚$\mathcal{N}_j$å¯ä»¥ç®€å•çš„å®šä¹‰ä¸ºä¸€ä¸ªå›´ç»•åœ¨åƒç´ $j$çš„å›ºå®šå¤§å°çš„blockæˆ–windowã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ›´ä¸€èˆ¬çš„å›¾ä¸Šï¼Œå¯ä»¥å°†$\mathcal{N}_j$å®šä¹‰ä¸ºé¡¶ç‚¹$v_j$çš„é‚»æ¥é¡¶ç‚¹çš„é›†åˆã€‚æ¯”å¦‚ï¼Œåœ¨Duvenaud et al. 2015çš„å·¥ä½œä¸­ï¼Œfingerprint(FP)å·ç§¯æ“ä½œå™¨çš„æ ¸å¿ƒæ˜¯è®¡ç®—é‚»å±…çš„å‡å€¼ï¼Œä¹Ÿå°±æ˜¯å¯¹äºæ‰€æœ‰çš„$(i, j)$ï¼Œ$w_{ij} = 1$ã€‚é€šè¿‡é‚»æ¥çŸ©é˜µ$A$ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæ“ä½œå†™ä¸º
&lt;/p&gt;
$$\tag{1}
L\_{FP} = AX.
$$&lt;p&gt;$A$å’Œç‰¹å¾çŸ©é˜µ$X$çš„ä¹˜ç§¯å¾—åˆ°ä¸€ä¸ªæ‰€æœ‰é‚»å±…é¡¶ç‚¹ç‰¹å¾çš„å‡å€¼ã€‚Kipf &amp;amp; Welling 2016aæå‡ºçš„node-GCNä½¿ç”¨çº¿æ€§ç»„åˆä¸éçº¿æ€§å˜æ¢å¾—åˆ°çš„å‡å€¼ä¸ºï¼š
&lt;/p&gt;
$$\tag{2}
L\_{node-GCN} = \sigma(AXW).
$$&lt;p&gt;æƒé‡çŸ©é˜µ$W$ï¼Œå‡½æ•°$\sigma(\cdot)$åˆ†åˆ«æ˜¯ç‰¹å¾$X$ä¸Šçš„çº¿æ€§ç»„åˆä¸éçº¿æ€§å˜æ¢ã€‚&lt;/p&gt;
&lt;p&gt;Bruna et al., 2013ä¸Defferrard et al., 2016æé‡‡ç”¨äº†ä¸åŒçš„æ–¹å¼åœ¨å›¾çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„è°±ä¸Šåšäº†å·ç§¯ã€‚$H$ä¸ºæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼Œæ­£äº¤åˆ†è§£ä¸º$H = U \Lambda U^T$($U$æ˜¯æ­£äº¤çŸ©é˜µï¼Œ$\Lambda$æ˜¯å¯¹è§’çŸ©é˜µ)ã€‚ä¸å…¶åœ¨å¼2ä¸­åŠ å…¥æƒé‡çŸ©é˜µï¼Œè°±å·ç§¯è€ƒè™‘çš„æ˜¯$H$ä¸Šçš„ä¸€ä¸ªå‚æ•°åŒ–çš„å·ç§¯æ“ä½œï¼›
&lt;/p&gt;
$$\tag{3}
L\_{spectral} = U g\_\theta U^T X.
$$&lt;p&gt;è¿™é‡Œ$g_\theta(\cdot)$æ˜¯ä¸€ä¸ªå¤šé¡¹å¼å‡½æ•°ï¼Œelement-wiselyåº”ç”¨åœ¨å¯¹è§’çŸ©é˜µ$\Lambda$ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è®¨è®ºè°±å›¾å·ç§¯çš„ä¼˜ç‚¹æ—¶ï¼Œä½œè€…æåˆ°$k$é˜¶å¤šé¡¹å¼å¤šé¡¹å¼$g_\theta(\cdot)$å°±æ˜¯å›¾çš„$k$é˜¶å±€éƒ¨ï¼Œä¹Ÿå°±æ˜¯è¯´å·ç§¯ä¼šåˆ°è¾¾$k$é˜¶é‚»å±…ã€‚å¯¹æ¯”å¼1å’Œå¼2ä¸€é˜¶é‚»å±…çš„å‡å€¼ï¼Œè¿™èƒ½ä½¿ä¿¡æ¯åœ¨å›¾ä¸Šå¿«é€Ÿçš„ä¼ æ’­ã€‚ç„¶è€Œï¼Œè€ƒè™‘åˆ°$U \Lambda^n U^T = A^n$ï¼Œå¤šé¡¹å¼$g_\theta(\cdot)$çš„é€‰æ‹©å¹¶æ²¡æœ‰ç»™$k$é˜¶é‚»å±…ä¸€ä¸ªæ˜ç¡®çš„å·ç§¯æ“ä½œï¼Œå› ä¸ºåœ¨å·ç§¯ä¸­ä¸æ˜¯æ‰€æœ‰çš„é‚»å±…éƒ½æ˜¯å ç›¸åŒçš„ä»½é‡ã€‚è¿™ä½¿å¾—æˆ‘ä»¬æå‡ºäº†æˆ‘ä»¬çš„é«˜é˜¶å·ç§¯æ“ä½œã€‚è¿™äº›å·ç§¯çš„å…¶ä»–é—®é¢˜æ˜¯ï¼Œä»–ä»¬åœ¨å›¾ä¸­æ˜¯ä¸å˜çš„ã€‚å› æ­¤å‡ ä¹ä¸èƒ½æ•è·åˆ°ä½¿ç”¨å·ç§¯æ—¶ä¸åŒåœ°æ–¹çš„ä¸åŒã€‚è¿™ä½¿å¾—æˆ‘ä»¬æå‡ºäº†è‡ªé€‚åº”æ¨¡å—ï¼ŒæˆåŠŸçš„è€ƒè™‘äº†å±€éƒ¨ç‰¹å¾å’Œå›¾ç»“æ„ã€‚ï¼ˆè¿™é‡Œçœ‹çš„äº‘é‡Œé›¾é‡Œçš„ã€‚ã€‚ã€‚ï¼‰&lt;/p&gt;
&lt;h1 id="high-order-and-adaptive-graph-convolutional-network-ha-gcn"&gt;High-Order and Adaptive Graph Convolutional Network (HA-GCN)
&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;K-th Order Graph Convolution&lt;/strong&gt;
å®šä¹‰é¡¶ç‚¹$v_j$çš„$k$é˜¶é‚»å±…ï¼š$\mathcal{N}_j = \lbrace v_i \in V \mid d(v_i, v_j) \leq k \rbrace $ã€‚å¯ä»¥é€šè¿‡å¯¹é‚»æ¥çŸ©é˜µ$A$è¿ä¹˜å¾—åˆ°$k$é˜¶é‚»å±…ã€‚
&lt;strong&gt;Proposition 1.&lt;/strong&gt; $A$æ˜¯å›¾$\mathcal{G}$çš„é‚»æ¥çŸ©é˜µï¼Œ$A^k$çš„ç¬¬$i$è¡Œç¬¬$j$åˆ—è¡¨ç¤ºçš„æ˜¯é¡¶ç‚¹$i$åˆ°é¡¶ç‚¹$j$çš„$k$æ­¥è·¯å¾„çš„ä¸ªæ•°ã€‚
æˆ‘ä»¬å®šä¹‰$k$é˜¶å·ç§¯å¦‚ä¸‹ï¼š
&lt;/p&gt;
$$\tag{4}
\tilde{L}^{(k)}\_{gconv} = (W\_k \circ \tilde{A}^k)X + B\_k,
$$&lt;p&gt;å…¶ä¸­
&lt;/p&gt;
$$\tag{5}
\tilde{A}^k = \min\lbrace A^k + I, 1\rbrace .
$$&lt;p&gt;å…¶ä¸­$\circ$å’Œ$\min$åˆ†åˆ«è¡¨ç¤ºelement-wiseçŸ©é˜µä¹˜æ³•å’Œæœ€å°å€¼ã€‚$W_k \in \mathcal{R}^{n \times n}$æ˜¯æƒé‡çŸ©é˜µï¼Œ$B_k \in \mathcal{R}^{n \times m}$æ˜¯åç½®çŸ©é˜µã€‚$\tilde{A}^k$æ˜¯é€šè¿‡å°†$A^k + I$ç åˆ°1è·å¾—çš„ã€‚åœ¨$A^k$ä¸Šå¢åŠ å•ä½é˜µæ˜¯ä¸ºäº†è®©å›¾ä¸Šçš„æ¯ä¸ªé¡¶ç‚¹éƒ½æœ‰è‡ªè¿æ¥ã€‚ç åˆ°1æ˜¯å› ä¸ºå¦‚æœ$A^k$æœ‰å¤§äº1çš„å…ƒç´ ï¼Œç åˆ°1ç¡®å®ä¼šå¾—åˆ°ké˜¶é‚»å±…çš„å·ç§¯ã€‚å·ç§¯çš„è¾“å…¥$\tilde{L}^{(k)}_{gconv}$æ˜¯é‚»æ¥çŸ©é˜µ$A \in \lbrace 0, 1\rbrace ^{n \times n}$å’Œç‰¹å¾çŸ©é˜µ$X \in \mathcal{r}^{n \times m}$ã€‚è¾“å‡ºçš„ç»´åº¦å’Œ$X$ä¸€æ ·ã€‚å¦‚åŒåå­—æ‰€ç¤ºï¼Œå·ç§¯æ“ä½œ$\tilde{L}^{(k)}_{gconv}$å–ä¸€ä¸ªé¡¶ç‚¹çš„$k$é˜¶é‚»å±…çš„ç‰¹å¾å‘é‡ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºä»–ä»¬çš„åŠ æƒå¹³å‡ã€‚&lt;/p&gt;
&lt;p&gt;å¼4çš„æ“ä½œä¼˜é›…åœ°å®ç°äº†æˆ‘ä»¬åœ¨å›¾ä¸Š$k$é˜¶é‚»å±…çš„ideaï¼Œå’Œä¼ ç»Ÿçš„å·ç§¯ä¸€æ ·ï¼Œæ˜¯kernel sizeä¸º$k$çš„å·ç§¯ã€‚ä¸€æ–¹é¢ï¼Œå®ƒå¯ä»¥çœ‹ä½œæ˜¯å¼2ä»1é˜¶é‚»å±…åˆ°é«˜é˜¶çš„é«˜æ•ˆçš„æ³›åŒ–ã€‚å¦ä¸€æ–¹é¢ï¼Œå·ç§¯å™¨ä¸å¼3çš„è°±å›¾å·ç§¯å…³ç³»ç´§å¯†ï¼Œå› ä¸ºè°±å›¾ä¸­çš„$k$é˜¶å¤šé¡¹å¼ä¹Ÿå¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ç§èŒƒå›´ä¸º$k$é˜¶é‚»å±…$\mathcal{N}_j$çš„æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Adaptive Filtering Module&lt;/strong&gt;
åŸºäºå¼4ï¼Œæˆ‘ä»¬å¼•å…¥å›¾å·ç§¯çš„è‡ªé€‚åº”æ»¤æ³¢å™¨æ¨¡å—ã€‚å®ƒæ ¹æ®ä¸€ä¸ªé¡¶ç‚¹çš„ç‰¹å¾ä»¥åŠé‚»å±…çš„è¿æ¥è¿‡æ»¤å·ç§¯çš„æƒé‡ã€‚ä»¥åŒ–å­¦ä¸­åˆ†å­çš„å›¾ä¸ºä¾‹ï¼Œåœ¨é¢„æµ‹åˆ†å­æ€§è´¨æ—¶ï¼Œbenzene ringsæ¯”alkyl chainsæ›´é‡è¦ã€‚æ²¡æœ‰è‡ªé€‚åº”æ¨¡å—ï¼Œå›¾å·ç§¯åœ¨ç©ºé—´ä¸Šä¸å˜ï¼Œè€Œä¸”ä¸èƒ½æŒ‰é¢„æœŸçš„é‚£æ ·å·¥ä½œã€‚è‡ªé€‚åº”æ»¤æ³¢å™¨çš„å¼•å…¥ä½¿å¾—ç½‘ç»œè‡ªé€‚åº”åœ°æ‰¾åˆ°å·ç§¯ç›®æ ‡å¹¶ä¸”æ›´å¥½çš„æ•è·å±€éƒ¨çš„ä¸ä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;è‡ªé€‚åº”æ»¤æ³¢å™¨çš„æƒ³æ³•æ¥æºäºæ³¨æ„åŠ›æœºåˆ¶Xu et al., 2015ï¼Œä»–ä»¬åœ¨ç”Ÿæˆè¾“å‡ºåºåˆ—ä¸­å¯¹åº”çš„è¯æ—¶ï¼Œè‡ªé€‚åº”åœ°çš„äº†æœ‰è¶£çš„åƒç´ ã€‚ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§é—¨çš„å˜ä½“ï¼Œè¿™ä¸ªé—¨æœ‰é€‰æ‹©çš„è®©ä¿¡æ¯é€šè¿‡LSTMã€‚ä»æŠ€æœ¯ä¸Šæ¥è®²ï¼Œæˆ‘ä»¬çš„è‡ªé€‚åº”æ»¤æ³¢å™¨æ˜¯ä¸€ä¸ªåœ¨æƒé‡çŸ©é˜µ$W_k$ä¸Šçš„éçº¿æ€§æ“ä½œå™¨$g$ï¼š
&lt;/p&gt;
$$\tag{6}
\tilde{W\_k} = g \circ W\_k,
$$&lt;p&gt;å…¶ä¸­$\circ$è¡¨ç¤ºelement-wiseçŸ©é˜µä¹˜æ³•ã€‚äº‹å®ä¸Šï¼Œæ“ä½œå™¨$g$æ˜¯ç”±$\tilde{A}^k$å’Œ$X$å…±åŒå†³å®šçš„ï¼Œåæ˜ äº†é¡¶ç‚¹ç‰¹å¾ä¸å›¾çš„è¿æ¥ï¼Œ
&lt;/p&gt;
$$
g = f\_{adp}(\tilde{A}^k, X).
$$&lt;p&gt;æˆ‘ä»¬è€ƒè™‘äº†å‡½æ•°$f_{adp}$çš„ä¸¤ä¸ªé€‰é¡¹ï¼š
&lt;/p&gt;
$$\tag{7}
f\_{adp/prod} = \mathrm{sigmoid}(\tilde{A}^kXQ)
$$&lt;p&gt;
å’Œ
&lt;/p&gt;
$$\tag{8}
f\_{adp/lin} = \mathrm{sigmoid}(Q \cdot [\tilde{A}^k, X]).
$$&lt;p&gt;è¿™é‡Œï¼Œ$[\cdot, \cdot]$è¡¨ç¤ºçŸ©é˜µæ‹¼æ¥ã€‚ç¬¬ä¸€ä¸ªæ“ä½œå™¨é€šè¿‡$A$å’Œ$X$çš„å†…ç§¯è€ƒè™‘äº†é¡¶ç‚¹ç‰¹å¾å’Œå›¾è¿æ¥çš„çš„äº¤äº’ï¼Œç¬¬äºŒä¸ªé€šè¿‡çº¿æ€§å˜æ¢ä¹Ÿå®ç°äº†è¿™ä¸ªç›®çš„ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬å‘ç°çº¿æ€§è‡ªé€‚åº”æ»¤æ³¢å™¨(8)æ¯”(7)åœ¨å¤§å¤šæ•°ä»»åŠ¡ä¸Šè¡¨ç°çš„æ›´å¥½ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨å®éªŒéƒ¨åˆ†ä¼šé‡‡ç”¨å¹¶ä¸”è®°å½•çº¿æ€§çš„è¡¨ç°ã€‚è‡ªé€‚åº”æ»¤æ³¢å™¨ä¸ºäº†é¡¶ç‚¹çš„æƒé‡é€‰æ‹©è€Œè®¾è®¡å‡ºæ¥ï¼Œå› æ­¤æˆ‘ä»¬ç”¨äº†ä¸€ä¸ªsigmoidéçº¿æ€§æ¿€æ´»ä½¿å®ƒäºŒå€¼åŒ–ã€‚å‚æ•°çŸ©é˜µ$Q$ä¼šè®©$f_{adp}$çš„è¾“å‡ºçš„ç»´åº¦ä¸çŸ©é˜µ$A$å¯¹é½ã€‚ä¸åƒå½“å‰å·²æœ‰çš„åŠ¨æ€æ»¤æ³¢å™¨åªä»é¡¶ç‚¹æˆ–è¾¹çš„ç‰¹å¾ä¸­ç”Ÿæˆæƒé‡ï¼Œæˆ‘ä»¬çš„è‡ªé€‚åº”æ»¤æ³¢å™¨æ¨¡å—é€šè¿‡åŒæ—¶è€ƒè™‘é¡¶ç‚¹ç‰¹å¾ä¸å›¾çš„è¿é€šæ€§æœ‰ç€æ›´å…¨é¢çš„è€ƒè™‘ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;The Framework of HA-GCN&lt;/strong&gt;
é€šè¿‡åœ¨é«˜é˜¶å·ç§¯å¼4ä¸­åŠ å…¥è‡ªé€‚åº”æ¨¡å—å¼6ï¼Œæˆ‘ä»¬å¾—åˆ°HAçš„å®šä¹‰ä¸ºï¼š
&lt;/p&gt;
$$
\tilde{L}^{(k)}\_{HA} = (\tilde{W}\_k \circ \tilde{A}^k)X = B\_k
$$&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/convolution-on-graph-a-high-order-and-adaptive-approach/Fig1.JPG"
loading="lazy"
alt="Fig1"
&gt;
å›¾1ç»™äº†å·ç§¯å™¨å’ŒHA-GCNæ¡†æ¶çš„å¯è§†åŒ–ã€‚å›¾1aå±•ç¤ºäº†å¯¹äºä¸€ä¸ªé¡¶ç‚¹ï¼Œ$k = 2$æ—¶çš„$\tilde{L}^{(k)}_{HA}$ï¼šè‡ªé€‚åº”æ»¤æ³¢å™¨$g$çš„åº•å±‚åŠ åˆ°æƒé‡çŸ©é˜µ$W_1$å’Œ$W_2$ä¸Šï¼Œå¾—åˆ°äº†è‡ªé€‚åº”æƒé‡$\tilde{W}_1$å’Œ$\tilde{W}_2$ï¼ˆæ©™è‰²å’Œç»¿è‰²çº¿ï¼‰ï¼›ç¬¬äºŒå±‚æŠŠè‡ªé€‚åº”æƒé‡å’Œå¯¹åº”çš„é‚»æ¥çŸ©é˜µæ‹¼åˆ°ä¸€èµ·ä¸ºäº†å·ç§¯ä½¿ç”¨ã€‚å›¾1bå¼ºè°ƒäº†å·ç§¯æ˜¯åœ¨å›¾ä¸Šæ¯ä¸ªé¡¶ç‚¹éƒ½åšçš„ï¼Œå¹¶ä¸”æ˜¯ä¸€å±‚ä¸€å±‚çš„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯é«˜é˜¶å·ç§¯å™¨å’Œè‡ªé€‚åº”æƒé‡å¯ä»¥å’Œå…¶ä»–çš„ç¥ç»ç½‘ç»œæ¶æ„/æ“ä½œä¸€èµ·ä½¿ç”¨ï¼Œæ¯”å¦‚å…¨è¿æ¥å±‚ï¼Œæ± åŒ–å±‚ï¼Œéçº¿æ€§å˜æ¢ã€‚æˆ‘ä»¬å°†æˆ‘ä»¬çš„HAæ“ä½œçš„å›¾å·ç§¯å±‚å‘½åä¸ºHA-GCNã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ‰€æœ‰çš„å·ç§¯å±‚ä¹‹åï¼Œæˆ‘ä»¬å°†é‚£äº›æ¥è‡ªä¸åŒé˜¶çš„å·ç§¯å±‚çš„è¾“å‡ºç‰¹å¾æ‹¼æ¥èµ·æ¥ï¼š
&lt;/p&gt;
$$
L\_{HA} = [\tilde{L}^{(1)}\_{HA}, ..., \tilde{L}^{(K)}\_{HA}].
$$&lt;p&gt;HA-GCNçš„æ¶æ„ä»¥ç‰¹å¾çŸ©é˜µ$X \in \mathcal{R}^{n \times m}$ï¼ˆ$n$æ˜¯å›¾çš„é¡¶ç‚¹æ•°ï¼Œ$m$æ˜¯é¡¶ç‚¹ç‰¹å¾çš„ç»´æ•°ï¼‰ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºä¸€ä¸ªç»´åº¦ä¸º$n \times (mK)$çš„çŸ©é˜µï¼Œç‰¹å¾çš„ç»´æ•°ä¼šä¹˜ä»¥$K$å€ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†è¯¦ç»†æè¿°å¦‚ä½•å°†HA-GCNåº”ç”¨åˆ°å„ç§å„æ ·çš„é—®é¢˜ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;**ä»¥é¡¶ç‚¹ä¸ºä¸­å¿ƒçš„é¢„æµ‹ï¼š**HA-GCNçš„å·ç§¯ä¹‹åï¼Œæ¯ä¸ªé¡¶ç‚¹å’Œä¸€ä¸ªç‰¹å¾å‘é‡æœ‰å…³ã€‚ç‰¹å¾å‘é‡å¯ä»¥ç”¨äºé¡¶ç‚¹åˆ†ç±»æˆ–å›å½’ã€‚ä¸ç½‘ç»œè¡¨ç¤ºå­¦ä¹ ä¹Ÿå¯†åˆ‡ç›¸å…³ã€‚ä½¿ç”¨ä»¥é¡¶ç‚¹ä¸ºä¸­å¿ƒçš„è®¾å®šï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥ç»™æ¯ä¸ªé¡¶ç‚¹å­¦ä¹ å‡ºä¸€ä¸ªå‘é‡ï¼Œå‘é‡åæ˜ äº†é‚£ä¸ªé¡¶ç‚¹å‘¨å›´çš„å›¾çš„å±€éƒ¨ç»“æ„ã€‚æˆ‘ä»¬çš„HA-GCNä¹Ÿç»™å›¾ä¸­çš„æ¯ä¸ªé¡¶ç‚¹è¾“å‡ºäº†ä¸€ä¸ªå‘é‡ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼ŒHA-GCNå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªç›‘ç£çš„å›¾è¡¨ç¤ºå­¦ä¹ æ¡†æ¶ã€‚&lt;/p&gt;
&lt;p&gt;**ä»¥å›¾ä¸ºä¸­å¿ƒçš„é¢„æµ‹ï¼š**ä¸ºäº†è§£å†³ä¸åŒå°ºåº¦çš„å›¾ï¼Œè¾“å…¥çš„é‚»æ¥çŸ©é˜µå’Œç‰¹å¾çŸ©é˜µåœ¨åº•éƒ¨å’Œå³ä¾§åŠ å…¥äº†ä¸º0çš„paddingã€‚ä»¥é¡¶ç‚¹ä¸ºä¸­å¿ƒå’Œä»¥å›¾ä¸ºä¸­å¿ƒçš„ä¸€ä¸ªå°ä¸åŒæ˜¯ï¼šä»¥é¡¶ç‚¹ä¸ºä¸­å¿ƒçš„ä»»åŠ¡ä¸­ï¼Œä¸€éƒ¨åˆ†æœ‰æ ‡ç­¾/å€¼çš„é¡¶ç‚¹ä½œä¸ºè®­ç»ƒï¼Œå…¶ä»–çš„ä½œéªŒè¯å’Œè¾“å‡ºï¼Œè€Œä»¥å›¾ä¸ºä¸­å¿ƒçš„ä»»åŠ¡ï¼Œæ•°æ®é›†æ˜¯ä¸€ç»„å›¾ï¼ˆå¯èƒ½å°ºåº¦ä¸åŒï¼‰ï¼Œåˆ†ä¸ºè®­ç»ƒ/éªŒè¯/æµ‹è¯•é›†ã€‚HA-GCNåœ¨è¿™ä¸¤ç§æƒ…å†µéƒ½èƒ½å·¥ä½œï¼ŒHAå·ç§¯å±‚ä¸­çš„å‚æ•°æ˜¯$(n^2)$ï¼Œ$n$æ˜¯å›¾çš„sizeï¼ˆæˆ–æ˜¯é‚£äº›å›¾ä¸­æœ€å¤§çš„sizeï¼‰ã€‚HA-GCNåœ¨é¡¶ç‚¹ä¸ºä¸­å¿ƒçš„ä»»åŠ¡ä¸­æ¯”åœ¨å›¾ä¸ºä¸­å¿ƒçš„ä»»åŠ¡æ›´å®¹æ˜“è¿‡æ‹Ÿåˆï¼Œæˆ‘ä»¬ä¼šåœ¨åé¢çš„å®éªŒéƒ¨åˆ†æè¿°è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;**å›¾ç”Ÿæˆæ¨¡å‹ï¼š**ä»ä¸€ç»„å›¾$\bar{\mathcal{G}} = \lbrace \mathcal{G}_1, &amp;hellip;, \mathcal{G}_N \rbrace $ä¸­å­¦ä¹ ä¸€ä¸ªæ¦‚ç‡æ¨¡å‹ï¼Œé€šè¿‡è¿™ä¸ªæ¨¡å‹æˆ‘å¯ä»¥ç”Ÿæˆä¹‹å‰æ²¡è§è¿‡ä½†æ˜¯å’Œ$\bar{\mathcal{G}}$ä¸­ç›¸ä¼¼çš„å›¾ã€‚é€šè¿‡variational auto-encoder(Kingma and Welling 2013)å’Œadversarial auto-encoder(Makhzani et al., 2015)ï¼Œå›¾å·ç§¯ç½‘ç»œå¯ä»¥é€‚ç”¨äºç”Ÿæˆæ¨¡å‹çš„ä»»åŠ¡ç”šè‡³æ˜¯åˆ¤åˆ«æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªè‡ªç¼–ç å™¨æ€»æ˜¯ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šä¸€ä¸ªç¼–ç å™¨å’Œä¸€ä¸ªè§£ç å™¨ã€‚ç¼–ç å™¨å°†è¾“å…¥æ•°æ®$X \in \mathcal{X}$æ˜ å°„åˆ°ä¸€ä¸ªç¼–ç å‘é‡$Y \in \mathcal{Y}$ï¼Œè§£ç å™¨å°†$\mathcal{Y}$æ˜ å°„å›$\mathcal{X}$ã€‚æˆ‘ä»¬ç§°ç¼–ç ç©ºé—´$\mathcal{Y}$ä¸ºéšè—ç©ºé—´ã€‚ä¸ºäº†ä½¿ä»–æˆä¸ºä¸€ä¸ªç”Ÿæˆæ¨¡å‹ï¼Œæˆ‘ä»¬é€šå¸¸å‡è®¾éšè—ç©ºé—´ä¸­æœ‰ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼ˆæ¯”å¦‚é«˜æ–¯åˆ†å¸ƒï¼‰ã€‚å›¾ç”Ÿæˆæ¨¡å‹èƒ½è®©æˆ‘ä»¬ç”Ÿæˆåˆ†å­çš„è¿ç»­è¡¨è¾¾ï¼Œé€šè¿‡æœç´¢éšè—ç©ºé—´ç”Ÿæˆæ–°çš„åŒ–å­¦ç»“æ„ï¼Œå¯ä»¥ç”¨æ¥æŒ‡å¯¼ææ–™è®¾è®¡å’Œè¯ç‰©ç­›é€‰ã€‚&lt;/p&gt;
&lt;h1 id="å®éªŒ"&gt;å®éªŒ
&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;Node-centric learning&lt;/strong&gt;
citation graphsä¸Šçš„ç›‘ç£æ–‡æ¡£åˆ†ç±»ï¼Œæ¯ä¸ªå›¾åŒ…å«æ–‡æ¡£çš„bag-of-wordsç‰¹å¾å‘é‡ï¼Œè¿˜æœ‰æ–‡æ¡£ä¹‹é—´çš„å¼•ç”¨è¿æ¥ã€‚æˆ‘ä»¬æŠŠè¿™ä¸ªç½‘ç»œå½“æˆæ— å‘å›¾ï¼Œæ„å»ºä¸€ä¸ªäºŒå€¼å¯¹ç§°é‚»æ¥çŸ©é˜µ$A$ã€‚æ¯ä¸ªæ–‡æ¡£æœ‰ä¸€ä¸ªç±»æ ‡ï¼Œç›®æ ‡æ˜¯ä»æ–‡æ¡£çš„ç‰¹å¾å’Œå¼•ç”¨çš„å›¾å¯¹æ–‡æ¡£æ ‡ç­¾é¢„æµ‹ã€‚ç»Ÿè®¡æ•°æ®(Sen et al., 2008)&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: center"&gt;Dataset&lt;/th&gt;
&lt;th style="text-align: center"&gt;Nodes&lt;/th&gt;
&lt;th style="text-align: center"&gt;Edges&lt;/th&gt;
&lt;th style="text-align: center"&gt;Classes&lt;/th&gt;
&lt;th style="text-align: center"&gt;Features&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;Citeseer&lt;/td&gt;
&lt;td style="text-align: center"&gt;3327&lt;/td&gt;
&lt;td style="text-align: center"&gt;4732&lt;/td&gt;
&lt;td style="text-align: center"&gt;6&lt;/td&gt;
&lt;td style="text-align: center"&gt;3703&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;Cora&lt;/td&gt;
&lt;td style="text-align: center"&gt;2708&lt;/td&gt;
&lt;td style="text-align: center"&gt;5429&lt;/td&gt;
&lt;td style="text-align: center"&gt;7&lt;/td&gt;
&lt;td style="text-align: center"&gt;1433&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;Pubmed&lt;/td&gt;
&lt;td style="text-align: center"&gt;19717&lt;/td&gt;
&lt;td style="text-align: center"&gt;44338&lt;/td&gt;
&lt;td style="text-align: center"&gt;210&lt;/td&gt;
&lt;td style="text-align: center"&gt;5414&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;**è®­ç»ƒå’Œæ¶æ„ï¼š**æˆ‘ä»¬ä½¿ç”¨å’ŒKipf &amp;amp; WellingåŒæ ·çš„GCNç½‘ç»œç»“æ„ï¼Œé™¤äº†å°†ä»–ä»¬çš„ä¸€é˜¶å›¾å·ç§¯å±‚æ¢æˆäº†æˆ‘ä»¬çš„HAå±‚ã€‚æˆ‘ä»¬ä½¿ç”¨$gcn_{1,&amp;hellip;,k}$è¡¨ç¤º$1$é˜¶åˆ°$k$é˜¶çš„å›¾å·ç§¯å±‚ã€‚$\mathrm{fc}k$è¡¨ç¤ºæœ‰$k$ä¸ªéšè—å•å…ƒçš„å…¨è¿æ¥å±‚ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: center"&gt;Name&lt;/th&gt;
&lt;th style="text-align: center"&gt;Architectures&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;GCN&lt;/td&gt;
&lt;td style="text-align: center"&gt;gcn_{1}-fc128-gcn_{1}-fc1-softmax&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;gcn_{1, 2}&lt;/td&gt;
&lt;td style="text-align: center"&gt;gcn{1, 2}-fc128-gcn{1, 2}-fc1-softmax&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;adp_gcn_{1, 2}&lt;/td&gt;
&lt;td style="text-align: center"&gt;adp_gcn{1, 2}-fc128-adp_gcn{1, 2}-fc1-softmax&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä¸ºäº†æ¯”è¾ƒä¸åŒæ¨¡å‹çš„æ€§èƒ½ï¼Œæˆ‘ä»¬å°†æ•°æ®é›†éšæœºåˆ’åˆ†æˆè®­ç»ƒ/éªŒè¯/æµ‹è¯•é›†ï¼Œæ¯”ä¾‹ä¸º$7:1.5:1.5$ï¼Œè®°å½•æµ‹è¯•é›†çš„é¢„æµ‹ç²¾åº¦ï¼Œè¡¨1ã€‚è¶…å‚æ•°ï¼šdropout rate $0.7$ï¼ŒL2 regularization $0.5 \cdot 10^{-8}$ï¼Œhidden units $128$ã€‚ä»é¡¶ç‚¹è¡¨ç¤ºå­¦ä¹ è§’åº¦çœ‹ï¼Œå‰ä¸‰ä¸ªæ˜¯åŠç›‘ç£çš„æ¨¡å‹ï¼Œåå››ä¸ªæ˜¯åŠç›‘ç£çš„æ¨¡å‹ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆåé¢çš„æ¨¡å‹æ•ˆæœæ›´å¥½ã€‚æˆ‘ä»¬çš„äºŒå§é‚»å±…HAå›¾å·ç§¯åœ¨ç²¾åº¦ä¸Šæå‡äº†2%ã€‚è‡ªé€‚åº”æ¨¡å—æ²¡èƒ½ç»§ç»­æå‡ã€‚è¿™æ˜¯å› ä¸ºè‡ªé€‚åº”æ¨¡å—æ˜¯ä¸ºäº†å¯¹ä¸åŒçš„å›¾ç”Ÿæˆä¸åŒçš„æ»¤æ³¢å™¨æƒé‡ã€‚ç„¶è€Œï¼Œåœ¨é¡¶ç‚¹ä¸ºä¸­å¿ƒçš„ä»»åŠ¡ä¸­ï¼Œåªæœ‰ä¸€ä¸ªå›¾ï¼Œå·ç§¯æƒé‡ç›´æ¥å°±å­¦å‡ºæ¥äº†ã€‚å› æ­¤è‡ªé€‚åº”æ¨¡å—åœ¨é¡¶ç‚¹ä¸ºä¸­å¿ƒçš„ä»»åŠ¡ä¸­æ˜¯å†—ä½™çš„ã€‚
&lt;img src="https://davidham3.github.io/blog/images/convolution-on-graph-a-high-order-and-adaptive-approach/Table1.JPG"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Graph-centric learning&lt;/strong&gt;
é¢„æµ‹åˆ†å­å›¾ã€‚ç›®æ ‡æ˜¯ç»™å®šåˆ†å­å›¾ï¼Œé¢„æµ‹åˆ†å­æ€§è´¨ã€‚æˆ‘ä»¬ä½¿ç”¨Duvenaud et al., 2015æè¿°çš„æ•°æ®é›†ï¼Œè¯„ä¼°ä¸‰ç§å±æ€§ï¼š
Solubility, Drug efficacy, Organic photovolatic efficiencyã€‚
è®­ç»ƒå’Œæ¶æ„ï¼š
l1_gcnå’Œl2_gcnåˆ†åˆ«è¡¨ç¤ºæœ‰ä¸€ä¸ªå’Œä¸¤ä¸ªå·ç§¯å±‚çš„å·ç§¯ç¥ç»ç½‘ç»œã€‚æˆ‘ä»¬è®°å½•äº†RMSEï¼ˆè¡¨2ï¼‰ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: center"&gt;Name&lt;/th&gt;
&lt;th style="text-align: center"&gt;Architectures&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;l1_gcn&lt;/td&gt;
&lt;td style="text-align: center"&gt;gcn_{1,2,3}-ReLU-fc64-ReLU-fc16-ReLU-fc1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;l1_adp_gcn&lt;/td&gt;
&lt;td style="text-align: center"&gt;adp_gcn{1,2,3}-ReLU-fc64-ReLU-fc16-ReLU-fc1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;l2_gcn&lt;/td&gt;
&lt;td style="text-align: center"&gt;[gcb_{1,2,3}-ReLU]*2-fc64-ReLU-fc16-ReLU-fc1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;l2_adp_gcn&lt;/td&gt;
&lt;td style="text-align: center"&gt;[adp_gcn_{1,2,3}-ReLU]*2-fc64-ReLU-fc16-ReLU-fc1&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/convolution-on-graph-a-high-order-and-adaptive-approach/Table2.JPG"
loading="lazy"
alt="Table2"
&gt;&lt;/p&gt;
&lt;p&gt;node-GCNå°±æ˜¯æ²¡æœ‰è‡ªé€‚åº”æ»¤æ³¢æ¨¡å—çš„ä¸€é˜¶HA-GCNã€‚å¯¹æ¯”node-GCN,l1_gcn,l2_gcnï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„å·ç§¯å±‚çš„æ•ˆæœã€‚æœ‰è‡ªé€‚åº”æ»¤æ³¢å™¨çš„æ¯”æ²¡æœ‰çš„æ•ˆæœå¥½ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€éƒ¨åˆ†å›¾ç”Ÿæˆæ¨¡å‹ï¼Œå°±ä¸è¯´äº†ã€‚&lt;/p&gt;</description></item><item><title>hexo markdown mathjax å†²çªé—®é¢˜</title><link>https://davidham3.github.io/blog/p/hexo-markdown-mathjax-%E5%86%B2%E7%AA%81%E9%97%AE%E9%A2%98/</link><pubDate>Sat, 14 Jul 2018 20:35:43 +0000</pubDate><guid>https://davidham3.github.io/blog/p/hexo-markdown-mathjax-%E5%86%B2%E7%AA%81%E9%97%AE%E9%A2%98/</guid><description>&lt;p&gt;å†™å®Œå…¬å¼æ¸²æŸ“ä¸å‡ºæ¥ï¼Œæ¯”å¦‚\vec{i}_jå°±ä¼šå‡ºé”™&lt;/p&gt;
&lt;p&gt;markdownä¸­çš„ä¸‹åˆ’çº¿_è¡¨ç¤ºæ–œä½“ï¼Œåœ¨latexä¸­ï¼Œæ˜¯ä¸‹æ ‡ã€‚
\åœ¨latexä¸­æ˜¯æ¢è¡Œï¼Œåœ¨markdownä¸­ä¼šè½¬ä¹‰æˆ\ã€‚
æ‰€ä»¥å¯¼è‡´å¦‚æœå†™å…¬å¼\vec{i}_jï¼Œæœ¬æ¥åº”è¯¥æ˜¯å‘é‡içš„jä¸‹æ ‡ï¼Œå°±ä¼šæ¸²æŸ“ä¸å‡ºæ¥ã€‚
è§£å†³æ–¹æ¡ˆï¼š
ä¿®æ”¹é»˜è®¤çš„æ¸²æŸ“å™¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;npm uninstall hexo-renderer-marked â€“save
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å®‰è£… hexo-renderer-markdown-it å’Œ markdown-it-katex&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;npm install hexo-renderer-markdown-it --save
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;npm install markdown-it-katex --save
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶ååœ¨ _config.yml é‡Œé¢åŠ å…¥ä¸‹é¢çš„ä»£ç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# Markdown-it config
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;## Docs: https://github.com/celsomiranda/hexo-renderer-markdown-it/wiki/
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;markdown:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; render:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; html: true
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; xhtmlOut: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; breaks: true
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; linkify: true
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; typographer: true
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; quotes: &amp;#39;â€œâ€â€˜â€™&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; plugins:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; anchors:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; level: 2
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; collisionSuffix: &amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;math:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; engine: &amp;#39;katex&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; katex:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; css: https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; js: https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; config:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; # KaTeX config
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; throwOnError: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; errorColor: &amp;#34;#cc0000&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶ååœ¨ä¸»é¢˜çš„ _config.yml é‡Œé¢æ‰“å¼€ katex æ”¯æŒå³å¯ã€‚&lt;/p&gt;</description></item><item><title>hexo yilia ä¸»é¢˜</title><link>https://davidham3.github.io/blog/p/hexo-yilia-%E4%B8%BB%E9%A2%98/</link><pubDate>Fri, 13 Jul 2018 23:01:12 +0000</pubDate><guid>https://davidham3.github.io/blog/p/hexo-yilia-%E4%B8%BB%E9%A2%98/</guid><description>&lt;p&gt;å‘ç°äº†ä¸€ä¸ªç‰¹åˆ«å¥½çœ‹çš„ä¸»é¢˜ï¼Œyiliaï¼Œä½†æ˜¯å·²ç»ä¸ç»´æŠ¤äº†ï¼Œå‘è¿˜æŒºå¤šçš„ï¼Œè®°å½•ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»é¢˜åœ°å€ï¼šhttps://github.com/litten/hexo-theme-yilia&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é¦–å…ˆgit cloneåˆ°themesç›®å½•ä¸­ï¼Œè®°å¾—è¦æ”¹åï¼Œç›®å½•åä¹æ•™yiliaï¼ŒæŠŠå‰é¢çš„hexo-themeå»æ‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¿®æ”¹å®Œhexoæ ¹ç›®å½•ä¸‹_config.ymlé‡Œé¢çš„themeä¸ºyiliaåï¼Œè¿è¡ŒæœåŠ¡å™¨ï¼Œå‘ç°å‡ºç°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;%- partial(&amp;#39;_partial/head&amp;#39;) %&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;%- partial(&amp;#39;_partial/header&amp;#39;) %&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;%- body %&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;% if (theme.sidebar &amp;amp;&amp;amp; theme.sidebar !== &amp;#39;bottom&amp;#39;){ %&amp;gt; &amp;lt;%- partial(&amp;#39;_partial/sidebar&amp;#39;) %&amp;gt; &amp;lt;% } %&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;%- partial(&amp;#39;_partial/footer&amp;#39;) %&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;%- partial(&amp;#39;_partial/mobile-nav&amp;#39;) %&amp;gt; &amp;lt;%- partial(&amp;#39;_partial/after-footer&amp;#39;) %&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¯´æ˜å°‘è£…äº†æ’ä»¶ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…æ’ä»¶ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;npm install hexo-renderer-ejs --save
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;npm install hexo-renderer-stylus --save
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;npm install hexo-renderer-marked --save
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¿›å…¥æ–‡ç« åï¼Œå¤´åƒå°±æ˜¾ç¤ºä¸å‡ºæ¥äº†ï¼Œè¿™æ˜¯æºç ä¸­çš„bugã€‚
ä¿®æ”¹themes\yilia\layout_partial\left-col.ejsçš„ç¬¬å…­è¡Œï¼Œæ”¹ä¸º&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;img src=&amp;#34;&amp;lt;%=theme.root%&amp;gt;&amp;lt;%=theme.avatar%&amp;gt;&amp;#34; class=&amp;#34;js-avatar&amp;#34;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¤´åƒå°±è®¾ç½®ä¸º&amp;quot;img/avatar.jpg&amp;quot;å³å¯ã€‚
åŒæ—¶ï¼Œè¿˜è¦ä¿®æ”¹themes\yilia\layout_partial\mobile-nav.ejs
é‡Œé¢çš„ç¬¬10è¡Œï¼Œä¿®æ”¹ä¸º&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;img src=&amp;#34;&amp;lt;%=theme.root%&amp;gt;&amp;lt;%=theme.avatar%&amp;gt;&amp;#34; class=&amp;#34;js-avatar&amp;#34;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ‰“èµçš„äºŒç»´ç ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜
ä¿®æ”¹themes\yilia\layout_partial\article.ejs
æ‰¾åˆ°&amp;lt;img class=&amp;ldquo;reward-img&amp;quot;è¿™ä¸ªæ ‡ç­¾ï¼Œæ”¹åé¢srcçš„å€¼
æ”¯ä»˜å®çš„æ”¹æˆè¿™ä¸ª&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;%=theme.root%&amp;gt;&amp;lt;%= theme.alipay%&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¾®ä¿¡çš„æ”¹æˆè¿™ä¸ª&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;%=theme.root%&amp;gt;&amp;lt;%= theme.weixin%&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;â€œæ‰€æœ‰æ–‡ç« â€æŒ‰é’®çš„å®‰è£…
é¦–å…ˆä½¿ç”¨å‘½ä»¤&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;node -v
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ£€æŸ¥ç‰ˆæœ¬æ˜¯ä¸æ˜¯å¤§äº6.2
ç„¶ååœ¨hexoçš„é…ç½®æ–‡ä»¶_config.ymlæœ€ä¸‹é¢åŠ ä¸Š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;jsonContent:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; meta: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; pages: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; posts:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; title: true
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; date: true
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; path: true
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; text: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; raw: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; content: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; slug: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; updated: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; comments: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; link: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; permalink: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; excerpt: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; categories: false
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; tags: true
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;é‡å¯æœåŠ¡å™¨å³å¯&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ†äº«åŠŸèƒ½æœ‰é—®é¢˜ï¼Œæˆ‘å‘ç°share_jiaçš„å¾®ä¿¡åˆ†äº«ä¸å¥½ä½¿ï¼Œå°±ä½¿ç”¨äº†Mobåˆ†äº«
å…ˆå»å®˜ç½‘æ³¨å†Œè´¦å·http://mob.com/ï¼Œç„¶åç”³è¯·shareSDKï¼Œä¼šå¾—åˆ°ä¸€ä¸ªApp Key
åœ¨yiliaä¸»é¢˜é‡Œé¢çš„_config.ymlä¸­çš„æœ€åï¼ŒåŠ ä¸Š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sharesdk: true #æ˜¯å¦å¼€å¯åˆ†äº«
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;shareSDKappkey: ä½ çš„App Key
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶ååœ¨layoutä¸­çš„_partialä¸­æ–°å»ºç›®å½•shareï¼Œ
åˆ›å»ºæ–‡ä»¶ï¼šyilia/layout/_partial/share/share.ejs&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-html" data-lang="html"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c"&gt;&amp;lt;!--MOB SHARE BEGIN--&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-ui-button -mob-share-open&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;åˆ†äº«&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-ui&amp;#34;&lt;/span&gt; &lt;span class="na"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;display: none&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;ul&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-list&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-weibo&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;æ–°æµªå¾®åš&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-tencentweibo&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;è…¾è®¯å¾®åš&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-qzone&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;QQç©ºé—´&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-qq&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;QQå¥½å‹&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-weixin&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;å¾®ä¿¡&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-twitter&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Twitter&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-youdao&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;æœ‰é“äº‘ç¬”è®°&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-mingdao&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;æ˜é“&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-linkedin&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;LinkedIn&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-close&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;å–æ¶ˆ&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share-ui-bg&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;-mob-share&amp;#34;&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;http://f1.webshare.mob.com/code/mob-share.js?appkey={{ theme.shareSDKappkey }}&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c"&gt;&amp;lt;!--MOB SHARE END--&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶åç¼–è¾‘layout/_partial/article.ejs
æ‰¾ä¸ªåˆé€‚çš„ä½ç½®åŠ å…¥ä»¥ä¸‹å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;% if (!index &amp;amp;&amp;amp; theme.sharesdk){ %&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;%- partial(&amp;#39;_partial/share/share.ejs&amp;#39;) %&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;% } %&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å·¦è¾¹æ˜µç§°çš„å­—ä½“æœ‰ç‚¹ä¸‘ï¼Œåœ¨themes\yilia\source\main.0cf68a.cssé‡Œé¢ä¿®æ”¹ï¼Œæ‰¾åˆ°header-authorï¼Œä¿®æ”¹é‡Œé¢çš„font-familyï¼Œæˆ‘æ”¹æˆäº†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-css" data-lang="css"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nt"&gt;font-family&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;Times New Roman&amp;#34;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;Georgia&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;Serif&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¹‹å‰çš„é‚£ä¸ªshare_jiaæˆ‘ä¿®å¤äº†ï¼Œä¹‹å‰å¾®ä¿¡åˆ†äº«ä¹‹æ‰€ä»¥ä¸æˆåŠŸï¼Œå¥½åƒæ˜¯å› ä¸ºç™¾åº¦ç½‘ç›˜å–æ¶ˆäº†ç”ŸæˆäºŒç»´ç çš„åŠŸèƒ½ï¼Œå¯¼è‡´ä¹‹å‰çš„é“¾æ¥ä¸å¯ç”¨äº†ã€‚è§£å†³æ–¹æ³•æ˜¯ä¿®æ”¹themes\yilia\layout_partial\post\share.ejs
æŠŠç¬¬49è¡Œä¸­çš„&lt;code&gt;//pan.baidu.com/share/qrcode?url=&lt;/code&gt;ä¿®æ”¹ä¸º&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;//api.qrserver.com/v1/create-qr-code/?size=150x150&amp;amp;data=
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¦‚ä½•åœ¨å·¦ä¾§æ˜¾ç¤ºæ€»æ–‡ç« æ•°ï¼Ÿ
ä¿®æ”¹themes\yilia\layout_partial\left-col.ejs
åœ¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-gdscript3" data-lang="gdscript3"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;nav&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;header-menu&amp;#34;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ul&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;&amp;lt;%&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;theme&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;menu&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt; &lt;span class="o"&gt;%&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;li&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&amp;lt;&lt;/span&gt;&lt;span class="si"&gt;%- u&lt;/span&gt;&lt;span class="s2"&gt;rl_for(theme.menu[i]) %&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;lt;%=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;%&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;li&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;&amp;lt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;%&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;ul&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;nav&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åé¢åŠ å…¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;nav&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; æ€»æ–‡ç« æ•° &amp;lt;%=site.posts.length%&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;/nav&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ·»åŠ è¯„è®ºç³»ç»Ÿ
yiliaé»˜è®¤å¸¦äº†å‡ ä¸ªç³»ç»Ÿï¼Œä½†æˆ‘æ˜¯ä»nextè¿™ä¸ªä¸»é¢˜è½¬è¿‡æ¥çš„ï¼Œä¹‹å‰ç”¨çš„æ˜¯æ¥å¿…åŠ›(livere)ï¼Œä¸æƒ³æ¢äº†ï¼Œå°±å¾—æ‰‹åŠ¨åœ¨yiliaé‡Œé¢åŠ ã€‚
é¦–å…ˆæ˜¯å»æ³¨å†Œlivereï¼Œç„¶åè·å–åˆ°è‡ªå·±çš„id
æ–°å»ºthemes\yilia\layout_partial\comment\livere.ejs
å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-gdscript3" data-lang="gdscript3"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;&amp;lt;!--&lt;/span&gt; &lt;span class="err"&gt;æ¥å¿…åŠ›&lt;/span&gt;&lt;span class="n"&gt;Cityç‰ˆå®‰è£…ä»£ç &lt;/span&gt; &lt;span class="o"&gt;--&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;div&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;lv-container&amp;#34;&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;city&amp;#34;&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;uid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&amp;lt;%=theme.livere_uid%&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;script&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;text/javascript&amp;#34;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;var&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getElementsByTagName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;typeof&lt;/span&gt; &lt;span class="n"&gt;LivereTower&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;function&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://cdn-city.livere.com/js/embed.dist.js&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parentNode&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;insertBefore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;})(&lt;/span&gt;&lt;span class="n"&gt;document&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;script&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;script&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;noscript&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="err"&gt;ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»&lt;/span&gt;&lt;span class="n"&gt;JavaScript&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;noscript&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;div&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;&amp;lt;!--&lt;/span&gt; &lt;span class="n"&gt;Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ&lt;/span&gt; &lt;span class="o"&gt;--&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶åç¼–è¾‘themes\yilia\layout_partial\article.ejs
æ‰¾åˆ°è¿™å¥è¯ï¼š&lt;code&gt;&amp;lt;% if (!index &amp;amp;&amp;amp; post.comments){ %&amp;gt;&lt;/code&gt;
åœ¨ä¸‹é¢ç›´æ¥åŠ å…¥ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;% if (theme.livere){ %&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;%- partial(&amp;#39;comment/livere&amp;#39;, {
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;key: post.slug,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;title: post.title,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;url: config.url+url_for(post.path)
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;}) %&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;% } %&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ„æ€å°±æ˜¯å¦‚æœä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­æœ‰livereè¿™ä¸ªå˜é‡ï¼Œä¸”ä¸ä¸ºfalseï¼Œé‚£å°±åœ¨ä¸‹é¢åŠ å…¥comment/livere.ejsé‡Œé¢çš„å†…å®¹
æ‰€ä»¥æ¥ä¸‹æ¥éœ€è¦åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶(themes\yilia_config.yml)ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;livere: true
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;livere_uid: ä½ çš„id
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ·»åŠ å­—æ•°ç»Ÿè®¡
é¦–å…ˆéœ€è¦å®‰è£…&lt;a class="link" href="https://github.com/willin/hexo-wordcount" target="_blank" rel="noopener"
&gt;hexo-wordcount&lt;/a&gt;
ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;npm i --save hexo-wordcount
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id="node-ç‰ˆæœ¬760ä¹‹å‰è¯·å®‰è£…-2x-ç‰ˆæœ¬-nodejs-v760-and-previous"&gt;Node ç‰ˆæœ¬7.6.0ä¹‹å‰,è¯·å®‰è£… 2.x ç‰ˆæœ¬ (Node.js v7.6.0 and previous)
&lt;/h1&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;npm install hexo-wordcount@2 --save
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶ååœ¨themes\yilia\layout_partial\left-col.ejsä¸­æ·»åŠ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;æ€»å­—æ•° &amp;lt;span class=&amp;#34;post-count&amp;#34;&amp;gt;&amp;lt;%= totalcount(site, &amp;#39;0,0.0a&amp;#39;) %&amp;gt;&amp;lt;/span&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¼–è¾‘themes\yilia\layout_partial\article.ejs
åœ¨headerä¸‹é¢åŠ å…¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;div align=&amp;#34;center&amp;#34; class=&amp;#34;post-count&amp;#34;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; å­—æ•°ï¼š&amp;lt;%= wordcount(post.content) %&amp;gt;å­— | é¢„è®¡é˜…è¯»æ—¶é•¿ï¼š&amp;lt;%= min2read(post.content) %&amp;gt;åˆ†é’Ÿ
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;/div&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å³å¯æ˜¾ç¤ºå•ç¯‡å­—æ•°å’Œé¢„è®¡é˜…è¯»æ—¶é•¿ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…³äºè®¿é—®litten.me:9005çš„é—®é¢˜ï¼Œè¿™ä¸ªä¸»é¢˜çš„ä½œè€…ä¹‹å‰ä¸ºäº†æ›´å¥½åœ°å®Œå–„è¿™ä¸ªä¸»é¢˜ï¼Œæœ‰æ—¶å€™ä¼šæ”¶é›†ç”¨æˆ·çš„å®¢æˆ·ç«¯ä¿¡æ¯ï¼Œè¯¦æƒ…è¯·è§&lt;a class="link" href="https://github.com/litten/hexo-theme-yilia/issues/528" target="_blank" rel="noopener"
&gt;https://github.com/litten/hexo-theme-yilia/issues/528&lt;/a&gt;ï¼Œå¦‚æœä¸æƒ³è¢«ç»Ÿè®¡ï¼Œå°±å°†themes\yilia\source-src\js\report.jsé‡Œé¢çš„å†…å®¹æ¸…ç©ºï¼Œä¸è¿‡è¿™ä¸ªè¯·æ±‚æ˜¯å¼‚æ­¥çš„ï¼Œä¸ä¼šå½±å“åšå®¢åŠ è½½é€Ÿåº¦ï¼Œè€Œä¸”ä½œè€…å·²ç»ä¸ç»´æŠ¤äº†ï¼Œæ‰€ä»¥å…³ä¸å…³éƒ½è¡Œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>Graph Attention Networks</title><link>https://davidham3.github.io/blog/p/graph-attention-networks/</link><pubDate>Fri, 13 Jul 2018 16:54:31 +0000</pubDate><guid>https://davidham3.github.io/blog/p/graph-attention-networks/</guid><description>&lt;p&gt;ICLR 2018ã€‚å›¾æ³¨æ„åŠ›ç½‘ç»œï¼Œä½¿ç”¨ self-attention æ¥æ„å»º graph attentional layerï¼Œattention ä¼šè€ƒè™‘å½“å‰é¡¶ç‚¹æ‰€æœ‰çš„é‚»å±…å¯¹å®ƒçš„é‡è¦æ€§ï¼ŒåŸºäºè°±å›¾ç†è®ºçš„æ¨¡å‹ä¸èƒ½åº”ç”¨åˆ°å…¶ä»–ä¸åŒç»“æ„çš„å›¾ä¸Šï¼Œè€Œè¿™ä¸ªåŸºäºattentionçš„æ–¹æ³•èƒ½æœ‰æ•ˆçš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1710.10903" target="_blank" rel="noopener"
&gt;Graph Attention Networks&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="æ‘˜è¦"&gt;æ‘˜è¦
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬æå‡ºäº†å›¾æ³¨æ„åŠ›ç½‘ç»œ(GAT)ï¼Œæ–°å‹å›¾ç¥ç»ç½‘ç»œï¼Œåˆ©ç”¨è‡ªæ³¨æ„åŠ›å±‚è§£å†³åŸºäºå›¾å·ç§¯åŠå…¶ç›¸ä¼¼æ–¹æ³•çš„ç¼ºç‚¹ã€‚é€šè¿‡å †å è¿™ç§å±‚ï¼ˆå±‚ä¸­çš„é¡¶ç‚¹ä¼šæ³¨æ„é‚»å±…çš„ç‰¹å¾ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç»™é‚»å±…ä¸­çš„é¡¶ç‚¹æŒ‡å®šä¸åŒçš„æƒé‡ï¼Œä¸éœ€è¦ä»»ä½•ä¸€ç§è€—æ—¶çš„çŸ©é˜µæ“ä½œï¼ˆæ¯”å¦‚æ±‚é€†ï¼‰æˆ–ä¾èµ–å›¾ç»“æ„çš„å…ˆéªŒçŸ¥è¯†ã€‚æˆ‘ä»¬åŒæ—¶è§£å†³äº†åŸºäºè°±çš„å›¾ç¥ç»ç½‘ç»œçš„å‡ ä¸ªå…³é”®æŒ‘æˆ˜ï¼Œå¹¶ä¸”ä½¿æˆ‘ä»¬çš„æ¨¡å‹å¾ˆè½»æ¾çš„åº”ç”¨åœ¨ inductive æˆ– transductive é—®é¢˜ä¸Šã€‚æˆ‘ä»¬çš„ GAT æ¨¡å‹åœ¨4ä¸ª transductive å’Œ inductive å›¾æ•°æ®é›†ä¸Šè¾¾åˆ°ä¸”åŒ¹æ•Œå½“å‰æœ€å…ˆè¿›çš„ç®—æ³•ï¼š&lt;em&gt;Cora&lt;/em&gt;, &lt;em&gt;Citeseer&lt;/em&gt;, &lt;em&gt;Pubmed citation networks&lt;/em&gt;ï¼Œ&lt;em&gt;protein-protin interaction&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 INTRODUCTION
&lt;/h1&gt;&lt;p&gt;CNN ç»“æ„å¯ä»¥æœ‰æ•ˆçš„é‡å¤ä½¿ç”¨å·ç§¯æ ¸ï¼Œåœ¨ç½‘æ ¼å‹çš„æ•°æ®ä¸Šåº”ç”¨ã€‚ç„¶è€Œå¾ˆå¤šé—®é¢˜éƒ½æ˜¯åŸºäºå›¾ç»“æ„çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ—©æœŸçš„å·¥ä½œä½¿ç”¨RNNæ¥å¤„ç†å›¾ç»“æ„ä¸­æ•°æ®çš„è¡¨ç¤ºã€‚2005 å¹´å’Œ 2009 å¹´æå‡ºäº† GNNï¼ˆGraph Neural Networksï¼‰çš„æ¦‚å¿µï¼Œä½œä¸º RNN çš„æ³›åŒ–ï¼Œå¯ä»¥ç›´æ¥å¤„ç†æ›´ä¸€èˆ¬çš„å›¾ç»“æ„ï¼Œæ¯”å¦‚å¸¦ç¯å›¾ã€æœ‰å‘ã€æ— å‘å›¾ã€‚GCN åŒ…å«äº†è¿­ä»£çš„è¿‡ç¨‹ï¼Œè¿­ä»£æ—¶é¡¶ç‚¹çŠ¶æ€å‘å‰ä¼ æ’­ï¼Œåé¢ä½¿ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œæ¥äº§ç”Ÿè¾“å‡ºã€‚Li et al., 2016ä½¿ç”¨äº†Cho et al., 2014æå‡ºçš„é—¨æ§å¾ªç¯å•å…ƒè¿›è¡Œæ”¹è¿›ã€‚&lt;/p&gt;
&lt;p&gt;è¿›ä¸€æ­¥çš„ç ”ç©¶åˆ†ä¸ºè°±æ–¹æ³•å’Œéè°±æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ–¹é¢ï¼Œè°±æ–¹æ³•ä½¿ç”¨å›¾çš„è°±è¡¨ç¤ºï¼ŒæˆåŠŸåº”ç”¨åˆ°äº†é¡¶ç‚¹åˆ†ç±»çš„é—®é¢˜ä¸Šã€‚Bruna et al., 2014åœ¨å‚…é‡Œå¶åŸŸä¸­å®šä¹‰äº†å·ç§¯æ“ä½œï¼Œé€šè¿‡è®¡ç®—æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å€¼åˆ†è§£ï¼Œç”±äºæ½œåœ¨çš„å¤§é‡çš„è®¡ç®—ï¼Œå¼•å‡ºäº†åç»­çš„éè°±æ–¹æ³•ã€‚Henaff et al., 2015å¼•å…¥äº†å¸¦æœ‰ smooth coefficients çš„è°±æ»¤æ³¢å™¨ï¼Œå¯ä»¥ä½¿ä»–ä»¬åœ¨ç©ºé—´å±€éƒ¨åŒ–ã€‚åæ¥ Defferrard et al., 2016 æå‡ºäº†é€šè¿‡æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼å±•å¼€çš„è¿‘ä¼¼è¡¨è¾¾ã€‚æœ€åï¼ŒKipf &amp;amp; Welling 2017 é€šè¿‡é™åˆ¶æ»¤æ³¢å™¨åªè€ƒè™‘ 1 é˜¶é‚»å±…ä»è€Œç®€åŒ–äº†ä¹‹å‰çš„æ–¹æ³•ã€‚ç„¶è€Œï¼Œå‰é¢æåˆ°çš„æ‰€æœ‰çš„è°±æ–¹æ³•ï¼Œå­¦ä¹ åˆ°çš„å·ç§¯æ ¸å‚æ•°éƒ½ä¾èµ–äºæ‹‰æ™®æ‹‰æ–¯ç‰¹å¾å€¼åˆ†è§£åçš„ç‰¹å¾å‘é‡ï¼Œä¹Ÿå°±æ˜¯è¯´ä¾èµ–äºå›¾ç»“æ„ã€‚å› æ­¤ï¼Œè®­ç»ƒåœ¨ä¸€ä¸ªæŒ‡å®šå›¾ç»“æ„çš„æ¨¡å‹ä¸èƒ½åº”ç”¨åˆ°ä¸åŒç»“æ„çš„å›¾ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€æ–¹é¢ï¼Œè¿˜æœ‰ä¸€äº›éè°±æ–¹æ³• (Duvenaud et al., 2015; Atwood &amp;amp; Towsley, 2016; Hamilton et al., 2017)ï¼Œè¿™äº›æ–¹æ³•ç›´æ¥åœ¨å›¾ä¸Šå®šä¹‰å·ç§¯æ“ä½œï¼Œç›´æ¥åœ¨ç©ºé—´ä¸Šç›¸è¿‘çš„é‚»å±…ä¸Šåº”ç”¨å·ç§¯æ“ä½œã€‚è¿™äº›æ–¹æ³•çš„ä¸€ä¸ªæŒ‘æˆ˜æ˜¯éœ€è¦å®šä¹‰ä¸€ä¸ªèƒ½å¤„ç†ä¸åŒæ•°é‡é‚»å±…çš„å·ç§¯æ“ä½œï¼Œå¹¶ä¸”ä¿è¯ CNN æƒé‡å…±äº«çš„æ€§è´¨ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™éœ€è¦å­¦ä¹ ä¸ºæ¯ä¸ª node degree å­¦ä¹ ä¸€ä¸ªæƒé‡çŸ©é˜µ (Duvenaud et al., 2015)ï¼Œåœ¨å¯¹æ¯ä¸ª input channel å’Œ neighborhood degree è®­ç»ƒæƒé‡æ—¶ï¼Œä½¿ç”¨è½¬ç§»çŸ©é˜µçš„å¹‚å®šä¹‰é‚»å±… (Atwood &amp;amp; Towsley, 2016)ï¼Œæˆ–æ˜¯å¯¹æœ‰ç€å›ºå®šæ•°é‡é¡¶ç‚¹çš„é‚»å±…è¿›è¡Œæå–å’Œå½’ä¸€åŒ–(Niepert et al., 2016)ã€‚Monti et al., 2016æå‡ºäº†æ··åˆæ¨¡å‹ CNNï¼Œ(MoNet)ï¼Œè¿™ä¸ªç©ºé—´æ–¹æ³•æä¾›äº†ä¸€ä¸ª CNN åœ¨å›¾ä¸Šæ³›åŒ–çš„ç»Ÿä¸€çš„æ¨¡å‹ã€‚æœ€è¿‘ï¼ŒHamilton et al., 2017æå‡ºäº† GraphSAGEï¼Œå¯¹æ¯ä¸ªé¡¶ç‚¹é‡‡æ ·é‡‡å‡ºä¸€ä¸ªå›ºå®šæ•°é‡çš„é‚»å±…ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªæŒ‡å®šçš„èšåˆæ“ä½œèšé›†ä»–ä»¬ï¼ˆæ¯”å¦‚å–æ‰€æœ‰é‡‡æ ·é‚»å±…çš„å‡å€¼ï¼Œæˆ–æ˜¯å°†ä»–ä»¬æ”¾è¿›RNNåäº§ç”Ÿçš„ç»“æœï¼‰ã€‚è¿™ä¸ªæ–¹æ³•åœ¨å‡ ä¸ªå¤§è§„æ¨¡çš„ inductive æ•°æ®é›†ä¸Šè·å¾—äº†å¾ˆæƒŠäººçš„æ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åŠ›æœºåˆ¶åœ¨å¾ˆå¤šåŸºäºåºåˆ—çš„ä»»åŠ¡ä¸­å·²ç»æˆä¸ºäº†ä¸€ä¸ªæ ‡å‡† (Bahdanau et al., 2015; Gehring et al., 2016)ã€‚æ³¨æ„åŠ›æœºåˆ¶çš„ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥å¤„ç†å˜é•¿è¾“å…¥ï¼Œä¸“æ³¨äºè¾“å…¥ä¸­æœ€ç›¸å…³çš„éƒ¨åˆ†æ¥åšå†³ç­–ã€‚ä½¿ç”¨æ³¨æ„åŠ›æœºåˆ¶è®¡ç®—ä¸€ä¸ªåºåˆ—çš„è¡¨ç¤ºæ—¶ï¼Œä¸€èˆ¬æåˆ°çš„æ˜¯ &lt;em&gt;self-attention&lt;/em&gt; æˆ– &lt;em&gt;intra-attention&lt;/em&gt;ã€‚ä¸ RNN æˆ–å·ç§¯ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œself-attention åœ¨æœºå™¨é˜…è¯»(Cheng et al., 2016)å’Œå­¦ä¹ å¥å­è¡¨ç¤º(Lin et al., 2017)è¿™äº›ä»»åŠ¡ä¸Šå¾ˆæœ‰ç”¨ã€‚ç„¶è€Œï¼ŒVaswani et al., 2017çš„ç ”ç©¶è¡¨æ˜ï¼Œself-attention ä¸ä»…å¯ä»¥æå‡ RNN å’Œå·ç§¯çš„æ¨¡å‹ï¼Œåœ¨æœºå™¨ç¿»è¯‘ä»»åŠ¡ä¸Šä¹Ÿæ˜¯å¯ä»¥æ„å»ºå‡ºæ€§èƒ½æœ€å¼ºçš„æ¨¡å‹çš„ã€‚&lt;/p&gt;
&lt;p&gt;å—æœ€è¿‘å·¥ä½œçš„å¯å‘ï¼Œæˆ‘ä»¬æå‡ºäº†åŸºäº attention çš„æ¶æ„å¯¹å›¾ç»“æ„çš„é¡¶ç‚¹è¿›è¡Œåˆ†ç±»ã€‚æ€è·¯æ˜¯é€šè¿‡å¯¹é¡¶ç‚¹é‚»å±…çš„æ³¨æ„ï¼Œè®¡ç®—å›¾ä¸­æ¯ä¸ªé¡¶ç‚¹çš„è¡¨ç¤ºï¼Œç„¶åä½¿ç”¨ä¸€ä¸ª self-attention æœºåˆ¶ã€‚æ³¨æ„åŠ›æ¶æ„æœ‰å‡ ä¸ªæœ‰è¶£çš„æ€§è´¨ï¼š(1) æ“ä½œé«˜æ•ˆï¼Œå› ä¸ºå®ƒå¯ä»¥â€œé¡¶ç‚¹-é‚»å±…â€å¯¹ä¸Šå¹¶è¡Œè®¡ç®—ï¼›(2) é€šè¿‡æŒ‡å®šå¯¹é‚»å±…ä»»æ„çš„æƒé‡ï¼Œå®ƒå¯ä»¥åœ¨æœ‰ç€ä¸åŒåº¦çš„é¡¶ç‚¹ä¸Šä½¿ç”¨ï¼›(3) æ¨¡å‹å¯ä»¥ç›´æ¥åº”ç”¨åœ¨ inductive learning ä»»åŠ¡ä¸Šï¼ŒåŒ…æ‹¬æ¨¡å‹å¿…é¡»è¦ç”Ÿæˆå®Œæ•´çš„æœªè§è¿‡çš„å›¾ç­‰ä»»åŠ¡ã€‚æˆ‘ä»¬åœ¨4ä¸ª benchmark ä¸ŠéªŒè¯äº†æˆ‘ä»¬çš„æ–¹æ³•ï¼š&lt;em&gt;Cora&lt;/em&gt;ï¼Œ&lt;em&gt;Citeseer&lt;/em&gt;ï¼Œ&lt;em&gt;Pubmed citation networks&lt;/em&gt;ï¼Œ&lt;em&gt;protein-protein interaction&lt;/em&gt;ï¼Œè·å¾—äº†æ¯”è‚© state-of-the-art çš„ç»“æœï¼Œå±•ç°äº†åŸºäº attention çš„æ¨¡å‹åœ¨å¤„ç†ä»»æ„ç»“æ„çš„å›¾çš„å¯èƒ½æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚ Kipf &amp;amp; Welling 2017å’ŒAtwood &amp;amp; Towsley 2016ï¼Œæˆ‘ä»¬çš„å·¥ä½œå¯ä»¥é‡å†™ä¸º MoNet(Monti et al., 2016)çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚é™¤æ­¤ä»¥å¤–ï¼Œæˆ‘ä»¬çš„åˆ†äº«ç¥ç»ç½‘ç»œè·¨è¾¹è®¡ç®—æ—¶æ˜¯å¯¹å…³ç³»ç½‘ç»œå…¬å¼çš„è”æƒ³(Santoro et al., 2017)å’ŒVAIN(Hoshen, 2017)ï¼Œåœ¨è¿™ä¸¤ç¯‡æ–‡ç« ä¸­ï¼Œobject å’Œ agent é—´çš„å…³ç³»è¢«èšåˆæˆå¯¹ï¼Œé€šè¿‡ä½¿ç”¨ä¸€ç§å…±äº«æœºåˆ¶ã€‚ç›¸ä¼¼åœ°ï¼Œæˆ‘ä»¬çš„æ³¨æ„åŠ›æ¨¡å‹å¯ä»¥ä¸ Duan et al., 2017 å’Œ Denil et al., 2017 çš„å·¥ä½œç›¸è¿ï¼Œä»–ä»¬ä½¿ç”¨ä¸€ä¸ªé‚»å±…æ³¨æ„åŠ›æ“ä½œæ¥è®¡ç®—ç¯å¢ƒä¸­ä¸åŒ object çš„æ³¨æ„åŠ›ç³»æ•°ã€‚å…¶ä»–ç›¸å…³çš„æ–¹æ³•åŒ…æ‹¬å±€éƒ¨çº¿æ€§åµŒå…¥(LLE)(Roweis &amp;amp; Saul, 2000)å’Œè®°å¿†ç½‘ç»œ(Weston et al., 2014)ã€‚LLE åœ¨æ¯ä¸ªæ•°æ®ç‚¹é€‰æ‹©äº†å›ºå®šæ•°é‡çš„é‚»å±…ï¼Œä¸ºæ¯ä¸ªé‚»å±…å­¦ä¹ äº†æƒé‡ç³»æ•°ï¼Œä»¥æ­¤å°†æ¯ä¸ªæ•°æ®ç‚¹é‡æ„ä¸ºé‚»å±…çš„åŠ æƒä¹‹å’Œã€‚ä¹‹åçš„ä¼˜åŒ–æå–äº†é¡¶ç‚¹åµŒå…¥çš„ç‰¹å¾ã€‚è®°å¿†ç½‘ç»œä¸æˆ‘ä»¬çš„å·¥ä½œä¹Ÿæœ‰å…³ç³»ï¼Œå¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ªé¡¶ç‚¹çš„é‚»å±…è§£é‡Šä¸ºè®°å¿†ï¼Œé€šè¿‡æ³¨æ„å®ƒçš„å€¼å¯ä»¥è®¡ç®—é¡¶ç‚¹ç‰¹å¾ï¼Œä¹‹åé€šè¿‡åœ¨åŒæ ·çš„ä½ç½®å­˜å‚¨æ–°ç‰¹å¾è¿›è¡Œæ›´æ–°ã€‚&lt;/p&gt;
&lt;h1 id="2-gat-architecture"&gt;2 GAT ARCHITECTURE
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬ä¼šåœ¨è¿™éƒ¨åˆ†æè¿°å¦‚ä½•åˆ›å»º block layer æ¥æ„é€ ä»»æ„çš„ graph attention networksï¼Œå¹¶ä¸”æŒ‡æ˜ç†è®ºå’Œå®é™…ä¸Šçš„ä¼˜ç‚¹ä»¥åŠç›¸æ¯”äºä¹‹å‰åœ¨ç¥ç»å›¾å¤„ç†ä¸Šçš„å·¥ä½œçš„ç¼ºç‚¹ã€‚&lt;/p&gt;
&lt;h2 id="21-graph-attentional-layer"&gt;2.1 Graph Attentional Layer
&lt;/h2&gt;&lt;p&gt;é¦–å…ˆæè¿°å•ä¸ª graph attentional layerï¼Œå› ä¸ºè¿™ç§å±‚ä¼šåœ¨æ•´ä¸ª GAT æ¶æ„ä¸­ä½¿ç”¨ã€‚æˆ‘ä»¬ä½¿ç”¨çš„ attention å’Œ Bahdanau et al., 2015 çš„å·¥ä½œç›¸ä¼¼ã€‚&lt;/p&gt;
&lt;p&gt;è¾“å…¥æ˜¯ä¸€ç»„é¡¶ç‚¹ç‰¹å¾ï¼Œ${\mathbf{h}} = \lbrace \vec{h}_1, \vec{h}_2, &amp;hellip;, \vec{h}_N \rbrace , \vec{h}_i \in \mathbb{R}^F$ï¼Œå…¶ä¸­ $N$ æ˜¯é¡¶ç‚¹æ•°ï¼Œ$F$ æ˜¯æ¯ä¸ªé¡¶ç‚¹çš„ç‰¹å¾æ•°ã€‚è¿™ä¸ªå±‚ä¼šç”Ÿæˆä¸€ç»„æ–°çš„é¡¶ç‚¹ç‰¹å¾ï¼Œ${\mathbf{h}&amp;rsquo;} = \lbrace \vec{h}&amp;rsquo;_1, \vec{h}&amp;rsquo;_2, &amp;hellip;, \vec{h}&amp;rsquo;_N\rbrace , \vec{h}&amp;rsquo;_i \in \mathbb{R}^{F&amp;rsquo;}$ï¼Œä½œä¸ºè¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†åœ¨å°†è¾“å…¥ç‰¹å¾å˜æ¢åˆ°é«˜ç»´ç‰¹å¾æ—¶è·å¾—å……è¶³çš„è¡¨ç°åŠ›ï¼Œè‡³å°‘éœ€è¦ä¸€ä¸ªå¯å­¦ä¹ çš„çº¿æ€§å˜æ¢ã€‚ä¸ºäº†åˆ°è¾¾è¿™ä¸ªç›®çš„ï¼Œæ¯ä¸ªé¡¶ç‚¹éƒ½ä¼šä½¿ç”¨ä¸€ä¸ªå…±äº«å‚æ•°çš„çº¿æ€§å˜æ¢ï¼Œå‚æ•°ä¸º ${\mathbf{W}} \in \mathbb{R}^{F&amp;rsquo; \times F}$ã€‚ç„¶ååœ¨æ¯ä¸ªé¡¶ç‚¹ä¸Šåšä¸€ä¸ª self-attention â€”â€”ä¸€ä¸ªå…±äº«çš„attentionæœºåˆ¶ $a : \mathbb{R}^{F&amp;rsquo;} \times \mathbb{R}^{F&amp;rsquo;} \rightarrow \mathbb{R}$ æ¥è®¡ç®—æ³¨æ„åŠ›åˆ†æ•° &lt;em&gt;attention coefficients&lt;/em&gt;ï¼š&lt;/p&gt;
$$\tag{1}
e\_{ij} = a(\mathbf{W} \vec{h}\_i, \mathbf{W} \vec{h}\_j)
$$&lt;p&gt;è¡¨ç¤ºé¡¶ç‚¹ $j$ çš„ç‰¹å¾å¯¹é¡¶ç‚¹ $i$ çš„é‡è¦æ€§(&lt;em&gt;importance&lt;/em&gt;)ã€‚åœ¨ä¸€èˆ¬çš„å…¬å¼ä¸­ï¼Œæ¨¡å‹å¯ä»¥ä½¿æ¯ä¸ªé¡¶ç‚¹éƒ½æ³¨æ„å…¶ä»–çš„æ¯ä¸ªé¡¶ç‚¹ï¼Œæ‰”æ‰æ‰€æœ‰çš„ç»“æ„ä¿¡æ¯ã€‚æˆ‘ä»¬ä½¿ç”¨ &lt;em&gt;mask attention&lt;/em&gt; ä½¿å¾—å›¾ç»“æ„å¯ä»¥æ³¨å…¥åˆ°æ³¨æ„åŠ›æœºåˆ¶ä¸­â€”â€”æˆ‘ä»¬åªå¯¹é¡¶ç‚¹ $j \in \mathcal{N_i}$ è®¡ç®—$e_{ij}$ï¼Œå…¶ä¸­$\mathcal{N_i}$ æ˜¯é¡¶ç‚¹ $i$ åœ¨å›¾ä¸­çš„ä¸€äº›é‚»å±…ã€‚åœ¨æˆ‘ä»¬æ‰€æœ‰çš„å®éªŒä¸­ï¼Œè¿™äº›æ˜¯ $i$ çš„ä¸€é˜¶é‚»å±…ï¼ˆåŒ…æ‹¬ $i$ ï¼‰ã€‚ä¸ºäº†è®©ç³»æ•°åœ¨ä¸åŒçš„é¡¶ç‚¹éƒ½å¯æ¯”ï¼Œæˆ‘ä»¬å¯¹æ‰€æœ‰çš„ $j$ ä½¿ç”¨ softmax è¿›è¡Œäº†å½’ä¸€åŒ–ï¼š&lt;/p&gt;
$$\tag{2}
\alpha\_{ij} = \mathrm{softmax}\_j (e\_{ij}) = \frac{\exp{e\_{ij}}}{\sum\_{k \in \mathcal{N}\_i} \exp{e\_{ik}}}
$$&lt;div align="center"&gt;![Figure1](/blog/images/graph-attention-networks/Fig1.JPG)&lt;/div&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çš„å®éªŒä¸­ï¼Œæ³¨æ„åŠ›æœºåˆ¶ $a$ æ˜¯ä¸€ä¸ªå•å±‚çš„å‰å‘ä¼ æ’­ç½‘ç»œï¼Œå‚æ•°ä¸ºæƒé‡å‘é‡ $\vec{\text{a}} \in \mathbb{R}^{2F&amp;rsquo;}$ï¼Œä½¿ç”¨LeakyReLUä½œä¸ºéçº¿æ€§å±‚ï¼ˆæ–œç‡$\alpha = 0.2$ï¼‰ã€‚æ•´ä¸ªåˆå¹¶èµ·æ¥ï¼Œæ³¨æ„åŠ›æœºåˆ¶è®¡ç®—å‡ºçš„åˆ†æ•°ï¼ˆå¦‚å›¾1å·¦ä¾§æ‰€ç¤ºï¼‰è¡¨ç¤ºä¸ºï¼š&lt;/p&gt;
$$\tag{3}
\alpha\_{ij} = \frac{ \exp{ ( \mathrm{LeakyReLU} ( \vec{\text{a}}^T [\mathbf{W} \vec{h}\_i \Vert \mathbf{W} \vec{h}\_j ] ))}}{\sum\_{k \in \mathcal{N\_i}} \exp{(\mathrm{LeakyReLU}(\vec{\text{a}}^T [\mathbf{W} \vec{h}\_i \Vert \mathbf{W} \vec{h}\_k]))}}
$$&lt;p&gt;å…¶ä¸­ $Â·^T$ è¡¨ç¤ºè½¬ç½®ï¼Œ$\Vert$ è¡¨ç¤ºconcatenationæ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;å¾—åˆ°å½’ä¸€åŒ–çš„åˆ†æ•°åï¼Œä½¿ç”¨å½’ä¸€åŒ–çš„åˆ†æ•°è®¡ç®—å¯¹åº”ç‰¹å¾çš„çº¿æ€§ç»„åˆï¼Œä½œä¸ºæ¯ä¸ªé¡¶ç‚¹æœ€åçš„è¾“å‡ºç‰¹å¾ï¼ˆæœ€åå¯ä»¥åŠ ä¸€ä¸ªéçº¿æ€§å±‚ï¼Œ$\sigma$ï¼‰ï¼š&lt;/p&gt;
$$\tag{4}
\vec{h}'\_i = \sigma(\sum\_{j \in \mathcal{N}\_i} \alpha\_{ij} \mathbf{W} \vec{h}\_j)
$$&lt;p&gt;ä¸ºäº†ç¨³å®š self-attention çš„å­¦ä¹ è¿‡ç¨‹ï¼Œæˆ‘ä»¬å‘ç°ä½¿ç”¨ &lt;em&gt;multi-head attention&lt;/em&gt; æ¥æ‰©å±•æˆ‘ä»¬çš„æ³¨æ„åŠ›æœºåˆ¶æ˜¯å¾ˆæœ‰æ•ˆçš„ï¼Œå°±åƒ Vaswani et al., 2017ã€‚ç‰¹åˆ«åœ°ï¼Œ$K$ ä¸ªç‹¬ç«‹çš„ attention æœºåˆ¶æ‰§è¡Œ å¼4 è¿™æ ·çš„å˜æ¢ï¼Œç„¶åä»–ä»¬çš„ç‰¹å¾è¿(concatednated)åœ¨ä¸€èµ·ï¼Œå°±å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„è¾“å‡ºï¼š&lt;/p&gt;
$$\tag{5}
\vec{h}'\_i = \Vert^{K}\_{k=1} \sigma(\sum\_{j \in \mathcal{N}\_i} \alpha^k\_{ij} \mathbf{W}^k \vec{h}\_j)
$$&lt;p&gt;å…¶ä¸­ $\Vert$ è¡¨ç¤ºconcatenationï¼Œ$\alpha^k_{ij}$ æ˜¯é€šè¿‡ç¬¬ $k$ ä¸ªæ³¨æ„åŠ›æœºåˆ¶ $(a^k)$ è®¡ç®—å‡ºçš„å½’ä¸€åŒ–çš„æ³¨æ„åŠ›åˆ†æ•°ï¼Œ$\mathbf{W}^k$ æ˜¯å¯¹åº”çš„è¾“å…¥çº¿æ€§å˜æ¢çš„æƒé‡çŸ©é˜µã€‚æ³¨æ„ï¼Œåœ¨è¿™é‡Œï¼Œæœ€åçš„è¿”å›è¾“å‡º $\mathbf{h}&amp;rsquo;$ï¼Œæ¯ä¸ªé¡¶ç‚¹éƒ½ä¼šæœ‰ $KF&amp;rsquo;$ ä¸ªç‰¹å¾ï¼ˆä¸æ˜¯ $F&amp;rsquo;$ ï¼‰ã€‚
ç‰¹åˆ«åœ°ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ç½‘ç»œçš„æœ€åä¸€å±‚ä½¿ç”¨ multi-head attentionï¼Œconcatenation å°±ä¸å†å¯è¡Œäº†ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ &lt;em&gt;averaging&lt;/em&gt;ï¼Œå¹¶ä¸”å»¶è¿Ÿä½¿ç”¨æœ€åçš„éçº¿æ€§å±‚ï¼ˆåˆ†ç±»é—®é¢˜é€šå¸¸æ˜¯ softmax æˆ– sigmoid ï¼‰ï¼š&lt;/p&gt;
$$
\vec{h}'\_i = \sigma(\frac{1}{K} \sum^K\_{k=1} \sum\_{j \in \mathcal{N}\_i} \alpha^k\_{ij} \mathbf{W}^k \vec{h}\_j)
$$&lt;p&gt;multi-head å›¾æ³¨æ„åŠ›å±‚çš„èšåˆè¿‡ç¨‹å¦‚å›¾1å³ä¾§æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;h2 id="22-comparisons-to-related-work"&gt;2.2 Comparisons to related work
&lt;/h2&gt;&lt;p&gt;2.1èŠ‚æè¿°çš„å›¾æ³¨æ„åŠ›å±‚ç›´æ¥è§£å†³äº†ä¹‹å‰åœ¨å›¾ç»“æ„ä¸Šä½¿ç”¨ç¥ç»ç½‘ç»œå»ºæ¨¡çš„æ–¹æ³•çš„å‡ ä¸ªé—®é¢˜ï¼š
Â· è®¡ç®—é«˜æ•ˆï¼šself-attentionå±‚çš„æ“ä½œå¯ä»¥åœ¨æ‰€æœ‰çš„è¾¹ä¸Šå¹¶è¡Œï¼Œè¾“å‡ºç‰¹å¾çš„è®¡ç®—å¯ä»¥åœ¨æ‰€æœ‰é¡¶ç‚¹ä¸Šå¹¶è¡Œã€‚æ²¡æœ‰è€—æ—¶çš„ç‰¹å¾å€¼åˆ†è§£ã€‚å•ä¸ªçš„GATè®¡ç®—$F&amp;rsquo;$ä¸ªç‰¹å¾çš„æ—¶é—´å¤æ‚åº¦å¯ä»¥å‹ç¼©è‡³$O(\vert V \vert F F&amp;rsquo; + \vert E \vert F&amp;rsquo;)$ï¼Œ$F$æ˜¯è¾“å…¥çš„ç‰¹å¾æ•°ï¼Œ$\vert V \vert$å’Œ$\vert E \vert$æ˜¯å›¾ä¸­é¡¶ç‚¹æ•°å’Œè¾¹æ•°ã€‚å¤æ‚åº¦ä¸Kipf &amp;amp; Welling, 2017çš„GCNå·®ä¸å¤šã€‚å°½ç®¡ä½¿ç”¨multi-head attentionå¯ä»¥å¹¶è¡Œè®¡ç®—ï¼Œä½†ä¹Ÿä½¿å¾—å‚æ•°å’Œç©ºé—´å¤æ‚åº¦å˜æˆäº†$K$å€ã€‚
Â· å¯¹æ¯”GCNï¼Œæˆ‘ä»¬çš„æ¨¡å‹å…è®¸å¯¹é¡¶ç‚¹çš„åŒä¸€ä¸ªé‚»å±…åˆ†é…ä¸åŒçš„é‡è¦åº¦ï¼Œä½¿å¾—æ¨¡å‹èƒ½åŠ›ä¸Šæœ‰ä¸€ä¸ªé£è·ƒã€‚ä¸ä»…å¦‚æ­¤ï¼Œå¯¹å­¦ä¹ åˆ°çš„attentionalæƒé‡è¿›è¡Œåˆ†æå¯ä»¥å¾—åˆ°æ›´å¥½çš„è§£é‡Šæ€§ï¼Œå°±åƒæœºå™¨ç¿»è¯‘é¢†åŸŸä¸€æ ·ï¼ˆæ¯”å¦‚Bahdanau et al., 2015çš„å®šæ€§åˆ†æï¼‰ã€‚
Â· æ³¨æ„åŠ›æœºåˆ¶ä»¥ä¸€ç§å…±äº«çš„ç­–ç•¥åº”ç”¨åœ¨å›¾çš„æ‰€æœ‰çš„è¾¹ä¸Šï¼Œå› æ­¤å®ƒå¹¶ä¸éœ€è¦åœ¨ä¹‹å‰å°±éœ€è¦å¾—åˆ°æ•´ä¸ªå›¾ç»“æ„æˆ–æ˜¯æ‰€æœ‰çš„é¡¶ç‚¹çš„ç‰¹å¾ï¼ˆå¾ˆå¤šä¹‹å‰çš„æ–¹æ³•çš„ç¼ºé™·ï¼‰ã€‚å› æ­¤è¿™ä¸ªæ–¹æ³•æœ‰å‡ ä¸ªå½±å“ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å›¾ä¸éœ€è¦æ˜¯æ— å‘çš„ï¼ˆå¦‚æœè¾¹$j \rightarrow i$æ²¡æœ‰å‡ºç°ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠ›å¼ƒæ‰$\alpha_{ij}$çš„è®¡ç®—ï¼‰&lt;/li&gt;
&lt;li&gt;è¿™ä¸ªæ–¹æ³•å¯ä»¥ç›´æ¥åº”ç”¨åˆ°&lt;em&gt;inductive learning&lt;/em&gt;â€”â€”åŒ…æ‹¬åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­åœ¨å®Œå…¨æœªè§è¿‡çš„å›¾ä¸Šè¯„ä¼°æ¨¡å‹çš„ä»»åŠ¡ä¸Šã€‚æœ€è¿‘å‘è¡¨çš„Hamilton et al., 2017çš„inductiveæ–¹æ³•ä¸ºäº†ä¿æŒè®¡ç®—è¿‡ç¨‹çš„ä¸€è‡´æ€§ï¼Œå¯¹æ¯ä¸ªé¡¶ç‚¹é‡‡æ ·é‡‡äº†ä¸€ä¸ªå›ºå®šæ•°é‡çš„é‚»å±…ï¼›è¿™å°±ä½¿å¾—è¿™ä¸ªæ–¹æ³•åœ¨æ¨æ–­çš„æ—¶å€™ä¸èƒ½è€ƒè™‘æ‰€æœ‰çš„é‚»å±…ã€‚æ­¤å¤–ï¼Œåœ¨ä½¿ç”¨ä¸€ä¸ªåŸºäºLSTMçš„é‚»å±…èšåˆæ–¹å¼æ—¶ï¼ˆHochreiter &amp;amp; Schmidhuber, 1997ï¼‰ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨æŸäº›æ—¶å€™èƒ½è¾¾åˆ°æœ€å¥½çš„æ•ˆæœã€‚è¿™æ„å‘³ç€å­˜åœ¨é‚»å±…é—´å­˜åœ¨ä¸€ä¸ªä¸€è‡´çš„é¡¶ç‚¹åºåˆ—é¡ºåºï¼Œä½œè€…é€šè¿‡å°†éšæœºé¡ºåºçš„åºåˆ—è¾“å…¥è‡³LSTMæ¥éªŒè¯å®ƒçš„ä¸€è‡´æ€§ã€‚æˆ‘ä»¬çš„æ–¹æ³•ä¸ä¼šå—åˆ°è¿™äº›é—®é¢˜ä¸­ä»»æ„ä¸€ä¸ªçš„å½±å“â€”â€”å®ƒåœ¨æ‰€æœ‰çš„é‚»å±…ä¸Šè¿ç®—ï¼ˆè™½è¯´ä¼šæœ‰è®¡ç®—ä¸Šçš„å¼€é”€ï¼Œä½†æ‰”èƒ½å’ŒGCNè¿™æ ·çš„é€Ÿåº¦å·®ä¸å¤šï¼‰ï¼Œå¹¶ä¸”å‡è®¾ä»»æ„é¡ºåºéƒ½å¯ä»¥ã€‚
Â· å¦‚ç¬¬ä¸€èŠ‚æåˆ°çš„ï¼ŒGATå¯ä»¥é‡å†™æˆMoNet(Monti et al., 2016)çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚æ›´å…·ä½“çš„æ¥è¯´ï¼Œè®¾pseudo-coordinate functionä¸º$u(x, y) = f(x) \Vert f(y)$ï¼Œ$f(x)$è¡¨ç¤º$x$çš„ç‰¹å¾ï¼ˆå¯èƒ½æ˜¯MLPå˜æ¢åçš„ç»“æœï¼‰ï¼Œ$\Vert$è¡¨ç¤ºconcatenationï¼›æƒé‡å‡½æ•°ä¸º$w_j(u) = \mathrm{softmax}(\mathrm{MLP}(u))$ï¼ˆsoftmaxåœ¨ä¸€ä¸ªé¡¶ç‚¹æ‰€æœ‰çš„é‚»å±…ä¸Šè®¡ç®—ï¼‰ä¼šä½¿MoNetçš„patch operatorå’Œæˆ‘ä»¬çš„å¾ˆç›¸ä¼¼ã€‚å°½ç®¡å¦‚æ­¤ï¼Œéœ€è¦æ³¨æ„åˆ°çš„æ˜¯ï¼Œå¯¹æ¯”ä¹‹å‰MoNetçš„å®ä¾‹ï¼Œæˆ‘ä»¬çš„æ¨¡å‹ä½¿ç”¨é¡¶ç‚¹ç‰¹å¾è®¡ç®—ç›¸ä¼¼æ€§ï¼Œè€Œä¸æ˜¯é¡¶ç‚¹çš„ç»“æ„æ€§è´¨ï¼ˆè¿™éœ€è¦ä¹‹å‰å°±å·²ç»ç›´åˆ°å›¾ç»“æ„ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥åšå‡ºä¸€ç§ä½¿ç”¨ç¨€ç–çŸ©é˜µæ“ä½œçš„GATå±‚ï¼Œå°†ç©ºé—´å¤æ‚åº¦é™ä½åˆ°é¡¶ç‚¹å’Œè¾¹æ•°çš„çº¿æ€§çº§åˆ«ï¼Œä½¿å¾—GATæ¨¡å‹å¯ä»¥åœ¨æ›´å¤§çš„å›¾æ•°æ®é›†ä¸Šè¿è¡Œã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„tensoræ“ä½œæ¡†æ¶åªæ”¯æŒäºŒé˜¶tensorçš„ç¨€ç–çŸ©é˜µä¹˜æ³•ï¼Œé™åˆ¶äº†å½“å‰å®ç°çš„ç‰ˆæœ¬çš„æ¨¡å‹èƒ½åŠ›ï¼ˆå°¤å…¶åœ¨æœ‰å¤šä¸ªå›¾çš„æ•°æ®é›†ä¸Šï¼‰ã€‚è§£å†³è¿™ä¸ªé—®é¢˜æ˜¯æœªæ¥çš„ä¸€ä¸ªé‡è¦ç ”ç©¶æ–¹å‘ã€‚åœ¨è¿™äº›ä½¿ç”¨ç¨€ç–çŸ©é˜µçš„åœºæ™¯ä¸‹ï¼Œåœ¨æŸäº›å›¾ç»“æ„ä¸‹GPUçš„è¿ç®—å¹¶ä¸èƒ½æ¯”CPUå¿«å¤šå°‘ã€‚å¦ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯æˆ‘ä»¬çš„æ¨¡å‹çš„æ„Ÿå—é‡çš„å¤§å°çš„ä¸Šå±Šå–å†³äºç½‘ç»œçš„æ·±åº¦ï¼ˆä¸GCNå’Œå…¶ä»–æ¨¡å‹ç›¸ä¼¼ï¼‰ã€‚åƒskip connections(He et al., 2016)è¿™æ ·çš„æŠ€æœ¯å¯ä»¥æ¥è¿‘ä¼¼çš„æ‰©å±•æ¨¡å‹çš„æ·±åº¦ã€‚æœ€åï¼Œåœ¨æ‰€æœ‰è¾¹ä¸Šçš„å¹¶è¡Œè®¡ç®—ï¼Œå°¤å…¶æ˜¯åˆ†å¸ƒå¼çš„è®¡ç®—å¯ä»¥è®¾è®¡å¾ˆå¤šå†—ä½™çš„è®¡ç®—ï¼Œå› ä¸ºå›¾ä¸­çš„é‚»å±…å¾€å¾€é«˜åº¦é‡å ã€‚&lt;/p&gt;
&lt;h1 id="3-evaluation"&gt;3 Evaluation
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬ä¸å¾ˆå¤šå¼ºåŠ›çš„æ¨¡å‹è¿›è¡Œäº†å¯¹æ¯”ï¼Œåœ¨å››ä¸ªåŸºäºå›¾çš„æ•°æ®é›†ä¸Šï¼Œè¾¾åˆ°äº†state-of-the-artçš„æ•ˆæœã€‚è¿™éƒ¨åˆ†å°†æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬çš„å®éªŒè¿‡ç¨‹ä¸ç»“æœï¼Œå¹¶å¯¹GATæå–ç‰¹å¾è¡¨ç¤ºåšä¸€ä¸ªå®šæ€§åˆ†æã€‚
&lt;img src="https://davidham3.github.io/blog/images/graph-attention-networks/Table1.JPG"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;h2 id="31-datasets"&gt;3.1 Datasets
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Transductive learning&lt;/strong&gt; æˆ‘ä»¬ä½¿ç”¨äº†ä¸‰ä¸ªæ ‡å‡†çš„citation network benchmarkæ•°æ®é›†â€”â€”Cora, Citeseerå’ŒPubmed(Sen et al., 2008)â€”â€”å¹¶æŒ‰Yang et al., 2016åšçš„transductiveå®éªŒã€‚è¿™äº›æ•°æ®é›†ä¸­ï¼Œé¡¶ç‚¹è¡¨ç¤ºæ–‡ç« ï¼Œè¾¹ï¼ˆæ— å‘ï¼‰è¡¨ç¤ºå¼•ç”¨ã€‚é¡¶ç‚¹ç‰¹å¾è¡¨ç¤ºæ–‡ç« çš„BOWç‰¹å¾ã€‚æ¯ä¸ªé¡¶ç‚¹æœ‰ä¸€ä¸ªç±»æ ‡ç­¾ã€‚æˆ‘ä»¬ä½¿ç”¨æ¯ç±»20ä¸ªé¡¶ç‚¹ç”¨æ¥è®­ç»ƒï¼Œè®­ç»ƒç®—æ³•ä½¿ç”¨æ‰€æœ‰çš„é¡¶ç‚¹ç‰¹å¾ã€‚æ¨¡å‹çš„é¢„æµ‹æ€§èƒ½æ˜¯åœ¨1000ä¸ªæµ‹è¯•é¡¶ç‚¹ä¸Šè¿›è¡Œè¯„ä¼°çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†500ä¸ªé¢å¤–çš„é¡¶ç‚¹æ¥éªŒè¯æ„å›¾ï¼ˆåƒKipf &amp;amp; Welling 2017ï¼‰ã€‚Coraæ•°æ®é›†åŒ…å«äº†2708ä¸ªé¡¶ç‚¹ï¼Œ5429æ¡è¾¹ï¼Œ7ä¸ªç±»åˆ«ï¼Œæ¯ä¸ªé¡¶ç‚¹1433ä¸ªç‰¹å¾ã€‚CiteseeråŒ…å«3327ä¸ªé¡¶ç‚¹ï¼Œ4732æ¡è¾¹ï¼Œ6ç±»ï¼Œæ¯ä¸ªé¡¶ç‚¹3703ä¸ªç‰¹å¾ã€‚Pubmedæ•°æ®é›†åŒ…å«19717ä¸ªé¡¶ç‚¹ï¼Œ44338æ¡è¾¹ï¼Œ3ç±»ï¼Œæ¯ä¸ªé¡¶ç‚¹500ä¸ªç‰¹å¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Inductive learning&lt;/strong&gt; æˆ‘ä»¬å……åˆ†åˆ©ç”¨protein-protein interaction(PPI)æ•°æ®é›†ï¼Œè¿™ä¸ªæ•°æ®é›†åŒ…å«äº†ä¸åŒçš„äººä½“ç»„ç»‡ï¼ˆZitnik &amp;amp; Leskovec, 2017ï¼‰ã€‚æ•°æ®é›†åŒ…å«äº†20ä¸ªå›¾æ¥è®­ç»ƒï¼Œ2ä¸ªéªŒè¯ï¼Œ2ä¸ªæµ‹è¯•ã€‚å…³é”®çš„æ˜¯ï¼Œæµ‹è¯•çš„å›¾åŒ…å«äº†è®­ç»ƒæ—¶å®Œå…¨æœªè§è¿‡çš„å›¾ã€‚ä¸ºäº†æ„å»ºå›¾ï¼Œæˆ‘ä»¬ä½¿ç”¨Hamilton et al., 2017é¢„å¤„ç†åçš„æ•°æ®ã€‚å¹³å‡æ¯ä¸ªå›¾çš„é¡¶ç‚¹æ•°ä¸º2372ä¸ªã€‚æ¯ä¸ªé¡¶ç‚¹æœ‰50ä¸ªç‰¹å¾ï¼Œç»„æˆäº†positional gene setsï¼Œmotif gene sets and immunological signaturesã€‚ä»åŸºå› æœ¬ä½“è·å¾—çš„æ¯ä¸ªé¡¶ç‚¹é›†æœ‰121ä¸ªæ ‡ç­¾ï¼Œç”±Molecular Signatures Database(Subramanian et al., 2005)æ”¶é›†ï¼Œä¸€ä¸ªé¡¶ç‚¹å¯ä»¥åŒæ—¶æ‹¥æœ‰å¤šä¸ªæ ‡ç­¾ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›æ•°æ®é›†çš„æ¦‚è²Œåœ¨è¡¨1ä¸­ç»™å‡ºã€‚&lt;/p&gt;
&lt;h2 id="32-state-of-the-art-methods"&gt;3.2 State-of-the-art methods
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Transductive learning&lt;/strong&gt; å¯¹äºtransductive learningä»»åŠ¡ï¼Œæˆ‘ä»¬å¯¹æ¯”äº†Kipf &amp;amp; Welling 2017çš„å·¥ä½œï¼Œä»¥åŠå…¶ä»–çš„baselineã€‚åŒ…æ‹¬äº†label propagation(LP)(Zhu et al., 2003)ï¼ŒåŠç›‘ç£åµŒå…¥(SemiEmb)(Weston et al., 2012)ï¼Œmanifold regulariization(ManiReg)(Belkin et al., 2006)ï¼Œskip-gram based graph embeddings(DeepWalk)(Perozzi et al., 2014)ï¼Œthe iterative classification algorithm(ICA)(Lu &amp;amp; Getoor, 2003)å’ŒPlanetoid(Yang et al., 2016)ã€‚æˆ‘ä»¬ä¹Ÿç›´æ¥å¯¹æ¯”äº†GCN(Kipf &amp;amp; Welling 2017)ï¼Œè¿˜æœ‰åˆ©ç”¨äº†é«˜é˜¶åˆ‡æ¯”é›ªå¤«çš„å›¾å·ç§¯æ¨¡å‹(Defferrard et al., 2016)ï¼Œè¿˜æœ‰Monti et al., 2016æå‡ºçš„MoNetã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Inductive learning&lt;/strong&gt; å¯¹äºinductive learningä»»åŠ¡ï¼Œæˆ‘ä»¬å¯¹æ¯”äº†Hamilton et al., 2017æå‡ºçš„å››ä¸ªä¸åŒçš„ç›‘ç£çš„GraphSAGE è¿™äº›æ–¹æ³•æä¾›äº†å¤§é‡çš„èšåˆç‰¹å¾ï¼šGraphSAGE-GCNï¼ˆå¯¹å›¾å·ç§¯æ“ä½œæ‰©å±•inductive settingï¼‰ï¼ŒGraphSAGE-meanï¼ˆå¯¹ç‰¹å¾å‘é‡çš„å€¼å–element-wiseå‡å€¼ï¼‰ï¼ŒGraphSAGE-LSTMï¼ˆé€šè¿‡å°†é‚»å±…ç‰¹å¾è¾“å…¥åˆ°LSTMè¿›è¡Œèšåˆï¼‰ï¼ŒGraphSAGE-poolï¼ˆç”¨ä¸€ä¸ªå…±äº«çš„å¤šå±‚æ„ŸçŸ¥æœºå¯¹ç‰¹å¾å‘é‡è¿›è¡Œå˜æ¢ï¼Œç„¶åä½¿ç”¨element-wiseå–æœ€å¤§å€¼ï¼‰ã€‚å…¶ä»–çš„transductiveæ–¹æ³•è¦ä¹ˆåœ¨inductiveä¸­å®Œå…¨ä¸åˆé€‚ï¼Œè¦ä¹ˆå°±è®¤ä¸ºé¡¶ç‚¹æ˜¯é€æ¸åŠ å…¥åˆ°ä¸€ä¸ªå›¾ä¸­ï¼Œä½¿å¾—ä»–ä»¬ä¸èƒ½åœ¨å®Œå…¨æœªè§è¿‡çš„å›¾ä¸Šä½¿ç”¨ï¼ˆå¦‚PPIæ•°æ®é›†ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œå¯¹äºä¸¤ç§ä»»åŠ¡ï¼Œæˆ‘ä»¬æä¾›äº†æ¯ä¸ªé¡¶ç‚¹å…±äº«çš„MLPåˆ†ç±»å™¨ï¼ˆå®Œå…¨æ²¡æœ‰æ•´åˆå›¾ç»“æ„ä¿¡æ¯ï¼‰çš„performanceã€‚&lt;/p&gt;
&lt;h2 id="33-experimental-setup"&gt;3.3 Experimental Setup
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Transductive learning&lt;/strong&gt; æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªä¸¤å±‚çš„GATæ¨¡å‹ã€‚è¶…å‚æ•°åœ¨Coraä¸Šä¼˜åŒ–è¿‡ååœ¨Citeseerä¸Šå¤ç”¨ã€‚ç¬¬ä¸€å±‚åŒ…å«$K = 8$ä¸ªattention headï¼Œè®¡ç®—å¾—åˆ°$F&amp;rsquo; = 8$ä¸ªç‰¹å¾ï¼ˆæ€»å…±64ä¸ªç‰¹å¾ï¼‰ï¼Œä¹‹åæ¥ä¸€ä¸ªæŒ‡æ•°çº¿æ€§å•å…ƒï¼ˆELUï¼‰ï¼ˆClevert et al., 2016ï¼‰ä½œä¸ºéçº¿æ€§å•å…ƒã€‚ç¬¬äºŒå±‚ç”¨ä½œåˆ†ç±»ï¼šä¸€ä¸ªå•ä¸ªçš„attention headè®¡ç®—$C$ä¸ªç‰¹å¾ï¼ˆå…¶ä¸­$C$æ˜¯ç±»åˆ«çš„æ•°é‡ï¼‰ï¼Œä¹‹åç”¨softmaxæ¿€æ´»ã€‚å¤„ç†å°è®­ç»ƒé›†æ—¶ï¼Œåœ¨æ¨¡å‹ä¸ŠåŠ æ­£åˆ™åŒ–ã€‚åœ¨è®­ç»ƒæ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨$L_2$æ­£åˆ™åŒ–ï¼Œ$\lambda = 0.0005$ã€‚é™¤æ­¤ä»¥å¤–ï¼Œä¸¤ä¸ªå±‚çš„è¾“å…¥éƒ½ä½¿ç”¨äº†$p = 0.6$çš„dropout(Srivastava et al., 2014)ï¼Œåœ¨&lt;em&gt;normalized attention coefficients&lt;/em&gt;ä¸Šä¹Ÿä½¿ç”¨äº†ï¼ˆä¹Ÿå°±æ˜¯åœ¨æ¯è½®è®­ç»ƒæ—¶ï¼Œæ¯ä¸ªé¡¶ç‚¹éƒ½è¢«éšæœºé‡‡æ ·é‚»å±…ï¼‰ã€‚å¦‚Monti et al., 2016è§‚å¯Ÿåˆ°çš„ä¸€æ ·ï¼Œæˆ‘ä»¬å‘ç°Pubmedçš„è®­ç»ƒé›†å¤§å°(60ä¸ªæ ·æœ¬)éœ€è¦å¾®è°ƒï¼šæˆ‘ä»¬ä½¿ç”¨$K = 8$ä¸ªattention headï¼ŒåŠ å¼ºäº†$L_2$æ­£åˆ™ï¼Œ$\lambda = 0.001$ã€‚é™¤æ­¤ä»¥å¤–ï¼Œæˆ‘ä»¬çš„ç»“æ„éƒ½å’ŒCoraå’ŒCiteseerçš„ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Inductive learning&lt;/strong&gt;
æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªä¸‰å±‚çš„GATæ¨¡å‹ã€‚å‰ä¸¤å±‚$K = 4$ï¼Œè®¡ç®—$F&amp;rsquo; = 256$ä¸ªç‰¹å¾ï¼ˆæ€»å…±1024ä¸ªç‰¹å¾ï¼‰ï¼Œç„¶åä½¿ç”¨ELUã€‚æœ€åä¸€å±‚ç”¨äºå¤šç±»åˆ«åˆ†ç±»ï¼š$K = 6$ï¼Œæ¯ä¸ªè®¡ç®—121ä¸ªç‰¹å¾ï¼Œå–å¹³å‡åä½¿ç”¨logistic sigmoidæ¿€æ´»ã€‚è®­ç»ƒé›†å……åˆ†å¤§æ‰€ä»¥ä¸éœ€è¦ä½¿ç”¨$L_2$æ­£åˆ™æˆ–dropoutâ€”â€”ä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨äº†skip connections(He et al., 2016)åœ¨attentional layeré—´ã€‚è®­ç»ƒæ—¶batch sizeè®¾ç½®ä¸º2ä¸ªå›¾ã€‚ä¸ºäº†ä¸¥æ ¼çš„è¡¡é‡å‡ºä½¿ç”¨æ³¨æ„åŠ›æœºåˆ¶çš„æ•ˆæœï¼ˆä¸GCNç›¸æ¯”ï¼‰ï¼Œæˆ‘ä»¬ä¹Ÿæä¾›äº†&lt;em&gt;constant attention mechanism&lt;/em&gt;ï¼Œ$a(x, y) = 1$ï¼Œä½¿ç”¨åŒæ ·çš„æ¶æ„â€”â€”ä¹Ÿå°±æ˜¯æ¯ä¸ªé‚»å±…ä¸Šéƒ½æœ‰ç›¸åŒçš„æƒé‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¤ä¸ªæ¨¡å‹éƒ½ä½¿ç”¨äº†Glorotåˆå§‹åŒ–(Glorot &amp;amp; Bengio, 2010)ï¼Œä½¿ç”¨Adam SGD(Kingma &amp;amp; Ba, 2014)ä¼˜åŒ–cross-entropyï¼ŒPubmedä¸Šåˆå§‹å­¦ä¹ ç‡æ˜¯0.01ï¼Œå…¶ä»–æ•°æ®é›†æ˜¯0.005ã€‚æˆ‘ä»¬åœ¨cross-entropy losså’Œaccuracy(transductive)æˆ–micro-F1(inductive)ä¸Šéƒ½ä½¿ç”¨äº†early stoppingç­–ç•¥ï¼Œè¿­ä»£æ¬¡æ•°ä¸º100è½®ã€‚
ä»£ç ï¼šhttps://github.com/PetarV-/GAT&lt;/p&gt;
&lt;h2 id="34-results"&gt;3.4 Results
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/graph-attention-networks/Table2.JPG"
loading="lazy"
alt="Table2"
&gt;
å¯¹äºtransductiveä»»åŠ¡ï¼Œæˆ‘ä»¬æäº¤äº†æˆ‘ä»¬çš„æ–¹æ³•100æ¬¡çš„å¹³å‡åˆ†ç±»ç²¾åº¦ï¼ˆè¿˜æœ‰æ ‡å‡†å·®ï¼‰ï¼Œä¹Ÿç”¨äº†Kipf &amp;amp; Welling., 2017å’ŒMonti et al., 2016çš„metricsã€‚ç‰¹åˆ«åœ°ï¼Œå¯¹äºåŸºäºåˆ‡æ¯”é›ªå¤«æ–¹æ³•(Defferrard et al., 2016)ï¼Œæˆ‘ä»¬æä¾›äº†äºŒé˜¶å’Œä¸‰é˜¶æœ€å¥½çš„ç»“æœã€‚ä¸ºäº†å…¬å¹³çš„è¯„ä¼°æ³¨æ„åŠ›æœºåˆ¶çš„æ€§èƒ½ï¼Œæˆ‘ä»¬è¿˜è¯„ä¼°äº†ä¸€ä¸ªè®¡ç®—å‡º64ä¸ªéšå«ç‰¹å¾çš„GCNæ¨¡å‹ï¼Œå¹¶ä¸”å°è¯•äº†ReLUå’ŒELUæ¿€æ´»ï¼Œè®°å½•äº†100è½®åæ›´å¥½çš„é‚£ä¸ªç»“æœï¼ˆGCN-64*ï¼‰ï¼ˆç»“æœæ˜¾ç¤ºReLUæ›´å¥½ï¼‰ã€‚
&lt;img src="https://davidham3.github.io/blog/images/graph-attention-networks/Table3.JPG"
loading="lazy"
alt="Table3"
&gt;
å¯¹äºinductiveä»»åŠ¡ï¼Œæˆ‘ä»¬è®¡ç®—äº†micro-averaged F1 scoreåœ¨ä¸¤ä¸ªä»æœªè§è¿‡çš„æµ‹è¯•å›¾ä¸Šï¼Œå¹³å‡äº†10æ¬¡ç»“æœï¼Œä¹Ÿä½¿ç”¨äº†Hamilton et al., 2017çš„metricsã€‚ç‰¹åˆ«åœ°ï¼Œå› ä¸ºæˆ‘ä»¬çš„æ–¹æ³•æ˜¯ç›‘ç£çš„ï¼Œæˆ‘ä»¬å¯¹æ¯”äº†GraphSAGEã€‚ä¸ºäº†è¯„ä¼°èšåˆæ‰€æœ‰çš„é‚»å±…çš„ä¼˜ç‚¹ï¼Œæˆ‘ä»¬è¿˜æä¾›äº†æˆ‘ä»¬é€šè¿‡ä¿®æ”¹æ¶æ„ï¼ˆä¸‰å±‚GraphSAGE-LSTMåˆ†åˆ«è®¡ç®—[512, 512, 726]ä¸ªç‰¹å¾ï¼Œ128ä¸ªç‰¹å¾ç”¨æ¥èšåˆé‚»å±…ï¼‰æ‰€èƒ½è¾¾åˆ°çš„GraphSAGEæœ€å¥½çš„ç»“æœï¼ˆGraphSAGE*ï¼‰ã€‚æœ€åï¼Œä¸ºäº†å…¬å¹³çš„è¯„ä¼°æ³¨æ„åŠ›æœºåˆ¶å¯¹æ¯”GCNè¿™æ ·çš„èšåˆæ–¹æ³•ï¼Œæˆ‘ä»¬è®°å½•äº†æˆ‘ä»¬çš„constant attention GATæ¨¡å‹çš„10è½®ç»“æœï¼ˆConst-GATï¼‰ã€‚
ç»“æœå±•ç¤ºå‡ºæˆ‘ä»¬çš„æ–¹æ³•åœ¨å››ä¸ªæ•°æ®é›†ä¸Šéƒ½å¾ˆå¥½ï¼Œå’Œé¢„æœŸä¸€è‡´ï¼Œå¦‚2.2èŠ‚è®¨è®ºçš„é‚£æ ·ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨Coraå’ŒCiteseerä¸Šæˆ‘ä»¬çš„æ¨¡å‹ä¸Šå‡äº†1.5%å’Œ1.6%ï¼Œæ¨æµ‹åº”è¯¥æ˜¯ç»™é‚»å±…åˆ†é…ä¸åŒçš„æƒé‡èµ·åˆ°äº†æ•ˆæœã€‚å€¼å¾—æ³¨æ„çš„æ˜¯åœ¨PPIæ•°æ®é›†ä¸Šï¼šæˆ‘ä»¬çš„GATæ¨¡å‹å¯¹äºæœ€å¥½çš„GraphSAGEç»“æœæå‡äº†20.5%ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„æ¨¡å‹å¯ä»¥åº”ç”¨åˆ°inductiveä¸Šï¼Œé€šè¿‡è§‚æµ‹æ‰€æœ‰çš„é‚»å±…ï¼Œæ¨¡å‹ä¼šæœ‰æ›´å¼ºçš„é¢„æµ‹èƒ½åŠ›ã€‚æ­¤å¤–ï¼Œé’ˆå¯¹Const-GATä¹Ÿæå‡3.9%ï¼Œå†ä¸€æ¬¡å±•ç°å‡ºç»™ä¸åŒçš„é‚»å±…åˆ†é…ä¸åŒçš„æƒé‡çš„å·¨å¤§æå‡ã€‚&lt;/p&gt;
&lt;p&gt;å­¦ä¹ åˆ°çš„ç‰¹å¾è¡¨ç¤ºçš„æœ‰æ•ˆæ€§å¯ä»¥å®šæ€§åˆ†æâ€”â€”æˆ‘ä»¬æä¾›äº†t-SNE(Maaten &amp;amp; Hinton, 2008)çš„å¯è§†åŒ–â€”â€”æˆ‘ä»¬å¯¹åœ¨Coraä¸Šé¢é¢„è®­ç»ƒçš„GATæ¨¡å‹ä¸­ç¬¬ä¸€å±‚çš„è¾“å‡ºåšäº†å˜æ¢ï¼ˆå›¾2ï¼‰ã€‚representationåœ¨äºŒç»´ç©ºé—´ä¸­å±•ç¤ºå‡ºäº†å¯è¾©åˆ«çš„ç°‡ã€‚æ³¨æ„ï¼Œè¿™äº›ç°‡å¯¹åº”äº†æ•°æ®é›†çš„ä¸ƒä¸ªç±»åˆ«ï¼ŒéªŒè¯äº†æ¨¡å‹åœ¨Coraä¸Šå¯¹ä¸ƒç±»çš„åˆ¤åˆ«èƒ½åŠ›ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¯è§†åŒ–äº†å½’ä¸€åŒ–çš„attentionç³»æ•°ï¼ˆå¯¹æ‰€æœ‰çš„8ä¸ªattention headå–å¹³å‡ï¼‰çš„ç›¸å¯¹å¼ºåº¦ã€‚åƒBahdanau et al., 2015é‚£æ ·é€‚å½“çš„è§£é‡Šè¿™äº›ç³»æ•°éœ€è¦æ›´å¤šçš„é¢†åŸŸçŸ¥è¯†ï¼Œæˆ‘ä»¬ä¼šåœ¨æœªæ¥çš„å·¥ä½œä¸­ç ”ç©¶ã€‚
&lt;img src="https://davidham3.github.io/blog/images/graph-attention-networks/Fig2.JPG"
loading="lazy"
alt="Figure2"
&gt;&lt;/p&gt;
&lt;h1 id="4-conclusions"&gt;4 Conclusions
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬å±•ç¤ºäº†å›¾æ³¨æ„åŠ›ç½‘ç»œ(GAT)ï¼Œæ–°çš„å·ç§¯é£æ ¼ç¥ç»ç½‘ç»œï¼Œåˆ©ç”¨masked self-attentionalå±‚ã€‚å›¾æ³¨æ„åŠ›ç½‘ç»œè®¡ç®—é«˜æ•ˆï¼ˆä¸éœ€è¦è€—æ—¶çš„çŸ©é˜µæ“ä½œï¼Œåœ¨å›¾ä¸­çš„é¡¶ç‚¹ä¸Šå¹¶è¡Œè®¡ç®—ï¼‰ï¼Œå¤„ç†ä¸åŒæ•°é‡çš„é‚»å±…æ—¶å¯¹é‚»å±…ä¸­çš„ä¸åŒé¡¶ç‚¹èµ‹äºˆä¸åŒçš„é‡è¦åº¦ï¼Œä¸éœ€è¦ä¾èµ–æ•´ä¸ªå›¾çš„ç»“æ„ä¿¡æ¯â€”â€”å› æ­¤è§£å†³äº†ä¹‹å‰æå‡ºçš„åŸºäºè°±çš„æ–¹æ³•çš„é—®é¢˜ã€‚æˆ‘ä»¬çš„è¿™ä¸ªåˆ©ç”¨attentionçš„æ¨¡å‹åœ¨4ä¸ªæ•°æ®é›†é’ˆå¯¹transductiveå’Œinductiveï¼ˆç‰¹åˆ«æ˜¯å¯¹å®Œå…¨æœªè§è¿‡çš„å›¾ï¼‰ï¼Œå¯¹é¡¶ç‚¹åˆ†ç±»æˆåŠŸåœ°è¾¾åˆ°äº†state-of-the-artçš„performanceã€‚&lt;/p&gt;
&lt;p&gt;æœªæ¥åœ¨å›¾æ³¨æ„åŠ›ç½‘ç»œä¸Šæœ‰å‡ ç‚¹å¯èƒ½çš„æ”¹è¿›ä¸æ‰©å±•ï¼Œæ¯”å¦‚è§£å†³2.2èŠ‚æè¿°çš„å¤„ç†å¤§æ‰¹æ•°æ®æ—¶çš„å®é™…é—®é¢˜ã€‚è¿˜æœ‰ä¸€ä¸ªæœ‰è¶£çš„ç ”ç©¶æ–¹å‘æ˜¯åˆ©ç”¨attentionæœºåˆ¶å¯¹æˆ‘ä»¬çš„æ¨¡å‹è¿›è¡Œä¸€ä¸ªæ·±å…¥çš„è§£é‡Šã€‚æ­¤å¤–ï¼Œæ‰©å±•æˆ‘ä»¬çš„æ¨¡å‹ä»é¡¶ç‚¹åˆ†ç±»åˆ°å›¾åˆ†ç±»ä¹Ÿæ˜¯ä¸€ä¸ªæ›´å…·åº”ç”¨æ€§çš„æ–¹å‘ã€‚æœ€åï¼Œæ‰©å±•æˆ‘ä»¬çš„æ¨¡å‹åˆ°æ•´åˆè¾¹çš„ä¿¡æ¯ï¼ˆå¯èƒ½åˆ¶è§†äº†é¡¶ç‚¹å…³ç³»ï¼‰å¯ä»¥å¤„ç†æ›´å¤šçš„é—®é¢˜ã€‚&lt;/p&gt;</description></item><item><title>FHWAæ•°æ®</title><link>https://davidham3.github.io/blog/p/fhwa%E6%95%B0%E6%8D%AE/</link><pubDate>Thu, 12 Jul 2018 14:05:06 +0000</pubDate><guid>https://davidham3.github.io/blog/p/fhwa%E6%95%B0%E6%8D%AE/</guid><description>&lt;p&gt;FHWAæ•°æ®
æ•°æ®åœ°å€ï¼š&lt;a class="link" href="https://www.fhwa.dot.gov/policyinformation/tables/tmasdata/" target="_blank" rel="noopener"
&gt;https://www.fhwa.dot.gov/policyinformation/tables/tmasdata/&lt;/a&gt;
æ•°æ®åŒ…å«äº†2011åˆ°2016å¹´çš„å…¨å¹´æ•°æ®ã€‚
æ•°æ®è¯´æ˜ï¼š&lt;a class="link" href="https://www.fhwa.dot.gov/policyinformation/tmguide/" target="_blank" rel="noopener"
&gt;https://www.fhwa.dot.gov/policyinformation/tmguide/&lt;/a&gt;
è¯´æ˜å…±æœ‰ä¸‰ç‰ˆï¼Œä½†æ˜¯æ•°æ®å¯¹åº”çš„å…¶å®æ˜¯æœ€è€çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œ2001å¹´ä¿®è®¢çš„é‚£ä¸ªæ–‡æ¡£ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡åªå¯¹æ–‡æ¡£ä¸­çš„ä¸€éƒ¨åˆ†è¿›è¡Œè¯´æ˜ï¼Œè¯¦ç»†çš„è¿˜æ˜¯å¾—çœ‹å®˜æ–¹æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;h1 id="æ•°æ®æ¦‚å†µ"&gt;æ•°æ®æ¦‚å†µ
&lt;/h1&gt;&lt;p&gt;æ•°æ®æ˜¯ç¾å›½é«˜é€Ÿå…¬è·¯å±€æ”¶é›†çš„äº¤é€šæµé‡æ•°æ®ï¼Œæ¯æœˆä¸€ç»„ã€‚&lt;/p&gt;
&lt;p&gt;æ•°æ®çš„æ ¼å¼æ˜¯FHWAå®šçš„ï¼Œæ•°æ®ä¼šè¢«è¾“å…¥åˆ°FHWAç»´æŠ¤çš„ä¸¤ä¸ªæ•°æ®åº“ä¸­ï¼ŒTraffic Volume Trendsï¼ˆTVTï¼‰å’ŒVehicle Travel Information Systemï¼ˆVTRISï¼‰ã€‚TVTç³»ç»Ÿå¤„ç†è¿ç»­çš„æµé‡æ•°æ®ï¼ŒæŒ‰æœˆç”Ÿæˆäº¤é€šæµé‡è¶‹åŠ¿æŠ¥å‘Šã€‚VIRISç³»ç»Ÿå¤„ç†è½¦è¾†åˆ†ç±»å’Œå¡è½¦ç§°é‡æ•°æ®ï¼Œä½œä¸ºå¹´åº¦å¡è½¦é‡é‡ç ”ç©¶ã€‚è¿™ä¸¤ä¸ªæ•°æ®ç®¡ç†ç³»ç»Ÿå¤„ç†ã€éªŒè¯ã€æ±‡æ€»ã€ç»´æŠ¤äº¤é€šæ•°æ®ã€‚TVTå’ŒVIRISå‘ä»»ä½•äººæä¾›ï¼Œé€šè¿‡è¿™ä¸ªåœ°å€&lt;a class="link" href="http://www.fhwa.dot.gov/ohim/tvtw/tvtwpage.htm" target="_blank" rel="noopener"
&gt;http://www.fhwa.dot.gov/ohim/tvtw/tvtwpage.htm&lt;/a&gt;è·å¾—ã€‚æ•°æ®æ”¶é›†è®¡åˆ’ç”±the Office of Management and Budgetæ‰¹å‡†ï¼ŒOMB # 2125-0587ï¼ŒæœŸé™æ˜¯2004å¹´4æœˆ30æ—¥ã€‚ï¼ˆå› ä¸ºç°åœ¨çœ‹çš„æ–‡æ¡£æ˜¯2001å¹´ç¼–å†™çš„ï¼Œæ‰€ä»¥å·²ç»è¿‡æ—¶äº†ï¼Œä½†æ˜¯æ•°æ®æ ¼å¼æ²¡æœ‰è¿‡æ—¶ï¼Œæ–°ç‰ˆçš„æ–‡æ¡£åè€Œå’Œå½“å‰æ•°æ®(2016å¹´)çš„æ ¼å¼å¯¹ä¸ä¸Šï¼‰&lt;/p&gt;
&lt;p&gt;æ•°æ®è®°å½•åˆ†ä¸ºå››ç±»ï¼Œç«™ç‚¹æè¿°æ•°æ®ã€æµé‡æ•°æ®ã€è½¦è¾†åˆ†ç±»æ•°æ®ã€å¡è½¦é‡é‡æ•°æ®ã€‚æ¯ç±»æ•°æ®éƒ½æœ‰è‡ªå·±çš„æ ¼å¼ã€‚æ¥ä¸‹æ¥ä¼šåˆ†ç« èŠ‚è®¨è®ºå››ç±»æ•°æ®çš„æ ¼å¼è§„èŒƒã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼šä¸€äº›å­—æ®µè¢«æ ‡è®°ä¸º&amp;quot;critical&amp;quot;ï¼Œæ„æ€æ˜¯å¿…ä¸å¯å°‘çš„å­—æ®µã€‚è¿™é‡Œæè¿°çš„æ‰€æœ‰æ•°æ®éƒ½ä¸ŠASCII flatæ–‡ä»¶ã€‚å¯¹äºç¼ºå¤±çš„å­—æ®µæˆ–æ•°æ®ï¼Œä¼šç”¨ç©ºæ ¼ä»£æ›¿ã€‚æ•°å­—æ˜¯å³å¯¹å…¶çš„ï¼Œå¦‚æœæ²¡æœ‰è¯´æ˜çš„è¯å·¦ä¾§è¡¥ç©ºæ ¼æˆ–0ã€‚æ•°å€¼å‹å­—æ®µç¼ºå¤±æˆ–ä¸å¯ç”¨çš„æ•°æ®ï¼Œè¾“å…¥ç©ºæ ¼æˆ–å³å¯¹é½çš„-1ã€‚&lt;/p&gt;
&lt;p&gt;å››ç±»æ•°æ®è®°å½•ä¸­çš„éƒ¨åˆ†æ•°æ®é¡¹æ˜¯ç›¸åŒçš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ‰€æœ‰çš„è®°å½•åŒ…å«ä¸€ä¸ª6å­—ç¬¦é•¿åº¦çš„ç«™ç‚¹æ ‡è¯†ç¬¦ã€‚è¿™ä½¿å¾—æ¯ä¸ªå·éƒ½éœ€è¦ä½¿ç”¨ä¸€ä¸ªå…±åŒçš„æ ‡è¯†ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;p&gt;ç«™ç‚¹æè¿°ä¸­çš„ä¸€äº›å­—æ®µè¢«æ›¿æ¢æˆäº†éœ€è¦ä¸GISè¿æ¥èµ·æ¥çš„äº¤é€šæ•°æ®ã€‚è¿™ä¼šä½¿å¾—æ•°æ®ä¸NHPN(National Highway Planning Network)æˆ–ç›¸ä¼¼çš„ç³»ç»Ÿé‡å ã€‚&lt;/p&gt;
&lt;h1 id="ç«™ç‚¹æ•°æ®æè¿°"&gt;ç«™ç‚¹æ•°æ®æè¿°
&lt;/h1&gt;&lt;p&gt;ç«™ç‚¹æ•°æ®æè¿°å¯¹æ‰€æœ‰çš„æµé‡ã€è½¦è¾†åˆ†ç±»ã€ç§°é‡ç«™ç‚¹éƒ½é€‚ç”¨ã€‚ä¸€ä¸ªç«™ç‚¹æè¿°æ–‡ä»¶åŒ…å«äº†å¯¹æ¯ä¸ªäº¤é€šç›‘æµ‹ç«™çš„è®°å½•ï¼ˆæ¯å¹´ï¼‰ã€‚æ‰€æœ‰çš„å­—æ®µéƒ½æ˜¯å­—ç¬¦å‹ã€‚å‘½åè§„åˆ™æ˜¯&amp;quot;ssyy.STA&amp;quot;ï¼ˆç°åœ¨å·²ç»ä¸æ˜¯äº†ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;2016å¹´æ•°æ®çš„æ–‡ä»¶åï¼šAK_2016 (TMAS).STAï¼Œå‰ä¸¤ä¸ªå­—ç¬¦è¡¨ç¤ºè¿™ä¸ªå·çš„ç¼©å†™ã€‚TMASæ˜¯æŒ‡Travel Monitoring Analysis System(National)ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ä¸‹æ ‡&lt;/th&gt;
&lt;th&gt;å«ä¹‰&lt;/th&gt;
&lt;th&gt;æ ·ä¾‹&lt;/th&gt;
&lt;th&gt;critical/optional&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;Record Type: è®°å½•ç±»å‹(Sè¡¨ç¤ºç«™ç‚¹)&lt;/td&gt;
&lt;td&gt;S&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2-3&lt;/td&gt;
&lt;td&gt;FIPS State Codes: å·ç¼–å·&lt;/td&gt;
&lt;td&gt;02&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4-9&lt;/td&gt;
&lt;td&gt;Station Identification: ç«™æ ‡è¯†ç¬¦&lt;/td&gt;
&lt;td&gt;000101&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;Direction of Travel Code: è·¯çš„èµ°å‘&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;Lane of Travel: å“ªæ¡è·¯&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12-13&lt;/td&gt;
&lt;td&gt;Year of Data: å¹´&lt;/td&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;14-15&lt;/td&gt;
&lt;td&gt;Functional Classification Code: åŠŸèƒ½ç±»å‹&lt;/td&gt;
&lt;td&gt;1R&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;Number of Lanes in Direction Indicated: è¿™ä¸ªæ–¹å‘å‡ æ¡è·¯&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;Sample Type for Traffic Volume: æ˜¯å¦ç”¨äºç›‘æµ‹æµé‡&lt;/td&gt;
&lt;td&gt;T&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;18&lt;/td&gt;
&lt;td&gt;Number of Lanes Monitored for Traffic Volume: å‡ æ¡è·¯ç›‘æµ‹æµé‡&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;19&lt;/td&gt;
&lt;td&gt;Method of Traffic Volume Counting: æµé‡ç›‘æµ‹æ–¹æ³•&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;Sample Type for Vehicle Classification: è½¦è¾†åˆ†ç±»æ–¹æ³•&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;21&lt;/td&gt;
&lt;td&gt;Number of Lanes Monitored for Vehicle Classification: å‡ æ¡è·¯å¯¹è½¦è¾†åˆ†ç±»&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;22&lt;/td&gt;
&lt;td&gt;Method of Vehicle Classification: è½¦è¾†åˆ†ç±»æ–¹æ³•&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;23&lt;/td&gt;
&lt;td&gt;Algorithm for Vehicle Classification: è½¦è¾†åˆ†ç±»ç®—æ³•&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;24-25&lt;/td&gt;
&lt;td&gt;Classification System for Vehicle Classification: è½¦è¾†åˆ†ç±»ç³»ç»Ÿ&lt;/td&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;26&lt;/td&gt;
&lt;td&gt;Sample Type for Truck Weight: ç§°é‡ç±»å‹&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;27&lt;/td&gt;
&lt;td&gt;Number of Lanes Monitored for Truck Weight: å‡ æ¡è·¯ç§°é‡&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;28&lt;/td&gt;
&lt;td&gt;Method of Truck Weighing: ç§°é‡æ–¹æ³•&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;29&lt;/td&gt;
&lt;td&gt;Calibration of Weighing System: ç§°é‡ç³»ç»Ÿç²¾åº¦&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;td&gt;Method of Data Retrieval: æ•°æ®è·å¾—çš„ç±»å‹&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;31&lt;/td&gt;
&lt;td&gt;Type of Sensor: æ£€æµ‹å™¨ç±»å‹&lt;/td&gt;
&lt;td&gt;P&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;32&lt;/td&gt;
&lt;td&gt;Second Type of Sensor: æ£€æµ‹å™¨çš„ç¬¬äºŒç§ç±»å‹&lt;/td&gt;
&lt;td&gt;L&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;33&lt;/td&gt;
&lt;td&gt;Primary Purpose: å®‰è£…æ£€æµ‹å™¨çš„æ„å›¾&lt;/td&gt;
&lt;td&gt;P&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;34-45&lt;/td&gt;
&lt;td&gt;LRS Identification&lt;/td&gt;
&lt;td&gt;001700000000&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;46-51&lt;/td&gt;
&lt;td&gt;LRS Location Point&lt;/td&gt;
&lt;td&gt;81967&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;52-59&lt;/td&gt;
&lt;td&gt;Latitude: çº¬åº¦&lt;/td&gt;
&lt;td&gt;62351650&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;60-68&lt;/td&gt;
&lt;td&gt;Longitude: ç»åº¦&lt;/td&gt;
&lt;td&gt;150252360&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;69-72&lt;/td&gt;
&lt;td&gt;SHRP Site Identification&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;73-78&lt;/td&gt;
&lt;td&gt;Previous Station ID&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;79-80&lt;/td&gt;
&lt;td&gt;Year Station Established: å“ªå¹´å»ºçš„ç«™ç‚¹&lt;/td&gt;
&lt;td&gt;91&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;81-82&lt;/td&gt;
&lt;td&gt;Year Station Discontinued&lt;/td&gt;
&lt;td&gt;00&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;83-85&lt;/td&gt;
&lt;td&gt;FIPS County Code&lt;/td&gt;
&lt;td&gt;170&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;86&lt;/td&gt;
&lt;td&gt;HPMS Sample Type&lt;/td&gt;
&lt;td&gt;Y&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;87-98&lt;/td&gt;
&lt;td&gt;HPMS Sample Identifier&lt;/td&gt;
&lt;td&gt;170000008007&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;99&lt;/td&gt;
&lt;td&gt;National Highway System&lt;/td&gt;
&lt;td&gt;Y&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;td&gt;Posted Route Signing&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;101-108&lt;/td&gt;
&lt;td&gt;Posted Signed Route Number&lt;/td&gt;
&lt;td&gt;00000003&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;109&lt;/td&gt;
&lt;td&gt;Concurrent Route Signing&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;110-117&lt;/td&gt;
&lt;td&gt;Concurrent Signed Route Number&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;118-167&lt;/td&gt;
&lt;td&gt;Station Location&lt;/td&gt;
&lt;td&gt;PARKS HIGHWAY AT CHULITNA - NB&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ•°æ®æ ·ä¾‹ï¼š
S0200010111161R1T13 00 13 00 2PLP001700000000 8196762351650150252360 9100170Y170000008007Y3000000030 PARKS HIGHWAY AT CHULITNA - NB (åé¢æœ‰å¾ˆå¤šç©ºæ ¼)&lt;/p&gt;
&lt;h1 id="æµé‡æ•°æ®æ ¼å¼"&gt;æµé‡æ•°æ®æ ¼å¼
&lt;/h1&gt;&lt;p&gt;2016å¹´æ•°æ®çš„æ–‡ä»¶åï¼šAK_JAN_2016 (TMAS).VOL
12ä¸ªå­—æ®µ&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ä¸‹æ ‡&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;th&gt;æ ·ä¾‹&lt;/th&gt;
&lt;th&gt;critical/optional&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;Record Type: è®°å½•ç±»å‹&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2-3&lt;/td&gt;
&lt;td&gt;FIPS State Code&lt;/td&gt;
&lt;td&gt;02&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4-5&lt;/td&gt;
&lt;td&gt;Functional Classification Code&lt;/td&gt;
&lt;td&gt;1R&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6-11&lt;/td&gt;
&lt;td&gt;Station Identification&lt;/td&gt;
&lt;td&gt;000101&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;Direction of Travel Code&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;Lane of Travel&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;14-15&lt;/td&gt;
&lt;td&gt;Year of Data&lt;/td&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;16-17&lt;/td&gt;
&lt;td&gt;Month of Data&lt;/td&gt;
&lt;td&gt;01&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;18-19&lt;/td&gt;
&lt;td&gt;Day of Data&lt;/td&gt;
&lt;td&gt;01&lt;/td&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;Day of Week(1è¡¨ç¤ºå‘¨æ—¥)&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;21-25,&amp;hellip;136-140&lt;/td&gt;
&lt;td&gt;Traffic Volume Counted Fields(ä»00:00åˆ°24:00ï¼Œ24ä¸ªå°æ—¶çš„æµé‡)&lt;/td&gt;
&lt;td&gt;00005 00004 00002 &amp;hellip; 00003&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;141&lt;/td&gt;
&lt;td&gt;Restrictions(1è¡¨ç¤ºæ–½å·¥æˆ–æ´»åŠ¨å½±å“æµé‡ï¼Œ2è¡¨ç¤ºæ£€æµ‹å™¨å‡ºç°é—®é¢˜ï¼Œ0è¡¨ç¤ºæ­£å¸¸)&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;o&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ•°æ®æ ·ä¾‹ï¼š
3021R0001011116010160000500004000020000000001000010000200001000150003100026000430003200052000340002800024000140001400007000120000800007000030
ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™è¡Œæ•°æ®åœ¨æµè§ˆå™¨é‡Œé¢ç›´æ¥å‡ºå»äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºè½¦è¾†åˆ†ç±»å’Œç§°é‡æ•°æ®å°±ä¸æè¿°äº†ï¼Œå¯ä»¥ç›´æ¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚&lt;/p&gt;</description></item><item><title>MnDOT traffic data</title><link>https://davidham3.github.io/blog/p/mndot-traffic-data/</link><pubDate>Wed, 11 Jul 2018 15:54:11 +0000</pubDate><guid>https://davidham3.github.io/blog/p/mndot-traffic-data/</guid><description>&lt;p&gt;MnDOTçš„å…¨ç§°æ˜¯Minnesota Department of Transportationã€‚RTMC traffic dataæ˜¯å…¶çš„ä¸€ä¸ªå­é›†ã€‚ç¾å›½æ˜å°¼è‹è¾¾å·åŒå­åŸäº¤é€šç®¡ç†ä¸­å¿ƒçš„äº¤é€šæ•°æ®ã€‚
åœ°å€ï¼š&lt;a class="link" href="http://www.d.umn.edu/~tkwon/TMCdata/TMCarchive.html" target="_blank" rel="noopener"
&gt;http://www.d.umn.edu/~tkwon/TMCdata/TMCarchive.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ•°æ®æ˜¯RTMCé‡‡é›†çš„è¿ç»­æ•°æ®ï¼Œæ˜¯MnDOTçš„ä¸€ä¸ªå­é›†ï¼Œè¶…è¿‡4500ä¸ªæ¯30ç§’ä¸ºé—´éš”çš„çº¿åœˆæ£€æµ‹å™¨éƒ¨ç½²Twin Cities Metro freewaysã€‚æœ€è¿‘åŠ å…¥äº†Rochesterçº¿åœˆæ•°æ®ã€‚æ¯å¤©çš„æ•°æ®éƒ½ä¼šUMDçš„æœåŠ¡å™¨è¢«æ‰“åŒ…è¿›ä¸€ä¸ªzipæ–‡ä»¶ï¼Œä¹‹åå­˜å…¥è¿™ä¸ªä»“åº“ã€‚æ–‡ä»¶åæ˜¯&amp;quot;yyyymmdd.traffic&amp;quot;ï¼Œåˆ†åˆ«æ˜¯å¹´æœˆæ—¥ã€‚ä½¿ç”¨unzipè½¯ä»¶ç›´æ¥è§£å‹å³å¯ã€‚è§£å‹åæœ‰9000ä¸ªæ–‡ä»¶ï¼Œ4500ä¸ªæ˜¯æµé‡æ•°æ®ï¼Œæ–‡ä»¶åæ˜¯&amp;quot;###.v30&amp;quot;ï¼Œå¦å¤–4000ä¸ªæ–‡ä»¶æ˜¯å ç”¨ç‡æ–‡ä»¶ï¼Œæ˜¯&amp;quot;###.o30&amp;quot;æˆ–è€…&amp;quot;###.c30&amp;quot;ã€‚###è¡¨ç¤ºæ£€æµ‹å™¨çš„idã€‚æ•°æ®æœåŠ¡ç”±UMDçš„Transportation Research Data Lab(TDRL)æä¾›ï¼Œæ—¨åœ¨ä¸å­¦è€…åˆ†äº«èµ„æºä¸æ€è·¯ã€‚æˆ‘ä»¬é¼“åŠ±æ•°æ®ä½¿ç”¨è€…ä¸æˆ‘ä»¬è”ç³»ï¼Œåˆ†äº«ç ”ç©¶æˆæœä¸æƒ³æ³•ã€‚è¿™ä¸ªæ•°æ®æ˜¯å…è´¹çš„ï¼Œä½†æ˜¯ç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ã€‚æœ€åï¼Œæ„Ÿè°¢RTMCå¦‚æ­¤æ…·æ…¨åœ°æä¾›äº¤é€šæ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;æ•°æ®æ ¼å¼ï¼š
&lt;a class="link" href="http://www.d.umn.edu/~tkwon/TMCdata/Traffic.html" target="_blank" rel="noopener"
&gt;http://www.d.umn.edu/~tkwon/TMCdata/Traffic.html&lt;/a&gt;
MN/DOTå·²ç»æ”¶é›†äº†è·¯ä¸­çš„æ£€æµ‹å™¨çš„æ•°æ®å¾ˆå¤šå¹´äº†ã€‚ä»2000å¹´3æœˆå¼€å§‹ï¼Œåœ¨Twin Cities metro areaï¼Œè¶…è¿‡4000ä¸ªæ£€æµ‹å™¨æ¯30ç§’éƒ½ä¼šæ”¶é›†ä¸€æ¬¡æ•°æ®ã€‚åŸå§‹æ•°æ®åŒ…æ‹¬äº†æµé‡å’Œå æœ‰ç‡ã€‚æ¯å¤©éƒ½ä¼šæœ‰å¤§é‡çš„æ•°æ®ï¼Œå°†è¿™äº›æ•°æ®å­˜å‚¨è¿›ä¼ ç»Ÿæ•°æ®åº“çš„ä»·å€¼æ¯”ä¹±æ”¾å¤§å¾ˆå¤šã€‚å› æ­¤ï¼Œè¿™äº›æ•°æ®çš„å­˜å‚¨ä¿ƒä½¿äº†MN/DOTäº¤é€šæ•°æ®æ–‡ä»¶æ ¼å¼çš„å‘å±•ã€‚è¿™ä¸ªæ ¼å¼ç°åœ¨æ˜¯TDRLçš„UTSDFçš„ä¸€ä¸ªç‰¹ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;UTSDFçš„ä¼˜ç‚¹å¾ˆå¤šã€‚æœ€é‡è¦çš„å¥½å¤„å°±æ˜¯ç®€å•ã€‚æ—©æœŸçš„æ–‡ä»¶æ ¼å¼æœ‰å¤æ‚çš„bitæ“ä½œï¼Œå¯¹æ•°æ®åˆ†æå·¥å…·å¾ˆéš¾æ“ä½œã€‚åæ¥æ‰€æœ‰çš„æ•°æ®å­˜æˆ8bitæˆ–16bitçš„æ•´æ•°è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚è¿™ä¸ªæ ¼å¼çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯å®ƒçš„ç´§å‡‘æ€§ã€‚æ—©æœŸçš„æ ¼å¼ï¼Œæ•°æ®33Mã€‚ç°åœ¨è¿™ä¸ªæ ¼å¼ï¼ŒåŒæ ·çš„æ•°æ®åªæœ‰13Mï¼ˆç²¾åº¦ä¸å˜ï¼‰ã€‚æ—©æœŸæ ¼å¼çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯30ç§’ã€5åˆ†é’Ÿçš„åŒºåˆ†ä½¿å¾—è·å–æ•°æ®å¾ˆéº»çƒ¦ã€‚ç°åœ¨è¿™ä¸ªæ•°æ®æŠŠæ‰€æœ‰æ•°æ®èåˆåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œç®€åŒ–äº†è¯»å–æ•°æ®çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªé‡è¦çš„å¥½å¤„æ˜¯å¯æ‰©å±•æ€§ï¼Œæœªæ¥å¯èƒ½åœ¨ä¸ç‰ºç‰²ç´§å‡‘æ€§çš„æƒ…å†µä¸‹å¢åŠ å…¶ä»–ç±»å‹çš„æ•°æ®ï¼ˆæ¯”å¦‚é€Ÿåº¦ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªtrafficæ•°æ®æ–‡ä»¶åŒ…å«äº†ä¸€å¤©çš„äº¤é€šæ•°æ®ã€‚æ–‡ä»¶ä¸€ç‰ˆå‘½åä¸º8ä¸ªæ•°å­—çš„æ—¥æœŸåŠ .trafficçš„åç¼€ã€‚å‹ç¼©æˆäº†zipæ ¼å¼ã€‚æ¯ä¸ªæ£€æµ‹å™¨æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯æ•´å¤©çš„æµé‡ï¼Œå¦ä¸€ä¸ªæ˜¯å ç”¨ç‡ã€‚è¿™äº›æ–‡ä»¶çš„å‘½åæ˜¯æ£€æµ‹å™¨çš„idã€‚æµé‡çš„åç¼€æ˜¯.v30ï¼Œå ç”¨ç‡æ˜¯.o30ã€‚æ‰€ä»¥å¦‚æœæœ‰ä¸ªç¼–å·ä¸º100çš„æ£€æµ‹å™¨ï¼Œé‚£å°±æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œ100.v30å’Œ100.o30ã€‚&lt;/p&gt;
&lt;p&gt;æµé‡æ–‡ä»¶ï¼ˆ.v30ï¼‰å…±2880ä¸ªå­—èŠ‚ã€‚æ¯å­—èŠ‚æ˜¯ä¸€ä¸ª8æ¯”ç‰¹å¸¦ç¬¦å·çš„æµé‡å€¼ï¼Œæ¯å¤©30ç§’ä¸ºä¸€ä¸ªå‘¨æœŸã€‚-1è¡¨ç¤ºç¼ºå¤±å€¼ã€‚æœ€å¼€å§‹çš„8bitè¡¨ç¤ºä¸€å¤©æœ€å¼€å§‹çš„å€¼ï¼Œä¹Ÿå°±æ˜¯åˆå¤œ0ç‚¹0åˆ†30ç§’ï¼Œæœ€åä¸€ä¸ªå€¼æ˜¯11ç‚¹59åˆ†30ç§’ã€‚&lt;/p&gt;
&lt;p&gt;å ç”¨ç‡æ–‡ä»¶ï¼ˆ.o30ï¼‰å’Œæµé‡æ–‡ä»¶å¾ˆç›¸ä¼¼ï¼Œé™¤äº†æ¯ä¸ªå€¼æ˜¯16bitã€‚æ¯ä¸ªæ–‡ä»¶æ˜¯5760å­—èŠ‚ã€‚å ç”¨ç‡å€¼æ˜¯ä»0åˆ°1000ï¼ˆç™¾åˆ†ç‚¹çš„ååˆ†ä¹‹ä¸€ï¼‰çš„fixed-point intergerã€‚-1è¡¨ç¤ºç¼ºå¤±ï¼Œ16bitæ˜¯é«˜ä½ä¼˜å…ˆï¼ˆhigh-byte first orderï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸Šæ ¼å¼è¯´æ˜ä¿®è®¢äº: 23 March 2000&lt;/p&gt;
&lt;p&gt;é™„å½•ï¼š2001å¹´8æœˆ3æ—¥&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;.c30æ–‡ä»¶æ˜¯è®°å½•åœ¨&amp;quot;scans&amp;quot;ä¸­ï¼Œå¹¶ä¸”æ¯”.o30æ–‡ä»¶æ›´ç²¾ç¡®ã€‚ä¸ä¹…æ‰€æœ‰çš„æ•°æ®éƒ½ä¼šä½¿ç”¨.c30æ ¼å¼ã€‚Scanså®šä¹‰ä¸º$\frac{1}{60}$ç§’ï¼Œæ‰€ä»¥æ•°æ®çš„èŒƒå›´æ˜¯0åˆ°1800ï¼ˆ30ç§’ $\times$ 60 scans/secondï¼‰ï¼Œè€ç‰ˆçš„æ–‡ä»¶.o30è¡¨ç¤ºçš„æ˜¯åƒåˆ†ä¹‹ä¸€ä¸ºå•ä½çš„å æœ‰ç‡ï¼Œæ‰€ä»¥èŒƒå›´æ˜¯0åˆ°1000ã€‚è¿™æ˜¯è¿™ä¸¤ä¸ªæ–‡ä»¶çš„åŒºåˆ«ã€‚å¦‚æœä½ æƒ³è¦0åˆ°100çš„æ•°æ®ï¼Œå°†scanæ•°æ®é™¤ä»¥18ï¼Œæˆ–è€…å°†å ç”¨ç‡æ•°æ®é™¤ä»¥10ã€‚ä»»ä½•åœ¨è¿™ä¸ªèŒƒå›´å¤–çš„æ•°æ®éƒ½æ˜¯æœ‰é—®é¢˜çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯¹äºæµé‡æ•°æ®ï¼ŒæŠŠä»–å½“æˆæœ‰ç¬¦å·æˆ–è€…æ²¡ç¬¦å·æ— æ‰€è°“ã€‚å› ä¸ºæ ·æœ¬æ˜¯30ç§’çš„æµé‡æ•°æ®ï¼Œå¦‚æœæœ‰40é‡è½¦é€šè¿‡é‚£å°±è¯´æ˜æ¯å°æ—¶ä¼šé€šè¿‡4800é‡è½¦ï¼Œå¹³å‡è½¦ä¸è½¦ä¹‹é—´å·®äº†0.75ç§’ã€‚è‚¯å®šæ˜¯ä¸å¯èƒ½ï¼Œæ‰€ä»¥æˆ‘å»ºè®®å¦‚æœæ•°æ®ä¸åœ¨0åˆ°40ä¹‹é—´ï¼Œé‚£å°±è¯´æ˜æ˜¯å¼‚å¸¸å€¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é‚£äº›ä¸åŒçš„è´Ÿæ•°æ˜¯æ•°æ®é‡‡é›†è½¯ä»¶çš„å°bugã€‚æœªæ¥æˆ‘ä»¬ä¼šä¿®å¤ä»–ä»¬ï¼Œæ‰€ä»¥å¯¹äºæµé‡æ•°æ®ï¼Œä»»ä½•ä¸åœ¨åˆç†èŒƒå›´çš„æ•°æ®éƒ½åº”è¯¥è¢«å½“æˆå¼‚å¸¸å€¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»¥ä¸Šæ ¼å¼ä¿¡æ¯ç”±TMC Mn/DOTçš„Doug Lauæä¾›ã€‚&lt;/p&gt;</description></item><item><title>GeoMAN: Multi-level Attention Networks for Geo-sensory Time Series Prediction</title><link>https://davidham3.github.io/blog/p/geoman-multi-level-attention-networks-for-geo-sensory-time-series-prediction/</link><pubDate>Mon, 09 Jul 2018 17:03:00 +0000</pubDate><guid>https://davidham3.github.io/blog/p/geoman-multi-level-attention-networks-for-geo-sensory-time-series-prediction/</guid><description>&lt;p&gt;IJCAI 2018ï¼Œçœ‹äº†ä¸€éƒ¨åˆ†ï¼Œè¿˜æ²¡çœ‹å®Œã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://www.ijcai.org/proceedings/2018/476" target="_blank" rel="noopener"
&gt;GeoMAN: Multi-level Attention Networks for Geo-sensory Time Series Prediction&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;å¤§é‡çš„ç›‘æµ‹å™¨è¢«éƒ¨ç½²åœ¨å„ä¸ªåœ°æ–¹ï¼Œè¿ç»­ååŒåœ°ç›‘æµ‹å‘¨å›´çš„ç¯å¢ƒï¼Œå¦‚ç©ºæ°”è´¨é‡ã€‚è¿™äº›æ£€æµ‹å™¨ç”Ÿæˆå¾ˆå¤šæ—¶ç©ºåºåˆ—æ•°æ®ï¼Œä¹‹é—´æœ‰ç€ç©ºé—´ç›¸å…³æ€§ã€‚é¢„æµ‹è¿™äº›æ—¶ç©ºæ•°æ®å¾ˆæœ‰æŒ‘æˆ˜ï¼Œå› ä¸ºé¢„æµ‹å—å¾ˆå¤šå› ç´ å½±å“ï¼Œæ¯”å¦‚åŠ¨æ€çš„æ—¶ç©ºå…³è”å’Œå…¶ä»–å› ç´ ã€‚æˆ‘ä»¬åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ä½¿ç”¨å¤šçº§åŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„ RNN æ¨¡å‹ï¼Œç»“åˆç©ºé—´ã€æ°”è±¡å’Œæ£€æµ‹å™¨æ•°æ®æ¥é¢„æµ‹æœªæ¥çš„ç›‘æµ‹æ•°å€¼ã€‚æˆ‘ä»¬çš„æ¨¡å‹ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¤šçº§æ³¨æ„åŠ›æœºåˆ¶å¯¹æ—¶ç©ºä¾èµ–å…³ç³»å»ºæ¨¡&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ªé€šç”¨çš„èåˆæ¨¡å—å¯¹å¤šé¢†åŸŸçš„å¤–éƒ¨ä¿¡æ¯è¿›è¡Œèåˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å®éªŒç”¨äº†ä¸¤ä¸ªçœŸå®çš„æ•°æ®é›†ï¼Œç©ºæ°”è´¨é‡æ•°æ®å’Œæ°´è´¨ç›‘æµ‹æ•°æ®ï¼Œç»“æœæ˜¾ç¤ºæˆ‘ä»¬çš„æ¨¡å‹æ¯”9ä¸ªbaselineséƒ½è¦å¥½ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 Introduction
&lt;/h1&gt;&lt;p&gt;ç°å®ä¸–ç•Œä¸­æœ‰å¤§é‡çš„æ£€æµ‹å™¨ï¼Œå¦‚ç©ºæ°”ç›‘æµ‹ç«™ã€‚æ¯ä¸ªç›‘æµ‹ç«™éƒ½æœ‰ä¸€ä¸ªåœ°ç†ä½ç½®ï¼Œä¸æ–­åœ°ç”Ÿæˆæ—¶é—´åºåˆ—æ•°æ®ã€‚ä¸€ç»„æ£€æµ‹å™¨ä¸æ–­çš„ç›‘æµ‹ä¸€ä¸ªåŒºåŸŸçš„ç¯å¢ƒï¼Œæ•°æ®é—´æœ‰ç©ºé—´ä¾èµ–å…³ç³»ã€‚æˆ‘ä»¬æˆè¿™æ ·çš„ç›‘æµ‹æ•°æ®ä¸º &lt;em&gt;geosensory time series&lt;/em&gt;ã€‚æ­¤å¤–ï¼Œä¸€ä¸ªæ£€æµ‹å™¨ç”Ÿæˆå¤šç§ geo-sensory æ—¶é—´åºåˆ—æ˜¯å¾ˆå¸¸è§çš„ï¼Œå› ä¸ºè¿™ä¸ªæ£€æµ‹å™¨åŒæ—¶ç›‘æµ‹ä¸åŒçš„ç›®æ ‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå›¾1aï¼Œè·¯ä¸Šçš„å¾ªç¯æ£€æµ‹å™¨å®æ—¶è®°å½•è½¦è¾†é€šè¡Œæƒ…å†µï¼Œä¹Ÿè®°å½•ä»–ä»¬çš„é€Ÿåº¦ã€‚å›¾1b å±•ç¤ºäº†æ£€æµ‹å™¨æ¯äº”åˆ†é’Ÿç”Ÿæˆçš„å…³äºæ°´è´¨çš„ä¸‰ä¸ªä¸åŒçš„æ°”å€™æŒ‡æ ‡ã€‚é™¤äº†ç›‘æµ‹ï¼Œå¯¹äº geo-sensory æ—¶é—´åºåˆ—é¢„æµ‹è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„éœ€æ±‚å°±æ˜¯äº¤é€šé¢„æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/geoman-multi-level-attention-networks-for-geo-sensory-time-series-prediction/Fig1.PNG"
loading="lazy"
alt="Fig1"
&gt;&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œé¢„æµ‹ geo-sensory æ—¶é—´åºåˆ—å¾ˆæœ‰æŒ‘æˆ˜æ€§ï¼Œä¸»è¦å—ä¸¤ä¸ªå› ç´ å½±å“ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŠ¨æ€æ—¶ç©ºå…³ç³»
Â·æ£€æµ‹å™¨é—´å¤æ‚çš„å…³ç³»ã€‚å›¾1cå±•ç¤ºäº†ä¸åŒæ£€æµ‹å™¨çš„æ—¶é—´åºåˆ—é—´çš„ç©ºé—´å…³ç³»æ˜¯é«˜åº¦åŠ¨æ€çš„ï¼Œéšç€æ—¶é—´ä¸æ–­æ”¹å˜ã€‚é™¤æ­¤ä»¥å¤–ï¼Œgeo-sensoryæ—¶é—´åºåˆ—æ ¹æ®åœ°åŒºæœ‰éçº¿æ€§çš„å˜åŒ–ã€‚å½“å¯¹åŠ¨æ€å…³ç³»å»ºæ¨¡æ—¶ï¼Œä¼ ç»Ÿæ–¹æ³•ï¼ˆå¦‚æ¦‚ç‡å›¾æ¨¡å‹ï¼‰çš„è®¡ç®—é‡ä¼šå¾ˆå¤§ï¼Œå› ä¸ºä»–ä»¬æœ‰å¾ˆå¤šå‚æ•°ã€‚
Â·æ£€æµ‹å™¨å†…éƒ¨çš„åŠ¨æ€å…³ç³»ã€‚é¦–å…ˆï¼Œä¸€ä¸ªgeo-sensoryæ—¶é—´åºåˆ—é€šå¸¸ç”±ä¸€ç§å‘¨æœŸæ¨¡å¼ï¼ˆå¦‚ï¼Œå›¾1cä¸­çš„$S_1$ï¼‰ï¼Œè¿™ç§æ¨¡å¼ä¸€ç›´å˜åŒ–ï¼Œå¹¶ä¸”åœ°ç†ä¸Šä¹Ÿæœ‰æ”¹å˜ã€‚å…¶æ¬¡ï¼Œæ£€æµ‹å™¨è®°å½•ç»å¸¸æœ‰å¾ˆå¤§çš„æŒ¯åŠ¨ï¼Œå¾ˆå¿«åœ°å‡å°‘å‰ä¸€ä¸ªæ•°å€¼çš„å½±å“ã€‚å› æ­¤ï¼Œå¦‚ä½•é€‰æ‹©ä¸€ä¸ªæ—¶é—´é—´éš”æ¥é¢„æµ‹ä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;å¤–éƒ¨å› ç´ ã€‚
æ£€æµ‹å™¨æ•°æ®ä¹Ÿè¢«å‘¨å›´çš„ç¯å¢ƒå½±å“ï¼Œæ¯”å¦‚æ°”è±¡ï¼ˆä¾‹å¦‚å¼ºé£ï¼‰ï¼Œå‡ ç‚¹ï¼ˆæ¯”å¦‚æ—©æ™šé«˜å³°ï¼‰è¿˜æœ‰åœŸåœ°ä½¿ç”¨æƒ…å†µç­‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ºäº†è§£å†³è¿™äº›æŒ‘æˆ˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªå¤šçº§æ³¨æ„åŠ›ç½‘ç»œï¼ˆGeoMANï¼‰æ¥é¢„æµ‹ä¸€ä¸ªæ£€æµ‹å™¨æœªæ¥å‡ ä¸ªå°æ—¶çš„æ•°å€¼ã€‚æˆ‘ä»¬çš„è´¡çŒ®æœ‰ä¸‰ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;em&gt;å¤šçº§æ³¨æ„åŠ›æœºåˆ¶&lt;/em&gt;ã€‚æˆ‘ä»¬ç ”å‘äº†ä¸€ä¸ªå¤šçº§æ³¨æ„åŠ›æœºåˆ¶å¯¹åŠ¨æ€æ—¶ç©ºå…³ç³»å»ºæ¨¡ã€‚å…·ä½“æ¥è¯´ï¼Œç¬¬ä¸€çº§ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–°çš„æ³¨æ„åŠ›æœºåˆ¶ï¼Œç”±å±€éƒ¨ç©ºé—´æ³¨æ„åŠ›å’Œå…¨å±€ç©ºé—´æ³¨æ„åŠ›ç»„æˆï¼Œç”¨æ¥æ•è·ä¸åŒæ£€æµ‹å™¨æ—¶é—´åºåˆ—é—´çš„å¤æ‚ç©ºé—´å…³ç³»ã€‚ç¬¬äºŒçº§ï¼Œæ—¶é—´æ³¨æ„åŠ›å¯¹ä¸€ä¸ªæ—¶é—´åºåˆ—ä¸­çš„åŠ¨æ€æ—¶é—´å…³ç³»è¿›è¡Œå»ºæ¨¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;em&gt;å¤–éƒ¨å› ç´ èåˆæ¨¡å‹&lt;/em&gt;ã€‚æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªé€šç”¨èåˆæ¨¡å‹èåˆä¸åŒé¢†åŸŸçš„å¤–éƒ¨å› ç´ ã€‚å­¦ä¹ åˆ°çš„éšå«è¡¨ç¤ºä¼šè¾“å…¥è‡³å¤šçº§æ³¨æ„åŠ›ç½‘ç»œä¸­æ¥æå‡è¿™äº›å¤–éƒ¨å› ç´ çš„é‡è¦æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;em&gt;çœŸå®çš„è¯„ä»·&lt;/em&gt;ã€‚æˆ‘ä»¬åŸºäºä¸¤ä¸ªçœŸå®çš„æ•°æ®é›†è¯„ä¼°æˆ‘ä»¬çš„æ–¹æ³•ã€‚å¤§é‡çš„å®éªŒè¯æ˜äº†æˆ‘ä»¬çš„æ–¹æ³•ç›¸æ¯”äºbaselineçš„ä¼˜è¶Šæ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="2-preliminary"&gt;2 Preliminary
&lt;/h1&gt;&lt;h2 id="21-notations"&gt;2.1 Notations
&lt;/h2&gt;&lt;p&gt;å‡è®¾ï¼Œæœ‰ $N_g$ ä¸ªæ£€æµ‹å™¨ï¼Œæ¯ä¸ªéƒ½ç”Ÿæˆ $N_l$ ç§æ—¶é—´åºåˆ—ã€‚æˆ‘ä»¬æŒ‡å®šå…¶ä¸­çš„ä¸€ä¸ªä¸º &lt;em&gt;target series&lt;/em&gt; æ¥é¢„æµ‹ï¼Œå…¶å®ƒåºåˆ—ä½œä¸ºç‰¹å¾ã€‚æ—¶é—´çª—ä¸º $T$ï¼Œæˆ‘ä»¬ä½¿ç”¨ $\mathbf{Y} = (\mathbf{y}^1, \mathbf{y}^2, &amp;hellip;, \mathbf{y}^{N_g}) \in \mathbb{R}^{N_g \times T}$ æ¥è¡¨ç¤ºæ‰€æœ‰ç›®æ ‡åºåˆ—åœ¨è¿‡å» $T$ ä¸ªå°æ—¶çš„ç›‘æµ‹å€¼ï¼Œå…¶ä¸­ $\mathbf{y}^i \in \mathbb{R}^T$ å±äºç›‘æµ‹å™¨ $i$ã€‚æˆ‘ä»¬ä½¿ç”¨ $\mathbf{X}^i = (\mathbf{x}^{i, 1}, \mathbf{x}^{i, 2}, &amp;hellip;, \mathbf{x}^{i, N_l})^{\rm T} = (\mathbf{x}^i_1, \mathbf{x}^i_2, &amp;hellip;, \mathbf{x}^i_T) \in \mathbb{R}^{N_l \times T}$ ä½œä¸ºæ£€æµ‹å™¨ $i$ çš„å±€éƒ¨ç‰¹å¾ï¼Œå…¶ä¸­ $\mathbf{x}^{i,k} \in \mathbb{R}^T$ æ˜¯è¿™ä¸ªæ£€æµ‹å™¨çš„ç¬¬ $k$ ä¸ªæ—¶é—´åºåˆ—ï¼Œ$\mathbf{x}^i_t = (x^{i,1}_t, x^{i,2}_t, &amp;hellip;, x^{i,N_l}_t)^{\rm T} \in \mathbb{R}^{N_l}$ è¡¨ç¤ºæ£€æµ‹å™¨ $i$ åœ¨æ—¶é—´ $t$ çš„æ‰€æœ‰æ—¶é—´åºåˆ—çš„å€¼ã€‚é™¤äº†æ£€æµ‹å™¨ $i$ çš„å±€éƒ¨ç‰¹å¾ï¼Œç”±äºä¸åŒæ£€æµ‹å™¨é—´çš„ç©ºé—´å…³ç³»ï¼Œå…¶ä»–çš„æ£€æµ‹å™¨ä¼šå…±äº«å¤§é‡å¯¹äºé¢„æµ‹æœ‰ç”¨çš„ä¿¡æ¯ã€‚ä¸ºäº†è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªæ£€æµ‹å™¨çš„å±€éƒ¨ç‰¹å¾èåˆåˆ°é›†åˆ $\mathcal{X}^i = \lbrace \mathbf{X}^1, \mathbf{X}^2, &amp;hellip;, \mathbf{X}^{N_g}\rbrace$ ä¸­ä½œä¸ºæ£€æµ‹å™¨ $i$ çš„å…¨å±€ç‰¹å¾ã€‚&lt;/p&gt;
&lt;h2 id="22-problem-statement"&gt;2.2 Problem Statement
&lt;/h2&gt;&lt;p&gt;ç»™å®šæ¯ä¸ªæ£€æµ‹å™¨ä¹‹å‰çš„å€¼å’Œå¤–éƒ¨å› ç´ ï¼Œé¢„æµ‹æ£€æµ‹å™¨ $i$ åœ¨æœªæ¥ $\tau$ ä¸ªå°æ—¶çš„å€¼ï¼Œè¡¨ç¤ºä¸º $\hat{\mathbf{y}}^i = (\hat{y}^i_{T+1}, \hat{y}^i_{T+2}, &amp;hellip;, \hat{y}^i_{T+\tau})^{\rm T} \in \mathbb{R}^{\tau}$.&lt;/p&gt;
&lt;h1 id="3-multi-level-attention-networks"&gt;3 Multi-level Attention Networks
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/geoman-multi-level-attention-networks-for-geo-sensory-time-series-prediction/Fig2.PNG"
loading="lazy"
alt="Fig2"
&gt;&lt;/p&gt;
&lt;p&gt;å›¾ 2 å±•ç¤ºäº†æˆ‘ä»¬æ–¹æ³•çš„æ¡†æ¶ã€‚åŸºäºç¼–ç è§£ç æ¶æ„[Cho et al., 2014b]ï¼Œæˆ‘ä»¬ç”¨ä¸¤ä¸ªåˆ†å¼€çš„ LSTMï¼Œä¸€ä¸ªå¯¹è¾“å…¥åºåˆ—ç¼–ç ï¼Œä¹Ÿå°±æ˜¯å¯¹å†å²çš„ geo-sensory æ—¶é—´åºåˆ—ï¼Œå¦ä¸€ä¸ªæ¥é¢„æµ‹è¾“å‡ºçš„åºåˆ— $\hat{y}^i$ã€‚æ›´å…·ä½“çš„è®²ï¼Œæˆ‘ä»¬çš„æ¨¡å‹ GeoMAN æœ‰ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¤šçº§æ³¨æ„åŠ›æœºåˆ¶ã€‚åŒ…å«ä¸€ä¸ªå¸¦æœ‰ä¸¤ç±»ç©ºé—´æ³¨æ„åŠ›æœºåˆ¶çš„ç¼–ç å™¨å’Œä¸€ä¸ªå¸¦æœ‰æ—¶é—´æ³¨æ„åŠ›çš„è§£ç å™¨ã€‚åœ¨ç¼–ç å™¨ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸¤ç§ä¸åŒçš„æ³¨æ„åŠ›æœºåˆ¶ï¼Œå±€éƒ¨ç©ºé—´æ³¨æ„åŠ›å’Œå…¨å±€ç©ºé—´æ³¨æ„åŠ›ï¼Œå¦‚å›¾ 2 æ‰€ç¤ºï¼Œè¿™ä¸¤ç§æ³¨æ„åŠ›æœºåˆ¶é€šè¿‡å‰å‡ æ­¥ç¼–ç å™¨çš„éšè—çŠ¶æ€ã€å‰å‡ æ­¥æ£€æµ‹å™¨çš„å€¼å’Œç©ºé—´ä¿¡æ¯ï¼ˆæ£€æµ‹å™¨ç½‘ç»œï¼‰ï¼Œå¯ä»¥åœ¨æ¯ä¸ªæ—¶é—´æ­¥ä¸Šæ•è·æ£€æµ‹å™¨é—´çš„å¤æ‚å…³ç³»ã€‚åœ¨è§£ç å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªæ—¶é—´æ³¨æ„åŠ›æœºåˆ¶æ¥è‡ªé€‚åº”åœ°é€‰æ‹©ä¹‹å‰çš„æ—¶é—´æ®µæ¥åšé¢„æµ‹ã€‚&lt;/li&gt;
&lt;li&gt;å¤–éƒ¨å› ç´ èåˆã€‚è¿™ä¸ªæ¨¡å—ç”¨æ¥å¤„ç†å¤–éƒ¨å› ç´ çš„å½±å“ï¼Œè¾“å‡ºä¼šä½œä¸ºè§£ç å™¨çš„ä¸€éƒ¨åˆ†è¾“å…¥ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ $h_t \in \mathbb{R}^m$ å’Œ $s_t \in \mathbb{R}^m$ æ¥è¡¨ç¤ºç¼–ç å™¨åœ¨æ—¶é—´ $t$ çš„éšè—çŠ¶æ€å’Œç»†èƒçŠ¶æ€ã€‚$d_t \in \mathbb{R}^n$ å’Œ $s&amp;rsquo; \in \mathbb{R}^n$ è¡¨ç¤ºè§£ç å™¨çš„éšè—çŠ¶æ€å’Œç»†èƒçŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="31-spatial-attention"&gt;3.1 Spatial Attention
&lt;/h2&gt;&lt;h3 id="local-spatial-attention"&gt;Local Spatial Attention
&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬å…ˆä»‹ç»ç©ºé—´å±€éƒ¨æ³¨æ„åŠ›æœºåˆ¶ã€‚å¯¹åº”ä¸€ä¸ªç›‘æµ‹å™¨ï¼Œåœ¨å®ƒçš„å±€éƒ¨æ—¶é—´åºåˆ—ä¸Šæœ‰å¤æ‚çš„å…³è”æ€§ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªç©ºæ°”è´¨é‡æ£€æµ‹ç«™ä¼šè®°å½•ä¸åŒçš„æ—¶é—´åºåˆ—å¦‚ PM2.5ï¼ŒNO å’Œ SO2ã€‚äº‹å®ä¸Šï¼ŒPM2.5 çš„æµ“åº¦é€šå¸¸è¢«å…¶ä»–æ—¶é—´åºåˆ—å½±å“ï¼ŒåŒ…æ‹¬å…¶ä»–çš„ç©ºæ°”æ±¡æŸ“ç‰©å’Œå±€éƒ¨ç©ºæ°”è´¨é‡ [Wang et al., 2005]ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç»™å®šç¬¬ $i$ ä¸ªæ£€æµ‹å™¨ç¬¬ $k$ ä¸ªå±€éƒ¨ç‰¹å¾å‘é‡ $\mathbf{x}^{i,k}$ï¼Œæˆ‘ä»¬ä½¿ç”¨æ³¨æ„åŠ›æœºåˆ¶è‡ªé€‚åº”åœ°æ•è·ç›®æ ‡åºåˆ—å’Œæ¯ä¸ªå±€éƒ¨ç‰¹å¾é—´çš„åŠ¨æ€å…³ç³»ï¼š&lt;/p&gt;
$$\tag{1}
e^k\_t = \mathbf{v}^T\_l \text{tanh} (\mathbf{W}\_l [\mathbf{h}\_{t-1};\mathbf{s}\_{t-1}] + \mathbf{U}\_l \mathbf{x}^{i,k} + \mathbf{b}\_l)
$$$$\tag{2}
\alpha^k\_t = \frac{\text{exp}(e^k\_t)}{\sum^{N\_l}\_{j=1}\text{exp}(e^j\_t)}.
$$&lt;p&gt;å…¶ä¸­ $[\cdot;\cdot]$ æ˜¯æ‹¼æ¥æ“ä½œï¼ˆè®ºæ–‡è¿™é‡Œå†™çš„æ˜¯ concentrationï¼Œæˆ‘æ€ä¹ˆè§‰å¾—æ˜¯concatenationå‘¢ã€‚ã€‚ã€‚ï¼‰ã€‚$\mathbf{v}_l, \mathbf{b}_l \in \mathbb{R}^T, \mathbf{W}_l \in \mathbb{R}^{T \times 2m}, \mathbf{U}_l \in \mathbb{R}^{T \times T}$ æ˜¯å‚æ•°ã€‚å±€éƒ¨ç‰¹å¾çš„æ³¨æ„åŠ›æƒé‡é€šè¿‡ç¼–ç å™¨ä¸­è¾“å…¥çš„å±€éƒ¨ç‰¹å¾å’Œå†å²çŠ¶æ€å…±åŒå†³å®šã€‚è¿™ä¸ªæ³¨æ„åŠ›åˆ†æ•°è¯­ä¹‰ä¸Šè¡¨ç¤ºæ¯ä¸ªå±€éƒ¨ç‰¹å¾çš„é‡è¦æ€§ï¼Œå±€éƒ¨ç©ºé—´æ³¨æ„åŠ›åœ¨æ—¶é—´æ­¥ $t$ çš„è¾“å‡ºå‘é‡é€šè¿‡ä¸‹å¼è®¡ç®—ï¼š&lt;/p&gt;
$$\tag{3}
\tilde{\mathbf{x}}^{local}\_t = (\alpha^1\_t x^{i,1}\_t, \alpha^2\_t x^{i,2}\_t, \dots, \alpha^{N\_l}\_t x^{i,N\_l}\_t)^{\rm T}.
$$&lt;h3 id="global-spatial-attention"&gt;Global Spatial Attention
&lt;/h3&gt;&lt;p&gt;å¯¹äºä¸€ä¸ªç›‘æµ‹å™¨è®°å½•çš„ç›®æ ‡æ—¶é—´åºåˆ—ï¼Œå…¶ä»–ç›‘æµ‹å™¨æ˜¯æ—¶é—´åºåˆ—å¯¹å…¶æœ‰ç›´æ¥å½±å“ã€‚ç„¶è€Œï¼Œå½±å“æƒé‡æ˜¯é«˜åº¦åŠ¨æ€åœ°ï¼Œéšæ—¶é—´å˜åŒ–ã€‚å› ä¸ºå¯èƒ½æœ‰å¾ˆå¤šä¸ç›¸å…³çš„åºåˆ—ï¼Œç›´æ¥ä½¿ç”¨å„ç§æ—¶é—´åºåˆ—ä½œä¸ºç¼–ç å™¨çš„è¾“å…¥æ¥æ•è·ä¸åŒç›‘æµ‹å™¨ä¹‹é—´çš„å…³ç³»ä¼šå¯¼è‡´å¾ˆé«˜çš„è®¡ç®—å¼€é”€å¹¶ä¸”é™ä½æ¨¡å‹çš„èƒ½åŠ›ã€‚è€Œä¸”è¿™æ ·çš„å½±å“æƒé‡å—å…¶ä»–ç›‘æµ‹å™¨çš„å±€éƒ¨æ¡ä»¶å½±å“ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“å¼ºé£ä»ä¸€ä¸ªé¥è¿œåœ°åœ°æ–¹å¹è¿‡æ¥ï¼Œè¿™ä¸ªåŒºåŸŸçš„ç©ºæ°”è´¨é‡å›æ¯”ä¹‹å‰å—å½±å“çš„å¤šã€‚å—è¿™ä¸ªç°è±¡çš„å¯å‘ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªæ–°çš„æ³¨æ„åŠ›æœºåˆ¶æ•è·ä¸åŒç›‘æµ‹å™¨é—´çš„åŠ¨æ€å…³ç³»ã€‚ç»™å®šç¬¬ $i$ ä¸ªç›‘æµ‹å™¨ä½œä¸ºæˆ‘ä»¬çš„é¢„æµ‹ç›®æ ‡ï¼Œå¦ä¸€ä¸ªç›‘æµ‹å™¨ $l$ï¼Œæˆ‘ä»¬è®¡ç®—ä»–ä»¬ä¹‹é—´çš„æ³¨æ„åŠ›åˆ†æ•°å¦‚ä¸‹ï¼š&lt;/p&gt;
$$
g^l\_t = \mathbf{v}^{\rm T}\_g \text{tanh} (\mathbf{W}\_g [\mathbf{h}\_{t-1}; \mathbf{s}\_{t-1}] + \mathbf{U}\_g \mathbf{y}^l + \mathbf{W}'\_g \mathbf{X}^l \mathbf{u}\_g + \mathbf{b}\_g),
$$&lt;p&gt;å…¶ä¸­ $\mathbf{v}_g, \mathbf{u}_g, \mathbf{b}_g \in \mathbb{R}^T, \mathbf{W}_g \in \mathbb{R}^{T \times 2m}, \mathbf{U}_g \in \mathbb{R}^{T \times T}, \mathbf{W}&amp;rsquo;_g \in \mathbb{R}^{T \times N_l}$ æ˜¯å‚æ•°ã€‚é€šè¿‡è€ƒè™‘ç›®æ ‡åºåˆ—å’Œå…¶ä»–æ£€æµ‹å™¨çš„å±€éƒ¨ç‰¹å¾ï¼Œè¿™ä¸ªæ³¨æ„åŠ›æœºåˆ¶å¯ä»¥è‡ªé€‚åº”åœ°é€‰æ‹©ç›¸å…³çš„ç›‘æµ‹å™¨æ¥åšé¢„æµ‹ã€‚åŒæ—¶ï¼Œé€šè¿‡è€ƒè™‘ç¼–ç å™¨å†…å‰ä¸€éšè—çŠ¶æ€å’Œç»†èƒçŠ¶æ€ï¼Œå†å²ä¿¡æ¯ä¼šè·¨æ—¶é—´æµåŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼Œç©ºé—´å› ç´ ä¹Ÿä¼šå¯¹ä¸åŒç›‘æµ‹å™¨ä¹‹é—´çš„å…³ç³»åšå‡ºè´¡çŒ®ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œgeo-sensors é€šè¿‡ä¸€ä¸ªæ˜ç¡®çš„æˆ–éšå«çš„ç½‘ç»œè¿æ¥èµ·æ¥ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªçŸ©é˜µ $\mathbf{P} \in \mathbb{R}^{N_g \times N_g}$ æ¥è¡¡é‡åœ°ç†ç©ºé—´ç›¸ä¼¼åº¦ï¼ˆå¦‚åœ°ç†è·ç¦»çš„å€’æ•°ï¼‰ï¼Œ$P_{i,j}$ è¡¨ç¤ºç›‘æµ‹å™¨ $i$ å’Œ $j$ ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚ä¸åŒäºæ³¨æ„åŠ›æƒé‡ï¼Œåœ°ç†ç›¸ä¼¼åº¦å¯ä»¥çœ‹ä½œæ˜¯å…ˆéªŒçŸ¥è¯†ã€‚ç‰¹åˆ«çš„è¯´ï¼Œå¦‚æœ $N_g$ å¾ˆå¤§ï¼Œä¸€ä¸ªæ–¹æ³•æ˜¯ä½¿ç”¨æœ€è¿‘é‚»æˆ–æœ€ç›¸è¿‘çš„ä¸€ç»„è€Œä¸æ˜¯æ‰€æœ‰çš„ç›‘æµ‹å™¨ã€‚ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª softmax å‡½æ•°ï¼Œç¡®å®šæ‰€æœ‰çš„æ³¨æ„åŠ›æƒé‡ä¹‹å’Œä¸º1ï¼Œä¸¤ä¸ªæ–¹æ³•å…±åŒè€ƒè™‘åœ°ç†ç›¸ä¼¼åº¦å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{4}
\beta^l\_t = \frac{\text{exp}((1-\lambda)g^l\_t + \lambda P\_{i,l})}{\sum^{N\_g}\_{j=1} \text{exp}((1-\lambda)g^j\_t + \lambda P\_{i,j})},
$$&lt;p&gt;å…¶ä¸­ï¼Œ$\lambda$ æ˜¯ä¸€ä¸ªå¯è°ƒçš„è¶…æƒ¨ã€‚å¦‚æœ $\lambda$ å¤§ï¼Œè¿™é¡¹ä¼šå¼ºåˆ¶æ³¨æ„åŠ›æƒé‡ç­‰äºåœ°ç†ç›¸ä¼¼åº¦ã€‚å…¨å±€æ³¨æ„åŠ›çš„è¾“å‡ºå‘é‡è®¡ç®—å¦‚ä¸‹ï¼š&lt;/p&gt;
$$\tag{5}
\tilde{\mathbf{x}}^{global}\_t = (\beta^1\_t y^1\_t, \beta^2\_t y^2\_t, \dots, \beta^{N\_g}\_t y^{N\_g}\_t)^{\rm T}.
$$&lt;h2 id="32-temporal-attention"&gt;3.2 Temporal Attention
&lt;/h2&gt;&lt;p&gt;å› ä¸ºç¼–ç è§£ç ç»“æ„ä¼šéšç€é•¿åº¦å¢é•¿ä¼šå¾ˆå¿«çš„é™ä½æ€§èƒ½ï¼Œä¸€ä¸ªé‡è¦çš„æ‰©å±•æ˜¯å¢åŠ æ—¶é—´æ³¨æ„åŠ›æœºåˆ¶ï¼Œå¯ä»¥è‡ªé€‚åº”åœ°é€‰æ‹©ç¼–ç å™¨ç›¸å…³çš„éšè—çŠ¶æ€æ¥ç”Ÿæˆè¾“å‡ºåºåˆ—ï¼Œå³æ¨¡å‹å¯¹ç›®æ ‡åºåˆ—ä¸­ä¸åŒæ—¶é—´é—´éš”çš„åŠ¨æ€æ—¶é—´å…³ç³»å»ºæ¨¡ã€‚ç‰¹åˆ«æ¥è¯´ï¼Œä¸ºäº†è®¡ç®—æ¯ä¸ªè¾“å‡ºæ—¶é—´ $t&amp;rsquo;$ å¯¹ç¼–ç å™¨æ¯ä¸ªéšè—çŠ¶æ€çš„çš„æ³¨æ„åŠ›å‘é‡ï¼Œæˆ‘ä»¬å®šä¹‰ï¼š&lt;/p&gt;
$$\tag{6}
u^o\_{t'} = \mathbf{v}^{\rm T}\_d \text{tanh} (\mathbf{W}'\_d [\mathbf{d}\_{t'-1}; \mathbf{s}'\_{t'-1}] + \mathbf{W}\_d \mathbf{h}\_o + \mathbf{b}\_d),
$$$$\tag{7}
\gamma^o\_{t'} = \frac{\text{exp} (u^o\_{t'})}{\sum^T\_{o=1} \gamma^o\_{t'} \mathbf{h}\_o},
$$$$\tag{8}
\mathbf{c}\_{t'} = \sum^T\_{o=1} \gamma^o\_{t'} \mathbf{h}\_o,
$$&lt;h2 id="33-external-factor-fusion"&gt;3.3 External Factor Fusion
&lt;/h2&gt;&lt;p&gt;Geo-sensory æ—¶é—´åºåˆ—å’Œç©ºé—´å› ç´ æœ‰å¼ºçƒˆçš„ç›¸å…³æ€§ï¼Œå¦‚ POI å’Œç›‘æµ‹å™¨ç½‘ç»œã€‚è¿™äº›å› ç´ ä¸€èµ·è¡¨ç¤ºä¸€ä¸ªåŒºåŸŸçš„åŠŸèƒ½ã€‚è€Œä¸”è¿˜æœ‰å¾ˆå¤šæ—¶é—´å› ç´ å½±å“ç›‘æµ‹å™¨çš„æ•°å€¼ï¼Œå¦‚æ°”è±¡æˆ–æ—¶é—´ã€‚å—ä¹‹å‰å·¥ä½œçš„å¯å‘ [Liang et al., 2017; Wang et al., 2018] ä¸“æ³¨æ—¶ç©ºåº”ç”¨ä¸­çš„å¤–éƒ¨å› ç´ çš„å½±å“ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªç®€å•æœ‰æ•ˆçš„ç»„ä»¶æ¥å¤„ç†è¿™äº›å› ç´ ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚å›¾ 2 æ‰€ç¤ºï¼Œæˆ‘ä»¬å…ˆå°†åŒ…å«æ—¶é—´ã€æ°”è±¡ç‰¹å¾çš„æ—¶é—´å› ç´ å’Œè¡¨ç¤ºç›®æ ‡ç›‘æµ‹å™¨çš„ç›‘æµ‹å™¨IDèåˆã€‚å› ä¸ºæœªæ¥çš„å¤©æ°”æ¡ä»¶æœªçŸ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨å¤©æ°”é¢„æŠ¥æ¥æå‡æ€§èƒ½ã€‚è¿™äº›å› ç´ çš„å¤§éƒ¨åˆ†éƒ½æ˜¯ç¦»æ•£ç‰¹å¾ï¼Œä¸èƒ½ç›´æ¥æ”¾åˆ°ç¥ç»ç½‘ç»œé‡Œé¢ï¼Œæˆ‘ä»¬é€šè¿‡å°†ç¦»æ•£ç‰¹å¾åˆ†å¼€æ”¾å…¥ä¸åŒçš„åµŒå…¥å±‚ï¼Œå°†ç¦»æ•£ç‰¹å¾è½¬æ¢ä¸ºä½ç»´å‘é‡ã€‚æ ¹æ®ç©ºé—´å› ç´ ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸åŒ POI ç±»å‹çš„å¯†åº¦ä½œä¸ºç‰¹å¾ã€‚å› ä¸ºç›‘æµ‹å™¨çš„å±æ€§ä¾èµ–å®é™…æƒ…å†µï¼Œæˆ‘ä»¬åªä½¿ç”¨ç½‘ç»œçš„ç»“æ„ç‰¹å¾ï¼Œå¦‚é‚»å±…æ•°å’Œäº¤é›†ç­‰ã€‚æœ€åï¼Œæˆ‘ä»¬å°†è·å¾—çš„åµŒå…¥å‘é‡å’Œç©ºé—´ç‰¹å¾æ‹¼æ¥ä½œä¸ºè¿™ä¸ªæ¨¡å—çš„è¾“å‡ºï¼Œè¡¨ç¤ºä¸º $\mathbf{ex}_{t&amp;rsquo;} \in \mathbb{R}^{N_e}$ï¼Œå…¶ä¸­ $t&amp;rsquo;$ æ˜¯è§£ç å™¨ä¸­æœªæ¥çš„æ—¶é—´æ­¥ã€‚&lt;/p&gt;
&lt;h2 id="34-encoder-decoder--model-training"&gt;3.4 Encoder-decoder &amp;amp; Model Training
&lt;/h2&gt;&lt;p&gt;ç¼–ç å™¨ä¸­ï¼Œæˆ‘ä»¬ç®€å•åœ°ä»å±€éƒ¨ç©ºé—´æ³¨æ„åŠ›å’Œå…¨å±€ç©ºé—´æ³¨æ„åŠ›èšåˆè¾“å‡ºï¼š&lt;/p&gt;
$$\tag{9}
\tilde{\mathbf{x}}\_t = [\tilde{\mathbf{x}}^{local}\_t; \tilde{\mathbf{x}}^{global}\_t],
$$&lt;p&gt;å…¶ä¸­ $\tilde{\mathbf{x}}_t \in \mathbb{R}^{N_l + N_g}$ã€‚æˆ‘ä»¬å°†æ‹¼æ¥ $\tilde{\mathbf{x}}_t$ ä½œä¸ºç¼–ç å™¨çš„æ–°è¾“å…¥ï¼Œä½¿ç”¨ $\mathbf{h}_t = f_e(\mathbf{h}_{t-1}, \tilde{\mathbf{x}}_t)$ æ›´æ–°æ—¶é—´ $t$ çš„éšè—çŠ¶æ€ï¼Œ$f_e$ æ˜¯ä¸€ä¸ª LSTM å•å…ƒã€‚&lt;/p&gt;
&lt;p&gt;è§£ç å™¨ä¸­ï¼Œä¸€æ—¦æˆ‘ä»¬è·å¾—äº†æ—¶é—´ $t&amp;rsquo;$ çš„ä¸Šä¸‹æ–‡å‘é‡ $\mathbf{c}_{t&amp;rsquo;}$ çš„å¸¦æƒå’Œï¼Œæˆ‘ä»¬å°†ä»–ä¸å¤–éƒ¨å› ç´ èåˆæ¨¡å—çš„è¾“å‡º $\mathbf{ex}_{t&amp;rsquo;}$ è¿˜æœ‰è§£ç å™¨çš„æœ€åä¸€ä¸ªè¾“å‡º $\hat{y}^i_{t&amp;rsquo;-1}$ èåˆï¼Œç”¨ $\mathbf{d}_{t&amp;rsquo;} = f_d (\mathbf{d}_{t&amp;rsquo;-1}, [\hat{y}^i_{t&amp;rsquo;-1}; \mathbf{ex}_{t&amp;rsquo;}; \mathbf{c}_{t&amp;rsquo;}])$ æ›´æ–°è§£ç å™¨çš„éšè—çŠ¶æ€ï¼Œ$f_d$ æ˜¯è§£ç å™¨ä¸­ä½¿ç”¨çš„ LSTM å•å…ƒã€‚ç„¶åï¼Œæˆ‘ä»¬è®²ä¸Šä¸‹æ–‡å‘é‡ $\mathbf{c}_{t&amp;rsquo;}$ å’Œéšè—çŠ¶æ€ $\mathbf{d}_{t&amp;rsquo;}$ æ‹¼æ¥ï¼Œå¾—åˆ°æ–°çš„éšè—çŠ¶æ€ï¼Œç„¶ååšæœ€åçš„é¢„æµ‹ï¼š&lt;/p&gt;
$$\tag{10}
\hat{y}^i\_{t'} = \mathbf{v}^{\rm T}\_y (\mathbf{W}\_m [\mathbf{c}\_{t'}; \mathbf{b}\_{t'}] + \mathbf{b}\_m) + b\_y,
$$&lt;p&gt;å…¶ä¸­ï¼Œ$\mathbf{W}_m \in \mathbb{R}^{n \times (m + n))}$ å’Œ $\mathbf{b}_m \in \mathbb{R}^n$ å°† $[\mathbf{c}_{t&amp;rsquo;}; \mathbf{d}_{t&amp;rsquo;}] \in \mathbb{R}^{m + n}$ æ˜ å°„åˆ°è§£ç å™¨éšè—çŠ¶æ€çš„ç©ºé—´ã€‚æœ€åï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªçº¿æ€§å˜æ¢ç”Ÿæˆæœ€ç»ˆç»“æœã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºæˆ‘ä»¬çš„æ–¹æ³•æ˜¯å¹³æ»‘ä¸”å¯å¾®çš„ï¼Œå¯ä»¥é€šè¿‡åå‘ä¼ æ’­è®­ç»ƒã€‚åœ¨è®­ç»ƒæ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ Adamï¼Œæœ€å°åŒ– MSEã€‚&lt;/p&gt;
$$\tag{11}
\mathcal{L}(\theta) = \Vert \hat{\mathbf{y}}^i - \mathbf{y}^i \Vert^2\_2,
$$&lt;h1 id="4-experiments"&gt;4 Experiments
&lt;/h1&gt;&lt;h2 id="41-settings"&gt;4.1 Settings
&lt;/h2&gt;&lt;h3 id="datasets"&gt;Datasets
&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸­å¼€å±•äº†å®éªŒï¼Œæ¯ä¸ªæ•°æ®é›†åŒ…å«ä¸‰ä¸ªå­é›†ï¼šæ°”è±¡æ•°æ®ã€POIã€ç›‘æµ‹å™¨ç½‘ç»œæ•°æ®ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ°´è´¨æ•°æ®é›†ï¼šä¸­å›½ä¸œå—çš„ä¸€ä¸ªåŸå¸‚çš„ä¾›æ°´ç³»ç»Ÿä¸­çš„ç›‘æµ‹å™¨æä¾›äº†é•¿è¾¾ä¸‰å¹´çš„æ¯5åˆ†é’Ÿä¸€ä¸ªè®°å½•çš„æ•°æ®ï¼ŒåŒ…å«äº†æ®‹ä½™æ°¯(RC)ã€æµ‘æµŠåº¦å’ŒPHå€¼ç­‰ã€‚æˆ‘ä»¬å°† RC ä½œä¸ºç›®æ ‡æ—¶é—´åºåˆ—ï¼Œå› ä¸ºå®ƒåœ¨ç¯å¢ƒç§‘å­¦ä¸­ä½œä¸ºå¸¸ç”¨çš„æ°´è´¨æŒ‡æ ‡ã€‚ä¸€å…±æœ‰ 14 ä¸ªç›‘æµ‹å™¨ï¼Œç›‘æµ‹ 10 ä¸ªæŒ‡æ ‡ï¼Œå®ƒä»¬ä¹‹é—´é€šè¿‡ç®¡é“ç½‘ç»œç›¸è¿ã€‚æˆ‘ä»¬ä½¿ç”¨ Liu et al., 2016a æå‡ºçš„æŒ‡æ ‡ä½œä¸ºè¿™ä¸ªæ•°æ®é›†çš„ç›¸ä¼¼åº¦çŸ©é˜µã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç©ºæ°”è´¨é‡ï¼šä»ä¸€ä¸ªå…¬å¼€æ•°æ®é›†æŠ“å–çš„ï¼Œè¿™ä¸ªæ•°æ®é›†åŒ…å«ä¸åŒæ±¡æŸ“ç‰©çš„æµ“åº¦ï¼Œè¿˜æœ‰æ°”è±¡æ•°æ®ï¼ŒåŒ—äº¬åœ°åŒºä¸€å…± 35 ä¸ªç›‘æµ‹å™¨ã€‚ä¸»è¦æ±¡æŸ“ç‰©æ˜¯ PM2.5ï¼Œå› æ­¤æˆ‘ä»¬å°†å®ƒä½œä¸ºç›®æ ‡ã€‚æˆ‘ä»¬åªä½¿ç”¨ç©ºé—´è·ç¦»çš„å€’æ•°è¡¨ç¤ºä¸¤ä¸ªç›‘æµ‹å™¨ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/geoman-multi-level-attention-networks-for-geo-sensory-time-series-prediction/Table1.JPG"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºæ°´è´¨æ•°æ®é›†ï¼Œæˆ‘ä»¬å°†æ•°æ®åˆ†æˆäº†ä¸é‡å çš„è®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†ï¼Œå»å¹´çš„å‰ä¸€åŠä½œä¸ºéªŒè¯æœºï¼Œå»å¹´çš„ååŠæ®µä½œä¸ºæµ‹è¯•é›†ã€‚å¯æƒœçš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨ç¬¬äºŒä¸ªæ•°æ®é›†ä¸Šæ²¡èƒ½è·å¾—å¾ˆå¤šçš„æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨äº†8ï¼š1ï¼š1çš„æ¯”ä¾‹åˆ’åˆ†ã€‚&lt;/p&gt;
&lt;h3 id="evaluation-metrics"&gt;Evaluation Metrics
&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨å¤šä¸ªæ ‡å‡†è¯„ä»·æ¨¡å‹ï¼ŒRMSE å’Œ MAEã€‚&lt;/p&gt;
&lt;h3 id="hyperparameters"&gt;Hyperparameters
&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬ä»¤ $\tau = 6$ï¼ŒåšçŸ­æœŸé¢„æµ‹ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œbatch size 256ï¼Œå­¦ä¹ ç‡ 0.001ã€‚å¤–éƒ¨å› ç´ èåˆæ¨¡å—ï¼Œæˆ‘ä½¿ç”¨ $\mathbb{R}^6$ åµŒå…¥ç›‘æµ‹å™¨ IDï¼Œæ—¶é—´ç‰¹å¾ $\mathbb{R}^10$ã€‚æˆ‘ä»¬çš„æ¨¡å‹ä¸€å…± 4 ä¸ªè¶…å‚æ•°ï¼Œ$\lambda$ æ ¹æ®ç»éªŒè®¾ç½®ï¼Œä» 0.1 åˆ° 0.5ã€‚å¯¹äºçª—å£é•¿åº¦ $T$ï¼Œæˆ‘ä»¬è®¾ä¸º $T \in \lbrace 6, 12, 24, 36, 48 \rbrace$ã€‚ä¸ºäº†ç®€å•ï¼Œæˆ‘ä»¬å°†ç¼–ç å™¨å’Œè§£ç å™¨é‡‡ç”¨åŒæ ·çš„éšè—ç»´æ•°ï¼Œç½‘æ ¼æœç´¢ $\lbrace 32, 64, 128, 256\rbrace$ã€‚æˆ‘ä»¬å †å  LSTM æ¥æé«˜æ€§èƒ½ï¼Œå±‚æ•°è®°ä¸º $q$ã€‚éªŒè¯é›†ä¸Šå¾—åˆ°çš„æœ€å¥½å‚æ•°æ˜¯ $q = 2, m = n = 64, \lambda = 2$ã€‚&lt;/p&gt;
&lt;h2 id="42-baselines"&gt;4.2 Baselines
&lt;/h2&gt;&lt;p&gt;ARIMA, VAR, GBRT, FFA, stMTMVL, stDNN, LSTM, Seq2seq, DA-RNNã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº ARIMAï¼Œæˆ‘ä»¬ç”¨å‰å…­ä¸ªå°æ—¶çš„æ•°æ®ä½œä¸ºè¾“å…¥ã€‚stMTMVL å’Œ FFAï¼Œæˆ‘ä»¬ä½¿ç”¨å’Œä½œè€…ä¸€æ ·çš„è®¾ç½®ã€‚å’Œ GeoMAN ç±»ä¼¼ï¼Œæˆ‘ä»¬ä½¿ç”¨å‰ $T \in \lbrace 6, 12, 24, 36, 48\rbrace$ ä¸ªå°æ—¶çš„æ•°æ®ä½œä¸ºå…¶ä»–æ¨¡å‹çš„è¾“å…¥ã€‚æœ€åï¼Œæˆ‘ä»¬æµ‹è¯•äº†ä¸åŒçš„è¶…å‚æ•°ï¼Œå¾—åˆ°äº†æ¯ä¸ªæ¨¡å‹çš„æœ€å¥½æ•ˆæœã€‚&lt;/p&gt;
&lt;h2 id="43-model-comparsion"&gt;4.3 Model Comparsion
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šæ¯”è¾ƒäº†æ¨¡å‹å’Œ baselinesã€‚ä¸ºäº†å…¬å¹³ï¼Œæˆ‘ä»¬åœ¨è¡¨ 2 å±•ç¤ºäº†æ¯ä¸ªæ–¹æ³•çš„æœ€å¥½æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„æ–¹æ³•åœ¨æ°´è´¨é¢„æµ‹ä¸Šå¾—åˆ°äº†æœ€å¥½çš„æ€§èƒ½ã€‚æ¯” state-of-the-art çš„ DA-RNN åœ¨ä¸¤ä¸ªæŒ‡æ ‡ä¸Šåˆ†åˆ«æå‡äº† 14.2% å’Œ 13.5%ã€‚å› ä¸º RC æµ“åº¦æœ‰ä¸€ä¸ªç¡®å®šçš„å‘¨æœŸæ¨¡å¼ï¼ŒstDNN å’Œ åŸºäº RNN çš„æ¨¡å‹æ¯” stMTMVL å’Œ FFA è·å¾—äº†æ›´å¥½çš„æ•ˆæœï¼Œå› ä¸ºä»–ä»¬èƒ½æ•è·æ›´é•¿çš„æ—¶é—´ä¾èµ–ã€‚å¯¹æ¯” LSTM æ™ºèƒ½é¢„æµ‹ä¸€ä¸ªæœªæ¥çš„æ—¶é—´æ­¥ï¼ŒGeoMAN å’Œ Seq2seq ç”±äºè§£ç å™¨çš„å­˜åœ¨æœ‰å¾ˆå¤§çš„æå‡ã€‚GBRT æ¯”å¤§éƒ¨åˆ†æ–¹æ³•ä¹Ÿè¦å¥½ï¼Œä½“ç°äº†é›†æˆå­¦ä¹ çš„ä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹æ¯”æ•°æ®ç›¸å¯¹ç¨³å®šçš„æ°´è´¨æ•°æ®é›†ï¼ŒPM2.5 çš„æµ“åº¦æœ‰äº›æ—¶å€™éœ‡è¡å¾—å¾ˆå‰å®³ï¼Œä½¿å¾—å¾ˆéš¾é¢„æµ‹ã€‚è¡¨ 2 å±•ç¤ºäº†åŒ—äº¬çš„ç©ºæ°”è´¨é‡æ•°æ®é›†ä¸Šä¸€ä¸ªå…¨é¢çš„å¯¹æ¯”ã€‚å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ¨¡å‹æœ‰æœ€å¥½çš„æ•ˆæœã€‚æˆ‘ä»¬ä¸»è¦è®¨è®ºä¸‹ MAEã€‚æˆ‘ä»¬çš„æ–¹æ³•æ¯”è¿™äº›æ–¹æ³•çš„ MAE ç›¸å¯¹ä½ 7.2% å’Œ 63.5%ï¼Œå±•ç¤ºå‡ºäº†æ¯”å…¶ä»–æ–¹æ³•æ›´å¥½çš„æ³›åŒ–æ•ˆæœã€‚å¦ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡æ˜¯ stMTMVL åœ¨æ°´è´¨é¢„æµ‹ä¸Šè¡¨ç°å¾ˆå¥½ï¼Œåœ¨ç©ºæ°”è´¨é‡ä¸Š&lt;/p&gt;</description></item><item><title>è¯»ç ”ä¸€å‘¨å¹´éšç¬”</title><link>https://davidham3.github.io/blog/p/%E8%AF%BB%E7%A0%94%E4%B8%80%E5%91%A8%E5%B9%B4%E9%9A%8F%E7%AC%94/</link><pubDate>Sun, 08 Jul 2018 18:08:00 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E8%AF%BB%E7%A0%94%E4%B8%80%E5%91%A8%E5%B9%B4%E9%9A%8F%E7%AC%94/</guid><description>&lt;p&gt;è¯»ç ”ä¸€å‘¨å¹´æ€»ç»“&lt;/p&gt;
&lt;p&gt;ä»Šå¤©æœ‰å¹¸å‚åŠ KDD CUP 2018çš„ä¸€ä¸ªçº¿ä¸‹èšä¼šï¼Œé‡åˆ°äº†å¾ˆå¤šé«˜æ‰‹ï¼Œå­¦åˆ°äº†å¾ˆå¤šï¼Œä¸»è¦æ˜¯å¼€æ‹“äº†è§†é‡ï¼Œä¼˜ç§€çš„äººçœŸçš„å¾ˆå¤šã€‚&lt;/p&gt;
&lt;p&gt;å¤§å››è·¨ä¸“ä¸šè€ƒç ”è®¡ç®—æœºæˆåŠŸã€‚è®°å¾—å¤§å››æ˜¯6æœˆ30æ—¥æ¯•ä¸šï¼Œæ­£å¥½å‘¨äº”ï¼Œå‘¨æœ«åœ¨å®¶å‘†äº†ä¸¤å¤©é©¬ä¸Šå°±å¥”èµ´å®éªŒå®¤äº†ï¼Œ7æœˆ3æ—¥å‘¨ä¸€ï¼Œæ­£å¼å¼€å§‹äº†æˆ‘å¿«(gou)ä¹(ri)çš„ç ”ç©¶ç”Ÿä¹‹æ—…ã€‚&lt;/p&gt;
&lt;p&gt;è®°å¾—å»å¹´7æœˆå’Œ8æœˆï¼Œå®éªŒå®¤æ–°å¼€äº†ä¸ªäº¤é€šæ•°æ®æŒ–æ˜æ–¹å‘ï¼Œè®©æˆ‘å’Œæˆ‘å¸ˆå§ä¸€èµ·å»è°ƒç ”ï¼Œç„¶åå°±ç–¯ç‹‚ç»™ç”²æ–¹å‡ºæ–¹æ¡ˆï¼Œå‡ºæ–‡æ¡£ï¼Œå‡ºPPTã€‚å½“æ—¶åæ­£ä¹Ÿæ²¡å­¦åˆ°ä»€ä¹ˆï¼Œæ„Ÿå—åˆ°çš„å°±æ˜¯æ¯å¤©éƒ½åœ¨å†™æ–‡æ¡£ï¼Œç„¶ååå¤æ”¹ï¼Œè¿˜å¾—å»ç”²æ–¹å¼€ä¼šï¼Œæ„Ÿè§‰æ²¡å•¥æ„ä¹‰ï¼Œå¯¹æˆ‘æ¥è¯´ã€‚é‚£ä¸ªæš‘å‡åŒæ—¶è¿˜è´Ÿè´£ç ”ç©¶hadoop HAçš„æ­å»ºï¼Œå†™äº†ä»½åˆç¨¿ï¼Œç„¶åå‘åˆ°ç®€ä¹¦ä¸Šçš„åšå®¢å»äº†ï¼Œè¿˜è¢«åŠ å…¥äº†ä»€ä¹ˆä¸“æ ï¼Œå‰å‡ å¤©å›å¤´å†çœ‹çš„æ—¶å€™æ„Ÿè§‰å†™çš„è·Ÿshiä¸€æ ·ã€‚æš‘å‡çš„æ—¶å€™ç¬¬ä¸€æ¬¡æ„Ÿå—åˆ°äº†åœ¨åŒ—äº¬æŒºè¾›è‹¦çš„ã€‚å½“æ—¶æ²¡åœ°æ–¹ä½ï¼Œåªèƒ½å›å®¶ï¼Œå›å®¶åå…¬äº¤è½¦1ä¸ªå°æ—¶ï¼Œå°±è¿™æ ·æ¯å¤©éƒ½å¾—åå…¬äº¤æ¥å›ä¸¤ä¸ªå°æ—¶ï¼Œæ™šä¸Šç»å¸¸åœ¨è½¦ä¸Šç¡ç€ã€‚å½“æ—¶é¡¹ç›®ä¸Šè¿˜æœ‰ç‚¹å¼€å‘ä»»åŠ¡ï¼Œæˆ‘è®°å¾—å½“æ—¶ç”¨sparkåšäº†ä¸€äº›è½¦è¾†è½¨è¿¹çš„åˆ†æï¼Œå½“æ—¶å­¦ä¼šäº†æ€ä¹ˆå†™sparkã€‚ç„¶åå°±æ²¡å•¥äº†ï¼Œé‚£ä¸ªæš‘å‡åœ¨courseraä¸Šé¢åˆ·äº†ä¸€äº›æœºå™¨å­¦ä¹ çš„è¯¾ï¼Œåç››é¡¿å¤§å­¦å¼€çš„ï¼Œå­¦äº†boostingå•Šï¼Œstackingå•Šé‚£äº›ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åä¸çŸ¥ä¸è§‰è¿›å…¥äº†9æœˆä»½ï¼Œå¼€å­¦çš„æ—¥å­ï¼Œå¼€äº†å­¦ä¹‹åå‘ç°ï¼Œå§æ§½è€å¸ˆä¸€ä¸ªæ¯”ä¸€ä¸ªç‰›é€¼ï¼Œè®²è¯¾éƒ½å¥½æ£’å¥½æ£’çš„ã€‚ç­‰è¿‡äº†ä¸€æ®µæ—¶é—´åï¼Œä¹Ÿå°±é‚£ä¹ˆå›äº‹ï¼Œå¯èƒ½æ˜¯ä¹ æƒ¯äº†ï¼Œå°±è§‰å¾—è¿˜å¯ä»¥äº†ã€‚å½“æ—¶çš„æœºå™¨å­¦ä¹ å’Œç•™å­¦ç”Ÿä¸€èµ·ä¸Šï¼Œè¿˜æŒºæœ‰æ„æ€çš„ã€‚å‘¨ä¸€åˆ°å‘¨äº”åªè¦ä¸ä¸Šè¯¾ï¼Œå°±åœ¨å®éªŒå®¤å‘†ç€ã€‚ä¸Šè¯¾çš„æ—¶å€™å€’æ˜¯è¿˜æŒºæœ‰æ„æ€ï¼Œä¸Šäººå·¥æ™ºèƒ½çš„é€»è¾‘åŸºç¡€æ—¶ï¼Œæ€»æ˜¯æ™šä¸Šä¸Šè¯¾ï¼Œç„¶åå°±å›°ï¼Œè™½è¯´åšç¬¬ä¸€æ’ï¼Œä½†ä¹Ÿä¼šè¶´æ¡Œå­ç¡ç€ï¼Œæœ€åè€ƒä¸ªç¬¬å…­ï¼Œè¿˜å¯ä»¥ã€‚å¤æ‚ç½‘ç»œçš„æ—¶å€™å°±ä¸€ç›´ç©æ‰‹æœºäº†ï¼Œå¤æ‚ç½‘ç»œæˆ‘ä»¬ç­åŒå­¦é€‰çš„è¿˜æŒºå¤šï¼Œä»–ä»¬è€åœ¨ä¸€èµ·ç©ç‹è€…è£è€€ï¼ŒæŒºæœ‰æ„æ€çš„ï¼Œæˆ‘ç°åœ¨è¿˜æ˜¯æŒºç¾¡æ…•ä»–ä»¬ä¸Šè¯¾ä¸€èµ·ç©æ¸¸æˆçš„ï¼Œå› ä¸ºç°åœ¨æ²¡è¯¾ä¸Šäº†ã€‚ã€‚ã€‚å¤æ‚ç½‘ç»œç­”è¾©å‰ä¸€ä¸ªæœˆï¼Œæ’¸äº†å¥½å‡ ç¯‡è®ºæ–‡ï¼Œæœ€åå¾—äº†ä¸ªç¬¬ä¸€ï¼Œä¸è¿‡çœ‹çš„é‚£å‡ ç¯‡è®ºæ–‡çœŸæ˜¯è®©æˆ‘å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼Œç­”è¾©æ—¶æˆ‘è¯´æœ‰ä¸€ä¸ªç®—æ³•åªè¦è°ƒè°ƒå‚ä»€ä¹ˆçš„ï¼Œè‚¯å®šæœ€åæ•ˆæœå¾ˆå¥½ï¼Œè€å¸ˆå½“æ—¶è¯´ä¸ä¸€å®šï¼Œå½“æ—¶æˆ‘æ²¡æœ‰ç†è§£ï¼Œåæ¥æˆ‘æ‰ç†è§£äº†ä¸ºä»€ä¹ˆä¸ä¸€å®šï¼Œåæ¥éšç€çœ‹çš„è®ºæ–‡å¤šäº†ï¼Œå¤ç°çš„å¤šäº†ï¼Œå‘ç°æœ‰äº›è®ºæ–‡å°±æ˜¯åœ¨æ‰¯æ·¡ï¼Œå¹çš„æŒºå¥½çš„ï¼Œå®é™…å¾ˆæ¸£ã€‚ç„¶åå°±æ˜¯ä»€ä¹ˆæ•°å­¦è¯¾å•Šï¼Œä»€ä¹ˆè‹±è¯­è¯¾ï¼Œè‹±è¯­è¯¾æœ€åä¹Ÿè€ƒäº†ç¬¬ä¸€ï¼Œä¸»è¦æ˜¯è€ƒç ”æ—¶è‹±è¯­æ‰“çš„åº•å­æœ‰ç‚¹æ·±â€¦â€¦æ„Ÿè§‰çœŸçš„æ˜¯ç»ˆèº«å—ç›Šï¼Œå³ä¾¿æ˜¯è¯»äº†ç ”ç©¶ç”Ÿæ‰‡è´å…¨å®¶æ¡¶ä¹Ÿä¸€ç›´åœ¨ç”¨ã€‚è€ƒçš„æœ€æ¸£çš„å°±æ˜¯ç®—æ³•äº†ï¼Œä¸»è¦æ˜¯åæ¥éƒ½æ²¡æ€ä¹ˆå¤ä¹ ï¼Œè§‰å¾—è®¤çœŸå‡†å¤‡è€ƒè¯•çœŸçš„è¶Šæ¥è¶Šæ²¡åŠ²äº†ï¼Œç´¢æ€§å°±çœ‹äº†çœ‹PPTï¼Œæœ€åæ‰è€ƒ70å¤šåˆ†ï¼Œæœºå™¨å­¦ä¹ æ‰80å¤šã€‚ã€‚ã€‚å”‰ï¼Œå°±è¿™æ ·å§ï¼Œæ¯•ç«Ÿè€ƒè¯•åˆ†æ•°ä»£è¡¨ä¸äº†ä»»ä½•ä¸œè¥¿ï¼Œå¤§å®¶éƒ½åœ¨crammingï¼Œæœ‰ä»€ä¹ˆæ„æ€å‘¢ã€‚æ‰€ä»¥å½“æ—¶æˆ‘å°±æ¥ç€çœ‹è®ºæ–‡ï¼Œè‡ªå·±è·‘å®éªŒæ¥ç€ï¼Œé‚£æ—¶å€™ä¸€ç›´ææ¨èç³»ç»Ÿæ¥ç€ï¼Œæœ¬ç§‘çš„æ—¶å€™å°±ç©è¿‡ï¼Œä»€ä¹ˆååŒè¿‡æ»¤å•Šé‚£äº›ç©æ„ï¼Œå½“æ—¶æœºå™¨å­¦ä¹ è€å¸ˆç»™æˆ‘ä»¬è®²äº†çŸ©é˜µåˆ†è§£çš„å¥½å‡ ä¸ªç®—æ³•ï¼Œäºæ˜¯æˆ‘å°±æ‰¾äº†è®ºæ–‡ç ”è¯»äº†ä¸€ä¸‹ï¼Œè™½è¯´éƒ½æ²¡æœ‰å®ç°ï¼Œä½†æ˜¯ç¡®å®æ‡‚äº†å¾ˆå¤šï¼Œåœ¨GitHubä¸Šè¿˜æ‰¾åˆ°äº†ä¸€ä¸ªå¼€æºå®ç°çš„implicit feedback recommendationï¼Œé‚£ä¸ªä»£ç çœŸæ˜¯ç‰›é€¼ï¼Œçœ‹éƒ½çœ‹ä¸æ‡‚ï¼Œcythonçš„çˆ†ç‚¸æ€§èƒ½å¾ˆå¼ºï¼Œè‡ªå·±å†™äº†å¾ˆå¤šçˆ¬è™«ï¼Œçˆ¬å„ç§ä¸œè¥¿ï¼ŒæŠ“å–ç”¨æˆ·çš„è¡Œä¸ºæ•°æ®ï¼Œç„¶åè·‘æ¨èã€‚é‚£ä¸ªå­¦æœŸå¥½åƒæ²¡ä»€ä¹ˆå°è±¡æ·±åˆ»çš„äº‹æƒ…ï¼Œåæ­£è§‰å¾—å®éªŒå®¤æŒºæ²¡åŠ²çš„ï¼Œé¡¹ç›®å¾ˆæ°´ï¼Œç»å¸¸å»æ¸…åç§‘æŠ€å›­ï¼Œç»™ç”²æ–¹è¿ç»´å»ï¼Œæ‰¾å·¥ä½œçš„æ—¶å€™éƒ½ä¸å¥½æ„æ€è¯´è¿™äº‹ã€‚å½“æ—¶æˆ‘ä»¬å®éªŒå®¤æœ‰ä¸ªå¾ˆç‰›é€¼çš„å¸ˆå…„ï¼Œæ¨èæˆ‘å»è·Ÿç€ææ²å¤§ç¥æ¯å‘¨åœ¨æ–—é±¼ä¸Šçš„ç›´æ’­ï¼Œå­¦æ·±åº¦å­¦ä¹ ï¼Œç„¶åæˆ‘å°±å»äº†ï¼Œè™½è¯´æ²¡æœ‰æ¯å‘¨éƒ½çœ‹ç›´æ’­ï¼Œä½†è¿˜æ˜¯ç»å¸¸çœ‹çœ‹å½•æ’­çš„ï¼Œå­¦ä¼šäº†å¦‚ä½•ä½¿ç”¨mxneté‡Œé¢çš„gluonï¼Œç„¶åå°±å®ç°äº†ä¸€äº›ç½‘ç»œï¼Œè·‘ç€ç©æ¥ç€ã€‚&lt;/p&gt;
&lt;p&gt;å¯’å‡çš„æ—¶å€™ï¼Œå­¦æ ¡æ”¾å‡äº†ï¼Œä½†æˆ‘ä»¬å®éªŒå®¤ä¸æ”¾ï¼Œå°±åœ¨å®éªŒå®¤çœ‹è®ºæ–‡æ¥ç€ï¼Œåªä¸è¿‡è€å¸ˆè®©æˆ‘çœ‹çœ‹ç¾¤ä½“ä¸ªä½“å‡ºè¡Œè½¨è¿¹ä»€ä¹ˆçš„ï¼Œåæ­£å°±æ˜¯ç ”ç©¶ç”¨æˆ·å‡ºè¡Œè§„å¾‹çš„ã€‚å½“æ—¶æˆ‘ä»¬å­¦æ ¡äº¤è¿å­¦é™¢çš„åœ¨nature communicationä¸Šé¢å‘äº†è®ºæ–‡ï¼Œè®©æˆ‘èµ¶ç´§ç ”ç©¶ï¼Œæˆ‘çœ‹äº†çœ‹ï¼Œæ„Ÿè§‰å’Œè®¡ç®—æœºç ”ç©¶çš„åŸºæœ¬ä¸ç›¸å…³ï¼Œä»–ä»¬å°±æ˜¯å»ºæ¨¡ï¼Œç„¶åç”¨å…¬å¼æ¥åšä»¿çœŸé‚£æ ·çš„ä¸œè¥¿ï¼Œä¹Ÿä¸æ˜¯é¢„æµ‹åˆ†ç±»å•Šä»€ä¹ˆçš„ã€‚å¯’å‡åœ¨å®éªŒå®¤æ°´äº†æ°´å°±è¿‡å»äº†ã€‚ç„¶åæ”¾æˆ‘ä»¬å®éªŒå®¤çš„å¯’å‡äº†ï¼Œ17å¤©ï¼Œåœ¨å®¶ç–¯ç‹‚çœ‹cs231nã€‚è¶Šçœ‹è¶Šçˆ½ï¼ŒJustinè®²çš„å¤ªå¥½äº†ï¼Œè¿˜æœ‰é‚£ä¸ªå¥³åšå£«ï¼Œè®²çš„å¾ˆæ£’ï¼Œå­¦åˆ°äº†å¾ˆå¤šçŸ¥è¯†ï¼Œä¸ºä»€ä¹ˆå¿…é¡»è¦å‡ä¸€åŒ–å•Šï¼Œå¸¸ç”¨çš„ä¼˜åŒ–ç®—æ³•çš„å‚æ•°å•Šï¼Œå„ç§å°trickï¼Œç°åœ¨ä¸€çœ‹è¿˜çœŸæ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Œä½†é‚£æ—¶å€™ç»™æˆ‘å¸®åŠ©å¾ˆå¤§ã€‚æˆ‘å°±åå¤çš„è·‘mnistï¼Œå‘ç°accuracyä¸€ç›´åœ¨ä¸Šå‡ï¼Œæ¯å¤©éƒ½æœ‰æˆå°±æ„Ÿï¼Œå¯’å‡é¡ºä¾¿è¿˜æŠŠæˆ‘çš„åšå®¢æ­å»ºèµ·æ¥äº†ï¼Œåœ¨GitHubä¸Šé¢ã€‚æ”¾å®Œå®éªŒå®¤çš„å¯’å‡ï¼Œå°±å›å®éªŒå®¤æ¥ç€å¹²æ´»äº†ã€‚å¿˜äº†å¹²ä»€ä¹ˆï¼Œåæ­£é©¬ä¸Šå¼€å­¦äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¼€å­¦ä¹‹åè¿˜æ˜¯ï¼Œæ¯å‘¨éƒ½å¾€ç”²æ–¹è·‘ï¼Œå‰å‡ å‘¨å¥½åƒè¿˜æ˜¯è¿ç»´ï¼Œåé¢å°±åšæ•°æ®åˆ†æäº†ã€‚æ•°æ®åˆ†æå°±æ›´æ‰¯äº†â€¦â€¦ç”¨pandasç–¯ç‹‚åšå„ç§æ•°æ®çš„ç»Ÿè®¡ï¼Œå„ç§æŒ‡æ ‡å…¨é è‡ªå·±æƒ³ï¼Œç„¶åç”»å›¾ï¼Œå†™æ–‡æ¡£ã€‚å¼‚å¸¸å‘çˆ¹åŠ æ²¡åŠ²ï¼Œåšå®Œäº†ä¹Ÿæ²¡æœ‰åµç”¨ï¼Œç”²æ–¹çœ‹å®Œè¿ä¸ªåé¦ˆéƒ½tmæ²¡æœ‰ã€‚ç„¶åè¿™ä¸ªé¡¹ç›®æ²¡å¼„å®Œå‘¢ï¼Œåˆå¼€è¾Ÿæ–°é¡¹ç›®äº†ï¼Œè®©æˆ‘ä¹Ÿå‚ä¸é‚£è¾¹çš„é¡¹ç›®ï¼Œé‚£è¾¹è¦ç”¨çš„hbaseæˆ‘æ ¹æœ¬æ²¡æ€ä¹ˆæ¥è§¦è¿‡ï¼Œé‚£æ•´ä¸ª4æœˆä»½ï¼Œæ˜¯æˆ‘æœ€éš¾å—çš„ä¸€ä¸ªæœˆï¼Œæœ‰ä¸€æ¬¡ç›´æ¥è¢«æ°”å“­äº†ï¼Œæˆ‘æ¥è¯»ç ”åˆä¸æ˜¯æ¥å­¦è¿™äº›çš„ï¼Œå½“æ—¶ç›´æ¥ä¸æƒ³å¿µäº†ï¼Œæ¥ç€è¯»ä¹Ÿæ²¡æœ‰å¿…è¦ï¼Œè§‰å¾—è‡ªå·±å…¶å®å°±æ˜¯è¿›é”™äº†å®éªŒå®¤ï¼Œå¤©å¤©å¹²äº›lowåˆ°ä¸è¡Œçš„æ´»å„¿ï¼Œå®è´µçš„æ—¶é—´å°±è¿™ä¹ˆä¸€åˆ†ä¸€ç§’çš„æ²¡äº†ã€‚åæ¥è€å¸ˆä¹Ÿä¸è®©æˆ‘æ¥ç€å»ä¹‹å‰é‚£ä¸ªç”²æ–¹å‡ºå·®äº†ï¼Œé‚£äº›lowæ´»ä¹Ÿä¸è®©æˆ‘å¹²äº†ï¼Œè®©æˆ‘å¼€å§‹å­¦ä¹ ã€‚4æœˆä»½çš„æ—¶å€™çœ‹äº†ä¸å°‘è®ºæ–‡ï¼Œä¹Ÿå¤ç°äº†å¾ˆå¤šï¼Œä¸¤ç‰ˆResNetï¼Œä¸€ç‰ˆé£æ ¼è¿ç§»ï¼Œä¸€ç‰ˆperceptual lossï¼Œå½“æ—¶å°±ä¸€ç›´åœ¨çœ‹CVçš„è®ºæ–‡ï¼Œå­¦åˆ°äº†ä¸å°‘ä¸œè¥¿ï¼Œæ¯”å¦‚å·ç§¯æ ¸å¦‚ä½•æå–ç‰¹å¾ä»€ä¹ˆçš„ï¼Œæ„Ÿè§‰é‚£æ—¶çœ‹çš„å‡ ç¯‡è®ºæ–‡åˆä¸€æ¬¡æ‹“å®½äº†çŸ¥è¯†é¢ï¼Œä¹‹åå°±æ˜¯çœ‹äº†ä¸€äº›nlpæ–¹å‘çš„ï¼Œæœºå™¨ç¿»è¯‘ã€NERä¸€ç±»çš„ã€‚5æœˆä»½çš„æ—¶å€™è¿˜å»åŒ—å¤§å¬äº†MSRAå‘¨æ˜åšå£«çš„è®²åº§ï¼Œæœ€åçš„æ„Ÿè§‰æ˜¯ï¼šç‰›é€¼ï¼çŸ¥é“äº†ä»€ä¹ˆæ˜¯æ·±å…¥æµ…å‡ºï¼é‚£æ—¶å€™5æœˆä»½çš„æ—¶å€™æ­£å¥½èµ¶ä¸Šé™¢é‡Œé¢çš„æ´»åŠ¨ï¼Œç­çº§é£é‡‡å¤§èµ›ï¼Œè¿™æ˜¯æˆ‘ç ”ç©¶ç”ŸæœŸé—´å‚åŠ è¿‡çš„æœ€æœ‰æ„æ€çš„æ´»åŠ¨ï¼Œä¹Ÿæ˜¯æœ€éš¾å¿˜çš„ã€‚æˆ‘ä»¬ç­åŒå­¦éƒ½å¤ªç»™åŠ›äº†ï¼ŒçœŸçš„å¾ˆä»¤äººæ„ŸåŠ¨ï¼Œæ¼”å‘˜ä»¬çœŸæ˜¯å¤ªç”¨å¿ƒäº†ã€‚è®°å¾—å½“æ—¶æƒ³å‰§æœ¬ï¼ŒçœŸæ˜¯æƒ³ç ´è„‘è¢‹äº†ï¼Œç»å¸¸å»å¼€ä¼šï¼Œå¤§å®¶åœ¨ä¸€èµ·è®¨è®ºï¼Œç»å¸¸å°±è®¨è®ºä¸å‡ºæ¥äº†ï¼Œæ²¡æœ‰çµæ„Ÿäº†ï¼Œä¸è¿‡æœ€åæ€»æ˜¯èƒ½çªç„¶é—ªå‡ºä¸€ä¸ªæƒ³æ³•ï¼Œç„¶åå¤§å®¶å°±åœ¨ä¸€èµ·è®¨è®ºã€‚åæ¥æ´»åŠ¨ç»“æŸåï¼Œå¤§å®¶è¿˜ä¸€èµ·å‡ºå»ç©ï¼Œ520é‚£å¤©ï¼Œæ¼‚æµçš„æ—¶å€™ä¸€ä¸ªæ¯”ä¸€ä¸ªæƒ¨å“ˆå“ˆå“ˆå“ˆï¼Œ5æœˆçœŸçš„æ˜¯æˆ‘æœ€å¿«ä¹çš„ä¸€æ®µæ—¶å…‰ï¼Œæ°¸ç”Ÿéš¾å¿˜ã€‚é‚£ä¹‹åï¼Œæˆ‘å°±å˜äº†ï¼Œæˆ‘è§‰å¾—è¿‡å¾—å¿«ä¹ä¸å¿«ä¹å®Œå…¨å–å†³äºè‡ªå·±æ˜¯å¦‚ä½•çœ‹å¾…å‘¨å›´è¿™äº›äº‹æƒ…çš„ï¼Œæœ¬ç§‘çš„æ—¶å€™æ²¡æœ‰é‚£ä¹ˆå¤šç ´äº‹ï¼Œæˆ–è€…è¯´æœ¬ç§‘çš„æ—¶å€™èƒ½é€ƒé¿çš„éƒ½é€ƒé¿äº†ï¼Œä½†æ˜¯ç ”ç©¶ç”ŸæœŸé—´ï¼Œå¤©å¤©æœ‰ç ´äº‹ï¼Œæ—¶é—´æ ¹æœ¬ä¸æ˜¯è‡ªå·±æ¥æŠŠæ§ï¼Œæ˜¯bossï¼Œæ˜¯å‘¨å›´çš„å„ç§æœ‰çš„æ²¡çš„ã€‚ä¹‹åæˆ‘å°±æŠŠæ‰€æœ‰çš„äº‹æƒ…éƒ½çœ‹æ·¡äº†ï¼Œå¿«ä¹è¿˜æ˜¯å¾ˆé‡è¦çš„ï¼Œå¦‚æœè‡ªå·±ä¸èƒ½è®©è‡ªå·±ä¿æŒä¸€ä¸ªå¿«ä¹çš„å¿ƒæƒ…ï¼Œé‚£å¾ˆæœ‰å¯èƒ½å°±æ˜¯æ¯å¤©çŠ¶æ€éƒ½éå¸¸ä¸å¥½ï¼Œæ•´å¤©éƒéƒå¯¡æ¬¢çš„ã€‚6æœˆä»½è¿‡çš„å¾ˆå¹³é™ï¼Œæ¯å¤©å†™å†™ä½œä¸šï¼Œå¸®åŒå­¦ä»¬è§£ç­”é—®é¢˜ï¼Œå¤„ç†ä»–ä»¬çš„è™šæ‹Ÿæœºå•Šä»€ä¹ˆçš„ã€‚å…¶ä»–æ—¶é—´çœ‹çœ‹è®ºæ–‡ï¼Œé€›é€›GitHubï¼Œæ‰¾ä¸€äº›æœ‰æ„æ€çš„å·¥å…·ï¼Œç„¶åææissueå•¥çš„ã€‚ç„¶åå°±æ˜¯å‡†å¤‡è€ƒè¯•ï¼Œå› ä¸ºä¸€åˆ‡éƒ½çœ‹æ·¡äº†ï¼Œæ‰€ä»¥è€ƒè¯•æˆç»©éƒ½æŒºæƒ¨çš„â€¦â€¦é«˜çº§Dè¯¾ç›´æ¥æŒ‚äº†ï¼ŒæŒ‚äº†å°±æŒ‚äº†å§ã€‚å¹³æ—¶ä¸“ä¸šè¯¾ä»€ä¹ˆçš„ä¸æŒ‚å°±è¡Œã€‚è€ƒè¯•å‘¨çš„æ—¶å€™ï¼ŒæŠ½ä¸€éƒ¨åˆ†æ—¶é—´çœ‹çœ‹è€ƒè¯•ï¼Œå…¶ä»–æ—¶é—´å¹²è‡ªå·±çš„äº‹æƒ…ï¼Œå¤ç°å¤ç°è®ºæ–‡ä»€ä¹ˆçš„ã€‚&lt;/p&gt;
&lt;p&gt;7æœˆä»½ï¼Œåˆè¿æ¥äº†æš‘å‡ï¼Œæš‘å‡åªæœ‰9å¤©ï¼Œæˆ‘å†³å®šå…«æœˆåº•æ”¾æš‘å‡ï¼Œå› ä¸ºæ”¾çš„æ—©å°±æ²¡ç›¼å¤´äº†ã€‚ã€‚ã€‚æš‘å‡é¡¹ç›®ä¹Ÿæ­£å¼å¼€å·¥äº†ï¼Œç›‘ç£å­¦å¦¹åšé¡¹ç›®ï¼Œæˆ‘æ¥ç€å¹²è‡ªå·±çš„äº‹æƒ…ï¼Œæç ”ç©¶ã€‚ä»Šå¤©å»KDD CUP 2018çº¿ä¸‹èšä¼šï¼Œå¼€æ‹“äº†è§†é‡ï¼Œæˆ‘ä¹‹å‰ä¸€ç›´è®¤ä¸ºï¼Œæä»€ä¹ˆæ•°æ®æŒ–æ˜ï¼Œæœºå™¨å­¦ä¹ ï¼Œæ²¡æœ‰ç‰›é€¼çš„å­¦å†ï¼Œæ²¡æœ‰ç‰›é€¼çš„èƒŒæ™¯ï¼Œè¿˜ææ¯›å•Šï¼Œä»Šå¤©å‘ç°ï¼Œä¸æ˜¯è¿™æ ·å­çš„ï¼Œæˆ‘å·²ç»å¿˜äº†æˆ‘ä¸ºä»€ä¹ˆå½“åˆä¼šè€ƒè®¡ç®—æœºï¼Œå½“åˆè€ƒè®¡ç®—æœºçš„ä¸€ä¸ªç›´æ¥åŸå› å°±æ˜¯ï¼Œè¿™è¡Œä¸æ˜¯é å®åŠ›åƒé¥­çš„å—ï¼Œä½†æ˜¯è¯»äº†ç ”ç©¶ç”Ÿä¹‹åï¼Œçœ‹å¸ˆå…„ä»¬æ‰¾å·¥ä½œçš„æ—¶å€™ï¼Œè¯´å’ŒåŒ—é‚®å•Šæ¯”ä¸äº†ä»€ä¹ˆçš„ï¼Œæ½œæ„è¯†ä¸­å°±é€æ¸å˜æˆäº†æ ¡åå†³å®šè‡ªå·±èƒ½å»å“ªé‡Œï¼Œå‡ºèº«å†³å®šä¸€åˆ‡ã€‚è¯»ç ”è¿™ä¸€å¹´ï¼Œæ€»ä¼šæŠŠè‡ªå·±ï¼Œæ‹¿å»å’Œé‚£äº›ç‰¹åˆ«ç‰›é€¼çš„é€‰æ‰‹ä½œæ¯”è¾ƒï¼Œæ€»ä¼šæŠŠè‡ªå·±ï¼Œå’Œæ¸…åŒ—é‚£äº›å­¦ç”Ÿä½œæ¯”è¾ƒï¼Œæ€»è§‰å¾—å¹³æ—¶å¹²é‚£äº›è¿ç»´çš„æ´»å„¿ï¼Œå°±æ˜¯æµªè´¹æ—¶é—´ï¼Œæ—¶é—´ä¸€ç‚¹ä¸€ç‚¹çš„æµªè´¹ç€ï¼Œå’Œé‚£äº›ç‰›é€¼çš„é€‰æ‰‹è¶Šå·®è¶Šè¿œï¼Œæœ€åæ‰¾äº†ä¸ªæ™®é€šå·¥ä½œï¼Œå­¦ä¹ ä¹Ÿå˜å¾—è¶Šæ¥è¶ŠåŠŸåˆ©ã€‚ä»Šå¤©çš„èšä¼šé‡Œé¢ï¼Œå¾ˆå¤šäººéƒ½æ²¡æœ‰é‚£ä¹ˆè¿‡ç¡¬çš„èƒŒæ™¯ï¼Œæœ‰ä¸ªå¤§ç¥ï¼Œå¤§å­¦éƒ½æ²¡ä¸Šï¼Œå‚åŠ äº†è‡ªè€ƒï¼Œæœºå™¨å­¦ä¹ è¿™äº›äººå®¶å…¨éƒ½æ˜¯è‡ªå­¦çš„ï¼Œç°åœ¨é©¬ä¸Šå°±è¦è¢«æŸé“¶è¡Œç ´æ ¼å½•ç”¨ï¼Œæ­£åœ¨èµ°ç¨‹åºã€‚ä»Šå¤©ä»–çš„ä¸€ä¸ªé¢†å¯¼è¿˜å»äº†é‚£ä¸ªæ´»åŠ¨ï¼Œè¯´æƒ³æ‰¾é‚£ç§è§‰å¾—è·‘æ¨¡å‹æ¯”æ‰“æ¸¸æˆæœ‰æ„æ€çš„åŒå­¦å»ä»–ä»¬é“¶è¡Œï¼Œé‚£ä¸€åˆ»æˆ‘æ‰çœŸæ­£çš„æ„è¯†åˆ°ï¼Œå…¶å®è¿™ä¸–ç•Œä¸Šæœ‰å¾ˆå¤šäººçƒ­çˆ±è®¡ç®—æœºï¼Œçƒ­çˆ±æœºå™¨å­¦ä¹ çš„ï¼Œè§‰å¾—è·‘æ¨¡å‹æ¯”æ‰“æ¸¸æˆæœ‰æ„æ€çš„äººå¤šäº†å»äº†ï¼Œåªä¸è¿‡æˆ‘ä¸€ç›´å±€é™åœ¨è‡ªå·±çš„å°åœˆå­é‡Œï¼Œå±€é™åœ¨è‡ªå·±çš„å®éªŒå®¤é‡Œé¢ï¼Œæ²¡æœ‰æ¥è§¦åˆ°è¿™äº›äººã€‚æˆ‘è€ƒè¯•å‘¨ä¹‹æ‰€ä»¥ä¸æ€ä¹ˆå¤ä¹ ï¼Œè¿™ä¸¤æ¬¡éƒ½æ˜¯å› ä¸ºåœ¨è·‘æ¨¡å‹ï¼Œæ„Ÿè§‰è·‘æ¨¡å‹ä¸Šç˜¾å•Šï¼Œåœä¸ä¸‹æ¥ã€‚&lt;/p&gt;
&lt;p&gt;æ€»çš„æ¥è¯´ï¼Œè¯»ç ”ä¸€å¹´äº†ï¼Œå®éªŒå®¤æŒºæ²¡æ„æ€çš„ï¼Œå½“åˆæ˜¯éå¸¸æœŸæœ›å»å®éªŒå®¤å­¦ä¹ ï¼Œæ—©ç‚¹è¿›å®éªŒå®¤ï¼Œå› ä¸ºå½“æ—¶å¯¹å®éªŒå®¤æœ‰ç€æ†§æ†¬ï¼Œè¿›å»ä¹‹åä¸€å †å¤§ç¥ï¼Œåƒæˆ‘è¿™ç§è·¨ä¸“ä¸šçš„èœé¸¡å¯ä»¥å­¦åˆ°å¾ˆå¤šä¸œè¥¿ã€‚è¿›äº†å®éªŒå®¤åå‘ç°ï¼Œå®éªŒå®¤é™¤äº†æä¾›ä¸€ä¸ªå¥½çš„ç¯å¢ƒï¼Œæœ‰æ—¶å€™è¿æ°›å›´ï¼Œéƒ½æ²¡æœ‰ã€‚æ‰“æ¯”èµ›è¿é˜Ÿå‹éƒ½æ‰¾ä¸åˆ°ã€‚ã€‚ã€‚åæ¥çœ‹æ·¡äº†è¿™ä¸€åˆ‡ä¹Ÿå°±æ— æ‰€è°“äº†ï¼Œç¯å¢ƒæ— æ³•æ”¹å˜çš„è¯ï¼Œé‚£å°±ä¸è¦è®©ç¯å¢ƒæŠŠè‡ªå·±æ”¹å˜ï¼Œåšä¿¡è‡ªå·±è®¤ä¸ºå¯¹çš„äº‹æƒ…å°±å¥½äº†ã€‚æš‘å‡ä»»åŠ¡å¾ˆæ˜ç¡®ï¼Œå¥½å¥½å­¦ä¹ ï¼Œå¥½å¥½çœ‹è®ºæ–‡ï¼Œä»Šå¤©ä¸»åŠæ–¹è¯´ä»¥åå¥½æå°†è®ºæ–‡ï¼Œåˆ†äº«æ¨¡å‹çš„æ´»åŠ¨ï¼Œçœ‹çœ‹åˆ°æ—¶å€™èƒ½ä¸èƒ½æŠ•æŠ•ç¨¿ï¼Œèµšèµšç¨¿è´¹ã€‚ç„¶åæƒ³åšäº›æœ‰æ„ä¹‰çš„äº‹æƒ…ï¼Œäº‰å–æ˜å¹´æ‰¾å·¥ä½œå‰èƒ½å‘ä¸€ç¯‡é¡¶ä¼šï¼Œæˆ–è€…å‘ä¸ªsciã€‚ç„¶åæ‰¾ä¸ªæ¯”èµ›ï¼Œè®¤çœŸæ‰“ä¸€ä¸‹ï¼Œå¤šå‚åŠ å‚åŠ è¿™ç§çº¿ä¸‹æ´»åŠ¨ï¼Œå’Œå¤§ç¥ä»¬å¤šäº¤æµï¼Œå­¦ä¹ ï¼Œå·®ä¸å¤šè¿™å°±æ˜¯ä»Šå¹´å¤å¤©åˆ°æ˜å¹´å¤å¤©çš„ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;æ„Ÿè§‰è¿™ä¸€å¹´è¿·å¤±äº†åŒçœ¼ã€‚å¸Œæœ›æ–°çš„ä¸€å¹´ï¼Œç›®æ ‡æ›´æ˜ç¡®ï¼Œèƒ½æ›´åŠªåŠ›çš„å»æå‡è‡ªå·±ï¼Œå¤šåšæœ‰æ„ä¹‰çš„äº‹æƒ…ã€‚&lt;/p&gt;</description></item><item><title>Kafkaç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…</title><link>https://davidham3.github.io/blog/p/kafka%E7%94%9F%E4%BA%A7%E8%80%85%E4%B8%8E%E6%B6%88%E8%B4%B9%E8%80%85/</link><pubDate>Thu, 05 Jul 2018 20:54:26 +0000</pubDate><guid>https://davidham3.github.io/blog/p/kafka%E7%94%9F%E4%BA%A7%E8%80%85%E4%B8%8E%E6%B6%88%E8%B4%B9%E8%80%85/</guid><description>&lt;p&gt;Kafkaæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€æµå¼æ¶ˆæ¯å¹³å°ï¼Œæ˜¯ä¸€å¥—å‘å¸ƒè®¢é˜…ç³»ç»Ÿï¼Œé€šä¿—æ¥è¯´å°±æ˜¯Kafka producerå‘å¸ƒæ•°æ®è‡³Kafka brokersï¼Œç„¶åç”±Kafka consumerä»brokersæ‹‰å–æ•°æ®ï¼Œè¿›è¡Œæ¶ˆè´¹ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘ä¸Šæ•°æ®ä»“åº“çš„è¯¾ï¼Œå­¦ä¹ äº†Kafkaçš„ä½¿ç”¨æ–¹å¼ä»¥åŠKafkaçš„åŸç†ã€‚&lt;/p&gt;
&lt;p&gt;Kafkaå®˜ç½‘ï¼š&lt;a class="link" href="http://kafka.apache.org/" target="_blank" rel="noopener"
&gt;Apache Kafka&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Kafkaæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€æµå¼æ¶ˆæ¯å¹³å°ï¼Œæ˜¯ä¸€å¥—å‘å¸ƒè®¢é˜…ç³»ç»Ÿï¼Œé€šä¿—æ¥è¯´å°±æ˜¯Kafka producerå‘å¸ƒæ•°æ®è‡³Kafka brokersï¼Œç„¶åç”±Kafka consumerä»brokersæ‹‰å–æ•°æ®ï¼Œè¿›è¡Œæ¶ˆè´¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ—¥å¿—&lt;/strong&gt;
æœ‰æ„æ€çš„ç‰¹æ€§æ˜¯Kafkaå†…çš„æ•°æ®éƒ½æ˜¯ä»¥æ—¥å¿—çš„å½¢å¼å­˜å‚¨ï¼Œå³ä¾¿æ¶ˆè´¹å®Œä¹Ÿä¸ä¼šæ¶ˆå¤±ï¼Œé…ç½®æ–‡ä»¶ä¸­é…ç½®äº†è¿‡äº†å¤šé•¿æ—¶é—´æ—¥å¿—ä¼šé”€æ¯æ‰ã€‚è¿™æ ·è®¾è®¡çš„å¥½å¤„æœ‰å¾ˆå¤šï¼Œconsumeræ˜¯æœ‰groupçš„ï¼Œæ¯ä¸ªç»„è¿›è¡Œæ¶ˆè´¹çš„æ—¶å€™ï¼Œéƒ½ä¼šæœ‰ä¸ªåç§»é‡offsetè®°å½•åœ¨zookeeperä¸­ï¼Œé€šè¿‡è¿™ä¸ªoffsetå°±çŸ¥é“ä¸‹æ¬¡ä»å“ªé‡Œå¼€å§‹æ¶ˆè´¹äº†ï¼Œä¸åŒç»„çš„offsetä¸ä¸€æ ·ï¼Œè¿™æ ·æ¯ä¸ªç»„éƒ½å¯ä»¥æŒ‰ç…§è‡ªå·±çš„éœ€è¦è¿›è¡Œæ¶ˆè´¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸»é¢˜&lt;/strong&gt;
Kafkaçš„è®°å½•æ˜¯æœ‰ä¸»é¢˜çš„ï¼Œè¿™æ ·producerå‘é€åˆ°brokerçš„æ•°æ®å…¶å®å°±æ˜¯æ‰“ä¸Šäº†æ ‡ç­¾ï¼Œæœ‰äº†åˆ†ç±»ï¼Œæ¶ˆè´¹çš„æ—¶å€™å¯ä»¥æŒ‰ä¸»é¢˜æ¶ˆè´¹ï¼Œç›¸å½“äºä¸€å¼€å§‹å°±ç”¨ä¸»é¢˜å¯¹æ•°æ®è¿›è¡Œäº†åŒºåˆ†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ•ˆç‡&lt;/strong&gt;
Kafkaé›†ç¾¤åŒæ—¶ä¹Ÿä½œä¸ºç¼“å†²åŒºï¼Œå¹³è¡¡producerå’Œconsumerä¸¤è¾¹çš„å·¥ä½œè¿›åº¦ï¼Œä¸ä¼šå› ä¸ºä¸€æ–¹è¿‡æ…¢é€ æˆé˜»å¡ä¸€ç±»çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¯­è¨€&lt;/strong&gt;
å†™èµ·æ¥çš„è¯ï¼Œè‚¯å®šæ˜¯javaå’Œscalaæœ€å¥½ï¼Œå› ä¸ºKafkaå°±æ˜¯ç”±è¿™ä¸¤ç§è¯­è¨€ç¼–å†™çš„ï¼Œå½“ç„¶ï¼Œä¹Ÿæœ‰å…¶ä»–è¯­è¨€çš„æ¥å£ï¼Œæ¯”å¦‚pythonã€‚pythonçš„è¯æ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯æœ‰ä¸¤ä¸ªKafkaæ¡†æ¶ï¼Œä¸€ä¸ªæ˜¯&lt;a class="link" href="https://kafka-python.readthedocs.io/en/master/index.html" target="_blank" rel="noopener"
&gt;kafka-python&lt;/a&gt;ï¼Œå¦ä¸€ä¸ªæ˜¯&lt;a class="link" href="http://pykafka.readthedocs.io/en/latest/#" target="_blank" rel="noopener"
&gt;pykafka&lt;/a&gt;ã€‚æ¨èä½¿ç”¨åè€…ï¼Œå‰è€…åœ¨åˆ›å»ºconsumer groupçš„æ—¶å€™ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œgroupå†…çš„æ¯ä¸ªconsumeræ¶ˆè´¹çš„å†…å®¹éƒ½ä¸€æ ·ï¼Œæ²¡æœ‰å®ç°å»é‡ä¸å¹³è¡¡ï¼Œè¿™äº›éƒ½éœ€è¦è‡ªå·±å®ç°ï¼Œåè€…çš„balanced_consumerå°±æŒºå¥½çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://github.com/Davidham3/pykafka_examples" target="_blank" rel="noopener"
&gt;è‡ªå·±å†™çš„ä¾‹å­&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Semi-Supervised Classification With Graph Convolutional Networks</title><link>https://davidham3.github.io/blog/p/semi-supervised-classification-with-graph-convolutional-networks/</link><pubDate>Mon, 02 Jul 2018 20:04:20 +0000</pubDate><guid>https://davidham3.github.io/blog/p/semi-supervised-classification-with-graph-convolutional-networks/</guid><description>&lt;p&gt;ICLR 2017ã€‚å›¾å·ç§¯ä¸­è°±å›¾é¢†åŸŸç†è®ºä¸Šå¾ˆé‡è¦çš„ä¸€ç¯‡è®ºæ–‡ï¼Œæå‡äº†å›¾å·ç§¯çš„æ€§èƒ½ï¼Œä½¿ç”¨åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼çš„1é˜¶è¿‘ä¼¼å®Œæˆäº†é«˜æ•ˆçš„å›¾å·ç§¯æ¶æ„ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1609.02907v4" target="_blank" rel="noopener"
&gt;Semi-Supervised Classification with Graph Convolutional Networks. Kipf &amp;amp; Welling 2017&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="æ‘˜è¦"&gt;æ‘˜è¦
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬æå‡ºäº†ä¸€ç§åœ¨å›¾ç»“æ„æ•°æ®ä¸Šçš„åŠç›‘ç£å¯æ‰©å±•å­¦ä¹ æ–¹æ³•ï¼ŒåŸºäºé«˜æ•ˆçš„å›¾å·ç§¯å˜ä½“ã€‚å¥‘æœºæ˜¯é€šè¿‡ä¸€ä¸ªè°±å›¾å·ç§¯çš„å±€éƒ¨ä¸€é˜¶è¿‘ä¼¼å¾—åˆ°çš„æˆ‘ä»¬çš„å›¾å·ç§¯ç»“æ„ã€‚æˆ‘ä»¬çš„æ¨¡å‹ä¸å›¾çš„è¾¹æ•°å‘ˆçº¿æ€§å…³ç³»ï¼Œå­¦ä¹ åˆ°çš„éšè—å±‚å¯ä»¥å¯¹å›¾çš„é¡¶ç‚¹å’Œå±€éƒ¨å›¾ç»“æ„åŒæ—¶è¿›è¡Œç¼–ç ã€‚åœ¨å¼•æ–‡ç½‘ç»œå’Œä¸€ä¸ªçŸ¥è¯†å›¾è°±æ•°æ®é›†ä¸Šçš„å¤§é‡å®éªŒç»“æœè¡¨æ˜æˆ‘ä»¬çš„æ–¹æ³•æ¯”ç›¸å…³æ–¹æ³•å¥½å¾ˆå¤šã€‚&lt;/p&gt;
&lt;h1 id="å¼•è¨€"&gt;å¼•è¨€
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªå¯¹å›¾é¡¶ç‚¹è¿›è¡Œåˆ†ç±»çš„é—®é¢˜ï¼Œåªæœ‰ä¸€å°éƒ¨åˆ†çš„é¡¶ç‚¹æœ‰æ ‡ç­¾ã€‚è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡åŸºäºå›¾çš„åŠç›‘ç£å­¦ä¹ ä»»åŠ¡å»ºæ¨¡ï¼Œé€šè¿‡æŸäº›æ˜ç¡®çš„å›¾æ­£åˆ™åŒ–æ–¹æ³•(Zhu et al., 2003; Zhou et al., 2004; Belkin et al., 2006; Weston et al., 2012)å¯ä»¥å¹³æ»‘æ ‡ç­¾ä¿¡æ¯ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œé€šè¿‡åœ¨loss functionä½¿ç”¨ä¸€ä¸ªå›¾æ‹‰æ™®æ‹‰æ–¯æ­£åˆ™é¡¹ï¼š
&lt;/p&gt;
$$\tag{1} \mathcal{L} = \mathcal{L\_0} + \lambda \mathcal{L\_{reg}}, \rm with \ \mathcal{L\_{reg}} = \sum\_{i.j}A\_{ij} \Vert f(X\_i) - f(X\_j) \Vert^2 = f(X)^T \Delta f(X)$$&lt;p&gt;
å…¶ä¸­ï¼Œ$\mathcal{L_0}$è¡¨ç¤ºå¯¹äºå›¾çš„æ ‡ç­¾éƒ¨åˆ†çš„ç›‘ç£æŸå¤±ï¼Œ$f(\cdot)$å¯ä»¥æ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œç±»çš„å¯å¾®åˆ†å‡½æ•°ï¼Œ$\lambda$æ˜¯æƒé‡å‘é‡ï¼Œ$X$æ˜¯å®šç‚¹ç‰¹å¾å‘é‡$X_i$çš„çŸ©é˜µã€‚$N$ä¸ªé¡¶ç‚¹$v_i \in \mathcal{V}$ï¼Œè¾¹$(v_i, v_j) \in \varepsilon$ï¼Œé‚»æ¥çŸ©é˜µ$A \in \mathbb{R}^{N \times N}$ï¼ˆäºŒå€¼çš„æˆ–è€…å¸¦æƒé‡çš„ï¼‰ï¼Œè¿˜æœ‰ä¸€ä¸ªåº¦çŸ©é˜µ$D_{ii} = \sum_jA_{ij}$ã€‚å¼1ä¾èµ–äºâ€œå›¾ä¸­ç›¸è¿çš„é¡¶ç‚¹æ›´æœ‰å¯èƒ½å…·æœ‰ç›¸åŒçš„æ ‡è®°â€è¿™ä¸€å‡è®¾ã€‚ç„¶è€Œï¼Œè¿™ä¸ªå‡è®¾ï¼Œå¯èƒ½ä¼šé™åˆ¶æ¨¡å‹çš„èƒ½åŠ›ï¼Œå› ä¸ºå›¾çš„è¾¹å¹¶ä¸æ˜¯å¿…é¡»è¦ç¼–ç æˆç›¸ä¼¼çš„ï¼Œè€Œæ˜¯è¦åŒ…å«æ›´å¤šçš„ä¿¡æ¯ã€‚
åœ¨æˆ‘ä»¬çš„ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬å°†å›¾ç»“æ„ç›´æ¥é€šè¿‡ä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹$f(X, A)$è¿›è¡Œç¼–ç ï¼Œå¹¶ä¸”åœ¨ç›‘ç£çš„ç›®æ ‡$\mathcal{L_0}$ä¸‹å¯¹æ‰€æœ‰æœ‰æ ‡è®°çš„é¡¶ç‚¹è¿›è¡Œè®­ç»ƒï¼Œå› æ­¤é¿å…äº†æŸå¤±å‡½æ•°ä¸­åˆ»æ„çš„å¯¹å›¾è¿›è¡Œæ­£åˆ™åŒ–ã€‚åœ¨å›¾çš„é‚»æ¥çŸ©é˜µä¸Šä½¿ç”¨$f(\cdot)$å¯ä»¥ä½¿æ¨¡å‹ä»ç›‘ç£æŸå¤±$\mathcal{L_0}$ä¸­åˆ†å¸ƒæ¢¯åº¦ä¿¡æ¯ï¼Œå¹¶ä¸”èƒ½å¤Ÿä»æœ‰æ ‡è®°å’Œæ²¡æœ‰æ ‡è®°çš„é¡¶ç‚¹ä¸Šå­¦ä¹ åˆ°ä»–ä»¬çš„è¡¨ç¤ºã€‚
æˆ‘ä»¬çš„è´¡çŒ®æœ‰ä¸¤ç‚¹ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ªç®€å•çš„ï¼Œè¡¨ç°å¾ˆå¥½çš„é’ˆå¯¹ç¥ç»ç½‘ç»œçš„å¯¹å±‚ä¼ æ’­è§„åˆ™ï¼Œå…¶ä¸­ï¼Œè¿™ä¸ªç¥ç»ç½‘ç»œæ˜¯ç›´æ¥åº”ç”¨åˆ°å›¾ä¸Šçš„ï¼Œå¹¶ä¸”å±•ç¤ºäº†è¿™ä¸ªè§„åˆ™æ˜¯å¦‚ä½•é€šè¿‡è°±å›¾å·ç§¯çš„ä¸€é˜¶è¿‘ä¼¼å¯å‘å¾—åˆ°çš„ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬å±•ç¤ºäº†è¿™ç§å½¢å¼çš„åŸºäºå›¾çš„ç¥ç»ç½‘ç»œå¯ä»¥ç”¨äºå¯¹å›¾ä¸­çš„é¡¶ç‚¹è¿›è¡Œæ›´å¿«æ›´å¯æ‰©å±•çš„åŠç›‘ç£åˆ†ç±»ä»»åŠ¡ã€‚åœ¨å¤§é‡æ•°æ®é›†ä¸Šçš„å®éªŒè¡¨æ˜æˆ‘ä»¬çš„æ¨¡å‹åœ¨åˆ†ç±»ç²¾åº¦å’Œæ•ˆç‡ä¸Šæ¯”å½“å‰åœ¨åŠç›‘ç£å­¦ä¹ ä¸­çš„å…ˆè¿›ç®—æ³•è¦å¥½ã€‚&lt;/p&gt;
&lt;h1 id="å›¾ä¸Šçš„å¿«é€Ÿè¿‘ä¼¼å·ç§¯"&gt;å›¾ä¸Šçš„å¿«é€Ÿè¿‘ä¼¼å·ç§¯
&lt;/h1&gt;&lt;p&gt;åœ¨è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¼šè®¨è®ºä¸€ä¸ªç‰¹æ®Šçš„åŸºäºå›¾çš„ç¥ç»ç½‘ç»œ$f(X, A)$ã€‚è€ƒè™‘ä¸€ä¸ªå¤šå±‚å›¾å·ç§¯ç½‘ç»œ(GCN)ï¼Œé€šè¿‡ä»¥ä¸‹çš„ä¼ æ’­è§„åˆ™ï¼š
&lt;/p&gt;
$$\tag{2} H^{(l+1)} = \sigma(\tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}} H^{(l)} W^{(l)})$$&lt;p&gt;
å…¶ä¸­ï¼Œ$\tilde{A} = A + I_N$æ˜¯æ— å‘å›¾$\mathcal{G}$åŠ äº†è‡ªè¿æ¥çš„é‚»æ¥çŸ©é˜µã€‚$I_N$æ˜¯å•ä½é˜µï¼Œ$\tilde{D}_{ii} = \sum_j \tilde{A}_{ij}$ï¼Œ$W^{(l)}$æ˜¯ä¸€ä¸ªé’ˆå¯¹å±‚è®­ç»ƒçš„æƒé‡çŸ©é˜µã€‚$\sigma(\cdot)$è¡¨ç¤ºä¸€ä¸ªæ¿€æ´»å‡½æ•°ï¼Œæ¯”å¦‚$\rm ReLU(\cdot) = \rm max(0, \cdot)$ï¼Œ$H^{(l)} \in \mathbb{R}^{N \times D}$æ˜¯ç¬¬$l$å±‚çš„æ¿€æ´»çŸ©é˜µï¼›$H^{(0)} = X$ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†å±•ç¤ºé€šè¿‡å›¾ä¸Šçš„ä¸€é˜¶è¿‘ä¼¼å±€éƒ¨è°±æ»¤æ³¢å™¨(Hammond et al., 2011; Defferrard et al., 2016)çš„ä¼ æ’­è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;h2 id="è°±å›¾å·ç§¯-spectral-graph-convolutions"&gt;è°±å›¾å·ç§¯ spectral graph convolutions
&lt;/h2&gt;&lt;p&gt;å®šä¹‰å›¾ä¸Šçš„è°±å›¾å·ç§¯ä¸ºä¿¡å·$x \in \mathbb{R}^N$å’Œä¸€ä¸ªæ»¤æ³¢å™¨$g_\theta = \rm diag(\theta)$ï¼Œå‚æ•°æ˜¯å‚…é‡Œå¶åŸŸä¸­çš„$\theta \in \mathbb{R}^N$ï¼Œä¹Ÿå°±æ˜¯ï¼š
&lt;/p&gt;
$$\tag{3} g\_\theta \ast x = U g\_\theta U^T x$$&lt;p&gt;
å…¶ä¸­$U$æ˜¯å½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ$L = I_N - D^{-\frac{1}{2}}AD^{-\frac{1}{2}} = U \Lambda U^T$çš„ç‰¹å¾å‘é‡ç»„æˆçš„çŸ©é˜µï¼Œ$\Lambda$æ˜¯ç‰¹å¾å€¼ç»„æˆçš„å¯¹è§’é˜µï¼Œ$U^Tx$æ˜¯$x$çš„å›¾å‚…é‡Œå¶å˜æ¢ã€‚å¯ä»¥è®¤ä¸º$g_\theta$æ˜¯å…³äº$L$çš„ç‰¹å¾å€¼çš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´$g_\theta(\Lambda)$ã€‚å¼3çš„è®¡ç®—é‡å¾ˆå¤§ï¼Œå› ä¸ºç‰¹å¾å‘é‡çŸ©é˜µ$U$çš„ä¹˜æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(N^2)$ã€‚æ­¤å¤–ï¼Œå¯¹äºå¤§å°ºåº¦çš„å›¾æ¥è¯´ï¼Œå¯¹$L$è¿›è¡Œç‰¹å¾å€¼åˆ†è§£æ˜¯è®¡ç®—é‡éå¸¸å¤§çš„ä¸€ä»¶äº‹ã€‚ä¸ºäº†é¿å¼€è¿™ä¸ªé—®é¢˜ï¼ŒHammond et al.(2001)å»ºè®®ä½¿ç”¨$K$é˜¶åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼$T_k(x)$æ¥è¿‘ä¼¼$g_\theta(\Lambda)$ï¼š
&lt;/p&gt;
$$\tag{4} g\_\theta' \approx \sum^K\_{k=0} \theta'\_k T\_k(\tilde{\Lambda})$$&lt;p&gt;
å…¶ä¸­ï¼Œ$\tilde{\Lambda} = \frac{2}{\lambda_{max}} \Lambda - I_N$ã€‚$\lambda_{max}$è¡¨ç¤º$L$çš„æœ€å¤§ç‰¹å¾å€¼ã€‚$\theta&amp;rsquo; \in \mathbb{R}^K$æ˜¯åˆ‡æ¯”é›ªå¤«ç³»æ•°å‘é‡ã€‚åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼çš„å®šä¹‰æ˜¯ï¼š$T_k(x) = 2xT_{k-1}(x) - T_{k-2}(x)$ï¼Œ$T_0(x) = 1$ï¼Œ$T_1(x) = x$ã€‚
å›åˆ°æˆ‘ä»¬å¯¹äºä¸€ä¸ªä¿¡å·$x$å’Œä¸€ä¸ªæ»¤æ³¢å™¨$g_\theta&amp;rsquo;$çš„å·ç§¯çš„å®šä¹‰ï¼š
&lt;/p&gt;
$$\tag{5} g\_\theta' \ast x \approx \sum^K\_{k=0} \theta'\_k T\_k(\tilde{L}) x$$&lt;p&gt;
å…¶ä¸­ï¼Œ$\tilde{L} = \frac{2}{\lambda x_{max}} L - I_N$ï¼›æ³¨æ„$(U \Lambda U^T)^k = U \Lambda^k U^T$ã€‚è¿™ä¸ªè¡¨è¾¾å¼ç›®å‰æ˜¯$K$é˜¶å±€éƒ¨çš„ï¼Œå› ä¸ºè¿™ä¸ªè¡¨è¾¾å¼æ˜¯æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„$K$é˜¶å¤šé¡¹å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ä»ä¸­å¿ƒèŠ‚ç‚¹å‘å¤–æœ€å¤šèµ°$K$æ­¥ï¼Œ$K$é˜¶é‚»å±…ã€‚å¼5çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(\vert \varepsilon \vert)$ï¼Œä¹Ÿå°±æ˜¯å’Œè¾¹æ•°å‘ˆçº¿æ€§å…³ç³»ã€‚Defferrard et al.(2016)ä½¿ç”¨è¿™ä¸ª$K$é˜¶å±€éƒ¨å·ç§¯å®šä¹‰äº†åœ¨å›¾ä¸Šçš„å·ç§¯ç¥ç»ç½‘ç»œã€‚&lt;/p&gt;
&lt;h2 id="æŒ‰å±‚çš„çº¿æ€§æ¨¡å‹-layer-wise-linear-model"&gt;æŒ‰å±‚çš„çº¿æ€§æ¨¡å‹ layer-wise linear model
&lt;/h2&gt;&lt;p&gt;ä¸€ä¸ªåŸºäºå›¾å·ç§¯çš„ç¥ç»ç½‘ç»œæ¨¡å‹å¯ä»¥é€šè¿‡å †å å¼5è¿™æ ·çš„å¤šä¸ªå·ç§¯å±‚æ¥å®ç°ï¼Œæ¯å±‚åé¢åŠ ä¸€ä¸ªéçº¿æ€§æ¿€æ´»å³å¯ã€‚ç°åœ¨å‡è®¾$K=1$ï¼Œä¹Ÿå°±æ˜¯å¯¹$L$çº¿æ€§çš„ä¸€ä¸ªå‡½æ•°ï¼Œå› æ­¤å¾—åˆ°ä¸€ä¸ªåœ¨å›¾æ‹‰æ™®æ‹‰æ–¯è°±(graph Laplacian spectrum)ä¸Šçš„çº¿æ€§å‡½æ•°ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬ä»ç„¶èƒ½é€šè¿‡å †å å¤šä¸ªè¿™æ ·çš„å±‚è·å¾—ä¸€ä¸ªå·ç§¯å‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬å°±ä¸ä¼šå†å—é™äºæ˜æ˜¾çš„å‚æ•°é™åˆ¶ï¼Œæ¯”å¦‚åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼ã€‚æˆ‘ä»¬ç›´è§‰ä¸ŠæœŸæœ›è¿™æ ·ä¸€ä¸ªæ¨¡å‹å¯ä»¥å‡è½»åœ¨åº¦åˆ†å¸ƒå¾ˆå¹¿æ³›çš„å›¾ä¸Šå±€éƒ¨å›¾ç»“æ„æ¨¡å‹è¿‡æ‹Ÿåˆçš„é—®é¢˜ï¼Œå¦‚ç¤¾äº¤ç½‘ç»œã€å¼•æ–‡ç½‘ç»œã€çŸ¥è¯†å›¾è°±å’Œå…¶ä»–å¾ˆå¤šçœŸå®æ•°æ®é›†ã€‚æ­¤å¤–ï¼Œè¿™ä¸ªå…¬å¼å¯ä»¥è®©æˆ‘ä»¬æ­å»ºæ›´æ·±çš„ç½‘ç»œï¼Œä¸€ä¸ªå¯ä»¥æå‡æ¨¡å‹å­¦ä¹ èƒ½åŠ›çš„å®ä¾‹æ˜¯He et al., 2016ã€‚
åœ¨GCNçš„çº¿æ€§å…¬å¼ä¸­ï¼Œæˆ‘ä»¬è®©$\lambda_{max}$è¿‘ä¼¼ç­‰äº2ï¼Œå› ä¸ºæˆ‘ä»¬æœŸæœ›ç¥ç»ç½‘ç»œå‚æ•°å¯ä»¥åœ¨è®­ç»ƒä¸­é€‚åº”è¿™ä¸ªå˜åŒ–ã€‚åœ¨è¿™ä¸ªè¿‘ä¼¼ä¸‹ï¼Œå¼5å¯ä»¥ç®€åŒ–ä¸ºï¼š
&lt;/p&gt;
$$\tag{6} g\_\theta' \ast x \approx \theta'\_0x + \theta'\_1 (L - I\_N)x = \theta'\_0x - \theta'\_1 D^{-\frac{1}{2}} A D^{-\frac{1}{2}} x$$&lt;p&gt;
ä¸¤ä¸ªå‚æ•°$\theta&amp;rsquo;_0$å’Œ$\theta&amp;rsquo;_1$ã€‚æ»¤æ³¢å™¨å‚æ•°å¯ä»¥åœ¨æ•´ä¸ªå›¾ä¸Šå…±äº«ã€‚è¿ç»­çš„ä½¿ç”¨è¿™ç§å½¢å¼çš„å·ç§¯å¯ä»¥æœ‰æ•ˆçš„å¯¹ä¸€ä¸ªé¡¶ç‚¹çš„$k$é˜¶é‚»å±…è¿›è¡Œå·ç§¯ï¼Œ$k$æ˜¯è¿ç»­çš„å·ç§¯æ“ä½œæˆ–æ¨¡å‹ä¸­å·ç§¯å±‚çš„ä¸ªæ•°ã€‚
å®é™…ä¸Šï¼Œé€šè¿‡é™åˆ¶å‚æ•°çš„æ•°é‡å¯ä»¥è¿›ä¸€æ­¥çš„è§£å†³è¿‡æ‹Ÿåˆçš„é—®é¢˜ï¼Œå¹¶ä¸”æœ€å°åŒ–æ¯å±‚çš„æ“ä½œæ•°é‡ï¼ˆæ¯”å¦‚çŸ©é˜µä¹˜æ³•ï¼‰ã€‚è¿™æ—¶çš„æˆ‘ä»¬å¾—åˆ°äº†ä¸‹é¢çš„å¼å­ï¼š
&lt;/p&gt;
$$\tag{7} g\_\theta \ast x \approx \theta(I\_N + D^{-\frac{1}{2}} A D^{-\frac{1}{2}}) x$$&lt;p&gt;
åªæœ‰ä¸€ä¸ªå‚æ•°$\theta = \theta&amp;rsquo;_0 = - \theta&amp;rsquo;_1$ã€‚æ³¨æ„ï¼Œ$I_N + D^{-\frac{1}{2}} A D^{-\frac{1}{2}}$ç°åœ¨çš„ç‰¹å¾å€¼åœ¨$[0, 2]$ä¹‹é—´ã€‚åœ¨æ·±å±‚æ¨¡å‹ä¸­é‡å¤åº”ç”¨è¿™ä¸ªæ“ä½œä¼šå¯¼è‡´æ•°å€¼ä¸ç¨³å®šå’Œæ¢¯åº¦çˆ†ç‚¸ã€æ¶ˆå¤±çš„ç°è±¡ã€‚ä¸ºäº†å‡è½»è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥äº†å¦‚ä¸‹çš„é‡æ–°æ­£åˆ™åŒ–æŠ€å·§ï¼š$I_N + D^{-\frac{1}{2}} A D^{-\frac{1}{2}} \to \tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}}$ï¼Œ$\tilde{A} = A + I_N$ï¼Œ$\tilde{D}_{ii} = \sum_j \tilde{A}_{ij}$ã€‚
æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªå®šä¹‰æ³›åŒ–åˆ°ä¸€ä¸ªæœ‰ç€$C$ä¸ªé€šé“çš„ä¿¡å·$X \in \mathbb{R}^{N \times C}$ä¸Šï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªé¡¶ç‚¹éƒ½æœ‰ä¸€ä¸ª$C$ç»´çš„ç‰¹å¾å‘é‡ï¼Œå¯¹äº$F$ä¸ªæ»¤æ³¢å™¨æˆ–$F$ä¸ªfeature mapçš„å·ç§¯å¦‚ä¸‹ï¼š
&lt;/p&gt;
$$\tag{8} Z = \tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}} X \Theta$$&lt;p&gt;
å…¶ä¸­$\Theta \in \mathbb{R}^{C \times F}$æ˜¯ä¸€ä¸ªæ»¤æ³¢å™¨çš„å‚æ•°çŸ©é˜µï¼Œ$Z \in \mathbb{R}^{N \times F}$æ˜¯å·ç§¯çš„ä¿¡å·çŸ©é˜µã€‚å·ç§¯æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(\vert \varepsilon \vert F C)$ï¼Œå› ä¸º$\tilde{A} X$å¯ä»¥è¢«å®ç°æˆä¸€ä¸ªç¨€ç–çŸ©é˜µå’Œä¸€ä¸ªç¨ å¯†çŸ©é˜µçš„ä¹˜ç§¯ã€‚&lt;/p&gt;
&lt;h1 id="åŠç›‘ç£é¡¶ç‚¹åˆ†ç±»"&gt;åŠç›‘ç£é¡¶ç‚¹åˆ†ç±»
&lt;/h1&gt;&lt;p&gt;ä»‹ç»è¿‡è¿™ä¸ªç®€å•ã€çµæ´»çš„å¯ä»¥åœ¨å›¾ä¸Šä¼ æ’­ä¿¡æ¯çš„æ¨¡å‹$f(X, A)$åï¼Œæˆ‘ä»¬å›åˆ°åŠç›‘ç£é¡¶ç‚¹åˆ†ç±»çš„é—®é¢˜ä¸Šã€‚å¦‚ä»‹ç»é‡Œé¢æ‰€è¯´çš„ï¼Œæˆ‘ä»¬å¯ä»¥å‡è½»åœ¨åŸºäºå›¾çš„åŠç›‘ç£å­¦ä¹ ä»»åŠ¡ä¸­çš„å‡è®¾ï¼Œé€šè¿‡åœ¨å›¾ç»“æ„ä¸Šçš„æ•°æ®$X$å’Œé‚»æ¥çŸ©é˜µ$A$ä¸Šä½¿ç”¨æ¨¡å‹$f(X, A)$ã€‚æˆ‘ä»¬æœŸæœ›è¿™ä¸ªè®¾ç½®å¯ä»¥åœ¨é‚»æ¥çŸ©é˜µè¡¨è¾¾å‡ºæ•°æ®$X$æ²¡æœ‰çš„ä¿¡æ¯çš„è¿™ç§æƒ…å†µæ—¶è¡¨ç°çš„å¾ˆå¥½ï¼Œæ¯”å¦‚å¼•æ–‡ç½‘ç»œä¸­ï¼Œå¼•ç”¨çš„å…³ç³»æˆ–æ˜¯çŸ¥è¯†å›¾è°±ä¸­çš„å…³ç³»ã€‚æ•´ä¸ªæ¨¡å‹æ˜¯ä¸€ä¸ªå¤šå±‚çš„GCNï¼Œå¦‚å›¾1æ‰€ç¤ºã€‚
&lt;img src="https://davidham3.github.io/blog/images/semi-supervised-classification-with-graph-convolutional-networks/Fig1.PNG"
loading="lazy"
alt="Fig1"
&gt;&lt;/p&gt;
&lt;h2 id="ä¾‹å­"&gt;ä¾‹å­
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªä¸¤å±‚GCNå¯¹å›¾ä¸­çš„é¡¶ç‚¹è¿›è¡ŒåŠç›‘ç£åˆ†ç±»ï¼Œé‚»æ¥çŸ©é˜µæ˜¯å¯¹ç§°çš„ã€‚æˆ‘ä»¬é¦–å…ˆåœ¨é¢„å¤„ç†ä¸­è®¡ç®—$\hat{A} = \tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}}$ã€‚å‰å‘ä¼ æ’­æ¨¡å‹çš„å½¢å¼å¦‚ä¸‹ï¼š
&lt;/p&gt;
$$\tag{9} Z = f(X, A) = \rm softmax( \hat{A} \ \rm ReLU( \hat{A}XW^{(0)})W^{(1)})$$&lt;p&gt;
è¿™é‡Œï¼Œ$W^{(0)} \in \mathbb{R}^{C \times H}$æ˜¯è¾“å…¥åˆ°éšè—å±‚çš„æƒé‡çŸ©é˜µï¼Œæœ‰$H$ä¸ªfeature mapã€‚$W^{(1)} \in \mathbb{R}^{H \times F}$æ˜¯éšè—å±‚åˆ°è¾“å‡ºçš„æƒé‡çŸ©é˜µã€‚softmaxæ¿€æ´»å‡½æ•°å®šä¹‰ä¸º$\rm softmax(x_i) = \frac{1}{\mathcal{Z}} \exp(x_i)$ï¼Œ$\mathcal{Z} = \sum_i \exp(x_i)$ï¼ŒæŒ‰è¡Œä½¿ç”¨ã€‚å¯¹äºåŠç›‘ç£å¤šç±»åˆ«åˆ†ç±»ï¼Œæˆ‘ä»¬ä½¿ç”¨äº¤å‰ç†µæ¥è¡¡é‡æ‰€æœ‰æ ‡è®°æ ·æœ¬çš„è¯¯å·®ï¼š
&lt;/p&gt;
$$\tag{10} \mathcal{L} = - \sum\_{l \in \mathcal{Y}\_L} \sum^F\_{f = 1} Y\_{lf} \ln(Z\_{lf})$$&lt;p&gt;
å…¶ä¸­ï¼Œ$\mathcal{Y}_L$æ˜¯æœ‰æ ‡ç­¾çš„é¡¶ç‚¹çš„ä¸‹æ ‡é›†åˆã€‚
ç¥ç»ç½‘ç»œæƒé‡$W^{(0)}$å’Œ$W^{(1)}$ä½¿ç”¨æ¢¯åº¦ä¸‹é™è®­ç»ƒã€‚æˆ‘ä»¬æ¯æ¬¡è®­ç»ƒçš„æ—¶å€™éƒ½æ˜¯ç”¨å…¨éƒ¨çš„è®­ç»ƒé›†æ¥åšæ¢¯åº¦ä¸‹é™ï¼Œåªè¦æ•°æ®é›†èƒ½æ”¾åˆ°å†…å­˜ä¸­ã€‚å¯¹$A$è¿›è¡Œç¨€ç–çŸ©é˜µçš„è¡¨ç¤ºï¼Œå†…å­˜çš„ä½¿ç”¨é‡æ˜¯$O(\vert \varepsilon \vert)$ã€‚è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨äº†dropoutå¢åŠ éšæœºæ€§ã€‚æˆ‘ä»¬å°†åœ¨æœªæ¥çš„å·¥ä½œä½¿ç”¨mini-batchéšæœºæ¢¯åº¦ä¸‹é™ã€‚&lt;/p&gt;
&lt;h2 id="å®ç°"&gt;å®ç°
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨Tensorflowå®ç°äº†åŸºäºGPUçš„ï¼Œç¨€ç–ç¨ å¯†çŸ©é˜µä¹˜æ³•å½¢å¼ã€‚å¼9çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(\vert \varepsilon \vert C H F)$ã€‚&lt;/p&gt;</description></item><item><title>Graph Convolutional Neural Networks for Web-Scale Recommender Systems</title><link>https://davidham3.github.io/blog/p/graph-convolutional-neural-networks-for-web-scale-recommender-systems/</link><pubDate>Sun, 17 Jun 2018 21:24:48 +0000</pubDate><guid>https://davidham3.github.io/blog/p/graph-convolutional-neural-networks-for-web-scale-recommender-systems/</guid><description>&lt;p&gt;KDD 2018ã€‚ä½¿ç”¨å›¾å·ç§¯å¯¹é¡¶ç‚¹è¿›è¡Œè¡¨ç¤ºï¼Œå­¦ä¹ é¡¶ç‚¹çš„ embedding ï¼Œé€šè¿‡å·ç§¯å°†è¯¥é¡¶ç‚¹çš„é‚»å±…ä¿¡æ¯èå…¥åˆ°å‘é‡ä¸­ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1806.01973v1" target="_blank" rel="noopener"
&gt;Graph Convolutional Neural Networks for Web-Scale Recommender Systems&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h1 id="abstract"&gt;ABSTRACT
&lt;/h1&gt;&lt;p&gt;æœ€è¿‘åœ¨å›¾æ•°æ®ä¸Šçš„æ·±åº¦ç¥ç»ç½‘ç»œåœ¨æ¨èç³»ç»Ÿä¸Šè¡¨ç°çš„å¾ˆå¥½ã€‚ç„¶è€Œï¼ŒæŠŠè¿™äº›ç®—æ³•åº”ç”¨åˆ°æ•°åäº¿çš„ç‰©å“å’Œæ•°ç™¾äº¿çš„ç”¨æˆ·ä¸Šä»ç„¶æ˜¯ä¸ªæŒ‘æˆ˜ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æå‡ºäº†ä¸€ç§åœ¨ Pinterest ä¸Šçš„å¤§è§„æ¨¡æ·±åº¦æ¨èå¼•æ“ï¼Œå¼€å‘äº†ä¸€ç§é«˜æ•ˆçš„å›¾å·ç§¯ç®—æ³• PinSageï¼Œèåˆäº†éšæœºæ¸¸èµ°å’Œå›¾å·ç§¯ï¼Œæ¥ç”Ÿæˆé¡¶ç‚¹ï¼ˆç‰©å“ï¼‰çš„è¡¨ç¤ºï¼ŒåŒæ—¶æ•´åˆäº†é¡¶ç‚¹ä¿¡æ¯å’Œå›¾ç»“æ„ã€‚å¯¹æ¯”ä¹‹å‰çš„ GCN æ–¹æ³•ï¼Œæˆ‘ä»¬ç ”ç©¶çš„æ¨¡å‹åŸºäºé«˜æ•ˆçš„éšæœºæ¸¸èµ°æ¥ç»“æ„åŒ–å·ç§¯æ“ä½œï¼Œè€Œä¸”è¿˜è®¾è®¡äº†ä¸€ä¸ªæ–°å‹çš„è®­ç»ƒç­–ç•¥ï¼Œè¿™ä¸ªç­–ç•¥ä¾èµ–äº harder-and-harder è®­ç»ƒæ ·æœ¬ï¼Œæ¥æé«˜æ¨¡å‹çš„é²æ£’æ€§å’Œæ”¶æ•›èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„ PinSage åœ¨ Pinterest ä¸Šé¢çš„75äº¿ä¸ªæ ·æœ¬ä¸Šè¿›è¡Œè®­ç»ƒï¼Œå›¾ä¸Šæœ‰30äº¿ä¸ªé¡¶ç‚¹è¡¨ç¤º &lt;em&gt;pins&lt;/em&gt; å’Œ &lt;em&gt;boards&lt;/em&gt;ï¼Œ180äº¿æ¡è¾¹ã€‚æ ¹æ®ç¦»çº¿æŒ‡æ ‡ã€ç”¨æˆ·ç ”ç©¶å’Œ A/B æµ‹è¯•ï¼ŒPinSage ç”Ÿæˆäº†ç›¸æ¯”å…¶ä»–æ·±åº¦å­¦ä¹ å’ŒåŸºäºå›¾çš„æ–¹æ³•æ›´é«˜è´¨é‡çš„æ¨èç»“æœã€‚æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œè¿™æ˜¯æ·±åº¦å›¾è¡¨ç¤ºç›®å‰è§„æ¨¡æœ€å¤§çš„åº”ç”¨ï¼Œå¹¶ä¸”ä¸ºæ–°ä¸€ä»£åŸºäºå›¾å·ç§¯ç»“æ„çš„å¤§è§„æ¨¡æ¨èç³»ç»Ÿå¥ å®šäº†åŸºç¡€ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1 INTRODUCTION
&lt;/h1&gt;&lt;p&gt;æ·±åº¦å­¦ä¹ æ–¹æ³•åœ¨æ¨èç³»ç»Ÿä¸­è¶Šæ¥è¶Šé‡è¦ï¼Œç”¨æ¥å­¦ä¹ å›¾åƒã€æ–‡æœ¬ã€ç”šè‡³æ˜¯ç”¨æˆ·çš„æœ‰æ•ˆçš„ä½ç»´è¡¨ç¤ºã€‚ä½¿ç”¨æ·±åº¦å­¦ä¹ å­¦ä¹ åˆ°çš„è¡¨ç¤ºå¯ä»¥ç”¨æ¥è¡¥å……ã€æˆ–æ˜¯æ›¿æ¢åƒååŒè¿‡æ»¤è¿™æ ·ä¼ ç»Ÿçš„æ¨èç®—æ³•ã€‚è¿™äº›è¡¨ç¤ºå¾ˆæœ‰ç”¨ï¼Œå› ä¸ºä»–ä»¬å¯ä»¥åœ¨å„ç§æ¨èä»»åŠ¡ä¸­é‡å¤ä½¿ç”¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä½¿ç”¨æ·±åº¦æ¨¡å‹å­¦ä¹ å¾—åˆ°çš„ç‰©å“çš„è¡¨ç¤ºï¼Œå¯ä»¥ç”¨æ¥åš â€œç‰©å“-ç‰©å“â€ æ¨èï¼Œä¹Ÿå¯ä»¥æ¥æŒ‰ä¸»é¢˜æ¨èï¼ˆæ¯”å¦‚ï¼Œæ­Œå•ã€æˆ–æ˜¯ Feedæµçš„å†…å®¹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿‘äº›å¹´å¯ä»¥çœ‹åˆ°è¿™ä¸ªé¢†åŸŸçš„å¾ˆå¤šé‡è¦çš„å‘å±•ï¼Œå°¤å…¶æ˜¯æ–°çš„å¯ä»¥å­¦ä¹ å›¾ç»“æ„çš„æ·±åº¦å­¦ä¹ æ–¹æ³•çš„å‘å±•ï¼Œæ˜¯ä¸€äº›æ¨èåº”ç”¨çš„åŸºç¡€ï¼ˆæ¯”å¦‚åœ¨ç”¨æˆ·-ç‰©å“ç½‘ç»œä¸Šæˆ–ç¤¾äº¤ç½‘ç»œä¸Šæ¨èï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™äº›æˆåŠŸçš„æ·±åº¦å­¦ä¹ æ¡†æ¶ä¸­æ¯”è¾ƒé‡è¦çš„æ˜¯å›¾å·ç§¯ç½‘ç»œï¼ˆGCNï¼‰ã€‚æ ¸å¿ƒçš„åŸç†æ˜¯å­¦ä¹ å¦‚ä½•è¿­ä»£åœ°ä½¿ç”¨ç¥ç»ç½‘ç»œä»å±€éƒ¨å›¾é‚»å±…ä¸­èšåˆç‰¹å¾ä¿¡æ¯ï¼ˆå›¾1ï¼‰ã€‚è¿™é‡Œï¼Œä¸€ä¸ªç®€å•çš„å·ç§¯æ“ä½œä»ä¸€æ­¥é‚»å±…ä¸­å˜æ¢å¹¶èšåˆç‰¹å¾ä¿¡æ¯ï¼Œå¹¶ä¸”é€šè¿‡å †å å¤šä¸ªè¿™æ ·çš„å·ç§¯ï¼Œä¿¡æ¯å¯ä»¥ä¼ æ’­åˆ°å›¾ä¸­å¾ˆå¹¿çš„åœ°æ–¹ã€‚ä¸åƒçº¯åŸºäºå†…å®¹çš„æ·±åº¦æ¨¡å‹ï¼ˆå¦‚ RNN ï¼‰ï¼ŒGCN åˆ©ç”¨å†…å®¹ä¿¡æ¯å’Œå›¾ç»“æ„ã€‚åŸºäº GCN çš„æ¨¡å‹çš„æ–¹æ³•å·²ç»åœ¨æ— æ•°æ¨èç³»ç»Ÿä¸­å½¢æˆäº†æ–°çš„æ ‡å‡†ï¼ˆå‚è§[19]çš„ç»¼è¿°ï¼‰ã€‚ç„¶è€Œï¼Œè¿™äº›b enchmark ä¸Šé¢è·å¾—çš„æå‡ï¼Œè¿˜æ²¡æœ‰è¢«è½¬æ¢åˆ°çœŸå®ç¯å¢ƒçš„åº”ç”¨ä¸­å»ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦æŒ‘æˆ˜æ˜¯è¦å°†è®­ç»ƒå’ŒåŸºäº GCN çš„é¡¶ç‚¹è¡¨ç¤ºåœ¨æ•°åäº¿çš„é¡¶ç‚¹å’Œæ•°ç™¾äº¿çš„è¾¹çš„å›¾ä¸­è¿›è¡Œã€‚æ‰©å±• GCN å¾ˆå›°éš¾ï¼Œå› ä¸ºå¾ˆå¤šåœ¨å¤§æ•°æ®ç¯å¢ƒä¸­ï¼Œå¾ˆå¤šåŸºäºè¿™äº› GCN è®¾è®¡çš„å‡è®¾éƒ½ä¸æˆç«‹äº†ã€‚æ¯”å¦‚ï¼Œæ‰€æœ‰çš„åŸºäº GCN çš„æ¨èç³»ç»Ÿéœ€è¦åœ¨è®­ç»ƒæ—¶ä½¿ç”¨å›¾çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼Œä½†æ˜¯å½“é¡¶ç‚¹æ•°å¾ˆå¤§çš„æ—¶å€™ï¼Œè¿™å°±ä¸ç°å®äº†ï¼Œå› ä¸ºç®—ä¸å‡ºæ¥ã€‚&lt;/p&gt;
&lt;h1 id="3-method"&gt;3 METHOD
&lt;/h1&gt;&lt;p&gt;åœ¨è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†æè¿° PinSage çš„ç»“æ„å’Œè®­ç»ƒçš„æŠ€æœ¯ç»†èŠ‚ï¼Œä¹Ÿä¼šè®²ä¸€ä¸‹ä½¿ç”¨è®­ç»ƒå¥½çš„ PinSage æ¨¡å‹æ¥é«˜æ•ˆåœ°ç”Ÿæˆ embedding çš„MapReduce pipelineã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/graph-convolutional-neural-networks-for-web-scale-recommender-systems/Fig1.PNG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ–¹æ³•çš„è®¡ç®—å…³é”®åœ¨äºå±€éƒ¨å›¾å·ç§¯çš„è¡¨ç¤º(notion)ã€‚æˆ‘ä»¬ä½¿ç”¨å¤šä¸ªå·ç§¯æ¨¡å—æ¥èšåˆä¸€ä¸ªé¡¶ç‚¹å±€éƒ¨çš„é‚»åŸŸç‰¹å¾ä¿¡æ¯ï¼ˆå›¾1ï¼‰ï¼Œæ¥ç”Ÿæˆè¿™ä¸ªé¡¶ç‚¹çš„ embeddingï¼ˆæ¯”å¦‚ä¸€ä¸ªç‰©å“ï¼‰ã€‚æ¯ä¸ªæ¨¡å—å­¦ä¹ å¦‚ä½•ä»ä¸€ä¸ªå°çš„å›¾é‚»åŸŸä¸­èšåˆä¿¡æ¯ï¼Œå¹¶ä¸”é€šè¿‡å †å å¤šä¸ªè¿™æ ·çš„æ¨¡å—ï¼Œæˆ‘ä»¬çš„æ–¹æ³•å¯ä»¥è·å¾—å±€éƒ¨ç½‘ç»œçš„æ‹“æ‰‘ç»“æ„ä¿¡æ¯ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™äº›å±€éƒ¨å·ç§¯æ¨¡å—çš„å‚æ•°å¯¹æ‰€æœ‰çš„é¡¶ç‚¹æ¥è¯´æ˜¯å…±äº«çš„ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬çš„æ–¹æ³•çš„å‚æ•°çš„è®¡ç®—å¤æ‚åº¦ä¸è¾“å…¥çš„å›¾çš„å¤§å°æ— å…³ã€‚&lt;/p&gt;
&lt;h1 id="31-problem-setup"&gt;3.1 Problem Setup
&lt;/h1&gt;&lt;p&gt;Pinterest æ˜¯ä¸€ä¸ªå†…å®¹æŒ–æ˜åº”ç”¨ï¼Œåœ¨è¿™é‡Œç”¨æˆ·ä¸ &lt;em&gt;pins&lt;/em&gt; è¿›è¡Œäº¤äº’ï¼Œè¿™äº› &lt;em&gt;pins&lt;/em&gt; æ˜¯åœ¨çº¿å†…å®¹çš„å¯è§æ ‡ç­¾ï¼ˆæ¯”å¦‚ç”¨æˆ·åšé¥­æ—¶çš„é£Ÿè°±ï¼Œæˆ–è€…ä»–ä»¬æƒ³ä¹°çš„è¡£æœï¼‰ã€‚ç”¨æˆ·ç”¨ &lt;em&gt;boards&lt;/em&gt; å°† &lt;em&gt;pins&lt;/em&gt; ç»„ç»‡èµ·æ¥ï¼Œ&lt;em&gt;boards&lt;/em&gt; é‡Œé¢åŒ…å«äº† &lt;em&gt;pins&lt;/em&gt; ç»„æˆçš„é›†åˆï¼Œè¿™äº› &lt;em&gt;pins&lt;/em&gt; åœ¨ç”¨æˆ·çœ‹æ¥æ˜¯ä¸»é¢˜ç›¸å…³çš„ã€‚Pinterest ç»„æˆçš„å›¾åŒ…å«äº† 20 äº¿çš„ &lt;em&gt;pins&lt;/em&gt;ï¼Œ10 äº¿çš„ &lt;em&gt;boards&lt;/em&gt;ï¼Œè¶…è¿‡ 180 äº¿çš„è¾¹ï¼ˆä¹Ÿå°±æ˜¯ &lt;em&gt;pins&lt;/em&gt; å¯¹åº” &lt;em&gt;boards&lt;/em&gt; çš„å…³ç³»ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯ç”Ÿæˆå¯ä»¥ç”¨äºæ¨èçš„é«˜è´¨é‡çš„ embedding æˆ– &lt;em&gt;pins&lt;/em&gt; çš„è¡¨ç¤ºï¼ˆæ¯”å¦‚ï¼Œä½¿ç”¨æœ€è¿‘é‚»æ¥æŸ¥æ‰¾ &lt;em&gt;pin&lt;/em&gt; çš„æ¨èï¼Œæˆ–æ˜¯ä½¿ç”¨ä¸‹æ¸¸çš„å†è¯„åˆ†ç³»ç»Ÿè¿›è¡Œæ¨èï¼‰ã€‚ä¸ºäº†å­¦ä¹ è¿™äº› embeddingï¼Œæˆ‘ä»¬å¯¹ Pinterest ç¯å¢ƒè¿›è¡Œå»ºæ¨¡ï¼Œå¾—åˆ°ä¸€ä¸ªäºŒéƒ¨å›¾ï¼Œé¡¶ç‚¹åˆ†ä¸ºä¸¤ä¸ªä¸ç›¸äº¤çš„é›†åˆï¼Œ$\mathcal{I}$ è¡¨ç¤º &lt;em&gt;pins&lt;/em&gt;ï¼Œ$\mathcal{C}$ è¡¨ç¤º &lt;em&gt;boards&lt;/em&gt;ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ˜¯å¯ä»¥æ³›åŒ–åˆ°å…¶ä»–æ–¹é¢çš„ï¼Œæ¯”å¦‚ $\mathcal{I}$ çœ‹ä½œæ˜¯ç‰©å“ï¼Œ$\mathcal{C}$ çœ‹ä½œæ˜¯ç”¨æˆ·å®šä¹‰çš„ç¯å¢ƒæˆ–æ”¶è—å“é›†åˆç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å†æ¥è¯´è¯´å›¾ç»“æ„ï¼Œæˆ‘ä»¬å‡è®¾ &lt;em&gt;pins/items&lt;/em&gt; $u \in \mathcal{I}$ ä¸ç‰¹å¾ $x_u \in \mathbb{R}^d$ ç›¸å…³ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™äº›ç‰¹å¾å¯èƒ½æ˜¯ç‰©å“çš„å…ƒæ•°æ®æˆ–ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œåœ¨ Pinterest çš„ä¾‹å­ä¸­ï¼Œ&lt;em&gt;pins&lt;/em&gt; æ˜¯å’Œå¯Œæ–‡æœ¬ä¸å›¾ç‰‡ç‰¹å¾ç›¸å…³çš„ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åˆ©ç”¨è¿™äº›è¾“å…¥ç‰¹å¾ï¼Œä¹Ÿåˆ©ç”¨äºŒéƒ¨å›¾çš„å›¾ç»“æ„æ€§è´¨æ¥ç”Ÿæˆé«˜è´¨é‡çš„ embeddingã€‚è¿™äº› embedding å¯ä»¥ç”¨äºæ¨èç³»ç»Ÿï¼Œé€šè¿‡æœ€è¿‘é‚»æŸ¥æ‰¾æ¥ç”Ÿæˆæ¨èï¼Œæˆ–æ˜¯ä½œä¸ºç”¨è¯„åˆ†æ¥æ¨èçš„æœºå™¨å­¦ä¹ ç³»ç»Ÿçš„ç‰¹å¾ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ç¬¦å·çš„ç®€æ´ï¼Œæˆ‘ä»¬ä½¿ç”¨ $\mathcal{V} = \mathcal{I} \cup \mathcal{C}$ æ¥è¡¨ç¤ºå›¾ä¸­çš„é¡¶ç‚¹é›†ï¼Œæ²¡æœ‰ç‰¹æ®Šéœ€è¦ä¸åŒºåˆ† &lt;em&gt;pin&lt;/em&gt; å’Œ &lt;em&gt;board&lt;/em&gt; é¡¶ç‚¹ï¼Œä¸€å¾‹ä½¿ç”¨ &lt;em&gt;node&lt;/em&gt; æ¥è¡¨ç¤ºé¡¶ç‚¹ã€‚&lt;/p&gt;
&lt;h2 id="32-model-architecture"&gt;3.2 Model Architecture
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨å±€éƒ¨å·ç§¯æ¨¡å—å¯¹é¡¶ç‚¹ç”Ÿæˆ embeddingsã€‚é¦–å…ˆè¾“å…¥é¡¶ç‚¹çš„ç‰¹å¾ï¼Œç„¶åå­¦ä¹ ç¥ç»ç½‘ç»œï¼Œç¥ç»ç½‘ç»œä¼šå˜æ¢å¹¶èšåˆæ•´ä¸ªå›¾ä¸Šçš„ç‰¹å¾æ¥è®¡ç®—é¡¶ç‚¹çš„ embeddingsï¼ˆå›¾1ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Forward propagation algorithm.&lt;/strong&gt; è€ƒè™‘å¯¹é¡¶ç‚¹ $u$ ç”Ÿæˆ embedding $z_u$ çš„ä»»åŠ¡ï¼Œéœ€è¦ä¾èµ–é¡¶ç‚¹çš„è¾“å…¥ç‰¹å¾å’Œè¿™ä¸ªé¡¶ç‚¹å‘¨å›´çš„å›¾ç»“æ„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/graph-convolutional-neural-networks-for-web-scale-recommender-systems/algo1.PNG"
loading="lazy"
alt="â€œAlgorithm 1â€"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„ PinSage ç®—æ³•æ˜¯ä¸€ä¸ªå±€éƒ¨å·ç§¯æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå±€éƒ¨å·ç§¯æ“ä½œå­¦åˆ°å¦‚ä½•ä» $u$ çš„é‚»å±…èšåˆä¿¡æ¯ï¼ˆå›¾1ï¼‰ã€‚è¿™ä¸ªæ­¥éª¤åœ¨ç®—æ³•1 CONVOLVE ä¸­æœ‰æ‰€æè¿°ã€‚ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå…¨è¿æ¥ç¥ç»ç½‘ç»œå¯¹ $\forall{v} \in \mathcal{N}(u)$ï¼Œä¹Ÿå°±æ˜¯ $u$ çš„é‚»å±…çš„è¡¨ç¤º $z_v$ è¿›è¡Œäº†å˜æ¢ï¼Œä¹‹ååœ¨ç»“æœå‘é‡é›†åˆä¸Šç”¨ä¸€ä¸ªèšåˆ/æ± åŒ–å‡½æ•°ï¼ˆä¾‹å¦‚ï¼šä¸€ä¸ª element-wise mean æˆ–æ˜¯åŠ æƒæ±‚å’Œï¼Œè¡¨ç¤ºä¸º $\gamma$ï¼‰ï¼ˆLine 1ï¼‰ã€‚è¿™ä¸ªèšåˆæ­¥éª¤ç”Ÿæˆäº†ä¸€ä¸ª $u$ çš„é‚»å±…$\mathcal{N}(u)$ çš„è¡¨ç¤º $n_u$ã€‚ä¹‹åæˆ‘ä»¬å°†è¿™ä¸ªèšé›†é‚»å±…å‘é‡ $n_u$ å’Œ $u$ çš„å½“å‰è¡¨ç¤ºå‘é‡è¿›è¡Œæ‹¼æ¥åï¼Œè¾“å…¥åˆ°ä¸€ä¸ªå…¨è¿æ¥ç¥ç»ç½‘ç»œåšå˜æ¢ï¼ˆLine 2ï¼‰ã€‚é€šè¿‡å®éªŒæˆ‘ä»¬å‘ç°ä½¿ç”¨æ‹¼æ¥æ“ä½œä¼šè·å¾—æ¯”å¹³å‡æ“ä½œ[21]å¥½å¾ˆå¤šçš„ç»“æœã€‚é™¤æ­¤ä»¥å¤–ï¼Œç¬¬ä¸‰è¡Œçš„ normalization ä½¿è®­ç»ƒæ›´ç¨³å®šï¼Œè€Œä¸”å¯¹è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢æ¥è¯´å½’ä¸€åŒ–çš„ embeddings æ›´é«˜æ•ˆï¼ˆSection 3.5ï¼‰ã€‚ç®—æ³•çš„è¾“å‡ºæ˜¯é›†æˆäº† $u$ è‡ªèº«å’Œä»–çš„å±€éƒ¨é‚»åŸŸä¿¡æ¯çš„è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Importance-based neighborhoods.&lt;/strong&gt; æˆ‘ä»¬æ–¹æ³•ä¸­çš„ä¸€ä¸ªé‡è¦åˆ›æ–°æ˜¯å¦‚ä½•å®šä¹‰çš„é¡¶ç‚¹é‚»å±… $\mathcal{N}(u)$ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨ç®—æ³•1ä¸­æ˜¯å¦‚ä½•é€‰æ‹©å·ç§¯çš„é‚»å±…é›†åˆã€‚å°½ç®¡ä¹‹å‰çš„ GCN æ–¹æ³•ç®€å•åœ°æ£€éªŒäº† k-hop é‚»å±…ï¼Œåœ¨ PinSage ä¸­æˆ‘ä»¬å®šä¹‰äº†åŸºäºé‡è¦æ€§çš„é‚»åŸŸï¼Œé¡¶ç‚¹ $u$ çš„é‚»å±…å®šä¹‰ä¸º $T$ ä¸ªé¡¶ç‚¹ï¼Œè¿™ $T$ ä¸ªé¡¶ç‚¹å¯¹ $u$ æ˜¯æœ€æœ‰å½±å“åŠ›çš„ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿäº†ä»é¡¶ç‚¹ $u$ å¼€å§‹çš„éšæœºæ¸¸èµ°ï¼Œå¹¶ä¸”è®¡ç®—äº†é€šè¿‡éšæœºæ¸¸èµ°&lt;a class="link" href="https://arxiv.org/abs/1711.07601" target="_blank" rel="noopener"
&gt;[14]&lt;/a&gt;å¯¹é¡¶ç‚¹çš„è®¿é—®æ¬¡æ•°çš„ $L_1$ å½’ä¸€åŒ–å€¼ã€‚$u$ çš„é‚»å±…å› æ­¤å®šä¹‰ä¸ºé’ˆå¯¹é¡¶ç‚¹ $u$ æ¥è¯´ $T$ ä¸ªæœ€é«˜çš„å½’ä¸€åŒ–çš„è®¿é—®æ•°é‡çš„é¡¶ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªåŸºäºé‡è¦æ€§çš„é‚»åŸŸå®šä¹‰çš„ä¼˜ç‚¹æœ‰ä¸¤ç‚¹ã€‚ç¬¬ä¸€ç‚¹æ˜¯é€‰æ‹©ä¸€ä¸ªå›ºå®šæ•°é‡çš„é‚»å±…é¡¶ç‚¹æ¥èšé›†å¯ä»¥åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ§åˆ¶å†…å­˜å¼€é”€[18]ã€‚ç¬¬äºŒï¼Œåœ¨ç®—æ³•1ä¸­èšé›†é‚»å±…çš„å‘é‡è¡¨ç¤ºæ—¶å¯ä»¥è€ƒè™‘é‚»å±…çš„é‡è¦æ€§ã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬åœ¨ç®—æ³•1ä¸­å®ç°çš„ $\gamma$ æ˜¯ä¸€ä¸ªåŠ æƒæ±‚å‡å€¼çš„æ“ä½œï¼Œæƒé‡å°±æ˜¯ $L_1$ å½’ä¸€åŒ–è®¿é—®æ¬¡æ•°ã€‚æˆ‘ä»¬å°†è¿™ä¸ªæ–°çš„æ–¹æ³•ç§°ä¸ºé‡è¦åº¦æ± åŒ–(&lt;em&gt;importance pooling&lt;/em&gt;)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Stacking convolutions.&lt;/strong&gt; æ¯æ¬¡ä½¿ç”¨ç®—æ³•1çš„ CONVOLVE æ“ä½œéƒ½ä¼šå¾—åˆ°ä¸€ä¸ªé¡¶ç‚¹çš„æ–°çš„è¡¨ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸ªé¡¶ç‚¹ä¸Šå †å å·ç§¯æ¥è·å¾—æ›´å¤šè¡¨ç¤ºé¡¶ç‚¹ $u$ çš„å±€éƒ¨é‚»åŸŸç»“æ„çš„ä¿¡æ¯ã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬ä½¿ç”¨å¤šå±‚å·ç§¯ï¼Œå…¶ä¸­å¯¹ç¬¬ $k$ å±‚å·ç§¯çš„è¾“å…¥ä¾èµ–äº $k-1$ å±‚çš„è¾“å‡ºï¼ˆå›¾1ï¼‰ï¼Œæœ€åˆçš„è¡¨ç¤ºï¼ˆ&amp;ldquo;layer 0&amp;rdquo;ï¼‰ç­‰ä»·äºé¡¶ç‚¹çš„è¾“å…¥ç‰¹å¾ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç®—æ³•1ä¸­çš„æ¨¡å‹å‚æ•°ï¼ˆ$Q$, $q$, $W$ å’Œ $w$ï¼‰åœ¨é¡¶ç‚¹é—´æ˜¯å…±äº«çš„ï¼Œä½†å±‚ä¸å±‚ä¹‹é—´ä¸å…±äº«ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/graph-convolutional-neural-networks-for-web-scale-recommender-systems/algo2.PNG"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;ç®—æ³•2è¯¦ç»†æè¿°äº†å¦‚ä½•å †å å·ç§¯æ“ä½œï¼Œé’ˆå¯¹ä¸€ä¸ª minibatch çš„é¡¶ç‚¹ $\mathcal{M}$ ç”Ÿæˆ embeddingsã€‚é¦–å…ˆè®¡ç®—æ¯ä¸ªé¡¶ç‚¹çš„é‚»å±…ï¼Œç„¶åä½¿ç”¨ $K$ ä¸ªå·ç§¯è¿­ä»£æ¥ç”Ÿæˆç›®æ ‡é¡¶ç‚¹çš„ K å±‚è¡¨ç¤ºã€‚æœ€åä¸€å±‚å·ç§¯å±‚çš„è¾“å‡ºä¹‹åä¼šè¾“å…¥åˆ°ä¸€ä¸ªå…¨è¿æ¥ç¥ç»ç½‘ç»œæ¥ç”Ÿæˆæœ€åçš„ embedding $z_u$ï¼Œ$\forall{u} \in \mathcal{M}$ã€‚&lt;/p&gt;
&lt;p&gt;æ¨¡å‹éœ€è¦å­¦ä¹ çš„å‚æ•°æœ‰ï¼šæ¯ä¸ªå·ç§¯å±‚çš„æƒé‡å’Œåç½®ï¼ˆ$Q^{(k)}$ï¼Œ$q^{(k)}$ï¼Œ$W^{(k)}$ï¼Œ$w^{(k)}$ï¼Œ$\forall{k} \in \lbrace 1,&amp;hellip;,K\rbrace $ï¼‰ï¼Œè¿˜æœ‰æœ€åçš„å…¨è¿æ¥ç½‘ç»œä¸­çš„å‚æ•° $G_1$ï¼Œ$G_2$ï¼Œ$g$ã€‚ç®—æ³•1çš„ç¬¬ä¸€è¡Œçš„æ¯å±‚è¾“å‡ºçš„ç»´åº¦ï¼ˆä¹Ÿå°±æ˜¯ $Q$ çš„åˆ—ç©ºé—´çš„ç»´åº¦ï¼‰è®¾ä¸º $m$ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰å·ç§¯å±‚ï¼ˆç®—æ³•1çš„ç¬¬ä¸‰è¡Œçš„è¾“å‡ºï¼‰çš„è¾“å‡ºéƒ½è®¾ä¸ºåŒä¸€ä¸ªæ•°ï¼Œè¡¨ç¤ºä¸º $d$ã€‚æ¨¡å‹æœ€åçš„è¾“å‡ºï¼ˆç®—æ³•2ç¬¬18è¡Œä¹‹åï¼‰ä¹Ÿè®¾ä¸º $d$ã€‚&lt;/p&gt;
&lt;h2 id="33-model-training"&gt;3.3 Model Training
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ max-margin ranking loss æ¥è®­ç»ƒ PinSageã€‚åœ¨è¿™æ­¥ï¼Œå‡è®¾æˆ‘ä»¬æœ‰äº†ä¸€ç»„æ ‡è®°çš„ç‰©å“å¯¹ $\mathcal{L}$ï¼Œ$(q,i) \in \mathcal{L}$ è®¤ä¸ºæ˜¯ç›¸å…³çš„ï¼Œä¹Ÿå°±æ˜¯å½“æŸ¥è¯¢ $q$ æ—¶ï¼Œç‰©å“ $i$ æ˜¯ä¸€ä¸ªå¥½çš„æ¨èå€™é€‰é¡¹ã€‚è®­ç»ƒé˜¶æ®µçš„ç›®æ ‡æ˜¯ä¼˜åŒ– PinSage çš„å‚æ•°ï¼Œä½¿å¾—ç‰©å“å¯¹ $(q,i) \in \mathcal{L}$ çš„ embedding åœ¨æ ‡è®°é›†åˆä¸­å°½å¯èƒ½çš„æ¥è¿‘ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ margin-based loss functionã€‚é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹æˆ‘ä»¬ä½¿ç”¨çš„å¯ä»¥é«˜æ•ˆåœ°è®¡ç®—å¹¶ä¸”ä½¿ PinSage å¿«é€Ÿæ”¶æ•›çš„ä¸€äº›æŠ€æœ¯ï¼Œè¿™äº›æŠ€æœ¯å¯ä»¥è®©æˆ‘ä»¬è®­ç»ƒåŒ…å«æ•°åäº¿çº§åˆ«çš„é¡¶ç‚¹çš„å›¾ï¼Œä»¥åŠæ•°åäº¿è®­ç»ƒæ ·æœ¬ã€‚æœ€åï¼Œæˆ‘ä»¬æè¿°æˆ‘ä»¬çš„ curriculum-training schemeï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥å…¨æ–¹ä½çš„æå‡æˆ‘ä»¬çš„æ¨èè´¨é‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Loss function.&lt;/strong&gt; ä¸ºäº†è®­ç»ƒæ¨¡å‹çš„å‚æ•°ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªåŸºäºæœ€å¤§è¾¹ç•Œçš„æŸå¤±å‡½æ•°ã€‚åŸºæœ¬çš„æ€æƒ³æ˜¯æˆ‘ä»¬å¸Œæœ›æœ€å¤§åŒ–æ­£ä¾‹ä¹‹é—´çš„å†…ç§¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒæŸ¥è¯¢ç‰©å“çš„ embedding å’Œå¯¹åº”çš„ç›¸å…³ç‰©å“çš„ embedding ä¹‹é—´çš„å†…ç§¯ã€‚ä¸æ­¤åŒæ—¶æˆ‘ä»¬è¿˜æƒ³ç¡®ä¿è´Ÿä¾‹ä¹‹é—´çš„å†…ç§¯ï¼Œä¹Ÿå°±æ˜¯æŸ¥è¯¢ç‰©å“çš„ embedding å’Œé‚£äº›ä¸ç›¸å…³ç‰©å“ embedding ä¹‹é—´çš„å†…ç§¯è¦å°äºé€šè¿‡æå‰å®šä¹‰å¥½çš„è¾¹ç•Œåˆ’åˆ†å‡ºçš„æ­£ä¾‹çš„å†…ç§¯ã€‚å¯¹äºå•ä¸ªé¡¶ç‚¹å¯¹ embeddings $(z_q, z_i):(q, i) \in \mathcal{L}$ çš„æŸå¤±å‡½æ•°æ˜¯ï¼š&lt;/p&gt;
$$
J\_{\mathcal{G}}(z\_qz\_i) = \mathbb{E}\_{n\_k \thicksim p\_n(q)}\max\lbrace 0, z\_q \cdot z\_{n\_k}-z\_q \cdot z\_i + \Delta\rbrace
$$&lt;p&gt;å…¶ä¸­ï¼Œ$P_n(q)$ è¡¨ç¤ºç‰©å“ $q$ çš„è´Ÿæ ·æœ¬åˆ†å¸ƒï¼Œ$\Delta$ è¡¨ç¤º margin è¶…å‚æ•°ã€‚ä¸€ä¼šå„¿ä¼šè®²è´Ÿæ ·æœ¬é‡‡æ ·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Multi-GPU training with large minibatches.&lt;/strong&gt; ä¸ºäº†åœ¨è®­ç»ƒä¸­å……åˆ†åˆ©ç”¨å•å°æœºå™¨çš„å¤šä¸ª GPUï¼Œæˆ‘ä»¬ä»¥ä¸€ç§ multi-tower çš„æ–¹æ³•è¿è¡Œå‰å‘å’Œåå‘ä¼ æ’­ã€‚æˆ‘ä»¬é¦–å…ˆå°†æ¯ä¸ª minibatchï¼ˆå›¾1åº•éƒ¨ï¼‰åˆ†æˆç›¸ç­‰å¤§å°çš„éƒ¨åˆ†ã€‚æ¯ä¸ª GPU è·å¾— minibatch çš„ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨åŒä¸€ç»„å‚æ•°æ¥è¿ç®—ã€‚åœ¨åå‘ä¼ æ’­ä¹‹åï¼Œæ‰€æœ‰ GPU ä¸Šçš„é’ˆå¯¹æ¯ä¸ªå‚æ•°çš„æ¢¯åº¦è¿›è¡Œæ±‡é›†ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªåŒæ­¥çš„ SGDã€‚ç”±äºè®­ç»ƒéœ€è¦æå¤§æ•°é‡çš„æ ·æœ¬ï¼Œæˆ‘ä»¬åœ¨è¿è¡Œæ—¶ä½¿ç”¨äº†å¾ˆå¤§çš„ batch sizeï¼ŒèŒƒå›´ä» 512 åˆ° 4096ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ä¸ Goyal et al.[16] æå‡ºçš„ç›¸ä¼¼çš„æŠ€æœ¯æ¥ç¡®ä¿å¿«é€Ÿæ”¶æ•›ï¼Œè€Œä¸”åœ¨å¤„ç†å¤§ batch size æ—¶è®­ç»ƒçš„ç¨³å®šå’Œæ³›åŒ–ç²¾åº¦ã€‚æˆ‘ä»¬åœ¨ç¬¬ä¸€è½®è®­ç»ƒçš„æ—¶å€™æ ¹æ®çº¿æ€§ç¼©æ”¾åŸåˆ™ä½¿ç”¨ä¸€ä¸ª gradual warmup procedureï¼Œä½¿å­¦ä¹ ç‡ä»å°å¢å¤§åˆ°ä¸€ä¸ªå³°å€¼ã€‚ä¹‹åå­¦ä¹ ç‡ä»¥æŒ‡æ•°çº§å‡å°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Producer-consumer minibatch construction.&lt;/strong&gt; åœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œç”±äºé‚»æ¥è¡¨å’Œç‰¹å¾çŸ©é˜µæœ‰æ•°åäº¿çš„é¡¶ç‚¹ï¼Œæ‰€ä»¥æ”¾åœ¨äº† CPU å†…å­˜ä¸­ã€‚ç„¶è€Œï¼Œåœ¨è®­ç»ƒ PinSage çš„ CONVOLVE æ­¥éª¤æ—¶ï¼Œæ¯ä¸ª GPU éœ€è¦å¤„ç†é‚»å±…å’Œé¡¶ç‚¹é‚»å±…çš„ç‰¹å¾ä¿¡æ¯ã€‚ä» GPU è®¿é—® CPU å†…å­˜ä¸­çš„æ•°æ®æ—¶ä¼šæœ‰å¾ˆå¤§çš„å¼€é”€ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ª &lt;em&gt;re-indexing&lt;/em&gt; çš„æ–¹æ³•åˆ›å»ºåŒ…å«äº†é¡¶ç‚¹å’Œä»–ä»¬çš„é‚»å±…çš„å­å›¾ $G&amp;rsquo; = (V&amp;rsquo;, E&amp;rsquo;)$ï¼Œåœ¨å½“å‰çš„ minibatch ä¸­ä¼šè¢«åŠ å…¥åˆ°è®¡ç®—ä¸­ã€‚åªåŒ…å«å½“å‰ minibatch è®¡ç®—çš„é¡¶ç‚¹ç‰¹å¾ä¿¡æ¯çš„å°çš„ç‰¹å¾çŸ©é˜µä¼šè¢«æŠ½å–å‡ºæ¥ï¼Œé¡ºåºä¸ $G&amp;rsquo;$ ä¸­é¡¶ç‚¹çš„ index ä¸€è‡´ã€‚$G&amp;rsquo;$ çš„é‚»æ¥è¡¨å’Œå°çš„ç‰¹å¾çŸ©é˜µä¼šåœ¨æ¯ä¸ª minibatch è¿­ä»£æ—¶è¾“å…¥åˆ° GPU ä¸­ï¼Œè¿™æ ·å°±æ²¡æœ‰äº† GPU å’Œ CPU é—´çš„é€šä¿¡å¼€é”€äº†ï¼Œæå¤§çš„æé«˜äº† GPU çš„åˆ©ç”¨ç‡ã€‚&lt;/p&gt;
&lt;p&gt;è®­ç»ƒè¿‡ç¨‹æ”¹å˜äº† CPU å’Œ GPU çš„ä½¿ç”¨æ–¹å¼ã€‚æ¨¡å‹è®¡ç®—æ˜¯åœ¨ GPUï¼Œç‰¹å¾æŠ½å–ã€re-indexingã€è´Ÿæ ·æœ¬é‡‡æ ·æ˜¯åœ¨ CPU ä¸Šè¿ç®—çš„ã€‚ä½¿ç”¨ multi-tower è®­ç»ƒçš„ GPU å¹¶è¡Œå’Œ CPU è®¡ç®—ä½¿ç”¨äº† OpenMP[25]ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼åœ¨å½“å‰è¿­ä»£ä¸­ä½¿ç”¨ GPU è®¡ç®—ï¼Œåœ¨ä¸‹ä¸€è½®ä½¿ç”¨ CPU è®¡ç®—ï¼Œä¸¤è€…å¹¶è¡Œè¿›è¡Œã€‚å·®ä¸å¤šå‡å°‘äº†ä¸€åŠçš„æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Sampling negative items.&lt;/strong&gt; è´Ÿæ ·æœ¬é‡‡æ ·åœ¨æˆ‘ä»¬çš„æŸå¤±å‡½æ•°ä¸­ä½œä¸º edge likelihood[23] çš„å½’ä¸€åŒ–ç³»æ•°çš„è¿‘ä¼¼å€¼ã€‚ä¸ºäº†æå‡ batch size è¾ƒå¤§æ—¶çš„è®­ç»ƒæ•ˆç‡ï¼Œæˆ‘ä»¬é‡‡æ ·äº† 500 ä¸ªè´Ÿæ ·æœ¬ä½œä¸ºä¸€ç»„ï¼Œæ¯ä¸ª minibatch çš„è®­ç»ƒæ ·æœ¬å…±åŒä½¿ç”¨è¿™ä¸€ç»„ã€‚ç›¸æ¯”äºå¯¹æ¯ä¸ªé¡¶ç‚¹åœ¨è®­ç»ƒæ—¶éƒ½è¿›è¡Œè´Ÿæ ·æœ¬é‡‡æ ·ï¼Œè¿™æå¤§åœ°å‡å°‘äº†æ¯æ¬¡è®­ç»ƒæ—¶éœ€è¦è®¡ç®—çš„ embeddings çš„æ•°é‡ã€‚ä»å®éªŒä¸Šæ¥çœ‹ï¼Œæˆ‘ä»¬å‘ç°è¿™ä¸¤ç§æ–¹æ³•åœ¨è¡¨ç°ä¸Šæ²¡ä»€ä¹ˆç‰¹åˆ«å¤§çš„å·®å¼‚ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æœ€ç®€å•çš„æƒ…å†µä¸­ï¼Œæˆ‘ä»¬ä»æ•´ä¸ªæ ·æœ¬é›†ä¸­ä½¿ç”¨å‡åŒ€åˆ†å¸ƒçš„æŠ½æ ·æ–¹å¼ã€‚ç„¶è€Œï¼Œç¡®ä¿æ­£ä¾‹($(q, i)$)çš„å†…ç§¯å¤§äº $q$ å’Œ 500 ä¸ªè´Ÿæ ·æœ¬ä¸­æ¯ä¸ªæ ·æœ¬çš„å†…ç§¯æ˜¯éå¸¸ç®€å•çš„ï¼Œè€Œä¸”è¿™æ ·åšä¸èƒ½æä¾›ç»™ç³»ç»Ÿè¶³å¤Ÿå­¦ä¹ çš„åˆ†è¾¨ç‡ã€‚æˆ‘ä»¬çš„æ¨èç®—æ³•åº”è¯¥èƒ½ä» 200 äº¿ä¸ªå•†å“ä¸­æ‰¾åˆ°å¯¹äºç‰©å“ $q$ æ¥è¯´æœ€ç›¸å…³çš„ 1000 ä¸ªç‰©å“ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬çš„æ¨¡å‹åº”è¯¥èƒ½ä»è¶…è¿‡ 2 åƒä¸‡çš„ç‰©å“ä¸­åŒºåˆ†/è¾¨åˆ«å‡º 1 ä»¶ç‰©å“ã€‚ä½†æ˜¯é€šè¿‡éšæœºé‡‡æ ·çš„ 500 ä»¶ç‰©å“ï¼Œæ¨¡å‹çš„åˆ†è¾¨ç‡åªæ˜¯ $\frac{1}{500}$ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬ä» 200 äº¿ç‰©å“ä¸­éšæœºæŠ½å– 500 ä¸ªç‰©å“ï¼Œè¿™äº›ç‰©å“ä¸­çš„ä»»æ„ä¸€ä¸ªäºå½“å‰è¿™ä»¶æŸ¥è¯¢çš„ç‰©å“ç›¸å…³çš„å‡ ç‡éƒ½å¾ˆå°ã€‚å› æ­¤ï¼Œæ¨¡å‹é€šè¿‡è®­ç»ƒä¸èƒ½è·å¾—å¥½çš„å‚æ•°ï¼ŒåŒæ—¶ä¹Ÿä¸èƒ½å¯¹ç›¸å…³çš„ç‰©å“è¿›è¡ŒåŒºåˆ†çš„æ¦‚ç‡å¾ˆå¤§ã€‚ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œå¯¹äºæ¯ä¸ªæ­£è®­ç»ƒæ ·æœ¬ï¼ˆç‰©å“å¯¹$(q, i)$ï¼‰ï¼Œæˆ‘ä»¬åŠ å…¥äº†&amp;quot;hard&amp;quot;è´Ÿä¾‹ï¼Œä¹Ÿå°±æ˜¯é‚£äº›ä¸æŸ¥è¯¢ç‰©å“ $q$ æœ‰æŸç§å…³è”çš„ç‰©å“ï¼Œä½†æ˜¯åˆä¸ä¸ç‰©å“ $i$ æœ‰å…³è”ã€‚æˆ‘ä»¬ç§°è¿™äº›æ ·æœ¬ä¸º&amp;quot;hard negative items&amp;quot;ã€‚é€šè¿‡åœ¨å›¾ä¸­æ ¹æ®ä»–ä»¬å¯¹æŸ¥è¯¢ç‰©å“ $q$ çš„ä¸ªæ€§åŒ– PageRank åˆ†æ•°æ¥ç”Ÿæˆ[14]ã€‚æ’ååœ¨ 2000-5000 çš„ç‰©å“ä¼šè¢«éšæœºé‡‡æ ·ä¸º hard negative itemsã€‚å¦‚å›¾2æ‰€ç¤ºï¼Œhard negative examples ç›¸æ¯”äºéšæœºé‡‡æ ·çš„è´Ÿæ ·æœ¬æ›´ç›¸ä¼¼äºæŸ¥è¯¢ç‰©å“ï¼Œå› æ­¤å¯¹æ¨¡å‹æ¥è¯´æŒ‘æˆ˜æ˜¯æ’åï¼Œè¿«ä½¿æ¨¡å‹å­¦ä¼šåœ¨ä¸€ä¸ªå¥½çš„ç²’åº¦ä¸Šåˆ†è¾¨ç‰©å“ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/graph-convolutional-neural-networks-for-web-scale-recommender-systems/Fig2.PNG"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ hard negative items ä¼šè®©èƒ½ä½¿æ¨¡å‹æ”¶æ•›çš„è®­ç»ƒè½®æ•°ç¿»å€ã€‚ä¸ºäº†å¸®åŠ©æ¨¡å‹æ”¶æ•›ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† curriculum training scheme[4]ã€‚åœ¨è®­ç»ƒçš„ç¬¬ä¸€è½®ï¼Œä¸é€‚ç”¨ hard negative itemsï¼Œè¿™æ ·ç®—æ³•å¯ä»¥å¿«é€Ÿåœ°æ‰¾åˆ° loss ç›¸å¯¹è¾ƒå°çš„å‚æ•°ç©ºé—´ã€‚ä¹‹åæˆ‘ä»¬åœ¨åç»­çš„è®­ç»ƒä¸­åŠ å…¥äº† hard negative itemsï¼Œä¸“æ³¨äºè®©æ¨¡å‹å­¦ä¹ å¦‚ä½•ä»å¼±å…³ç³»ä¸­åŒºåˆ†é«˜åº¦å…³è”çš„pinsã€‚åœ¨ç¬¬ $n$ è½®ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸ªç‰©å“çš„è´Ÿæ ·æœ¬é›†ä¸­åŠ å…¥äº† $n-1$ ä¸ª hard negative itemsã€‚&lt;/p&gt;
&lt;h2 id="34-node-embeddings-via-mapreduce"&gt;3.4 Node Embeddings via MapReduce
&lt;/h2&gt;&lt;p&gt;åœ¨æ¨¡å‹è®­ç»ƒç»“æŸåï¼Œå¯¹äºæ‰€æœ‰çš„ç‰©å“ï¼ˆåŒ…æ‹¬é‚£äº›åœ¨è®­ç»ƒä¸­æœªè§è¿‡çš„ç‰©å“ï¼‰ç›´æ¥ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹ç”Ÿæˆ embeddings è¿˜æ˜¯æœ‰æŒ‘æˆ˜çš„ã€‚ä½¿ç”¨ç®—æ³•2å¯¹é¡¶ç‚¹ç›´æ¥è®¡ç®— embedding çš„æ–¹æ³•ä¼šå¯¼è‡´é‡å¤è®¡ç®—ï¼Œè¿™æ˜¯ç”±é¡¶ç‚¹çš„K-hop é‚»å±…å¯¼è‡´çš„ã€‚å¦‚å›¾1æ‰€ç¤ºï¼Œå¾ˆå¤šé¡¶ç‚¹åœ¨é’ˆå¯¹ä¸åŒçš„ç›®æ ‡é¡¶ç‚¹ç”Ÿæˆ embedding çš„æ—¶å€™è¢«å¾ˆå¤šå±‚é‡å¤è®¡ç®—å¤šæ¬¡ã€‚ä¸ºäº†ç¡®ä¿æ¨ç®—çš„æœ‰æ•ˆæ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ç§ MapReduce æ¶æ„æ¥é¿å…åœ¨ä½¿ç”¨æ¨¡å‹è¿›è¡Œæ¨ç®—çš„æ—¶å€™çš„é‡å¤è®¡ç®—é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç°é¡¶ç‚¹çš„ embedding åœ¨æ¨ç®—çš„æ—¶å€™ä¼šå¾ˆå¥½çš„å°†å…¶è‡ªèº«å¸¦å…¥åˆ° MR è®¡ç®—æ¨¡å‹ä¸­ã€‚å›¾3è¯¦ç»†åœ°è¡¨è¿°äº† pin-to-board Pinterest äºŒéƒ¨å›¾ä¸Šçš„æ•°æ®æµï¼Œæˆ‘ä»¬å‡è®¾è¾“å…¥ï¼ˆ&amp;ldquo;layer-0&amp;rdquo;ï¼‰é¡¶ç‚¹æ˜¯ pins/itemsï¼ˆlayer-1 é¡¶ç‚¹æ˜¯ boards/contextsï¼‰ã€‚MR pipeline æœ‰ä¸¤ä¸ªå…³é”®çš„ç»„æˆéƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸€ä¸ª MapReduce ä»»åŠ¡å°†æ‰€æœ‰çš„ pins æŠ•å½±åˆ°ä¸€ä¸ªä½ç»´éšç©ºé—´ä¸­ï¼Œåœ¨è¿™ä¸ªç©ºé—´ä¸­ä¼šè¿›è¡Œèšåˆæ“ä½œï¼ˆç®—æ³•1ï¼Œç¬¬ä¸€è¡Œï¼‰&lt;/li&gt;
&lt;li&gt;å¦ä¸€ä¸ª MR ä»»åŠ¡æ˜¯å°†ç»“æœçš„ pins è¡¨ç¤ºå’Œä»–ä»¬å‡ºç°åœ¨çš„ boards çš„ id è¿›è¡Œè¿æ¥ï¼Œç„¶åé€šè¿‡ board çš„é‚»å±…ç‰¹å¾çš„æ± åŒ–æ¥è®¡ç®— board çš„ embeddingã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ³¨æ„ï¼Œæˆ‘ä»¬çš„æ–¹æ³•é¿å…äº†å†—ä½™çš„è®¡ç®—ï¼Œå¯¹äºæ¯ä¸ªé¡¶ç‚¹çš„éšå‘é‡åªè®¡ç®—ä¸€æ¬¡ã€‚åœ¨è·å¾— boards çš„ embedding ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªä»¥ä¸Šçš„ MR ä»»åŠ¡ï¼Œç”¨åŒæ ·çš„æ–¹æ³•è®¡ç®—ç¬¬äºŒå±‚ pins çš„ embeddingï¼Œè¿™ä¸ªæ­¥éª¤ä¹Ÿæ˜¯å¯ä»¥è¿­ä»£çš„ï¼ˆç›´åˆ° K ä¸ªå·ç§¯å±‚ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id="35-efficient-nearest-neighbor-lookups"&gt;3.5 Efficient nearest-neighbor lookups
&lt;/h3&gt;&lt;p&gt;ç”± PinSage ç”Ÿæˆçš„ embeddings å¯ä»¥ç”¨åœ¨å¾ˆå¤šä¸‹æ¸¸æ¨èä»»åŠ¡ä¸Šï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸­æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™äº› embeddings æ¥åšæ¨èï¼Œé€šè¿‡åœ¨å­¦ä¹ åˆ°çš„åµŒå…¥ç©ºé—´ä¸­ä½¿ç”¨æœ€è¿‘é‚»æŸ¥æ‰¾ã€‚ä¹Ÿå°±æ˜¯ï¼Œç»™å®šä¸€ä¸ªæŸ¥è¯¢ç‰©å“ $q$ï¼Œæˆ‘ä»¬ä½¿ç”¨ K-è¿‘é‚»çš„æ–¹å¼æ¥æŸ¥æ‰¾æŸ¥è¯¢ç‰©å“ embedding çš„ K ä¸ªé‚»å±…çš„åµŒå…¥ã€‚é€šè¿‡å±€éƒ¨æ•æ„Ÿå“ˆå¸Œ[2]çš„è¿‘ä¼¼ K è¿‘é‚»ç®—æ³•å¾ˆé«˜æ•ˆã€‚åœ¨å“ˆå¸Œå‡½æ•°è®¡ç®—å‡ºåï¼ŒæŸ¥æ‰¾ç‰©å“å¯ä»¥é€šè¿‡ä¸€ä¸ªåŸºäº Weak AND æ“ä½œ[5]çš„ä¸¤é˜¶æ®µæŸ¥è¯¢å®ç°ã€‚PinSage æ¨¡å‹æ˜¯ç¦»çº¿è®¡ç®—çš„å¹¶ä¸”æ‰€æœ‰èŠ‚ç‚¹çš„è¡¨ç¤ºé€šè¿‡ MR è®¡ç®—åå­˜æ”¾åˆ°æ•°æ®åº“ä¸­ï¼Œé«˜æ•ˆçš„æœ€è¿‘é‚»æŸ¥æ‰¾æ–¹æ³•å¯ä»¥ä½¿ç³»ç»Ÿåœ¨çº¿æä¾›æ¨èç»“æœã€‚&lt;/p&gt;</description></item><item><title>æ±‰è¯­åˆ†è¯æœ€å¤§åŒ¹é…ç®—æ³•</title><link>https://davidham3.github.io/blog/p/%E6%B1%89%E8%AF%AD%E5%88%86%E8%AF%8D%E6%9C%80%E5%A4%A7%E5%8C%B9%E9%85%8D%E7%AE%97%E6%B3%95/</link><pubDate>Fri, 15 Jun 2018 19:45:48 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E6%B1%89%E8%AF%AD%E5%88%86%E8%AF%8D%E6%9C%80%E5%A4%A7%E5%8C%B9%E9%85%8D%E7%AE%97%E6%B3%95/</guid><description>&lt;p&gt;æ­£å‘æœ€å¤§åŒ¹é…ï¼Œé€†å‘æœ€å¤§åŒ¹é…&lt;/p&gt;
&lt;h2 id="æ±‰è¯­æ­£å‘é€†å‘æœ€å¤§åˆ†è¯ç®—æ³•"&gt;æ±‰è¯­æ­£å‘ã€é€†å‘æœ€å¤§åˆ†è¯ç®—æ³•
&lt;/h2&gt;&lt;p&gt;æ±‰è¯­åˆ†è¯æœ€å¤§åŒ¹é…æ³•(Maximum Matching)ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ­£å‘æœ€å¤§åŒ¹é…ç®—æ³•(Forward MM)&lt;/li&gt;
&lt;li&gt;é€†å‘æœ€å¤§åŒ¹é…ç®—æ³•(Backward MM)&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="ç®—æ³•"&gt;ç®—æ³•
&lt;/h3&gt;&lt;p&gt;å‡è®¾å¥å­ï¼š$S = c_1c_2Â·Â·Â·c_n$ï¼ŒæŸä¸€è¯ï¼š$w_i = c_1c_2Â·Â·Â·c_m$ï¼Œ$m$ä¸ºè¯å…¸ä¸­æœ€é•¿è¯çš„å­—æ•°ã€‚
FMM ç®—æ³•æè¿°&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä»¤$i=0$ï¼Œå½“å‰æŒ‡é’ˆ$p_i$æŒ‡å‘è¾“å…¥å­—ä¸²çš„åˆå§‹ä½ç½®ï¼Œæ‰§è¡Œä¸‹é¢çš„æ“ä½œï¼š&lt;/li&gt;
&lt;li&gt;è®¡ç®—å½“å‰æŒ‡é’ˆ$p_i$åˆ°å­—ä¸²æœ«ç«¯çš„å­—æ•°ï¼ˆå³æœªè¢«åˆ‡åˆ†å­—ä¸²çš„é•¿åº¦ï¼‰$n$ï¼Œå¦‚æœ$n=1$ï¼Œè½¬(4)ï¼Œç»“æŸç®—æ³•ã€‚å¦åˆ™ï¼Œä»¤$m=$è¯å…¸ä¸­æœ€é•¿å•è¯çš„å­—æ•°ï¼Œå¦‚æœ$n&amp;lt;m$ï¼Œä»¤$m=n$ã€‚&lt;/li&gt;
&lt;li&gt;ä»å½“å‰$p_i$èµ·å–$m$ä¸ªæ±‰å­—ä½œä¸ºè¯$w_i$ï¼Œåˆ¤æ–­ï¼š
3.1. å¦‚æœ$w_i$ç¡®å®æ˜¯è¯å…¸ä¸­çš„è¯ï¼Œåˆ™åœ¨$w_i$åæ·»åŠ ä¸€ä¸ªåˆ‡åˆ†æ ‡å¿—ï¼Œè½¬(3.3);
3.2. å¦‚æœ$w_i$ä¸æ˜¯è¯å…¸ä¸­çš„è¯ä¸”$w_i$çš„é•¿åº¦å¤§äº1ï¼Œå°†$w_i$ä»å³ç«¯å»æ‰ä¸€ä¸ªå­—ï¼Œè½¬(3.1)æ­¥ï¼›å¦åˆ™ï¼ˆ$w_i$çš„é•¿åº¦ç­‰äº1ï¼‰ï¼Œåˆ™åœ¨$w_i$åæ·»åŠ ä¸€ä¸ªåˆ‡åˆ†æ ‡å¿—ï¼Œå°†$w_i$ä½œä¸ºå•å­—è¯æ·»åŠ åˆ°è¯å…¸ä¸­ï¼Œæ‰§è¡Œ(3.3)æ­¥ï¼›
3.3. æ ¹æ®$w_i$çš„é•¿åº¦ä¿®æ”¹æŒ‡é’ˆ$p_i$çš„ä½ç½®ï¼Œå¦‚æœ$p_i$æŒ‡å‘å­—ä¸²æœ«ç«¯ï¼Œè½¬(4)ï¼Œå¦åˆ™ï¼Œ$i=i+1$ï¼Œè¿”å›(2)ï¼›&lt;/li&gt;
&lt;li&gt;è¾“å‡ºåˆ‡åˆ†ç»“æœï¼Œç»“æŸåˆ†è¯ç¨‹åºã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€†å‘æœ€å¤§åŒ¹é…ç®—æ³•åŒç†ã€‚&lt;/p&gt;
&lt;h3 id="æ•°æ®"&gt;æ•°æ®
&lt;/h3&gt;&lt;p&gt;äººæ°‘æ—¥æŠ¥è¯­æ–™ï¼Œæ€»å…±100344æ¡æ ·æœ¬ã€‚
æ ·ä¾‹ï¼šï»¿â€™/w ï¼™ï¼™/m æ˜†æ˜/ns ä¸–åšä¼š/n ç»„å§”ä¼š/j ç§˜ä¹¦é•¿/n ã€/w äº‘å—çœ/ns å‰¯/b çœé•¿/n åˆ˜/nr äº¬/nr ä»‹ç»/v è¯´/v ï¼Œ/w â€™/w ï¼™ï¼™/m ä¸–åšä¼š/j&lt;/p&gt;
&lt;h3 id="ä»£ç "&gt;ä»£ç 
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;collections&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;defaultdict&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;seaborn&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;use&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;fivethirtyeight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;readFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; read file return a generator, each element is one line
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; Parameters
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>vscode-remote-workspace</title><link>https://davidham3.github.io/blog/p/vscode-remote-workspace/</link><pubDate>Fri, 15 Jun 2018 09:46:40 +0000</pubDate><guid>https://davidham3.github.io/blog/p/vscode-remote-workspace/</guid><description>&lt;p&gt;ä½¿ç”¨vscodeç®¡ç†è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ä¸é¡¹ç›®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://github.com/mkloubert/vscode-remote-workspace" target="_blank" rel="noopener"
&gt;vscode-remote-workspace&lt;/a&gt;æ˜¯ä¸€ä¸ªvscodeä¸­çš„æ’ä»¶ï¼Œå¯ä»¥ç®¡ç†è¿œç¨‹å­˜å‚¨ä¸Šçš„æ–‡ä»¶ã€é¡¹ç›®ï¼Œè¿˜å¯ä»¥æ‰§è¡Œå‘½ä»¤ã€‚
æ”¯æŒçš„ç³»ç»Ÿå¾ˆå¤šï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Auzre&lt;/li&gt;
&lt;li&gt;Dropbox&lt;/li&gt;
&lt;li&gt;FTP&lt;/li&gt;
&lt;li&gt;FTPs&lt;/li&gt;
&lt;li&gt;S3 Buckets&lt;/li&gt;
&lt;li&gt;SFTP&lt;/li&gt;
&lt;li&gt;Slack&lt;/li&gt;
&lt;li&gt;WebDAV&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»¥SFTPä¸ºä¾‹ï¼Œåªè¦å†™è¿™ä¹ˆä¸€ä¸ªé…ç½®æ–‡ä»¶å³å¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;#34;folders&amp;#34;: [{
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;#34;uri&amp;#34;: &amp;#34;sftp://my-user:my-password@sftp.example.com/&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;#34;name&amp;#34;: &amp;#34;My SFTP folder&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; }],
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;#34;settings&amp;#34;: {}
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;#34;folders&amp;#34;: [{
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;#34;uri&amp;#34;: &amp;#34;sftp://Davidham3:my-password@my-linux-server-ip/data/Davidham3&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;#34;name&amp;#34;: &amp;#34;My SFTP folder&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; }],
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;#34;settings&amp;#34;: {}
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¿å­˜æˆåä¸ºmy-linux-server.code-workspaceçš„æ–‡ä»¶åï¼Œå³é”®ç‚¹å‡»è¿™ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨vscodeæ‰“å¼€å³å¯ã€‚æˆ–æ˜¯æ‰“å¼€vscodeåï¼Œç‚¹å‡»â€œæ–‡ä»¶â€ï¼Œé€‰æ‹©â€œæ‰“å¼€å·¥ä½œåŒºâ€ï¼Œç„¶åé€‰æ‹©è¿™ä¸ªæ–‡ä»¶å³å¯ã€‚
&lt;img src="https://davidham3.github.io/blog/images/vscode-remote-workspace/demo1.gif"
loading="lazy"
&gt;
ä½¿ç”¨F1ï¼Œç„¶åè¾“å…¥&lt;code&gt;execute remote command&lt;/code&gt;ï¼Œç„¶åå°±å¯ä»¥è¾“å…¥å‘½ä»¤ï¼Œç›´æ¥åœ¨è¿œç¨‹æœºå™¨ä¸Šè¿è¡Œã€‚
&lt;img src="https://davidham3.github.io/blog/images/vscode-remote-workspace/demo2.PNG"
loading="lazy"
&gt;&lt;/p&gt;
&lt;h1 id="å®‰è£…æ–¹æ³•"&gt;å®‰è£…æ–¹æ³•
&lt;/h1&gt;&lt;p&gt;æ‰“å¼€vscodeåï¼Œé€‰æ‹©å·¦ä¾§ç¬¬äº”ä¸ªæŒ‰é’®ï¼Œè¿›å…¥å•†åº—ï¼Œç„¶åæŸ¥æ‰¾vscode-remote-workspaceï¼Œç‚¹å‡»ç»¿è‰²çš„å®‰è£…æŒ‰é’®å®‰è£…å³å¯ï¼Œå®‰è£…åç‚¹è“è‰²çš„â€œé‡æ–°åŠ è½½â€æŒ‰é’®å³å¯ã€‚
&lt;img src="https://davidham3.github.io/blog/images/vscode-remote-workspace/demo3.PNG"
loading="lazy"
&gt;&lt;/p&gt;
&lt;h1 id="é—®é¢˜"&gt;é—®é¢˜
&lt;/h1&gt;&lt;p&gt;ä¸è¿‡ä½¿ç”¨execute remote commandçš„æ—¶å€™ï¼Œå¦‚æœç¨‹åºå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä¸æŠ¥é”™ï¼Œé‚£è¿™ä¸ªå·¥å…·æ˜¯å¯ä»¥æ˜¾ç¤ºå†…å®¹çš„ï¼Œä½†æ˜¯ä¸€æ—¦ç¨‹åºå‡ºé”™äº†ï¼Œå°±ä¸ä¼šæœ‰ä»»ä½•é”™è¯¯ä¿¡æ¯æ˜¾ç¤ºã€‚è¿™ç‚¹è¿™ä¸ªå·¥å…·æ²¡æ³•å¤„ç†ã€‚æ‰€ä»¥è§£å†³æ–¹æ¡ˆå°±æ˜¯ï¼Œç›´æ¥ç”¨ä¸‹é¢çš„ç»ˆç«¯ï¼Œsshè¿›å»ã€‚æœ€æ–°ç‰ˆæœ¬çš„Windows10å·²ç»å†…ç½®äº†OpenSSHï¼Œæ‰€ä»¥ç›´æ¥ç”¨&lt;code&gt;ssh ç”¨æˆ·å@hostname&lt;/code&gt;å°±å¯ä»¥è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œç„¶åæ‰§è¡Œå‘½ä»¤è·‘ç¨‹åºã€‚&lt;/p&gt;</description></item><item><title>Gaussian Naive Bayes</title><link>https://davidham3.github.io/blog/p/gaussian-naive-bayes/</link><pubDate>Thu, 14 Jun 2018 19:33:30 +0000</pubDate><guid>https://davidham3.github.io/blog/p/gaussian-naive-bayes/</guid><description>&lt;p&gt;å‡è®¾è¿ç»­å‹éšæœºå˜é‡æœä»é«˜æ–¯åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯ã€‚å‘ç°è‡ªå·±å®ç°çš„ç‰ˆæœ¬æ¯”sklearnçš„ç²¾åº¦ä½äº†20%å·¦å³â€¦â€¦ç ”ç©¶äº†ä¸€ä¸‹å·®åœ¨äº†å“ªé‡Œã€‚&lt;/p&gt;
&lt;h1 id="æœ´ç´ è´å¶æ–¯"&gt;æœ´ç´ è´å¶æ–¯
&lt;/h1&gt;&lt;p&gt;æœ´ç´ è´å¶æ–¯æ˜¯åŸºäºè´å¶æ–¯å®šç†ä¸ç‰¹å¾æ¡ä»¶ç‹¬ç«‹å‡è®¾çš„åˆ†ç±»å™¨ã€‚&lt;/p&gt;
&lt;h2 id="åŸç†"&gt;åŸç†
&lt;/h2&gt;&lt;p&gt;æœ´ç´ è´å¶æ–¯é€šè¿‡ç»™å®šè®­ç»ƒé›†&lt;/p&gt;
$$T = \lbrace (x\_1, y\_1), (x\_2, y\_2), Â·Â·Â·, (x\_N, y\_N)\rbrace $$&lt;p&gt;è®­ç»ƒå­¦ä¹ åˆ°è”åˆæ¦‚ç‡åˆ†å¸ƒ$P(X, Y)$ï¼Œé€šè¿‡å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒ&lt;/p&gt;
$$P(Y = c\_k), k = 1,2,...,K$$&lt;p&gt;å’Œæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ&lt;/p&gt;
$$P(X = x \mid Y = c\_k) = P(X^{(1)} = x^{(1)}, Â·Â·Â·, X^{(n)} = x^{(n)} \mid Y = c\_k), k=1,2,...,K$$&lt;p&gt;å­¦ä¹ åˆ°è”åˆæ¦‚ç‡åˆ†å¸ƒ$P(X, Y)$&lt;/p&gt;
&lt;p&gt;ç”±ç‰¹å¾ç›¸äº’ç‹¬ç«‹å‡è®¾ï¼Œå¯å¾—&lt;/p&gt;
$$P(X = x \mid Y = c\_k) = \prod^n\_{j=1}P(X^{(j)}=x^{(j)} \mid Y = c\_k)$$&lt;p&gt;åˆ†ç±»æ—¶ï¼Œå¯¹ç»™å®šçš„è¾“å…¥$x$ï¼Œæ¨¡å‹è®¡ç®—$P(Y = c_k \mid X = x)$ï¼Œå°†åéªŒæ¦‚ç‡æœ€å¤§çš„ç±»ä½œä¸º$x$çš„ç±»è¾“å‡ºï¼ŒåéªŒæ¦‚ç‡è®¡ç®—å¦‚ä¸‹ï¼š&lt;/p&gt;
$$
\begin{aligned}
P(Y = c\_k \mid X = x) &amp;= \frac{P(X = x \mid Y = c\_k)P(Y = c\_k)}{\sum\_kP(X = x \mid Y = c\_k)P(Y = c\_k)} \\
&amp; = \frac{P(Y = c\_k) \prod\_j P(X^{(j)} = x^{(j)} \mid Y = c\_k)}{\sum\_k P(Y = c\_k) \prod\_j P(X^{(j)} = x^{(j)} \mid Y = c\_k)}
\end{aligned}
$$&lt;p&gt;ç”±äºåˆ†æ¯å¯¹ä»»æ„çš„$c_k$éƒ½ç›¸åŒï¼Œæ•…æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨å¯ä»¥è¡¨ç¤ºä¸ºï¼š&lt;/p&gt;
$$
y = \mathop{\arg\max}\_{c\_k} P(Y = c\_k) \prod\_j P(X^{(j)} = x^{(j)} \mid Y = c\_k)
$$&lt;h2 id="å‚æ•°ä¼°è®¡"&gt;å‚æ•°ä¼°è®¡
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å¦‚æœç‰¹å¾æ˜¯ç¦»æ•£å‹éšæœºå˜é‡ï¼Œå¯ä»¥ä½¿ç”¨é¢‘ç‡ç”¨æ¥ä¼°è®¡æ¦‚ç‡ã€‚&lt;/p&gt;
$$P(Y = c\_k) = \frac{\sum^N\_{i=1}I(y\_i = c\_k)}{N}, k=1,2,...,K$$&lt;p&gt;è®¾ç¬¬$j$ä¸ªç‰¹å¾çš„å–å€¼çš„é›†åˆä¸º${a_{j1}, a_{j2}, &amp;hellip;, a_{js_j}}$ï¼Œåˆ™&lt;/p&gt;
$$
\begin{gathered}P(X^{(j)} = a\_{jl} \mid Y = c\_k) = \frac{\sum^N\_{i=1}I(x^{(j)}\_i = a\_{jl}, y\_i = c\_k)}{\sum^N\_{i=1}I(y\_i = c\_k)}\\
j=1,2,...,n; \ l=1,2,...,S\_j; \ k=1,2,...,K
\end{gathered}
$$&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¦‚æœç‰¹å¾æ˜¯è¿ç»­å‹éšæœºå˜é‡ï¼Œå¯ä»¥å‡è®¾æ­£æ€åˆ†å¸ƒæ¥ä¼°è®¡æ¡ä»¶æ¦‚ç‡ã€‚&lt;/p&gt;
$$P(X^{(j)} = a\_{jl} \mid Y = c\_k) = \frac{1}{\sqrt{2 \pi \sigma^2\_{c\_k,j}}}\exp{(- \frac{(a\_{jl} - \mu\_{c\_k,j})^2}{2 \sigma^2\_{c\_k,j}})}$$&lt;p&gt;è¿™é‡Œ$\mu_{c_k,j}$å’Œ$\sigma^2_{c_k,j}$åˆ†åˆ«ä¸º$Y = c_k$æ—¶ï¼Œç¬¬$j$ä¸ªç‰¹å¾çš„å‡å€¼å’Œæ–¹å·®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="ä»£ç "&gt;ä»£ç 
&lt;/h2&gt;&lt;p&gt;å› ä¸ºäºŒå€¼åˆ†ç±»å’Œ$n$å€¼åˆ†ç±»æ˜¯ä¸€æ ·çš„ï¼Œæ•…ä»¥ä¸‹ä»£ç åªå®ç°äº†$n$å€¼åˆ†ç±»çš„æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ã€‚
ä»“åº“:&lt;a class="link" href="https://github.com/Davidham3/naive_bayes" target="_blank" rel="noopener"
&gt;https://github.com/Davidham3/naive_bayes&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;span class="lnt"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;collections&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;defaultdict&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;readDataSet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;frequency&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;training_set_ratio&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shuffle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; read the dataset file, and shuffle, remove all punctuations
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; Parameters
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>è¿ç§»CentOS7è™šæ‹Ÿæœºmacå’Œç½‘å¡åå˜æ¢å¯¼è‡´ç½‘ç»œä¸é€šçš„é—®é¢˜</title><link>https://davidham3.github.io/blog/p/%E8%BF%81%E7%A7%BBcentos7%E8%99%9A%E6%8B%9F%E6%9C%BAmac%E5%92%8C%E7%BD%91%E5%8D%A1%E5%90%8D%E5%8F%98%E6%8D%A2%E5%AF%BC%E8%87%B4%E7%BD%91%E7%BB%9C%E4%B8%8D%E9%80%9A%E7%9A%84%E9%97%AE%E9%A2%98/</link><pubDate>Tue, 12 Jun 2018 11:15:17 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E8%BF%81%E7%A7%BBcentos7%E8%99%9A%E6%8B%9F%E6%9C%BAmac%E5%92%8C%E7%BD%91%E5%8D%A1%E5%90%8D%E5%8F%98%E6%8D%A2%E5%AF%BC%E8%87%B4%E7%BD%91%E7%BB%9C%E4%B8%8D%E9%80%9A%E7%9A%84%E9%97%AE%E9%A2%98/</guid><description>&lt;p&gt;vcenterè¿ç§»è™šæ‹Ÿæœºçš„æ—¶å€™ï¼Œè¿ç§»ä¹‹åè™šæ‹Ÿæœºç½‘ç»œä¸é€šã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a class="link" href="https://www.jianshu.com/p/29af2068cfb6" target="_blank" rel="noopener"
&gt;è§£å†³CentOS 7è™šæ‹Ÿæœºå…‹éš†çš„ç½‘ç»œé—®é¢˜&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨vcenterçš„è¿ç§»åï¼Œè™šæ‹Ÿæœºå‡ºç°äº†ç½‘ç»œä¸é€šçš„ç°è±¡ï¼Œä»”ç»†è§‚å¯Ÿå¯ä»¥å‘ç°vcenterç»™è™šæ‹Ÿæœºåˆ†é…äº†æ–°çš„macåœ°å€ã€‚
å› ä¸ºLinuxç³»ç»Ÿä¼šè®°å½•macåœ°å€ä¸ç½‘å¡åçš„å…³ç³»ï¼Œæ‰€ä»¥Linuxç³»ç»Ÿåœ¨è¿è¡Œåï¼Œå‘ç°macå˜äº†ï¼Œäºæ˜¯ä¼šç»™å½“å‰è¿™å¼ ç½‘å¡åˆ†é…ä¸€ä¸ªæ–°çš„ç½‘å¡åã€‚
è§£å†³æ–¹æ¡ˆå°±æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¿®æ”¹ç½‘å¡é…ç½®æ–‡ä»¶/etc/sysconfig/network-scripts/ifcfg-eno16884287
åˆ é™¤UUIDè¿™ä¸€è¡Œï¼Œå› ä¸ºæ¯å¼ ç½‘å¡çš„macåœ°å€æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥UUIDä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚
ä¿®æ”¹HWADDRä¸ºè™šæ‹Ÿæœºå…‹éš†åçš„MACåœ°å€&lt;/li&gt;
&lt;li&gt;è¿›å…¥/etc/udev/rules.d/è¿™ä¸ªç›®å½•ï¼Œå°†é‡Œé¢çš„.rulesæ–‡ä»¶æ”¹å
&lt;code&gt;mv 70-persistent-ipoib.rules 70-persistent-ipoib.rules.bak&lt;/code&gt;
&lt;code&gt;mv 90-eno-fix.rules 90-eno-fix.rules.bak&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;é‡å¯
&lt;code&gt;reboot&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>Lattice LSTM ä¸­æ–‡NER</title><link>https://davidham3.github.io/blog/p/lattice-lstm-%E4%B8%AD%E6%96%87ner/</link><pubDate>Wed, 23 May 2018 16:54:12 +0000</pubDate><guid>https://davidham3.github.io/blog/p/lattice-lstm-%E4%B8%AD%E6%96%87ner/</guid><description>&lt;p&gt;ACL 2018ï¼ŒåŸºäºLSTM+CRFï¼Œç”¨word2vecå¯¹å­—ç¬¦è¿›è¡Œè¡¨ç¤ºï¼Œç„¶åç”¨å¤§è§„æ¨¡è‡ªåŠ¨åˆ†è¯çš„é¢„æ–™ï¼Œå°†è¯è¿›è¡Œè¡¨ç¤ºï¼Œæ‰”è¿›LSTMè·å¾—ç»†èƒçŠ¶æ€ï¼Œä¸åŸºäºå­—ç¬¦çš„LSTMçš„ç»†èƒçŠ¶æ€ç›¸ç»“åˆï¼Œå¾—åˆ°åºåˆ—çš„éšè—çŠ¶æ€ï¼Œç„¶åå¥—ä¸€ä¸ªCRFã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1805.02023" target="_blank" rel="noopener"
&gt;Chinese NER Using Lattice LSTM&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="æ‘˜è¦"&gt;æ‘˜è¦
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬è°ƒæŸ¥äº†lattice-structured LSTMæ¨¡å‹åœ¨ä¸­æ–‡åˆ†è¯ä¸Šçš„è¡¨ç°ï¼Œè¿™ä¸ªæ¨¡å‹å°†è¾“å…¥çš„å­—ç¬¦åºåˆ—å’Œæ‰€æœ‰å¯èƒ½åŒ¹é…åˆ°è¯å…¸ä¸­çš„è¯è¿›è¡Œç¼–ç ã€‚å¯¹æ¯”åŸºäºå­—ç¬¦çš„æ–¹æ³•ï¼Œæˆ‘ä»¬çš„æ¨¡å‹æ˜æ˜¾çš„åˆ©ç”¨äº†è¯ä¸è¯åºåˆ—çš„ä¿¡æ¯ã€‚å¯¹äºåŸºäºè¯çš„æ–¹æ³•ï¼Œlattice LSTMä¸ä¼šå—åˆ°é”™è¯¯åˆ†è¯çš„å½±å“ã€‚é—¨æ§å¾ªç¯ç»†èƒå¯ä»¥ä½¿æ¨¡å‹ä»åºåˆ—ä¸­é€‰å–æœ€ç›¸å…³çš„å­—ç¬¦å’Œå•è¯è·å¾—æ›´å¥½çš„NERç»“æœã€‚å®éªŒåœ¨å„ç§æ•°æ®é›†ä¸Šéƒ½æ˜¾ç¤ºå‡ºlattice LSTMæ¯”åŸºäºè¯å’ŒåŸºäºå­—çš„LSTMè¦å¥½ï¼Œè·å¾—äº†æœ€å¥½çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;h2 id="å¼•è¨€"&gt;å¼•è¨€
&lt;/h2&gt;&lt;p&gt;ä¿¡æ¯æŠ½å–ä¸­æœ€åŸºç¡€çš„ä»»åŠ¡ï¼ŒNERè¿‘äº›å¹´å—åˆ°äº†å¹¿æ³›çš„å…³æ³¨ã€‚NERä»¥å¾€è¢«å½“ä½œä¸€ä¸ªåºåˆ—æ ‡æ³¨é—®é¢˜æ¥è§£å†³ï¼Œå®ä½“çš„è¾¹ç•Œå’Œç±»åˆ«æ ‡ç­¾æ˜¯åŒæ—¶è¿›è¡Œé¢„æµ‹çš„ã€‚å½“å‰æœ€å…ˆè¿›çš„è‹±æ–‡å‘½åå®ä½“è¯†åˆ«çš„æ–¹æ³•æ˜¯ä½¿ç”¨é›†æˆè¿›å•è¯è¡¨ç¤ºçš„å­—ç¬¦ä¿¡æ¯çš„LSTM-CRFæ¨¡å‹ï¼ˆLample et al., 2016; Ma and Hovy, 2016; Chiu and Nichols, 2016; Liu et al., 2018ï¼‰ã€‚
ä¸­æ–‡NERä¸åˆ†è¯è”ç³»çš„å¾ˆç´§å¯†ã€‚å°¤å…¶æ˜¯å‘½åå®ä½“çš„è¾¹ç•Œä¹Ÿæ˜¯è¯çš„è¾¹ç•Œã€‚ä¸€ä¸ªç›´è§‚çš„æƒ³æ³•æ˜¯å…ˆåˆ†è¯ï¼Œå†æ ‡æ³¨è¯ã€‚ç„¶è€Œè¿™ä¸ªpipelineä¼šå—åˆ°é”™è¯¯åˆ†è¯çš„å½±å“ï¼Œå› ä¸ºå‘½åå®ä½“æ˜¯åˆ†è¯ä¸­OOVä¸­çš„å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸”ä¸æ­£ç¡®çš„å®ä½“è¾¹ç•Œåˆ’åˆ†ä¼šå¯¼è‡´é”™è¯¯çš„NERã€‚è¿™ä¸ªé—®é¢˜åœ¨open domainä¸­å¾ˆä¸¥é‡ï¼Œå› ä¸ºè·¨é¢†åŸŸçš„åˆ†è¯è¿˜æ˜¯ä¸ºè§£å†³çš„é—®é¢˜ï¼ˆLiu and Zhang, 2012; Jiang et al., 2013; Liu et al., 2014; Qiu and Zhang, 2015; Chen et al., 2017; Huang et al., 2017ï¼‰ã€‚åŸºäºå­—ç¬¦çš„æ–¹æ³•æ¯”åŸºäºè¯çš„æ–¹æ³•åœ¨ä¸­æ–‡NERä¸­è¡¨ç°çš„å¥½ï¼ˆHe and Wang, 2008; Liu et al., 2010; Li et al., 2014ï¼‰ã€‚
ç„¶è€Œï¼ŒåŸºäºå­—ç¬¦çš„NERçš„ä¸€ä¸ªç¼ºç‚¹æ˜¯ï¼Œè¯ä¸è¯çš„åºåˆ—ä¿¡æ¯ä¸èƒ½è¢«å®Œå…¨åˆ©ç”¨åˆ°ï¼Œç„¶è€Œè¿™éƒ¨åˆ†ä¿¡æ¯å¯èƒ½å¾ˆæœ‰ç”¨ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨ä¸€ä¸ªlattice LSTMè¡¨ç¤ºå¥å­ä¸­çš„lexicon wordsï¼Œåœ¨åŸºäºå­—ç¬¦çš„LSTM-CRFæ¨¡å‹ä¸­é›†æˆäº†latent word informationã€‚å¦‚å›¾1æ‰€ç¤ºï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå¤§å‹çš„è‡ªåŠ¨è·å–çš„è¯å…¸æ¥åŒ¹é…ä¸€ä¸ªå¥å­ï¼Œæ„å»ºäº†ä¸€ä¸ªè¯-å­—latticeã€‚ç»“æœæ˜¯ï¼Œè¯åºåˆ—ï¼Œåƒâ€œé•¿æ±Ÿå¤§æ¡¥â€ï¼Œâ€œé•¿æ±Ÿâ€ï¼Œâ€œå¤§æ¡¥â€å¯ä»¥ç”¨æ¥åœ¨ä¸Šä¸‹æ–‡ä¸­åŒºåˆ†æ½œåœ¨çš„ç›¸å…³çš„å‘½åå®ä½“ï¼Œæ¯”å¦‚äººåâ€œæ±Ÿå¤§æ¡¥â€ã€‚
&lt;img src="https://davidham3.github.io/blog/images/lattice-lstm-%e4%b8%ad%e6%96%87ner/Fig1.PNG"
loading="lazy"
alt="Fig1"
&gt;
&lt;img src="https://davidham3.github.io/blog/images/lattice-lstm-%e4%b8%ad%e6%96%87ner/Fig2.PNG"
loading="lazy"
alt="Fig2"
&gt;
å› ä¸ºåœ¨latticeä¸­æœ‰å¾ˆå¤šæ½œåœ¨çš„è¯-å­—è·¯å¾„ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†ä¸€ä¸ªlattice-LSTMç»“æ„æ¥è‡ªåŠ¨åœ°æ§åˆ¶å¥å­çš„å¼€å§‹åˆ°ç»“å°¾çš„ä¿¡æ¯æµã€‚å¦‚å›¾2æ‰€ç¤ºï¼Œé—¨æ§ç»†èƒè¢«ç”¨äºåŠ¨æ€è§„åˆ’ä¿¡æ¯ä»ä¸åŒçš„è·¯å¾„åˆ°æ¯ä¸ªå­—ç¬¦ä¸Šã€‚åœ¨NERæ•°æ®ä¸Šè®­ç»ƒçš„lattice LSTMå¯ä»¥å­¦ä¹ åˆ°å¦‚ä½•ä»ä¸Šä¸‹æ–‡ä¸­æ‰¾åˆ°æœ‰ç”¨çš„å•è¯ï¼Œè‡ªåŠ¨åœ°æé«˜NERçš„ç²¾åº¦ã€‚å¯¹æ¯”åŸºäºå­—ç¬¦çš„å’ŒåŸºäºå•è¯çš„NERæ–¹æ³•ï¼Œæˆ‘ä»¬çš„æ¨¡å‹çš„ä¼˜åŠ¿åœ¨äºåˆ©ç”¨åœ¨å­—ç¬¦åºåˆ—æ ‡ç­¾ä¸Šçš„å•è¯ä¿¡æ¯ï¼Œä¸”ä¸ä¼šå—åˆ°é”™è¯¯åˆ†è¯çš„å½±å“ã€‚
ç»“æœæ˜¾ç¤ºæˆ‘ä»¬çš„æ¨¡å‹æ¯”å­—ç¬¦åºåˆ—æ ‡æ³¨æ¨¡å‹å’Œä½¿ç”¨LSTM-CRFçš„å•è¯åºåˆ—æ ‡æ³¨æ¨¡å‹éƒ½è¦å¥½å¾ˆå¤šï¼Œåœ¨å¾ˆå¤šä¸­æ–‡è·¨é¢†åŸŸçš„NERæ•°æ®é›†ä¸Šéƒ½è·å¾—äº†å¾ˆå¥½çš„ç»“æœã€‚æˆ‘ä»¬çš„æ¨¡å‹å’Œæ•°æ®åœ¨https://github.com/jiesutd/LatticeLSTMã€‚&lt;/p&gt;
&lt;h2 id="ç›¸å…³å·¥ä½œ"&gt;ç›¸å…³å·¥ä½œ
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬çš„å·¥ä½œä¸å½“å‰å¤„ç†NERçš„ç¥ç»ç½‘ç»œä¸€è‡´ã€‚Hammerton(2003)å°è¯•è§£å†³ä½¿ç”¨ä¸€ä¸ªå•å‘çš„LSTMè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªç¬¬ä¸€ä¸ªå¤„ç†NERçš„ç¥ç»ç½‘ç»œã€‚Collobert et al. (2011)ä½¿ç”¨äº†ä¸€ä¸ªCNN-CRFçš„ç»“æ„ï¼Œè·å¾—äº†å’Œæœ€å¥½çš„ç»Ÿè®¡æ¨¡å‹ç›¸å½“çš„ç»“æœã€‚dos Santos et al. (2015)ä½¿ç”¨äº†å­—ç¬¦CNNæ¥å¢å¼ºCNN-CRFæ¨¡å‹ã€‚å¤§éƒ¨åˆ†æœ€è¿‘çš„å·¥ä½œåˆ©ç”¨äº†LSTM-CRFæ¶æ„ã€‚Huang et al. (2015)ä½¿ç”¨æ‰‹å·¥çš„æ‹¼å†™ç‰¹å¾ï¼›Maå’ŒHovyï¼ˆ2016ï¼‰ä»¥åŠChiu and Nicholsï¼ˆ2016ï¼‰ä½¿ç”¨äº†ä¸€ä¸ªå­—ç¬¦CNNæ¥è¡¨ç¤ºæ‹¼å†™çš„å­—ç¬¦ï¼›Lample et al.ï¼ˆ2016ï¼‰ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦LSTMï¼Œæ²¡æœ‰ä½¿ç”¨CNNã€‚æˆ‘ä»¬çš„baselineåŸºäºè¯çš„ç³»ç»Ÿä½¿ç”¨äº†ä¸è¿™äº›ç›¸ä¼¼çš„æ¶æ„ã€‚
å­—ç¬¦åºåˆ—æ ‡æ³¨æ˜¯å¤„ç†ä¸­æ–‡NERçš„ä¸»è¦æ–¹æ³•ï¼ˆChen et al., 2006b; Lu et al., 2016; Dong et al., 2016ï¼‰ã€‚å·²ç»æœ‰è®¨è®ºåŸºäºè¯çš„å’ŒåŸºäºå­—ç¬¦çš„æ–¹æ³•çš„ç»Ÿè®¡çš„æ–¹æ³•å¯¹æ¯”ï¼Œè¡¨æ˜äº†åè€…ä¸€èˆ¬æœ‰æ›´å¥½çš„è¡¨ç°ï¼ˆHe and Wang, 2008; Liu et al., 2010; Li et al., 2014ï¼‰ã€‚æˆ‘ä»¬å‘ç°æœ‰ç€æ°å½“çš„è¡¨ç¤ºè®¾å®šï¼Œç»“è®ºåŒæ ·é€‚ç”¨äºç¥ç»NERã€‚å¦ä¸€æ–¹é¢ï¼Œlattice LSTMç›¸æ¯”äºè¯LSTMå’Œå­—ç¬¦LSTMæ˜¯æ›´å¥½çš„ä¸€ä¸ªé€‰æ‹©ã€‚
å¦‚ä½•æ›´å¥½çš„åˆ©ç”¨è¯çš„ä¿¡æ¯åœ¨ä¸­æ–‡NERä»»åŠ¡ä¸­å—åˆ°äº†æŒç»­çš„å…³æ³¨ï¼ˆGao et al., 2015ï¼‰ï¼Œåˆ†è¯ä¿¡æ¯åœ¨NERä»»åŠ¡ä¸­ä½œä¸ºsoft featuresï¼ˆZhao and Kit, 2008; Peng and Dredze, 2015; He and Sun, 2017aï¼‰ï¼Œä½¿ç”¨å¯¹å¶åˆ†è§£çš„åˆ†è¯ä¸NERè”åˆå­¦ä¹ ä¹Ÿè¢«äººç ”ç©¶äº†ï¼ˆXu et al., 2014ï¼‰ï¼Œå¤šä»»åŠ¡å­¦ä¹ ï¼ˆPeng and Dredze, 2016ï¼‰ç­‰ç­‰ã€‚æˆ‘ä»¬çš„å·¥ä½œä¹Ÿæ˜¯ï¼Œèšç„¦äºç¥ç»è¡¨ç¤ºå­¦ä¹ ã€‚å°½ç®¡ä¸Šè¿°çš„æ–¹æ³•å¯èƒ½ä¼šè¢«åˆ†è¯è®­ç»ƒæ•°æ®å’Œåˆ†è¯çš„é”™è¯¯å½±å“ï¼Œæˆ‘ä»¬çš„æ–¹æ³•ä¸éœ€è¦ä¸€ä¸ªåˆ†è¯å™¨ã€‚è¿™ä¸ªæ¨¡å‹ä¸éœ€è¦è€ƒè™‘å¤šä»»åŠ¡è®¾å®šï¼Œå› æ­¤ä»æ¦‚å¿µä¸Šæ¥çœ‹å°±æ›´ç®€å•ã€‚
NERå¯ä»¥åˆ©ç”¨å¤–éƒ¨ä¿¡æ¯ã€‚ç‰¹åˆ«åœ°ï¼Œè¯å…¸ç‰¹å¾å·²ç»è¢«å¹¿æ³›åœ°ä½¿ç”¨äº†ï¼ˆCollobert et al., 2011; Passos et al., 2014; Huang et al., 2015; Luo et al., 2015ï¼‰ã€‚Rei(2017)ä½¿ç”¨äº†ä¸€ä¸ªè¯çº§åˆ«çš„è¯­è¨€æ¨¡å‹ç›®çš„æ˜¯å¢å¼ºNERçš„è®­ç»ƒï¼Œåœ¨å¤§é‡åŸå§‹è¯­æ–™ä¸Šå®ç°å¤šä»»åŠ¡å­¦ä¹ ã€‚Peters et al.(2017)é¢„è®­ç»ƒäº†ä¸€ä¸ªå­—ç¬¦è¯­è¨€æ¨¡å‹æ¥å¢å¼ºè¯çš„è¡¨ç¤ºã€‚Yang et al.(2017b)é€šè¿‡å¤šä»»åŠ¡å­¦ä¹ æ¢ç´¢äº†è·¨é¢†åŸŸå’Œè·¨è¯­è¨€çš„çŸ¥è¯†ã€‚æˆ‘ä»¬é€šè¿‡åœ¨å¤§é‡è‡ªåŠ¨åˆ†è¯çš„æ–‡æœ¬ä¸Šé¢„è®­ç»ƒæ–‡æœ¬åµŒå…¥è¯å…¸åˆ©ç”¨äº†å¤–éƒ¨ä¿¡æ¯ï¼Œå°½ç®¡åŠç›‘ç£æŠ€æœ¯å¦‚è¯­è¨€æ¨¡å‹are orthogonal toè€Œä¸”ä¹Ÿå¯ä»¥åœ¨æˆ‘ä»¬çš„lattice LSTMæ¨¡å‹ä¸­ä½¿ç”¨ã€‚
Latticeç»“æ„çš„RNNå¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªæ ‘çŠ¶ç»“æ„çš„RNNï¼ˆTai et al., 2015ï¼‰å¯¹DAGçš„è‡ªç„¶æ‰©å±•ã€‚ä»–ä»¬å·²ç»æœ‰è¢«ç”¨æ¥å»ºæ¨¡è¿åŠ¨åŠ›å­¦ï¼ˆSun et al., 2017ï¼‰ï¼Œdependency-discourse DAGs(Peng et al., 2017)ï¼Œè¿˜æœ‰speech tokenization latticeï¼ˆSperber et al., 2017ï¼‰ä»¥åŠå¯¹NMTï¼ˆneural machine translationï¼‰ç¼–ç å™¨çš„å¤šç²’åº¦åˆ†è¯è¾“å‡ºã€‚å¯¹æ¯”ç°åœ¨çš„å·¥ä½œï¼Œæˆ‘ä»¬çš„lattice LSTMåœ¨åŠ¨æœºå’Œç»“æ„ä¸Šéƒ½æ˜¯ä¸åŒçš„ã€‚æ¯”å¦‚ï¼Œå¯¹äºä»¥å­—ç¬¦ä¸ºä¸­å¿ƒçš„lattice-LSTM-CRFåºåˆ—æ ‡æ³¨è®¾è®¡çš„æ¨¡å‹ï¼Œå®ƒæœ‰å¾ªç¯ç»†èƒä½†æ˜¯æ²¡æœ‰é’ˆå¯¹è¯çš„éšè—å‘é‡ã€‚æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œæˆ‘ä»¬ç¬¬ä¸€ä¸ªè®¾è®¡äº†ä¸€ä¸ªæ–°å‹çš„lattice LSTMå¯¹å­—æ¯å’Œè¯è¿›è¡Œæ··åˆçš„è¡¨ç¤ºï¼Œä¹Ÿæ˜¯ç¬¬ä¸€ä¸ªä½¿ç”¨ä¸€ä¸ªåŸºäºè¯çš„latticeå¤„ç†ä¸åˆ†è¯çš„ä¸­æ–‡NERä»»åŠ¡çš„ã€‚&lt;/p&gt;
&lt;h2 id="æ¨¡å‹"&gt;æ¨¡å‹
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬è·Ÿä»æœ€å¥½çš„è‹±è¯­NERæ¨¡å‹ï¼ˆHuang et al., 2015; Ma and Hovy, 2016; Lample et al., 2016ï¼‰ï¼Œä½¿ç”¨LSTM-CRFä½œä¸ºä¸»è¦çš„ç½‘ç»œç»“æ„ã€‚ä½¿ç”¨$s=c_1, c_2, &amp;hellip;, c_m$è¡¨ç¤ºè¾“å…¥çš„å¥å­ï¼Œå…¶ä¸­$c_j$è¡¨ç¤ºç¬¬$j$ä¸ªå­—ç¬¦ã€‚$s$å¯ä»¥è¢«çœ‹ä½œä¸€ä¸ªå•è¯åºåˆ—$s=w_1, w_2, &amp;hellip;, w_n$ï¼Œå…¶ä¸­$w_i$è¡¨ç¤ºåºåˆ—ä¸­çš„ç¬¬$i$ä¸ªå•è¯ï¼Œç”±ä¸€ä¸ªä¸­æ–‡åˆ†è¯å™¨è·å¾—ã€‚æˆ‘ä»¬ä½¿ç”¨$t(i, k)$è¡¨ç¤ºå¥å­ä¸­ç¬¬$i$ä¸ªå•è¯çš„ç¬¬$k$ä¸ªå­—ç¬¦è¡¨ç¤ºä¸‹æ ‡$j$ã€‚å–å›¾1çš„å¥å­ä½œä¸ºä¾‹å­ã€‚å¦‚æœåˆ†è¯ç»“æœæ˜¯â€œå—äº¬å¸‚ é•¿æ±Ÿå¤§æ¡¥â€ï¼Œä¸‹æ ‡ä»1å¼€å§‹ï¼Œé‚£ä¹ˆ$t(2, 1)=4$ï¼ˆé•¿ï¼‰ï¼Œ$t(1, 3)=3$ï¼ˆå¸‚ï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨BIOESæ ‡è®°ï¼ˆRatinov and Roth, 2009ï¼‰å¯¹åŸºäºè¯å’ŒåŸºäºå­—çš„NERè¿›è¡Œæ ‡è®°ã€‚
&lt;img src="https://davidham3.github.io/blog/images/lattice-lstm-%e4%b8%ad%e6%96%87ner/Fig3.PNG"
loading="lazy"
alt="Fig3"
&gt;&lt;/p&gt;
&lt;h3 id="åŸºäºå­—ç¬¦çš„æ¨¡å‹"&gt;åŸºäºå­—ç¬¦çš„æ¨¡å‹
&lt;/h3&gt;&lt;p&gt;åŸºäºå­—ç¬¦çš„æ¨¡å‹å¦‚å›¾3(a)æ‰€ç¤ºã€‚å®ƒåœ¨$c_1, c_2, &amp;hellip;, c_m$ä¸Šä½¿ç”¨äº†LSTM-CRFæ¨¡å‹ã€‚æ¯ä¸ªå­—ç¬¦$c_j$è¡¨ç¤ºä¸º
&lt;/p&gt;
$$x^c\_j = e^c(c\_j)$$&lt;p&gt;
å…¶ä¸­$e^c$è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦åµŒå…¥åˆ°äº†lookup tableä¸­ã€‚
ä¸€ä¸ªåŒå‘LSTMï¼ˆä¸å¼11åŒç»“æ„ï¼‰è¢«ä½¿ç”¨åœ¨$x_1, x_2, &amp;hellip;, x_m$æ¥è·å–ä»å·¦åˆ°å³çš„$\overrightarrow{h}^c_1, \overrightarrow{h}^c_2, &amp;hellip;, \overrightarrow{h}^c_m$å’Œä»å³åˆ°å·¦çš„$\overleftarrow{h}^c_1, \overleftarrow{h}^c_2, &amp;hellip;, \overleftarrow{h}^c_m$éšè—çŠ¶æ€ï¼Œè¿™ä¸¤ä¸ªéšè—çŠ¶æ€æœ‰ä¸¤ç»„ä¸åŒçš„å‚æ•°ã€‚æ¯ä¸ªå­—ç¬¦çš„éšè—å‘é‡è¡¨ç¤ºä¸º
&lt;/p&gt;
$$h^c\_j = [\overrightarrow{h}^c\_j, \overleftarrow{h}^c\_j]$$&lt;p&gt;
ä¸€ä¸ªæ ‡å‡†çš„CRFæ¨¡å‹è¢«ç”¨åœ¨$h^c_1, h^c_2, &amp;hellip;, h^c_m$ä¸Šæ¥è¿›è¡Œåºåˆ—æ ‡æ³¨ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å­—ç¬¦+åŒå­—ç¬¦
Character bigramsåœ¨åˆ†è¯ä¸­ç”¨æ¥è¡¨ç¤ºå­—ç¬¦å·²ç»å¾ˆæœ‰ç”¨äº†ï¼ˆChen et al., 2015; Yang et al., 2017aï¼‰ã€‚æˆ‘ä»¬æå‡ºäº†é€šè¿‡æ‹¼æ¥åŒå…ƒå­—ç¬¦åµŒå…¥å’Œå­—ç¬¦åµŒå…¥çš„åŸºäºå­—ç¬¦çš„æ¨¡å‹ï¼š
$$x^c\_j = [e^c(c\_j); e^b(c\_j, c\_{j+1})]$$
å…¶ä¸­$e^b$è¡¨ç¤ºä¸€ä¸ªcharacter bigram lookup tableã€‚&lt;/li&gt;
&lt;li&gt;å­—ç¬¦+softword
å·²ç»æœ‰å®éªŒè¡¨æ˜ä½¿ç”¨åˆ†è¯ä½œä¸ºsoft featureså¯¹äºåŸºäºå­—ç¬¦çš„NERæ¨¡å‹å¯ä»¥æå‡æ€§èƒ½ï¼ˆZhao and Kit, 2008; Peng and Dredze, 2016ï¼‰ã€‚æˆ‘ä»¬æå‡ºçš„é€šè¿‡æ‹¼æ¥åˆ†è¯æ ‡è®°åµŒå…¥å’Œå­—ç¬¦åµŒå…¥çš„å¸¦æœ‰åˆ†è¯ä¿¡æ¯çš„å­—ç¬¦è¡¨ç¤ºï¼š
$$x^c\_j = [e^c(c\_j); e^s(seg(c\_j))]$$
å…¶ä¸­$e^s$è¡¨ç¤ºä¸€ä¸ªåˆ†è¯æ ‡ç­¾åµŒå…¥æŸ¥è¯¢è¡¨ã€‚$seg(c_j)$è¡¨ç¤ºä¸€ä¸ªåˆ†è¯å™¨åœ¨å­—ç¬¦$c_j$ä¸Šç»™å‡ºçš„åˆ†è¯æ ‡ç­¾ã€‚æˆ‘ä»¬ä½¿ç”¨äº†BMESç­–ç•¥æ¥è¡¨ç¤ºåˆ†è¯ï¼ˆXue, 2003ï¼‰
$$h^w\_i = [\overrightarrow{h^w\_i}, \overleftarrow{h^w\_i}]$$
ä¸åŸºäºå­—ç¬¦çš„æƒ…å†µç±»ä¼¼ï¼Œä¸€ä¸ªæ ‡å‡†çš„CRFæ¨¡å‹åœ¨åºåˆ—æ ‡è®°ä¸­è¢«ç”¨åœ¨äº†$h^w_1, h^w_2, &amp;hellip;, h^w_m$ä¸Šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="åŸºäºè¯çš„æ¨¡å‹"&gt;åŸºäºè¯çš„æ¨¡å‹
&lt;/h3&gt;&lt;p&gt;åŸºäºè¯çš„æ¨¡å‹å¦‚å›¾3ï¼ˆbï¼‰æ‰€ç¤ºï¼Œå®ƒå°†word embedding $e^w(w_i)$ä½œä¸ºæ¯ä¸ªè¯$w_i$çš„è¡¨ç¤ºï¼š
&lt;/p&gt;
$$x^w\_i = e^w(w\_i)$$&lt;p&gt;
å…¶ä¸­$e^w$è¡¨ç¤ºä¸€ä¸ªè¯åµŒå…¥æŸ¥æ‰¾è¡¨ã€‚ä¸€ä¸ªåŒå‘LSTMè¢«ç”¨æ¥è·å–è¯åºåˆ—$w_1, w_2, &amp;hellip;, w_n$ä¸Šä¸€ä¸ªä»å·¦åˆ°å³çš„éšè—çŠ¶æ€$\overrightarrow{h}^w_1, \overrightarrow{h}^w_2, &amp;hellip;, \overrightarrow{h}^w_n$å’Œä¸€ä¸ªä»å³åˆ°å·¦çš„éšè—çŠ¶æ€åºåˆ—$\overleftarrow{h}^w_1, \overleftarrow{h}^w_2, &amp;hellip;, \overleftarrow{h}^w_n$ã€‚æœ€åï¼Œå¯¹äºæ¯ä¸ªè¯$w_i$ï¼Œ$\overrightarrow{h^w_i}$å’Œ$\overleftarrow{h^w_i}$ä¼šè¢«æ‹¼åœ¨ä¸€èµ·æˆä¸ºå®ƒçš„è¡¨ç¤ºï¼š
&lt;strong&gt;é›†æˆå­—ç¬¦è¡¨ç¤º&lt;/strong&gt;
å­—ç¬¦CNNï¼ˆMa and Hovy, 2016ï¼‰å’ŒLSTMï¼ˆLample et al., 2016ï¼‰ä¸¤ç§æ–¹æ³•éƒ½è¢«ç”¨äºè¿‡è¡¨ç¤ºä¸€ä¸ªå•è¯ä¸­çš„å­—ç¬¦åºåˆ—ã€‚æˆ‘ä»¬åœ¨ä¸­æ–‡NERä¸­å¯¹ä¸¤ä¸ªæ–¹æ³•éƒ½è¿›è¡Œäº†å®éªŒã€‚æˆ‘ä»¬ä½¿ç”¨$x^c_i$è¡¨ç¤º$w_i$ä¸­çš„å­—ç¬¦ï¼Œé€šè¿‡æ‹¼æ¥$e^w(w_i)$å’Œ$x^c_i$å¯ä»¥è·å¾—ä¸€ä¸ªæ–°è¯çš„è¡¨ç¤ºï¼š
&lt;/p&gt;
$$x^w\_i = [e^w(w\_i; x^c\_i)]$$&lt;ol&gt;
&lt;li&gt;è¯+å­—ç¬¦LSTM
å°†æ¯ä¸ªè¾“å…¥å­—ç¬¦çš„åµŒå…¥è®°ä½œ$e^c(c_j)$ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªåŒå‘LSTMæ¥å­¦ä¹ è¯$w_i$çš„å­—ç¬¦$c_{t(i, 1)}, &amp;hellip;, c_{t(i, len(i))}$çš„éšè—çŠ¶æ€$\overrightarrow{h}^c_{t(i, 1)}, &amp;hellip;, \overrightarrow{h}^c_{t(i, len(i))}$å’Œ$\overleftarrow{h}^c_{t(i, 1)}, &amp;hellip;, \overleftarrow{h}^c_{t(i, len(i))}$ï¼Œå…¶ä¸­$len(i)$è¡¨ç¤ºè¯$w_i$çš„å­—ç¬¦ä¸ªæ•°ã€‚æœ€å$w_i$çš„å­—ç¬¦è¡¨ç¤ºä¸ºï¼š
$$x^c\_i = [\overrightarrow{h}^c\_{t(i, len(i))};\overleftarrow{h}^c\_{t(i, 1)}]$$&lt;/li&gt;
&lt;li&gt;è¯+å­—ç¬¦LSTM'
æˆ‘ä»¬è°ƒæŸ¥äº†ä¸€ç§è¯+å­—ç¬¦LSTMçš„å˜å½¢ï¼Œè¿™ä¸ªæ¨¡å‹ä½¿ç”¨å•å‘çš„LSTMå¯¹æ¯ä¸ªå­—ç¬¦è·å–$\overrightarrow{h}^c_j$å’Œ$\overleftarrow{h}^c_j$ã€‚ä¸Liu et al. (2018)çš„ç»“æ„ç›¸ä¼¼ä½†æ˜¯æ²¡æœ‰ä½¿ç”¨highway layerã€‚ä½¿ç”¨äº†ç›¸åŒçš„LSTMç»“æ„å’Œç›¸åŒçš„æ–¹æ³•é›†æˆå­—ç¬¦éšè—çŠ¶æ€è¿›è¯åµŒå…¥ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;è¯+å­—ç¬¦CNN
æˆ‘ä»¬ä½¿ç”¨æ ‡å‡†çš„CNNï¼ˆLeCun et al., 1989ï¼‰åº”ç”¨åœ¨è¯çš„å­—ç¬¦åºåˆ—ä¸Šè·å¾—å­—ç¬¦è¡¨ç¤º$x^c_i$ã€‚å°†å­—ç¬¦$c_j$çš„åµŒå…¥è®°ä¸º$e^c(c_j)$ï¼Œå‘é‡$x^c_i$é€šè¿‡ä»¥ä¸‹å¼å­å¾—åˆ°ï¼š
$$x^c\_i = \max\_{t(i,1) \leq j \leq t(i, len(i))}(W^T\_{CNN} \begin{bmatrix}
e^c(c\_{j-\frac{ke-1}{2}}) \\
... \\
e^c(c\_{j+\frac{ke-1}{2}})
\end{bmatrix}+ b\_{CNN})$$
å…¶ä¸­ï¼Œ$W_{CNN}$å’Œ$b_{CNN}$å’Œå‚æ•°ï¼Œ$ke=3$æ˜¯æ ¸çš„å¤§å°ï¼Œ$max$è¡¨ç¤ºæœ€å¤§æ± åŒ–ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="latticeæ¨¡å‹"&gt;Latticeæ¨¡å‹
&lt;/h3&gt;&lt;p&gt;å›¾2ä¸­å±•ç¤ºäº†è¯-å­—latticeæ¨¡å‹çš„æ•´ä¸ªç»“æ„ï¼Œå¯ä»¥çœ‹ä½œæ˜¯åŸºäºå­—çš„æ¨¡å‹çš„æ‰©å±•ï¼Œé›†æˆäº†åŸºäºè¯çš„ç»†èƒå’Œç”¨æ¥æ§åˆ¶ä¿¡æ¯æµçš„é¢å¤–çš„é—¨ã€‚
å›¾3ï¼ˆcï¼‰å±•ç¤ºäº†æ¨¡å‹çš„è¾“å…¥æ˜¯ä¸€ä¸ªå­—ç¬¦åºåˆ—$c_1, c_2, &amp;hellip;, c_m$ï¼Œä¸ä¹‹ä¸€èµ·çš„è¿˜æœ‰æ‰€æœ‰å­—ç¬¦åºåˆ—ï¼Œå­—ç¬¦éƒ½èƒ½åœ¨è¯å…¸$\mathbb{D}$ä¸­åŒ¹é…åˆ°ã€‚å¦‚éƒ¨åˆ†2ä¸­æŒ‡ç¤ºçš„ï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªåŠ¨åˆ†è¯çš„å¤§å‹åŸå§‹è¯­æ–™æ¥æ„å»º$\mathbb{D}$ã€‚ä½¿ç”¨$w^d_{b,e}$æ¥è¡¨ç¤ºä¸€ä¸ªèµ·å§‹å­—ç¬¦ä¸‹æ ‡ä¸º$b$ï¼Œç»“å°¾å­—ç¬¦ä¸‹æ ‡ä¸º$e$ï¼Œå›¾1ä¸­çš„$w^d_{1,2}$æ˜¯â€œå—äº¬ï¼ˆNanjingï¼‰â€ï¼Œ$w^d_{7,8}$æ˜¯â€œå¤§æ¡¥ï¼ˆBridgeï¼‰â€ã€‚
æ¨¡å‹æ¶‰åŠåˆ°äº†å››ç§ç±»å‹çš„å‘é‡ï¼Œåˆ†åˆ«æ˜¯è¾“å…¥å‘é‡ã€è¾“å‡ºéšè—å‘é‡ã€ç»†èƒå‘é‡ã€é—¨å‘é‡ã€‚ä½œä¸ºåŸºæœ¬çš„ç»„æˆéƒ¨åˆ†ï¼Œä¸€ä¸ªå­—ç¬¦è¾“å…¥å‘é‡è¢«ç”¨æ¥è¡¨ç¤ºæ¯ä¸ªå­—ç¬¦$c_j$ï¼Œå°±åƒåœ¨åŸºäºå­—ç¬¦çš„æ¨¡å‹ä¸­ï¼š
$x^c_j = e^c(c_j)$
åŸºæœ¬çš„å¾ªç¯ç»“æ„æ˜¯é€šè¿‡ä¸€ä¸ªåœ¨æ¯ä¸ªå­—ç¬¦$c_j$ä¸Šçš„å­—ç¬¦ç»†èƒå‘é‡$\mathbf{c}^c_j$å’Œä¸€ä¸ªéšè—å‘é‡$\mathbf{h}^c_j$æ„é€ çš„ï¼Œå…¶ä¸­$\mathbf{c}^c_j$æä¾›å¥å­çš„å¼€å§‹åˆ°$c_j$çš„ä¿¡æ¯æµï¼Œ$\mathbf{h}^c_j$ç”¨äºCRFåºåˆ—æ ‡æ³¨ã€‚
åŸºç¡€çš„å¾ªç¯LSTMå‡½æ•°å¦‚ä¸‹ï¼š
&lt;/p&gt;
$$
\begin{bmatrix}
i^c\_j \\
o^c\_j \\
f^c\_j \\
\widetilde{c}^c\_j
\end{bmatrix} =
\begin{bmatrix}
\sigma \\
\sigma \\
\sigma \\
tanh
\end{bmatrix}({W^c}^T
\begin{bmatrix}
x^c\_j \\
h^c\_{j-1}
\end{bmatrix}+b^c)
$$&lt;p&gt;
&lt;/p&gt;
$$c^c\_j = f^c\_j \odot c^c\_{j-1} + i^c\_j \odot \hat{c}^c\_j$$&lt;p&gt;
&lt;/p&gt;
$$h^c\_j = o^c\_j \odot tanh(c^c\_j)$$&lt;p&gt;
å…¶ä¸­ï¼Œ$i^c_j$ï¼Œ$f^c_j$å’Œ$o^c_j$è¡¨ç¤ºä¸€ç»„è¾“å…¥ã€é—å¿˜å’Œè¾“å‡ºé—¨ã€‚${w^c}^T$å’Œ$b^c$æ˜¯æ¨¡å‹å‚æ•°ã€‚$\sigma()$è¡¨ç¤ºsigmoid functionã€‚
ä¸åŒäºåŸºäºå­—ç¬¦çš„æ¨¡å‹ï¼Œç°åœ¨è®¡ç®—$c^c_j$çš„æ—¶å€™éœ€è¦è€ƒè™‘å¥å­ä¸­è¯å…¸åºåˆ—$w^d_{b,e}$ã€‚ç‰¹åˆ«åœ°ï¼Œæ¯ä¸ªåºåˆ—$w^d_{b,e}$è¢«è¡¨ç¤ºä¸ºï¼š
&lt;/p&gt;
$$x^w\_{b,e} = e^w(w^d\_{b,e})$$&lt;p&gt;
å…¶ä¸­$e^w$è¡¨ç¤º3.2èŠ‚ç›¸åŒçš„è¯åµŒå…¥æŸ¥è¯¢è¡¨ã€‚
æ­¤å¤–ï¼Œä¸€ä¸ªè¯ç»†èƒ$c^w_{b,e}$ç”¨æ¥è¡¨ç¤º$x^w_{b,e}$ä»å¥å­å¼€å§‹çš„å¾ªç¯çŠ¶æ€ã€‚$c^w_{b,e}$é€šè¿‡ä»¥ä¸‹å¼å­è®¡ç®—å¾—åˆ°ï¼š
&lt;/p&gt;
$$
\begin{bmatrix}
i^w\_{b,e} \\
f^w\_{b,e} \\
\widetilde{c}^w\_{b,e}
\end{bmatrix} = \begin{bmatrix}
\sigma \\
\sigma \\
tanh
\end{bmatrix}({w^w}^T \begin{bmatrix}
x^w\_{b,e} \\
h^c\_b
\end{bmatrix} + b^w)
$$&lt;p&gt;
&lt;/p&gt;
$$c^w\_{b,e} = f^w\_{b,e} \odot c^c\_b + i^w\_{b,e} \odot \widetilde{c}^w\_{b,e}$$&lt;p&gt;
å…¶ä¸­$i^w_{b,e}$å’Œ$f^w_{b,e}$æ˜¯ä¸€ç»„è¾“å…¥å’Œé—å¿˜é—¨ã€‚å¯¹äºè¯ç»†vèƒæ¥è¯´æ²¡æœ‰è¾“å‡ºé—¨å› ä¸ºæ ‡è®°åªåœ¨å­—ç¬¦å±‚é¢ä¸Šåšã€‚
æœ‰äº†$c^w_{b,e}$ï¼Œä¼šæœ‰å¾ˆå¤šè·¯å¾„å¯ä»¥ä½¿ä¿¡æ¯æµå‘æ¯ä¸ª$c^c_j$ã€‚æ¯”å¦‚ï¼Œåœ¨å›¾2ä¸­ï¼Œå¯¹äº$c^c_7$çš„è¾“å…¥åŒ…å«$x^c_7$ï¼ˆæ¡¥Bridgeï¼‰ï¼Œ$c^w_{6,7}$ï¼ˆå¤§æ¡¥Bridgeï¼‰å’Œ$c^w_{4,7}$ï¼ˆé•¿æ±Ÿå¤§æ¡¥Yangtze River Bridgeï¼‰ã€‚æˆ‘ä»¬å°†$c^w_{b,e}$å’Œ$b \in \lbrace b&amp;rsquo; \mid w^d_{b&amp;rsquo;,e} \in \mathbb{D}\rbrace$è¿æ¥åˆ°ç»†èƒ$c^c_e$ã€‚æˆ‘ä»¬ä½¿ç”¨é¢å¤–çš„é—¨$i^c_{b,e}$å¯¹æ¯ä¸ªåºåˆ—ç»†èƒ$c^w_{b,e}$æ¥æ§åˆ¶å®ƒå¯¹$c^c_{b,e}$çš„è´¡çŒ®ï¼š
&lt;/p&gt;
$$i^c\_{b,e} = \sigma({w^l}^T \begin{bmatrix}
x^c\_e \\
c^w\_{b,e}
\end{bmatrix} + b^l)$$&lt;p&gt;
å› æ­¤ï¼Œ$c^c_j$çš„è®¡ç®—å˜ä¸ºï¼š
&lt;/p&gt;
$$c^c\_j = \sum\_{b \in \lbrace b' \mid w^d\_{b',j} \in \mathbb{D}\rbrace } \alpha^c\_{b,j} \odot c^w\_{b,j} + \alpha^c\_j \odot \widetilde{c}^c\_j$$&lt;p&gt;
åœ¨ä¸Šå¼ä¸­ï¼Œé—¨$i^c_{b,j}$å’Œ$i^c_{j}$çš„å€¼è¢«å½’ä¸€åŒ–åˆ°$\alpha^c_{b,j}$å’Œ$\alpha^c_j$ï¼Œå’Œä¸º1ã€‚
&lt;/p&gt;
$$
\alpha^c\_{b,j} = \frac{exp(i^c\_{b,j})}{exp(i^c\_j)+\sum\_{b' \in \lbrace b'' \mid w^d\_{b'',j} \in \mathbb{D}\rbrace}exp(i^c\_{b',j})}
$$&lt;p&gt;
&lt;/p&gt;
$$
\alpha^c\_{j} = \frac{exp(i^c\_{j})}{exp(i^c\_j)+\sum\_{b' \in \lbrace b'' \mid w^d\_{b'',j} \in \mathbb{D}\rbrace}exp(i^c\_{b',j})}
$$&lt;p&gt;
æœ€åçš„éšè—å‘é‡$h^c_j$ä»ç„¶ç”±ä¹‹å‰çš„LSTMè®¡ç®—å…¬å¼å¾—åˆ°ã€‚åœ¨NERè®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒæŸå¤±å€¼åå‘ä¼ æ’­åˆ°å‚æ•°$w^c, b^c, w^w, b^w, w^l$å’Œ$b^l$ä½¿å¾—æ¨¡å‹å¯ä»¥åŠ¨æ€åœ°åœ¨NERæ ‡æ³¨è¿‡ç¨‹ä¸­å…³æ³¨æ›´ç›¸å…³çš„è¯ã€‚&lt;/p&gt;
&lt;h3 id="è§£ç å’Œè®­ç»ƒ"&gt;è§£ç å’Œè®­ç»ƒ
&lt;/h3&gt;&lt;p&gt;ä¸€ä¸ªæ ‡å‡†çš„CRFå±‚è¢«ç”¨åœ¨$h_1, h_2, &amp;hellip;, h_{\tau}$ä¸Šé¢ï¼Œå…¶ä¸­$\tau$å¯¹äºåŸºäºå­—ç¬¦çš„æ¨¡å‹æ¥è¯´æ˜¯$n$ï¼Œå¯¹äºåŸºäºè¯çš„æ¨¡å‹æ¥è¯´æ˜¯$m$ã€‚ä¸€ä¸ªæ ‡ç­¾åºåˆ—$y = l_1, l_2, &amp;hellip;, l_{\tau}$çš„æ¦‚ç‡æ˜¯
&lt;/p&gt;
$$
p(y \mid s) = \frac{exp(\sum\_i(w^{l\_i}\_{CRF} h\_i + b^{(l\_{i-1}, l\_i)}\_{CRF}))}{\sum\_{y'}exp(\sum\_i(w^{l'\_i}\_{CRF} h\_i + b^{(l'\_{i-1}, l'\_i)}\_{CRF}))}
$$&lt;p&gt;
è¿™é‡Œ$y&amp;rsquo;$è¡¨ç¤ºä¸€ä¸ªä»»æ„æ ‡ç­¾åºåˆ—ï¼Œ$W^{l_i}_{CRF}$æ˜¯é’ˆå¯¹äº$l_i$çš„æ¨¡å‹å‚æ•°ï¼Œ$b^{(l_{i-1},l_i)}_{CRF}$æ˜¯é’ˆå¯¹$l_{i-1}$å’Œ$l_i$çš„åç½®ã€‚
æˆ‘ä»¬ä½¿ç”¨ä¸€é˜¶ç»´ç‰¹æ¯”ç®—æ³•æ¥å¯»æ‰¾ä¸€ä¸ªåŸºäºè¯æˆ–åŸºäºå­—ç¬¦çš„è¾“å…¥åºåˆ—ä¸­å¾—åˆ†æœ€é«˜çš„æ ‡ç­¾åºåˆ—ã€‚ç»™å®šä¸€ç»„æ‰‹åŠ¨æ ‡æ³¨çš„è®­ç»ƒæ•°æ®$\lbrace (s_i, y_i)\rbrace \mid^N_{i=1}$ï¼Œå¸¦æœ‰L2æ­£åˆ™é¡¹çš„å¥å­å±‚é¢çš„log-likelihoodä½œä¸ºlossï¼Œè®­ç»ƒæ¨¡å‹ï¼š
&lt;/p&gt;
$$L = \sum^N\_{i=1} log(P(y\_i \mid s\_i)) + \frac{\lambda}{2}\Vert \Theta \Vert^2$$&lt;p&gt;
å…¶ä¸­ï¼Œ$\lambda$æ˜¯L2æ­£åˆ™é¡¹ç³»æ•°ï¼Œ$\Theta$è¡¨ç¤ºäº†å‚æ•°é›†åˆã€‚&lt;/p&gt;</description></item><item><title>é—¨æ§å·ç§¯ç½‘ç»œè¯­è¨€å»ºæ¨¡</title><link>https://davidham3.github.io/blog/p/%E9%97%A8%E6%8E%A7%E5%8D%B7%E7%A7%AF%E7%BD%91%E7%BB%9C%E8%AF%AD%E8%A8%80%E5%BB%BA%E6%A8%A1/</link><pubDate>Wed, 23 May 2018 10:54:44 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E9%97%A8%E6%8E%A7%E5%8D%B7%E7%A7%AF%E7%BD%91%E7%BB%9C%E8%AF%AD%E8%A8%80%E5%BB%BA%E6%A8%A1/</guid><description>&lt;p&gt;ICML 2017ï¼Œå¤§ä½“æ€è·¯ï¼šå·ç§¯+ä¸€ä¸ªçº¿æ€§é—¨æ§å•å…ƒï¼Œæ›¿ä»£äº†ä¼ ç»Ÿçš„RNNè¿›è¡Œlanguage modelingï¼Œåæ¥çš„Facebookå°†è¿™ä¸ªç”¨äºæœºå™¨ç¿»è¯‘ï¼Œæå‡ºäº†å·ç§¯ç‰ˆçš„seq2seqæ¨¡å‹ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1612.08083" target="_blank" rel="noopener"
&gt;Language Modeling with Gated Convolutional Networks&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="æ‘˜è¦"&gt;æ‘˜è¦
&lt;/h2&gt;&lt;p&gt;å½“å‰æµè¡Œçš„è¯­è¨€å»ºæ¨¡æ¨¡å‹æ˜¯åŸºäºRNNçš„ã€‚åœ¨è¿™ç±»ä»»åŠ¡ä¸Šçš„æˆåŠŸç»å¸¸å’Œä»–ä»¬æ•æ‰unbound contextæœ‰å…³ã€‚è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªé€šè¿‡å †å convolutionsçš„finite contextæ–¹æ³•ï¼Œå·ç§¯å¯ä»¥å˜å¾—æ›´æœ‰æ•ˆå› ä¸ºä»–ä»¬å¯ä»¥åœ¨åºåˆ—ä¸Šå¹¶è¡Œã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–°å‹çš„ç®€å•çš„é—¨æ§æœºåˆ¶ï¼Œè¿™ä¸ªé—¨æ§æœºåˆ¶è¡¨ç°çš„è¦æ¯”Oord et al.(2016b)è¦å¥½ï¼Œæˆ‘ä»¬ä¹Ÿæ¢ç©¶äº†å…³é”®æ¶æ„å†³ç­–çš„å½±å“ã€‚æˆ‘ä»¬æå‡ºçš„æ–¹æ³•åœ¨WikiText-103ä¸Šè¾¾åˆ°äº†æœ€å¥½çš„æ•ˆæœï¼Œeven though it features long-term dependenciesï¼Œåœ¨Google Billion Wordsä¸Šä¹Ÿè¾¾åˆ°äº†æœ€å¥½çš„æ•ˆæœã€‚Our model reduces the latency to score a sentece by an order of magnitude compared to a recurrent baseline. æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œè¿™æ˜¯åœ¨å¤§è§„æ¨¡è¯­è¨€ä»»åŠ¡ä¸Šç¬¬ä¸€æ¬¡ä¸€ä¸ªéå¾ªç¯ç»“æ„çš„æ–¹æ³•è¶…è¶Šäº†å¼ºæœ‰åŠ›çš„å¾ªç¯æ¨¡å‹ã€‚&lt;/p&gt;
&lt;h2 id="å¼•è¨€"&gt;å¼•è¨€
&lt;/h2&gt;&lt;p&gt;ç»Ÿè®¡è¯­è¨€æ¨¡å‹ä¼°è®¡ä¸€ä¸ªå•è¯åºåˆ—çš„æ¦‚ç‡åˆ†å¸ƒï¼Œé€šè¿‡ç»™å®šå½“å‰çš„å•è¯åºåˆ—ï¼Œå¯¹ä¸‹ä¸€ä¸ªå•è¯çš„æ¦‚ç‡è¿›è¡Œå»ºæ¨¡
&lt;/p&gt;
$$P(w\_0, ..., w\_N) = P(w\_0)\prod^N\_{i=1}P(w\_i \mid w\_0, ..., w\_{i-1})$$&lt;p&gt;
å…¶ä¸­$w_i$æ˜¯å•è¯è¡¨ä¸­çš„å•è¯ä¸‹æ ‡ã€‚è¯­è¨€æ¨¡å‹å¯¹è¯­éŸ³è¯†åˆ«(Yu &amp;amp; Deng, 2014)å’Œæœºå™¨ç¿»è¯‘(Koehn, 2010)æ¥è¯´æ˜¯å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†ã€‚
æœ€è¿‘ï¼Œç¥ç»ç½‘ç»œ(Bengio et al., 2014; Mikolov et al., 2010; Jozefowicz et al., 2016)å·²ç»å±•ç¤ºå‡ºäº†æ¯”ä¼ ç»Ÿn-gramæ¨¡å‹(Kneser &amp;amp; Ney, 1995; Chen &amp;amp; Goodman, 1996)æ›´å¥½çš„è¯­è¨€æ¨¡å‹ã€‚è¿™äº›ä¼ ç»Ÿæ¨¡å‹ä¸èƒ½è§£å†³æ•°æ®ç¨€ç–çš„é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜å¯¼è‡´è¿™äº›æ–¹æ³•å¾ˆéš¾å¯¹å¤§é‡çš„ä¸Šä¸‹æ–‡è¿›è¡Œè¡¨ç¤ºï¼Œå› æ­¤ä¹Ÿä¸èƒ½å›é•¿èŒƒå›´çš„ä¾èµ–è¿›è¡Œè¡¨ç¤ºã€‚ç¥ç»è¯­è¨€æ¨¡å‹é€šè¿‡åœ¨è¿ç»­ç©ºé—´ä¸­å¯¹è¯çš„åµŒå…¥è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚å½“å‰æœ€å¥½çš„è¯­è¨€æ¨¡å‹æ˜¯åŸºäºLSTMï¼ˆHochreiter et al., 1997ï¼‰çš„æ¨¡å‹ï¼ŒLSTMç†è®ºä¸Šå¯ä»¥å¯¹ä»»æ„é•¿åº¦çš„ä¾èµ–è¿›è¡Œå»ºæ¨¡ã€‚
åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº†æ–°çš„é—¨æ§å·ç§¯ç½‘ç»œï¼Œå¹¶ä¸”ç”¨å®ƒè¿›è¡Œè¯­è¨€å»ºæ¨¡ã€‚å·ç§¯ç½‘ç»œå¯ä»¥è¢«å †å èµ·æ¥æ¥è¡¨ç¤ºå¤§é‡çš„ä¸Šä¸‹æ–‡å¹¶ä¸”åœ¨è¶Šæ¥è¶Šé•¿çš„æœ‰ç€æŠ½è±¡ç‰¹å¾ï¼ˆLeCun &amp;amp; Bengio, 1995ï¼‰çš„ä¸Šä¸‹æ–‡ä¸­æå–å±‚æ¬¡ç‰¹å¾ã€‚è¿™ä½¿å¾—è¿™äº›æ¨¡å‹å¯ä»¥é€šè¿‡ä¸Šä¸‹æ–‡ä¸º$N$ï¼Œå·ç§¯æ ¸å®½åº¦ä¸º$k$ï¼Œ$O(\frac{N}{k})$çš„æ“ä½œå¯¹é•¿æ—¶é—´çš„ä¾èµ–å…³ç³»è¿›è¡Œå»ºæ¨¡ã€‚ç›¸åï¼Œå¾ªç¯ç½‘ç»œå°†è¾“å…¥çœ‹ä½œæ˜¯ä¸€ä¸ªé“¾å¼ç»“æ„ï¼Œå› æ­¤éœ€è¦ä¸€ä¸ªçº¿æ€§æ—¶é—´$O(N)$çš„æ“ä½œã€‚
å±‚æ¬¡çš„åˆ†æè¾“å…¥ä¸ä¼ ç»Ÿçš„è¯­æ³•åˆ†æç›¸ä¼¼ï¼Œä¼ ç»Ÿçš„è¯­æ³•åˆ†æå»ºç«‹ç²’åº¦å¢åŠ çš„è¯­æ³•æ ‘ç»“æ„ï¼Œæ¯”å¦‚ï¼ŒåŒ…å«åè¯çŸ­è¯­å’ŒåŠ¨è¯çŸ­è¯­çš„å¥å­ï¼ŒçŸ­è¯­ä¸­åˆåŒ…å«äº†æ›´å†…åœ¨çš„ç»“æ„ï¼ˆManning &amp;amp; Schutze, 1999; Steedman, 2002ï¼‰ã€‚å±‚æ¬¡ç»“æ„ä¹Ÿä¼šè®©å­¦ä¹ å˜å¾—æ›´ç®€å•ï¼Œå› ä¸ºå¯¹äºä¸€ä¸ªç»™å®šçš„ä¸Šä¸‹æ–‡å¤§å°ï¼Œç›¸æ¯”é“¾å¼ç»“æ„ï¼Œéçº¿æ€§å•å…ƒçš„æ•°é‡ä¼šå‡å°‘ï¼Œå› æ­¤å‡è½»äº†æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ï¼ˆGlorot &amp;amp; Bengio, 2010ï¼‰ã€‚
ç°ä»£çš„ç¡¬ä»¶å¯¹é«˜åº¦å¹¶è¡Œçš„æ¨¡å‹æ”¯æŒçš„å¾ˆå¥½ã€‚åœ¨å¾ªç¯ç¥ç»ç½‘ç»œä¸­ï¼Œä¸‹ä¸€ä¸ªè¾“å‡ºä¾èµ–äºä¹‹å‰çš„éšè—çŠ¶æ€ï¼Œè€Œä¹‹å‰çš„éšè—çŠ¶æ€åœ¨åºåˆ—ä¸­å…ƒç´ ä¸Šæ˜¯ä¸èƒ½å¹¶è¡Œçš„ã€‚ç„¶è€Œï¼Œå·ç§¯ç¥ç»ç½‘ç»œå¯¹è¿™ä¸ªè®¡ç®—æµç¨‹æ”¯æŒçš„å¾ˆå¥½å› ä¸ºå·ç§¯æ˜¯å¯ä»¥åœ¨è¾“å…¥å…ƒç´ ä¸ŠåŒæ—¶è¿›è¡Œçš„ã€‚
å¯¹äºRNNæ¥è¯´æƒ³è¦è¾¾åˆ°å¾ˆå¥½çš„æ•ˆæœï¼ˆJozefowicz et al., 2016ï¼‰ï¼Œé—¨çš„ä½œç”¨å¾ˆé‡è¦ã€‚æˆ‘ä»¬çš„é—¨æ§çº¿æ€§å•å…ƒä¸ºæ·±å±‚çš„ç»“æ„å¯¹æ¢¯åº¦æä¾›äº†ä¸€æ¡çº¿æ€§çš„é€šé“ï¼ŒåŒæ—¶åˆä¿ç•™äº†éçº¿æ€§çš„ç‰¹æ€§ï¼Œå‡å°‘äº†æ¢¯åº¦æ¶ˆå¤±çš„ç°è±¡ã€‚
æˆ‘ä»¬å±•ç¤ºäº†é—¨æ§å·ç§¯ç½‘ç»œæ¯”å…¶ä»–çš„å·²ç»å‘è¡¨çš„è¯­è¨€æ¨¡å‹éƒ½è¦å¥½ï¼Œæ¯”å¦‚åœ¨Google Billion Word Benchmarkï¼ˆChelba et al., 2013ï¼‰ä¸Šçš„LSTMã€‚æˆ‘ä»¬ä¹Ÿè¯„ä¼°äº†æˆ‘ä»¬çš„æ¨¡å‹åœ¨å¤„ç†é•¿èŒƒå›´ä¾èµ–å…³ç³»WikiText-103ä¸Šçš„èƒ½åŠ›ï¼Œåœ¨è¿™ä¸ªæ•°æ®é›†ä¸Šï¼Œæ¨¡å‹æ˜¯ä»¥æ®µè½ä¸ºæ¡ä»¶è¿›è¡Œè¾“å…¥çš„ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¥å­ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªæ•°æ®é›†ï¼ˆMerity et al., 2016ï¼‰ä¸Šè·å¾—äº†æœ€å¥½çš„æ•ˆæœã€‚æœ€åï¼Œæˆ‘ä»¬å±•ç¤ºäº†é—¨æ§çº¿æ€§å•å…ƒè·å¾—äº†æ›´å¥½çš„ç²¾åº¦ä»¥åŠç›¸æ¯”äºOord et al., 2016çš„LSTMé—¨æ”¶æ•›çš„æ›´å¿«ã€‚&lt;/p&gt;
&lt;h2 id="æ–¹æ³•"&gt;æ–¹æ³•
&lt;/h2&gt;&lt;p&gt;åœ¨è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å¼•å…¥äº†ä¸€ç§æ–°çš„ç¥ç»è¯­è¨€æ¨¡å‹ï¼Œè¿™ç§æ¨¡å‹ä½¿ç”¨é—¨æ§æ—¶é—´å·ç§¯æ›¿ä»£äº†ä½¿ç”¨åœ¨å¾ªç¯ç¥ç»ç½‘ç»œä¸­ä½¿ç”¨çš„å¾ªç¯é“¾æ¥ã€‚ç¥ç»è¯­è¨€æ¨¡å‹ï¼ˆBengio et al., 2003ï¼‰æä¾›äº†ä¸€ç§å¯¹æ¯ä¸ªå•è¯$w_0, &amp;hellip;, w_N$çš„ä¸Šä¸‹æ–‡è¡¨ç¤º$H=[h_0, &amp;hellip;, h_N]$ç”¨æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªè¯çš„æ¦‚ç‡$P(w_i \mid h_i)$ã€‚å¾ªç¯ç¥ç»ç½‘ç»œ$f$é€šè¿‡ä¸€ä¸ªå¾ªç¯å‡½æ•°$h_i = f(h_{i-1}, w_{i-1})$è®¡ç®—$H$ï¼Œè¿™ä¸ªå¾ªç¯å‡½æ•°æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ä¸èƒ½å¹¶è¡Œå¤„ç†çš„åºåˆ—æ“ä½œã€‚
æˆ‘ä»¬æå‡ºçš„æ–¹æ³•ä½¿ç”¨å‡½æ•°$f$å¯¹è¾“å…¥è¿›è¡Œå·ç§¯æ¥è·å¾—$H = f \ast w$å¹¶ä¸”å› æ­¤æ²¡æœ‰æ—¶é—´ä¸Šçš„ä¾èµ–ï¼Œæ‰€ä»¥å®ƒèƒ½æ›´å¥½çš„åœ¨å¥å­ä¸­çš„å•è¯ä¸Šå¹¶è¡Œè®¡ç®—ã€‚è¿™ä¸ªè¿‡ç¨‹å°†ä¼šæŠŠè®¸å¤šå‰é¢å‡ºç°çš„å•è¯ä½œä¸ºä¸€ä¸ªå‡½æ•°è¿›è¡Œè®¡ç®—ã€‚å¯¹æ¯”å·ç§¯ç¥ç»ç½‘ç»œï¼Œä¸Šä¸‹æ–‡çš„å¤§å°æ˜¯æœ‰é™çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å±•ç¤ºå‡ºäº†æœ‰é™çš„ä¸Šä¸‹æ–‡å¤§å°ä¸æ˜¯å¿…é¡»çš„ï¼Œè€Œä¸”æˆ‘ä»¬çš„æ¨¡å‹å¯ä»¥è¡¨ç¤ºè¶³å¤Ÿå¤§çš„ä¸Šä¸‹æ–‡å¹¶è¡¨ç°çš„å¾ˆå¥½ã€‚
&lt;img src="https://davidham3.github.io/blog/images/%e9%97%a8%e6%8e%a7%e5%8d%b7%e7%a7%af%e7%bd%91%e7%bb%9c%e8%af%ad%e8%a8%80%e5%bb%ba%e6%a8%a1/Fig1.PNG"
loading="lazy"
alt="Fig1"
&gt;
å›¾1å±•ç¤ºäº†æ¨¡å‹çš„æ¶æ„ã€‚è¯é€šè¿‡ä¸€ä¸ªåµŒå…¥çš„å‘é‡è¿›è¡Œè¡¨ç¤ºï¼Œè¿™äº›è¡¨ç¤ºå­˜å‚¨åœ¨lookup table$\mathbf{D}^{\vert \mathcal{V} \vert \times e}$ä¸­ï¼Œå…¶ä¸­$\vert \mathcal{V} \vert$æ˜¯è¯åº“ä¸­å•è¯çš„æ•°é‡ï¼Œ$e$æ˜¯åµŒå…¥çš„å¤§å°ã€‚æˆ‘ä»¬æ¨¡å‹çš„è¾“å…¥æ˜¯ä¸€ä¸ªè¯åºåˆ—$w_0, &amp;hellip;, w_N$ï¼Œè¿™ä¸ªåºåˆ—è¢«è¯å‘é‡è¡¨ç¤ºä¸º$E = [D_{w_0}, &amp;hellip;, D_{w_N}]$ã€‚æˆ‘ä»¬å°†éšè—å±‚$h_0, &amp;hellip;, h_L$è®¡ç®—ä¸º
&lt;/p&gt;
$$h\_l(X) = (X \ast W + b) \otimes \sigma(X \ast V + c)$$&lt;p&gt;
å…¶ä¸­ï¼Œ$m$ï¼Œ$n$åˆ†åˆ«æ˜¯è¾“å…¥å’Œè¾“å‡ºçš„feature mapçš„æ•°é‡ï¼Œ$k$æ˜¯patch sizeï¼Œ$X \in \mathbb{R}^{N \times m}$æ˜¯å±‚$h_l$çš„è¾“å…¥ï¼ˆè¦ä¹ˆæ˜¯è¯åµŒå…¥ï¼Œè¦ä¹ˆæ˜¯å‰ä¸€å±‚çš„è¾“å‡ºï¼‰,$W \in \mathbb{R}^{k \times m \times n}$ï¼Œ$b \in \mathbb{R}^n$ï¼Œ$V \in \mathbb{R}^{k \times m \times n}$ï¼Œ$c \in \mathbb{R}^n$æ˜¯å­¦ä¹ åˆ°çš„å‚æ•°ï¼Œ$\sigma$æ˜¯sigmoid functionï¼Œ$\otimes$æ˜¯çŸ©é˜µé—´çš„element-wise productã€‚
å½“å·ç§¯è¾“å…¥æ—¶ï¼Œæˆ‘ä»¬æ³¨æ„$h_i$ä¸åŒ…å«æœªæ¥å•è¯çš„ä¿¡æ¯ã€‚æˆ‘ä»¬é€šè¿‡ç§»åŠ¨å·ç§¯è¾“å…¥æ¥é˜²æ­¢å·ç§¯æ ¸çœ‹åˆ°æœªæ¥çš„ä¸Šä¸‹æ–‡ï¼ˆOord et al., 2016aï¼‰æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬åœ¨åºåˆ—çš„å¼€å§‹åŠ å…¥äº†$k-1$å®½åº¦çš„0ä½œä¸ºpaddingè¡¥å…¨ï¼Œå‡è®¾ç¬¬ä¸€ä¸ªè¾“å…¥çš„å…ƒç´ æ˜¯åºåˆ—çš„å¼€å§‹å…ƒç´ ï¼Œèµ·å§‹çš„æ ‡è®°æˆ‘ä»¬æ˜¯ä¸é¢„æµ‹çš„ï¼Œ$k$æ˜¯å·ç§¯æ ¸çš„å®½åº¦ã€‚
æ¯å±‚çš„è¾“å‡ºæ˜¯ä¸€ä¸ªçº¿æ€§å˜æ¢$X \ast W + b$é€šè¿‡é—¨$\sigma(X \ast W + b)$è°ƒèŠ‚ã€‚ä¸LSTMç›¸ä¼¼çš„æ˜¯ï¼Œè¿™äº›é—¨ä¹˜ä»¥çŸ©é˜µçš„æ¯ä¸ªå…ƒç´ $X \ast W + b$ï¼Œå¹¶ä¸”ä»¥å±‚æ¬¡çš„å½¢å¼æ§åˆ¶ä¿¡æ¯çš„é€šè¿‡ã€‚æˆ‘ä»¬ç§°è¿™ç§é—¨æ§æœºåˆ¶ä¸ºGated Linear Units(GLU)ã€‚é€šè¿‡åœ¨è¾“å…¥$E$ä¸Šå †å å¤šä¸ªè¿™æ ·çš„å±‚ï¼Œå¯ä»¥å¾—åˆ°æ¯ä¸ªè¯$H = h_L \circ &amp;hellip; \circ h_0(E)$çš„ä¸Šä¸‹æ–‡è¡¨ç¤ºã€‚æˆ‘ä»¬å°†å·ç§¯å’Œé—¨æ§çº¿æ€§å•å…ƒæ”¾åœ¨äº†ä¸€ä¸ªpreactivation residual blockï¼Œè¿™ä¸ªå—å°†è¾“å…¥ä¸è¾“å‡ºç›¸åŠ ï¼ˆHe et al., 2015aï¼‰ã€‚è¿™ä¸ªå—æœ‰ä¸ªbottleneckç»“æ„ï¼Œå¯ä»¥ä½¿è®¡ç®—æ›´é«˜æ•ˆå¹¶ä¸”æ¯ä¸ªå—æœ‰5å±‚ã€‚
è·å¾—æ¨¡å‹é¢„æµ‹ç»“æœæœ€ç®€å•çš„æ˜¯ä½¿ç”¨softmaxå±‚ï¼Œä½†æ˜¯è¿™ä¸ªé€‰æ‹©å¯¹äºè¯­æ–™åº“å¾ˆå¤§å’Œè¿‘ä¼¼æ¥è¯´ä¸€èˆ¬è®¡ç®—èµ·æ¥å¾ˆæ…¢ï¼Œåƒnoise contrastive estimation(Gutmann &amp;amp; Hyvarinen)æˆ–å±‚æ¬¡softmax(Morin &amp;amp; Bengio, 2005)ä¸€èˆ¬æ›´å¸¸ç”¨ã€‚æˆ‘ä»¬é€‰äº†åè€…çš„æ”¹è‰¯ç‰ˆadaptive softmaxï¼Œè¿™ä¸ªç®—æ³•å°†higher capacityåˆ†é…ç»™å‡ºç°é¢‘ç‡æ›´é«˜çš„å•è¯ï¼Œlower capacityåˆ†é…ç»™é¢‘ç‡ä½çš„å•è¯ï¼ˆGrave et al., 2016aï¼‰ã€‚è¿™ä½¿å¾—åœ¨è®­ç»ƒå’Œæµ‹è¯•çš„æ—¶å€™å†…å­˜å ç”¨æ›´å°‘ä¸”è®¡ç®—é€Ÿåº¦æ›´å¿«ã€‚&lt;/p&gt;
&lt;h2 id="é—¨æ§æœºåˆ¶"&gt;é—¨æ§æœºåˆ¶
&lt;/h2&gt;&lt;p&gt;é—¨æ§æœºåˆ¶æ§åˆ¶äº†ç½‘ç»œä¸­ä¿¡æ¯æµé€šçš„è·¯å¾„ï¼Œåœ¨å¾ªç¯ç¥ç»ç½‘ç»œä¸­å·²ç»è¯æ˜äº†æ˜¯éå¸¸æœ‰æ•ˆçš„æ‰‹æ®µï¼ˆHochreiter &amp;amp; Schumidhuber, 1997ï¼‰ã€‚LSTMé€šè¿‡è¾“å…¥å’Œé—å¿˜é—¨æ§åˆ¶åˆ†ç¦»çš„ç»†èƒä½¿å¾—LSTMè·å¾—é•¿æ—¶é—´çš„è®°å¿†ã€‚è¿™ä½¿å¾—ä¿¡æ¯å¯ä»¥ä¸å—é˜»ç¢çš„æµé€šå¤šä¸ªæ—¶é—´æ­¥ã€‚æ²¡æœ‰è¿™äº›é—¨ï¼Œä¿¡æ¯ä¼šåœ¨é€šè¿‡æ—¶é—´æ­¥çš„è½¬ç§»æ—¶è½»æ˜“åœ°æ¶ˆå¤±ã€‚ä¸ä¹‹ç›¸æ¯”ï¼Œå·ç§¯ç¥ç»ç½‘ç»œä¸ä¼šé‡åˆ°è¿™æ ·çš„æ¢¯åº¦æ¶ˆå¤±ç°è±¡ï¼Œæˆ‘ä»¬é€šè¿‡å®éªŒå‘ç°å·ç§¯ç¥ç»ç½‘ç»œä¸éœ€è¦é—å¿˜é—¨ã€‚
å› æ­¤ï¼Œæˆ‘ä»¬è®¤ä¸ºæ¨¡å‹åªéœ€è¦è¾“å‡ºé—¨ï¼Œè¿™ä¸ªé—¨å¯ä»¥æ§åˆ¶ä¿¡æ¯æ˜¯å¦åº”è¯¥é€šè¿‡è¿™äº›å±‚ã€‚æˆ‘ä»¬å±•ç¤ºäº†è¿™ä¸ªæ¨¡å‹å¯¹è¯­è¨€å»ºæ¨¡å¾ˆæœ‰æ•ˆï¼Œå› ä¸ºå®ƒå¯ä»¥ä½¿æ¨¡å‹é€‰æ‹©é¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯çš„æ—¶å€™å“ªä¸ªå•è¯æ˜¯ç›¸å…³çš„ã€‚å’Œæˆ‘ä»¬åŒæ—¶è¿›è¡Œç ”ç©¶çš„ï¼ŒOord et al.(2016b)å±•ç¤ºäº†LSTMé£æ ¼çš„é—¨æ§æœºåˆ¶ï¼Œ$tanh(X \ast W + b) \otimes \sigma(X \ast V + c)$åœ¨å¯¹å›¾åƒè¿›è¡Œå·ç§¯å»ºæ¨¡çš„æœ‰æ•ˆæ€§ã€‚åæ¥ï¼ŒKalchbrenner et al. (2016)åœ¨ç¿»è¯‘å’Œå­—ç¬¦çº§åˆ«çš„è¯­è¨€å»ºæ¨¡ä¸Šä½¿ç”¨é¢å¤–çš„é—¨æ‰©å±•äº†è¿™ä¸ªæœºåˆ¶ã€‚
é—¨æ§çº¿æ€§å•å…ƒæ˜¯ä¸€ç§ç®€åŒ–çš„é—¨æ§æœºåˆ¶ï¼ŒåŸºäºDauphin &amp;amp; Grangier(2015)å¯¹non-deterministic gatesçš„ç ”ç©¶ï¼Œè¿™ä¸ªé—¨å¯ä»¥é€šè¿‡å’Œé—¨ç»„åˆåœ¨ä¸€èµ·çš„çº¿æ€§å•å…ƒå‡å°‘æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ã€‚è¿™ä¸ªé—¨å°½ç®¡å…è®¸æ¢¯åº¦é€šè¿‡çº¿æ€§å•å…ƒè¿›è¡Œä¼ æ’­è€Œä¸å‘ç”Ÿç¼©æ”¾çš„å˜åŒ–ï¼Œä½†ä¿æŒäº†å±‚éçº¿æ€§çš„æ€§è´¨ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸ºgated tanh unit(GTU)çš„LSTMé£æ ¼çš„é—¨çš„æ¢¯åº¦æ˜¯ï¼š
&lt;/p&gt;
$$\nabla[tanh(X) \otimes \sigma(X)]=tanh'(X) \nabla X \otimes \sigma(X) + \sigma'(X) \nabla X \otimes tanh(X)$$&lt;p&gt;
æ³¨æ„åˆ°éšç€æˆ‘ä»¬å †å çš„å±‚æ•°çš„å¢åŠ ï¼Œå®ƒä¼šæ¸æ¸åœ°æ¶ˆå¤±ï¼Œå› ä¸º$tanh&amp;rsquo;(X)$å’Œ$\sigma&amp;rsquo;(X)$è¿™ä¸¤ä¸ªå› æ•°çš„æ•°å€¼èŒƒå›´åœ¨å‡å°ã€‚ç›¸å¯¹æ¥è¯´ï¼Œé—¨æ§çº¿æ€§å•å…ƒçš„æ¢¯åº¦ï¼š
&lt;/p&gt;
$$\nabla [X \otimes \sigma(X)] = \nabla X \otimes \sigma(X) + X \otimes \sigma'(X) \nabla X$$&lt;p&gt;
æœ‰ä¸€æ¡è·¯å¾„$\nabla X \otimes \sigma(X)$å¯¹äºåœ¨$\sigma(X)$ä¸­çš„æ¿€æ´»çš„é—¨æ§å•å…ƒæ²¡æœ‰å‡å°çš„å› æ•°ã€‚è¿™å¯ä»¥è¢«ç†è§£ä¸ºä¸€ä¸ªè·³è¿‡ä¹˜æ³•çš„è¿æ¥å¸®åŠ©æ¢¯åº¦ä¼ æ’­è¿‡è¿™äº›å±‚ã€‚æˆ‘ä»¬é€šè¿‡å®éªŒæ¯”è¾ƒäº†ä¸åŒçš„é—¨ç­–ç•¥åå‘ç°é—¨æ§çº¿æ€§å•å…ƒå¯ä»¥æ”¶æ•›åœ°æ›´å¿«ä¸”å›°æƒ‘åº¦çš„å€¼æ›´å¥½ã€‚&lt;/p&gt;</description></item><item><title>Convolutional Sequence to Sequence Learning</title><link>https://davidham3.github.io/blog/p/convolutional-sequence-to-sequence-learning/</link><pubDate>Tue, 22 May 2018 11:30:51 +0000</pubDate><guid>https://davidham3.github.io/blog/p/convolutional-sequence-to-sequence-learning/</guid><description>&lt;p&gt;ICML 2017. Facebook 2017å¹´çš„å·ç§¯ç‰ˆseq2seqã€‚å·ç§¯åŠ æ³¨æ„åŠ›æœºåˆ¶ï¼Œå¤–åŠ GLUï¼Œè®­ç»ƒé€Ÿåº¦å¾ˆå¿«ï¼Œå› ä¸ºRNNè®­ç»ƒæ—¶ä¾é ä¸Šä¸€ä¸ªå…ƒç´ çš„éšè—çŠ¶æ€ï¼ŒCNNå¯ä»¥å¹¶è¡Œè®­ç»ƒã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1705.03122" target="_blank" rel="noopener"
&gt;Convolutional Sequence to Sequence Learning&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract
&lt;/h1&gt;&lt;p&gt;æµè¡Œçš„åºåˆ—åˆ°åºåˆ—çš„å­¦ä¹ æ–¹æ³•å°†è¾“å…¥çš„åºåˆ—é€šè¿‡å¾ªç¯ç¥ç»ç½‘ç»œæ˜ å°„åˆ°ä¸€ä¸ªå˜é•¿è¾“å‡ºåºåˆ—ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªå®Œå…¨åŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„æ¶æ„ã€‚å¯¹æ¯”å¾ªç¯ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯¹æ‰€æœ‰å…ƒç´ çš„è¿ç®—éƒ½å¯ä»¥å¹¶è¡Œï¼Œè€Œä¸”å¯ä»¥å……åˆ†åˆ©ç”¨GPUèµ„æºï¼Œä¼˜åŒ–è¿‡ç¨‹ä¹Ÿä¼šå˜å¾—æ›´åŠ å®¹æ˜“ï¼Œå› ä¸ºéçº¿æ€§å•å…ƒçš„ä¸ªæ•°æ˜¯å›ºå®šçš„ï¼Œè€Œä¸”ä¸è¾“å…¥é•¿åº¦æ— å…³ã€‚æˆ‘ä»¬ä½¿ç”¨çš„é—¨æ§çº¿æ€§å•å…ƒï¼ˆGLUï¼‰å¯ä»¥å¸®åŠ©æ¢¯åº¦ä¼ æ’­ï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªè§£ç å±‚ä¸Šéƒ¨ç½²äº†ä¸€ä¸ªç‹¬ç«‹çš„æ³¨æ„åŠ›æ¨¡å—ã€‚æˆ‘ä»¬ç®—æ³•è¡¨ç°åœ¨WMTâ€™14è‹±è¯­-å¾·è¯­å’ŒWMTâ€™14è‹±è¯­-æ³•è¯­ä¸¤ä¸ªæ•°æ®é›†ä¸Šï¼Œéƒ½è¦æ¯”Wuç­‰äººçš„æ·±åº¦LSTMæ‹¥æœ‰æ›´é«˜çš„ç²¾åº¦ï¼Œä¸”åœ¨GPUå’ŒCPUä¸Šè®­ç»ƒé€Ÿåº¦éƒ½å¿«äº†ä¸€ä¸ªé‡çº§ã€‚&lt;/p&gt;
&lt;h1 id="1-introduction"&gt;1. Introduction
&lt;/h1&gt;&lt;p&gt;åºåˆ—åˆ°åºåˆ—æ¨¡å‹åœ¨å¾ˆå¤šä»»åŠ¡ä¸­éƒ½å¤§è·æˆåŠŸï¼Œå¦‚æœºå™¨ç¿»è¯‘ã€è¯­éŸ³è¯†åˆ«ï¼ˆSutskever et al., 201v4; Chorowski et al., 2015ï¼‰ï¼Œæ–‡æœ¬æ‘˜è¦ï¼ˆRush et al., 2015; Nallapati et al., 2016; Shen et al., 2016ï¼‰ç­‰ç­‰ã€‚å½“ä»Šä¸»æµçš„æ–¹æ³•å°†è¾“å…¥åºåˆ—ä½¿ç”¨ä¸€ä¸ªåŒå‘å¾ªç¯ç¥ç»ç½‘ç»œè¿›è¡Œç¼–ç ï¼Œå¹¶ä¸”ç”¨å¦ä¸€ä¸ªå¾ªç¯ç¥ç»ç½‘ç»œç”Ÿæˆä¸€ä¸ªå˜é•¿è¾“å‡ºåºåˆ—ï¼Œè¿™ä¸¤ä¸ªæ¨¡å‹é€šè¿‡soft-attentionï¼ˆBahdanau et al., 2014; Luong et al., 2015ï¼‰ç›¸è¿ã€‚åœ¨æœºå™¨ç¿»è¯‘ä¸­ï¼Œè¿™ä¸ªæ¶æ„å·²ç»æ¯”ä¼ ç»Ÿçš„åŸºäºçŸ­è¯­çš„æ¨¡å‹è¦å¥½å‡ºå¾ˆå¤šäº†ï¼ˆSennrich et al., 2016b; Zhou et al., 2016; Wu et al., 2016ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å°½ç®¡å·ç§¯ç¥ç»ç½‘ç»œæœ‰å¾ˆå¤šä¼˜ç‚¹ï¼Œä½†æ˜¯å¾ˆå°‘åº”ç”¨åœ¨åºåˆ—å»ºæ¨¡ä¸­ï¼ˆWaibel et al., 1989; LeCun &amp;amp; Bengio, 1995ï¼‰ã€‚å¯¹æ¯”å¾ªç¯ç¥ç»ç½‘ç»œä¸­çš„å¾ªç¯å±‚ï¼Œå·ç§¯æ˜¯å¯¹å®šé•¿çš„å†…å®¹ç”Ÿæˆè¡¨ç¤ºï¼Œç„¶è€Œï¼Œæœ‰æ•ˆçš„å·ç§¯é•¿åº¦å¯ä»¥é€šè¿‡ç®€å•çš„å †å å·ç§¯å±‚å˜å¾—é€æ¸å¢åŠ ã€‚è¿™å°±ä½¿å¾—æˆ‘ä»¬å¯ä»¥ç²¾ç¡®åœ°æ§åˆ¶è¦å»ºæ¨¡çš„ä¾èµ–å…³ç³»çš„æœ€å¤§é•¿åº¦ã€‚å·ç§¯ç¥ç»ç½‘ç»œä¸éœ€è¦ä¾èµ–äºä¹‹å‰æ—¶é—´æ­¥çš„è®¡ç®—ï¼Œå› æ­¤å¯ä»¥åœ¨åºåˆ—ä¸­çš„ä»»æ„ä¸€ä¸ªåœ°æ–¹è¿›è¡Œå¹¶è¡Œè¿ç®—ã€‚RNNéœ€è¦ç»´æŒä¸€ä¸ªå«æœ‰æ•´ä¸ªè¿‡å»ä¿¡æ¯çš„éšè—çŠ¶æ€ï¼Œå¯¼è‡´å¯¹åºåˆ—è¿›è¡Œè®¡ç®—æ—¶ä¸èƒ½å¹¶è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å¤šå±‚å·ç§¯ç¥ç»ç½‘ç»œåœ¨æ•´ä¸ªè¾“å…¥åºåˆ—ä¸Šæ„å»ºäº†å±‚æ¬¡è¡¨ç¤ºï¼Œåœ¨è¿™ä¸ªå±‚æ¬¡è¡¨ç¤ºä¸­ï¼Œåº•å±‚æ˜¯ä¸´è¿‘çš„è¾“å…¥å…ƒç´ äº¤äº’ï¼Œé«˜å±‚æ˜¯ç¦»å¾—è¾ƒè¿œçš„å…ƒç´ äº¤äº’ã€‚å±‚çº§ç»“æ„ç›¸æ¯”äºé“¾å¼ç»“æ„çš„å¾ªç¯ç¥ç»ç½‘ç»œï¼Œæä¾›äº†ä¸€æ¡æ›´çŸ­çš„è·¯å¾„æ¥æ•è·é•¿èŒƒå›´çš„ä¾èµ–å…³ç³»ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ»‘åŠ¨çª—åœ¨ $n$ ä¸ªå•è¯ä¸Šï¼Œä½¿ç”¨å¤æ‚åº¦ä¸º $O(\frac{n}{k})$ çš„å·ç§¯æ“ä½œï¼Œå·ç§¯æ ¸å®½åº¦ä¸º $k$ï¼Œæ¥è·å–å•è¯é—´çš„å…³ç³»ï¼Œæå–åˆ°ä¸€ä¸ªç‰¹å¾è¡¨ç¤ºï¼Œå¦‚æœç”¨å¾ªç¯ç¥ç»ç½‘ç»œï¼Œå¤æ‚åº¦ä¸º $O(n)$ã€‚å·ç§¯ç¥ç»ç½‘ç»œçš„è¾“å…¥ä¼šè¢«æ”¾å…¥ä¸€ä¸ªæœ‰ç€å›ºå®šæ•°ç›®çš„å·ç§¯æ ¸å’Œéçº¿æ€§å•å…ƒçš„ç½‘ç»œä¸­ï¼Œç„¶è€Œå¾ªç¯ç¥ç»ç½‘ç»œå¯¹ç¬¬ä¸€ä¸ªå•è¯è¿›è¡Œäº† $n$ æ¬¡æ“ä½œå’Œéçº¿æ€§å˜æ¢åï¼Œå¯¹æœ€åä¸€ä¸ªå•è¯åªè¿›è¡Œäº†ä¸€ç»„æ“ä½œã€‚å›ºå®šæ•°ç›®çš„éçº¿æ€§æ“ä½œä¹Ÿå¯ä»¥ç®€åŒ–å­¦ä¹ è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘åœ¨å·ç§¯ç¥ç»ç½‘ç»œåº”ç”¨äºåºåˆ—å»ºæ¨¡çš„å·¥ä½œï¼Œåƒ Bradbury et al.(2016)ï¼Œä»–ä»¬åœ¨ä¸€è¿ä¸²çš„å·ç§¯å±‚é—´å¼•å…¥äº†å¾ªç¯æ± åŒ–ã€‚Kalchbrenner et al.(2016) è§£å†³äº†æ²¡æœ‰æ³¨æ„åŠ›æœºåˆ¶çš„ç¥ç»æœºå™¨ç¿»è¯‘çš„é—®é¢˜ã€‚ç„¶è€Œï¼Œè¿™äº›æ–¹æ³•çš„è¡¨ç°æ²¡æœ‰ä¸€ä¸ªåœ¨å¤§å‹çš„æ•°æ®é›†ä¸Šè¶…è¶Šå½“å‰æœ€å…ˆè¿›çš„æŠ€æœ¯ã€‚é—¨æ§å·ç§¯åœ¨ä¹‹å‰å·²ç»è¢« Meng et al.(2015) ç”¨äºäº†æœºå™¨ç¿»è¯‘ï¼Œä½†æ˜¯ä»–ä»¬çš„è¯„ä¼°æ–¹æ³•å—é™äºå°æ•°æ®é›†ï¼Œè€Œä¸”æ¨¡å‹ä¸ä¼ ç»Ÿçš„åŸºäºè®¡æ•°çš„æ¨¡å‹ç›¸ä¸²è”ã€‚æœ‰ä¸€éƒ¨åˆ†æ˜¯å·ç§¯å±‚çš„æ¶æ„åœ¨å¤§æ•°æ®é›†ä¸Šå±•ç°äº†æ›´å¥½çš„æ•ˆæœä½†æ˜¯ä»–ä»¬çš„è§£ç å™¨ä»ç„¶æ˜¯å¾ªç¯çš„ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªé’ˆå¯¹åºåˆ—åˆ°åºåˆ—çš„æ¨¡å‹ï¼Œè¿™ä¸ªæ¨¡å‹å®Œå…¨æ˜¯åŸºäºå·ç§¯çš„ã€‚æˆ‘ä»¬çš„æ¨¡å‹ä½¿ç”¨äº†é—¨æ§çº¿æ€§å•å…ƒï¼ˆDauphin et al., 2016ï¼‰å’Œæ®‹å·®è¿æ¥ï¼ˆHe et al., 2015aï¼‰ã€‚æˆ‘ä»¬åœ¨æ¯ä¸ªè§£ç å±‚ä¹Ÿä½¿ç”¨äº†æ³¨æ„åŠ›æœºåˆ¶ï¼Œè€Œä¸”æ˜¾ç¤ºå‡ºæ¯ä¸ªæ³¨æ„åŠ›å±‚åªå¢åŠ äº†ä¸€ç‚¹ç‚¹å¯ä»¥å¿½ç•¥ä¸è®¡çš„å¼€é”€ã€‚è¿™äº›æ–¹æ³•çš„èåˆå¯ä»¥è®©æˆ‘ä»¬å¤„ç†å¤§è§„æ¨¡çš„æ•°æ®é›†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨å‡ ä¸ªå¤§å‹çš„æœºå™¨ç¿»è¯‘æ•°æ®é›†ä¸Šè¯„ä¼°äº†æˆ‘ä»¬çš„æ–¹æ³•ï¼Œå¹¶ä¸”å’Œæ–‡ç« ä¸­ç°æœ‰çš„æœ€å¥½çš„æ¶æ„ä»¬è¿›è¡Œäº†å¯¹æ¯”ä¸æ€»ç»“ã€‚åœ¨ WMTâ€™16 è‹±è¯­-ç½—é©¬å°¼äºšè¯­æ•°æ®é›†ä¸Šï¼Œæˆ‘ä»¬çš„ç®—æ³•æ˜¯æœ€å¥½çš„ï¼Œæ¯”ä¹‹å‰æœ€å¥½çš„ç»“æœè¦å¥½ 1.9 BLEUã€‚åœ¨ WMTâ€™14 è‹±è¯­-å¾·è¯­ä¸Šï¼Œæˆ‘ä»¬æ¯” Wu et al.(2016) çš„ strong LSTM å¥½ 0.5 BLEUã€‚åœ¨ WMTâ€™14 è‹±è¯­-æ³•è¯­ä¸Šï¼Œæˆ‘ä»¬æ¯” Wu et al.(2016) çš„ likelihood trained system å¥½ 1.6 BLEUã€‚é™¤æ­¤ä»¥å¤–ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å¯ä»¥ç¿»è¯‘ä»æœªè§è¿‡çš„å¥å­ï¼Œé€Ÿåº¦æ¯” Wu et al.(2016) çš„ç®—æ³•åœ¨ GPU å’Œ CPU ä¸Šéƒ½å¿«å‡ºä¸€ä¸ªæ•°é‡çº§ã€‚&lt;/p&gt;
&lt;h1 id="2-recurrent-sequence-to-sequence-learning"&gt;2. Recurrent Sequence to Sequence Learning
&lt;/h1&gt;&lt;p&gt;åºåˆ—åˆ°åºåˆ—å»ºæ¨¡åˆç§°åŸºäºå¾ªç¯ç¥ç»ç½‘ç»œçš„ç¼–ç å™¨-è§£ç å™¨æ¶æ„ï¼ˆSutskever et al., 2014; Bahdanau et al., 2014ï¼‰ã€‚ç¼–ç å™¨ RNN å¤„ç†è¾“å…¥åºåˆ— $\mathbf{x} = (x_1, â€¦, x_m)$ $m$ ä¸ªå…ƒç´ ï¼Œè¿”å›çŠ¶æ€è¡¨ç¤º $\mathbf{z} = (z_1, â€¦, z_m)$ã€‚è§£ç å™¨ RNN æ¥å— $\bf{z}$ å¹¶ä¸”ä»å·¦åˆ°å³ç”Ÿæˆè¾“å‡ºåºåˆ— $\mathbf{y} = (y_1, â€¦, y_n)$ï¼Œä¸€æ¬¡ä¸€ä¸ªå…ƒç´ ã€‚ä¸ºäº†ç”Ÿæˆè¾“å‡º $y_{i+1}$ï¼Œè§£ç å™¨åŸºäºä¹‹å‰çš„éšè—çŠ¶æ€ $h_i$ ï¼Œå‰ä¸€ä¸ªç›®æ ‡å•è¯ $y_i$ çš„åµŒå…¥è¡¨ç¤º $g_i$ï¼Œè¿˜æœ‰ä¸€ä¸ªæºè‡ªç¼–ç å™¨è¾“å‡º $\bf{z}$ çš„æ¡ä»¶è¾“å…¥ $c_i$ï¼Œè®¡ç®—ä¸€ä¸ªæ–°çš„éšè—çŠ¶æ€ $h_{i+1}$ã€‚åŸºäºè¿™ä¸ªå¤§ä½“çš„è§„åˆ™ï¼Œå„ç§å„æ ·çš„ç¼–ç -è§£ç æ¶æ„è¢«ç›¸ç»§æå‡ºï¼Œä»–ä»¬ä¹‹é—´ä¸»è¦å·®åˆ«æ˜¯æ¡ä»¶è¾“å…¥å’ŒRNNçš„ç±»å‹ä¸åŒã€‚&lt;/p&gt;
&lt;p&gt;æ²¡æœ‰æ³¨æ„åŠ›æœºåˆ¶çš„æ¨¡å‹é€šè¿‡å¯¹æ‰€æœ‰çš„ $i$ è®¾å®š $c_i = z_m$ï¼Œåªè€ƒè™‘æœ€åçš„ç¼–ç çŠ¶æ€ $z_m$ï¼ˆCho et al., 2014ï¼‰ï¼Œæˆ–æ˜¯ç®€å•åœ°å°†ç¬¬ä¸€ä¸ªè§£ç å™¨çš„éšè—çŠ¶æ€åˆå§‹åŒ–ä¸º $z_m$ï¼ˆSutskever et al., 2014ï¼‰ï¼Œåœ¨åé¢è¿™ç§æƒ…å†µä¸­æ²¡æœ‰ç”¨åˆ° $c_i$ã€‚å¸¦æ³¨æ„åŠ›æœºåˆ¶çš„æ¶æ„ï¼ˆBahdanau et al., 2014; Luong et al., 2015ï¼‰åœ¨æ¯ä¸ªæ—¶é—´æ­¥ï¼Œè®¡ç®— $(z_1, &amp;hellip;, z_m)$ çš„åŠ æƒå’Œå¾—åˆ° $c_i$ã€‚æ±‚å’Œæ—¶æ¯ä¸€é¡¹çš„æƒé‡ç§°ä¸ºæ³¨æ„åŠ›åˆ†æ•°ï¼Œå¯ä»¥ä½¿ç½‘ç»œåœ¨è¾“å‡ºåºåˆ—æ—¶å…³æ³¨äºè¾“å…¥åºåˆ—çš„ä¸åŒéƒ¨åˆ†ã€‚æ³¨æ„åŠ›åˆ†æ•°æœ¬è´¨ä¸Šæ˜¯é€šè¿‡æ¯”è¾ƒæ¯ä¸ªç¼–ç å™¨çŠ¶æ€ $z_j$ å’Œä¹‹å‰çš„è§£ç å™¨éšè—çŠ¶æ€ $h_i$ ä¸æœ€åçš„é¢„æµ‹ç»“æœ $y_i$ çš„çº¿æ€§ç»„åˆï¼Œè®¡ç®—å¾—åˆ°ï¼›ç»“æœé€šè¿‡å½’ä¸€åŒ–å¾—åˆ°äº†åœ¨è¾“å…¥åºåˆ—ä¸Šçš„ä¸€ä¸ªåˆ†å¸ƒã€‚&lt;/p&gt;
&lt;p&gt;å½“å‰æµè¡Œçš„ç¼–è§£ç å™¨ä½¿ç”¨çš„æ¨¡å‹æ˜¯é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œï¼ˆLSTM; Hochreiter &amp;amp; Schmidhuber, 1997ï¼‰å’Œé—¨æ§å¾ªç¯å•å…ƒï¼ˆGRU; Cho et al., 2014ï¼‰ã€‚è¿™ä¸¤ä¸ªéƒ½æ˜¯ä½¿ç”¨é—¨æ§æœºåˆ¶å¯¹Elmançš„RNNï¼ˆElman, 1990ï¼‰è¿›è¡Œäº†æ‰©å±•ï¼Œé—¨æ§æœºåˆ¶ä½¿å¾—æ¨¡å‹å¯ä»¥è®°å¾—å‰ä¸€æ—¶é—´æ­¥è·å¾—çš„ä¿¡æ¯ï¼Œä»¥æ­¤æ¥å¯¹é•¿æœŸä¾èµ–è¿›è¡Œå»ºæ¨¡ã€‚å¤§å¤šæ•°æœ€è¿‘çš„æ–¹æ³•ä¹Ÿä¾èµ–äºåŒå‘ç¼–ç å™¨å¯¹è¿‡å»å’Œæœªæ¥çš„ä¸Šä¸‹æ–‡ç¯å¢ƒåŒæ—¶åœ°æ„å»ºè¡¨ç¤ºï¼ˆBahdanau et al., 2014; Zhou et al., 2016; Wu et al., 2016ï¼‰ã€‚é€šå¸¸å¸¦æœ‰å¾ˆå¤šå±‚çš„æ¨¡å‹ä¼šä¾èµ–äºæ®‹å·®ç½‘ç»œçš„æ®‹å·®è¿æ¥ï¼ˆHe et al., 2015a; Zhou et al., 2016; Wu et al., 2016ï¼‰ã€‚&lt;/p&gt;
&lt;h1 id="3-a-convolutional-architecture"&gt;3. A Convolutional Architecture
&lt;/h1&gt;&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»ä¸€ä¸ªåºåˆ—åˆ°åºåˆ—çš„å®Œå…¨å·ç§¯æ¶æ„ã€‚æˆ‘ä»¬ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œæ›¿ä»£ RNN æ¥è®¡ç®—ä¸­é—´çš„ç¼–ç å™¨çŠ¶æ€ $\bf{z}$ å’Œè§£ç å™¨çŠ¶æ€ $\bf{h}$ã€‚&lt;/p&gt;
&lt;h2 id="31-position-embeddings"&gt;3.1. Position Embeddings
&lt;/h2&gt;&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å°†è¾“å…¥åºåˆ— $\mathbf{x} = (x_1, &amp;hellip;, x_m)$ åµŒå…¥åˆ°ä¸€ä¸ªåˆ†å¸ƒçš„ç©ºé—´å†… $\mathbf{w} = (w_1, &amp;hellip;, w_m)$ä¸­ï¼Œå…¶ä¸­ $w_j \in \mathbb{R}^f$ æ˜¯åµŒå…¥çŸ©é˜µ $\mathcal{D} \in \mathbb{R}^{V \times f}$ çš„ä¸€åˆ—ã€‚æˆ‘ä»¬ä¹Ÿé€šè¿‡åµŒå…¥è¾“å…¥å…ƒç´  $\mathbf{p} = (p_1, &amp;hellip;, p_m)$ çš„ç»å¯¹ä½ç½®ä½¿æ¨¡å‹å¯¹é¡ºåºæ•æ„Ÿï¼Œå…¶ä¸­ $p_j \in \mathbb{R}^f$ã€‚è¿™ä¸¤è€…åšåŠ å’Œè·å¾—è¾“å…¥å…ƒç´ çš„è¡¨ç¤º $\mathbf{e} = (w_1+p_1, &amp;hellip;, w_m+p_m)$ã€‚æˆ‘ä»¬å¯¹è§£ç å™¨è¾“å‡ºçš„å…ƒç´ ä¹Ÿåšç›¸ä¼¼çš„å·¥ä½œæ¥ç”Ÿæˆè¾“å‡ºå…ƒç´ è¡¨ç¤º $\mathbf{g} = (g_1, &amp;hellip;, g_n)$ï¼Œç„¶åå†ä¼ å…¥è§£ç ç½‘ç»œã€‚ä½ç½®åµŒå…¥åœ¨æˆ‘ä»¬çš„æ¶æ„ä¸­å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºä»–ä»¬èƒ½è®©æ¨¡å‹çŸ¥é“å½“å‰æ­£åœ¨å¤„ç†çš„è¾“å…¥æˆ–è¾“å‡ºåºåˆ—ä¸­çš„å“ªä¸ªéƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h2 id="32-convolutional-block-structure"&gt;3.2. Convolutional Block Structure
&lt;/h2&gt;&lt;p&gt;ç¼–ç å™¨å’Œè§£ç å™¨ç½‘ç»œå…±äº«ä¸€ä¸ªç®€å•çš„å—çŠ¶ç»“æ„ï¼Œè¿™ä¸ªå—çŠ¶ç»“æ„ä¼šåŸºäºå›ºå®šé•¿åº¦çš„è¾“å…¥å…ƒç´ è®¡ç®—å‡ºä¸­é—´çŠ¶æ€ã€‚æˆ‘ä»¬å°†è§£ç å™¨çš„ç¬¬ $l$ ä¸ªå—çš„è¾“å‡ºè®°ä¸º $\mathbf{h}^l = (h^l_1, &amp;hellip;, h^l_n)$ï¼Œç¼–ç å™¨çš„ç¬¬ $l$ ä¸ªè¾“å‡ºè®°ä¸º $\mathbf{z}^l=(z^l_1, &amp;hellip;, z^l_m)$ï¼›æˆ‘ä»¬äº¤æ›¿åœ°ç§°å—å’Œå±‚ã€‚æ¯ä¸ªå—åŒ…å«ä¸€ä¸ªä¸€ç»´å·ç§¯åŠ ä¸€ä¸ªéçº¿æ€§å•å…ƒã€‚å¯¹äºä¸€ä¸ªæœ‰ç€ä¸€ä¸ªå—å’Œå®½åº¦ä¸º $k$ çš„å·ç§¯æ ¸çš„è§£ç ç½‘ç»œæ¥è¯´ï¼Œæ¯ä¸ªç»“æœçŠ¶æ€ $h^l_i$ åŒ…å«äº†è¿‡å» $k$ ä¸ªè¾“å…¥å…ƒç´ çš„ä¿¡æ¯ã€‚å †å å¤šä¸ªå—å¢åŠ äº†åœ¨ä¸€ä¸ªçŠ¶æ€ä¸­å¯ä»¥è¡¨ç¤ºçš„è¾“å…¥å…ƒç´ çš„æ•°é‡ã€‚æ¯”å¦‚ï¼Œå †å 6ä¸ªå®½åº¦ä¸º $k=5$ çš„å—å¯ä»¥å¾—åˆ°è¾“å…¥ç©ºé—´ä¸º25ä¸ªå…ƒç´ çš„è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªè¾“å‡ºä¾èµ–äº25ä¸ªè¾“å…¥ã€‚éçº¿æ€§å•å…ƒå…è®¸ç½‘ç»œåˆ©ç”¨æ•´ä¸ªè¾“å…¥ç©ºé—´ï¼Œæˆ–è€…åœ¨å¿…è¦æ—¶å…³æ³¨æ›´å°‘çš„å…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªå·ç§¯æ ¸çš„å‚æ•°ä¸º $W \in \mathbb{R}^{2d \times kd}$ï¼Œ$b_w \in \mathbb{R}^{2d}$ï¼Œæ¥æ”¶çš„è¾“å…¥ä¸º $X \in \mathbb{R}^{k \times d}$ï¼Œè¾“å…¥æ˜¯ $k$ ä¸ªè¾“å…¥å…ƒç´ åµŒå…¥åˆ° $d$ ç»´ç©ºé—´å¾—åˆ°çš„å‘é‡çš„æ‹¼æ¥ï¼Œç„¶åå°†ä»–ä»¬æ˜ å°„åˆ°ä¸€ä¸ªæœ‰ç€è¾“å…¥å…ƒç´ ç»´æ•°ä¸¤å€çš„è¾“å‡ºå…ƒç´  $Y \in \mathbb{R}^{2d}$ ä¸Šï¼›åç»­çš„å±‚å¯¹å‰ä¸€å±‚çš„ $k$ ä¸ªè¾“å‡ºå…ƒç´ è¿›è¡Œæ“ä½œã€‚æˆ‘ä»¬é€‰æ‹©é—¨æ§çº¿æ€§å•å…ƒï¼ˆGLU; Dauphin et al., 2016ï¼‰ä½œä¸ºéçº¿æ€§æ¿€æ´»å•å…ƒï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨å·ç§¯ $Y=[A \ B] \in \mathbb{R}^{2d}$ çš„è¾“å‡ºä¸Šå®ç°çš„ä¸€ä¸ªç®€å•çš„é—¨æ§æœºåˆ¶ï¼š&lt;/p&gt;
$$
v([A B])=A \otimes \sigma(B)
$$&lt;p&gt;å…¶ä¸­ $A, B \in \mathbb{R}^d$ æ˜¯éçº¿æ€§å±‚çš„è¾“å…¥ï¼Œ$\otimes$ æ˜¯å…ƒç´ å¯¹å…ƒç´ ç›¸ä¹˜ï¼Œè¾“å‡º $v([A B]) \in \mathbb{R}^d$ æ˜¯ $Y$ çš„å¤§å°çš„ä¸€åŠã€‚é—¨ $\sigma(B)$ æ§åˆ¶å½“å‰çš„ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­å“ªä¸ªè¾“å…¥ $A$ æ˜¯ç›¸å…³çš„ã€‚ä¸€ä¸ªç›¸ä¼¼çš„éçº¿æ€§å•å…ƒç”± Oord et al. (2016b) æå‡ºï¼Œä»–ä»¬åœ¨ $A$ ä¸ŠåŠ äº† $tanh$ ä½†æ˜¯ Dauphin et al. (2016) å±•ç¤ºäº†GLUsåœ¨è¯­è¨€æ¨¡å‹ä¸­è¡¨ç°çš„æ›´å¥½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©æ·±åº¦å·ç§¯ç½‘ç»œå¯è¡Œï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªå·ç§¯çš„è¾“å…¥å’Œå—çš„è¾“å‡ºé—´åŠ å…¥äº†æ®‹å·®è¿æ¥ï¼ˆHe et al., 2015aï¼‰ã€‚&lt;/p&gt;
$$
h^l\_i=v(W^l[h^{l-1}\_{i-k/2}, ..., h^{l-1}\_{i+k/2}] + b^l\_w) + h^{l-1}\_i
$$&lt;p&gt;å¯¹äºç¼–ç å™¨ç½‘ç»œï¼Œæˆ‘ä»¬ç¡®ä¿¡å·ç§¯å±‚çš„è¾“å‡ºé€šè¿‡åœ¨æ¯å±‚å¢åŠ  padding å¯ä»¥åŒ¹é…è¾“å…¥é•¿åº¦ã€‚ç„¶è€Œï¼Œå¯¹äºè§£ç å™¨ç½‘ç»œæˆ‘ä»¬éœ€è¦æ³¨æ„å¯¹äºè§£ç å™¨æ¥è¯´æ²¡æœ‰å¯ç”¨çš„æœªæ¥ä¿¡æ¯ï¼ˆOord et al., 2016aï¼‰ã€‚è¯¦ç»†æ¥è¯´å°±æ˜¯ï¼Œæˆ‘ä»¬åœ¨è¾“å…¥çš„å·¦å³ä¸¤ä¾§éƒ½åŠ äº† $k-1$ ä¸ª 0 ä½œä¸º paddingï¼Œå¹¶ä¸”ä»å·ç§¯è¾“å‡ºçš„æœ«ç«¯åˆ é™¤äº† $k$ ä¸ªå…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¹Ÿåœ¨åµŒå…¥çš„å¤§å° $f$ å’Œ å·ç§¯çš„è¾“å‡ºï¼Œä¹Ÿå°±æ˜¯å¤§å°ä¸º $2d$ çš„ç©ºé—´ä¸­åšäº†çº¿æ€§æ˜ å°„å…³ç³»ã€‚æˆ‘ä»¬åœ¨å°†åµŒå…¥è¡¨ç¤ºè¾“å…¥åˆ°ç¼–ç å™¨çš„æ—¶å€™ï¼Œå¯¹ $\bf{w}$ ä½¿ç”¨äº†è¿™æ ·çš„å˜æ¢ï¼Œä¹Ÿå¯¹ç¼–ç å™¨è¾“å‡º $z^y_j$ï¼Œè§£ç å™¨åœ¨ softmax $\bf{h^L}$ ä¹‹å‰çš„æœ€åä¸€å±‚ï¼Œä»¥åŠè®¡ç®—æ³¨æ„åŠ›å€¼ä¹‹å‰çš„è§£ç å™¨çš„æ¯ä¸€å±‚$h^l$ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬è®¡ç®—äº†åœ¨ $T$ ä¸ªå¯èƒ½çš„ä¸‹ä¸€ä¸ªç›®æ ‡å…ƒç´  $y_{i+1}$ ä¸Šçš„åˆ†å¸ƒï¼Œé€šè¿‡å°†è§£ç å™¨æœ€ä¸Šé¢çš„è¾“å‡ºåšæƒé‡ä¸º $W_o$ åç½®ä¸º $b_o$ çš„çº¿æ€§ç»„åˆå¾—åˆ°ï¼š&lt;/p&gt;
$$
p(y\_{i+1} \mid y\_1, ..., y\_i, \mathbf{x}) = \text{softmax} (W\_oh^L\_i+b\_o) \in \mathbb{R}^T
$$&lt;h2 id="33-multi-step-attention"&gt;3.3. Multi-step Attention
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/convolutional-sequence-to-sequence-learning/Fig1.JPG"
loading="lazy"
alt="Figure1"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯¹äºæ¯ä¸€ä¸ªè§£ç å±‚å¼•å…¥äº†ä¸€ä¸ªåˆ†å¼€çš„æ³¨æ„åŠ›æœºåˆ¶ã€‚ä¸ºäº†è®¡ç®—æ³¨æ„åŠ›ï¼Œæˆ‘ä»¬èåˆäº†å½“å‰è§£ç å™¨çŠ¶æ€$h^l_i$å’Œå‰ä¸€ä¸ªç›®æ ‡å…ƒç´ $g_i$çš„åµŒå…¥è¡¨ç¤ºï¼š
&lt;/p&gt;
$$d^l\_i=W^l\_dh^l\_i + b^l\_d + g\_i$$&lt;p&gt;
è§£ç å™¨å±‚$l$çš„æ³¨æ„åŠ›$a^l_{ij}$çš„çŠ¶æ€$i$å’Œæºå…ƒç´ $j$æ˜¯é€šè¿‡è§£ç å™¨çŠ¶æ€çš„æ±‡æ€»$d^l_i$å’Œæœ€åä¸€ä¸ªç¼–ç å™¨å—$u$çš„æ¯ä¸ªè¾“å‡º$z^u_j$çš„ç‚¹ä¹˜å¾—åˆ°ï¼š
&lt;/p&gt;
$$a^l\_{ij}=\frac{\exp(d^l\_i \cdot z^u\_j)}{\sum^m\_{t=1}\exp(d^l\_i \cdot z^u\_t)}$$&lt;p&gt;
å¯¹å½“å‰è§£ç å™¨å±‚çš„æ¡ä»¶è¾“å…¥$c^l_i$æ˜¯ç¼–ç å™¨è¾“å‡ºçš„åŠ æƒæ±‚å’Œï¼Œä¹Ÿå°±æ˜¯è¾“å…¥å…ƒç´ åµŒå…¥$e_j$ï¼ˆå›¾1ï¼Œä¸­å³ä¾§ï¼‰ï¼š
&lt;/p&gt;
$$c^l\_i=\sum^m\_{j=1}a^l\_{ij}(z^u\_j+e\_j)$$&lt;p&gt;
è¿™ä¸å¾ªç¯ç¥ç»ç½‘ç»œçš„æ–¹æ³•ç¨æœ‰ä¸åŒï¼Œåœ¨å¾ªç¯ç¥ç»ç½‘ç»œä¸­ï¼Œæ³¨æ„åŠ›å’Œ$z^u_j$çš„åŠ æƒæ±‚å’Œæ˜¯åŒæ—¶è®¡ç®—çš„(This is slightly different to recurrent approaches which compute both the attention and the weighted sum over $z^u_j$ only)ã€‚æˆ‘ä»¬å‘ç°åŠ å…¥$e_j$æ›´æœ‰æ•ˆï¼Œè€Œä¸”å®ƒä¸é”®å€¼è®°å¿†ç½‘ç»œç›¸ä¼¼ï¼Œåè€…çš„é”®æ˜¯$z^u_j$ï¼Œå€¼æ˜¯$z^u_j+e_j$ï¼ˆMiller et al., 2016ï¼‰ã€‚ç¼–ç å™¨è¾“å‡º$z^u_j$æ½œåœ¨åœ°è¡¨è¾¾äº†å¤§é‡çš„è¾“å…¥ä¸Šä¸‹æ–‡ï¼Œ$e_j$æä¾›äº†ä¸€ä¸ªåœ¨åšé¢„æµ‹æ—¶æœ‰æ•ˆçš„è¾“å…¥å…ƒç´ çš„ç‚¹ä¿¡æ¯ã€‚ä¸€æ—¦$c^l_i$è¢«è®¡ç®—å¾—å‡ºï¼Œå®ƒå°±ä¼šè¢«ç®€å•çš„åŠ åˆ°å¯¹åº”è§£ç å±‚$h^l_i$çš„è¾“å‡ºä¸Šã€‚
å¯¹æ¯”å•æ­¥æ³¨æ„åŠ›æœºåˆ¶ï¼ˆBahdanau et al., 2014; Luong et al., 2015; Zhou et al., 2016; Wu et al., 2016ï¼‰æ¥è¯´ï¼Œè¿™å¯ä»¥è¢«çœ‹ä½œæ˜¯å¤šæ­¥â€œè·³è·ƒâ€ï¼ˆSukhbaater et al., 2015ï¼‰çš„æ³¨æ„åŠ›æœºåˆ¶ã€‚ç‰¹åˆ«åœ°ï¼Œç¬¬ä¸€å±‚çš„æ³¨æ„åŠ›å†³å®šäº†è¢«è¾“å…¥åˆ°ç¬¬äºŒå±‚çš„ä¸€ä¸ªæœ‰æ•ˆçš„æºä¸Šä¸‹æ–‡ï¼Œç¬¬äºŒå±‚åœ¨è®¡ç®—æ³¨æ„åŠ›çš„æ—¶å€™è€ƒè™‘äº†è¿™ä¸ªä¿¡æ¯ã€‚è§£ç å™¨ä¹Ÿå¯ä»¥ç›´æ¥è·å–æ³¨æ„åŠ›çš„å‰$k-1$æ­¥å†å²ï¼Œå› ä¸ºæ¡ä»¶è¾“å…¥$c^{l-1}_{i-k}, &amp;hellip;, c^{l-1}_{i}$æ˜¯$h^{l-1}_{i-k}, &amp;hellip;, h^{l-1}_i$çš„ä¸€éƒ¨åˆ†ï¼Œè€Œåè€…æ˜¯$h^l_i$çš„è¾“å…¥ã€‚å¯¹äºå¾ªç¯ç¥ç»ç½‘ç»œæ¥è¯´ï¼Œå‰å‡ æ­¥çš„è¾“å…¥åœ¨éšè—çŠ¶æ€ä¸­ï¼Œå¹¶ä¸”éœ€è¦ç»è¿‡å¤šä¸ªéçº¿æ€§å•å…ƒåè¿˜ä¿å­˜ä¸‹æ¥ï¼Œä½†æ˜¯å¯¹äºå·ç§¯çš„ç½‘ç»œæ¥è¯´ï¼Œè€ƒè™‘å·²ç»è¢«åŠ å…¥çš„å‰å‡ æ­¥ä¿¡æ¯æ›´åŠ ç®€å•ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬çš„æ³¨æ„åŠ›æœºåˆ¶è€ƒè™‘äº†æˆ‘ä»¬ä¹‹å‰å·²ç»åŠ å…¥çš„å“ªä¸ªå•è¯ï¼Œå¹¶ä¸”æ¯ä¸ªæ—¶é—´æ­¥éƒ½å®ç°äº†å¤šæ¬¡è·³è·ƒæ³¨æ„åŠ›æœºåˆ¶ã€‚åœ¨åè®°$C$ä¸­ï¼Œæˆ‘ä»¬ç»˜åˆ¶äº†å¯¹äºæ·±å±‚è§£ç å™¨çš„æ³¨æ„åŠ›åˆ†æ•°ï¼Œæ˜¾ç¤ºå‡ºäº†ä¸åŒå±‚ï¼Œè¢«è€ƒè™‘çš„æºè¾“å…¥çš„ä¸åŒä½ç½®ã€‚
æˆ‘ä»¬çš„å·ç§¯æ¶æ„ä¸RNNç›¸æ¯”å¯ä»¥æ‰¹é‡çš„è®¡ç®—ä¸€ä¸ªåºåˆ—çš„æ‰€æœ‰å…ƒç´ çš„æ³¨æ„åŠ›ï¼ˆå›¾1ï¼Œä¸­é—´ï¼‰ã€‚æˆ‘ä»¬åˆ†åˆ«åœ°è®¡ç®—äº†æ¯ä¸ªè§£ç å™¨å±‚ã€‚&lt;/p&gt;
&lt;h3 id="æ­£åˆ™åŒ–çš„ç­–ç•¥"&gt;æ­£åˆ™åŒ–çš„ç­–ç•¥
&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬é€šè¿‡å°å¿ƒçš„æƒé‡åˆå§‹åŒ–ç¨³å®šäº†å­¦ä¹ è¿‡ç¨‹$\text{\S3.5}$ï¼Œå¹¶ä¸”é€šè¿‡ç¼©æ”¾ç½‘ç»œçš„éƒ¨åˆ†ä½¿é€è¿‡ç½‘ç»œä¸­çš„æ–¹å·®ä¸ä¼šå‰§çƒˆçš„å˜åŒ–ã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬ä¹Ÿå¯¹æ®‹å·®å—çš„è¾“å‡ºå’Œæ³¨æ„åŠ›è¿›è¡Œç¼©æ”¾æ¥ä¿æŒæ¿€æ´»åçš„æ–¹å·®ã€‚æˆ‘ä»¬å°†è¾“å…¥çš„åŠ å’Œå’Œä¸€ä¸ªæ®‹å·®å—çš„è¾“å‡ºä¹˜ä»¥äº†$\sqrt{0.5}$ï¼Œæ¥ä½¿å’Œçš„æ–¹å·®å‡åŠã€‚è¿™å‡è®¾äº†è¢«åŠ æ•°æœ‰ç€ç›¸åŒçš„æ–¹å·®ï¼Œè™½è¯´ä¸ä¸€å®šæ€»æ˜¯èƒ½è¿™æ ·ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨çš„æ—¶å€™è¿˜æ˜¯å¾ˆæœ‰æ•ˆçš„ã€‚
é€šè¿‡æ³¨æ„åŠ›æœºåˆ¶ç”Ÿæˆçš„æ¡ä»¶è¾“å…¥$c^l_i$æ˜¯$m$ä¸ªå‘é‡çš„åŠ æƒæ±‚å’Œï¼Œæˆ‘ä»¬é€šè¿‡ç¼©æ”¾$m\sqrt{1/m}$æŠµæ¶ˆäº†åœ¨æ–¹å·®ä¸Šçš„ä¸€ä¸ªå˜åŒ–ï¼›æˆ‘ä»¬å‡è®¾æ³¨æ„åŠ›åˆ†æ•°æ˜¯å‡åŒ€åˆ†å¸ƒçš„ï¼Œå¯¹è¾“å…¥ä¹˜ä»¥äº†$m$æ¥ä½¿ä»–ä»åŸæ¥çš„å¤§å°æ”¾å¤§ã€‚ä¸€èˆ¬æˆ‘ä»¬ä¸è¿™ä¹ˆå¹²ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°åœ¨å®é™…æƒ…å†µä¸­è¡¨ç°å¾—è¿˜æŒºå¥½ã€‚
å¯¹äºå¸¦æœ‰å¤šä¸ªæ³¨æ„åŠ›æœºåˆ¶çš„å·ç§¯è§£ç å™¨ï¼Œæˆ‘ä»¬æ ¹æ®æˆ‘ä»¬çš„ä½¿ç”¨çš„æ³¨æ„åŠ›æœºåˆ¶çš„æ•°é‡å¯¹ç¼–ç å±‚çš„æ¢¯åº¦è¿›è¡Œç¼©æ”¾ï¼›æˆ‘ä»¬æ’é™¤äº†æºå•è¯çš„åµŒå…¥ã€‚æˆ‘ä»¬å‘ç°è¿™æ ·å¯ä»¥ç¨³å®šè®­ç»ƒè¿‡ç¨‹ï¼Œå› ä¸ºå¦‚æœä¸è¿™æ ·ç¼–ç å™¨å°±ä¼šæ¥å—åˆ°å¾ˆå¤§çš„æ¢¯åº¦ã€‚&lt;/p&gt;
&lt;h3 id="åˆå§‹åŒ–"&gt;åˆå§‹åŒ–
&lt;/h3&gt;&lt;p&gt;åœ¨å¯¹ä¸åŒå±‚çš„è¾“å‡ºè¿›è¡ŒåŠ å’Œçš„æ—¶å€™ï¼Œæ¯”å¦‚æ®‹å·®è¿æ¥ï¼Œå¯¹æ¿€æ´»å•å…ƒè¿›è¡Œå½’ä¸€åŒ–æ—¶éœ€è¦å¾ˆå°å¿ƒçš„æƒé‡åˆå§‹åŒ–ã€‚æˆ‘ä»¬çš„åˆå§‹åŒ–ç­–ç•¥æ˜¯å—åˆ°äº†å½’ä¸€åŒ–çš„å¯å‘ï¼šä¿æŒç½‘ç»œå‰å‘å’Œåå‘ä¼ æ’­æ—¶æ¿€æ´»åçš„å€¼çš„æ–¹å·®ã€‚æ‰€æœ‰çš„åµŒå…¥è¡¨ç¤ºä»ä¸€ä¸ªå‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º0.1çš„æ­£æ€åˆ†å¸ƒä¸­åˆå§‹åŒ–å¾—åˆ°ã€‚å¯¹äºè¾“å‡ºä¸ç›´æ¥è¾“å…¥åˆ°é—¨æ§çº¿æ€§å•å…ƒçš„å±‚ï¼Œæˆ‘ä»¬ä»$\mathcal{N}(0, \sqrt{1/n_l})$ä¸­åˆå§‹åŒ–æƒé‡ï¼Œå…¶ä¸­$n_l$æ˜¯æ¯ä¸ªç¥ç»å…ƒè¾“å…¥è¿æ¥æ•°ã€‚è¿™ç¡®ä¿äº†ä¸€ä¸ªå‡åŒ€åˆ†å¸ƒè¾“å…¥çš„æ–¹å·®æ˜¯ä¿æŒä¸å˜çš„ã€‚
å¯¹äºé€šè¿‡GLUæ¿€æ´»çš„å±‚æ¥è¯´ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªé€šè¿‡adapting the derivations inï¼ˆHe et al., 2015b; Glorot &amp;amp; Bengio, 2010; Appendix Aï¼‰çš„åˆå§‹åŒ–æœºåˆ¶ã€‚å¦‚æœGLUçš„è¾“å…¥æœä»å‡å€¼ä¸º0çš„åˆ†å¸ƒï¼Œå¹¶ä¸”æœ‰å……åˆ†å°çš„æ–¹å·®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨è¾“å…¥æ–¹å·®çš„å››åˆ†ä¹‹ä¸€æ¥è¿‘ä¼¼è¾“å‡ºæ–¹å·®ï¼ˆAppendix A.1ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åˆå§‹åŒ–æƒé‡ï¼Œä½¿å¾—GLUæ¿€æ´»çš„è¾“å…¥æœ‰ç€4å€çš„è¾“å…¥çš„æ–¹å·®ã€‚è¿™å¯ä»¥é€šè¿‡å¯¹$\mathcal{N}(0, \sqrt{r/n_l})$é‡‡æ ·åˆå§‹åŒ–å¾—åˆ°ã€‚åç½®é¡¹åœ¨ç½‘ç»œæ„å»ºæ—¶å‡åŒ€çš„è®¾ç½®ä¸º0ã€‚
æˆ‘ä»¬åœ¨æŸäº›å±‚çš„è¾“å…¥ä½¿ç”¨äº†dropoutï¼Œä»¥ä¾¿è¾“å…¥ä¿æŒä¸€ä¸ªæ¦‚ç‡$p$ã€‚è¿™å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªä¼¯åŠªåˆ©éšæœºå˜é‡å–å€¼ä¸º$1/p$çš„æ¦‚ç‡ä¸º$p$ï¼Œå…¶ä»–ä¸º0ï¼ˆSrivastava et al., 2014ï¼‰ã€‚dropoutçš„åº”ç”¨ä¼šä½¿å¾—æ–¹å·®è¢«$1/p$ç¼©æ”¾ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯é€šè¿‡ä½¿ç”¨å¤§çš„æƒé‡æ¥åˆå§‹åŒ–å„ä¸ªå±‚æ¥æ¢å¤è¿›å…¥çš„æ–¹å·®(We aim to restore the incoming variance by initializing the respective layers with larger weights)ã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬ä½¿ç”¨$\mathcal{N}(0, \sqrt{4p/n_l})$åˆå§‹åŒ–é‚£äº›è¾“å‡ºä¼šè¾“å…¥è‡³GLUçš„å±‚ï¼Œä½¿ç”¨$\mathcal{N}(0, \sqrt{p/n_l})$æ¥åˆå§‹åŒ–å…¶ä»–çš„ã€‚&lt;/p&gt;</description></item><item><title>Spatio-Temporal Graph Convolutional Networks: A Deep Learning Framework for Traffic</title><link>https://davidham3.github.io/blog/p/spatio-temporal-graph-convolutional-networks-a-deep-learning-framework-for-traffic/</link><pubDate>Thu, 10 May 2018 15:35:47 +0000</pubDate><guid>https://davidham3.github.io/blog/p/spatio-temporal-graph-convolutional-networks-a-deep-learning-framework-for-traffic/</guid><description>&lt;p&gt;IJCAI 2018ï¼Œå¤§ä½“æ€è·¯ï¼šä½¿ç”¨Kipf &amp;amp; Welling 2017çš„è¿‘ä¼¼è°±å›¾å·ç§¯å¾—åˆ°çš„å›¾å·ç§¯ä½œä¸ºç©ºé—´ä¸Šçš„å·ç§¯æ“ä½œï¼Œæ—¶é—´ä¸Šä½¿ç”¨ä¸€ç»´å·ç§¯å¯¹æ‰€æœ‰é¡¶ç‚¹è¿›è¡Œå·ç§¯ï¼Œä¸¤è€…äº¤æ›¿è¿›è¡Œï¼Œç»„æˆäº†æ—¶ç©ºå·ç§¯å—ï¼Œåœ¨åŠ å·PeMSå’ŒåŒ—äº¬å¸‚çš„ä¸¤ä¸ªæ•°æ®é›†ä¸Šåšäº†éªŒè¯ã€‚ä½†æ˜¯å›¾çš„æ„å»ºæ–¹æ³•å¹¶ä¸æ˜¯åŸºäºå®é™…è·¯ç½‘ï¼Œè€Œæ˜¯é€šè¿‡æ•°å­¦æ–¹æ³•æ„å»ºäº†ä¸€ä¸ªåŸºäºè·ç¦»å…³ç³»çš„ç½‘ç»œã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1709.04875v4" target="_blank" rel="noopener"
&gt;Spatio-Temporal Graph Convolutional Networks: A Deep Learning Framework for Traffic Forecasting&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="æ‘˜è¦"&gt;æ‘˜è¦
&lt;/h1&gt;&lt;p&gt;å®æ—¶ç²¾ç¡®çš„äº¤é€šé¢„æµ‹å¯¹åŸå¸‚äº¤é€šç®¡æ§å’Œå¼•å¯¼å¾ˆé‡è¦ã€‚ç”±äºäº¤é€šæµçš„å¼ºéçº¿æ€§ä»¥åŠå¤æ‚æ€§ï¼Œä¼ ç»Ÿæ–¹æ³•å¹¶ä¸èƒ½æ»¡è¶³ä¸­é•¿æœŸé¢„æµ‹çš„è¦æ±‚ï¼Œè€Œä¸”ä¼ ç»Ÿæ–¹æ³•ç»å¸¸å¿½ç•¥å¯¹æ—¶ç©ºæ•°æ®çš„ä¾èµ–ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–°çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œæ—¶ç©ºå›¾å·ç§¯(Spatio-Temporal Graph Convolutional Networks)ï¼Œæ¥è§£å†³äº¤é€šé¢†åŸŸçš„æ—¶é—´åºåˆ—é¢„æµ‹é—®é¢˜ã€‚æˆ‘ä»¬åœ¨å›¾ä¸Šå°†é—®é¢˜å½¢å¼åŒ–ï¼Œå¹¶ä¸”å»ºç«‹äº†å®Œå…¨å·ç§¯çš„ç»“æ„ï¼Œå¹¶ä¸æ˜¯ç›´æ¥åº”ç”¨ä¼ ç»Ÿçš„å·ç§¯ä»¥åŠå¾ªç¯ç¥ç»å•å…ƒï¼Œè¿™å¯ä»¥è®©è®­ç»ƒé€Ÿåº¦æ›´å¿«ï¼Œå‚æ•°æ›´å°‘ã€‚å®éªŒç»“æœæ˜¾ç¤ºé€šè¿‡åœ¨å¤šå°ºåº¦çš„äº¤é€šç½‘ç»œä¸Šå»ºæ¨¡ï¼ŒSTGCNæ¨¡å‹å¯ä»¥æœ‰æ•ˆåœ°æ•è·åˆ°å¾ˆå…¨é¢çš„æ—¶ç©ºç›¸å…³æ€§å¹¶ä¸”åœ¨å„ç§çœŸå®æ•°æ®é›†ä¸Šè¡¨ç°çš„è¦æ¯”å¾ˆå¤šstate-of-the-artç®—æ³•å¥½ã€‚&lt;/p&gt;
&lt;h1 id="å¼•è¨€"&gt;å¼•è¨€
&lt;/h1&gt;&lt;p&gt;äº¤é€šè¿è¾“åœ¨æ¯ä¸ªäººçš„ç”Ÿæ´»ä¸­éƒ½æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ã€‚æ ¹æ®2015å¹´çš„è°ƒæŸ¥ï¼Œç¾å›½çš„å¸æœºä»¬å¹³å‡æ¯å¤©è¦åœ¨è½¦ä¸Šå‘†48åˆ†é’Ÿã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œç²¾ç¡®çš„å®æ—¶äº¤é€šçŠ¶å†µé¢„æµ‹å¯¹äºè·¯ä¸Šçš„ç”¨æˆ·ï¼Œprivate sectorå’Œæ”¿åºœæ¥è¯´å˜å¾—è‡³å…³é‡è¦ã€‚å¹¿æ³›ä½¿ç”¨çš„äº¤é€šæœåŠ¡ï¼Œå¦‚äº¤é€šæµæ§åˆ¶ã€è·¯çº¿è§„åˆ’å’Œå¯¼èˆªï¼Œä¹Ÿä¾èµ–äºé«˜è´¨é‡çš„äº¤é€šçŠ¶å†µé¢„æµ‹ã€‚æ€»çš„æ¥è¯´ï¼Œå¤šå°ºåº¦çš„äº¤é€šé¢„æµ‹çš„ç ”ç©¶å¾ˆæœ‰å‰æ™¯è€Œä¸”æ˜¯åŸå¸‚äº¤é€šæµæ§åˆ¶å’Œå¼•å¯¼çš„åŸºç¡€ï¼Œä¹Ÿæ˜¯æ™ºèƒ½äº¤é€šç³»ç»Ÿçš„ä¸€ä¸ªä¸»è¦åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨äº¤é€šç ”ç©¶ä¸­ï¼Œäº¤é€šæµçš„åŸºæœ¬å˜é‡ï¼Œä¹Ÿå°±æ˜¯é€Ÿåº¦ã€æµé‡å’Œå¯†åº¦ï¼Œé€šå¸¸ä½œä¸ºç›‘æ§å½“å‰äº¤é€šçŠ¶æ€ä»¥åŠæœªæ¥é¢„æµ‹çš„æŒ‡ç¤ºæŒ‡æ ‡ã€‚æ ¹æ®é¢„æµ‹çš„é•¿åº¦ï¼Œäº¤é€šé¢„æµ‹å¤§ä½“åˆ†ä¸ºä¸¤ä¸ªå°ºåº¦ï¼šçŸ­æœŸ(5~30min)ï¼Œä¸­å’Œé•¿æœŸé¢„æµ‹(è¶…è¿‡30min)ã€‚å¤§å¤šæ•°æµè¡Œçš„ç»Ÿè®¡æ–¹æ³•(æ¯”å¦‚ï¼Œçº¿æ€§å›å½’)å¯ä»¥åœ¨çŸ­æœŸé¢„æµ‹ä¸Šè¡¨ç°çš„å¾ˆå¥½ã€‚ç„¶è€Œï¼Œç”±äºäº¤é€šæµçš„ä¸ç¡®å®šæ€§å’Œå¤æ‚æ€§ï¼Œè¿™äº›æ–¹æ³•åœ¨ç›¸å¯¹é•¿æœŸçš„é¢„æµ‹ä¸Šä¸æ˜¯é‚£ä¹ˆçš„æœ‰æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹å‰åœ¨ä¸­é•¿æœŸäº¤é€šé¢„æµ‹ä¸Šçš„ç ”ç©¶å¯ä»¥å¤§ä½“çš„åˆ†ä¸ºä¸¤ç±»ï¼šåŠ¨æ€å»ºæ¨¡å’Œæ•°æ®é©±åŠ¨çš„æ–¹æ³•ã€‚åŠ¨æ€å»ºæ¨¡ä½¿ç”¨äº†æ•°å­¦å·¥å…·ï¼ˆæ¯”å¦‚å¾®åˆ†æ–¹ç¨‹ï¼‰å’Œç‰©ç†çŸ¥è¯†é€šè¿‡è®¡ç®—æ¨¡æ‹Ÿæ¥å½¢å¼åŒ–äº¤é€šé—®é¢˜[Vlahogiani, 2015]ã€‚ä¸ºäº†è¾¾åˆ°ä¸€ä¸ªç¨³å®šçš„çŠ¶æ€ï¼Œæ¨¡æ‹Ÿè¿›ç¨‹ä¸ä»…éœ€è¦å¤æ‚çš„ç³»ç»Ÿç¼–ç¨‹ï¼Œè¿˜éœ€è¦æ¶ˆè€—å¤§é‡çš„è®¡ç®—èµ„æºã€‚æ¨¡å‹ä¸­ä¸åˆ‡å®é™…çš„å‡è®¾å’ŒåŒ–ç®€ä¹Ÿä¼šé™ä½é¢„æµ‹çš„ç²¾åº¦ã€‚å› æ­¤ï¼Œéšç€äº¤é€šæ•°æ®æ”¶é›†å’Œå­˜å‚¨æŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼Œä¸€å¤§ç¾¤ç ”ç©¶è€…æ­£åœ¨å°†ä»–ä»¬çš„ç›®å…‰æŠ•å‘æ•°æ®é©±åŠ¨çš„æ–¹æ³•ã€‚
å…¸å‹çš„ç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ æ¨¡å‹æ˜¯æ•°æ®é©±åŠ¨æ–¹æ³•çš„ä¸¤ç§ä½“ç°ã€‚åœ¨æ—¶é—´åºåˆ—åˆ†æä¸Šï¼Œè‡ªå›å½’ç§»åŠ¨å¹³å‡æ¨¡å‹ï¼ˆARIMAï¼‰å’Œå®ƒçš„å˜å½¢æ˜¯ä¼—å¤šç»Ÿä¸€çš„æ–¹æ³•ä¸­åŸºäºä¼ ç»Ÿç»Ÿè®¡å­¦çš„æ–¹æ³•[Ahmed and Cook, 1979; Williams and Hoel, 2003; Lippi $et al.$, 2013]ã€‚ç„¶è€Œï¼Œè¿™ç§ç±»å‹çš„æ¨¡å‹å—é™äºæ—¶é—´åºåˆ—çš„å¹³ç¨³åˆ†å¸ƒï¼Œè€Œä¸”ä¸èƒ½è€ƒè™‘æ—¶ç©ºç›¸å…³æ€§ã€‚å› æ­¤ï¼Œè¿™äº›æ–¹æ³•é™åˆ¶äº†é«˜åº¦éçº¿æ€§çš„äº¤é€šæµçš„è¡¨ç¤ºèƒ½åŠ›ã€‚æœ€è¿‘ï¼Œä¼ ç»Ÿçš„ç»Ÿè®¡æ–¹æ³•åœ¨äº¤é€šé¢„æµ‹ä¸Šå·²ç»å—åˆ°äº†æœºå™¨å­¦ä¹ æ–¹æ³•çš„å†²å‡»ã€‚è¿™äº›æ¨¡å‹å¯ä»¥è·å¾—æ›´é«˜çš„ç²¾åº¦ï¼Œå¯¹æ›´å¤æ‚çš„æ•°æ®å»ºæ¨¡ï¼Œæ¯”å¦‚kè¿‘é‚»ï¼ˆKNNï¼‰ï¼Œæ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰å’Œç¥ç»ç½‘ç»œï¼ˆNNï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ·±åº¦å­¦ä¹ æ–¹æ³•&lt;/strong&gt; æœ€è¿‘ï¼Œæ·±åº¦å­¦ä¹ å·²ç»è¢«å¹¿æ³›ä¸”æˆåŠŸåœ°åº”ç”¨äºå„å¼å„æ ·çš„äº¤é€šä»»åŠ¡ä¸­ï¼Œåœ¨æœ€è¿‘çš„å·¥ä½œä¸­å·²ç»å–å¾—äº†å¾ˆæ˜¾è‘—çš„æˆæœï¼Œæ¯”å¦‚ï¼Œæ·±åº¦ç½®ä¿¡ç½‘ç»œï¼ˆDBNï¼‰[Jia &lt;em&gt;et al.&lt;/em&gt;, 2016; Huang &lt;em&gt;et al.&lt;/em&gt;, 2014]å’Œå±‚å è‡ªç¼–ç å™¨(stacked autoencoder)(SAE)[Lv &lt;em&gt;et al.&lt;/em&gt;, 2015; Chen &lt;em&gt;et al.&lt;/em&gt;, 2016]ã€‚ç„¶è€Œï¼Œè¿™äº›å…¨è¿æ¥ç¥ç»ç½‘ç»œå¾ˆéš¾ä»è¾“å…¥ä¸­æå–ç©ºé—´å’Œæ—¶é—´ç‰¹å¾ã€‚è€Œä¸”ï¼Œç©ºé—´å±æ€§çš„ä¸¥æ ¼é™åˆ¶ç”šè‡³å®Œå…¨ç¼ºå¤±ï¼Œè¿™äº›ç½‘ç»œçš„è¡¨ç¤ºèƒ½åŠ›è¢«é™åˆ¶çš„å¾ˆä¸¥é‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å……åˆ†åˆ©ç”¨ç©ºé—´ç‰¹å¾ï¼Œä¸€äº›ç ”ç©¶è€…ä½¿ç”¨äº†å·ç§¯ç¥ç»ç½‘ç»œæ¥æ•è·äº¤é€šç½‘ç»œä¸­çš„ä¸´è¿‘ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿåœ¨æ—¶é—´è½´ä¸Šéƒ¨ç½²äº†å¾ªç¯ç¥ç»ç½‘ç»œã€‚é€šè¿‡ç»„åˆé•¿çŸ­æœŸè®°å¿†ç½‘ç»œ[Hochreiter and Schmidhuber, 1997]å’Œ1ç»´å·ç§¯ï¼ŒWuå’ŒTan[2016]é¦–å…ˆæå‡ºä¸€ä¸ªç‰¹å¾å±‚é¢èåˆçš„æ¶æ„CLTFPæ¥é¢„æµ‹çŸ­æœŸäº¤é€šçŠ¶å†µã€‚å°½ç®¡å®ƒé‡‡å–äº†ä¸€ä¸ªå¾ˆç®€å•çš„ç­–ç•¥ï¼ŒCLTFPä»ç„¶æ˜¯ç¬¬ä¸€ä¸ªå°è¯•å¯¹æ—¶é—´å’Œç©ºé—´è§„å¾‹æ€§å¯¹é½çš„æ–¹æ³•ã€‚åæ¥ï¼ŒShi &lt;em&gt;et al.&lt;/em&gt;[2015]æå‡ºäº†å·ç§¯LSTMï¼Œè¿™æ˜¯ä¸€ä¸ªå¸¦æœ‰åµŒå…¥å·ç§¯å±‚çš„å…¨è¿æ¥LSTMçš„æ‰©å±•ã€‚ç„¶è€Œï¼Œå¸¸è§„çš„å·ç§¯æ“ä½œé™åˆ¶äº†æ¨¡å‹åªèƒ½å¤„ç†å¸¸è§„çš„ç½‘æ ¼ç»“æ„ï¼ˆå¦‚å›¾åƒæˆ–è§†é¢‘ï¼‰ï¼Œè€Œä¸æ˜¯å…¶ä»–çš„å¤§éƒ¨åˆ†é¢†åŸŸï¼ˆæ¯”å¦‚Graphï¼‰ã€‚ä¸æ­¤åŒæ—¶ï¼Œå¾ªç¯ç¥ç»ç½‘ç»œå¯¹äºåºåˆ—çš„å­¦ä¹ éœ€è¦è¿­ä»£è®­ç»ƒï¼Œè¿™ä¼šå¯¼è‡´è¯¯å·®çš„ç§¯ç´¯ã€‚æ›´è¿›ä¸€æ­¥åœ°è¯´ï¼Œå¾ªç¯ç¥ç»ç½‘ç»œï¼ˆåŒ…æ‹¬åŸºäºLSTMçš„RNNï¼‰çš„éš¾ä»¥è®­ç»ƒå’Œè®¡ç®—é‡å¤§æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å…‹æœè¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€äº›ç­–ç•¥æ¥æœ‰æ•ˆçš„å¯¹äº¤é€šæµçš„æ—¶é—´åŠ¨æ€å’Œç©ºé—´ä¾èµ–è¿›è¡Œå»ºæ¨¡ã€‚ä¸ºäº†å®Œå…¨åˆ©ç”¨ç©ºé—´ä¿¡æ¯ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå¹¿ä¹‰å›¾å¯¹äº¤é€šç½‘ç»œå»ºæ¨¡ï¼Œè€Œä¸æ˜¯å°†äº¤é€šæµçœ‹æˆå„ä¸ªç¦»æ•£çš„éƒ¨åˆ†ï¼ˆæ¯”å¦‚ç½‘æ ¼æˆ–ç¢å—ï¼‰ã€‚ä¸ºäº†å¤„ç†å¾ªç¯ç¥ç»ç½‘ç»œçš„ç¼ºé™·ï¼Œæˆ‘ä»¬åœ¨æ—¶é—´è½´ä¸Šéƒ¨ç½²äº†ä¸€ä¸ªå…¨å·ç§¯ç»“æ„æ¥é˜»æ­¢ç´¯ç§¯æ•ˆåº”ï¼ˆcumulative effectsï¼‰å¹¶ä¸”åŠ é€Ÿæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–°çš„ç¥ç»ç½‘ç»œæ¶æ„ï¼Œæ—¶ç©ºå›¾å·ç§¯ç½‘ç»œï¼Œæ¥é¢„æµ‹äº¤é€šæƒ…å†µã€‚è¿™ä¸ªæ¶æ„ç”±å¤šä¸ªæ—¶ç©ºå›¾å·ç§¯å—ç»„æˆï¼Œè¿™äº›éƒ½æ˜¯å›¾å·ç§¯å±‚å’Œå·ç§¯åºåˆ—å­¦ä¹ å±‚ï¼ˆconvolutional sequence learning layersï¼‰çš„ç»„åˆï¼Œç”¨æ¥å¯¹æ—¶é—´å’Œç©ºé—´ä¾èµ–å…³ç³»è¿›è¡Œå»ºæ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„ä¸»è¦è´¡çŒ®å¯ä»¥å½’çº³ä¸ºä»¥ä¸‹ä¸‰ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æˆ‘ä»¬ç ”ç©¶äº†åœ¨äº¤é€šé¢†åŸŸæ—¶é—´ä¸ç©ºé—´ä¾èµ–ç»“åˆçš„å¥½å¤„ã€‚ä¸ºäº†å……åˆ†åˆ©ç”¨æˆ‘ä»¬çš„çŸ¥è¯†ï¼Œè¿™æ˜¯åœ¨äº¤é€šç ”ç©¶ä¸­ç¬¬ä¸€æ¬¡åº”ç”¨çº¯å·ç§¯å±‚æ¥åŒæ—¶ä»å›¾ç»“æ„çš„æ—¶é—´åºåˆ—ä¸­æå–æ—¶ç©ºä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–°çš„ç”±æ—¶ç©ºå—ç»„æˆçš„ç¥ç»ç½‘ç»œç»“æ„ã€‚ç”±äºè¿™ä¸ªæ¶æ„ä¸­æ˜¯çº¯å·ç§¯æ“ä½œï¼Œå®ƒæ¯”åŸºäºRNNçš„æ¨¡å‹çš„è®­ç»ƒé€Ÿåº¦å¿«10å€ä»¥ä¸Šï¼Œè€Œä¸”éœ€è¦çš„å‚æ•°æ›´å°‘ã€‚è¿™ä¸ªæ¶æ„å¯ä»¥è®©æˆ‘ä»¬æ›´æœ‰æ•ˆåœ°å¤„ç†æ›´å¤§çš„è·¯ç½‘ï¼Œè¿™éƒ¨åˆ†å°†åœ¨ç¬¬å››éƒ¨åˆ†å±•ç¤ºã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬åœ¨ä¸¤ä¸ªçœŸå®äº¤é€šæ•°æ®é›†ä¸ŠéªŒè¯äº†æå‡ºæ¥çš„ç½‘ç»œã€‚è¿™ä¸ªå®éªŒæ˜¾ç¤ºå‡ºæˆ‘ä»¬çš„æ¡†æ¶æ¯”å·²ç»å­˜åœ¨çš„åœ¨å¤šé•¿åº¦é¢„æµ‹å’Œç½‘ç»œå°ºåº¦ä¸Šçš„æ¨¡å‹è¡¨ç°çš„æ›´å¥½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="å‡†å¤‡å·¥ä½œ"&gt;å‡†å¤‡å·¥ä½œ
&lt;/h1&gt;&lt;h2 id="è·¯ç½‘ä¸Šçš„äº¤é€šé¢„æµ‹"&gt;è·¯ç½‘ä¸Šçš„äº¤é€šé¢„æµ‹
&lt;/h2&gt;&lt;p&gt;äº¤é€šé¢„æµ‹æ˜¯ä¸€ä¸ªå…¸å‹çš„æ—¶é—´åºåˆ—é¢„æµ‹é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯é¢„æµ‹åœ¨ç»™å®šå‰Mä¸ªè§‚æµ‹æ ·æœ¬æ¥ä¸‹æ¥Hä¸ªæ—¶é—´æˆ³åæœ€å¯èƒ½çš„äº¤é€šæµæŒ‡æ ‡ï¼ˆæ¯”å¦‚é€Ÿåº¦æˆ–äº¤é€šæµï¼‰ï¼Œ&lt;/p&gt;
&lt;p&gt;$$&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;\tag{1} \hat{v}\_{t+1}, ..., \hat{v}\_{t+H} = \mathop{\arg\min}\_{v\_{t+1},...,v\_{t+H}}logP(v\_{t+1},...,v\_{t+H}\vert v\_{t-M+1},...v\_t)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;$$&lt;/p&gt;
&lt;p&gt;è¿™é‡Œ$v_t \in \mathbb{R}^n$æ˜¯$n$ä¸ªè·¯æ®µåœ¨æ—¶é—´æˆ³$t$è§‚å¯Ÿåˆ°çš„ä¸€ä¸ªå‘é‡ï¼Œæ¯ä¸ªå…ƒç´ è®°å½•äº†ä¸€æ¡è·¯æ®µçš„å†å²è§‚æµ‹æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çš„å·¥ä½œä¸­ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªå›¾ä¸Šå®šä¹‰äº†ä¸€ä¸ªäº¤é€šç½‘ç»œï¼Œå¹¶ä¸“æ³¨äºç»“æ„åŒ–çš„äº¤é€šæ—¶é—´åºåˆ—ã€‚è§‚æµ‹åˆ°çš„æ ·æœ¬$v_t$é—´ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œè€Œæ˜¯åœ¨å›¾ä¸­ä¸¤ä¸¤ç›¸äº’è¿æ¥çš„ã€‚å› æ­¤ï¼Œæ•°æ®ç‚¹$v_t$å¯ä»¥è¢«è§†ä¸ºå®šä¹‰åœ¨æƒé‡ä¸º$w_{ij}$ï¼Œå¦‚å›¾1å±•ç¤ºçš„æ— å‘å›¾ï¼ˆæˆ–æœ‰å‘å›¾ï¼‰$\mathcal{G}$ä¸Šçš„ä¸€ä¸ªä¿¡å·ã€‚åœ¨ç¬¬$t$ä¸ªæ—¶é—´æˆ³ï¼Œåœ¨å›¾$\mathcal{G_t}=(\mathcal{V_t}, \mathcal{\varepsilon}, W)$, $\mathcal{V_t}$æ˜¯å½“é¡¶ç‚¹çš„æœ‰é™é›†ï¼Œå¯¹åº”åœ¨äº¤é€šç½‘ç»œä¸­$n$ä¸ªç›‘æµ‹ç«™ï¼›$\epsilon$æ˜¯è¾¹é›†ï¼Œè¡¨ç¤ºè§‚æµ‹ç«™ä¹‹é—´çš„è¿é€šæ€§ï¼›$W \in \mathbb{R^{n \times n}}$è¡¨ç¤º$\mathcal{G_t}$çš„é‚»æ¥çŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/spatio-temporal-graph-convolutional-networks-a-deep-learning-framework-for-traffic/Fig1.PNG"
loading="lazy"
alt="Fig1"
&gt;&lt;/p&gt;
&lt;h2 id="å›¾ä¸Šçš„å·ç§¯"&gt;å›¾ä¸Šçš„å·ç§¯
&lt;/h2&gt;&lt;p&gt;ä¼ ç»Ÿç½‘æ ¼ä¸Šçš„æ ‡å‡†å·ç§¯å¾ˆæ˜æ˜¾æ˜¯ä¸èƒ½åº”ç”¨åœ¨å¹¿ä¹‰å›¾ä¸Šçš„ã€‚ç°åœ¨æœ‰ä¸¤ä¸ªåŸºæœ¬çš„æ–¹æ³•æ­£åœ¨æ¢ç´¢å¦‚ä½•æ³›åŒ–ç»“æ„åŒ–æ•°æ®ä¸Šçš„CNNã€‚ä¸€ä¸ªæ˜¯æ‰©å±•å·ç§¯çš„ç©ºé—´å®šä¹‰[Niepert &lt;em&gt;et al.&lt;/em&gt;, 2016]ï¼Œå¦ä¸€ä¸ªæ˜¯ä½¿ç”¨å›¾å‚…é‡Œå¶å˜æ¢åœ¨è°±åŸŸä¸­è¿›è¡Œæ“ä½œ[Bruna &lt;em&gt;et al.&lt;/em&gt;, 2013]ã€‚å‰ä¸€ä¸ªæ–¹æ³•é‡æ–°å°†é¡¶ç‚¹å®‰æ’è‡³ç¡®å®šçš„è¡¨æ ¼å½¢å¼å†…ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨ä¼ ç»Ÿçš„å·ç§¯æ–¹æ³•äº†ã€‚åè€…å¼•å…¥äº†è°±æ¡†æ¶ï¼Œåœ¨è°±åŸŸä¸­åº”ç”¨å›¾å·ç§¯ï¼Œç»å¸¸è¢«ç§°ä¸ºè°±å›¾å·ç§¯ã€‚ä¸€äº›åç»­çš„ç ”ç©¶é€šè¿‡å°†æ—¶é—´å¤æ‚åº¦ä»$O(n^2)$é™è‡³çº¿æ€§[Defferrard &lt;em&gt;et al.&lt;/em&gt;, 2016;Kipf and Welling, 2016]ä½¿è°±å›¾å·ç§¯çš„æ•ˆæœæ›´å¥½ã€‚
æˆ‘ä»¬åŸºäºè°±å›¾å·ç§¯çš„å®šä¹‰å¼•å…¥å›¾å·ç§¯æ“ä½œâ€œ$\ast_{\mathcal{G}}$â€çš„ç¬¦å·ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ ¸$\Theta$å’Œä¿¡å·$x \in \mathbb{R}^n$çš„ä¹˜æ³•ï¼Œ&lt;/p&gt;
$$\tag{2} \Theta \ast\_{\mathcal{G}}x=\Theta(L)x=\Theta(U \Lambda U^T)x=U\Theta(\Lambda)U^Tx$$&lt;p&gt;è¿™é‡Œå›¾çš„å‚…é‡Œå¶åŸº$U \in \mathbb{R}^{n \times n}$æ˜¯å½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ$L=I_n-D^{-1/2}WD^{-1/2}= U \Lambda U^T \in \mathbb{R}^{n \times n}$çš„ç‰¹å¾å‘é‡ç»„æˆçš„çŸ©é˜µï¼Œå…¶ä¸­$I_n$æ˜¯å•ä½é˜µï¼Œ$D \in \mathbb{R}^{n \times n}$æ˜¯å¯¹è§’çš„åº¦çŸ©é˜µ$D_{ii}=\sum_j{W_{ij}}$ï¼›$\Lambda \in \mathbb{R}^{n \times n}$æ˜¯$L$çš„ç‰¹å¾å€¼ç»„æˆçš„çŸ©é˜µï¼Œå·ç§¯æ ¸$\Theta(\Lambda)$æ˜¯ä¸€ä¸ªå¯¹è§’çŸ©é˜µã€‚é€šè¿‡è¿™ä¸ªå®šä¹‰ï¼Œä¸€ä¸ªå›¾ä¿¡å·$x$æ˜¯è¢«ä¸€ä¸ªæ ¸$\Theta$é€šè¿‡$\Theta$å’Œå›¾å‚…é‡Œå¶å˜æ¢$U^Tx$[Shuman &lt;em&gt;et al.&lt;/em&gt;, 2013]è¿‡æ»¤çš„ã€‚&lt;/p&gt;
&lt;h1 id="æå‡ºçš„æ¨¡å‹"&gt;æå‡ºçš„æ¨¡å‹
&lt;/h1&gt;&lt;h2 id="ç½‘ç»œæ¶æ„"&gt;ç½‘ç»œæ¶æ„
&lt;/h2&gt;&lt;p&gt;åœ¨è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬è¯¦ç»†è¯´æ˜äº†æ—¶ç©ºå›¾å·ç§¯ç½‘ç»œçš„æ¡†æ¶ã€‚å¦‚å›¾äºŒæ‰€ç¤ºï¼ŒSTGCNæœ‰å¤šä¸ªæ—¶ç©ºå·ç§¯å—ç»„æˆï¼Œæ¯ä¸€ä¸ªéƒ½æ˜¯åƒä¸€ä¸ªâ€œä¸‰æ˜æ²»â€ç»“æ„çš„ç»„æˆï¼Œæœ‰ä¸¤ä¸ªé—¨åºåˆ—å·ç§¯å±‚å’Œä¸€ä¸ªç©ºé—´å›¾å·ç§¯å±‚åœ¨ä¸­é—´ã€‚æ¯ä¸ªæ¨¡å—çš„ç»†èŠ‚å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/spatio-temporal-graph-convolutional-networks-a-deep-learning-framework-for-traffic/Fig2.PNG"
loading="lazy"
alt="Fig2"
&gt;&lt;/p&gt;
&lt;p&gt;å›¾äºŒï¼šæ—¶ç©ºå›¾å·ç§¯ç½‘ç»œçš„æ¶æ„å›¾ã€‚STGCNçš„æ¶æ„æœ‰ä¸¤ä¸ªæ—¶ç©ºå·ç§¯å—å’Œä¸€ä¸ªå…¨è¿æ¥çš„åœ¨æœ«å°¾çš„è¾“å‡ºå±‚ç»„æˆã€‚æ¯ä¸ªST-Convå—åŒ…å«äº†ä¸¤ä¸ªæ—¶é—´é—¨å·ç§¯å±‚ï¼Œä¸­é—´æœ‰ä¸€ä¸ªç©ºé—´å›¾å·ç§¯å±‚ã€‚æ¯ä¸ªå—ä¸­éƒ½ä½¿ç”¨äº†æ®‹å·®è¿æ¥å’Œbottleneckç­–ç•¥ã€‚è¾“å…¥$v_{t-M+1},&amp;hellip;v_t$è¢«ST-Convå—å‡åŒ€çš„ï¼ˆuniformlyï¼‰å¤„ç†ï¼Œæ¥è·å–æ—¶ç©ºä¾èµ–å…³ç³»ã€‚å…¨éƒ¨ç‰¹å¾ç”±ä¸€ä¸ªè¾“å‡ºå±‚æ¥æ•´åˆï¼Œç”Ÿæˆæœ€åçš„é¢„æµ‹$\hat{v}$ã€‚&lt;/p&gt;
&lt;h2 id="æå–ç©ºé—´ç‰¹å¾çš„å›¾å·ç§¯ç¥ç»ç½‘ç»œ"&gt;æå–ç©ºé—´ç‰¹å¾çš„å›¾å·ç§¯ç¥ç»ç½‘ç»œ
&lt;/h2&gt;&lt;p&gt;äº¤é€šç½‘ç»œå¤§ä½“ä¸Šæ˜¯ä¸€ä¸ªå›¾ç»“æ„ã€‚ç”±æ•°å­¦ä¸Šçš„å›¾æ¥æ„æˆè·¯ç½‘æ˜¯å¾ˆè‡ªç„¶ä¹Ÿå¾ˆåˆç†çš„ã€‚ç„¶è€Œï¼Œä¹‹å‰çš„ç ”ç©¶å¿½è§†äº†äº¤é€šç½‘ç»œçš„ç©ºé—´å±æ€§ï¼šå› ä¸ºäº¤é€šç½‘ç»œè¢«åˆ†æˆäº†å—æˆ–ç½‘æ ¼çŠ¶ï¼Œæ‰€ä»¥ç½‘ç»œçš„å…¨å±€æ€§å’Œè¿é€šæ€§è¢«è¿‡åˆ†çš„å…³æ³¨äº†ã€‚å³ä½¿æ˜¯åœ¨ç½‘æ ¼ä¸Šçš„äºŒç»´å·ç§¯ï¼Œç”±äºæ•°æ®å»ºæ¨¡çš„æŠ˜ä¸­ï¼Œä¹Ÿåªèƒ½æ•æ‰åˆ°å¤§ä½“çš„ç©ºé—´å±€éƒ¨æ€§ã€‚æ ¹æ®ä»¥ä¸Šæƒ…å†µï¼Œåœ¨æˆ‘ä»¬çš„æ¨¡å‹ä¸­ï¼Œå›¾å·ç§¯è¢«ç›´æ¥çš„åº”ç”¨åœ¨äº†å›¾ç»“æ„æ•°æ®ä¸Šä¸ºäº†åœ¨ç©ºé—´ä¸­æŠ½å–å¾ˆæœ‰æ„ä¹‰çš„æ¨¡å¼å’Œç‰¹å¾ã€‚é›†æ˜¯åœ¨å›¾å·ç§¯ä¸­ç”±å¼2å¯ä»¥çœ‹å‡ºæ ¸$\Theta$çš„è®¡ç®—çš„æ—¶é—´å¤æ‚åº¦ç”±äºå‚…é‡Œå¶åŸºçš„ä¹˜æ³•å¯ä»¥è¾¾åˆ°$O(n^2)$ï¼Œä¸¤ä¸ªè¿‘ä¼¼çš„ç­–ç•¥å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼è¶‹è¿‘&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å±€éƒ¨åŒ–è¿‡æ»¤å™¨å¹¶ä¸”å‡å°‘å‚æ•°ï¼Œæ ¸$\Theta$å¯ä»¥è¢«ä¸€ä¸ªå…³äº$\Lambda$çš„å¤šé¡¹å¼é™åˆ¶èµ·æ¥ï¼Œä¹Ÿå°±æ˜¯$\Theta(\Lambda)=\sum_{k=0}^{K-1} \theta_k \Lambda^k$ï¼Œå…¶ä¸­$\theta \in \mathbb{R}^K$æ˜¯ä¸€ä¸ªå¤šé¡¹å¼ç³»æ•°çš„å‘é‡ã€‚$K$æ˜¯å›¾å·ç§¯æ ¸çš„å¤§å°ï¼Œå®ƒå†³å®šäº†å·ç§¯ä»ä¸­å¿ƒèŠ‚ç‚¹å¼€å§‹çš„æœ€å¤§åŠå¾„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼$T_k(x)$è¢«ç”¨äºè¿‘ä¼¼æ ¸ï¼Œä½œä¸º$K-1$é˜¶å±•å¼€çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯$\Theta(\Lambda) \approx \sum_{k=0}^{K-1} \theta_k T_k(\widetilde{\Lambda})$ï¼Œå…¶ä¸­$\widetilde{\Lambda}=2\Lambda/\lambda_{max}-I_n$ï¼ˆ$\lambda_{max}$è¡¨ç¤º$L$çš„æœ€å¤§ç‰¹å¾å€¼ï¼‰[Hammond &lt;em&gt;et al.&lt;/em&gt;, 2011]ã€‚å›¾å·ç§¯å› æ­¤å¯ä»¥è¢«å†™æˆ&lt;/p&gt;
$$
\tag{3} \Theta \ast\_{\mathcal{G}} x = \Theta(L)x \approx \sum\_{k=0}^{K-1}\theta\_k T\_k(\widetilde{L})x
$$&lt;p&gt;å…¶ä¸­$T_k(\widetilde{L}) \in \mathbb{R}^{n \times n}$æ˜¯ké˜¶åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼å¯¹ç¼©æ”¾åï¼ˆscaledï¼‰çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ$\widetilde{L}=2L/\lambda_{max}-I_n$ã€‚é€šè¿‡é€’å½’åœ°ä½¿ç”¨è¶‹è¿‘åçš„åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼è®¡ç®—Ké˜¶å·ç§¯æ“ä½œï¼Œå¼2çš„å¤æ‚åº¦å¯ä»¥è¢«é™ä½è‡³$O(K\vert \varepsilon \vert)$ï¼Œå¦‚å¼3æ‰€ç¤º[Defferrard &lt;em&gt;et al.&lt;/em&gt;, 2016]ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1é˜¶è¿‘ä¼¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªé’ˆå¯¹å±‚çš„çº¿æ€§å…¬å¼å¯ä»¥ç”±å †å å¤šä¸ªä½¿ç”¨æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ä¸€é˜¶è¿‘ä¼¼çš„å±€éƒ¨å›¾å·ç§¯å±‚[Kipf and Welling, 2016]ã€‚ç»“æœå°±æ˜¯ï¼Œè¿™æ ·å¯ä»¥æ„å»ºå‡ºä¸€ä¸ªæ·±çš„ç½‘ç»œï¼Œè¿™ä¸ªç½‘ç»œå¯ä»¥æ·±å…¥åœ°æ¢å¤ç©ºé—´ä¿¡æ¯å¹¶ä¸”ä¸éœ€è¦æŒ‡å®šå¤šé¡¹å¼ä¸­çš„å‚æ•°ã€‚ç”±äºåœ¨ç¥ç»ç½‘ç»œä¸­è¦ç¼©æ”¾å’Œå½’ä¸€åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥å‡è®¾$\lambda_{max} \approx 2$ã€‚å› æ­¤ï¼Œå¼3å¯ä»¥ç®€å†™ä¸º&lt;/p&gt;
$$
\begin{aligned}
\Theta \ast\_{\mathcal{G}}x \approx &amp; \theta\_0x+\theta\_1(\frac{2}{\lambda\_{max}}L-I\_n)x\\
\approx &amp; \theta\_0 x- \theta\_1(D^{-\frac{1}{2}} W D^{-\frac{1}{2}}) x
\end{aligned}
$$&lt;p&gt;å…¶ä¸­ï¼Œ$\theta_0$ï¼Œ$\theta_1$æ˜¯æ ¸çš„ä¸¤ä¸ªå…±äº«å‚æ•°ã€‚ä¸ºäº†çº¦æŸå‚æ•°å¹¶ä¸ºç¨³å®šæ•°å€¼è®¡ç®—ï¼Œ$\theta_0$å’Œ$\theta_1$ç”¨ä¸€ä¸ªå‚æ•°$\theta$æ¥æ›¿æ¢ï¼Œ$\theta=\theta_0=-\theta_1$ï¼›$W$å’Œ$D$æ˜¯é€šè¿‡$\widetilde{W}=W+I_n$å’Œ$\widetilde{D}_{ii}=\sum_j\widetilde{W}_{ij}$é‡æ–°å½’ä¸€åŒ–å¾—åˆ°çš„ã€‚ä¹‹åï¼Œå›¾å·ç§¯å°±å¯ä»¥è¡¨è¾¾ä¸º&lt;/p&gt;
$$
\begin{aligned}
\Theta \ast\_{\mathcal{G}} x = &amp; \theta(I\_n + D^{-\frac{1}{2}} W D^{\frac{1}{2}})x\\
= &amp; \theta (\widetilde{D}^{-\frac{1}{2}} \widetilde{W} \widetilde{D}^{-\frac{1}{2}})x
\end{aligned}
$$&lt;p&gt;ç«–ç›´åœ°å †å ä¸€é˜¶è¿‘ä¼¼çš„å›¾å·ç§¯å¯ä»¥è·å¾—å’Œå¹³è¡Œçš„Ké˜¶å·ç§¯ç›¸åŒçš„æ•ˆæœï¼Œæ‰€æœ‰çš„å·ç§¯å¯ä»¥ä»ä¸€ä¸ªé¡¶ç‚¹çš„$K-1$é˜¶é‚»å±…ä¸­è·å–åˆ°ä¿¡æ¯ã€‚åœ¨è¿™é‡Œï¼Œ$K$æ˜¯è¿ç»­å·ç§¯æ“ä½œçš„æ¬¡æ•°æˆ–æ˜¯æ¨¡å‹ä¸­çš„å·ç§¯å±‚æ•°ã€‚è¿›ä¸€æ­¥è¯´ï¼Œé’ˆå¯¹å±‚çš„çº¿æ€§ç»“æ„æ˜¯èŠ‚çœå‚æ•°çš„ï¼Œå¹¶ä¸”å¯¹å¤§å‹çš„å›¾æ¥è¯´æ˜¯æ•ˆç‡å¾ˆé«˜çš„ï¼Œå› ä¸ºå¤šé¡¹å¼è¶‹è¿‘çš„é˜¶æ•°ä¸º1ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å›¾å·ç§¯çš„æ³›åŒ–&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å›¾å·ç§¯æ“ä½œ$\ast_{\mathcal{G}}$ä¹Ÿå¯ä»¥è¢«æ‰©å±•åˆ°å¤šç»´å¼ é‡ä¸Šã€‚å¯¹äºä¸€ä¸ªæœ‰ç€$C_i$ä¸ªé€šé“çš„ä¿¡å·$X \in \mathbb{R}^{n \times C_i}$ï¼Œå›¾å·ç§¯æ“ä½œå¯ä»¥æ‰©å±•ä¸º&lt;/p&gt;
$$
y\_j = \sum\_{i=1}^{C\_i} \Theta\_{i,j}(L) x\_i \in \mathbb{R}^n, 1 \leq j \leq C\_o
$$&lt;p&gt;å…¶ä¸­ï¼Œ$C_i \times C_o$ä¸ªå‘é‡æ˜¯åˆ‡æ¯”é›ªå¤«ç³»æ•°$\Theta_{i,j} \in \mathbb{R}^K$ï¼ˆ$C_i$ï¼Œ$C_o$åˆ†åˆ«æ˜¯feature mapçš„è¾“å…¥å’Œè¾“å‡ºå¤§å°ï¼‰ã€‚é’ˆå¯¹äºŒç»´å˜é‡çš„å›¾å·ç§¯è¡¨ç¤ºä¸º$\Theta \ast_{\mathcal{G}} X$ï¼Œå…¶ä¸­$\Theta \in \mathbb{R}^{K \times C_i \times C_o}$ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¾“å…¥çš„äº¤é€šé¢„æµ‹æ˜¯ç”±$M$å¸§è·¯ç½‘ç»„æˆçš„ï¼Œå¦‚å›¾1æ‰€ç¤ºã€‚æ¯å¸§$v_t$å¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªçŸ©é˜µï¼Œå®ƒçš„ç¬¬$i$åˆ—æ˜¯å›¾$\mathcal{G_t}$ä¸­ç¬¬$i$ä¸ªé¡¶ç‚¹çš„ä¸€ä¸ªä¸º$C_i$ç»´çš„å€¼ï¼Œä¹Ÿå°±æ˜¯$X \in \mathbb{R}^{n \times C_i}$ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ$C_i=1$ï¼‰ã€‚å¯¹äº$M$ä¸­çš„æ¯ä¸ªæ—¶é—´æ­¥$t$ï¼Œç›¸åŒçš„æ ¸ä¸ç›¸åŒçš„å›¾å·ç§¯æ“ä½œæ˜¯åœ¨$X_t \in \mathbb{R}^{n \times C_i}$ä¸­å¹¶è¡Œè¿›è¡Œçš„ã€‚å› æ­¤ï¼Œå›¾å·ç§¯æ“ä½œä¹Ÿå¯ä»¥æ³›åŒ–è‡³ä¸‰ç»´ï¼Œè®°ä¸º$\Theta \ast_{\mathcal{G}} \mathcal{X}$ï¼Œå…¶ä¸­$\mathcal{X} \in \mathbb{R}^{M \times n \times C_i}$&lt;/p&gt;
&lt;h2 id="æŠ½å–æ—¶é—´ç‰¹å¾çš„é—¨æ§å·ç§¯ç¥ç»ç½‘ç»œ"&gt;æŠ½å–æ—¶é—´ç‰¹å¾çš„é—¨æ§å·ç§¯ç¥ç»ç½‘ç»œ
&lt;/h2&gt;&lt;p&gt;å°½ç®¡åŸºäºRNNçš„æ¨¡å‹å¯ä»¥å¹¿æ³›çš„åº”ç”¨äºæ—¶é—´åºåˆ—åˆ†æï¼Œç”¨äºäº¤é€šé¢„æµ‹çš„å¾ªç¯ç¥ç»ç½‘ç»œä»ç„¶ä¼šé‡åˆ°è´¹æ—¶çš„è¿­ä»£ï¼Œå¤æ‚çš„é—¨æ§æœºåˆ¶ï¼Œå¯¹åŠ¨æ€å˜åŒ–çš„å“åº”æ…¢ã€‚ç›¸åï¼ŒCNNè®­ç»ƒå¿«ï¼Œç»“æ„ç®€å•ï¼Œè€Œä¸”ä¸ä¾èµ–äºå‰ä¸€æ­¥ã€‚å—åˆ°[Gehring &lt;em&gt;et al.&lt;/em&gt;, 2017]çš„å¯å‘ï¼Œæˆ‘ä»¬åœ¨æ—¶é—´è½´ä¸Šéƒ¨ç½²äº†æ•´å—çš„å·ç§¯ç»“æ„ï¼Œç”¨æ¥æ•è·äº¤é€šæµçš„åŠ¨æ€æ—¶é—´ç‰¹å¾ã€‚è¿™ä¸ªç‰¹æ®Šçš„è®¾è®¡å¯ä»¥è®©å¹¶è¡Œè€Œä¸”å¯æ§çš„è®­ç»ƒè¿‡ç¨‹é€šè¿‡å¤šå±‚å·ç§¯ç»“æ„å½¢æˆå±‚æ¬¡è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;å¦‚å›¾2å³ä¾§æ‰€ç¤ºï¼Œæ—¶é—´å·ç§¯å±‚åŒ…å«äº†ä¸€ä¸ªä¸€ç»´å·ç§¯ï¼Œæ ¸çš„å®½åº¦ä¸º$K_t$ï¼Œä¹‹åæ¥äº†ä¸€ä¸ªé—¨æ§çº¿æ€§å•å…ƒ(GLU)ä½œä¸ºæ¿€æ´»ã€‚å¯¹äºå›¾$\mathcal{G}$ä¸­çš„æ¯ä¸ªé¡¶ç‚¹ï¼Œæ—¶é—´å·ç§¯å¯¹è¾“å…¥å…ƒç´ çš„$K_t$ä¸ªé‚»å±…è¿›è¡Œæ“ä½œï¼Œå¯¼è‡´æ¯æ¬¡å°†åºåˆ—é•¿åº¦ç¼©çŸ­$K_t-1$ã€‚å› æ­¤ï¼Œæ¯ä¸ªé¡¶ç‚¹çš„æ—¶é—´å·ç§¯çš„è¾“å…¥å¯ä»¥è¢«çœ‹åšæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º$M$çš„åºåˆ—ï¼Œæœ‰ç€$C_i$ä¸ªé€šé“ï¼Œè®°ä½œ$Y \in \mathbb{R}^{M \times C_i}$ã€‚å·ç§¯æ ¸$\Gamma \in \mathbf{R}^{K_t \times C_i \times 2C_o}$æ˜¯è¢«è®¾è®¡ä¸ºæ˜ å°„$Y$åˆ°ä¸€ä¸ªå•ä¸ªçš„è¾“å‡º$[P Q] \in \mathbb{R}^{(M-K_t+1) \times (2C_o)}$($P$, $Q$æ˜¯é€šé“æ•°çš„ä¸€åŠ)ã€‚ä½œä¸ºç»“æœï¼Œæ—¶é—´é—¨æ§å·ç§¯å¯ä»¥å®šä¹‰ä¸ºï¼š&lt;/p&gt;
$$
\Gamma \ast\_ \tau Y = P \otimes \sigma (Q) \in \mathbb{R}^{(M-K\_t+1) \times C\_o}
$$&lt;p&gt;å…¶ä¸­ï¼Œ$P$, $Q$åˆ†åˆ«æ˜¯GLUçš„è¾“å…¥é—¨ï¼Œ$\otimes$è¡¨ç¤ºå“ˆè¾¾ç›ç§¯ï¼Œsigmoidé—¨$\sigma(Q)$æ§åˆ¶å½“å‰çŠ¶æ€çš„å“ªä¸ªè¾“å…¥$P$å¯¹äºå‘ç°æ—¶é—´åºåˆ—ä¸­çš„ç»„æˆç»“æ„å’ŒåŠ¨æ€æ–¹å·®æ˜¯ç›¸å…³çš„ã€‚éçº¿æ€§é—¨é€šè¿‡å †å æ—¶é—´å±‚å¯¹æŒ–æ˜è¾“å…¥ä¹Ÿæœ‰è´¡çŒ®ã€‚é™¤æ­¤ä»¥å¤–ï¼Œåœ¨å †å æ—¶é—´å·ç§¯å±‚æ—¶ï¼Œå®ç°äº†æ®‹å·®è¿æ¥ã€‚ç›¸ä¼¼åœ°ï¼Œé€šè¿‡åœ¨æ¯ä¸ªèŠ‚ç‚¹$\mathcal{Y_i} \in \mathbb{R}^{M \times C_i}$(æ¯”å¦‚ç›‘æµ‹ç«™)ä¸Šéƒ½ä½¿ç”¨åŒæ ·çš„å·ç§¯æ ¸$\Gamma$ï¼Œæ—¶é—´å·ç§¯å°±å¯ä»¥æ³›åŒ–è‡³3Då˜é‡ä¸Šï¼Œè®°ä½œ$\Gamma \ast_\tau \mathcal{Y}$ï¼Œå…¶ä¸­$\mathcal{Y} \in \mathbb{R}^{M \times n \times C_i}$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿™é‡Œæˆ‘ä¹‹å‰è®¤ä¸ºæ®‹å·®æ˜¯ç”¨äº† padding çš„ï¼Œå…¶å®ä¸æ˜¯ï¼Œçœ‹äº†ä½œè€…çš„ä»£ç åå‘ç°ä½œè€…æ˜¯ç”¨äº†ä¸€åŠæ•°é‡çš„å·ç§¯æ ¸å®Œæˆå·ç§¯ï¼Œè¿™æ ·å°±å’Œ P çš„ç»´åº¦ä¸€è‡´äº†ï¼Œç„¶åç›´æ¥å’Œ P ç›¸åŠ ï¼Œç„¶åä¸ sigmoid æ¿€æ´»åçš„å€¼è¿›è¡Œç‚¹å¯¹ç‚¹çš„ç›¸ä¹˜ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id="æ—¶ç©ºå·ç§¯å—"&gt;æ—¶ç©ºå·ç§¯å—
&lt;/h2&gt;&lt;p&gt;ä¸ºäº†åŒæ—¶ä»ç©ºé—´å’Œæ—¶é—´é¢†åŸŸèåˆç‰¹å¾ï¼Œæ—¶ç©ºå·ç§¯å—(ST-Conv block)çš„æ„å»ºæ˜¯ä¸ºäº†åŒæ—¶å¤„ç†å›¾ç»“æ„çš„æ—¶é—´åºåˆ—çš„ã€‚å¦‚å›¾2ï¼ˆä¸­ï¼‰æ‰€ç¤ºï¼Œbottleneckç­–ç•¥çš„åº”ç”¨å½¢æˆäº†ä¸‰æ˜æ²»çš„ç»“æ„ï¼Œå…¶ä¸­å«æœ‰ä¸¤ä¸ªæ—¶é—´é—¨æ§å·ç§¯å±‚ï¼Œåˆ†åˆ«åœ¨ä¸Šä¸‹ä¸¤å±‚ï¼Œä¸€ä¸ªç©ºé—´å›¾å·ç§¯å±‚å¡«å……ä¸­é—´çš„éƒ¨åˆ†ã€‚ç©ºé—´å·ç§¯å±‚å¯¼è‡´çš„é€šé“æ•°$C$çš„å‡å°ä¿ƒä½¿äº†å‚æ•°çš„å‡å°‘ï¼Œå¹¶ä¸”å‡å°‘äº†è®­ç»ƒçš„æ—¶é—´å¼€é”€ã€‚é™¤æ­¤ä»¥å¤–ï¼Œæ¯ä¸ªæ—¶ç©ºå—éƒ½ä½¿ç”¨äº†å±‚å½’ä¸€åŒ–æ¥æŠ‘åˆ¶è¿‡æ‹Ÿåˆã€‚&lt;/p&gt;
&lt;p&gt;ST-Convå—çš„è¾“å…¥å’Œè¾“å‡ºéƒ½æ˜¯3Då¼ é‡ã€‚å¯¹äºå—$l$çš„è¾“å…¥$v^l \in \mathbb{R}^{M \times n \times C^l}$ï¼Œè¾“å‡º$v^{l+1} \in \mathbb{R}^{(M-2(K_t-1)) \times n \times C^{l+1}}$é€šè¿‡ä»¥ä¸‹å¼å­è®¡ç®—å¾—åˆ°ï¼š&lt;/p&gt;
$$
v^{l+1} = \Gamma^l\_1 \ast\_\tau \rm ReLU(\Theta^l \ast\_{\mathcal{G}}(\Gamma^l\_0 \ast\_\tau v^l))
$$&lt;p&gt;å…¶ä¸­$\Gamma^l_0$ï¼Œ$\Gamma^l_1$æ˜¯å—$l$çš„ä¸Šä¸‹ä¸¤ä¸ªæ—¶é—´å±‚ï¼›$\Theta^l$æ˜¯å›¾å·ç§¯è°±æ ¸ï¼›$\rm ReLU(Â·)$è¡¨ç¤ºReLUæ¿€æ´»å‡½æ•°ã€‚æˆ‘ä»¬åœ¨å †å ä¸¤ä¸ªST-Convå—åï¼ŒåŠ äº†ä¸€ä¸ªé¢å¤–çš„æ—¶é—´å·ç§¯å’Œå…¨è¿æ¥å±‚ä½œä¸ºæœ€åçš„è¾“å‡ºå±‚ï¼ˆå›¾2å·¦ä¾§ï¼‰ã€‚æ—¶é—´å·ç§¯å±‚å°†æœ€åä¸€ä¸ªST-Convå—çš„è¾“å‡ºæ˜ å°„åˆ°ä¸€ä¸ªæœ€ç»ˆçš„å•æ­¥é¢„æµ‹ä¸Šã€‚ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä»æ¨¡å‹è·å¾—ä¸€ä¸ªæœ€åçš„è¾“å‡º$Z \in \mathbb{R}^{n \times c}$ï¼Œé€šè¿‡ä¸€ä¸ªè·¨$c$ä¸ªé€šé“çš„çº¿æ€§å˜æ¢$\hat{v} = Zw+b$æ¥é¢„æµ‹$n$ä¸ªèŠ‚ç‚¹çš„é€Ÿåº¦ï¼Œå…¶ä¸­$w \in \mathbb{R}^c$æ˜¯æƒé‡å‘é‡,$b$æ˜¯åç½®ã€‚å¯¹äº¤é€šé¢„æµ‹çš„STGCNçš„æŸå¤±å‡½æ•°å¯ä»¥å†™æˆï¼š&lt;/p&gt;
$$
L(\hat{v}; W\_\theta) = \sum\_t \Vert \hat{v}(v\_{t-M+1, ..., v\_t, W\_\theta}) - v\_{t+1} \Vert^2
$$&lt;p&gt;å…¶ä¸­ï¼Œ$W_\theta$æ˜¯æ¨¡å‹ä¸­æ‰€æœ‰çš„è®­ç»ƒå‚æ•°; $v_{t+1}$æ˜¯ground truthï¼Œ$\hat{v}(Â·)$è¡¨ç¤ºæ¨¡å‹çš„é¢„æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬çš„STGCNçš„ä¸»è¦ç‰¹å¾ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;STGCNæ˜¯å¤„ç†ç»“æ„åŒ–çš„æ—¶é—´åºåˆ—çš„é€šç”¨æ¡†æ¶ï¼Œä¸ä»…å¯ä»¥è§£å†³äº¤é€šç½‘ç»œå»ºæ¨¡ï¼Œè¿˜å¯ä»¥åº”ç”¨åˆ°å…¶ä»–çš„æ—¶ç©ºåºåˆ—å­¦ä¹ çš„æŒ‘æˆ˜ä¸­ï¼Œæ¯”å¦‚ç¤¾äº¤ç½‘ç»œå’Œæ¨èç³»ç»Ÿã€‚&lt;/li&gt;
&lt;li&gt;æ—¶ç©ºå—èåˆäº†å›¾å·ç§¯å’Œé—¨æ§æ—¶é—´å·ç§¯ï¼Œå¯ä»¥åŒæ—¶æŠ½å–æœ‰ç”¨çš„ç©ºé—´ä¿¡æ¯ï¼Œæ•è·æœ¬è´¨ä¸Šçš„æ—¶é—´ç‰¹å¾ã€‚&lt;/li&gt;
&lt;li&gt;æ¨¡å‹å®Œå…¨ç”±å·ç§¯å±‚ç»„æˆï¼Œå› æ­¤å¯ä»¥åœ¨è¾“å…¥åºåˆ—ä¸Šå¹¶è¡Œè¿ç®—ï¼Œç©ºé—´åŸŸä¸­å‚æ•°å°‘æ˜“äºè®­ç»ƒã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™ä¸ªç»æµçš„æ¶æ„å¯ä»¥ä½¿æ¨¡å‹æ›´é«˜æ•ˆçš„å¤„ç†å¤§è§„æ¨¡çš„ç½‘ç»œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="å®éªŒ"&gt;å®éªŒ
&lt;/h1&gt;&lt;h2 id="æ•°æ®é›†æè¿°"&gt;æ•°æ®é›†æè¿°
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬åœ¨ä¸¤ä¸ªçœŸå®çš„æ•°æ®é›†ä¸ŠéªŒè¯äº†æ¨¡å‹ï¼Œåˆ†åˆ«æ˜¯&lt;strong&gt;BJER4&lt;/strong&gt;å’Œ&lt;strong&gt;PeMSD7&lt;/strong&gt;ï¼Œç”±åŒ—äº¬å¸‚äº¤å§”å’ŒåŠ åˆ©ç¦å°¼äºšè¿è¾“éƒ¨æä¾›ã€‚æ¯ä¸ªæ•°æ®é›†åŒ…å«äº†äº¤é€šè§‚æµ‹æ•°æ®çš„å…³é”®å±æ€§å’Œå¯¹åº”æ—¶é—´çš„åœ°å›¾ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;BJER4&lt;/strong&gt;æ˜¯é€šè¿‡double-loop detectorè·å–çš„ä¸œå››ç¯å‘¨è¾¹çš„æ•°æ®ã€‚æˆ‘ä»¬çš„å®éªŒä¸­æœ‰12æ¡é“è·¯ã€‚äº¤é€šæ•°æ®æ¯äº”åˆ†é’Ÿèšåˆä¸€æ¬¡ã€‚æ—¶é—´æ˜¯ä»2014å¹´çš„7æœˆ1æ—¥åˆ°8æœˆ31æ—¥ï¼Œä¸å«å‘¨æœ«ã€‚æˆ‘ä»¬é€‰å–äº†ç¬¬ä¸€ä¸ªæœˆçš„è½¦é€Ÿé€Ÿåº¦è®°å½•ä½œä¸ºè®­ç»ƒé›†ï¼Œå‰©ä¸‹çš„åˆ†åˆ«åšéªŒè¯å’Œæµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;PeMSD7&lt;/strong&gt;æ˜¯Caltrans Performance Measurement System(PeMS)é€šè¿‡è¶…è¿‡39000ä¸ªç›‘æµ‹ç«™å®æ—¶è·å–çš„æ•°æ®ï¼Œè¿™äº›ç›‘æµ‹ç«™åˆ†å¸ƒåœ¨åŠ å·é«˜é€Ÿå…¬è·¯ç³»ç»Ÿä¸»è¦çš„éƒ½å¸‚éƒ¨åˆ†[Chen &lt;em&gt;et al&lt;/em&gt;., 2001]ã€‚æ•°æ®æ˜¯30ç§’çš„æ•°æ®æ ·æœ¬èšåˆæˆ5åˆ†é’Ÿä¸€æ¬¡çš„æ•°æ®ã€‚æˆ‘ä»¬åœ¨åŠ å·çš„District 7éšæœºé€‰å–äº†ä¸€ä¸ªå°çš„å’Œä¸€ä¸ªå¤§çš„èŒƒå›´ä½œä¸ºæ•°æ®æºï¼Œåˆ†åˆ«æœ‰228å’Œ1026ä¸ªç›‘æµ‹ç«™ï¼Œåˆ†åˆ«å‘½åä¸ºPeMSD7(S)å’ŒPeMSD7(L)ï¼ˆå¦‚å›¾3å·¦ä¾§æ‰€ç¤ºï¼‰ã€‚PeMSD7æ•°æ®é›†çš„æ—¶é—´èŒƒå›´æ˜¯2012å¹´äº”æœˆå’Œå…­æœˆçš„å‘¨æœ«ã€‚æˆ‘ä»¬ä½¿ç”¨åŒæ ·çš„åŸåˆ™å¯¹æ•°æ®è¿›è¡Œäº†è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„åˆ’åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/spatio-temporal-graph-convolutional-networks-a-deep-learning-framework-for-traffic/Fig3.PNG"
loading="lazy"
alt="Fig1"
&gt;&lt;/p&gt;
&lt;h2 id="æ•°æ®é¢„å¤„ç†"&gt;æ•°æ®é¢„å¤„ç†
&lt;/h2&gt;&lt;p&gt;ä¸¤ä¸ªæ•°æ®é›†çš„é—´éš”è®¾å®šä¸º5åˆ†é’Ÿã€‚å› æ­¤ï¼Œè·¯ç½‘ä¸­çš„æ¯ä¸ªé¡¶ç‚¹æ¯å¤©å°±æœ‰288ä¸ªæ•°æ®ç‚¹ã€‚æ•°æ®æ¸…ç†åä½¿ç”¨äº†çº¿æ€§æ’å€¼çš„æ–¹æ³•æ¥å¡«è¡¥ç¼ºå¤±å€¼ã€‚é€šè¿‡æ ¸å¯¹ç›¸å…³æ€§ï¼Œæ¯æ¡è·¯çš„æ–¹å‘å’ŒOD(origin-destination)ç‚¹ï¼Œç¯è·¯ç³»ç»Ÿå¯ä»¥è¢«æ•°å€¼åŒ–æˆä¸€ä¸ªæœ‰å‘å›¾ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨PeMSD7ï¼Œè·¯ç½‘çš„é‚»æ¥çŸ©é˜µé€šè¿‡äº¤é€šç½‘ç»œä¸­çš„ç›‘æµ‹ç«™çš„è·ç¦»æ¥è®¡ç®—ã€‚å¸¦æƒé‚»æ¥çŸ©é˜µ$W$é€šè¿‡ä»¥ä¸‹å…¬å¼è®¡ç®—ï¼š&lt;/p&gt;
$$
w\_{ij} = \begin{cases}
\exp{(-\frac{d^2\_{ij}}{\sigma^2})}&amp;,i \neq j \ \rm and \exp{(-\frac{d^2\_{ij}}{\sigma^2}) \geq \epsilon} \\
0&amp;, \rm otherwise
\end{cases}
$$&lt;p&gt;å…¶ä¸­$w_{ij}$æ˜¯è¾¹çš„æƒé‡ï¼Œé€šè¿‡$d_{ij}$å¾—åˆ°ï¼Œä¹Ÿå°±æ˜¯$i$å’Œ$j$ä¹‹é—´çš„è·ç¦»ã€‚$\sigma^2$å’Œ$\epsilon$æ˜¯æ¥æ§åˆ¶çŸ©é˜µ$W$çš„åˆ†å¸ƒå’Œç¨€ç–æ€§çš„é˜ˆå€¼ï¼Œæˆ‘ä»¬ç”¨äº†10å’Œ0.5ã€‚$W$çš„å¯è§†åŒ–åœ¨å›¾3çš„å³ä¾§ã€‚&lt;/p&gt;
&lt;h1 id="ä»£ç "&gt;ä»£ç 
&lt;/h1&gt;&lt;p&gt;&lt;a class="link" href="https://github.com/VeritasYin/STGCN_IJCAI-18" target="_blank" rel="noopener"
&gt;ä½œè€…ä»£ç &lt;/a&gt;ï¼Œè¿™ä¸ªæ˜¯ä½œè€…æä¾›çš„ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://github.com/Davidham3/STGCN" target="_blank" rel="noopener"
&gt;ä»“åº“åœ°å€&lt;/a&gt;ï¼Œæˆ‘æŒ‰ç…§è®ºæ–‡ç»“åˆä½œè€…çš„ä»£ç è¿›è¡Œäº†å¤ç°ä¸ä¿®æ­£ã€‚&lt;/p&gt;</description></item><item><title>Spatial Temporal Graph Convolutional Networks for Skeleton-Based Action Recognition</title><link>https://davidham3.github.io/blog/p/spatial-temporal-graph-convolutional-networks-for-skeleton-based-action-recognition/</link><pubDate>Wed, 18 Apr 2018 10:43:36 +0000</pubDate><guid>https://davidham3.github.io/blog/p/spatial-temporal-graph-convolutional-networks-for-skeleton-based-action-recognition/</guid><description>&lt;p&gt;AAAI 2018ï¼Œä»¥äººä½“å…³èŠ‚ä¸ºå›¾çš„é¡¶ç‚¹ï¼Œæ„å»ºç©ºé—´ä¸Šçš„å›¾ï¼Œç„¶åé€šè¿‡æ—¶é—´ä¸Šçš„å…³ç³»ï¼Œè¿æ¥è¿ç»­å¸§ä¸Šç›¸åŒçš„å…³èŠ‚ï¼Œæ„æˆä¸€ä¸ªä¸‰ç»´çš„æ—¶ç©ºå›¾ã€‚é’ˆå¯¹æ¯ä¸ªé¡¶ç‚¹ï¼Œå¯¹å…¶é‚»å±…è¿›è¡Œå­é›†åˆ’åˆ†ï¼Œæ¯ä¸ªå­é›†ä¹˜ä»¥å¯¹åº”çš„æƒé‡å‘é‡ï¼Œå¾—åˆ°æ—¶ç©ºå›¾ä¸Šçš„å·ç§¯å®šä¹‰ã€‚å®ç°æ—¶ä½¿ç”¨Kipf &amp;amp; Welling 2017çš„æ–¹æ³•å®ç°ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1801.07455" target="_blank" rel="noopener"
&gt;Spatial Temporal Graph Convolutional Networks for Skeleton-Based Action Recognition&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="æ‘˜è¦"&gt;æ‘˜è¦
&lt;/h1&gt;&lt;p&gt;äººä½“éª¨éª¼çš„åŠ¨æ€ä¼ é€’äº†ç”¨äºäººä½“åŠ¨ä½œè¯†åˆ«çš„å¾ˆå¤šä¿¡æ¯ã€‚ä¼ ç»Ÿæ–¹æ³•éœ€è¦æ‰‹å·¥å’Œéå†è§„åˆ™ï¼Œå¯¼è‡´è¡¨ç°åŠ›çš„é™åˆ¶å’Œæ³›åŒ–çš„å›°éš¾ã€‚æˆ‘ä»¬æå‡ºäº†åŠ¨æ€éª¨éª¼è¯†åˆ«çš„æ–°æ¨¡å‹ï¼ŒSTGCNï¼Œå¯ä»¥ä»æ•°æ®ä¸­è‡ªåŠ¨å­¦ä¹ æ—¶ç©ºæ¨¡å¼ã€‚è¿™å¥—ç†è®ºæœ‰å¾ˆå¼ºçš„è¡¨è¾¾èƒ½åŠ›ä¸æ³›åŒ–èƒ½åŠ›ã€‚åœ¨ä¸¤ä¸ªå¤§å‹æ•°æ®é›†Kineticså’ŒNTU-RGBDä¸Šæ¯”ä¸»æµæ–¹æ³•è¡¨ç°çš„æ›´å¥½ã€‚&lt;/p&gt;
&lt;h1 id="1-å¼•è¨€"&gt;1 å¼•è¨€
&lt;/h1&gt;&lt;p&gt;åŠ¨ä½œè¯†åˆ«åœ¨è§†é¢‘ç†è§£ä¸­å¾ˆæœ‰ç”¨ã€‚ä¸€èˆ¬ï¼Œä»å¤šä¸ªè§’åº¦è¯†åˆ«äººä½“åŠ¨ä½œï¼Œå¦‚å¤–è¡¨ã€æ™¯æ·±ã€å…‰æºã€éª¨éª¼ã€‚å¯¹éª¨éª¼å»ºæ¨¡å—åˆ°çš„å…³æ³¨è¾ƒå¤–è¡¨å’Œå…‰æºè¾ƒå°‘ï¼Œæˆ‘ä»¬ç³»ç»Ÿçš„ç ”ç©¶äº†è¿™ä¸ªæ¨¡æ€ï¼Œç›®çš„æ˜¯ç ”å‘å‡ºä¸€ä¸ªæœ‰æ•ˆçš„å¯¹åŠ¨æ€éª¨éª¼å»ºæ¨¡çš„æ–¹æ³•ï¼ŒæœåŠ¡äºåŠ¨ä½œè¯†åˆ«ã€‚&lt;/p&gt;
&lt;p&gt;åŠ¨æ€éª¨éª¼æ¨¡æ€å¾ˆè‡ªç„¶åœ°è¡¨ç¤ºæˆäººä½“å…³èŠ‚çš„æ—¶é—´åºåˆ—ï¼Œä»¥2Dæˆ–3Dåæ ‡çš„å½¢å¼ã€‚äººä½“åŠ¨ä½œå¯ä»¥é€šè¿‡åˆ†æç§»åŠ¨è§„å¾‹æ¥è¯†åˆ«ã€‚æ—©æœŸçš„å·¥ä½œåªç”¨æ¯å¸§çš„å…³èŠ‚åæ ‡ç”Ÿæˆç‰¹å¾å‘é‡ï¼Œç„¶åä½¿ç”¨ç©ºé—´åˆ†æï¼ˆWang et al., 2012; Fernando et al., 2015ï¼‰ã€‚è¿™äº›æ–¹æ³•èƒ½åŠ›å—é™çš„åŸå› æ˜¯ä»–ä»¬æ²¡æœ‰æŒ–æ˜å…³èŠ‚ä¹‹é—´çš„ç©ºé—´ä¿¡æ¯ï¼Œä½†æ˜¯è¿™äº›ä¿¡æ¯å¯¹äºç†è§£äººä½“åŠ¨ä½œæ¥è¯´å¾ˆå…³é”®ã€‚æœ€è¿‘ï¼Œæ–°çš„æ–¹æ³•å°è¯•åˆ©ç”¨å…³èŠ‚é—´çš„è‡ªç„¶è¿æ¥å…³ç³»(Shahroudy et al., 2016; Du, Wang, and Wang 2015)ã€‚è¿™äº›æ–¹æ³•éƒ½æœ‰æå‡ï¼Œè¡¨æ˜äº†è¿æ¥çš„é‡è¦æ€§ã€‚ç„¶è€Œï¼Œå¾ˆå¤šæ˜¾å­˜çš„æ–¹æ³•ä¾èµ–æ‰‹å·¥çš„éƒ¨åˆ†æˆ–æ˜¯åˆ†æç©ºé—´æ¨¡å¼çš„è§„åˆ™ã€‚ç»“æœå¯¼è‡´é’ˆå¯¹ç‰¹å®šé—®é¢˜è®¾è®¡çš„æ¨¡å‹ä¸èƒ½æ³›åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è·¨è¶Šè¿™äº›é™åˆ¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–°çš„æ–¹æ³•èƒ½è‡ªåŠ¨æ•è·å…³èŠ‚çš„ç©ºé—´é…ç½®ä¸æ—¶é—´åŠ¨æ€æ€§ä¸­åµŒå…¥çš„æ¨¡å¼ã€‚è¿™å°±æ˜¯æ·±åº¦ç¥ç»ç½‘ç»œçš„ä¼˜åŠ¿äº†ã€‚ç”±äºéª¨éª¼æ˜¯å›¾ç»“æ„ï¼Œä¸æ˜¯2Dæˆ–3Dç½‘æ ¼ï¼Œå› æ­¤ä¼ ç»Ÿçš„CNNä¸è¡Œï¼Œæœ€è¿‘GCNå·²ç»æˆåŠŸçš„åº”ç”¨åœ¨äº†ä¸€äº›åº”ç”¨ä¸Šï¼Œå¦‚å›¾åƒåˆ†ç±»(Bruna et al., 2014)ï¼Œæ–‡æ¡£åˆ†ç±»(Defferrard, Bresson, and Vandergheynst 2016)ï¼Œè¿˜æœ‰åŠç›‘ç£å­¦ä¹ (Kipf and Welling 2017)ã€‚ç„¶è€Œï¼Œè¿™äº›å·¥ä½œéƒ½å‡è®¾ä¸€ä¸ªå›ºå®šçš„å›¾ä½œä¸ºè¾“å…¥ã€‚GCNçš„åº”ç”¨åœ¨å¤§å°ºåº¦çš„æ•°æ®é›†ä¸Šå¯¹åŠ¨æ€å›¾å»ºæ¨¡ï¼Œå¦‚äººä½“éª¨éª¼åºåˆ—è¿˜æ²¡æœ‰è¢«æŒ–æ˜è¿‡ã€‚&lt;/p&gt;
&lt;p&gt;![Fig1]](/blog/images/spatial-temporal-graph-convolutional-networks-for-skeleton-based-action-recognition/Fig1.JPG)
æˆ‘ä»¬å°†å›¾ç½‘ç»œæ‰©å±•åˆ°ä¸€ä¸ªæ—¶ç©ºå›¾æ¨¡å‹æ¥å¯¹éª¨éª¼åºåˆ—è¿›è¡Œè¡¨ç¤ºåè¯†åˆ«åŠ¨ä½œã€‚å›¾1æ‰€ç¤ºï¼Œè¿™ä¸ªæ¨¡å‹åŸºäºä¸€ä¸ªéª¨éª¼å›¾åºåˆ—ï¼Œæ¯ä¸ªé¡¶ç‚¹è¡¨ç¤ºäººä½“çš„ä¸€ä¸ªå…³èŠ‚ã€‚æœ‰ä¸¤ç§ç±»å‹çš„è¾¹ï¼Œç©ºé—´è¾¹ï¼Œè¿æ¥å…³èŠ‚ï¼Œæ—¶é—´è¾¹è¿æ¥è¿ç»­æ—¶é—´çš„åŒä¸€å…³èŠ‚ã€‚æ„å»ºåœ¨ä¸Šé¢çš„æ—¶ç©ºå·ç§¯å¯ä»¥åŒæ—¶é›†æˆæ—¶é—´å’Œç©ºé—´ä¸Šçš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ST-GCNçš„å±‚æ¬¡æœ¬è´¨æ¶ˆé™¤äº†æ‰‹å·¥å’Œéå†éƒ¨åˆ†ã€‚ä¸ä»…æœ‰æ›´å¼ºçš„è¡¨è¾¾èƒ½åŠ›å’Œæ›´å¥½çš„è¡¨ç°ï¼Œä¹Ÿæ›´ç®€å•çš„æ³›åŒ–åˆ°å…¶ä»–ç¯å¢ƒä¸­ã€‚åœ¨åŸºç¡€çš„GCNå…¬å¼åŸºç¡€ä¸Šï¼Œå—åˆ°å›¾åƒæ¨¡å‹çš„å¯å‘ï¼Œæˆ‘ä»¬è¿˜æå‡ºäº†è®¾è®¡å›¾å·ç§¯æ ¸æ–°çš„ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„å·¥ä½œæœ‰ä¸‰ç‚¹è´¡çŒ®ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æå‡ºäº†ST-GCNï¼Œå¯¹åŠ¨æ€éª¨éª¼å»ºæ¨¡çš„åŸºäºå›¾ç»“æ„çš„æ¨¡å‹ï¼Œç¬¬ä¸€ä¸ªåº”ç”¨åŸºäºå›¾çš„ç¥ç»ç½‘ç»œåˆ°è¿™ä¸ªä»»åŠ¡ä¸Šã€‚&lt;/li&gt;
&lt;li&gt;è®¾è®¡ST-GCNçš„å·ç§¯æ ¸æ—¶æå‡ºäº†å‡ ä¸ªåŸåˆ™ä½¿å¾—åœ¨éª¨éª¼å»ºæ¨¡æ—¶æ»¡è¶³ç‰¹å®šçš„éœ€æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ä¸¤ä¸ªå¤§å°ºåº¦æ•°æ®é›†ä¸Šï¼Œæˆ‘ä»¬æå‡ºçš„æ¨¡å‹æ•ˆæœæ¯”ä¹‹å‰çš„æ‰‹å·¥å’Œéå†è§„åˆ™çš„æ–¹æ³•å¼ºã€‚
ä»£ç å’Œæ¨¡å‹ï¼šhttps://github.com/yysijie/st-gcn&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="2-ç›¸å…³å·¥ä½œ"&gt;2 ç›¸å…³å·¥ä½œ
&lt;/h1&gt;&lt;p&gt;ä¸¤ç±»æ–¹æ³•&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è°±æ–¹æ³•ï¼Œè°±åˆ†æä¸­è€ƒè™‘å›¾å·ç§¯çš„å±€éƒ¨å½¢å¼(Henaff, Bruna, and LeCun 2015; Duvenaud et al., 2015; Li et al., 2016; Kipf and Welling., 2017)&lt;/li&gt;
&lt;li&gt;ç©ºé—´æ–¹æ³•ï¼Œå·ç§¯æ ¸ç›´æ¥åœ¨é¡¶ç‚¹å’Œä»–ä»¬çš„é‚»å±…ä¸Šåšå·ç§¯(Bruna et al., 2014; Niepert, Ahmed, and Kutzkov 2016)ã€‚æˆ‘ä»¬çš„å·¥ä½œfollowäº†ç¬¬äºŒç§æ–¹æ³•ã€‚æˆ‘ä»¬åœ¨ç©ºé—´é¢†åŸŸæ„å»ºCNNæ»¤æ³¢å™¨ï¼Œé€šè¿‡é™åˆ¶æ»¤æ³¢å™¨åˆ°æ¯ä¸ªé¡¶ç‚¹çš„ä¸€é˜¶é‚»å±…ä¸Šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;éª¨éª¼åŠ¨ä½œè¯†åˆ«&lt;/strong&gt; æ–¹æ³•å¯åˆ†ä¸ºæ‰‹å·¥æ–¹æ³•å’Œæ·±åº¦å­¦ä¹ æ–¹æ³•ã€‚ç¬¬ä¸€ç±»æ˜¯æ‰‹å·¥è®¾è®¡ç‰¹å¾æ•è·å…³èŠ‚ç§»åŠ¨çš„åŠ¨æ€æ€§ã€‚å¯ä»¥æ˜¯å…³èŠ‚è½¨è¿¹çš„åæ–¹å·®çŸ©é˜µ(Hussein et al., 2013)ï¼Œå…³èŠ‚çš„ç›¸å¯¹ä½ç½®(Wang et al., 2012)ï¼Œèº«ä½“éƒ¨åˆ†çš„æ—‹è½¬å’Œå˜æ¢(Vemulapalli, Arrate, and Chellappa 2014)ã€‚æ·±åº¦å­¦ä¹ çš„å·¥ä½œä½¿ç”¨RNN(Shahroudy et al., 2016; Zhu et al. 2016; Liu et al. 2016; Zhang, Liu and Xiao 2017)å’Œæ—¶é—´CNN(Li et al. 2017; Ke et al. 2017; Kim and Reiter 2017)ç”¨ç«¯åˆ°ç«¯çš„æ–¹å¼å­¦ä¹ åŠ¨ä½œè¯†åˆ«æ¨¡å‹ã€‚è¿™äº›æ–¹æ³•ä¸­å¾ˆå¤šå¼ºè°ƒäº†å°†å…³èŠ‚ä¸èº«ä½“éƒ¨åˆ†å»ºæ¨¡çš„é‡è¦æ€§ã€‚ä½†è¿™äº›éƒ½éœ€è¦é¢†åŸŸçŸ¥è¯†ã€‚æˆ‘ä»¬çš„ST-GCNæ˜¯ç¬¬ä¸€ä¸ªå°†å›¾å·ç§¯ç”¨åœ¨éª¨éª¼åŠ¨ä½œè¯†åˆ«ä¸Šçš„ã€‚ä¸åŒäºä¹‹å‰çš„æ–¹æ³•ï¼Œæˆ‘ä»¬çš„æ–¹æ³•å¯ä»¥åˆ©ç”¨å›¾å·ç§¯çš„å±€éƒ¨æ€§å’Œæ—¶é—´åŠ¨æ€æ€§å­¦ä¹ èº«ä½“éƒ¨åˆ†çš„ä¿¡æ¯ã€‚é€šè¿‡æ¶ˆé™¤æ‰‹å·¥éƒ¨åˆ†æ ‡æ³¨çš„éœ€è¦ï¼Œæ¨¡å‹æ›´å®¹æ˜“å»è®¾è®¡ï¼Œè€Œä¸”èƒ½å­¦åˆ°æ›´å¥½çš„åŠ¨ä½œè¡¨ç¤ºã€‚&lt;/p&gt;
&lt;h1 id="3-spatial-temporal-graph-convnet"&gt;3 Spatial Temporal Graph ConvNet
&lt;/h1&gt;&lt;p&gt;äººä»¬åœ¨æ´»åŠ¨çš„æ—¶å€™ï¼Œå…³èŠ‚åªåœ¨ä¸€ä¸ªèŒƒå›´å†…æ´»åŠ¨ï¼Œè¿™ä¸ªéƒ¨åˆ†ç§°ä¸ºbody partsã€‚å·²æœ‰çš„æ–¹æ³•å·²ç»è¯æ˜äº†å°†body partsèå…¥åˆ°æ¨¡å‹ä¸­æ˜¯å¾ˆæœ‰æ•ˆçš„(Shahroudy et al., 2016; Liu et al., 2016; Zhang, Liu and Xiao 2017)ã€‚æˆ‘ä»¬è®¤ä¸ºæå‡å¾ˆæœ‰å¯èƒ½æ˜¯å› ä¸ºpartså°†å…³èŠ‚è½¨è¿¹é™åˆ¶åœ¨äº†å±€éƒ¨åŒºåŸŸä¸­ã€‚åƒç‰©ä½“è¯†åˆ«è¿™æ ·çš„ä»»åŠ¡ï¼Œå±‚æ¬¡è¡¨ç¤ºå’Œå±€éƒ¨æ€§é€šå¸¸æ˜¯å·ç§¯ç¥ç»ç½‘ç»œæ½œåœ¨å°±å¯ä»¥è·å¾—çš„(Krizhevsky, Sutskever, and Hinton 2012)ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨åˆ†é…çš„ã€‚è¿™ä½¿å¾—æˆ‘ä»¬åœ¨åŸºäºéª¨éª¼çš„åŠ¨ä½œè¯†åˆ«ä¸­å¼•å…¥CNNçš„æ€§è´¨ã€‚ç»“æœå°±æ˜¯ST-GCNæ¨¡å‹çš„å°è¯•ã€‚&lt;/p&gt;
&lt;h2 id="31-pipeline-overview"&gt;3.1 Pipeline Overview
&lt;/h2&gt;&lt;p&gt;éª¨éª¼æ•°æ®é€šè¿‡åŠ¨ä½œæ•æ‰è®¾å¤‡å’ŒåŠ¨ä½œä¼°è®¡ç®—æ³•å³å¯ä»è§†é¢‘ä¸­è·å¾—ã€‚é€šå¸¸æ•°æ®æ˜¯ä¸€ç³»åˆ—çš„å¸§ï¼Œæ¯å¸§æœ‰ä¸€ç»„å…³èŠ‚åæ ‡ã€‚ç»™å®šèº«ä½“å…³èŠ‚2Dæˆ–3Dçš„åæ ‡åºåˆ—ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªæ—¶ç©ºå›¾ï¼Œå…³èŠ‚ä½œå›¾çš„é¡¶ç‚¹ï¼Œèº«ä½“ç»“æ„æˆ–æ—¶é—´ä½œè¾¹ã€‚ST-GCNçš„è¾“å…¥å› æ­¤å°±æ˜¯å…³èŠ‚åæ ‡å‘é‡ã€‚å¯ä»¥è®¤ä¸ºè¿™æ˜¯åŸºäºå›¾ç‰‡çš„CNNçš„è¿‘ä¼¼ï¼Œåè€…çš„è¾“å…¥æ˜¯2Dç½‘æ ¼ä¸­çš„åƒç´ å‘é‡ã€‚å¤šå±‚æ—¶ç©ºå›¾å·ç§¯æ“ä½œåŠ åˆ°è¾“å…¥ä¸Šä¼šç”Ÿæˆæ›´é«˜ç­‰çº§çš„ç‰¹å¾ã€‚ç„¶åä½¿ç”¨softmaxåšè´¹é›·ã€‚æ•´ä¸ªæ¨¡å‹ä»¥ç«¯åˆ°ç«¯çš„æ–¹å¼è¿›è¡Œè®­ç»ƒã€‚&lt;/p&gt;
&lt;h2 id="32-éª¨éª¼å›¾æ„å»º"&gt;3.2 éª¨éª¼å›¾æ„å»º
&lt;/h2&gt;&lt;p&gt;éª¨éª¼åºåˆ—é€šå¸¸è¡¨ç¤ºæˆæ¯å¸§éƒ½æ˜¯äººä½“å…³èŠ‚çš„2Dæˆ–3Dåæ ‡ã€‚ä¹‹å‰ä½¿ç”¨å·ç§¯æ¥åšéª¨éª¼åŠ¨ä½œè¯†åˆ«çš„å·¥ä½œ(Kim and Reiter 2017)æ‹¼æ¥äº†åœ¨æ¯å¸§æ‹¼æ¥äº†æ‰€æœ‰å…³èŠ‚çš„åæ ‡å‘é‡æ¥ç”Ÿæˆä¸€ä¸ªç‰¹å¾å‘é‡ã€‚æˆ‘ä»¬çš„å·¥ä½œä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨æ—¶ç©ºå›¾æ¥ç”Ÿæˆéª¨éª¼åºåˆ—çš„å±‚æ¬¡è¡¨ç¤ºã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬æ„å»ºäº†æ— å‘æ—¶ç©ºå›¾$G = (V, E)$ï¼Œ$N$ä¸ªå…³èŠ‚ï¼Œ$T$å¸§æè¿°èº«ä½“å†…å’Œå¸§ä¸å¸§ä¹‹é—´çš„è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;é¡¶ç‚¹é›†$V = \lbrace v_{ti} \mid t = 1, &amp;hellip;, T, i = 1, &amp;hellip;, N \rbrace$åŒ…å«äº†éª¨éª¼åºåˆ—ä¸­æ‰€æœ‰çš„å…³èŠ‚ã€‚ST-GCNçš„è¾“å…¥ï¼Œæ¯ä¸ªé¡¶ç‚¹çš„ç‰¹å¾å‘é‡$F(v_{ti})$ç”±ç¬¬$t$å¸§çš„ç¬¬$i$ä¸ªå…³èŠ‚çš„åæ ‡å‘é‡ç»„æˆï¼Œè¿˜æœ‰estimation confidenceã€‚æ„å»ºæ—¶ç©ºå›¾åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥ï¼Œä¸€å¸§å†…çš„å…³èŠ‚é€šè¿‡äººä½“ç»“æ„è¿æ¥ï¼Œå¦‚å›¾1æ‰€ç¤ºã€‚ç„¶åæ¯ä¸ªå…³èŠ‚åœ¨è¿ç»­çš„å¸§ä¹‹é—´è¿æ¥èµ·æ¥ã€‚è¿™é‡Œä¸éœ€è¦äººå·¥å¹²é¢„ã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒKineticsæ•°æ®é›†ï¼Œæˆ‘ä»¬ä½¿ç”¨OpenPose toolbox(Cao et al., 2017b)2DåŠ¨ä½œä¼°è®¡ç”Ÿæˆäº†18ä¸ªå…³èŠ‚ï¼Œè€ŒNTU-RGB+D(Shahroudy et al., 2016)æ•°æ®é›†ä¸Šä½¿ç”¨3Då…³èŠ‚è¿½è¸ªäº§ç”Ÿäº†25ä¸ªå…³èŠ‚ã€‚ST-GCNå¯ä»¥åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹å·¥ä½œï¼Œå¹¶ä¸”æä¾›ä¸€è‡´çš„ä¼˜è¶Šæ€§èƒ½ã€‚å›¾1å°±æ˜¯æ—¶ç©ºå›¾çš„ä¾‹å­ã€‚
ä¸¥æ ¼æ¥è¯´ï¼Œè¾¹é›†$E$ç”±ä¸¤ä¸ªå­é›†ç»„æˆï¼Œç¬¬ä¸€ä¸ªå­é›†æè¿°äº†æ¯å¸§éª¨éª¼å†…çš„è¿æ¥ï¼Œè¡¨ç¤ºä¸º$E_S = \lbrace v_{ti}v_{tj} \mid (i, j) \in H \rbrace$ï¼Œ$H$æ˜¯è‡ªç„¶è¿æ¥çš„å…³èŠ‚çš„ç»“åˆã€‚ç¬¬äºŒä¸ªå­é›†æ˜¯è¿ç»­å¸§çš„ç›¸åŒå…³èŠ‚$E_F = \lbrace v_{ti} v_{(t+1)i} \rbrace$ï¼Œå› æ­¤$E_F$ä¸­æ‰€æœ‰çš„è¾¹å¯¹äºå…³èŠ‚$i$æ¥è¯´è¡¨ç¤ºçš„æ˜¯å®ƒéšæ—¶é—´å˜åŒ–çš„è½¨è¿¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/spatial-temporal-graph-convolutional-networks-for-skeleton-based-action-recognition/Fig2.JPG"
loading="lazy"
alt="Fig2"
&gt;&lt;/p&gt;
&lt;h2 id="33-ç©ºé—´å›¾å·ç§¯ç¥ç»ç½‘ç»œ"&gt;3.3 ç©ºé—´å›¾å·ç§¯ç¥ç»ç½‘ç»œ
&lt;/h2&gt;&lt;p&gt;æ—¶é—´$\tau$ä¸Šï¼Œ$N$ä¸ªå…³èŠ‚é¡¶ç‚¹$V_t$ï¼Œéª¨éª¼è¾¹é›†$E_S(\tau) = \lbrace v_{ti} v_{tj} \mid t = \tau, (i, j) \in H \rbrace$ã€‚å›¾åƒä¸Šçš„2Då·ç§¯çš„è¾“å…¥å’Œè¾“å‡ºéƒ½ä¸Š2Dç½‘æ ¼ï¼Œstrideè®¾ä¸º1æ—¶ï¼ŒåŠ ä¸Šé€‚å½“çš„paddingï¼Œè¾“å‡ºçš„sizeå°±å¯ä»¥ä¸å˜ã€‚ç»™å®šä¸€ä¸ª$K \times K$çš„å·ç§¯æ“ä½œï¼Œè¾“å…¥ç‰¹å¾$f_{in}$çš„channelsæ•°æ˜¯$c$ã€‚åœ¨ç©ºé—´ä½ç½®$\mathbf{x}$çš„å•ä¸ªé€šé“çš„è¾“å‡ºå€¼å¯ä»¥å†™æˆï¼š&lt;/p&gt;
$$\tag{1}
f\_{out}(\mathbf{x}) = \sum^K\_{h=1} \sum^K\_{w=1} f\_{in}(\mathbf{p}(\mathbf{x}, h, w)) \cdot \mathbf{w}(h, w)
$$&lt;p&gt;&lt;strong&gt;é‡‡æ ·å‡½æ•°&lt;/strong&gt;$\mathbf{p} : Z^2 \times Z^2 \rightarrow Z^2$å¯¹$\mathbf{x}$çš„é‚»å±…éå†ã€‚åœ¨å›¾åƒå·ç§¯ä¸­ï¼Œä¹Ÿå¯è¡¨ç¤ºæˆ$\mathbf{p}(\mathbf{x}, h, w) = \mathbf{x} + \mathbf{p}&amp;rsquo;(h, w)$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æƒé‡å‡½æ•°&lt;/strong&gt;$\mathbf{w}: Z^2 \rightarrow \mathbb{R}^c$æä¾›äº†ä¸€ä¸ª$c$ç»´çš„æƒé‡å‘é‡ï¼Œä¸é‡‡å‡ºçš„$c$ç»´è¾“å…¥ç‰¹å¾å‘é‡åšå†…ç§¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æƒé‡å‡½æ•°ä¸è¾“å…¥ä½ç½®$\mathbf{x}$æ— å…³ã€‚å› æ­¤æ»¤æ³¢å™¨æƒé‡åœ¨è¾“å…¥å›¾åƒä¸Šæ˜¯å…±äº«çš„ã€‚å›¾åƒé¢†åŸŸæ ‡å‡†çš„å·ç§¯é€šè¿‡å¯¹$\mathbf{p}(x)$ä¸­çš„ä¸¾è¡Œè¿›è¡Œç¼–ç å¾—åˆ°ã€‚æ›´å¤šè§£é‡Šå’Œåº”ç”¨å¯ä»¥çœ‹(Dai et al., 2017)ã€‚&lt;/p&gt;
&lt;p&gt;å›¾ä¸Šçš„å·ç§¯æ˜¯å¯¹ä¸Šå¼çš„æ‰©å±•ï¼Œè¾“å…¥æ˜¯ç©ºé—´å›¾$V_t$ã€‚feature map $f^t_{in}: V_t \rightarrow R^c$åœ¨å›¾ä¸Šçš„æ¯ä¸ªé¡¶ç‚¹æœ‰ä¸€ä¸ªå‘é‡ã€‚ä¸‹ä¸€æ­¥æ‰©å±•æ˜¯é‡æ–°å®šä¹‰é‡‡æ ·å‡½æ•°$\mathbf{p}$ï¼Œæƒé‡å‡½æ•°æ˜¯$\mathbf{w}$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é‡‡æ ·å‡½æ•°.&lt;/strong&gt; å›¾åƒä¸­ï¼Œé‡‡æ ·å‡½æ•°$\mathbf{p}(h, w)$å®šä¹‰ä¸ºä¸­å¿ƒä½ç½®$\mathbf{x}$çš„é‚»å±…åƒç´ ã€‚å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ç›¸ä¼¼çš„é‡‡æ ·å‡½æ•°åœ¨é¡¶ç‚¹$v_{ti}$çš„é‚»å±…é›†åˆä¸Š$B(v_{ti}) = \lbrace v_{tj} \mid d(v_{tj}, v_{ti} \leq D \rbrace)$ã€‚è¿™é‡Œ$d(v_{tj}, t_{ti})$è¡¨ç¤ºä»$v_{tj}$åˆ°$v_{ti}$çš„ä»»æ„ä¸€æ¡è·¯å¾„ä¸­æœ€çŸ­çš„ã€‚å› æ­¤é‡‡æ ·å‡½æ•°$\mathbf{p}: B(v_{ti}) \rightarrow V$å¯ä»¥å†™æˆï¼š
&lt;/p&gt;
$$\tag{2}
\mathbf{p}(v\_{ti}, v\_{tj}) = v\_{tj}.
$$&lt;p&gt;
æˆ‘ä»¬ä»¤$D = 1$ï¼Œä¹Ÿå°±æ˜¯å…³èŠ‚çš„ä¸€é˜¶é‚»å±…ã€‚æ›´é«˜é˜¶çš„é‚»å±…ä¼šåœ¨æœªæ¥çš„å·¥ä½œä¸­å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æƒé‡å‡½æ•°.&lt;/strong&gt; å¯¹æ¯”é‡‡æ ·å‡½æ•°ï¼Œæƒé‡å‡½æ•°åœ¨å®šä¹‰æ—¶æ›´å·§å¦™ã€‚åœ¨2Då·ç§¯ï¼Œç½‘æ ¼å‹è‡ªç„¶å°±å›´åœ¨äº†ä¸­å¿ƒä½ç½®å‘¨å›´ã€‚æ‰€ä»¥åƒç´ ä¸å…¶é‚»å±…æœ‰ä¸ªå›ºå®šçš„é¡ºåºã€‚æƒé‡å‡½æ•°æ ¹æ®ç©ºé—´é¡ºåºé€šè¿‡å¯¹ç»´åº¦ä¸º$(c, K, K)$çš„tensoræ·»åŠ ç´¢å¼•æ¥å®ç°ã€‚å¯¹äºåƒæˆ‘ä»¬æ„é€ çš„è¿™ç§å›¾ï¼Œæ²¡æœ‰è¿™ç§æš—å«çš„å…³ç³»ã€‚è§£å†³æ–¹æ³•ç”±(Niepert, Ahmed, and Kuzkov 2016)æå‡ºï¼Œé¡ºåºæ˜¯é€šè¿‡æ ¹èŠ‚ç‚¹å‘¨å›´çš„é‚»å±…èŠ‚ç‚¹çš„æ ‡è®°é¡ºåºç¡®å®šã€‚æˆ‘ä»¬æ ¹æ®è¿™ä¸ªæ€è·¯æ„å»ºæˆ‘ä»¬çš„æƒé‡å‡½æ•°ã€‚ä¸å†ç»™æ¯ä¸ªé¡¶ç‚¹ä¸€ä¸ªæ ‡ç­¾ï¼Œæˆ‘ä»¬é€šè¿‡å°†é¡¶ç‚¹$v_{ti}$çš„é‚»å±…é›†åˆ$B(v_{ti})$åˆ’åˆ†ä¸º$K$ä¸ªå­é›†æ¥ç®€åŒ–è¿‡ç¨‹ï¼Œå…¶ä¸­æ¯ä¸ªå­é›†éƒ½æœ‰ä¸€ä¸ªæ•°å€¼å‹æ ‡ç­¾ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ˜ å°„$l_{ti}:B(v_{ti}) \rightarrow \lbrace 0,&amp;hellip;,K-1 \rbrace$ï¼Œè¿™ä¸ªæ˜ å°„å°†é¡¶ç‚¹æ˜ å°„åˆ°å®ƒçš„é‚»å±…å­é›†çš„æ ‡ç­¾ä¸Šã€‚æƒé‡å‡½æ•°$\mathbf{w}(v_{ti}, v_{tj}):B(v_{ti}) \rightarrow R^c$å¯ä»¥é€šè¿‡å¯¹ç»´åº¦ä¸º$(c, K)$çš„tensoræ ‡è®°ç´¢å¼•æˆ–
&lt;/p&gt;
$$\tag{3}
\mathbf{w}(v\_{ti}, v\_{tj}) = \mathbf{w}'(l\_{ti}(v\_{tj})).
$$&lt;p&gt;
æˆ‘ä»¬ä¼šåœ¨3.4èŠ‚è®¨è®ºåˆ†åŒºç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç©ºé—´å›¾å·ç§¯.&lt;/strong&gt; æˆ‘ä»¬å¯ä»¥å°†å¼1é‡å†™ä¸ºï¼š
&lt;/p&gt;
$$\tag{4}
f\_{out}(v\_{ti}) = \sum\_{v\_{tj} \in B(v\_{ti})} \frac{1}{Z\_{ti}(v\_{tj})} f\_{in}(\mathbf{p}(v\_{ti}, v\_{tj})) \cdot \mathbf{w}(v\_{ti}, v\_{tj}),
$$&lt;p&gt;
å…¶ä¸­å½’ä¸€åŒ–é¡¹$Z_{ti}(v_{tj}) = \vert \lbrace v_{tk} \mid l_{ti}(v_{tk}) = l_{ti}(t_{tj}) \rbrace \vert$ç­‰äºå¯¹åº”å­é›†çš„åŸºæ•°ã€‚è¿™é¡¹è¢«åŠ å…¥æ˜¯æ¥å¹³è¡¡ä¸åŒå­é›†å¯¹è¾“å‡ºçš„è´¡çŒ®ã€‚
æ›¿æ¢å¼2å’Œå¼3ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°
&lt;/p&gt;
$$\tag{5}
f\_{out}(v\_{ti}) = \sum\_{v\_{tj} \in B(v\_{ti})} \frac{1}{Z\_{ti}(v\_{tj})} f\_{in}(v\_{tj}) \cdot \mathbf{w}(l\_{ti}(v\_{tj})).
$$&lt;p&gt;
è¿™ä¸ªå…¬å¼ä¸æ ‡å‡†2Då·ç§¯ç›¸ä¼¼å¦‚æœæˆ‘ä»¬å°†å›¾ç‰‡çœ‹ä½œ2Dç½‘æ ¼ã€‚æ¯”å¦‚ï¼Œ$3 \times 3$å·ç§¯æ ¸çš„ä¸­å¿ƒåƒç´ å‘¨å›´æœ‰9ä¸ªåƒç´ ã€‚é‚»å±…é›†åˆåº”è¢«åˆ†ä¸º9ä¸ªå­é›†ï¼Œæ¯ä¸ªå­é›†æœ‰ä¸€ä¸ªåƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ—¶ç©ºå»ºæ¨¡.&lt;/strong&gt; é€šè¿‡å¯¹ç©ºé—´å›¾CNNçš„æ„å»ºï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥å¯¹éª¨éª¼åºåˆ—çš„æ—¶ç©ºåŠ¨æ€æ€§è¿›è¡Œå»ºæ¨¡ã€‚å›æƒ³å›¾çš„æ„å»ºï¼Œå›¾çš„æ—¶é—´æ–¹é¢æ˜¯é€šè¿‡åœ¨è¿ç»­å¸§ä¸Šè¿æ¥ç›¸åŒçš„å…³èŠ‚è¿›è¡Œæ„å»ºçš„ã€‚è¿™å¯ä»¥è®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå¾ˆç®€å•çš„ç­–ç•¥æ¥æ‰©å±•ç©ºé—´å›¾CNNåˆ°æ—¶ç©ºé¢†åŸŸã€‚æˆ‘ä»¬æ‰©å±•é‚»å±…çš„æ¦‚å¿µåˆ°åŒ…å«ç©ºé—´è¿æ¥çš„å…³èŠ‚ï¼š
&lt;/p&gt;
$$\tag{6}
B(v\_{ti}) = \lbrace v\_{qj} \mid d(v\_{tj}, v\_{ti}) \leq K, \vert q - t \vert \leq \lfloor \Gamma / 2 \rfloor \rbrace.
$$&lt;p&gt;
å‚æ•°$\Gamma$æ§åˆ¶è¢«åŒ…å«åˆ°é‚»å±…å›¾çš„æ—¶é—´èŒƒå›´ï¼Œå› æ­¤è¢«ç§°ä¸ºç©ºé—´æ ¸çš„å¤§å°ã€‚æˆ‘ä»¬éœ€è¦é‡‡æ ·å‡½æ•°æ¥å®Œæˆæ—¶ç©ºå›¾ä¸Šçš„å·ç§¯æ“ä½œï¼Œä¸åªæœ‰ç©ºé—´å·ç§¯ä¸€æ ·ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æƒé‡å‡½æ•°ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯æ˜ å°„$l_{ST}$ã€‚å› ä¸ºç©ºé—´è½´æ˜¯æœ‰åºçš„ï¼Œæˆ‘ä»¬ç›´æ¥ä¿®æ”¹æ ¹èŠ‚ç‚¹ä¸º$v_{ti}$çš„æ—¶ç©ºé‚»å±…çš„æ ‡ç­¾æ˜ å°„$l_{ST}$ä¸ºï¼š
&lt;/p&gt;
$$\tag{7}
l\_{ST}(v\_{qj}) = l\_{ti}(v\_{tj}) + (q - t + \lfloor \Gamma / 2 \rfloor) \times K,
$$&lt;p&gt;
å…¶ä¸­$l_{ti}(v_{tj})$æ˜¯$v_{ti}$çš„å•å¸§çš„æ ‡ç­¾æ˜ å°„ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªå®šä¹‰åœ¨æ—¶ç©ºå›¾ä¸Šçš„å·ç§¯æ“ä½œã€‚&lt;/p&gt;
&lt;h2 id="34-åˆ†åŒºç­–ç•¥"&gt;3.4 åˆ†åŒºç­–ç•¥
&lt;/h2&gt;&lt;p&gt;è®¾è®¡ä¸€ä¸ªå®ç°æ ‡è®°æ˜ å°„çš„åˆ†åŒºç­–ç•¥å¾ˆé‡è¦ã€‚æˆ‘ä»¬æ¢ç´¢äº†å‡ ç§åˆ†åŒºç­–ç•¥ã€‚ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬åªè®¨è®ºå•å¸§æƒ…å†µä¸‹ï¼Œå› ä¸ºä½¿ç”¨å¼7å°±å¯ä»¥å¾ˆè‡ªç„¶çš„æ‰©å±•åˆ°æ—¶ç©ºé¢†åŸŸã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Uni-labeling.&lt;/strong&gt; æœ€ç®€å•çš„åˆ†åŒºç­–ç•¥ï¼Œæ‰€æœ‰çš„é‚»å±…éƒ½æ˜¯ä¸€ä¸ªé›†åˆã€‚æ¯ä¸ªé‚»å±…é¡¶ç‚¹çš„ç‰¹å¾å‘é‡ä¼šå’ŒåŒä¸€ä¸ªæƒé‡å‘é‡åšå†…ç§¯ã€‚äº‹å®ä¸Šï¼Œè¿™ä¸ªç­–ç•¥å’ŒKipf and Welling 2017æå‡ºçš„ä¼ æ’­è§„åˆ™å¾ˆåƒã€‚ä½†æ˜¯æœ‰ä¸ªå¾ˆæ˜æ˜¾çš„ç¼ºé™·ï¼Œåœ¨å•å¸§çš„æ—¶å€™ä½¿ç”¨è¿™ç§åˆ†åŒºç­–ç•¥å°±æ˜¯å°†é‚»å±…çš„ç‰¹å¾å‘é‡å–å¹³å‡åå’Œæƒé‡å‘é‡åšå†…ç§¯ã€‚åœ¨éª¨éª¼åºåˆ—åˆ†æä¸­ä¸èƒ½è¾¾åˆ°æœ€ä¼˜ï¼Œå› ä¸ºä¸¢å¤±äº†å±€éƒ¨æ€§è´¨ã€‚$K = 1$ï¼Œ$l_{ti}(v_{tj}) = 0, \forall{i, j} \in V$ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Distance partitioning.&lt;/strong&gt; å¦ä¸€ä¸ªè‡ªç„¶çš„åˆ†åŒºç­–ç•¥æ˜¯æ ¹æ®é¡¶ç‚¹åˆ°æ ¹èŠ‚ç‚¹$v_{ti}$çš„è·ç¦»$d(\cdot, v_{ti})$æ¥åˆ’åˆ†ã€‚æˆ‘ä»¬è®¾ç½®$D = 1$ï¼Œé‚»å±…é›†åˆä¼šè¢«åˆ†æˆä¸¤ä¸ªå­é›†ï¼Œ$d = 0$è¡¨ç¤ºæ ¹èŠ‚ç‚¹å­é›†ï¼Œå…¶ä»–çš„é¡¶ç‚¹æ˜¯åœ¨$d = 1$çš„å­é›†ä¸­ã€‚å› æ­¤æˆ‘ä»¬æœ‰ä¸¤ä¸ªä¸åŒçš„æƒé‡å‘é‡ï¼Œä»–ä»¬èƒ½å¯¹å±€éƒ¨æ€§è´¨è¿›è¡Œå»ºæ¨¡ï¼Œæ¯”å¦‚å…³èŠ‚é—´çš„ç›¸å¯¹å˜æ¢ã€‚$K = 2$ï¼Œ$l_{ti}(v_{tj}) = d(v_{tj}, v_{ti})$&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Spatial configuration partitioning.&lt;/strong&gt; å› ä¸ºéª¨éª¼æ˜¯ç©ºé—´å±€éƒ¨åŒ–çš„ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ®Šçš„ç©ºé—´é…ç½®æ¥åˆ†åŒºã€‚æˆ‘ä»¬å°†é‚»å±…é›†åˆåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š1. æ ¹èŠ‚ç‚¹è‡ªå·±ï¼›2. ä¸­å¿ƒç»„ï¼šç›¸æ¯”æ ¹èŠ‚ç‚¹æ›´æ¥è¿‘éª¨éª¼é‡å¿ƒçš„é‚»å±…é¡¶ç‚¹ï¼›3. å…¶ä»–çš„é¡¶ç‚¹ã€‚å…¶ä¸­ï¼Œä¸­å¿ƒå®šä¹‰ä¸ºä¸€å¸§ä¸­éª¨éª¼æ‰€æœ‰çš„å…³èŠ‚çš„åæ ‡çš„å¹³å‡å€¼ã€‚è¿™æ˜¯å—åˆ°äººä½“çš„è¿åŠ¨å¤§ä½“åˆ†ä¸ºåŒå¿ƒè¿åŠ¨å’Œåå¿ƒè¿åŠ¨ä¸¤ç±»ã€‚
&lt;/p&gt;
$$\tag{8}
l\_{ti}(v\_tj) = \begin{cases}
0 &amp; if r\_j = r\_i \\
1 &amp; if r\_j &lt; r\_i \\
2 &amp; if r\_j &gt; r\_i \end{cases}
$$&lt;p&gt;
å…¶ä¸­ï¼Œ$r_i$æ˜¯è®­ç»ƒé›†ä¸­æ‰€æœ‰å¸§çš„é‡å¿ƒåˆ°å…³èŠ‚$i$çš„å¹³å‡è·ç¦»ã€‚
åˆ†åŒºç­–ç•¥å¦‚å›¾3æ‰€ç¤ºã€‚æˆ‘ä»¬é€šè¿‡å®éªŒæ£€éªŒæå‡ºçš„åˆ†åŒºç­–ç•¥åœ¨éª¨éª¼åŠ¨ä½œè¯†åˆ«ä¸Šçš„è¡¨ç°ã€‚åˆ†åŒºç­–ç•¥è¶Šé«˜çº§ï¼Œæ•ˆæœåº”è¯¥æ˜¯è¶Šå¥½çš„ã€‚
&lt;img src="https://davidham3.github.io/blog/images/spatial-temporal-graph-convolutional-networks-for-skeleton-based-action-recognition/Fig3.JPG"
loading="lazy"
alt="Fig3"
&gt;&lt;/p&gt;
&lt;h2 id="35-learnable-edge-importance-weighting"&gt;3.5 Learnable edge importance weighting
&lt;/h2&gt;&lt;p&gt;å°½ç®¡äººåœ¨åšåŠ¨ä½œæ—¶å…³èŠ‚æ˜¯ä»¥ç»„çš„å½¢å¼ç§»åŠ¨çš„ï¼Œä½†ä¸€ä¸ªå…³èŠ‚å¯ä»¥å‡ºç°åœ¨èº«ä½“çš„å¤šä¸ªéƒ¨åˆ†ã€‚ç„¶è€Œï¼Œè¿™äº›è¡¨ç°åœ¨å»ºæ¨¡æ—¶åº”è¯¥æœ‰ä¸åŒçš„é‡è¦æ€§ã€‚æˆ‘ä»¬åœ¨æ¯ä¸ªæ—¶ç©ºå›¾å·ç§¯å±‚ä¸Šæ·»åŠ äº†ä¸€ä¸ªå¯å­¦ä¹ çš„mask$M$ã€‚è¿™ä¸ªmaskä¼šåŸºäº$E_S$ä¸­æ¯ä¸ªç©ºé—´å›¾è¾¹ä¸Šå¯å­¦ä¹ çš„é‡è¦æ€§æƒé‡æ¥è°ƒæ•´ä¸€ä¸ªé¡¶ç‚¹çš„ç‰¹å¾å¯¹å®ƒçš„é‚»å±…é¡¶ç‚¹çš„è´¡çŒ®ã€‚é€šè¿‡å®éªŒæˆ‘ä»¬å‘ç°å¢åŠ è¿™ä¸ªmaskå¯ä»¥æå‡ST-GCNçš„æ€§èƒ½ã€‚ä½¿ç”¨æ³¨æ„åŠ›æ˜ å°„åº”è¯¥ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œè¿™ä¸ªç•™åˆ°ä»¥åå†åšã€‚&lt;/p&gt;
&lt;h2 id="36-implementation-st-gcn"&gt;3.6 Implementation ST-GCN
&lt;/h2&gt;&lt;p&gt;å®ç°è¿™ä¸ªå›¾å·ç§¯ä¸åƒå®ç°2Dæˆ–3Då·ç§¯é‚£æ ·ç®€å•ã€‚æˆ‘ä»¬æä¾›äº†å®ç°ST-GCNçš„å…·ä½“ç»†èŠ‚ã€‚
æˆ‘ä»¬é‡‡ç”¨äº†Kipf &amp;amp; Welling 2017çš„ç›¸ä¼¼çš„å®ç°æ–¹å¼ã€‚å•å¸§å†…èº«ä½“å†…å…³èŠ‚çš„è¿æ¥è¡¨ç¤ºä¸ºä¸€ä¸ªé‚»æ¥çŸ©é˜µ$\rm{A}$ï¼Œå•ä½é˜µ$\rm{I}$è¡¨ç¤ºè‡ªè¿æ¥ã€‚åœ¨å•å¸§æƒ…å†µä¸‹ï¼ŒST-GCNä½¿ç”¨ç¬¬ä¸€ç§åˆ†åŒºç­–ç•¥æ—¶å¯ä»¥å®ç°ä¸ºï¼š
&lt;/p&gt;
$$\tag{9}
\rm
f\_{out} = \Lambda^{-\frac{1}{2}}(A + I) \Lambda^{-\frac{1}{2}} f\_{in}W,
$$&lt;p&gt;
å…¶ä¸­ï¼Œ$\Lambda^{ii} = \sum_j (A^{ij} + I^{ij})$ã€‚å¤šä¸ªè¾“å‡ºçš„æƒé‡å‘é‡å åœ¨ä¸€èµ·å½¢æˆäº†æƒé‡çŸ©é˜µ$\mathrm{W}$ã€‚å®é™…ä¸Šï¼Œåœ¨æ—¶ç©ºæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¾“å…¥çš„feature mapè¡¨ç¤ºä¸ºç»´åº¦ä¸º$(C, V, T)$çš„tensorã€‚å›¾å·ç§¯é€šè¿‡ä¸€ä¸ª$1 \times \Gamma$å®ç°ä¸€ä¸ªæ ‡å‡†çš„2Då·ç§¯ï¼Œå°†ç»“æœä¸å½’ä¸€åŒ–çš„é‚»æ¥çŸ©é˜µ$\rm \Lambda^{-\frac{1}{2}}(A + I)\Lambda^{-\frac{1}{2}}$åœ¨ç¬¬äºŒä¸ªç»´åº¦ä¸Šç›¸ä¹˜ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå¤šä¸ªå­é›†çš„åˆ†åŒºç­–ç•¥ï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡åˆ©ç”¨è¿™ç§å®ç°ã€‚ä½†æ³¨æ„ç°åœ¨é‚»æ¥çŸ©é˜µå·²ç»åˆ†è§£æˆäº†å‡ ä¸ªçŸ©é˜µ$A_j$ï¼Œå…¶ä¸­$\rm A + I = \sum_j A_j$ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨è·ç¦»åˆ†åŒºç­–ç•¥ä¸­ï¼Œ$\rm A_0 = I$ï¼Œ$\rm A_1 = A$ã€‚å¼9å˜å½¢ä¸º
&lt;/p&gt;
$$\tag{10}
\rm f\_{out} = \sum\_j \Lambda^{-\frac{1}{2}}\_j A\_j \Lambda^{\frac{1}{2}}\_j f\_{in} W\_j
$$&lt;p&gt;
å…¶ä¸­ï¼Œ$\rm \Lambda^{ii}_j = \sum_k (A^{ik}_j) + \alpha$ã€‚è¿™é‡Œæˆ‘ä»¬è®¾$\alpha = 0.001$é¿å…$\rm A_j$ä¸­æœ‰ç©ºè¡Œã€‚&lt;/p&gt;
&lt;p&gt;å®ç°å¯å­¦ä¹ çš„è¾¹é‡è¦æ€§æƒé‡å¾ˆç®€å•ã€‚å¯¹äºæ¯ä¸ªé‚»æ¥çŸ©é˜µï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªå¯å­¦ä¹ çš„æƒé‡çŸ©é˜µ$M$ï¼Œæ›¿æ¢å¼9ä¸­çš„$\rm A + I$å’Œå¼10ä¸­çš„$\rm A_j$ä¸­çš„$A_j$ä¸º$\rm (A + I) \otimes M$å’Œ$\rm A_j \otimes M$ã€‚è¿™é‡Œ$\otimes$è¡¨ç¤ºä¸¤ä¸ªçŸ©é˜µé—´çš„element-wise productã€‚mask$M$åˆå§‹åŒ–ä¸ºä¸€ä¸ªå…¨ä¸€çš„çŸ©é˜µã€‚&lt;/p&gt;</description></item><item><title>Identity Mappings in Deep Residual Networks</title><link>https://davidham3.github.io/blog/p/identity-mappings-in-deep-residual-networks/</link><pubDate>Thu, 08 Mar 2018 18:45:45 +0000</pubDate><guid>https://davidham3.github.io/blog/p/identity-mappings-in-deep-residual-networks/</guid><description>&lt;p&gt;ECCV 2016, ResNet v2, åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1603.05027" target="_blank" rel="noopener"
&gt;Identity Mappings in Deep Residual Networks&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="identity-mappings-in-deep-residual-networks"&gt;Identity Mappings in Deep Residual Networks
&lt;/h1&gt;&lt;h2 id="introduction"&gt;Introduction
&lt;/h2&gt;&lt;p&gt;Deep residual network (ResNets) consist of many stacked &amp;ldquo;Residual Units&amp;rdquo;. Each unit (Fig. 1(a)) can be expressed in a general form:
&lt;/p&gt;
$$y\_l = h(x\_l) + \mathcal{F}(x\_l, \mathcal{W\_l})$$&lt;p&gt;
&lt;/p&gt;
$$x\_{l+1}=f(y\_l)$$&lt;p&gt;
where $x_l$ and $x_{l+1}$ are input and output of the $l$-th unit, and $\mathcal{F}$ is a residual function.$h(x_l)=x_l$ is an identity mapping and $f$ is a ReLU function.
The central idea of ResNets is to learn the additive residual function $\mathcal{F}$ with respect to $h(x_l)$, with a key choice of using an identity mapping $h(x_l)=x_l$. This is realized by attaching an identity skip connection (&amp;ldquo;shortcut&amp;rdquo;).
In this paper, we analyze deep residual networks by focusing on creating a &amp;ldquo;direct&amp;rdquo; path for propagating information &amp;ndash; not only within a residual unit, but through the entire network. Our derivations reveal that &lt;em&gt;if both h(x_l) and f(y_l) are identity mappings, the signal could be directly&lt;/em&gt; propagated from one unit to any other units, in both forward and backward passes.
To understand the role of skip connections, we analyse and compare various types of $h(x_l)$. We find that the identity mapping $h(x_l) = x_l$ chosen in achieves the fastest error reduction and lowest training loss among all variants we investigated, whereas skip connections of scaling, gating, and $1 \times 1$ convolutions all lead to higher training loss and error. These experiments suggest that keeping a &amp;ldquo;clean&amp;rdquo; information path (indicated by the grey arrows in Fig. 1,2, and 4) is helpful for easing optimization.
&lt;img src="https://davidham3.github.io/blog/images/identity-mappings-in-deep-residual-networks/Fig1.PNG"
loading="lazy"
alt="Fig1"
&gt;
Figure 1. Left: (a) original Residual Unit in [1]; (b) proposed Residual Unit. The grey arrows indicate the easiest paths for the information to propagate, corresponding to the additive term &amp;ldquo;x_l&amp;rdquo; in Eqn.(4) (forward propagation) and the additive term &amp;ldquo;1&amp;rdquo; in Eqn.(5) (backward propagation). Right: training curves on CIFAR-10 of 1001-layer ResNets. Solid lines denote test error (y-axis on the right), and dashed lines denote training loss (y-axis on the left). The proposed unit makes ResNet-1001 easier to train.&lt;/p&gt;
&lt;p&gt;To construct an identity mapping $f(y_l)=y_l$, we view the activation functions (ReLU and BN) as &amp;ldquo;pre-activation&amp;rdquo; of the weight layers, in constrast to conventional wisdom of &amp;ldquo;post-activation&amp;rdquo;. This point of view leads to a new residual unit design, shown in (Fig. 1(b)). Based on this unit, we present competitive results on CIFAR-10/100 with a 1001-layer ResNet, which is much easier to train and generalizes better than the original ResNet in [1]. We further report improved results on ImageNet using a 200-layer ResNet, for which the counterpart of [1] starts to overfit. These results suggest that there is much room to exploit the dimension of &lt;em&gt;network depth&lt;/em&gt;, a key to the success of modern deep learning.&lt;/p&gt;
&lt;h2 id="analysis-of-deep-residual-networks"&gt;Analysis of Deep Residual Networks
&lt;/h2&gt;&lt;p&gt;The ResNets developed in [1] are &lt;em&gt;modularized&lt;/em&gt; architectures that stack building blocks of the same connecting shape. In this paper we call these blocks &amp;ldquo;Residual Units&amp;rdquo;. The original Residual Unit in [1] performs the following computation:
&lt;/p&gt;
$$y\_l = h(x\_l) + \mathcal{F}(x\_l, \mathcal{W-l})$$&lt;p&gt;
&lt;/p&gt;
$$x\_{l+1}=f(y\_l)$$&lt;p&gt;
Here $x_l$ is the input feature to the $l$-th Residual Unit. $\mathcal{W_l}=\lbrace W_{l,k} \mid 1 \le k \le K\rbrace$ is a set of weights (and biases) associated with the $l$-th Residual Unit, and $K$ is the number of layers in a Residual Unit ($K$ is 2 or 3 in [1]). $\mathcal{F}$ denotes the residual function, &lt;em&gt;e.g.&lt;/em&gt;, a stack of two $3 \times 3$ convolutional layers in [1]. The function $f$ is the operation after element-wise addition, and in [1] $f$ is ReLU. The function $h$ is set as an identity mapping: $h(x_l)=x_l$.
If $f$ is also an identity mapping: $x_{l+1} \equiv y_l$, we can put Eqn.(2) into Eqn.(1) and obtain:
&lt;/p&gt;
$$x\_{l+1}=x\_l+\mathcal{F}(x\_l, \mathcal{W\_l})$$&lt;p&gt;
Recursively $(x_{l+2}=x_{l+1} + \mathcal{F}(x_{l+1}, \mathcal{W_{l+1}}) = x_l + \mathcal{F}(x_l, \mathcal{W_l}) + \mathcal{F}(x_{l+1},\mathcal{W_{l+1}}), etc.)$ we will have:
&lt;/p&gt;
$$x\_L = x\_l + \sum\_{i=1}^{L-1}\mathcal{F}(x\_i, \mathcal{W\_i})$$&lt;p&gt;
for &lt;em&gt;any deeper unit&lt;/em&gt; $L$ and &lt;em&gt;any shallower unit&lt;/em&gt; $l$. Eqn.(4) exhibits some nice properties.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The feature $x_L$ of any deeper unit $L$ can be represented as the feature $x_l$ of any shallower unit $l$ plus a residual function in a form of $\sum_{i=1}^{L-1}\mathcal{F}$, indicating that the model is in a &lt;em&gt;residual&lt;/em&gt; fashion between any units $L$ and $l$.&lt;/li&gt;
&lt;li&gt;The feature $x_L = x_0 + \sum_{i=0}^{L-1}\mathcal{F}(x_i, \mathcal{W_i})$, of any deep unit $L$, is the &lt;em&gt;summation&lt;/em&gt; of the outputs of all preceding residual functions (plus $x_0$). This is in contrast to a &amp;ldquo;plain network&amp;rdquo; where a feature $x_L$ is a series of matrix-vector &lt;em&gt;products&lt;/em&gt;, say, $\prod_{i=0}^{L-1}W_ix_0$ (ignoring BN and ReLU).
Eqn.(4) also leads to nice backward propagation properties. Denoting the loss function as $\varepsilon$, from the chain rule of backpropagation [9] we have:
$$\frac{\partial{\varepsilon}}{\partial{x\_l}}=\frac{\partial{\varepsilon}}{\partial{x\_L}}\frac{\partial{x\_L}}{\partial{x\_l}}=\frac{\partial{\varepsilon}}{\partial{x\_L}}(1+\frac{\partial}{\partial{x\_l}}\sum\_{i=l}^{L-1}\mathcal{F}(x\_i, \mathcal{W\_i}))$$
Eqn.(5) indicates that the gradient $\frac{\partial{\varepsilon}}{\partial{x_i}}$ can be decomposed into two additive terms: a term of $\frac{\partial{\varepsilon}}{\partial{x_L}}$ that propagates information directly without concerning any weight layers, and another term of $\frac{\partial{\varepsilon}}{\partial{x_L}}(\frac{\partial}{\partial{x_l}}\sum_{i=l}^{L-1}\mathcal{F})$ that propagates through the weight layers. The additive term of $\frac{\partial{\varepsilon}}{\partial{x_L}}$ ensures that information is directly propagated back to &lt;em&gt;any shallower unit&lt;/em&gt; $l$. Eqn.(5) also suggests that it is unlikely for the gradient $\frac{\partial{\varepsilon}}{\partial{x_l}}$ to be canceled out for a mini-batch, because in general the term $\frac{\partial}{\partial{x_l}}\sum_{i=l}^{L-1}\mathcal{F}$ cannot be always -1 for all samples in a mini-batch. This implies that the gradient of a layer does not vanish even when the weights are arbitrarily small.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="on-the-importance-of-identity-skip-connections"&gt;On the Importance of Identity Skip Connections
&lt;/h2&gt;&lt;p&gt;Let&amp;rsquo;s consider a simple modification, $h(x_l)=\lambda_lx_l$, to break the identity shortcut:
&lt;/p&gt;
$$x\_{l+1}=\lambda\_lx\_l+\mathcal{F}(x\_l, \mathcal{W\_l})$$&lt;p&gt;
where $\lambda_l$ is a modulating scalar (for simplicity we still assume $f$ is identity).
Recursively applying this forumulation we obtain an equation similar to Eqn. (4): $x_L=(\prod_{i=l}^{L-1}\lambda_i)x_l+\sum_{i=1}^{L-1}(\prod_{j=i+1}^{L-1}\lambda_j)\mathcal{F}(x_i, \mathcal{W_i})$, or simply:
&lt;/p&gt;
$$x\_L = (\prod\_{i=l}^{L-1}\lambda\_i)x\_l+\sum\_{i=l}^{L-1}\hat{\mathcal{F}}(x\_i, \mathcal{W\_i})$$&lt;p&gt;
where the notation $\hat{\mathcal{F}}$ absorbs the scalars into the residual functions. Similar to Eqn.(5), we have backpropagation of the following form:
&lt;/p&gt;
$$\frac{\partial{\varepsilon}}{\partial{x\_l}}=\frac{\partial{\varepsilon}}{\partial{x\_L}}((\prod\_{i=l}^{L-1}\lambda\_i)+\frac{\partial}{\partial{x\_l}}\sum\_{i=l}^{L-1}\hat{\mathcal{F}}(x\_i, \mathcal{W\_i}))$$&lt;p&gt;
For an extremely deep network ($L$ is large), if $\lambda_i &amp;gt; 1$ for all $i$, this factor can be exponentially large; if $\lambda_i &amp;lt; 1$ for all $i$, this factor can be expoentially small and vanish, which blocks the backpropagated signal from the shortcur and forces it to flow through the weighted layers. This results in optimization difficuties as we show by experiments.
If the skip connection $h(x_l)$ represents more complicated transforms (such as gating and $1 \times 1$ convolutions), in Eqn.(8) the first term becomes $\prod_{i=l}^{L-1}h_i&amp;rsquo;$ where $h&amp;rsquo;$ is the derivative of $h$. This product may also impede information propagation and hamper the training procedure as witnessed in the following experiments.&lt;/p&gt;
&lt;h3 id="experiments-on-skip-connections"&gt;Experiments on skip Connections
&lt;/h3&gt;&lt;p&gt;We experiments with the 110-layer ResNet as presented in [1] on CIFAR-10. Though our above analysis is driven by identity $f$, the experiments in this section are all based on $f = ReLU$ as in [1]; we address identity $f$ in the next section. Our baseline ResNet-110 has 6.61% error on the test set. The comparisons of other variants (Fig.2 and Table 1) are summarized as follows:
&lt;strong&gt;Table 1.&lt;/strong&gt; Classification error on the CIFAR-10 test set using ResNet-110 [1], with different types of shortcut connections applied to all Residual Units. We report &amp;ldquo;fail&amp;rdquo; when the test error is higher than 20%.
&lt;img src="https://davidham3.github.io/blog/images/identity-mappings-in-deep-residual-networks/Table1.PNG"
loading="lazy"
alt="Table1"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Constant scaling&lt;/strong&gt;. We set $\lambda = 0.5$ for all shortcuts (Fig. 2(b)). We further study two cases of scaling $\mathcal{F}$:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$\mathcal{F}$ is not scaled;&lt;/li&gt;
&lt;li&gt;$\mathcal{F}$ is scaled by a constant scalar of $1-\lambda = 0.5$, which is similar to the highway gating [6,7] but with frozen gates. The former case does not converge well; the latter is able to converge, but the test error (Table 1, 12.35%) is substantially higher than the original ResNet-110. Fig 3(a) shows that the training error is higher than that of the original ResNet-110, suggesting that the optimization has difficulties when the shortcut signal is scaled down.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Exclusive gating&lt;/strong&gt;. Following the Highway Networks [6,7] that adopt a gating mechanism [5], we consider a gating function $g(x)=\sigma(W_gx+b_g)$ where a transform is represented by weights $W_g$ and biases $b_g$ followed by the sigmoid function $\sigma(x)=\frac{1}{1+e^{-x}}$. In a convolutional network $g(x)$ is realized by a $1 \times 1$ convolutional layer. The gating function modulates the signal by element-wise multiplication.
We investigate the &amp;ldquo;exclusive&amp;rdquo; gates as used in [6,7] &amp;ndash; the $\mathcal{F}$ path is scaled by $g(x)$ and the shortcut path is scaled by $1-g(x)$. See Fig 2(c). We find that the initialization of the biases $b_g$ is critical for training gated models, and following the guidelines in [6,7], we conduct hyper-parameter search on the initial value of $b_g$ in the range of 0 to -10 with a decrement step of -1 on the training set by cross-validation. The best value (-6 here) is then used for training on the training set, leading to a test result of 8.70% (Table 1), which still lags far behind the ResNet-110 baseline. Fig 3(b) shows the training curves. Table 1 also reports the results of using other initialized values, noting that the exclusive gating network does not converge to a good solution when $b_g$ is not appropriately initialized.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Shortcut-only gating&lt;/strong&gt;. In this case the function $\mathcal{F}$ is not scaled; only the shortcut path is gated by $1-g(x)$. See Fig 2(d). The initialized value of $b_g$ is still essential in this case. When the initialized $b_g$ is 0 (so initially the expectation of $1-g(x)$ is 0.5), the network converges to a poor result of 12.86% (Table 1). This is also caused by higher training error (Fig 3(c)).
When the initialized $b_g$ is very negatively biased (e.g., -6), the value of $1-g(x)$ is closer to 1 and the shortcut connection is nearly an identity mapping. Therefore, the result (6.91%, Table 1) is much closer to the ResNet-110 baseline.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;$1 \times 1$ convolutional shortcut&lt;/strong&gt;. Next we experiment with $1 \times 1$ convolutional shortcut connections that replace the identity. This option has been investigated in [1] (known as option C) on a 34-layer ResNet (16 Residual Units) and shows good results, suggesting that $1 \times 1$ shortcut connections could be useful. But we find that this is not the case when there are many Residual Units. The 110-layer ResNet has a poorer result (12.22%, Table 1) when using $1 \times 1$ convolutional shortcuts. Again, the training error becomes higher (Fig 3(d)). When stacking so many Residual Units (54 for ResNet-110), even the shortest path may still impede signal propagation. We witnessed similar phenomena on ImageNet with ResNet-101 when using $1 \times 1$ convolutional shortcuts.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Dropout shortcut&lt;/strong&gt;. Last we experiment with dropout [11] (at a ratio of 0.5) which we adopt on the output of the identity shortcut (Fig. 2(f)). The network fails to converge to a good solution. Dropout statistically imposes a scale of $\lambda $ with an expectation of 0.5 on the shortcut, and similar to constant scaling by 0.5, it impedes signal propagation.&lt;/p&gt;
&lt;h2 id="on-the-usage-of-activation-functions"&gt;On the Usage of Activation Functions
&lt;/h2&gt;&lt;p&gt;We want to make $f$ an identity mapping, which is done by re-arranging the activation function (ReLU and/or BN). The original Residual Unit in [1] has a shape in Fig.4(a) &amp;ndash; BN is used after each weight layer, and ReLU is adopted after BN expect that the last ReLU in a Residual Unit is after element-wise addition ($f=ReLU$). Fig.4(b-e) show the laternatives we investigated, explained as following.&lt;/p&gt;
&lt;h2 id="experiments-on-activation"&gt;Experiments on Activation
&lt;/h2&gt;&lt;p&gt;In this section we experiment with ResNet-110 and a 164-layer Bottlenect [1] architecture (denoted as ResNet-164). A bottleneck Residual Unit consist of a $1 \times 1$ layer for reducing dimension, a $3 \times 3$ layer, and a $1 \times 1$ layer for restoring dimension. As designed in [1], its computational complexity is similar to the two-$3 \times 3$ Residual Unit. More details are in the appendix. The baseline ResNet-164 has a competitive result of 5.93% on CIFAR-10 (Table 2).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;BN after addition&lt;/strong&gt;. Before turning $f$ into an identity mapping, we go the opposite way by adopting BN after addition (Fig. 4(b)). In this case $f$ involves BN and ReLU. The results become considerably worse than the baseline (Table 2). Unlike the original design, now the BN layer alters the signal that passes through the shortcut and impedes information propagation, as reflected by the difficulties on reducing training loss at the begining of training (Fib. 6 left).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ReLU before addition&lt;/strong&gt;. A naive choice of making $f$ into an identity mapping is to move the ReLU&lt;/p&gt;
&lt;h2 id="implementation"&gt;Implementation
&lt;/h2&gt;&lt;p&gt;ä½¿ç”¨mxnetå®ç°äº†ä¸€ç‰ˆ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt; 10
&lt;/span&gt;&lt;span class="lnt"&gt; 11
&lt;/span&gt;&lt;span class="lnt"&gt; 12
&lt;/span&gt;&lt;span class="lnt"&gt; 13
&lt;/span&gt;&lt;span class="lnt"&gt; 14
&lt;/span&gt;&lt;span class="lnt"&gt; 15
&lt;/span&gt;&lt;span class="lnt"&gt; 16
&lt;/span&gt;&lt;span class="lnt"&gt; 17
&lt;/span&gt;&lt;span class="lnt"&gt; 18
&lt;/span&gt;&lt;span class="lnt"&gt; 19
&lt;/span&gt;&lt;span class="lnt"&gt; 20
&lt;/span&gt;&lt;span class="lnt"&gt; 21
&lt;/span&gt;&lt;span class="lnt"&gt; 22
&lt;/span&gt;&lt;span class="lnt"&gt; 23
&lt;/span&gt;&lt;span class="lnt"&gt; 24
&lt;/span&gt;&lt;span class="lnt"&gt; 25
&lt;/span&gt;&lt;span class="lnt"&gt; 26
&lt;/span&gt;&lt;span class="lnt"&gt; 27
&lt;/span&gt;&lt;span class="lnt"&gt; 28
&lt;/span&gt;&lt;span class="lnt"&gt; 29
&lt;/span&gt;&lt;span class="lnt"&gt; 30
&lt;/span&gt;&lt;span class="lnt"&gt; 31
&lt;/span&gt;&lt;span class="lnt"&gt; 32
&lt;/span&gt;&lt;span class="lnt"&gt; 33
&lt;/span&gt;&lt;span class="lnt"&gt; 34
&lt;/span&gt;&lt;span class="lnt"&gt; 35
&lt;/span&gt;&lt;span class="lnt"&gt; 36
&lt;/span&gt;&lt;span class="lnt"&gt; 37
&lt;/span&gt;&lt;span class="lnt"&gt; 38
&lt;/span&gt;&lt;span class="lnt"&gt; 39
&lt;/span&gt;&lt;span class="lnt"&gt; 40
&lt;/span&gt;&lt;span class="lnt"&gt; 41
&lt;/span&gt;&lt;span class="lnt"&gt; 42
&lt;/span&gt;&lt;span class="lnt"&gt; 43
&lt;/span&gt;&lt;span class="lnt"&gt; 44
&lt;/span&gt;&lt;span class="lnt"&gt; 45
&lt;/span&gt;&lt;span class="lnt"&gt; 46
&lt;/span&gt;&lt;span class="lnt"&gt; 47
&lt;/span&gt;&lt;span class="lnt"&gt; 48
&lt;/span&gt;&lt;span class="lnt"&gt; 49
&lt;/span&gt;&lt;span class="lnt"&gt; 50
&lt;/span&gt;&lt;span class="lnt"&gt; 51
&lt;/span&gt;&lt;span class="lnt"&gt; 52
&lt;/span&gt;&lt;span class="lnt"&gt; 53
&lt;/span&gt;&lt;span class="lnt"&gt; 54
&lt;/span&gt;&lt;span class="lnt"&gt; 55
&lt;/span&gt;&lt;span class="lnt"&gt; 56
&lt;/span&gt;&lt;span class="lnt"&gt; 57
&lt;/span&gt;&lt;span class="lnt"&gt; 58
&lt;/span&gt;&lt;span class="lnt"&gt; 59
&lt;/span&gt;&lt;span class="lnt"&gt; 60
&lt;/span&gt;&lt;span class="lnt"&gt; 61
&lt;/span&gt;&lt;span class="lnt"&gt; 62
&lt;/span&gt;&lt;span class="lnt"&gt; 63
&lt;/span&gt;&lt;span class="lnt"&gt; 64
&lt;/span&gt;&lt;span class="lnt"&gt; 65
&lt;/span&gt;&lt;span class="lnt"&gt; 66
&lt;/span&gt;&lt;span class="lnt"&gt; 67
&lt;/span&gt;&lt;span class="lnt"&gt; 68
&lt;/span&gt;&lt;span class="lnt"&gt; 69
&lt;/span&gt;&lt;span class="lnt"&gt; 70
&lt;/span&gt;&lt;span class="lnt"&gt; 71
&lt;/span&gt;&lt;span class="lnt"&gt; 72
&lt;/span&gt;&lt;span class="lnt"&gt; 73
&lt;/span&gt;&lt;span class="lnt"&gt; 74
&lt;/span&gt;&lt;span class="lnt"&gt; 75
&lt;/span&gt;&lt;span class="lnt"&gt; 76
&lt;/span&gt;&lt;span class="lnt"&gt; 77
&lt;/span&gt;&lt;span class="lnt"&gt; 78
&lt;/span&gt;&lt;span class="lnt"&gt; 79
&lt;/span&gt;&lt;span class="lnt"&gt; 80
&lt;/span&gt;&lt;span class="lnt"&gt; 81
&lt;/span&gt;&lt;span class="lnt"&gt; 82
&lt;/span&gt;&lt;span class="lnt"&gt; 83
&lt;/span&gt;&lt;span class="lnt"&gt; 84
&lt;/span&gt;&lt;span class="lnt"&gt; 85
&lt;/span&gt;&lt;span class="lnt"&gt; 86
&lt;/span&gt;&lt;span class="lnt"&gt; 87
&lt;/span&gt;&lt;span class="lnt"&gt; 88
&lt;/span&gt;&lt;span class="lnt"&gt; 89
&lt;/span&gt;&lt;span class="lnt"&gt; 90
&lt;/span&gt;&lt;span class="lnt"&gt; 91
&lt;/span&gt;&lt;span class="lnt"&gt; 92
&lt;/span&gt;&lt;span class="lnt"&gt; 93
&lt;/span&gt;&lt;span class="lnt"&gt; 94
&lt;/span&gt;&lt;span class="lnt"&gt; 95
&lt;/span&gt;&lt;span class="lnt"&gt; 96
&lt;/span&gt;&lt;span class="lnt"&gt; 97
&lt;/span&gt;&lt;span class="lnt"&gt; 98
&lt;/span&gt;&lt;span class="lnt"&gt; 99
&lt;/span&gt;&lt;span class="lnt"&gt;100
&lt;/span&gt;&lt;span class="lnt"&gt;101
&lt;/span&gt;&lt;span class="lnt"&gt;102
&lt;/span&gt;&lt;span class="lnt"&gt;103
&lt;/span&gt;&lt;span class="lnt"&gt;104
&lt;/span&gt;&lt;span class="lnt"&gt;105
&lt;/span&gt;&lt;span class="lnt"&gt;106
&lt;/span&gt;&lt;span class="lnt"&gt;107
&lt;/span&gt;&lt;span class="lnt"&gt;108
&lt;/span&gt;&lt;span class="lnt"&gt;109
&lt;/span&gt;&lt;span class="lnt"&gt;110
&lt;/span&gt;&lt;span class="lnt"&gt;111
&lt;/span&gt;&lt;span class="lnt"&gt;112
&lt;/span&gt;&lt;span class="lnt"&gt;113
&lt;/span&gt;&lt;span class="lnt"&gt;114
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;mxnet&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;mx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pickle&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;unpickle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;fo&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dicts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pickle&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;bytes&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dicts&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;residual_unit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;channels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;same_shape&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;stride&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;same_shape&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BatchNorm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fix_gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;_bn1&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;momentum&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;_relu1&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;channels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;_conv1&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BatchNorm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fix_gamma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;_bn2&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;momentum&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;_relu2&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;channels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;_conv2&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;same_shape&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;channels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;stride&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;_conv3&amp;#34;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;ResNet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;units&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Variable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;residual_unit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&lt;/span&gt;&lt;span class="si"&gt;%s%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;units&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;residual_unit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&lt;/span&gt;&lt;span class="si"&gt;%s%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BatchNorm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;batch1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;momentum&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;relu1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pooling&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pool_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;avg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pool1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Flatten&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;flat1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FullyConnected&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;fc1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_hidden&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SoftmaxOutput&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;softmax&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;net&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;all_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;unpickle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;../data/cifar-10-batches-py/data_batch_&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;all_data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="sa"&gt;b&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="sa"&gt;b&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;labels&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;all_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;trainX&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trainY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;concat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;astype&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;float32&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;concat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;unpickle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;../data/cifar-10-batches-py/test_batch&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;testX&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="sa"&gt;b&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;astype&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;float32&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;testY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="sa"&gt;b&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;labels&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# batch_size = 128&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;128&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;train_iter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;io&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NDArrayIter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trainX&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trainY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shuffle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;test_iter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;io&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NDArrayIter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;testX&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;testY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shuffle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ResNet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Module&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gpu&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# context = mx.gpu(0),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;data_names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;label_names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;softmax_label&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data_shapes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;train_iter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;provide_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label_shapes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;train_iter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;provide_label&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;initializer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Xavier&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rnd_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;gaussian&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;factor_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;in&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;magnitude&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init_optimizer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;optimizer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;nag&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;optimizer_params&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;learning_rate&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;wd&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0001&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;momentum&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.9&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# mod.init_optimizer(optimizer=&amp;#39;adam&amp;#39;, optimizer_params=((&amp;#39;learning_rate&amp;#39;, 5e-4),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# (&amp;#39;beta1&amp;#39;, 0.9),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# (&amp;#39;beta2&amp;#39;, 0.99)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;losses&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;accuracy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;metrics&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;metric&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;metric&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CrossEntropy&lt;/span&gt;&lt;span class="p"&gt;()]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;epoch&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;train_iter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;batch&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;train_iter&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;batch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;is_train&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update_metric&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;batch&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update_metric&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;batch&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;epoch&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;score&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;score&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_iter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;metric&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CrossEntropy&lt;/span&gt;&lt;span class="p"&gt;()])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;losses&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;score&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;accuracy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;score&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Epoch &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s1"&gt;, Training acc &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;, loss &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;epoch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;accuracy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;losses&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Epoch &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s1"&gt;, Validation acc &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;, loss &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;epoch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;accuracy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;losses&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;train_loss&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;test_loss&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;losses&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;train_loss&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;training loss&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_loss&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;testing loss&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;upper right&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;iteration&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;train_acc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;test_acc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;accuracy&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;train_acc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;training acc&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_acc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;testing acc&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;upper right&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;iteration&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>Deep Residual Learning for Image Recognition</title><link>https://davidham3.github.io/blog/p/deep-residual-learning-for-image-recognition/</link><pubDate>Sun, 04 Mar 2018 18:59:20 +0000</pubDate><guid>https://davidham3.github.io/blog/p/deep-residual-learning-for-image-recognition/</guid><description>&lt;p&gt;CVPR 2015ï¼ŒResNetï¼ŒåŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1512.03385" target="_blank" rel="noopener"
&gt;Deep Residual Learning for Image Recognition&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="deep-residual-learning-for-image-recongnition"&gt;Deep Residual Learning for Image Recongnition
&lt;/h1&gt;&lt;h2 id="problems"&gt;problems
&lt;/h2&gt;&lt;p&gt;When deeper networks are able to start converging, a degradation problem has been exposed: with the network depth increasing, accuracy gets saturated (which might be unsurprising) and then degrades rapidly. Unexpectedly, such degradation is not caused by overfitting, and adding more layers to a suitably deep model leads to higher training error, as reported in [11, 42] and thoroughly verified by our experiments. Fig. 1 shows a typical example.
&lt;img src="https://davidham3.github.io/blog/images/deep-residual-learning-for-image-recognition/Fig1.PNG"
loading="lazy"
alt="Fig1"
&gt;&lt;/p&gt;
&lt;p&gt;Figure 1. Training error (left) and test error (right) on CIFAR-10 with 20-layer and 56-layer â€œplainâ€ networks. The deeper network has higher training error, and thus test error. Similar phenomena on ImageNet is presented in Fig. 4.&lt;/p&gt;
&lt;p&gt;The degradation (of training accuracy) indicates that not all systems are similarly easy to optimize. Let us consider a shallower architecture and its deeper counterpart that adds more layers onto it. There exists a solution &lt;em&gt;by construction&lt;/em&gt; to the deeper model: the added layers are &lt;em&gt;identity&lt;/em&gt; mapping and the other layers are copied from the learned shallower model. The existence of this constructed solution indicates that a deeper model should produce no higher training error than its shallower counterpart. But experiments show that our current solvers on hand are unable to find solutions that are comparably good or better than the constructed solution (or unable to do so in feasible time).&lt;/p&gt;
&lt;h2 id="deep-residual-learning"&gt;Deep Residual Learning
&lt;/h2&gt;&lt;h3 id="residual-learning"&gt;Residual Learning
&lt;/h3&gt;&lt;p&gt;Let us consider $\mathcal{H}(x)$ as an underlying mapping to be fit by a few stacked layers (not necessarily the entire net), with $x$ denoting the inputs to the first of these layers. If one hypothesizes that multiple nonlinear layers can asymptotically approximate complicated functions, then it is equivalent to hypothesize that they can asymptotically approximate the residual functions, $i.e.$, $\mathcal{H}(x)-x$ (assuming that the input and output are of the same dimensions). So rather than expect stacked layers to approximate $\mathcal{H}(x)$, we explicitly let these layers approximate a residual function $\mathcal{F}(x):=\mathcal{H}(x)-x$. The original function thus becomes $\mathcal{F}(x)+x$. Although both forms should be able to asymptotically approximate the desired functions (as hypothesized), the ease of learning might be different.&lt;/p&gt;
&lt;h3 id="identity-mapping-by-shortcuts"&gt;Identity Mapping by Shortcuts
&lt;/h3&gt;$$y = \mathcal{F}(x, {W\_i})+x$$&lt;p&gt;
Here $x$ and $y$ are the input and output vectors of the layers considered. The function $\mathcal{F}(x, W_i)$ represents the residual mapping to be learned. For the example in Fig. 2 that has two layers, $\mathcal{F} = W_2\sigma (W_1x)$ in which $\sigma $ denotes ReLU and the bias are omitting for simplifying notations. The operation $\mathcal{F}+x$ is performed by a shortcut connection and element-wise addition. We adopt the second nonlinearity after the addtion (&lt;em&gt;i.e.&lt;/em&gt;, $\sigma(y)$, see Fig.2).
&lt;img src="https://davidham3.github.io/blog/images/deep-residual-learning-for-image-recognition/Fig2.PNG"
loading="lazy"
alt="Fig2"
&gt;&lt;/p&gt;
&lt;p&gt;Figure2. Residual learning: a building block.&lt;/p&gt;
&lt;p&gt;The dimensions of $x$ and $\mathcal{F}$ must be equal in Eqn.(1). If this is not the case (&lt;em&gt;e.g.&lt;/em&gt;, when changing the input/output channels), we can perform a linear projection $W_s$ by the shortcut connections to match the dimensions:
&lt;/p&gt;
$$y = \mathcal{F}(x, {W\_i}) + W\_sx$$&lt;p&gt;
We can also use a square matrix $W_s$ in Eqn.(1). But we will show by experiments that the identity mapping is sufficient for addressing the degradation problem and is economical, and thus $W_s$ is only used when matching dimensions.
We also note that although the above notations are about fully-connected layers for simplicity, they are applicable to convolutional layers. The function $\mathcal{F}(x, {W_i})$ can represent multiple convolutional layers. The element-wise addition is performed on two feature maps, channel by channel.&lt;/p&gt;
&lt;h2 id="residual-network"&gt;Residual Network
&lt;/h2&gt;&lt;p&gt;The identity shortcuts can be directly used when the input and output are of the same dimensions (solid line shortcuts in Fig.3). When the dimensions increase (dotted line shortcuts in Fig.3), we consider two options: (A) The shortcut still performs identity mapping, with extra zero entries padded for increasing dimensions. This option introduces no extra parameter; (B) The projection shortcut in Eqn.(2) is used to match dimensions (done by $1 \times 1$ convolutions). For both options, when the shortcuts go across feature maps of two sizes, they are performed with a stride of 2.
&lt;img src="https://davidham3.github.io/blog/images/deep-residual-learning-for-image-recognition/Fig3.PNG"
loading="lazy"
alt="Fig3"
&gt;&lt;/p&gt;
&lt;p&gt;Figure3. Example network architectures for ImageNet. &lt;b&gt;Left&lt;/b&gt;: the VGG-19 model. &lt;b&gt;Middle&lt;/b&gt;: a plain network with 34-parameter layers. &lt;strong&gt;Right&lt;/strong&gt;: a residual network with 34 parameter layers. The dotted shortcuts increase dimensions. &lt;b&gt;Table 1&lt;/b&gt; shows more details and other variants.&lt;/p&gt;
&lt;h2 id="implementation"&gt;Implementation
&lt;/h2&gt;&lt;p&gt;Our implementation for ImageNet follows the practice in &lt;em&gt;[Imagenet classification
with deep convolutional neural networks]&lt;/em&gt; and &lt;em&gt;[Very deep convolutional networks for large-scale image recognition]&lt;/em&gt;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The Image is resized with its shorter side randomly sampled in $[256, 480]$ for scale agumentation.&lt;/li&gt;
&lt;li&gt;A $224 \times 224$ crop is randomly sampled from an image or its horizontal flip, with the per-pixel mean subtracted.&lt;/li&gt;
&lt;li&gt;The standard color augmentation in &lt;em&gt;Imagenet classification
with deep convolutional neural networks&lt;/em&gt; is used.&lt;/li&gt;
&lt;li&gt;We adopt batch normalization (BN) right after each convolution and before activation.&lt;/li&gt;
&lt;li&gt;We initialize the weights as in &lt;em&gt;Delving deep into rectifiers:
Surpassing human-level performance on imagenet classification&lt;/em&gt; and train all plain/residual nets from scratch.&lt;/li&gt;
&lt;li&gt;We use SGD with a mini-batch size of 256.&lt;/li&gt;
&lt;li&gt;The learning rate starts from 0.1 and is divided by 10 when the error plateaus, and the models are trained from up to $60 \times 10^4$ iterations.&lt;/li&gt;
&lt;li&gt;We use a weight decay of 0.0001 and a momentum of 0.9.&lt;/li&gt;
&lt;li&gt;We do not use dropout, following the practice in &lt;em&gt;Batch normalization: Accelerating deep
network training by reducing internal covariate shift&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;In testing, for comparison studies we adopt the standard 10-crop testing.[&lt;em&gt;Imagenet classification
with deep convolutional neural networks&lt;/em&gt;]&lt;/li&gt;
&lt;li&gt;For best results, we adopt the fully-convolutional form as in &lt;em&gt;Very deep convolutional networks for large-scale image recognition&lt;/em&gt; and &lt;em&gt;Delving deep into rectifiers: Surpassing human-level performance on imagenet classification&lt;/em&gt;, and average the scores at multiple scales (images are resized such that the shorter side is in $\lbrace 224, 256, 384, 480, 640\rbrace $.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="imagenet-classification"&gt;ImageNet classification
&lt;/h2&gt;&lt;h3 id="deeper-bottleneck-architecture"&gt;Deeper Bottleneck Architecture
&lt;/h3&gt;&lt;p&gt;Next we describe our deeper nets for ImageNet. Because of concerns on the training time that we can afford, we modify the building block as a &lt;em&gt;bottleneck&lt;/em&gt; design. For each residual function $\mathcal{F}$, we use a stack of 3 layers instead of 2 (Fig. 5). The three layers are $1 \times 1$, $3 \times 3$, and $1 \times 1$ convolutions, where the $1 \times 1$ layers are responsible for reducing and then increasing (restoring) dimensions, leaving the $3 \times 3$ layer a bottleneck with smaller input/output dimensions. Fig. 5 shows an example, where both designs have similar time complexity.
The parameter-free indentity shortcuts are particularly important for the bottleneck architectures. If the identity&lt;/p&gt;
&lt;h2 id="cifar-10-and-analysis"&gt;CIFAR-10 and Analysis
&lt;/h2&gt;&lt;p&gt;The plain/residual architectures follow the form in Fig.3(middle/right). The network inputs are $32 \times 32$ images, with the per-pixel mean subtracted. The first layer is $3 \times 3$ convolutions. Then we use a stack of $6n$ layers with $3 \times 3$ convolutions on the feature maps of sizes $\lbrace 32, 16, 8\rbrace $ respectively, with $2n$ layers for each feature map size. The numbers of filters are $\lbrace 16, 32, 64\rbrace $ respectively, with $2n$ layers for each feature map size. The subsampling is performed by convolutions with a stride of 2. The network ends with a global average pooling, a 10-way fully-connected layer, and softmax.
When shortcut connections are used, they are connected to the pairs of $3 \times 3$ layers(totally $3n$ shortcuts). On this dataset we use identity shortcuts in all cases (&lt;em&gt;i.e.&lt;/em&gt;, option A), so our residual models have exactly the same depth, width and number of parameters as the plain counterparts.
We use a weight decay of 0.0001 and momentum of 0.9, and adopt the weight initialization in &lt;em&gt;Delving deep into rectifiers: Surpassing human-level performance on imagenet classification&lt;/em&gt; and BN in &lt;em&gt;Accelerating deep network training by reducing internal covariate shift&lt;/em&gt; but with no dropout. These models are trained with a mini-batch size of 128 on two GPUs. We start with a learning rate of 0.1, divide it by 10 at 32k and 48k iterations, and terminate training at 64k iterations, which is determined on a 45k/5k train/val split. We follow the simple data augmentation in &lt;em&gt;Deeply-supervised nets&lt;/em&gt; for training: 4 pixels are padded on each side, and a $32 \times 32$ crop is randomly sampled from the padded image or its horizontal flip. For testing, we only evaluate the single view of the original $32 \times 32$ image.
We compare $n=\lbrace 3, 5, 7, 9\rbrace $, leading to 20, 32, 44, and 56-layer networks.&lt;/p&gt;</description></item><item><title>Image Super-Resolution Using Deep Convolutional Networks</title><link>https://davidham3.github.io/blog/p/image-super-resolution-using-deep-convolutional-networks/</link><pubDate>Fri, 02 Mar 2018 11:19:50 +0000</pubDate><guid>https://davidham3.github.io/blog/p/image-super-resolution-using-deep-convolutional-networks/</guid><description>&lt;p&gt;PAMI 2016ï¼Œå¤§ä½“æ€è·¯ï¼šæŠŠè®­ç»ƒé›†ä¸­çš„æ‰€æœ‰æ ·æœ¬æ¨¡ç³ŠåŒ–ï¼Œæ‰”åˆ°ä¸‰å±‚çš„å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼ŒæŠŠè¾“å‡ºå’ŒåŸå§‹å›¾ç‰‡åšä¸€ä¸ªlossï¼Œè®­ç»ƒæ¨¡å‹å³å¯ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1501.00092" target="_blank" rel="noopener"
&gt;Image Super-Resolution Using Deep Convolutional Networks&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ˜¯ill-posed problemï¼Œå›¾åƒçš„ä¸é€‚å®šé—®é¢˜
æ³•å›½æ•°å­¦å®¶é˜¿è¾¾é©¬æ—©åœ¨19ä¸–çºªå°±æå‡ºäº†ä¸é€‚å®šé—®é¢˜çš„æ¦‚å¿µ:ç§°ä¸€ä¸ªæ•°å­¦ç‰©ç†å®šè§£é—®é¢˜çš„è§£å­˜åœ¨ã€å”¯ä¸€å¹¶ä¸”ç¨³å®šçš„åˆ™ç§°è¯¥é—®é¢˜æ˜¯é€‚å®šçš„ï¼ˆWell Posedï¼‰.å¦‚æœä¸æ»¡è¶³é€‚å®šæ€§æ¦‚å¿µä¸­çš„ä¸Šè¿°åˆ¤æ®ä¸­çš„ä¸€æ¡æˆ–å‡ æ¡ï¼Œç§°è¯¥é—®é¢˜æ˜¯ä¸é€‚å®šçš„ã€‚&lt;/p&gt;
&lt;h1 id="convolutional-neural-networks-for-super-resolution"&gt;Convolutional Neural Networks For Super-Resolution
&lt;/h1&gt;&lt;h2 id="formulation"&gt;Formulation
&lt;/h2&gt;&lt;p&gt;We first upscale a single low-resolution image to the desired size using bicubic interpolation. Let us denote the interpolated image as $Y$. Our goal is to recover from $Y$ an image $F(Y)$ that is as similar as possible to the ground truth high-resolution image $X$. For the ease of presentation, we still call $Y$ a &amp;ldquo;low-resolution&amp;rdquo; image, although it has the same size as $X$. We wish to learning a mapping $F$, which conceptually consists of three operations:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Patch extraction and representation. this operation extracts (overlapping) patches from the low-resolution image $Y$ and represents each patch as a high-dimensional vector. These vectors comprise a set of feature maps, of which the number equals to the dimensionality of the vectors.&lt;/li&gt;
&lt;li&gt;Non-linear mapping. this operation nonlinearly maps each high-dimensional vector onto another high-dimensional vector. Each mapped vector is conceptually the representation of a high-resolution patch. These vectors comprise another set of feature maps.&lt;/li&gt;
&lt;li&gt;Reconstruction. this operation aggregates the above high-resolution patch-wise representations to generate the final high-resolution image. This image is expected to be similar to the ground truth $X$.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="patch-extraction-and-representation"&gt;Patch Extraction and Representation
&lt;/h3&gt;&lt;p&gt;A popular strategy in image restoration is to densely extract patches and then represent them by a set of pre-trained bases such as PCA, DCT, Haar, etc. This is equivalent to convolving the image by a set of filters, each of which is a basis. In our formulation, we involve the optimization of these bases into the optimization of the network. Formally, our first layer is expressed as an operation $F_1$:
&lt;/p&gt;
$$F\_1(Y)=max(0, W\_1 * Y + B\_1)$$&lt;p&gt;
where $W_1$ and $B_1$ represent the filters and biases respectively, and $*$ denotes the convolution operation. Here, $W_1$ corresponds to $n_1$ filters of support $c \times f_1 \times f_1$, where $c$ is the number of channels in the input image, $f_1$ is the spatial size of a filter. Intuitively, $W_1$ applies $n_1$ convolutions on the image, and each convolution has a kernel size $c \times f_1 \times f_1$. The output is composed of $n_1$ feature maps. $B_1$ is an $n_1$-dimensional vector, whose each element is associated with a filter. We apply the ReLU on the filter responses.&lt;/p&gt;
&lt;h3 id="non-linear-mapping"&gt;Non-Linear Mapping
&lt;/h3&gt;&lt;p&gt;The first layer extracts an $n_1$-dimensional feature for each patch. In the second operation, we map each of these $n_1$-dimensional vectors into an $n_2$-dimensional one. This is equivalent to applying $n_2$ filters which have a trivial spatial support $1 \times 1$. This interpretation is only valid for $1 \times 1$ filters. But it is easy to generalize to larger filters like $3 \times 3$ or $5 \times 5$. In that case, the non-linear mapping is not on a patch of the input image; instead, it is on a $3 \times 3$ or $5 \times 5$ &amp;ldquo;patch&amp;rdquo; of the feature map. The operation of the second layer is:
&lt;/p&gt;
$$F\_2(Y) = max(0, W\_2 * F\_1(Y) + B\_2)$$&lt;p&gt;
Here $W_2$ contains $n_2$ filters of size $n_1 \times f_2 \times f_2$, and $B_2$ is $n_2$-dimensional. Each of the output $n_2$-dimensional vectors is conceptually a representation of a high-resolution patch that will be used for reconstruction.&lt;/p&gt;
&lt;h3 id="reconstruction"&gt;Reconstruction
&lt;/h3&gt;&lt;p&gt;In the traditional methods, the predicted overlapping high-resolution patches are often averaged to produce the final full image. The averaging can be considered as a pre-defined filter on a set of feature maps (where each position is the &amp;ldquo;flattened&amp;rdquo; vector form of a high-resolution patch). Motivated by this, we define a convolutional layer to produce the final high-resolution image:
&lt;/p&gt;
$$F(Y)=W\_3 * F\_2(Y) + B\_3$$&lt;p&gt;
Here W_3 corresponds to $c$ filters of a size $n_2 \times f_3 \times f_3$, and $B_3$ is a $c$-dimensional vector.&lt;/p&gt;
&lt;h2 id="training"&gt;Training
&lt;/h2&gt;&lt;p&gt;Loss function: given a set of high-resolution images ${X_i}$ and their corresponding low-resolution images ${Y_i}$, we use mean squared error (MSE) as the loss function:
&lt;/p&gt;
$$L(\Theta ) = \frac{1}{n}\sum^n\_{i=1}\Vert F(Y\_i;\Theta)-X\_i\Vert ^2$$&lt;p&gt;
where $n$ is the number of training samples. Using MSE as the loss function favors a high PSNR. The PSNR is widely-used metric for quantitatively evaluating image restoration quality, and is at least partially related to the perceptual quality. Despite that the proposed model is trained favoring a high PSNR, we still observe satisfactory performance when the model is evaluated using alternative evaluation metrics, e.g., SSIM, MSSIM.
PSNR: Peak Signal to Noise Ratio. æ˜¯ä¸€ç§è¯„ä»·å›¾åƒçš„å®¢è§‚æ ‡å‡†ã€‚
&lt;/p&gt;
$$PSNR = 10 \times \log\_{10}(\frac{(2^n-1)^2}{MSE})$$&lt;p&gt;
å…¶ä¸­ï¼ŒMSEæ˜¯åŸå›¾åƒå’Œå¤„ç†å›¾åƒä¹‹é—´çš„å‡æ–¹è¯¯å·®ï¼Œnæ˜¯æ¯ä¸ªé‡‡æ ·å€¼çš„æ¯”ç‰¹æ•°ï¼Œå•ä½æ˜¯dBã€‚
The loss is minimized using stochastic gradient descent with the standard backpropagation. In particular, the weight matrices are updated as
&lt;/p&gt;
$$\Delta\_{i+1}=0.9 \cdot \Delta\_i + \eta \cdot \frac{\partial{L}}{\partial{W^\ell\_i}}, W^\ell\_{i+1}=W^\ell\_{i}+\Delta\_{i+1}$$&lt;p&gt;
where $\ell \in {1,2,3}$ and $i$ are the indices of layers and iterations, $\eta$ is the learning rate, and $\frac{\partial{L}}{\partial{W^\ell_i}}$ is the derivative. The filter weights of each layer are initialized by drawing randomly from a Gaussian distribution with zero mean and standard deviation 0.0001 (and 0 for biases). The learning rate is $10^{-4}$ for the first two layers, and $10^{-5}$ for the last layer. We empirically find that a smaller learning rate in the last layer is important for the network to converge (similar to the denoising case).
In the training phase, the ground truth images ${X_i}$ are prepared as $f_{sub} \times f_{sub} \times c$-pixel sub-images randomly cropped from the training images. By &amp;ldquo;sub-images&amp;rdquo; we mean these samples are treated as small &amp;ldquo;images&amp;rdquo; rather than &amp;ldquo;patches&amp;rdquo;, in the sense that &amp;ldquo;patches&amp;rdquo; are overlapping and require some averaging as post-processing but &amp;ldquo;sub-images&amp;rdquo; need not. To synthesize the low-resolution samples ${Y_i}$, we blur a sub-image by a Gaussian kernel, sub-sample it by the upscaling factor, and upscale it by the same factor via bicubic interpolation.
To avoid border effects during training, all the convolutional layers have no padding, and the network produces a smaller output $((f_{sub}-f_1-f_2-f_3+3)^2 \times c)$. The MSE loss function is evaluated only by the difference between the contral pixels of $X_i$ and the network output. Although we use a fixed image size in training, the convolutional nerual network can be applied on images of arbitrary sizes during testing.&lt;/p&gt;</description></item><item><title>Perceptual Losses for Real-Time Style Transfer and Super-Resolution</title><link>https://davidham3.github.io/blog/p/perceptual-losses-for-real-time-style-transfer-and-super-resolution/</link><pubDate>Thu, 01 Mar 2018 19:01:46 +0000</pubDate><guid>https://davidham3.github.io/blog/p/perceptual-losses-for-real-time-style-transfer-and-super-resolution/</guid><description>&lt;p&gt;ECCV 2016ï¼Œå®æ—¶é£æ ¼è¿ç§»ä¸è¶…åˆ†è¾¨ç‡åŒ–çš„æ„ŸçŸ¥æŸå¤±ï¼Œè¿™ç¯‡è®ºæ–‡æ˜¯åœ¨cs231né‡Œé¢çœ‹åˆ°çš„ï¼Œæ­£å¥½æœ€è¿‘åœ¨ç ”ç©¶é£æ ¼è¿ç§»ã€‚ä¸€ä½œæ˜¯Justin Johnsonï¼Œ2017æ˜¥çš„cs231nçš„ä¸»è®²ä¹‹ä¸€ã€‚è¿™ç¯‡è®ºæ–‡çš„ä¸»è¦å†…å®¹æ˜¯å¯¹Gatysç­‰äººçš„é£æ ¼è¿ç§»åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå¤§å¹…æå‡äº†æ€§èƒ½ã€‚
ä¸»è¦åŸç†å°±æ˜¯ï¼Œä¹‹å‰Gatysç­‰äººçš„è®ºæ–‡æ˜¯åˆ©ç”¨å·²ç»è®­ç»ƒå¥½çš„VGG19ï¼Œæ±‚losså¹¶åˆ©ç”¨VGGçš„ç»“æ„åå‘æ±‚å¯¼æ›´æ–°å›¾ç‰‡ã€‚ç”±äºVGGç»“æ„å¤æ‚ï¼Œè¿™æ ·åå‘æ›´æ–°é€Ÿåº¦å¾ˆæ…¢ï¼Œæ”¹è¿›æ–¹æ³•æ˜¯å†å¦å¤–è®¾è®¡ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œå°†å†…å®¹å›¾ç‰‡ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºæ‰”åˆ°VGGä¸­åšä¸¤ä¸ªlossï¼Œç„¶ååå‘ä¼ æ’­æ›´æ–°å½“å‰è¿™ä¸ªç¥ç»ç½‘ç»œçš„å‚æ•°ï¼Œè¿™æ ·è®­ç»ƒå‡ºæ¥çš„ç¥ç»ç½‘ç»œå°±å¯èƒ½å°†ä»»æ„çš„å†…å®¹å›¾ç‰‡æ‰”è¿›å»ï¼Œè¾“å‡ºä¸ºé£æ ¼è¿ç§»åçš„å›¾ç‰‡ï¼Œè¿™ä¹Ÿå°±è§£å†³äº†é€Ÿåº¦çš„é—®é¢˜ã€‚è¿™ä¹Ÿå°±æ˜¯å°†Feed-forward image transformationä¸style transferç»“åˆåœ¨ä¸€èµ·ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://arxiv.org/abs/1603.08155" target="_blank" rel="noopener"
&gt;Perceptual Losses for Real-Time Style Transfer and Super-Resolution&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="image-transformation-network"&gt;Image Transformation Network
&lt;/h1&gt;&lt;h2 id="architecture"&gt;Architecture
&lt;/h2&gt;&lt;p&gt;We do not use any pooling layers, instead using strided and fractionally strided convolutions for in-network downsampling and upsampling. Our network body consists of five residual blocks using the architecture of http://torch. ch/blog/2016/02/04/resnets.html. All non-residual convolutional layers are followed by spatial batch normalization and ReLU nonlinearities with the exception of the output layer, which instead uses a scaled tanh to ensure that the output image has pixels in the range [0, 255]. Other than the first and last layers with use $9 \times 9$ kernels, all convolutional layers use $3 \times 3$ kernels. The exact architectures of all our networks can be found in the supplementary material.&lt;/p&gt;
&lt;h2 id="inputs-and-outputs"&gt;Inputs and Outputs
&lt;/h2&gt;&lt;p&gt;For style transfer the input and output are both color images of shape #3 \times 256 \times 256#.
For super-resolution with an upsampling factor of $f$, the output is a high-resolution patch of shape $3 \times 288/f \times 288/f$. Since the image transformation networks are fully-convolutional, at test-time they can be applied to images of any resolution.&lt;/p&gt;
&lt;h2 id="downsampling-and-upsampling"&gt;Downsampling and Upsampling
&lt;/h2&gt;&lt;p&gt;For super-resolution with an upsampling factor of $f$, we use several residual blocks followed by $log_2f$ convolutional layers with stride $1/2$. This is different from [1] who use bicubic interpolation to upsample the low-resolution input before passing it to the network.&lt;/p&gt;
&lt;p&gt;Our style transfer networks use the architecture shown in Table 1 and our super-resolution networks use the architecture shown in Table 2. In these tables &amp;ldquo;$C \times H \times W$ conv&amp;rdquo; denotes a convolutional layer with $C$ filters size $H \times W$ which is immeidately followed by spatial batch normalization [1] and a ReLU nonlinearity.
Our residual blocks each contain two $3 \times 3$ convolutional layers with the same number of filters on both layer. We use the residual block design of Gross and Wilber [2] (shown in Figure 1), which differs from that of He &lt;em&gt;et al&lt;/em&gt; [3] in that the ReLU nonlinearity following the addition is removed; this modified design was found in [2] to perform slightly better for image classification.
For style transfer, we found that standard zero-padded convolutions resulted in severe artifacts around the borders of the generated image. We therefore remove padding from the convolutions in residual blocks. A $3 \times 3$ convolution with no padding reduces the size of a feature map by 1 pixel on each side, so in this case the identity connection of the residual block performs a center crop on the input feature map. We also add spatial reflection padding to the beginning of the network so that the input and output of the network have the same size.&lt;/p&gt;
&lt;h1 id="perceptual-loss-functions"&gt;Perceptual Loss Functions
&lt;/h1&gt;&lt;p&gt;We define two &lt;em&gt;perceptual loss functions&lt;/em&gt; that measure high-level perceptual and semantic differences between images. They make use of a loss &lt;em&gt;network&lt;/em&gt; $\phi$ pretrained for image classification, meaning that these perceptual loss functions are themselves deep convolutional neural networks. In all our experiments $\phi$ is the 16-layer VGG network pretrained on the ImageNet dataset.&lt;/p&gt;
&lt;h2 id="featue-reconstruction-loss"&gt;Featue Reconstruction Loss
&lt;/h2&gt;&lt;p&gt;Rather than encouraging the pixels of the output image $\hat{y} = f_W(x)$ to exactly match the pixels of the target image $y$, we instead encourage them to have similar feature representations as computed by the loss network $\phi$. Let $\phi_j(x)$ be the activations of the &lt;em&gt;j&lt;/em&gt;th layer of the network $\phi$ when processing the image $x$; if $j$ is a convolutional layer then $\phi_j(x)$ will be a feature map of shape $C_j \times H_j \times W_j$. The &lt;em&gt;feature reconstruction loss&lt;/em&gt; is the (squared, normalized) Euclidean distance between feature representations:
&lt;/p&gt;
$$\ell\_{feat}^{\phi,j}(\hat{y}, y)=\frac{1}{C\_jH\_jW\_j}\Vert \phi\_j(\hat{y})-\phi\_j(y)\Vert\_2^2$$&lt;p&gt;
As demonstrated in [6] and reproduced in Figure 3, finding an image $\hat{y}$ that minimizes the feature reconstruction loss for early layers tends to produce images that are visually indistinguishable from $y$.&lt;/p&gt;
&lt;h2 id="style-reconstruction-loss"&gt;Style Reconstruction Loss
&lt;/h2&gt;&lt;p&gt;The feature reconstruction loss penalizes the output image $\hat{y}$ when it deviates in content from the target $y$. We also wish to penalize differences in style: colors, textures, common patterns, etc. To achieve this effect, Gatys &lt;em&gt;et al&lt;/em&gt; propose the following &lt;em&gt;style reconstruction loss&lt;/em&gt;.
As above, let $\phi_j(x)$ be the activations at the $j$th layer of the network $\phi$ for the input $x$, which is a feature map of shape $C_j \times H_j \times W_j$. Define the &lt;em&gt;Gram matrix&lt;/em&gt; $G^\phi_j(x)$ to be the $C_j \times C_j$ matrix whose elements are given by
&lt;/p&gt;
$$G^\phi\_j(x)\_{c,c'}=\frac{1}{C\_jH\_jW\_j}\sum^{H\_j}\_{h=1}\sum\_{w=1}^{W\_j}\phi\_j(x)\_{h,w,c}\phi\_j(x)\_{h,w,c'}$$&lt;h1 id="experiments"&gt;Experiments
&lt;/h1&gt;&lt;h2 id="style-transfer"&gt;Style Transfer
&lt;/h2&gt;&lt;h2 id="single-image-super_resolution"&gt;Single-Image Super_Resolution
&lt;/h2&gt;&lt;p&gt;This is an inherently ill-posed problem, since for each low-resolution image there exist multiple high-resolution images that could have generated it. The ambiguity becomes more extreme as the super-resolution factor grows; for larger factors ($\times 4$, $\times 8$), fine details of the high-resolution image may have little or no evidence in its low-resolution version.
To overcome this problem, we train super-resolution networks not with the per-pixel loss typically used [1] but instead with a feature reconstruction loss to allow transer of semantic knowledge from the pretrained loss network to the super-resolution network. We focus on $\times 4$ and $\times 8$ super-resolution since larger factors require more semantic reasoning about the input.
The traditional metrics used to evaluate super-resolution are PSNR and SSIM, both of which have been found to correlate poorly with human assessment of visual quality. PSNR and SSIM rely only on low-level differences between pixels and operate under the assumption of additive Gasussian noise, which may be invalid for super-resolution. In addition, PSNR is equivalent to the per-pixel loss $\mathcal{l_{pixle}}$, so as measured by PSNR a model trained to minimize feature reconstruction loss should always outperform a model trained to minimize feature reconstruction loss. We therefore emphasize that the goal of these experiments is not to achieve state-of-the art PSNR or SSIM results, but instead to showcase the qualitative difference between models trained with per-pixel and feature reconstruction losses.&lt;/p&gt;
&lt;h1 id="code"&gt;code
&lt;/h1&gt;&lt;p&gt;æˆ‘ç”¨gluonå®ç°äº†ä¸€ä¸ª2xçš„è¶…åˆ†è¾¨ç‡ç½‘ç»œï¼Œè®­ç»ƒåæ„Ÿè§‰æ•ˆæœä¸€èˆ¬ï¼Œåªæœ‰ä¸€æ¬¡lossé™åˆ°äº†40é™„è¿‘ï¼Œé‚£æ¬¡æ•ˆæœæŒºå¥½ï¼Œä½†æ˜¯é¢œè‰²å¹¶ä¸æ˜¯å¾ˆå¥½
ä»¥ä¸‹æ˜¯ä»£ç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt; 10
&lt;/span&gt;&lt;span class="lnt"&gt; 11
&lt;/span&gt;&lt;span class="lnt"&gt; 12
&lt;/span&gt;&lt;span class="lnt"&gt; 13
&lt;/span&gt;&lt;span class="lnt"&gt; 14
&lt;/span&gt;&lt;span class="lnt"&gt; 15
&lt;/span&gt;&lt;span class="lnt"&gt; 16
&lt;/span&gt;&lt;span class="lnt"&gt; 17
&lt;/span&gt;&lt;span class="lnt"&gt; 18
&lt;/span&gt;&lt;span class="lnt"&gt; 19
&lt;/span&gt;&lt;span class="lnt"&gt; 20
&lt;/span&gt;&lt;span class="lnt"&gt; 21
&lt;/span&gt;&lt;span class="lnt"&gt; 22
&lt;/span&gt;&lt;span class="lnt"&gt; 23
&lt;/span&gt;&lt;span class="lnt"&gt; 24
&lt;/span&gt;&lt;span class="lnt"&gt; 25
&lt;/span&gt;&lt;span class="lnt"&gt; 26
&lt;/span&gt;&lt;span class="lnt"&gt; 27
&lt;/span&gt;&lt;span class="lnt"&gt; 28
&lt;/span&gt;&lt;span class="lnt"&gt; 29
&lt;/span&gt;&lt;span class="lnt"&gt; 30
&lt;/span&gt;&lt;span class="lnt"&gt; 31
&lt;/span&gt;&lt;span class="lnt"&gt; 32
&lt;/span&gt;&lt;span class="lnt"&gt; 33
&lt;/span&gt;&lt;span class="lnt"&gt; 34
&lt;/span&gt;&lt;span class="lnt"&gt; 35
&lt;/span&gt;&lt;span class="lnt"&gt; 36
&lt;/span&gt;&lt;span class="lnt"&gt; 37
&lt;/span&gt;&lt;span class="lnt"&gt; 38
&lt;/span&gt;&lt;span class="lnt"&gt; 39
&lt;/span&gt;&lt;span class="lnt"&gt; 40
&lt;/span&gt;&lt;span class="lnt"&gt; 41
&lt;/span&gt;&lt;span class="lnt"&gt; 42
&lt;/span&gt;&lt;span class="lnt"&gt; 43
&lt;/span&gt;&lt;span class="lnt"&gt; 44
&lt;/span&gt;&lt;span class="lnt"&gt; 45
&lt;/span&gt;&lt;span class="lnt"&gt; 46
&lt;/span&gt;&lt;span class="lnt"&gt; 47
&lt;/span&gt;&lt;span class="lnt"&gt; 48
&lt;/span&gt;&lt;span class="lnt"&gt; 49
&lt;/span&gt;&lt;span class="lnt"&gt; 50
&lt;/span&gt;&lt;span class="lnt"&gt; 51
&lt;/span&gt;&lt;span class="lnt"&gt; 52
&lt;/span&gt;&lt;span class="lnt"&gt; 53
&lt;/span&gt;&lt;span class="lnt"&gt; 54
&lt;/span&gt;&lt;span class="lnt"&gt; 55
&lt;/span&gt;&lt;span class="lnt"&gt; 56
&lt;/span&gt;&lt;span class="lnt"&gt; 57
&lt;/span&gt;&lt;span class="lnt"&gt; 58
&lt;/span&gt;&lt;span class="lnt"&gt; 59
&lt;/span&gt;&lt;span class="lnt"&gt; 60
&lt;/span&gt;&lt;span class="lnt"&gt; 61
&lt;/span&gt;&lt;span class="lnt"&gt; 62
&lt;/span&gt;&lt;span class="lnt"&gt; 63
&lt;/span&gt;&lt;span class="lnt"&gt; 64
&lt;/span&gt;&lt;span class="lnt"&gt; 65
&lt;/span&gt;&lt;span class="lnt"&gt; 66
&lt;/span&gt;&lt;span class="lnt"&gt; 67
&lt;/span&gt;&lt;span class="lnt"&gt; 68
&lt;/span&gt;&lt;span class="lnt"&gt; 69
&lt;/span&gt;&lt;span class="lnt"&gt; 70
&lt;/span&gt;&lt;span class="lnt"&gt; 71
&lt;/span&gt;&lt;span class="lnt"&gt; 72
&lt;/span&gt;&lt;span class="lnt"&gt; 73
&lt;/span&gt;&lt;span class="lnt"&gt; 74
&lt;/span&gt;&lt;span class="lnt"&gt; 75
&lt;/span&gt;&lt;span class="lnt"&gt; 76
&lt;/span&gt;&lt;span class="lnt"&gt; 77
&lt;/span&gt;&lt;span class="lnt"&gt; 78
&lt;/span&gt;&lt;span class="lnt"&gt; 79
&lt;/span&gt;&lt;span class="lnt"&gt; 80
&lt;/span&gt;&lt;span class="lnt"&gt; 81
&lt;/span&gt;&lt;span class="lnt"&gt; 82
&lt;/span&gt;&lt;span class="lnt"&gt; 83
&lt;/span&gt;&lt;span class="lnt"&gt; 84
&lt;/span&gt;&lt;span class="lnt"&gt; 85
&lt;/span&gt;&lt;span class="lnt"&gt; 86
&lt;/span&gt;&lt;span class="lnt"&gt; 87
&lt;/span&gt;&lt;span class="lnt"&gt; 88
&lt;/span&gt;&lt;span class="lnt"&gt; 89
&lt;/span&gt;&lt;span class="lnt"&gt; 90
&lt;/span&gt;&lt;span class="lnt"&gt; 91
&lt;/span&gt;&lt;span class="lnt"&gt; 92
&lt;/span&gt;&lt;span class="lnt"&gt; 93
&lt;/span&gt;&lt;span class="lnt"&gt; 94
&lt;/span&gt;&lt;span class="lnt"&gt; 95
&lt;/span&gt;&lt;span class="lnt"&gt; 96
&lt;/span&gt;&lt;span class="lnt"&gt; 97
&lt;/span&gt;&lt;span class="lnt"&gt; 98
&lt;/span&gt;&lt;span class="lnt"&gt; 99
&lt;/span&gt;&lt;span class="lnt"&gt;100
&lt;/span&gt;&lt;span class="lnt"&gt;101
&lt;/span&gt;&lt;span class="lnt"&gt;102
&lt;/span&gt;&lt;span class="lnt"&gt;103
&lt;/span&gt;&lt;span class="lnt"&gt;104
&lt;/span&gt;&lt;span class="lnt"&gt;105
&lt;/span&gt;&lt;span class="lnt"&gt;106
&lt;/span&gt;&lt;span class="lnt"&gt;107
&lt;/span&gt;&lt;span class="lnt"&gt;108
&lt;/span&gt;&lt;span class="lnt"&gt;109
&lt;/span&gt;&lt;span class="lnt"&gt;110
&lt;/span&gt;&lt;span class="lnt"&gt;111
&lt;/span&gt;&lt;span class="lnt"&gt;112
&lt;/span&gt;&lt;span class="lnt"&gt;113
&lt;/span&gt;&lt;span class="lnt"&gt;114
&lt;/span&gt;&lt;span class="lnt"&gt;115
&lt;/span&gt;&lt;span class="lnt"&gt;116
&lt;/span&gt;&lt;span class="lnt"&gt;117
&lt;/span&gt;&lt;span class="lnt"&gt;118
&lt;/span&gt;&lt;span class="lnt"&gt;119
&lt;/span&gt;&lt;span class="lnt"&gt;120
&lt;/span&gt;&lt;span class="lnt"&gt;121
&lt;/span&gt;&lt;span class="lnt"&gt;122
&lt;/span&gt;&lt;span class="lnt"&gt;123
&lt;/span&gt;&lt;span class="lnt"&gt;124
&lt;/span&gt;&lt;span class="lnt"&gt;125
&lt;/span&gt;&lt;span class="lnt"&gt;126
&lt;/span&gt;&lt;span class="lnt"&gt;127
&lt;/span&gt;&lt;span class="lnt"&gt;128
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;mxnet&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;mx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;autograd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;gluon&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet.gluon&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;init&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet.gluon.model_zoo&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;vision&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# get_ipython().run_line_magic(&amp;#39;matplotlib&amp;#39;, &amp;#39;inline&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;logging&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;logger&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getLogger&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;data_filenames&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;trainx_&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;.params&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;target_filenames&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;trainy_&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;.params&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;load_params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;epochs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;ratio&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;learning_rate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-5&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;start_index&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;num_samples&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;end_index&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;start_index&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gpu&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;load_params&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;training.log&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;residual_unit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gluon&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HybridBlock&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;channels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;residual_unit&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conv1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;channels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;channels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;kernel_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;strides&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;use_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bn1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BatchNorm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;momentum&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;act1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conv2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;channels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;channels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;kernel_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;use_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bn2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BatchNorm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;momentum&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;act2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conv3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;channels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;channels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;kernel_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;strides&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;use_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;act3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;hybrid_forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;act1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bn1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conv1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;act2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bn2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conv2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;x2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conv3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;act3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;plsr_network&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gluon&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HybridBlock&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;plsr_network&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name_scope&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;channels&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;kernel_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;strides&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;use_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;residual_sequential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HybridSequential&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;residual_sequential&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;residual_unit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;deconv1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Conv2DTranspose&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;channels&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;kernel_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;strides&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;output_padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;use_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;channels&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;kernel_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;strides&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;use_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HybridSequential&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;residual_sequential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;deconv1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;hybrid_forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;tv_loss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;data1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;data2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:,&lt;/span&gt; &lt;span class="p"&gt;:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:,&lt;/span&gt; &lt;span class="p"&gt;:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;data1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;data2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_vgg_loss_net&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pretrained_net&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HybridSequential&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pretrained_net&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;features&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;net&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_loss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vgg_loss_net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ratio&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;square&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vgg_loss_net&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;ratio&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;tv_loss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;rgb_mean&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.485&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.456&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.406&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;rgb_std&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.229&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.224&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.225&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_samples&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;72&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;72&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_samples&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;72&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;72&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;total_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data_filenames&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target_filenames&lt;/span&gt;&lt;span class="p"&gt;))[:&lt;/span&gt;&lt;span class="n"&gt;num_samples&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;total_size&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="n"&gt;total_size&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="n"&gt;total_size&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[:]&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plsr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plsr_network&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;load_params&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;plsr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;plsr.params&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;plsr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;initialize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Xavier&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plsr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hybridize&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;pretrained_net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vgg16&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pretrained&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;vgg_loss_net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_vgg_loss_net&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pretrained_net&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;vgg_loss_net&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;collect_params&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reset_ctx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;trainer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gluon&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;trainer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trainer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;plsr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;collect_params&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;adam&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;learning_rate&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;learning_rate&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;beta1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;beta2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.99&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dataloader&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gluon&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataLoader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gluon&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ArrayDataset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shuffle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;epoch&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;epochs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;training_loss&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;dataloader&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;data_list&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gluon&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utils&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split_and_load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;target_list&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gluon&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utils&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split_and_load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;autograd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;losses&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data_list&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target_list&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;losses&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;get_loss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vgg_loss_net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;plsr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rgb_mean&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copyto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;rgb_std&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copyto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ratio&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;loss&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;losses&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;loss&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;trainer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;training_loss&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="nb"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asscalar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;losses&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;epoch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;training_loss&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;training.log&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;training_loss&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;plsr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;plsr.params&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åœ¨å®ç°çš„æ—¶å€™ï¼Œè¶…åˆ†è¾¨ç‡åéœ€è¦ä¸€ä¸ªåå¤„ç†â€”â€”ç›´æ–¹å›¾åŒ¹é…ï¼Œè¿™é‡Œå‚è€ƒçš„æ˜¯&lt;a class="link" href="https://github.com/mapbox/rio-hist/blob/master/rio_hist/match.py" target="_blank" rel="noopener"
&gt;rio-hist&lt;/a&gt;ã€‚
å®éªŒæ•°æ®æœ€å¼€å§‹ç”¨çš„æ˜¯Microsoftçš„coco2017ï¼Œå°†æ¯å¼ å›¾éšæœºæˆªå–$144 \times 144$åƒç´ çš„å¤§å°ï¼Œç„¶åä½¿ç”¨å®½åº¦ä¸º1çš„é«˜æ–¯æ ¸è¿›è¡Œæ¨¡ç³Šå¤„ç†åï¼Œdownsamplingäº†ä¸€ä¸‹ï¼Œå¾—åˆ°äº†$72 \times 72$çš„å›¾ç‰‡ï¼Œä½œä¸ºç½‘ç»œçš„è¾“å…¥ã€‚åæ¥å‘ç°æ•ˆæœä¸æ˜¯å¾ˆå¥½ï¼Œå°±æ‰“ç®—å‘waifu2xä¸€æ ·ï¼Œåªè®­ç»ƒåŠ¨æ¼«å›¾ç‰‡ï¼Œä¸Škonachanä¸Šçˆ¬äº†ä¸€ä¸‡å¼ å›¾ï¼ŒåšåŒæ ·çš„å¤„ç†ã€‚æ­¤æ—¶çš„lossé™åˆ°äº†31.
&lt;img src="https://davidham3.github.io/blog/images/perceptual-losses-for-real-time-style-transfer-and-super-resolution/400_0.1_31.png"
loading="lazy"
alt="Fig1"
&gt;
è¿™æ˜¯è®­ç»ƒçš„æœ€å¥½çš„ä¸€æ¬¡ï¼Œæœ€å·¦ä¾§æ˜¯è¾“å…¥çš„æ¨¡ç³Šå›¾ç‰‡ï¼Œç¬¬äºŒåˆ—æ˜¯ç½‘ç»œçš„è¾“å‡ºï¼Œç¬¬ä¸‰åˆ—æ˜¯åšäº†ç›´æ–¹å›¾åŒ¹é…å¾—åˆ°çš„å›¾ç‰‡ï¼Œç¬¬å››åˆ—æ˜¯ground truthã€‚å¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šå°ç‚¹ç‚¹ï¼Œæˆ‘åˆ†ææ˜¯tv losså æ¯”å¤ªå°çš„åŸå› ï¼Œå½“å‰tv lossä¹˜ä»¥äº†0.1ã€‚äºæ˜¯å°†tv lossä¹˜ä»¥0.5ååˆè®­ç»ƒäº†ä¸€æ¬¡ï¼Œlossé™åˆ°äº†58ï¼Œç»“æœå¦‚ä¸‹ï¼š
&lt;img src="https://davidham3.github.io/blog/images/perceptual-losses-for-real-time-style-transfer-and-super-resolution/400_0.5_58.png"
loading="lazy"
alt="Fig2"
&gt;
æ„Ÿè§‰æ²¡æ³•çœ‹äº†ã€‚ã€‚ã€‚&lt;/p&gt;</description></item><item><title>Image Style Transfer Using Convolutional Neural Networks</title><link>https://davidham3.github.io/blog/p/image-style-transfer-using-convolutional-neural-networks/</link><pubDate>Sat, 24 Feb 2018 23:51:39 +0000</pubDate><guid>https://davidham3.github.io/blog/p/image-style-transfer-using-convolutional-neural-networks/</guid><description>&lt;p&gt;CVPR 2016ï¼Œå¤§ä½“åŸç†ï¼šé€‰æ‹©ä¸¤å¼ å›¾ç‰‡ï¼Œä¸€å¼ ä½œä¸ºé£æ ¼å›¾ç‰‡ï¼Œä¸€å¼ ä½œä¸ºå†…å®¹å›¾ç‰‡ï¼Œä»»åŠ¡æ˜¯å°†é£æ ¼å›¾ç‰‡ä¸­çš„é£æ ¼ï¼Œè¿ç§»åˆ°å†…å®¹å›¾ç‰‡ä¸Šã€‚æ–¹æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œåˆ©ç”¨åœ¨ImageNetä¸Šè®­ç»ƒå¥½çš„VGG19ï¼Œå› ä¸ºè¿™ç§æ·±å±‚æ¬¡çš„å·ç§¯ç¥ç»ç½‘ç»œçš„å·ç§¯æ ¸å¯ä»¥æœ‰æ•ˆçš„æ•æ‰ä¸€äº›ç‰¹å¾ï¼Œè¶Šé è¿‘è¾“å…¥çš„å·ç§¯å±‚æ•æ‰åˆ°çš„ä¿¡æ¯å±‚æ¬¡è¶Šä½ï¼Œè€Œè¶Šé è¿‘è¾“å‡ºçš„å·ç§¯å±‚æ•æ‰åˆ°çš„ä¿¡æ¯å±‚æ¬¡è¶Šé«˜ï¼Œå› æ­¤å¯ä»¥ç”¨é«˜å±‚æ¬¡çš„å·ç§¯å±‚æ•æ‰åˆ°çš„ä¿¡æ¯ä½œä¸ºå¯¹é£æ ¼å›¾ç‰‡é£æ ¼çš„æ•æ‰ã€‚è€Œä½å±‚æ¬¡çš„å·ç§¯å±‚ç”¨æ¥æ•æ‰å†…å®¹å›¾ç‰‡ä¸­çš„å†…å®¹ã€‚æ‰€ä»¥å®é™…çš„æ“ä½œå°±æ˜¯ï¼Œå°†å†…å®¹å›¾ç‰‡æ‰”åˆ°è®­ç»ƒå¥½çš„VGG19ä¸­ï¼Œå–å‡ºä½å±‚æ¬¡çš„å·ç§¯å±‚çš„è¾“å‡ºï¼Œä¿å­˜èµ·æ¥ï¼Œç„¶åå†æŠŠé£æ ¼å›¾ç‰‡æ”¾åˆ°VGG19ä¸­ï¼Œå–å‡ºé«˜å±‚æ¬¡çš„å·ç§¯å±‚çš„è¾“å‡ºï¼Œä¿å­˜èµ·æ¥ã€‚ç„¶åéšæœºç”Ÿæˆä¸€å¼ å›¾ç‰‡ï¼Œæ‰”åˆ°VGG19ä¸­ï¼Œå°†åˆšæ‰ä¿å­˜ä¸‹æ¥çš„å·ç§¯å±‚çš„è¾“å‡ºçš„é‚£äº›å·ç§¯å±‚çš„ç»“æœæ‹¿å‡ºæ¥ï¼Œå’Œé‚£äº›ä¿å­˜çš„ç»“æœåšä¸ªlossï¼Œç„¶åå¯¹è¾“å…¥çš„éšæœºç”Ÿæˆçš„å›¾ç‰‡è¿›è¡Œä¼˜åŒ–å³å¯ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Gatys_Image_Style_Transfer_CVPR_2016_paper.pdf" target="_blank" rel="noopener"
&gt;Image Style Transfer Using Convolutional Neural Networks&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="image-style-transfer-using-convolutional-neural-networks"&gt;Image Style Transfer Using Convolutional Neural Networks
&lt;/h1&gt;&lt;h1 id="å¤§ä½“åŸç†"&gt;å¤§ä½“åŸç†
&lt;/h1&gt;&lt;p&gt;é€‰æ‹©ä¸¤å¼ å›¾ç‰‡ï¼Œä¸€å¼ ä½œä¸ºé£æ ¼å›¾ç‰‡ï¼Œä¸€å¼ ä½œä¸ºå†…å®¹å›¾ç‰‡ï¼Œä»»åŠ¡æ˜¯å°†é£æ ¼å›¾ç‰‡ä¸­çš„é£æ ¼ï¼Œè¿ç§»åˆ°å†…å®¹å›¾ç‰‡ä¸Šã€‚æ–¹æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œåˆ©ç”¨åœ¨ImageNetä¸Šè®­ç»ƒå¥½çš„VGG19ï¼Œå› ä¸ºè¿™ç§æ·±å±‚æ¬¡çš„å·ç§¯ç¥ç»ç½‘ç»œçš„å·ç§¯æ ¸å¯ä»¥æœ‰æ•ˆçš„æ•æ‰ä¸€äº›ç‰¹å¾ï¼Œè¶Šé è¿‘è¾“å…¥çš„å·ç§¯å±‚æ•æ‰åˆ°çš„ä¿¡æ¯å±‚æ¬¡è¶Šä½ï¼Œè€Œè¶Šé è¿‘è¾“å‡ºçš„å·ç§¯å±‚æ•æ‰åˆ°çš„ä¿¡æ¯å±‚æ¬¡è¶Šé«˜ï¼Œå› æ­¤å¯ä»¥ç”¨é«˜å±‚æ¬¡çš„å·ç§¯å±‚æ•æ‰åˆ°çš„ä¿¡æ¯ä½œä¸ºå¯¹é£æ ¼å›¾ç‰‡é£æ ¼çš„æ•æ‰ã€‚è€Œä½å±‚æ¬¡çš„å·ç§¯å±‚ç”¨æ¥æ•æ‰å†…å®¹å›¾ç‰‡ä¸­çš„å†…å®¹ã€‚æ‰€ä»¥å®é™…çš„æ“ä½œå°±æ˜¯ï¼Œå°†å†…å®¹å›¾ç‰‡æ‰”åˆ°è®­ç»ƒå¥½çš„VGG19ä¸­ï¼Œå–å‡ºä½å±‚æ¬¡çš„å·ç§¯å±‚çš„è¾“å‡ºï¼Œä¿å­˜èµ·æ¥ï¼Œç„¶åå†æŠŠé£æ ¼å›¾ç‰‡æ”¾åˆ°VGG19ä¸­ï¼Œå–å‡ºé«˜å±‚æ¬¡çš„å·ç§¯å±‚çš„è¾“å‡ºï¼Œä¿å­˜èµ·æ¥ã€‚ç„¶åéšæœºç”Ÿæˆä¸€å¼ å›¾ç‰‡ï¼Œæ‰”åˆ°VGG19ä¸­ï¼Œå°†åˆšæ‰ä¿å­˜ä¸‹æ¥çš„å·ç§¯å±‚çš„è¾“å‡ºçš„é‚£äº›å·ç§¯å±‚çš„ç»“æœæ‹¿å‡ºæ¥ï¼Œå’Œé‚£äº›ä¿å­˜çš„ç»“æœåšä¸ªlossï¼Œç„¶åå¯¹è¾“å…¥çš„éšæœºç”Ÿæˆçš„å›¾ç‰‡è¿›è¡Œä¼˜åŒ–å³å¯ã€‚(Fig2)
&lt;img src="https://davidham3.github.io/blog/images/image-style-transfer-using-convolutional-neural-networks/Fig2.PNG"
loading="lazy"
alt="Fig2"
&gt;&lt;/p&gt;
&lt;p&gt;Figure 2. Style transfer algorithm. First content and style features are extracted and stored. The style image $\vec{a}$ is passed through the network and its style representation $A^l$ on all layers included are computed and stored(left). The content image $\vec{p}$ is passed through the network and the content representation $P^l$ in one layer is stored(right). Then a random white noise image $\vec{x}$ is passed through the network and its style features $G^l$ and content features $F^l$ are computed. On each layer included in the style representation, the element-wise mean squared difference between $G^l$ and $A^l$ is computed to give the style loss $\mathcal{L}_{style}$(left). Also the mean squared difference between $F^l$ and $P^l$ is computed to give the content loss $\mathcal{L}_{content}(right)$. The total loss $\mathcal{L}_{total}$ is then a linear combination between the content and the style loss. Its derivative with respect to the pixel values can be computed using error back-propagation(middle). This gradient is used to iteratively update the image $\vec{x}$ until it simultaneously matches the style features of the style image $\vec{a}$ and the content features of the content image $\vec{p}$(middle, bottom).&lt;/p&gt;
&lt;h1 id="deep-image-representations"&gt;Deep image representations
&lt;/h1&gt;&lt;p&gt;We used the feature space provided by a normalized version of the 16 convolutional and 5 pooling layers of the 19-layer VGG network. We normalized the network by scaling the weights such that the mean activation of each convolutional filter over images and positions is equal to one. Such re-scaling can be done for the VGG network without changing its output, because it contains only rectifying linear activation functions and no normalization or pooling over feature maps.
å…¶å®è¿™é‡Œæˆ‘ä¸æ˜¯å¾ˆæ˜ç™½ä¸ºä»€ä¹ˆä¸ä¼šå½±å“è¾“å‡ºã€‚&lt;/p&gt;
&lt;h2 id="content-representation"&gt;content representation
&lt;/h2&gt;&lt;p&gt;A layer with $N_l$ distinct filters has $N_l$ feature maps each of size $M_l$, where $M_l$ is the height times the width of the feature map. So the responses in a layer $l$ can be stored in a matrix $F^l \in \mathcal{R}^{N_l \times M_l}$ where $F^l_{ij}$ is the activation of the $i^{th}$ filter at position $j$ in layer $l$.
Let $\vec{p}$ and $\vec{x}$ be the original image and the image that is generated, and $P^l$ and $F^l$ their respective feature representation in layer $l$.
We then define the squared-error loss between the two feature representations
&lt;/p&gt;
$$\mathcal{L}\_{content}(\vec{p}, \vec{x}, l) = \frac{1}{2}\sum\_{i, j}(F^l\_{ij}-P^l\_{ij})^2$$&lt;p&gt;
The derivative of this loss with respect to the activations in layer $l$ equals&lt;/p&gt;
&lt;p&gt;\begin{equation}
\frac{\partial{\mathcal{L}&lt;em&gt;{content}}}{\partial{F^l&lt;/em&gt;{ij}}}=\left{
\begin{aligned}
&amp;amp; (F^l - P^l)&lt;em&gt;{ij} &amp;amp; if \ F^l&lt;/em&gt;{ij} &amp;gt; 0 \
&amp;amp; 0 &amp;amp; if \ F^l_{ij} &amp;lt; 0
\end{aligned}
\right.
\end{equation}&lt;/p&gt;
&lt;p&gt;from which the gradient with respect to the image $\vec{x}$ can be computed using standard error back-propagation.&lt;/p&gt;
&lt;p&gt;When Convolutional Neural Networks are trained on object recongnition, they develop a representation of the image that makes object information increasingly explicit along the processing hierarchy. Higher layers in the network capture the high-level &lt;em&gt;content&lt;/em&gt; in terms of objects and their arrangement in the input image but do not constrain the exact pixel values of the reconstruction very much. We therefore refer to the feature responses in higher layers of the network as the &lt;em&gt;content representation&lt;/em&gt;.&lt;/p&gt;
&lt;h2 id="style-representation"&gt;style representation
&lt;/h2&gt;&lt;p&gt;To obtain a representation of the style of an input image, we use a feature space designed to capture texture information. This feature space can be built on top of the filter responses in any layer of the network. It consists of the correlations between the different filter responses, where the expecation is taken over the spatial extent of the feature maps. These feature correlations are given by the Gram matrix $G^l \in \mathcal{R}^{N_l \times N_l}$, where $G^l_{ij}$ is the inner product between the vecotrized feature maps $i$ and $j$ in layer $l$:
&lt;/p&gt;
$$G^l\_{ij}=\sum\_kF^l\_{ik}F^l\_{jk}.$$&lt;p&gt;
By inducing the feature corelations of multiple layers, we obtain a stationary, multi-scale representation of the input image, which captures its texture information but not the global arrangement. Again, we can visualise the information captured by these style feature spaces built on different layers of the network by constructing an image that matches the style representation of a given input image. This is done by using gradient descent from a white noise image to minimise the mean-squared distance between the entries of the Gram matrices from the original image and the Gram matrices of the image to be generated.
Let $\vec{a}$ and $\vec{x}$ be the original image and the image that is generated, and $A^l$ and $G^l$ their respective style representation in layer $l$. The contribution of layer $l$ to the toal loss is then
&lt;/p&gt;
$$E\_l = \frac{1}{4N^2\_lM^2\_l}\sum\_{i,j}(G^l\_{ij} - A^l\_{ij})^2$$&lt;p&gt;
and the total style loss is
&lt;/p&gt;
$$\mathcal{L}\_{style}(\vec{a}, \vec{x})=\sum^L\_{l=0}w\_lE\_l,$$&lt;p&gt;
where $w_L$ are weighting factors of the contribution of each layer to the total loss (see below for specific values of $w_l$ in our results). The derivative of $E_l$ with respect to the activations in layer $l$ can be computed analytically:&lt;/p&gt;
&lt;p&gt;\begin{equation}
\frac{\partial{E_l}}{\partial{F^l_{ij}}}=\left{
\begin{aligned}
&amp;amp; \frac{1}{N^2_lM^2_l}((F^l)^T(G^l-A^l))&lt;em&gt;{ji} &amp;amp; if \ F^l&lt;/em&gt;{ij} &amp;gt; 0 \
&amp;amp; 0 &amp;amp; if \ F^l_{ij} &amp;lt; 0
\end{aligned}
\right.
\end{equation}
The gradient of $E_l$ with respect to the pixel values $\vec{x}$ can be readily computed using standard error back-propagation.&lt;/p&gt;
&lt;h2 id="style-transfer"&gt;style transfer
&lt;/h2&gt;&lt;p&gt;To transfer the style of an artwork $\vec{a}$ onto a photograph $\vec{p}$ we synthesise a new image that simultaneously matches the content representation of $\vec{p}$ and the style representation of $\vec{a}$. Thus we jointly minimise the distance of the feature representations of a white noise image fron the content representation of the photograph in one layer and the style representation of the painting defined on a numebr of layers of the Convolutional Neural Network. The loss function we minimise is
&lt;/p&gt;
$$\mathcal{L}\_{total}(\vec{p}, \vec{a}, \vec{x})=\alpha \mathcal{L}\_{content}(\vec{p}, \vec{x}) + \beta \mathcal{L}\_{style}(\vec{a}, \vec{x})$$&lt;p&gt;
where $\alpha$ and $\beta$ are the weighting factors for content and style reconstruction, respectively. The gradient with respect to the pixel values $\frac{\partial{\mathcal{L}_{total}}}{\partial{\vec{x}}}$ can be used as input for some numerical optimisation strategy. Here we use &lt;strong&gt;L-BFGS&lt;/strong&gt;, which we found to work best for image synthesis. To extract image information on comparable scales, we always resized the style image to the same size as the content image before computing its feature representations.&lt;/p&gt;
&lt;h1 id="results"&gt;Results
&lt;/h1&gt;&lt;h2 id="trade-off-between-content-and-style-matching"&gt;Trade-off between content and style matching
&lt;/h2&gt;&lt;p&gt;Since the loss function we minimise during image synthesis is a linear combination between the loss functions for content and style respectively, we can smoothly regulate the emphasis on either reconstructing the content or the style(Fig4).
&lt;img src="https://davidham3.github.io/blog/images/image-style-transfer-using-convolutional-neural-networks/Fig4.PNG"
loading="lazy"
alt="Fig4"
&gt;
Figure 4. Relative weighting of matching content and style of the respective source images. The ratio $\alpha / \beta$ between matching the content and matching the style increases from top left to bottom right. A high emphasis on the style effectively produces a texturised version of the style image(top left). A high emphasis on the content produces an image with only little stylisation(bottom right). In practice one can smoothly interpolate between the two extremes.&lt;/p&gt;
&lt;h2 id="effect-of-different-layers-of-the-convolutional-neural-network"&gt;Effect of different layers of the Convolutional Neural Network
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/image-style-transfer-using-convolutional-neural-networks/Fig5.PNG"
loading="lazy"
alt="Fig5"
&gt;
Figure 5. The effect of matching the content representation in different layers of the network. Matching the content on layer &amp;lsquo;conv2_2&amp;rsquo; preserves much of the fine structure of the original photograph and the synthesised image looks as if the texture of the painting is simply blended over the photograph(middle). When matching the content on layer &amp;lsquo;conv4_2&amp;rsquo; the texture of the painting and the content of the photograph merge together such that the content of photograph is displayed in the style of the painting(bottom). Both images were generated with the same choice of parameters($\alpha / \beta = 1 \times 10^{-3}$). The painting that served as the style image is shown in the bottom left corner and is name &lt;i&gt;Jesuiten â…¢&lt;/i&gt; by Lyonel Feininger, 1915.
Another important factor in the image synthesis process is the choice of layers to match the content and style representation on. As outlined above, the style representation is a multi-scale representation that includes multiple layers of the neural network. The number and position of these layers determines the local scale on which the style is matched, leading to different visual experiences. We find that matching the style representations up to higher layers in the network preserves local images structures an increasingly large scale, leading to a smoother and more continuous visual experience. Thus, the visually most appealing images are usually created by matching the style representation up to high layers in the network, which is why for all images shown we match the style features in layers &amp;lsquo;conv1_1&amp;rsquo;, &amp;lsquo;conv2_1&amp;rsquo;, &amp;lsquo;conv3_1&amp;rsquo;, &amp;lsquo;conv4_1&amp;rsquo;and &amp;lsquo;conv5_1&amp;rsquo; of the network.
To analyse the effect of using different layers to match the content features, we present a style transfer result obtained by stylising a photograph with the same artwork and parameter configuration ($\alpha / \beta = 1 \times 10^{-3}$), but in one matching the content features on layer &amp;lsquo;conv2_2&amp;rsquo; and in the other on layer &amp;lsquo;conv4_2&amp;rsquo;(Fig5). When matching the content on a lower layer of the network, the algorithm matches much of the detailed pixel information in the photograph and the generated image appears as if the texture of the artwork is merely blended over the photograph(Fig5, middle). In contrast, when matching the content features on a higher layer of the network, deatiled pixel information of the photograph is not as strongly constraint and the texture of the artwork and the content of the photograph are properly merged. That is, the fine structure of the image, for example the edges and colour map, is altered such that it agrees with the style of the artwork while displaying the content of the photograph(Fig5, bottom).&lt;/p&gt;
&lt;h2 id="initialisation-of-gradient-descent"&gt;Initialisation of gradient descent
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://davidham3.github.io/blog/images/image-style-transfer-using-convolutional-neural-networks/Fig6.PNG"
loading="lazy"
alt="Fig6"
&gt;
Figure 6. Initialisation of the gradient descent. &lt;b&gt;A&lt;/b&gt; Initialised from the content image. &lt;b&gt;B&lt;/b&gt; Initialised from the style image. &lt;b&gt;C&lt;/b&gt; Four samples of images initialised from different white noise images. For all images the ratio $\alpha / \beta$ was equal to $1 \times 10^{-3}$
We have initialised all images shown so far with white noise. However, one could also initialise the image synthesis with either the content image or the style image. We explored these two alternatives(Fig6 A, B): although they bias the final image somewhat towards the spatial structure of the initialisation, the different intialisation do not seem to have a strong effect on the outcome of the synthesis procedure. It should be noted that only initialising with noise allows to generate an arbitrary number of new images(Fig6 C). Initialising with a fixed image always deterministically leads to the same outcome (up to stochasticity in the gradient descent procedure).&lt;/p&gt;
&lt;h1 id="implementation"&gt;implementation
&lt;/h1&gt;&lt;p&gt;å…³äºå®ç°çš„éƒ¨åˆ†ï¼Œæˆ‘è‡ªå·±ç”¨mxnetå®ç°äº†ä¸€ä¸‹ï¼Œä½†æ˜¯å‘ç°å’Œmxnetçš„exampleé‡Œé¢ç»™çš„éå¸¸ä¸ä¸€æ ·ã€‚åœ¨ä»–ä»¬çš„å®ç°é‡Œé¢æåˆ°äº†Total variation denoisingã€‚è€Œä¸”ï¼Œè®ºæ–‡ä¸­çš„loss functionæ˜¯sum of squareï¼Œè€Œå›¾2ä¸­ç»™å‡ºæ˜¯MSEï¼Œå–äº†ä¸ªå¹³å‡å€¼ã€‚æˆ‘å®ç°æ˜¯æ—¶å€™æ²¡æœ‰å–å¹³å‡ï¼Œå¯¼è‡´losså¾ˆå¤§ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥è®­ç»ƒã€‚ä½†æ˜¯è‡ªå·±å®ç°çš„æ¢¯åº¦ä¸‹é™å¾ˆéš¾æ”¶æ•›ï¼Œéœ€è¦å¯¹æ¢¯åº¦è¿›è¡Œå½’ä¸€åŒ–ï¼Œåæ¥ä½¿ç”¨MXNetçš„gluonçš„Trainerè®­ç»ƒä¼šæ¯”åŸæ¥å¥½å¾ˆå¤šã€‚&lt;/p&gt;
&lt;h2 id="total-variation-denoising"&gt;Total variation denoising
&lt;/h2&gt;&lt;p&gt;In signal processing, total variation denoising, also known as total variation regularization, is a process, most often used in digital image processing, that has applications in noise removal.
&lt;img src="https://davidham3.github.io/blog/images/image-style-transfer-using-convolutional-neural-networks/ROF_Denoising_Example.png"
loading="lazy"
alt="â€œTotal variation denoisingâ€"
&gt;
Example of application of the Rudin et al.[1] total variation denoising technique to an image corrupted by Gaussian noise. This example created using demo_tv.m by Guy Gilboa, see external links.
It is based on the principle that signals with excessive and possibly spurious detail have high total variation, that is, the integral of the absolute gradient of the signla is high. According to this principle, reducing the total variation of the signal subject to it being a close match to the original signal, removes unwanted detail whilst preserving important details such as edges. The concept was pioneered by Rudin, Osher, and Fatemi in 1992 and so is today known as the ROF model.
This noise removal technique has advantages over simple techniques such as linear smoothing or median filtering which reduce noise but at the same time smooth away edges to a greater or lesser degree. By contrast, total variation denoising is remarkably effective at simultaneously preserving edges whilst smoothing away noise in flat regions, even at low signal-to-noise ratios.&lt;/p&gt;
&lt;h3 id="1d-signal-series"&gt;1D signal series
&lt;/h3&gt;&lt;p&gt;For a digital signal $y_n$, we can, for example, define the total variation as:
&lt;/p&gt;
$$V(y)=\sum\_n\vert y\_{n+1}-y\_n\vert$$&lt;p&gt;
Given an input signal $x_n$, the goal of total variation denoising is to find an approximation, call it $y_n$, that has smaller total variation than $x_n$ but is &amp;ldquo;close&amp;rdquo; to $x_n$. One measure of closeness is the sum of square errors:
&lt;/p&gt;
$$E(x, y)=\frac{1}{2}\sum\_n(x\_n - y\_n)^2$$&lt;p&gt;
So the total variation denoising problem amounts to minimizing the following discrete functional over the signal $y_n$:
&lt;/p&gt;
$$E(x, y) + \lambda V(y)$$&lt;p&gt;
By differentiating this functional with respect to $y_n$, we can derive a corresponding Euler-lagrange equation, that can be numerically integrated with the original signal $x_n$ as initial condition. This was the original approach. Alternatively, since this is a convex functional, techniques from convex optimization can be used to minimize it and find the solution $y_n$.&lt;/p&gt;
&lt;h3 id="regularization-properties"&gt;Regularization properties
&lt;/h3&gt;&lt;p&gt;The regularization parameter $\lambda $ plays a critical role in the denoising process. When $\lambda = 0$, there is no smoothing and the result is the same as minimizing the sum of squares. As $\lambda \to \infty $, however, the total variation term plays an increasingly strong role, which forces the result to have smaller total variation, at the expanse of being less like the input (noisy) signal. Thus, the choice of regularization parameter is critical to achieving just the right amount of noise removal.&lt;/p&gt;
&lt;h3 id="2d-signal-images"&gt;2D signal images
&lt;/h3&gt;&lt;p&gt;We now consider 2D signals $y$, such as images. The total variation norm proposed by the 1992 paper is
&lt;/p&gt;
$$V(y) = \sum\_{i,j}\sqrt{\vert y\_{i+1,j}-y\_{i,j}\vert ^2 + \vert y\_{i, j+1} - y\_{i, j}\vert ^2}$$&lt;p&gt;
and is isotropic and not differentiable. A variation that is sometimes used, since it may sometimes be easier to minimize, is an anisotropic version
&lt;/p&gt;
$$V\_{aniso}(y) = \sum\_{i,j}\sqrt{\vert y\_{i+1,j}-y\_{i,j}\vert ^2} + \sqrt{\vert y\_{i,j+1} - y\_{i,j}\vert ^2} = \sum\_{i,j}\vert y\_{i+1,j}-y\_{i,j}\vert + \vert y\_{i,j+1}-y\_{i,j}\vert $$&lt;p&gt;
The standard total variation denoising problem is still of the form
&lt;/p&gt;
$$\min\_yE(x,y)+\lambda V(y)$$&lt;p&gt;
where $E$ is the 2D L2 norm. In contrast to the 1D case, solving this denoising is non-trivial. A recent algorithm that solves this is known as the primal dual method.
Due in part to much research in compressed sensing in the mid-2000s, there are many algorithms, such as the split-Bregman method, that solve variants of this problem.&lt;/p&gt;
&lt;p&gt;ä¸è¿‡æˆ‘ä¸ªäººåœ¨å®ç°çš„æ—¶å€™ï¼Œå®ç°äº†ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¸€ä¸ªæ˜¯å¢åŠ äº†total variation denoisingï¼Œå¦ä¸€ä¸ªæ˜¯æ²¡å¢åŠ total variation denoisingçš„aã€‚
ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt; 10
&lt;/span&gt;&lt;span class="lnt"&gt; 11
&lt;/span&gt;&lt;span class="lnt"&gt; 12
&lt;/span&gt;&lt;span class="lnt"&gt; 13
&lt;/span&gt;&lt;span class="lnt"&gt; 14
&lt;/span&gt;&lt;span class="lnt"&gt; 15
&lt;/span&gt;&lt;span class="lnt"&gt; 16
&lt;/span&gt;&lt;span class="lnt"&gt; 17
&lt;/span&gt;&lt;span class="lnt"&gt; 18
&lt;/span&gt;&lt;span class="lnt"&gt; 19
&lt;/span&gt;&lt;span class="lnt"&gt; 20
&lt;/span&gt;&lt;span class="lnt"&gt; 21
&lt;/span&gt;&lt;span class="lnt"&gt; 22
&lt;/span&gt;&lt;span class="lnt"&gt; 23
&lt;/span&gt;&lt;span class="lnt"&gt; 24
&lt;/span&gt;&lt;span class="lnt"&gt; 25
&lt;/span&gt;&lt;span class="lnt"&gt; 26
&lt;/span&gt;&lt;span class="lnt"&gt; 27
&lt;/span&gt;&lt;span class="lnt"&gt; 28
&lt;/span&gt;&lt;span class="lnt"&gt; 29
&lt;/span&gt;&lt;span class="lnt"&gt; 30
&lt;/span&gt;&lt;span class="lnt"&gt; 31
&lt;/span&gt;&lt;span class="lnt"&gt; 32
&lt;/span&gt;&lt;span class="lnt"&gt; 33
&lt;/span&gt;&lt;span class="lnt"&gt; 34
&lt;/span&gt;&lt;span class="lnt"&gt; 35
&lt;/span&gt;&lt;span class="lnt"&gt; 36
&lt;/span&gt;&lt;span class="lnt"&gt; 37
&lt;/span&gt;&lt;span class="lnt"&gt; 38
&lt;/span&gt;&lt;span class="lnt"&gt; 39
&lt;/span&gt;&lt;span class="lnt"&gt; 40
&lt;/span&gt;&lt;span class="lnt"&gt; 41
&lt;/span&gt;&lt;span class="lnt"&gt; 42
&lt;/span&gt;&lt;span class="lnt"&gt; 43
&lt;/span&gt;&lt;span class="lnt"&gt; 44
&lt;/span&gt;&lt;span class="lnt"&gt; 45
&lt;/span&gt;&lt;span class="lnt"&gt; 46
&lt;/span&gt;&lt;span class="lnt"&gt; 47
&lt;/span&gt;&lt;span class="lnt"&gt; 48
&lt;/span&gt;&lt;span class="lnt"&gt; 49
&lt;/span&gt;&lt;span class="lnt"&gt; 50
&lt;/span&gt;&lt;span class="lnt"&gt; 51
&lt;/span&gt;&lt;span class="lnt"&gt; 52
&lt;/span&gt;&lt;span class="lnt"&gt; 53
&lt;/span&gt;&lt;span class="lnt"&gt; 54
&lt;/span&gt;&lt;span class="lnt"&gt; 55
&lt;/span&gt;&lt;span class="lnt"&gt; 56
&lt;/span&gt;&lt;span class="lnt"&gt; 57
&lt;/span&gt;&lt;span class="lnt"&gt; 58
&lt;/span&gt;&lt;span class="lnt"&gt; 59
&lt;/span&gt;&lt;span class="lnt"&gt; 60
&lt;/span&gt;&lt;span class="lnt"&gt; 61
&lt;/span&gt;&lt;span class="lnt"&gt; 62
&lt;/span&gt;&lt;span class="lnt"&gt; 63
&lt;/span&gt;&lt;span class="lnt"&gt; 64
&lt;/span&gt;&lt;span class="lnt"&gt; 65
&lt;/span&gt;&lt;span class="lnt"&gt; 66
&lt;/span&gt;&lt;span class="lnt"&gt; 67
&lt;/span&gt;&lt;span class="lnt"&gt; 68
&lt;/span&gt;&lt;span class="lnt"&gt; 69
&lt;/span&gt;&lt;span class="lnt"&gt; 70
&lt;/span&gt;&lt;span class="lnt"&gt; 71
&lt;/span&gt;&lt;span class="lnt"&gt; 72
&lt;/span&gt;&lt;span class="lnt"&gt; 73
&lt;/span&gt;&lt;span class="lnt"&gt; 74
&lt;/span&gt;&lt;span class="lnt"&gt; 75
&lt;/span&gt;&lt;span class="lnt"&gt; 76
&lt;/span&gt;&lt;span class="lnt"&gt; 77
&lt;/span&gt;&lt;span class="lnt"&gt; 78
&lt;/span&gt;&lt;span class="lnt"&gt; 79
&lt;/span&gt;&lt;span class="lnt"&gt; 80
&lt;/span&gt;&lt;span class="lnt"&gt; 81
&lt;/span&gt;&lt;span class="lnt"&gt; 82
&lt;/span&gt;&lt;span class="lnt"&gt; 83
&lt;/span&gt;&lt;span class="lnt"&gt; 84
&lt;/span&gt;&lt;span class="lnt"&gt; 85
&lt;/span&gt;&lt;span class="lnt"&gt; 86
&lt;/span&gt;&lt;span class="lnt"&gt; 87
&lt;/span&gt;&lt;span class="lnt"&gt; 88
&lt;/span&gt;&lt;span class="lnt"&gt; 89
&lt;/span&gt;&lt;span class="lnt"&gt; 90
&lt;/span&gt;&lt;span class="lnt"&gt; 91
&lt;/span&gt;&lt;span class="lnt"&gt; 92
&lt;/span&gt;&lt;span class="lnt"&gt; 93
&lt;/span&gt;&lt;span class="lnt"&gt; 94
&lt;/span&gt;&lt;span class="lnt"&gt; 95
&lt;/span&gt;&lt;span class="lnt"&gt; 96
&lt;/span&gt;&lt;span class="lnt"&gt; 97
&lt;/span&gt;&lt;span class="lnt"&gt; 98
&lt;/span&gt;&lt;span class="lnt"&gt; 99
&lt;/span&gt;&lt;span class="lnt"&gt;100
&lt;/span&gt;&lt;span class="lnt"&gt;101
&lt;/span&gt;&lt;span class="lnt"&gt;102
&lt;/span&gt;&lt;span class="lnt"&gt;103
&lt;/span&gt;&lt;span class="lnt"&gt;104
&lt;/span&gt;&lt;span class="lnt"&gt;105
&lt;/span&gt;&lt;span class="lnt"&gt;106
&lt;/span&gt;&lt;span class="lnt"&gt;107
&lt;/span&gt;&lt;span class="lnt"&gt;108
&lt;/span&gt;&lt;span class="lnt"&gt;109
&lt;/span&gt;&lt;span class="lnt"&gt;110
&lt;/span&gt;&lt;span class="lnt"&gt;111
&lt;/span&gt;&lt;span class="lnt"&gt;112
&lt;/span&gt;&lt;span class="lnt"&gt;113
&lt;/span&gt;&lt;span class="lnt"&gt;114
&lt;/span&gt;&lt;span class="lnt"&gt;115
&lt;/span&gt;&lt;span class="lnt"&gt;116
&lt;/span&gt;&lt;span class="lnt"&gt;117
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;mxnet&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;mx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;skimage&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;io&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;skimage&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;transform&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;matplotlib&lt;/span&gt; &lt;span class="n"&gt;inline&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet.gluon.model_zoo&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;vision&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet.gluon&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;autograd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet.gluon&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Trainer&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mxnet.gluon&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Parameter&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;warnings&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filterwarnings&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;ignore&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;content_image_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;../../gluon-tutorial-zh/img/pine-tree.jpg&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;style_image_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;the_starry_night.jpg&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;rgb_mean&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.485&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.456&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.406&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;rgb_std&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.229&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.224&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.225&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;preprocessing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;image_shape&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cpu&lt;/span&gt;&lt;span class="p"&gt;()):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;newImage&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;transform&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;image_shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;newImage&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;newImage&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;transpose&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;newImage&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;newImage&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;rgb_mean&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rgb_std&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;expand_dims&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;newImage&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;postprocessing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;newImage&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asnumpy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;rgb_std&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;rgb_mean&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;newImage&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;transpose&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_net&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style_layers&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content_layers&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HybridSequential&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style_layers&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;content_layers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pretrained_net&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;features&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hybridize&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;net&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;extract_features&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content_layers&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style_layers&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content_results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;style_results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;](&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;content_layers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content_results&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;style_layers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;style_results&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;content_results&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style_results&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;content_loss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_results&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content_target&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;losses&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_results&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;losses&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;content_results&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;content_target&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;square&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_n&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;losses&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;gram&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;feature_map&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;feature_map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;M&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;prod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;feature_map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;new_feature_map&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;feature_map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;new_feature_map&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_feature_map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;style_loss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style_results&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style_target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;weights&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;losses&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style_results&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gram&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style_results&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;style_target&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;square&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; \
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;prod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style_results&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;losses&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;weights&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_n&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;losses&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_loss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_loss_result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style_loss_result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ratio&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;content_loss_result&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;ratio&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;style_loss_result&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;style_layers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# è¿™é‡Œä¸è®ºæ–‡ä¸åŒï¼Œæˆ‘é€‰çš„å±‚æ¯”è®ºæ–‡ç»™å‡ºçš„æ›´æ·±ï¼Œä¸ºäº†æ•æ‰åˆ°æ›´æŠ½è±¡çš„style&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;content_layers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;21&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_net&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style_layers&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content_layers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;content_image&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;io&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_image_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;style_image&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;io&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style_image_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;pretrained_net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vgg19&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pretrained&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gpu&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;collect_params&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reset_ctx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;content_img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;preprocessing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_image&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;style_img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;preprocessing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style_image&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;output&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;content_img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;initialize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# output.set_data(nd.random_normal(shape = content_img.shape).abs())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_img&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;content_img_result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;extract_features&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content_img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content_layers&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style_layers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style_img_result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;extract_features&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style_img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content_layers&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style_layers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;content_results&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style_results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;extract_features&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;content_layers&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style_layers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;style_target&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;gram&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;style_img_result&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;trainer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Trainer&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;adam&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;learning_rate&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;beta1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;beta2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.99&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;epoch&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3000&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;autograd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content_results&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style_results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;extract_features&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;content_layers&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style_layers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;loss&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_loss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_loss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_results&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content_img_result&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;style_loss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style_results&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style_target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="mf"&gt;1e-4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;loss&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;epoch&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;loss&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asscalar&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;trainer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;postprocessing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œåœ¨å®ç°çš„æ—¶å€™ï¼Œä½¿ç”¨äº†è¿™ä¸ª2Då›¾åƒçš„total variation denoisingï¼Œä¹Ÿå°±æ˜¯ï¼Œæ¯ä¸ªåƒç´ åº”å°½å¯èƒ½çš„ä¸å·¦ä¾§å’Œä¸Šæ–¹çš„åƒç´ ç›¸è¿‘ã€‚æ‰€ä»¥æœ€åçš„ä¼˜åŒ–ç›®æ ‡æ˜¯ä¸‰éƒ¨åˆ†ç»„æˆï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯content lossï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯style lossï¼Œç¬¬ä¸‰éƒ¨åˆ†æ˜¯total variation lossã€‚
ç ”ç©¶ä¸€ä¸‹mxnetç»™å‡ºçš„example
model_vgg19.py&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;span class="lnt"&gt;44
&lt;/span&gt;&lt;span class="lnt"&gt;45
&lt;/span&gt;&lt;span class="lnt"&gt;46
&lt;/span&gt;&lt;span class="lnt"&gt;47
&lt;/span&gt;&lt;span class="lnt"&gt;48
&lt;/span&gt;&lt;span class="lnt"&gt;49
&lt;/span&gt;&lt;span class="lnt"&gt;50
&lt;/span&gt;&lt;span class="lnt"&gt;51
&lt;/span&gt;&lt;span class="lnt"&gt;52
&lt;/span&gt;&lt;span class="lnt"&gt;53
&lt;/span&gt;&lt;span class="lnt"&gt;54
&lt;/span&gt;&lt;span class="lnt"&gt;55
&lt;/span&gt;&lt;span class="lnt"&gt;56
&lt;/span&gt;&lt;span class="lnt"&gt;57
&lt;/span&gt;&lt;span class="lnt"&gt;58
&lt;/span&gt;&lt;span class="lnt"&gt;59
&lt;/span&gt;&lt;span class="lnt"&gt;60
&lt;/span&gt;&lt;span class="lnt"&gt;61
&lt;/span&gt;&lt;span class="lnt"&gt;62
&lt;/span&gt;&lt;span class="lnt"&gt;63
&lt;/span&gt;&lt;span class="lnt"&gt;64
&lt;/span&gt;&lt;span class="lnt"&gt;65
&lt;/span&gt;&lt;span class="lnt"&gt;66
&lt;/span&gt;&lt;span class="lnt"&gt;67
&lt;/span&gt;&lt;span class="lnt"&gt;68
&lt;/span&gt;&lt;span class="lnt"&gt;69
&lt;/span&gt;&lt;span class="lnt"&gt;70
&lt;/span&gt;&lt;span class="lnt"&gt;71
&lt;/span&gt;&lt;span class="lnt"&gt;72
&lt;/span&gt;&lt;span class="lnt"&gt;73
&lt;/span&gt;&lt;span class="lnt"&gt;74
&lt;/span&gt;&lt;span class="lnt"&gt;75
&lt;/span&gt;&lt;span class="lnt"&gt;76
&lt;/span&gt;&lt;span class="lnt"&gt;77
&lt;/span&gt;&lt;span class="lnt"&gt;78
&lt;/span&gt;&lt;span class="lnt"&gt;79
&lt;/span&gt;&lt;span class="lnt"&gt;80
&lt;/span&gt;&lt;span class="lnt"&gt;81
&lt;/span&gt;&lt;span class="lnt"&gt;82
&lt;/span&gt;&lt;span class="lnt"&gt;83
&lt;/span&gt;&lt;span class="lnt"&gt;84
&lt;/span&gt;&lt;span class="lnt"&gt;85
&lt;/span&gt;&lt;span class="lnt"&gt;86
&lt;/span&gt;&lt;span class="lnt"&gt;87
&lt;/span&gt;&lt;span class="lnt"&gt;88
&lt;/span&gt;&lt;span class="lnt"&gt;89
&lt;/span&gt;&lt;span class="lnt"&gt;90
&lt;/span&gt;&lt;span class="lnt"&gt;91
&lt;/span&gt;&lt;span class="lnt"&gt;92
&lt;/span&gt;&lt;span class="lnt"&gt;93
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# Licensed to the Apache Software Foundation (ASF) under one&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# or more contributor license agreements. See the NOTICE file&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# distributed with this work for additional information&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# regarding copyright ownership. The ASF licenses this file&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# to you under the Apache License, Version 2.0 (the&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# &amp;#34;License&amp;#34;); you may not use this file except in compliance&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# with the License. You may obtain a copy of the License at&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# http://www.apache.org/licenses/LICENSE-2.0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# Unless required by applicable law or agreed to in writing,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# software distributed under the License is distributed on an&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# &amp;#34;AS IS&amp;#34; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# KIND, either express or implied. See the License for the&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# specific language governing permissions and limitations&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# under the License.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;find_mxnet&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;mxnet&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;mx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;collections&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;namedtuple&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;ConvExecutor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;namedtuple&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ConvExecutor&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;executor&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;data&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;data_grad&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;style&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;content&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;arg_dict&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_symbol&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# declare symbol&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Variable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;data&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv1_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;conv1_1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;workspace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;relu1_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu1_1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conv1_1&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv1_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;conv1_2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;relu1_1&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;workspace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;relu1_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu1_2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conv1_2&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pool1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pooling&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pool1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;relu1_2&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;pool_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;avg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv2_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;conv2_1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pool1&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;workspace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;relu2_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu2_1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conv2_1&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv2_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;conv2_2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;relu2_1&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;workspace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;relu2_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu2_2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conv2_2&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pool2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pooling&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pool2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;relu2_2&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;pool_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;avg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv3_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;conv3_1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pool2&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;workspace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;relu3_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu3_1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conv3_1&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv3_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;conv3_2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;relu3_1&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;workspace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;relu3_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu3_2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conv3_2&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv3_3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;conv3_3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;relu3_2&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;workspace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;relu3_3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu3_3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conv3_3&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv3_4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;conv3_4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;relu3_3&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;workspace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;relu3_4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu3_4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conv3_4&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pool3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pooling&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pool3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;relu3_4&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;pool_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;avg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv4_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;conv4_1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pool3&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;512&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;workspace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;relu4_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu4_1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conv4_1&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv4_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;conv4_2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;relu4_1&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;512&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;workspace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;relu4_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu4_2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conv4_2&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv4_3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;conv4_3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;relu4_2&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;512&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;workspace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;relu4_3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu4_3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conv4_3&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv4_4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;conv4_4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;relu4_3&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;512&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;workspace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;relu4_4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu4_4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conv4_4&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pool4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pooling&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pool4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;relu4_4&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;pool_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;avg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;conv5_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;conv5_1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pool4&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;512&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;workspace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;relu5_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu5_1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;conv5_1&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;act_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# style and content layers&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;style&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Group&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;relu1_1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;relu2_1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;relu3_1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;relu4_1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;relu5_1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Group&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;relu4_2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_executor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;input_size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Group&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# make executor&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;arg_shapes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;output_shapes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aux_shapes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;infer_shape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;input_size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;input_size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;arg_names&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;list_arguments&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;arg_dict&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arg_names&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;arg_shapes&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;grad_dict&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;data&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;arg_dict&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;data&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copyto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# init with pretrained weight&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pretrained&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;./model/vgg19.params&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;arg_names&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;data&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;arg:&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;pretrained&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;pretrained&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copyto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arg_dict&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;Skip argument &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;executor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;arg_dict&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args_grad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;grad_dict&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;grad_req&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;write&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ConvExecutor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;arg_dict&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;data&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;data_grad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;grad_dict&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;data&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;outputs&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;outputs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;arg_dict&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;arg_dict&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_model&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;input_size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_symbol&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;get_executor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;input_size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;nstyle.py&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt; 10
&lt;/span&gt;&lt;span class="lnt"&gt; 11
&lt;/span&gt;&lt;span class="lnt"&gt; 12
&lt;/span&gt;&lt;span class="lnt"&gt; 13
&lt;/span&gt;&lt;span class="lnt"&gt; 14
&lt;/span&gt;&lt;span class="lnt"&gt; 15
&lt;/span&gt;&lt;span class="lnt"&gt; 16
&lt;/span&gt;&lt;span class="lnt"&gt; 17
&lt;/span&gt;&lt;span class="lnt"&gt; 18
&lt;/span&gt;&lt;span class="lnt"&gt; 19
&lt;/span&gt;&lt;span class="lnt"&gt; 20
&lt;/span&gt;&lt;span class="lnt"&gt; 21
&lt;/span&gt;&lt;span class="lnt"&gt; 22
&lt;/span&gt;&lt;span class="lnt"&gt; 23
&lt;/span&gt;&lt;span class="lnt"&gt; 24
&lt;/span&gt;&lt;span class="lnt"&gt; 25
&lt;/span&gt;&lt;span class="lnt"&gt; 26
&lt;/span&gt;&lt;span class="lnt"&gt; 27
&lt;/span&gt;&lt;span class="lnt"&gt; 28
&lt;/span&gt;&lt;span class="lnt"&gt; 29
&lt;/span&gt;&lt;span class="lnt"&gt; 30
&lt;/span&gt;&lt;span class="lnt"&gt; 31
&lt;/span&gt;&lt;span class="lnt"&gt; 32
&lt;/span&gt;&lt;span class="lnt"&gt; 33
&lt;/span&gt;&lt;span class="lnt"&gt; 34
&lt;/span&gt;&lt;span class="lnt"&gt; 35
&lt;/span&gt;&lt;span class="lnt"&gt; 36
&lt;/span&gt;&lt;span class="lnt"&gt; 37
&lt;/span&gt;&lt;span class="lnt"&gt; 38
&lt;/span&gt;&lt;span class="lnt"&gt; 39
&lt;/span&gt;&lt;span class="lnt"&gt; 40
&lt;/span&gt;&lt;span class="lnt"&gt; 41
&lt;/span&gt;&lt;span class="lnt"&gt; 42
&lt;/span&gt;&lt;span class="lnt"&gt; 43
&lt;/span&gt;&lt;span class="lnt"&gt; 44
&lt;/span&gt;&lt;span class="lnt"&gt; 45
&lt;/span&gt;&lt;span class="lnt"&gt; 46
&lt;/span&gt;&lt;span class="lnt"&gt; 47
&lt;/span&gt;&lt;span class="lnt"&gt; 48
&lt;/span&gt;&lt;span class="lnt"&gt; 49
&lt;/span&gt;&lt;span class="lnt"&gt; 50
&lt;/span&gt;&lt;span class="lnt"&gt; 51
&lt;/span&gt;&lt;span class="lnt"&gt; 52
&lt;/span&gt;&lt;span class="lnt"&gt; 53
&lt;/span&gt;&lt;span class="lnt"&gt; 54
&lt;/span&gt;&lt;span class="lnt"&gt; 55
&lt;/span&gt;&lt;span class="lnt"&gt; 56
&lt;/span&gt;&lt;span class="lnt"&gt; 57
&lt;/span&gt;&lt;span class="lnt"&gt; 58
&lt;/span&gt;&lt;span class="lnt"&gt; 59
&lt;/span&gt;&lt;span class="lnt"&gt; 60
&lt;/span&gt;&lt;span class="lnt"&gt; 61
&lt;/span&gt;&lt;span class="lnt"&gt; 62
&lt;/span&gt;&lt;span class="lnt"&gt; 63
&lt;/span&gt;&lt;span class="lnt"&gt; 64
&lt;/span&gt;&lt;span class="lnt"&gt; 65
&lt;/span&gt;&lt;span class="lnt"&gt; 66
&lt;/span&gt;&lt;span class="lnt"&gt; 67
&lt;/span&gt;&lt;span class="lnt"&gt; 68
&lt;/span&gt;&lt;span class="lnt"&gt; 69
&lt;/span&gt;&lt;span class="lnt"&gt; 70
&lt;/span&gt;&lt;span class="lnt"&gt; 71
&lt;/span&gt;&lt;span class="lnt"&gt; 72
&lt;/span&gt;&lt;span class="lnt"&gt; 73
&lt;/span&gt;&lt;span class="lnt"&gt; 74
&lt;/span&gt;&lt;span class="lnt"&gt; 75
&lt;/span&gt;&lt;span class="lnt"&gt; 76
&lt;/span&gt;&lt;span class="lnt"&gt; 77
&lt;/span&gt;&lt;span class="lnt"&gt; 78
&lt;/span&gt;&lt;span class="lnt"&gt; 79
&lt;/span&gt;&lt;span class="lnt"&gt; 80
&lt;/span&gt;&lt;span class="lnt"&gt; 81
&lt;/span&gt;&lt;span class="lnt"&gt; 82
&lt;/span&gt;&lt;span class="lnt"&gt; 83
&lt;/span&gt;&lt;span class="lnt"&gt; 84
&lt;/span&gt;&lt;span class="lnt"&gt; 85
&lt;/span&gt;&lt;span class="lnt"&gt; 86
&lt;/span&gt;&lt;span class="lnt"&gt; 87
&lt;/span&gt;&lt;span class="lnt"&gt; 88
&lt;/span&gt;&lt;span class="lnt"&gt; 89
&lt;/span&gt;&lt;span class="lnt"&gt; 90
&lt;/span&gt;&lt;span class="lnt"&gt; 91
&lt;/span&gt;&lt;span class="lnt"&gt; 92
&lt;/span&gt;&lt;span class="lnt"&gt; 93
&lt;/span&gt;&lt;span class="lnt"&gt; 94
&lt;/span&gt;&lt;span class="lnt"&gt; 95
&lt;/span&gt;&lt;span class="lnt"&gt; 96
&lt;/span&gt;&lt;span class="lnt"&gt; 97
&lt;/span&gt;&lt;span class="lnt"&gt; 98
&lt;/span&gt;&lt;span class="lnt"&gt; 99
&lt;/span&gt;&lt;span class="lnt"&gt;100
&lt;/span&gt;&lt;span class="lnt"&gt;101
&lt;/span&gt;&lt;span class="lnt"&gt;102
&lt;/span&gt;&lt;span class="lnt"&gt;103
&lt;/span&gt;&lt;span class="lnt"&gt;104
&lt;/span&gt;&lt;span class="lnt"&gt;105
&lt;/span&gt;&lt;span class="lnt"&gt;106
&lt;/span&gt;&lt;span class="lnt"&gt;107
&lt;/span&gt;&lt;span class="lnt"&gt;108
&lt;/span&gt;&lt;span class="lnt"&gt;109
&lt;/span&gt;&lt;span class="lnt"&gt;110
&lt;/span&gt;&lt;span class="lnt"&gt;111
&lt;/span&gt;&lt;span class="lnt"&gt;112
&lt;/span&gt;&lt;span class="lnt"&gt;113
&lt;/span&gt;&lt;span class="lnt"&gt;114
&lt;/span&gt;&lt;span class="lnt"&gt;115
&lt;/span&gt;&lt;span class="lnt"&gt;116
&lt;/span&gt;&lt;span class="lnt"&gt;117
&lt;/span&gt;&lt;span class="lnt"&gt;118
&lt;/span&gt;&lt;span class="lnt"&gt;119
&lt;/span&gt;&lt;span class="lnt"&gt;120
&lt;/span&gt;&lt;span class="lnt"&gt;121
&lt;/span&gt;&lt;span class="lnt"&gt;122
&lt;/span&gt;&lt;span class="lnt"&gt;123
&lt;/span&gt;&lt;span class="lnt"&gt;124
&lt;/span&gt;&lt;span class="lnt"&gt;125
&lt;/span&gt;&lt;span class="lnt"&gt;126
&lt;/span&gt;&lt;span class="lnt"&gt;127
&lt;/span&gt;&lt;span class="lnt"&gt;128
&lt;/span&gt;&lt;span class="lnt"&gt;129
&lt;/span&gt;&lt;span class="lnt"&gt;130
&lt;/span&gt;&lt;span class="lnt"&gt;131
&lt;/span&gt;&lt;span class="lnt"&gt;132
&lt;/span&gt;&lt;span class="lnt"&gt;133
&lt;/span&gt;&lt;span class="lnt"&gt;134
&lt;/span&gt;&lt;span class="lnt"&gt;135
&lt;/span&gt;&lt;span class="lnt"&gt;136
&lt;/span&gt;&lt;span class="lnt"&gt;137
&lt;/span&gt;&lt;span class="lnt"&gt;138
&lt;/span&gt;&lt;span class="lnt"&gt;139
&lt;/span&gt;&lt;span class="lnt"&gt;140
&lt;/span&gt;&lt;span class="lnt"&gt;141
&lt;/span&gt;&lt;span class="lnt"&gt;142
&lt;/span&gt;&lt;span class="lnt"&gt;143
&lt;/span&gt;&lt;span class="lnt"&gt;144
&lt;/span&gt;&lt;span class="lnt"&gt;145
&lt;/span&gt;&lt;span class="lnt"&gt;146
&lt;/span&gt;&lt;span class="lnt"&gt;147
&lt;/span&gt;&lt;span class="lnt"&gt;148
&lt;/span&gt;&lt;span class="lnt"&gt;149
&lt;/span&gt;&lt;span class="lnt"&gt;150
&lt;/span&gt;&lt;span class="lnt"&gt;151
&lt;/span&gt;&lt;span class="lnt"&gt;152
&lt;/span&gt;&lt;span class="lnt"&gt;153
&lt;/span&gt;&lt;span class="lnt"&gt;154
&lt;/span&gt;&lt;span class="lnt"&gt;155
&lt;/span&gt;&lt;span class="lnt"&gt;156
&lt;/span&gt;&lt;span class="lnt"&gt;157
&lt;/span&gt;&lt;span class="lnt"&gt;158
&lt;/span&gt;&lt;span class="lnt"&gt;159
&lt;/span&gt;&lt;span class="lnt"&gt;160
&lt;/span&gt;&lt;span class="lnt"&gt;161
&lt;/span&gt;&lt;span class="lnt"&gt;162
&lt;/span&gt;&lt;span class="lnt"&gt;163
&lt;/span&gt;&lt;span class="lnt"&gt;164
&lt;/span&gt;&lt;span class="lnt"&gt;165
&lt;/span&gt;&lt;span class="lnt"&gt;166
&lt;/span&gt;&lt;span class="lnt"&gt;167
&lt;/span&gt;&lt;span class="lnt"&gt;168
&lt;/span&gt;&lt;span class="lnt"&gt;169
&lt;/span&gt;&lt;span class="lnt"&gt;170
&lt;/span&gt;&lt;span class="lnt"&gt;171
&lt;/span&gt;&lt;span class="lnt"&gt;172
&lt;/span&gt;&lt;span class="lnt"&gt;173
&lt;/span&gt;&lt;span class="lnt"&gt;174
&lt;/span&gt;&lt;span class="lnt"&gt;175
&lt;/span&gt;&lt;span class="lnt"&gt;176
&lt;/span&gt;&lt;span class="lnt"&gt;177
&lt;/span&gt;&lt;span class="lnt"&gt;178
&lt;/span&gt;&lt;span class="lnt"&gt;179
&lt;/span&gt;&lt;span class="lnt"&gt;180
&lt;/span&gt;&lt;span class="lnt"&gt;181
&lt;/span&gt;&lt;span class="lnt"&gt;182
&lt;/span&gt;&lt;span class="lnt"&gt;183
&lt;/span&gt;&lt;span class="lnt"&gt;184
&lt;/span&gt;&lt;span class="lnt"&gt;185
&lt;/span&gt;&lt;span class="lnt"&gt;186
&lt;/span&gt;&lt;span class="lnt"&gt;187
&lt;/span&gt;&lt;span class="lnt"&gt;188
&lt;/span&gt;&lt;span class="lnt"&gt;189
&lt;/span&gt;&lt;span class="lnt"&gt;190
&lt;/span&gt;&lt;span class="lnt"&gt;191
&lt;/span&gt;&lt;span class="lnt"&gt;192
&lt;/span&gt;&lt;span class="lnt"&gt;193
&lt;/span&gt;&lt;span class="lnt"&gt;194
&lt;/span&gt;&lt;span class="lnt"&gt;195
&lt;/span&gt;&lt;span class="lnt"&gt;196
&lt;/span&gt;&lt;span class="lnt"&gt;197
&lt;/span&gt;&lt;span class="lnt"&gt;198
&lt;/span&gt;&lt;span class="lnt"&gt;199
&lt;/span&gt;&lt;span class="lnt"&gt;200
&lt;/span&gt;&lt;span class="lnt"&gt;201
&lt;/span&gt;&lt;span class="lnt"&gt;202
&lt;/span&gt;&lt;span class="lnt"&gt;203
&lt;/span&gt;&lt;span class="lnt"&gt;204
&lt;/span&gt;&lt;span class="lnt"&gt;205
&lt;/span&gt;&lt;span class="lnt"&gt;206
&lt;/span&gt;&lt;span class="lnt"&gt;207
&lt;/span&gt;&lt;span class="lnt"&gt;208
&lt;/span&gt;&lt;span class="lnt"&gt;209
&lt;/span&gt;&lt;span class="lnt"&gt;210
&lt;/span&gt;&lt;span class="lnt"&gt;211
&lt;/span&gt;&lt;span class="lnt"&gt;212
&lt;/span&gt;&lt;span class="lnt"&gt;213
&lt;/span&gt;&lt;span class="lnt"&gt;214
&lt;/span&gt;&lt;span class="lnt"&gt;215
&lt;/span&gt;&lt;span class="lnt"&gt;216
&lt;/span&gt;&lt;span class="lnt"&gt;217
&lt;/span&gt;&lt;span class="lnt"&gt;218
&lt;/span&gt;&lt;span class="lnt"&gt;219
&lt;/span&gt;&lt;span class="lnt"&gt;220
&lt;/span&gt;&lt;span class="lnt"&gt;221
&lt;/span&gt;&lt;span class="lnt"&gt;222
&lt;/span&gt;&lt;span class="lnt"&gt;223
&lt;/span&gt;&lt;span class="lnt"&gt;224
&lt;/span&gt;&lt;span class="lnt"&gt;225
&lt;/span&gt;&lt;span class="lnt"&gt;226
&lt;/span&gt;&lt;span class="lnt"&gt;227
&lt;/span&gt;&lt;span class="lnt"&gt;228
&lt;/span&gt;&lt;span class="lnt"&gt;229
&lt;/span&gt;&lt;span class="lnt"&gt;230
&lt;/span&gt;&lt;span class="lnt"&gt;231
&lt;/span&gt;&lt;span class="lnt"&gt;232
&lt;/span&gt;&lt;span class="lnt"&gt;233
&lt;/span&gt;&lt;span class="lnt"&gt;234
&lt;/span&gt;&lt;span class="lnt"&gt;235
&lt;/span&gt;&lt;span class="lnt"&gt;236
&lt;/span&gt;&lt;span class="lnt"&gt;237
&lt;/span&gt;&lt;span class="lnt"&gt;238
&lt;/span&gt;&lt;span class="lnt"&gt;239
&lt;/span&gt;&lt;span class="lnt"&gt;240
&lt;/span&gt;&lt;span class="lnt"&gt;241
&lt;/span&gt;&lt;span class="lnt"&gt;242
&lt;/span&gt;&lt;span class="lnt"&gt;243
&lt;/span&gt;&lt;span class="lnt"&gt;244
&lt;/span&gt;&lt;span class="lnt"&gt;245
&lt;/span&gt;&lt;span class="lnt"&gt;246
&lt;/span&gt;&lt;span class="lnt"&gt;247
&lt;/span&gt;&lt;span class="lnt"&gt;248
&lt;/span&gt;&lt;span class="lnt"&gt;249
&lt;/span&gt;&lt;span class="lnt"&gt;250
&lt;/span&gt;&lt;span class="lnt"&gt;251
&lt;/span&gt;&lt;span class="lnt"&gt;252
&lt;/span&gt;&lt;span class="lnt"&gt;253
&lt;/span&gt;&lt;span class="lnt"&gt;254
&lt;/span&gt;&lt;span class="lnt"&gt;255
&lt;/span&gt;&lt;span class="lnt"&gt;256
&lt;/span&gt;&lt;span class="lnt"&gt;257
&lt;/span&gt;&lt;span class="lnt"&gt;258
&lt;/span&gt;&lt;span class="lnt"&gt;259
&lt;/span&gt;&lt;span class="lnt"&gt;260
&lt;/span&gt;&lt;span class="lnt"&gt;261
&lt;/span&gt;&lt;span class="lnt"&gt;262
&lt;/span&gt;&lt;span class="lnt"&gt;263
&lt;/span&gt;&lt;span class="lnt"&gt;264
&lt;/span&gt;&lt;span class="lnt"&gt;265
&lt;/span&gt;&lt;span class="lnt"&gt;266
&lt;/span&gt;&lt;span class="lnt"&gt;267
&lt;/span&gt;&lt;span class="lnt"&gt;268
&lt;/span&gt;&lt;span class="lnt"&gt;269
&lt;/span&gt;&lt;span class="lnt"&gt;270
&lt;/span&gt;&lt;span class="lnt"&gt;271
&lt;/span&gt;&lt;span class="lnt"&gt;272
&lt;/span&gt;&lt;span class="lnt"&gt;273
&lt;/span&gt;&lt;span class="lnt"&gt;274
&lt;/span&gt;&lt;span class="lnt"&gt;275
&lt;/span&gt;&lt;span class="lnt"&gt;276
&lt;/span&gt;&lt;span class="lnt"&gt;277
&lt;/span&gt;&lt;span class="lnt"&gt;278
&lt;/span&gt;&lt;span class="lnt"&gt;279
&lt;/span&gt;&lt;span class="lnt"&gt;280
&lt;/span&gt;&lt;span class="lnt"&gt;281
&lt;/span&gt;&lt;span class="lnt"&gt;282
&lt;/span&gt;&lt;span class="lnt"&gt;283
&lt;/span&gt;&lt;span class="lnt"&gt;284
&lt;/span&gt;&lt;span class="lnt"&gt;285
&lt;/span&gt;&lt;span class="lnt"&gt;286
&lt;/span&gt;&lt;span class="lnt"&gt;287
&lt;/span&gt;&lt;span class="lnt"&gt;288
&lt;/span&gt;&lt;span class="lnt"&gt;289
&lt;/span&gt;&lt;span class="lnt"&gt;290
&lt;/span&gt;&lt;span class="lnt"&gt;291
&lt;/span&gt;&lt;span class="lnt"&gt;292
&lt;/span&gt;&lt;span class="lnt"&gt;293
&lt;/span&gt;&lt;span class="lnt"&gt;294
&lt;/span&gt;&lt;span class="lnt"&gt;295
&lt;/span&gt;&lt;span class="lnt"&gt;296
&lt;/span&gt;&lt;span class="lnt"&gt;297
&lt;/span&gt;&lt;span class="lnt"&gt;298
&lt;/span&gt;&lt;span class="lnt"&gt;299
&lt;/span&gt;&lt;span class="lnt"&gt;300
&lt;/span&gt;&lt;span class="lnt"&gt;301
&lt;/span&gt;&lt;span class="lnt"&gt;302
&lt;/span&gt;&lt;span class="lnt"&gt;303
&lt;/span&gt;&lt;span class="lnt"&gt;304
&lt;/span&gt;&lt;span class="lnt"&gt;305
&lt;/span&gt;&lt;span class="lnt"&gt;306
&lt;/span&gt;&lt;span class="lnt"&gt;307
&lt;/span&gt;&lt;span class="lnt"&gt;308
&lt;/span&gt;&lt;span class="lnt"&gt;309
&lt;/span&gt;&lt;span class="lnt"&gt;310
&lt;/span&gt;&lt;span class="lnt"&gt;311
&lt;/span&gt;&lt;span class="lnt"&gt;312
&lt;/span&gt;&lt;span class="lnt"&gt;313
&lt;/span&gt;&lt;span class="lnt"&gt;314
&lt;/span&gt;&lt;span class="lnt"&gt;315
&lt;/span&gt;&lt;span class="lnt"&gt;316
&lt;/span&gt;&lt;span class="lnt"&gt;317
&lt;/span&gt;&lt;span class="lnt"&gt;318
&lt;/span&gt;&lt;span class="lnt"&gt;319
&lt;/span&gt;&lt;span class="lnt"&gt;320
&lt;/span&gt;&lt;span class="lnt"&gt;321
&lt;/span&gt;&lt;span class="lnt"&gt;322
&lt;/span&gt;&lt;span class="lnt"&gt;323
&lt;/span&gt;&lt;span class="lnt"&gt;324
&lt;/span&gt;&lt;span class="lnt"&gt;325
&lt;/span&gt;&lt;span class="lnt"&gt;326
&lt;/span&gt;&lt;span class="lnt"&gt;327
&lt;/span&gt;&lt;span class="lnt"&gt;328
&lt;/span&gt;&lt;span class="lnt"&gt;329
&lt;/span&gt;&lt;span class="lnt"&gt;330
&lt;/span&gt;&lt;span class="lnt"&gt;331
&lt;/span&gt;&lt;span class="lnt"&gt;332
&lt;/span&gt;&lt;span class="lnt"&gt;333
&lt;/span&gt;&lt;span class="lnt"&gt;334
&lt;/span&gt;&lt;span class="lnt"&gt;335
&lt;/span&gt;&lt;span class="lnt"&gt;336
&lt;/span&gt;&lt;span class="lnt"&gt;337
&lt;/span&gt;&lt;span class="lnt"&gt;338
&lt;/span&gt;&lt;span class="lnt"&gt;339
&lt;/span&gt;&lt;span class="lnt"&gt;340
&lt;/span&gt;&lt;span class="lnt"&gt;341
&lt;/span&gt;&lt;span class="lnt"&gt;342
&lt;/span&gt;&lt;span class="lnt"&gt;343
&lt;/span&gt;&lt;span class="lnt"&gt;344
&lt;/span&gt;&lt;span class="lnt"&gt;345
&lt;/span&gt;&lt;span class="lnt"&gt;346
&lt;/span&gt;&lt;span class="lnt"&gt;347
&lt;/span&gt;&lt;span class="lnt"&gt;348
&lt;/span&gt;&lt;span class="lnt"&gt;349
&lt;/span&gt;&lt;span class="lnt"&gt;350
&lt;/span&gt;&lt;span class="lnt"&gt;351
&lt;/span&gt;&lt;span class="lnt"&gt;352
&lt;/span&gt;&lt;span class="lnt"&gt;353
&lt;/span&gt;&lt;span class="lnt"&gt;354
&lt;/span&gt;&lt;span class="lnt"&gt;355
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# Licensed to the Apache Software Foundation (ASF) under one&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# or more contributor license agreements. See the NOTICE file&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# distributed with this work for additional information&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# regarding copyright ownership. The ASF licenses this file&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# to you under the Apache License, Version 2.0 (the&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# &amp;#34;License&amp;#34;); you may not use this file except in compliance&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# with the License. You may obtain a copy of the License at&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# http://www.apache.org/licenses/LICENSE-2.0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# Unless required by applicable law or agreed to in writing,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# software distributed under the License is distributed on an&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# &amp;#34;AS IS&amp;#34; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# KIND, either express or implied. See the License for the&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# specific language governing permissions and limitations&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# under the License.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;find_mxnet&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;mxnet&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;mx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;importlib&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;logging&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;basicConfig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;argparse&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;collections&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;namedtuple&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;skimage&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;io&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;transform&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;skimage.restoration&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;denoise_tv_chambolle&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;CallbackData&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;namedtuple&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CallbackData&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field_names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;eps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;epoch&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;img&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;filename&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_args&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arglist&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;argparse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ArgumentParser&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;neural style&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# é€‰æ‹©æ¨¡å‹ï¼Œé»˜è®¤æ˜¯VGG19&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--model&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;vgg19&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;choices&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;vgg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;the pretrained model to use&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# å†…å®¹å›¾ç‰‡çš„è·¯å¾„&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--content-image&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;input/IMG_4343.jpg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;the content image&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# é£æ ¼å›¾ç‰‡çš„è·¯å¾„&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--style-image&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;input/starry_night.jpg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;the style image&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# åœæ­¢è¿­ä»£çš„é˜ˆå€¼ï¼Œè‹¥relative changeå°äºè¿™ä¸ªæ•°å°±åœæ­¢è¿­ä»£&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--stop-eps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;.005&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;stop if the relative chanage is less than eps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# å†…å®¹å›¾ç‰‡åœ¨lossä¸Šçš„æƒé‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--content-weight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;the weight for the content image&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# é£æ ¼å›¾ç‰‡åœ¨lossä¸Šçš„æƒé‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--style-weight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;the weight for the style image&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# total variationåœ¨lossä¸Šçš„æƒé‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--tv-weight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;the magtitute on TV loss&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# æœ€å¤§è¿­ä»£æ¬¡æ•°&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--max-num-epochs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;the maximal number of training epochs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--max-long-edge&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;600&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;resize the content image&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# åˆå§‹çš„å­¦ä¹ ç‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--lr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;.001&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;the initial learning rate&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# ä½¿ç”¨å“ªå—GPU&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--gpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;which gpu card to use, -1 means using cpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# è¾“å‡ºå›¾åƒçš„è·¯å¾„&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--output_dir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;output/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;the output image&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# æ¯å¤šå°‘è½®ä¿å­˜ä¸€æ¬¡å½“å‰çš„è¾“å‡ºç»“æœ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--save-epochs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;save the output every n epochs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--remove-noise&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;.02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;the magtitute to remove noise&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# æ¯è¿­ä»£å¤šå°‘è½®å‡å°ä¸€ä¸‹å­¦ä¹ ç‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--lr-sched-delay&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;how many epochs between decreasing learning rate&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# å­¦ä¹ ç‡è¡°å‡å› å­&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--lr-sched-factor&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;factor to decrease learning rate on schedule&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;arglist&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parse_args&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parse_args&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arglist&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;PreprocessContentImage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;long_edge&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; å†…å®¹å›¾ç‰‡é¢„å¤„ç†
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; Parameter: path, str, å›¾ç‰‡è·¯å¾„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; long_edge, int, float, str(float), å›¾åƒè¢«ç¼©æ”¾åé•¿è¾¹çš„é•¿åº¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# è¯»å–å›¾ç‰‡ï¼Œä½¿ç”¨skimage.io.imreadï¼Œè¿”å›numpy.ndarray&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;io&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# img.shapeå‰ä¸¤ä¸ªæ•°åˆ†åˆ«æ˜¯å¤šå°‘è¡Œå’Œå¤šå°‘åˆ—ï¼Œç¬¬ä¸‰ä¸ªæ•°æ˜¯channelæ•°&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;load the content image, size = &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# resizeä¸€ä¸‹å›¾ç‰‡ï¼Œresizeåçš„èŒƒå›´åœ¨0åˆ°1å†…&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;factor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;long_edge&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;new_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;resized_img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;transform&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# ä¹˜ä»¥256æ¢å¤åˆ°åŸæ¥çš„åŒºé—´&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sample&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;resized_img&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;256&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# swap axes to make image from (224, 224, 3) to (3, 224, 224)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sample&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;swapaxes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sample&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;swapaxes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# sub meanï¼Œè¿™é‡Œçš„å‡å€¼åº”è¯¥æ˜¯ImageNetæ•°æ®é›†åœ¨RGBä¸‰é€šé“ä¸Šçš„å‡å€¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mf"&gt;123.68&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mf"&gt;116.779&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mf"&gt;103.939&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;resize the content image to &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;PreprocessStyleImage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; å¯¹é£æ ¼å›¾ç‰‡çš„é¢„å¤„ç†
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; Parameter: path, str, å›¾åƒè·¯å¾„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; shape, tuple, é•¿åº¦ä¸º4çš„tupleï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ å’Œç¬¬å››ä¸ªå…ƒç´ æ˜¯content imageçš„size
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;io&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;resized_img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;transform&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sample&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;resized_img&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;256&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sample&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;swapaxes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sample&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;swapaxes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mf"&gt;123.68&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mf"&gt;116.779&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mf"&gt;103.939&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;PostprocessImage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; å¯¹å›¾åƒçš„åå¤„ç†
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; Parameter: img, numpy.ndarray
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mf"&gt;123.68&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mf"&gt;116.779&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mf"&gt;103.939&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;swapaxes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;swapaxes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# clipå‡½æ•°æ˜¯ç”¨æ¥ç æ‰å°äºä¸‹ç•Œå’Œå¤§äºä¸Šå±Šçš„æ•°çš„&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;astype&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;uint8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;SaveImage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;remove_noise&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; ä¿å­˜å›¾ç‰‡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; Parameter: img, numpy.ndarray
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; filename, str
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; remove_noise, float, default=0.,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;save output to &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;PostprocessImage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;remove_noise&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;denoise_tv_chambolle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;remove_noise&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;multichannel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;io&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imsave&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;style_gram_symbol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;input_size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; Parameter: input_size, tuple, length=2, è¡¨ç¤ºcontent imageçš„size
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; style, mx.sym.Groupï¼Œé‡Œé¢æ˜¯styleå¯¹åº”çš„å±‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;output_shapes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;infer_shape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;input_size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;input_size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;gram_list&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;grad_scale&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;list_outputs&lt;/span&gt;&lt;span class="p"&gt;())):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;shape&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;output_shapes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;target_shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;prod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:]))))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# use fully connected to quickly do dot(x, x^T)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;gram&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FullyConnected&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_hidden&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;gram_list&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gram&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# grad_scale c*h*w*c&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;grad_scale&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;prod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:])&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Group&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gram_list&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;grad_scale&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_loss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gram&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;gram_loss&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gram&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;list_outputs&lt;/span&gt;&lt;span class="p"&gt;())):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;gvar&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Variable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;target_gram_&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;gram_loss&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;square&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gvar&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gram&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;cvar&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Variable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;target_content&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content_loss&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;square&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cvar&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Group&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gram_loss&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;content_loss&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_tv_grad_executor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tv_weight&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&amp;#34;create TV gradient executor with input binded on img
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;tv_weight&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;nchannel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;simg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Variable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;img&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;skernel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Variable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;kernel&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;channels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SliceChannel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;simg&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_outputs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;nchannel&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Concat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Convolution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;channels&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;skernel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;num_filter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;no_bias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stride&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nchannel&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;kernel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;8.0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;tv_weight&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;img&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;kernel&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;train_nstyle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&amp;#34;Train a neural style network.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; Args are from argparse and control input, output, hyper-parameters.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; callback allows for display of training progress.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# input&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dev&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gpu&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gpu&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gpu&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cpu&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content_np&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;PreprocessContentImage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_image&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max_long_edge&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;style_np&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;PreprocessStyleImage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;style_image&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;content_np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# sizeæ˜¯å†…å®¹å›¾ç‰‡çš„å°ºå¯¸&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;content_np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# model&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Executor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;namedtuple&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Executor&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;executor&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;data&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;data_grad&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# å¯¼å…¥&amp;#39;model_vgg19.py&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;model_module&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;importlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;import_module&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;model_&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# è·å–åˆ°styleå’Œcontentä¸¤ä¸ªmx.sym.Groupï¼Œé‡Œé¢è£…ç€styleå’Œcontentå±‚&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;model_module&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_symbol&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# è·å–åˆ°æ‰€æœ‰styleå±‚çš„gramçŸ©é˜µå’Œgrad scale&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;gram&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;gscale&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;style_gram_symbol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;model_executor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;model_module&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_executor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gram&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[:]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;style_np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;style_array&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;style_array&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copyto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cpu&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[:]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;content_np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content_array&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copyto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cpu&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# delete the executor&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;model_executor&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;style_loss&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content_loss&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_loss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gram&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;model_executor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;model_module&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_executor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;style_loss&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content_loss&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;grad_array&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;style_array&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;style_array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copyto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arg_dict&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;target_gram_&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;grad_array&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,),&lt;/span&gt; &lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;style_weight&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;gscale&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;grad_array&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,),&lt;/span&gt; &lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_weight&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asscalar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;grad_array&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;content_array&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copyto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arg_dict&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;target_content&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# train&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# initialize img with random noise&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;[:]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rnd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;lr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lr_scheduler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FactorScheduler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lr_sched_delay&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;factor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lr_sched_factor&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;optimizer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;optimizer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NAG&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;learning_rate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;wd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0001&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;momentum&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.95&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;lr_scheduler&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;optim_state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;optimizer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;start training arguments &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;old_img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copyto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;clip_norm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;prod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tv_grad_executor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_tv_grad_executor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tv_weight&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max_num_epochs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copyto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;grad_array&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;gnorm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data_grad&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asscalar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;gnorm&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;clip_norm&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data_grad&lt;/span&gt;&lt;span class="p"&gt;[:]&lt;/span&gt; &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="n"&gt;clip_norm&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;gnorm&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;tv_grad_executor&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;tv_grad_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;optimizer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data_grad&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;tv_grad_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;outputs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;optim_state&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;optimizer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;model_executor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data_grad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;optim_state&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;new_img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;eps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old_img&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;new_img&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;new_img&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asscalar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;old_img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new_img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copyto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;epoch &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s1"&gt;, relative change &lt;/span&gt;&lt;span class="si"&gt;%f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;eps&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;eps&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stop_eps&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;eps &amp;lt; args.stop_eps, training finished&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;break&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;cbdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;eps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;eps&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;epoch&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save_epochs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;outfn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;output_dir&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;e_&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.jpg&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;npimg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new_img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asnumpy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;SaveImage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npimg&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;outfn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;remove_noise&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;cbdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;filename&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;outfn&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;cbdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;img&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;npimg&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cbdata&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;final_fn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;output_dir&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/final.jpg&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;SaveImage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;new_img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asnumpy&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;final_fn&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_args&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;train_nstyle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>leetcode algorithms #3</title><link>https://davidham3.github.io/blog/p/leetcode-algorithms-%233/</link><pubDate>Sat, 24 Feb 2018 16:13:34 +0000</pubDate><guid>https://davidham3.github.io/blog/p/leetcode-algorithms-%233/</guid><description>&lt;p&gt;leetcode algorithms #3. Title: Longest Substring Without Repeating Characters&lt;/p&gt;
&lt;h1 id="longest-substring-without-repeating-characters"&gt;Longest Substring Without Repeating Characters
&lt;/h1&gt;&lt;h2 id="description"&gt;Description
&lt;/h2&gt;&lt;p&gt;Given a string, find the length of the longest substring without repeating characters.&lt;/p&gt;
&lt;p&gt;Examples:&lt;/p&gt;
&lt;p&gt;Given &amp;ldquo;abcabcbb&amp;rdquo;, the answer is &amp;ldquo;abc&amp;rdquo;, which the length is 3.&lt;/p&gt;
&lt;p&gt;Given &amp;ldquo;bbbbb&amp;rdquo;, the answer is &amp;ldquo;b&amp;rdquo;, with the length of 1.&lt;/p&gt;
&lt;p&gt;Given &amp;ldquo;pwwkew&amp;rdquo;, the answer is &amp;ldquo;wke&amp;rdquo;, with the length of 3. Note that the answer must be a substring, &amp;ldquo;pwke&amp;rdquo; is a subsequence and not a substring.&lt;/p&gt;
&lt;h2 id="discussion"&gt;Discussion
&lt;/h2&gt;&lt;p&gt;æšä¸¾ï¼š
å¯¹äºç¬¬ä¸€ä¸ªå­—æ¯ï¼Œä»å®ƒå¼€å§‹å‘åæ‰¾ï¼Œå¦‚æœéå†çš„é€”ä¸­å‘ç°æœ‰é‡å¤çš„å­—æ¯ï¼Œåœæ­¢ï¼Œè®°å½•é•¿åº¦ã€‚
ç„¶åä»ç¬¬äºŒä¸ªå­—æ¯å¼€å§‹ï¼Œç”¨åŒæ ·çš„æ–¹æ³•æ‰¾ã€‚
æœ€åå–æ‰€æœ‰é•¿åº¦ä¸­çš„æœ€å¤§å€¼å³å¯ã€‚
æ—¶é—´å¤æ‚åº¦: $O(n^2)$ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒç§æ–¹æ³•
æ»‘åŠ¨çª—æ‰«æ
å¯¹äºç¬¬ä¸€ä¸ªå­—æ¯ï¼Œä»å®ƒå¼€å§‹å‘åæ‰¾ï¼Œè®°å½•æ­¤æ—¶é¦–å­—ç¬¦çš„ä¸‹æ ‡ä¸º$i$ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªé‡å¤çš„å­—æ¯åï¼Œè®°å½•æœ«å­—ç¬¦å°æ ‡ä¸º$j$ã€‚å¾—åˆ°é•¿åº¦$j-i$ã€‚ç„¶å$i++$ï¼Œå°†é¦–å­—ç¬¦ä¸‹æ ‡å‘åç§»åŠ¨ä¸€ä½ï¼Œ$j$å˜ä¸º$i+1$ï¼Œè‹¥ç¢°åˆ°é‡å¤çš„å­—ç¬¦ï¼Œè®¡ç®—é•¿åº¦$j-i$ï¼Œ$i++$ï¼Œåå¤å¦‚æ­¤ï¼Œæœ€åå–å¤§çš„é‚£ä¸ªæ•°ã€‚
è¿™ä¸ªæ—¶é—´å¤æ‚åº¦æˆ‘ä¸ä¼šè®¡ç®—ï¼Œä¸è¿‡åº”è¯¥æ˜¯æ¯”çº¿æ€§è¦æ…¢ä¸€ç‚¹ç‚¹ï¼Œä½†æ˜¯è¶‹è¿‘äºçº¿æ€§æ‰«æçš„é€Ÿåº¦ã€‚
ä¸‹é¢çš„sliding windowæ˜¯æˆ‘å®ç°çš„ï¼Œçœ‹äº†ä¸€ä¸‹åˆ«äººçš„solution
Algorithm&lt;/p&gt;
&lt;p&gt;The naive approach is very straightforward. But it is too slow. So how can we optimize it?&lt;/p&gt;
&lt;p&gt;In the naive approaches, we repeatedly check a substring to see if it has duplicate character. But it is unnecessary. If a substring $s_{ij}$ from index $i$ to $j - 1$ is already checked to have no duplicate characters. We only need to check if $s[j]$ is already in the substring $s_{ij}$.&lt;/p&gt;
&lt;p&gt;To check if a character is already in the substring, we can scan the substring, which leads to an $O(n^2)$ algorithm. But we can do better.&lt;/p&gt;
&lt;p&gt;By using HashSet as a sliding window, checking if a character in the current can be done in $O(1)$.&lt;/p&gt;
&lt;p&gt;A sliding window is an abstract concept commonly used in array/string problems. A window is a range of elements in the array/string which usually defined by the start and end indices, i.e. $[i, j)$ (left-closed, right-open). A sliding window is a window &amp;ldquo;slides&amp;rdquo; its two boundaries to the certain direction. For example, if we slide $[i, j)$ to the right by $1$ element, then it becomes $[i+1, j+1)$ (left-closed, right-open).&lt;/p&gt;
&lt;p&gt;Back to our problem. We use HashSet to store the characters in current window $[i, j)$ ($j = i$ initially). Then we slide the index $j$ to the right. If it is not in the HashSet, we slide $j$ further. Doing so until $s[j]$ is already in the HashSet. At this point, we found the maximum size of substrings without duplicate characters start with index $i$. If we do this for all $i$, we get our answer.&lt;/p&gt;
&lt;p&gt;æ—¶é—´å¤æ‚åº¦: $O(2n)=O(n)$ï¼Œæœ€åæƒ…å†µä¸‹æ¯ä¸ªå…ƒç´ è¢«è®¿é—®ä¸¤æ¬¡
ç©ºé—´å¤æ‚åº¦ï¼š$O(min(m, n))$ï¼Œ$n$æ˜¯å­—ç¬¦ä¸²$s$çš„é•¿åº¦ï¼Œ$m$æ˜¯å­—ç¬¦ç§ç±»ä¸ªæ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;lengthOfLongestSubstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Character&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HashSet&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// try to extend the range [i, j]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;contains&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;charAt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;))){&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;charAt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;charAt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯ä¼˜åŒ–çš„sliding window
The above solution requires at most $2n$ steps. In fact, it could be optimized to require only $n$ steps. Instead of using a set to tell if a character exists or not, we could define a mapping of the characters to its index. Then we can skip the characters immediately when we found a repeated character.&lt;/p&gt;
&lt;p&gt;The reason is that if $s[j]$ have a duplicate in the range $[i, j)$ with index $j&amp;rsquo;$, we don&amp;rsquo;t need to increase $i$ little by little. We can skip all the elements in the range $[i, j&amp;rsquo;]$ and let $i$ to be $j&amp;rsquo; + 1$ directly.
ç¬¬ä¸‰ç§æ–¹æ³•çš„æ„æ€æ˜¯ï¼Œå¦‚æœåœ¨å½“å‰çš„æ»‘åŠ¨çª—$i$åˆ°$j$ä¸­ï¼Œç°åœ¨çš„jæŒ‡å‘çš„å…ƒç´ ä¸$j&amp;rsquo;$ç›¸åŒï¼Œè¿™ä¸ª$j&amp;rsquo;$åœ¨$i$å’Œ$j$ä¹‹é—´ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è®©$i=j+1$ã€‚
å‡è®¾å­—ç¬¦ä¸²æ˜¯&amp;rsquo;pwawb&amp;rsquo;ï¼Œ$i$æ˜¯0ï¼Œ$j$æ˜¯3ï¼Œæ­¤æ—¶$j&amp;rsquo;$æ˜¯1ï¼Œæˆ‘ä»¬å¯ä»¥è®©$i$ç›´æ¥è·³åˆ°$j&amp;rsquo;+1$ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ç§èƒ½é©¬ä¸ŠæŸ¥è¯¢åˆ°$j&amp;rsquo;$çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯Hash tableã€‚
$j$è¿™ä¸ªä¸‹æ ‡åœ¨ç§»åŠ¨è¿‡ç¨‹ä¸­ï¼Œå¦‚æœç¢°åˆ°æ²¡æœ‰çš„è§è¿‡çš„å…ƒç´ ï¼Œå°±åŠ å…¥tableä¸­ï¼Œå¦‚æœè§è¿‡ï¼Œå°±è·å¾—å½“å‰çš„é•¿åº¦$j-i$ï¼Œä½†æ˜¯è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªæ›´æ–°å»¶æ—¶çš„é—®é¢˜ã€‚
æ¯”å¦‚å­—ç¬¦ä¸²&amp;quot;abba&amp;quot;ï¼Œtableä¸­{&amp;lsquo;a&amp;rsquo;: 0, &amp;lsquo;b&amp;rsquo;: 1}ï¼Œæ­¤æ—¶$j$ä¸º2ï¼Œé‚£ä¹ˆ$j&amp;rsquo;$ä¸º1ï¼Œéœ€è¦å°†$i$æŒªåˆ°tableä¸­$j$å¯¹åº”çš„å€¼$+1$ï¼Œå³$i=2$ï¼Œè€Œä¸”è¦æ›´æ–°tableä¸º{&amp;lsquo;a&amp;rsquo;: 0, &amp;lsquo;b&amp;rsquo;: 2}ã€‚æ¥ä¸‹æ¥$j=3$ï¼Œ$a$å·²ç»åœ¨tableä¸­äº†ï¼Œä½†æ˜¯$j&amp;rsquo;$åœ¨$i$å‰é¢ï¼Œæ­¤æ—¶å°±ä¸åº”è¯¥ç§»åŠ¨$i$äº†ï¼Œç›´æ¥æ›´æ–°$a$å³å¯ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;lengthOfLongestSubstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Character&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Integer&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HashMap&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// current index of character&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// try to extend the range [i, j]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;containsKey&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;charAt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;charAt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="na"&gt;charAt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id="implementation"&gt;implementation
&lt;/h2&gt;&lt;p&gt;sliding window 1 runing time: 816ms&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;lengthOfLongestSubstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; :type s: str
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; :rtype: int
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;lengths&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;chars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;lengths&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;chars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;lengths&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lengths&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;sliding window 2 runing time: 120ms&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;lengthOfLongestSubstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; :type s: str
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; :rtype: int
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;chars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;sliding window 3 runing time: 128ms&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;lengthOfLongestSubstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; :type s: str
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; :rtype: int
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;chars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>leetcode algorithms #2</title><link>https://davidham3.github.io/blog/p/leetcode-algorithms-%232/</link><pubDate>Sat, 24 Feb 2018 13:29:05 +0000</pubDate><guid>https://davidham3.github.io/blog/p/leetcode-algorithms-%232/</guid><description>&lt;p&gt;leetcode algorithms #2. Title: Add Two Numbers&lt;/p&gt;
&lt;h1 id="add-two-numbers"&gt;Add Two Numbers
&lt;/h1&gt;&lt;h2 id="description"&gt;Description
&lt;/h2&gt;&lt;p&gt;You are given two non-empty linked lists representing two non-negative integers. The digits are stored in reverse order and each of their nodes contain a single digit. Add the two numbers and return it as a linked list.&lt;/p&gt;
&lt;p&gt;You may assume the two numbers do not contain any leading zero, except the number 0 itself.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Example&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Input: (2 -&amp;gt; 4 -&amp;gt; 3) + (5 -&amp;gt; 6 -&amp;gt; 4)
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Output: 7 -&amp;gt; 0 -&amp;gt; 8
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Explanation: 342 + 465 = 807.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id="discussion"&gt;Discussion
&lt;/h2&gt;&lt;p&gt;ç”¨ä¸¤ä¸ªæŒ‡é’ˆï¼Œåˆ†åˆ«æŒ‡å‘ä¸¤ä¸ªlistçš„é¦–å…ƒç´ ï¼ŒåŠ ä¸€ä¸ªè¿›ä½tï¼Œåªèƒ½æ˜¯0æˆ–è€…1ï¼Œç”¨æ¥è¡¨ç¤ºè¿›ä½ã€‚
æŒ‡é’ˆæŒ‡å‘çš„ä¸¤ä¸ªå…ƒç´ è¿˜æœ‰è¿›ä½å…ƒç´ tç›¸åŠ ï¼Œå¯¹10æ±‚æ¨¡å¾—åˆ°å½“å‰è¿™ä½å­˜åˆ°æ–°çš„èŠ‚ç‚¹ä¸­ï¼Œç”¨è¿™ä¸ªå’Œé™¤ä»¥10ï¼Œæ›´æ–°è¿›ä½å…ƒç´ ï¼Œä¸¤æŒ‡é’ˆåŒæ—¶å‘åç§»åŠ¨ã€‚
æœ€åå‰©ä½™çš„ä¸€æˆªçš„å¤´èŠ‚ç‚¹ä¸è¿›ä½å…ƒç´ tç›¸åŠ åï¼Œç›´æ¥æ¥åˆ°å½“å‰çš„èŠ‚ç‚¹åé¢ã€‚&lt;/p&gt;
&lt;h2 id="solutions"&gt;Solutions
&lt;/h2&gt;&lt;p&gt;python3 runtime:112ms&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# Definition for singly-linked list.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# class ListNode:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# def __init__(self, x):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# self.val = x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# self.next = None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;addTwoNumbers&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;l1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;l2&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; :type l1: ListNode
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; :type l2: ListNode
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; :rtype: ListNode
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;l2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ListNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;current&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;l1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;l2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;l1&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;l2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;l2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ListNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;current&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;l1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;l2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;l1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ListNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;current&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;l1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;l2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ListNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;current&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;l2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ListNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>leetcode algorithms #1</title><link>https://davidham3.github.io/blog/p/leetcode-algorithms-%231/</link><pubDate>Sat, 24 Feb 2018 00:20:18 +0000</pubDate><guid>https://davidham3.github.io/blog/p/leetcode-algorithms-%231/</guid><description>&lt;p&gt;leetcode algorithms #1. Title: Two sum&lt;/p&gt;
&lt;h1 id="two-sum"&gt;Two sum
&lt;/h1&gt;&lt;h2 id="description"&gt;Description
&lt;/h2&gt;&lt;p&gt;Given an array of integers, return indices of the two numbers such that they add up to a specific target.&lt;/p&gt;
&lt;p&gt;You may assume that each input would have exactly one solution, and you may not use the same element twice.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Example&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Given nums = [2, 7, 11, 15], target = 9,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Because nums[0] + nums[1] = 2 + 7 = 9,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;return [0, 1].
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id="discussion"&gt;Discussion
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;æšä¸¾(brute force)ï¼š
å¯ä»¥ç”¨æšä¸¾ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(n^2)$, ç©ºé—´å¤æ‚åº¦$O(1)$ï¼Œ$n$ä¸ºé—®é¢˜è§„æ¨¡ã€‚
å‡è®¾ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºarrayä¸­çš„ç¬¬ä¸€ä¸ªï¼Œä»ç¬¬äºŒä¸ªå¼€å§‹éå†ï¼Œæ‰¾åˆ°å’Œç¬¬ä¸€ä¸ªæ•°ç›¸åŠ å¾—åˆ°targetçš„é‚£ä¸ªå…ƒç´ çš„ä¸‹æ ‡ï¼Œç„¶åå‡è®¾ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯arrayä¸­çš„ç¬¬äºŒä¸ªï¼Œå¦‚æ­¤åå¤éå†ï¼Œç›´åˆ°æ±‚è§£æˆåŠŸæˆ–æ— è§£ã€‚&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨hash tableæ±‚è§£
é¦–å…ˆå¼„ä¸ªhash tableï¼Œç„¶åå°†è¿™äº›æ•°ä»¥åŠä»–ä»¬çš„ä¸‹æ ‡ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å…¥hash tableä¸­ï¼Œç„¶åç”¨targetåˆ†åˆ«å‡å»arrayä¸­çš„æ•°å­—ï¼Œå‡å»åå¾—åˆ°çš„å·®è‹¥åœ¨hash tableä¸­ï¼Œé‚£ä¹ˆå½“å‰çš„å‡æ•°çš„ä¸‹æ ‡ï¼Œä»¥åŠå·®åœ¨hash tableä¸­å¯¹åº”çš„å€¼ï¼Œå³ä¸ºç­”æ¡ˆã€‚å­˜å…¥hash tableæ—¶çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(n)$ï¼Œç”¨targetå‡å»arrayä¸­å…ƒç´ è¿›è¡Œæœç´¢çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(n)$ã€‚
æ•…æ—¶é—´å¤æ‚åº¦ä¸º$O(n)$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º$O(n)$ã€‚&lt;/li&gt;
&lt;li&gt;çœ‹äº†è®ºå›ä¹‹åå‘ç°è¿˜æœ‰ç¬¬ä¸‰ç§è§£æ³•ï¼Œä¸Šè¿°çš„æ–¹æ³•2éå†äº†ä¸¤æ¬¡æ‰€æœ‰çš„æ•°å­—ï¼Œè€Œæ–¹æ³•3åªéœ€éå†ä¸€æ¬¡ã€‚è¿™ä¸ªæ–¹æ³•åˆ©ç”¨äº†è¿™é“é¢˜çš„ä¸€ä¸ªç‰¹æ€§ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸¤ä¸ªç›¸åŠ ç­‰äºtargetçš„å…ƒç´ ï¼Œä¸€å®šæ˜¯ä¸€å‰ä¸€åå‡ºç°çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æ„é€ hash tableçš„æ—¶å€™ï¼Œå°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼šå…ˆæ’å…¥ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åçœ‹targetå‡å»å®ƒåœ¨ä¸åœ¨hash tableä¸­ï¼Œä¸€èˆ¬æƒ…å†µï¼Œè‚¯å®šæ˜¯ä¸åœ¨çš„ï¼Œé‚£ä¹ˆå°±å°†è¿™ä¸ªå…ƒç´ åŠå…¶ä¸‹æ ‡ç»„æˆçš„key-value pairåŠ å…¥hash tableä¸­ï¼Œç„¶åç»§ç»­éå†ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå‡è®¾æˆ‘ä»¬åˆšæ‰å·²ç»å°†æœ€ç»ˆç»“æœçš„ç¬¬ä¸€ä¸ªå…ƒç´ åŠ å…¥äº†hash tableï¼Œé‚£éå†åˆ°ç¬¬äºŒä¸ªç»“æœçš„æ—¶å€™ï¼Œä¸ä¹‹ç›¸å¯¹çš„é‚£ä¸ªå…ƒç´ è‚¯å®šåœ¨hash tableä¸­ï¼Œåªè¦å°†hash tableä¸­targetå‡å»å®ƒçš„å€¼ï¼Œå’Œå½“å‰å…ƒç´ çš„ä¸‹æ ‡è¿”å›å³å¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="solutions"&gt;Solutions
&lt;/h2&gt;&lt;h3 id="solution2"&gt;Solution2
&lt;/h3&gt;&lt;p&gt;python3 runtime: 40ms&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;twoSum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; :type nums: List[int]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; :type target: int
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; :rtype: List[int]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# å»ºhash table&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;table&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;diff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;diff&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# éœ€è¦åˆ¤æ–­ä¼šä¸ä¼šæœ‰target = num + numçš„æƒ…å†µï¼Œæœ‰çš„è¯å°±è·³è¿‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;c++ runtime: 10ms&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cpp" data-lang="cpp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;twoSum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;diff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id="solution3"&gt;Solution3
&lt;/h3&gt;&lt;p&gt;c++ runtime: 10ms&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cpp" data-lang="cpp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;twoSum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;diff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>è®­ç»ƒç¥ç»ç½‘ç»œæ—¶å½’ä¸€åŒ–çš„ç›®çš„</title><link>https://davidham3.github.io/blog/p/%E8%AE%AD%E7%BB%83%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E6%97%B6%E5%BD%92%E4%B8%80%E5%8C%96%E7%9A%84%E7%9B%AE%E7%9A%84/</link><pubDate>Wed, 21 Feb 2018 13:39:35 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E8%AE%AD%E7%BB%83%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E6%97%B6%E5%BD%92%E4%B8%80%E5%8C%96%E7%9A%84%E7%9B%AE%E7%9A%84/</guid><description>&lt;p&gt;åœ¨è®­ç»ƒç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œnormalizationæ˜¯å¿…ä¸å¯å°‘çš„ï¼ŒåŸå› æ˜¯å¦‚æœä¸è¿›è¡Œnormalizationï¼Œåœ¨æ›´æ–°å‚æ•°çš„æ—¶å€™ä¼šå‡ºç°zig zagçš„ç°è±¡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è®­ç»ƒç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œå½’ä¸€åŒ–æ˜¯å¿…ä¸å¯å°‘çš„ã€‚ä¹‹å‰ä¸€ç›´ä¸ç†è§£ä¸ºä»€ä¹ˆéè¦å½’ä¸€åŒ–ï¼Œç›´åˆ°çœ‹äº†cs231nè¿™é—¨è¯¾æ‰çŸ¥é“å½’ä¸€åŒ–çš„ç›®çš„ã€‚
äº‹å®ä¸Šè¿™ä¸ªé—®é¢˜ä¸»è¦æ˜¯é’ˆå¯¹æ¿€æ´»å‡½æ•°æ¥è¯´ï¼Œå¦‚æœä¸å½’ä¸€åŒ–çš„è¯ï¼Œé‚£ä¹ˆæ¿€æ´»å‡½æ•°åœ¨åå‘ä¼ æ’­çš„æ—¶å€™å°±ä¼šå‡ºé—®é¢˜ã€‚
&lt;img src="https://davidham3.github.io/blog/images/%e8%ae%ad%e7%bb%83%e7%a5%9e%e7%bb%8f%e7%bd%91%e7%bb%9c%e6%97%b6%e5%bd%92%e4%b8%80%e5%8c%96%e7%9a%84%e7%9b%ae%e7%9a%84/1.png"
loading="lazy"
alt="â€œå›¾1 å›¾ç‰‡æ¥æºäºcs231nâ€"
&gt;
å›¾1 å·¦ä¾§æ˜¯åŸå§‹æ•°æ®ï¼Œä¸­é—´æ˜¯ä¸­å¿ƒåŒ–åçš„ï¼Œå³ä¾§æ˜¯å½’ä¸€åŒ–åçš„ å›¾ç‰‡æ¥æºäºcs231n
äº‹å®ä¸Šå½’ä¸€åŒ–åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼Œç¬¬ä¸€æ­¥æ˜¯å°†æ•°æ®å˜ä¸ºä»¥0ä¸ºä¸­å¿ƒï¼Œç¬¬äºŒéƒ¨æ˜¯ç¼©å°æ•°æ®çš„èŒƒå›´ã€‚æ‰€ä»¥å½’ä¸€åŒ–çš„å…¬å¼ä¸ºï¼š
&lt;/p&gt;
$$\frac{X-\bar{X}}{std(X)}$$&lt;p&gt;
å…¶ä¸­ï¼ŒXä¸ºåŸå§‹æ ·æœ¬ï¼Œ$\bar{X}$ä¸ºæ ·æœ¬å‡å€¼ï¼Œ$std(X)$ä¸ºæ ·æœ¬æ ‡å‡†å·®ã€‚
åœ¨è¿™é‡Œï¼ŒçœŸæ­£å½±å“åå‘ä¼ æ’­çš„æ˜¯ç¬¬ä¸€æ­¥ï¼Œzero-centeredã€‚å¦‚æœæ²¡æœ‰å°†æ•°æ®ä»¥0ä¸ºä¸­å¿ƒä¸­å¿ƒåŒ–çš„è¯ï¼Œå°±ä¼šå½±å“åå‘ä¼ æ’­çš„æ•ˆæœã€‚
ä»¥é€»è¾‘å›å½’(Logistic Regression)ä¸ºä¾‹ï¼Œé€»è¾‘å›å½’çš„æ¨¡å‹å¯å†™ä¸º
&lt;/p&gt;
$$\hat{y} = sigmoid(W \cdot X+b)$$&lt;p&gt;
å…¶ä¸­$W$å’Œ$b$æ˜¯å‚æ•°ï¼ŒXæ˜¯æ ·æœ¬ï¼Œ$sigmoid$è¡¨ç¤ºsigmoidæ¿€æ´»å‡½æ•°ï¼Œè®¾æŸå¤±å‡½æ•°ä¸º
&lt;/p&gt;
$$L = Loss(y, \hat{y})$$&lt;p&gt;
å…¶ä¸­ï¼Œ$y$ä¸ºæ ·æœ¬çš„æ ‡ç­¾æˆ–æ ‡æ³¨å€¼ã€‚åœ¨åå‘ä¼ æ’­çš„æ—¶å€™ï¼Œéœ€è¦å¯¹$W$å’Œ$b$æ±‚åå¯¼æ•°ï¼Œå³æ±‚æŸå¤±å‡½æ•°åœ¨å½“å‰æ ·æœ¬ç‚¹çš„æ¢¯åº¦ï¼Œè¿™é‡Œæˆ‘ä»¬è®¾$Z = W \cdot X + b$ï¼Œåˆ™
&lt;/p&gt;
$$\frac{\partial{L}}{\partial{W}} = \frac{\partial{L}}{\partial{\hat{y}}}\frac{\partial{\hat{y}}}{\partial{Z}}\frac{\partial{Z}}{\partial{W}} = \frac{\partial{L}}{\partial{\hat{y}}}\frac{\partial{\hat{y}}}{\partial{Z}}X^T$$&lt;p&gt;
åŒç†å¯ä»¥æ±‚å‡º$b$çš„åå¯¼æ•°ã€‚
åœ¨è¿™é‡Œå°±å¯ä»¥çœ‹å‡ºé—®é¢˜ï¼Œå‡è®¾æˆ‘ä»¬çš„è¾“å…¥æ˜¯å›¾åƒé‚£æ ·çš„æ ·æœ¬ï¼Œåƒç´ å€¼éƒ½æ˜¯å¤§äº0çš„ï¼Œé‚£è¿™é‡Œ$\frac{\partial{L}}{\partial{W}}$å°±ä¼šå¤§äº0ã€‚
ä½¿ç”¨æ¢¯åº¦ä¸‹é™çš„æ›´æ–°è§„åˆ™æ¥æ›´æ–°å‚æ•°æ—¶
&lt;/p&gt;
$$W := W - \alpha \frac{\partial{L}}{\partial{W}}$$&lt;p&gt;
Wå°±ä¼šä¸€ç›´å‡å°ï¼Œè¿™æ˜¾ç„¶æ˜¯æœ‰é—®é¢˜çš„ã€‚
&lt;img src="https://davidham3.github.io/blog/images/%e8%ae%ad%e7%bb%83%e7%a5%9e%e7%bb%8f%e7%bd%91%e7%bb%9c%e6%97%b6%e5%bd%92%e4%b8%80%e5%8c%96%e7%9a%84%e7%9b%ae%e7%9a%84/2.png"
loading="lazy"
alt="â€œå›¾2 å›¾ç‰‡æ¥æºäºcs231nâ€"
&gt;
å›¾2 å³å›¾å±•ç¤ºäº†åªæœ‰ä¸¤ä¸ªæ–¹å‘å…è®¸æ›´æ–°æ¢¯åº¦åå®é™…çš„å‚æ•°æ›´æ–°è·¯çº¿(çº¢çº¿) å›¾ç‰‡æ¥æºäºcs231n
å¦‚å›¾2æ‰€ç¤ºï¼Œå¯ä»¥å‘ç°å¦‚æœæˆ‘ä»¬çš„è¾“å…¥å˜æˆäº†è¦ä¹ˆéƒ½æ˜¯å¤§äº0ï¼Œè¦ä¹ˆéƒ½æ˜¯å°äº0çš„æ•°ï¼Œé‚£ä¹ˆå…è®¸æ¢¯åº¦æ›´æ–°çš„ä¸¤ä¸ªæ–¹å‘åœ¨äºŒç»´ç©ºé—´ä¸­å°±åªèƒ½è½åœ¨ç¬¬ä¸€å’Œç¬¬ä¸‰è±¡é™ä¸­ï¼Œæ‰©å±•åˆ°é«˜ç»´ç©ºé—´ä¸­ä¹Ÿæ˜¯ç›¸å¯¹çš„ä¸¤ä¸ªå¦é™ã€‚è¿™æ ·åœ¨æ›´æ–°çš„è¿‡ç¨‹ä¸­å°±ä¼šäº§ç”Ÿè¿™ç§çº¢çº¿æ‰€ç¤ºçš„è·¯å¾„zig zag pathã€‚ä»¥ä¸Šæ˜¯ä¸è¿›è¡Œä¸­å¿ƒåŒ–çš„åæœã€‚
è€Œä¸è¿›è¡Œç‰¹å¾ç¼©æ”¾çš„åæœåˆ™æ˜¯ï¼Œå¦‚æœæ¯ä¸ªç‰¹å¾çš„é‡çº§ä¸åŒï¼Œå‡è®¾ä¸€ä¸ªç‰¹å¾æ˜¯æ•°å€¼èŒƒå›´åœ¨$[-10, 10]$ï¼Œå¦ä¸€ä¸ªç‰¹å¾åœ¨$[-10^9, 10^9]$ï¼Œé‚£ä¹ˆåœ¨è®¡ç®—æ¢¯åº¦åï¼Œä½¿ç”¨æ¢¯åº¦ä¸‹é™æ›´æ–°æ—¶ï¼Œä¹Ÿä¼šé€ æˆä¸Šé¢æ‰€è¿°çš„zig zagç°è±¡ã€‚&lt;/p&gt;</description></item><item><title>åœ¨GitHubä¸Šéƒ¨ç½²hexoåšå®¢</title><link>https://davidham3.github.io/blog/p/%E5%9C%A8github%E4%B8%8A%E9%83%A8%E7%BD%B2hexo%E5%8D%9A%E5%AE%A2/</link><pubDate>Tue, 20 Feb 2018 16:53:50 +0000</pubDate><guid>https://davidham3.github.io/blog/p/%E5%9C%A8github%E4%B8%8A%E9%83%A8%E7%BD%B2hexo%E5%8D%9A%E5%AE%A2/</guid><description>&lt;p&gt;åœ¨GitHub Pageséƒ¨ç½²hexoåšå®¢&lt;/p&gt;
&lt;h1 id="éœ€è¦çš„å·¥å…·"&gt;éœ€è¦çš„å·¥å…·
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;node.js&lt;/li&gt;
&lt;li&gt;git&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="å®‰è£…åŠéƒ¨ç½²"&gt;å®‰è£…åŠéƒ¨ç½²
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;å®‰è£…å®Œnode.jså’Œgitåå®‰è£…hexo&lt;br&gt;
&lt;code&gt;npm install hexo -g&lt;/code&gt;
å®‰è£…åä½¿ç”¨&lt;code&gt;hexo -v&lt;/code&gt;æŸ¥çœ‹ç‰ˆæœ¬å·ï¼Œçœ‹æ˜¯å¦å®‰è£…æˆåŠŸ&lt;/li&gt;
&lt;li&gt;åˆ›å»ºhexoé¡¹ç›®
æ‰¾ä¸ªæ–‡ä»¶å¤¹ä½œä¸ºåšå®¢çš„ç›®å½•
åœ¨è¿™ä¸ªç›®å½•ä¸‹ä½¿ç”¨
&lt;code&gt;hexo init&lt;/code&gt;
åˆå§‹åŒ–è¯¥ç›®å½•&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;npm install&lt;/code&gt;å®‰è£…éœ€è¦çš„ç»„ä»¶&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;npm install hexo-deployer-git --save&lt;/code&gt;å®‰è£…æ’ä»¶&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;hexo generate&lt;/code&gt;æˆ–&lt;code&gt;hexo g&lt;/code&gt;ç”Ÿæˆå½“å‰çš„åšå®¢&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;hexo server&lt;/code&gt;æˆ–&lt;code&gt;hexo s&lt;/code&gt;å¯åŠ¨æœåŠ¡å™¨
ç„¶åå°±å¯ä»¥æ‰“å¼€æµè§ˆå™¨è®¿é—®localhost:4000åœ¨æœ¬åœ°æŸ¥çœ‹å½“å‰çš„åšå®¢&lt;/li&gt;
&lt;li&gt;ç”ŸæˆSSHå¯†é’¥
æ‰“å¼€Git Bashï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é…ç½®git
&lt;code&gt;git config --global user.name &amp;quot;ä½ çš„githubç”¨æˆ·çš„åå­—&amp;quot;&lt;/code&gt;
&lt;code&gt;git config --global user.email &amp;quot;ä½ çš„githubè´¦æˆ·é‚®ç®±&amp;quot;&lt;/code&gt;
&lt;code&gt;cd ~/.ssh&lt;/code&gt;
&lt;code&gt;ssh-keygen -t rsa -C &amp;quot;ä½ çš„githubè´¦æˆ·é‚®ç®±&amp;quot;&lt;/code&gt;
è¿ç»­ä¸‰ä¸ªå›è½¦
&lt;code&gt;eval &amp;quot;$(ssh-agent -s)&amp;quot;&lt;/code&gt;ï¼Œæ·»åŠ å¯†é’¥åˆ°ssh-agent
&lt;code&gt;ssh-add ~/.ssh/id_rsa&lt;/code&gt;ï¼Œæ·»åŠ ç”Ÿæˆçš„SSH keyåˆ°ssh-agent
&lt;code&gt;cat ~/.ssh/id_rsa.pub&lt;/code&gt;
å¤åˆ¶æ­¤æ—¶æ˜¾ç¤ºçš„å†…å®¹ï¼Œå†…å®¹åº”è¯¥æ˜¯ä»¥ssh-rsaå¼€å¤´&lt;/li&gt;
&lt;li&gt;Ctrl+Cé€€å‡ºåï¼Œåœ¨GitHubä¸Šæ–°å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œä»“åº“åéšæ„ï¼Œä¸è¿‡éœ€è¦è®°å½•ä¸‹æ¥ï¼Œæˆ‘è¿™é‡Œèµ·åå«blogï¼Œæœ€ä¸‹é¢çš„Initialize this repository with a READMEè¦å‹¾é€‰ä¸Šï¼Œç„¶åä¿å­˜å³å¯ã€‚è¿›å…¥è¿™ä¸ªä»“åº“åé€‰æ‹©Settingsï¼Œåœ¨å·¦ä¾§é€‰é¡¹å¡Optionsä¸­ç¿»åˆ°ä¸‹é¢ï¼ŒGItHub Pagesè¿™é¡¹ï¼ŒSourceé€‰æ‹©master branchï¼Œé€‰æ‹©saveåï¼Œä¼šåœ¨è¿™éƒ¨åˆ†çš„æ ‡é¢˜å¤„å†™æ˜è¿™ä¸ªä»“åº“çš„urlï¼Œè¿™å°±æ˜¯ä½ åšå®¢çš„urläº†ã€‚è¿˜æ˜¯é¡µé¢çš„å·¦ä¾§çš„é€‰é¡¹å¡ï¼ŒDeploy é€‰æ‹©Add deploy keyï¼Œæ·»åŠ å¯†é’¥ã€‚
Titleéšæ„ï¼Œæˆ‘è®¾ç½®ä¸ºäº†blog
Keyç²˜è´´æˆ‘ä»¬åˆšæ‰å¤åˆ¶çš„é‚£ä¸€æ®µã€‚
æœ€ä¸‹é¢Allow write accessè¦æ‰“å‹¾.
é€‰æ‹©Add Keyå³å¯ã€‚
ç„¶ååœ¨Git Bashä¸­ä½¿ç”¨
&lt;code&gt;ssh -T git@github.com&lt;/code&gt;æµ‹è¯•ï¼Œå¦‚æœçœ‹åˆ°Hiåé¢æ˜¯ä½ çš„ç”¨æˆ·åï¼Œå°±è¯´æ˜æˆåŠŸäº†ã€‚&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹hexoé…ç½®æ–‡ä»¶
æ‰“å¼€æœ¬åœ°åšå®¢çš„æ ¹ç›®å½•ï¼Œæ‰¾åˆ°_config.ymlæ–‡ä»¶ï¼Œ
åœ¨æ–‡ä»¶çš„å¼€å¤´å¤„ï¼Œç¬¬äºŒéƒ¨åˆ†ï¼ŒURLè¿™éƒ¨åˆ†æ”¹æˆå¦‚ä¸‹å†…å®¹ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# URL
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;## If your site is put in a subdirectory, set url as &amp;#39;http://yoursite.com/child&amp;#39; and root as &amp;#39;/child/&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;url: http://yoursite.com/blog
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;root: /blog/
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;permalink: :year/:month/:day/:title/
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;permalink_defaults:
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„urlå’Œrootè¿™ä¸¤é¡¹éƒ½éœ€è¦ä¿®æ”¹ã€‚urlåœ¨åé¢è¦åŠ ä»“åº“åï¼Œæˆ‘çš„ä»“åº“å«blogï¼Œæ‰€ä»¥å†™æˆäº†&lt;code&gt;http://yoursite.com/ä»“åº“å&lt;/code&gt;ï¼ŒåŒç†rootè¦ä¿®æ”¹æˆ&lt;code&gt;/ä»“åº“å/&lt;/code&gt;ã€‚
åœ¨æ–‡ä»¶çš„ç»“å°¾å¤„ï¼ŒDeploymentè¿™éƒ¨åˆ†æ”¹æˆå¦‚ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# Deployment
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;## Docs: https://hexo.io/docs/deployment.html
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;deploy:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;type: git
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;repository: git@github.com:Davidham3/blog.git
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;branch: master
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„repositoryè¿™é¡¹ï¼Œåº”è¯¥å»GitHubé‡Œé¢ä½ æ–°å»ºçš„é‚£ä¸ªå«blogçš„ä»“åº“é‡Œé¢æ‰¾ã€‚è¿›å…¥ä»“åº“ä¸»é¡µåï¼Œç‚¹å‡»å³ä¾§ç»¿è‰²çš„æŒ‰é’®Clone or downloadï¼Œåœ¨æ–°å¼¹å‡ºçš„çª—å£å³ä¸Šè§’é€‰æ‹©Use SSHï¼Œç„¶åå°†ä¸‹é¢çš„æ–‡å­—å¤åˆ¶ç²˜è´´åˆ°æ­¤å¤„ã€‚
ä¿®æ”¹å®Œé…ç½®æ–‡ä»¶åä¿å­˜é€€å‡ºå³å¯ã€‚
10. ä½¿ç”¨&lt;code&gt;hexo clean&lt;/code&gt;æ¸…é™¤ç¼“å­˜
11. ä½¿ç”¨&lt;code&gt;hexo g&lt;/code&gt;ç”Ÿæˆåšå®¢
12. ä½¿ç”¨&lt;code&gt;hexo deploy&lt;/code&gt;æˆ–&lt;code&gt;hexo d&lt;/code&gt;å°†åšå®¢éƒ¨ç½²è‡³GitHubä¸Šï¼Œæ‰“å¼€åˆšæ‰GitHub Pagesè®¾ç½®é‡Œé¢ç»™å‡ºçš„urlï¼Œå°±å¯ä»¥è¿›å…¥ä½ çš„åšå®¢äº†ã€‚ä»¥ä¸Šä¸¤æ­¥ä¹Ÿå¯ä»¥è¿å†™ä¸º&lt;code&gt;hexo d -g&lt;/code&gt;ã€‚&lt;/p&gt;</description></item><item><title>Collaborative Filtering for Implicit Feedback Datasets</title><link>https://davidham3.github.io/blog/p/collaborative-filtering-for-implicit-feedback-datasets/</link><pubDate>Thu, 18 Jan 2018 18:58:25 +0000</pubDate><guid>https://davidham3.github.io/blog/p/collaborative-filtering-for-implicit-feedback-datasets/</guid><description>&lt;p&gt;ICDM 2008. æ¨èç³»ç»Ÿï¼šååŒè¿‡æ»¤åœ¨éšåé¦ˆæ•°æ®ä¸Šçš„åº”ç”¨ï¼Œè¿™ä¸ªç®—æ³•åœ¨GitHubä¸Šæœ‰äººå®ç°äº†ï¼Œæ€§èƒ½å¾ˆå¼ºã€‚è¿™æ˜¯æˆ‘çš„é˜…è¯»ç¬”è®°ï¼ŒæŠŠè®ºæ–‡å½“ä¸­çš„ä¸»è¦éƒ¨åˆ†æŠ½å‡ºæ¥äº†ã€‚åŸæ–‡é“¾æ¥ï¼š&lt;a class="link" href="https://ieeexplore.ieee.org/abstract/document/4781121/" target="_blank" rel="noopener"
&gt;Collaborative Filtering for Implicit Feedback Datasets&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="introduction"&gt;Introduction
&lt;/h1&gt;&lt;p&gt;In this part, this paper introduce 4 important characteristics for implicit feedback:&lt;/p&gt;
&lt;h2 id="no-negative-feedback"&gt;No negative feedback
&lt;/h2&gt;&lt;p&gt;For example, a user that did not watch a certain show might have done so because she dislikes the show or was not availale to watch it. So by observing the users behavior, we can infer which items they probably like and thus chose to consume. However, it&amp;rsquo;s hard to reliably infer which item a user did not like.&lt;/p&gt;
&lt;h2 id="implicit-feedback-is-inherently-noise"&gt;Implicit feedback is inherently noise
&lt;/h2&gt;&lt;p&gt;For example, we may view purchases behavior for an individual, but this does not necessarily indicate a positive view of thhe product. The item may have been purchased as a gift. Or a television is on a particular channel and a particular time, but the viewer might be asleep.&lt;/p&gt;
&lt;h2 id="the-numerical-value-of-explicit-feedback-indicate-preference-whereas-the-numerical-value-of-implicit-feedback-indicates-confidence"&gt;The numerical value of explicit feedback indicate preference, whereas the numerical value of implicit feedback indicates confidence
&lt;/h2&gt;&lt;p&gt;Numerical values of implicit feedback describe the frequency of actions, e.g., how much time the user watched a certain show, how frequently a user is buying a certain item, etc. A larger value is not indicating a higher preference.&lt;/p&gt;
&lt;h2 id="evaluation-of-implicit-feedback-recommender-requires-appropriate-measures"&gt;Evaluation of implicit-feedback recommender requires appropriate measures
&lt;/h2&gt;&lt;p&gt;For example, if we gather data on television viewing, it&amp;rsquo;s unclear how to evaluate a show that has been watched more than once, or how to compare two shows that are on at the same time, and hence cannot both be watched by the user.&lt;/p&gt;
&lt;h1 id="preliminaries"&gt;preliminaries
&lt;/h1&gt;&lt;p&gt;notions:
users $u, v$
items $i, j$
observations $r_{ui}$, associate users and items. For explicit feedback datasets, those values would be ratings that indicate the preference by user $u$ and item $i$. For implicit datasets, $r_{ui}$ can indicate observations for user actions. For example, $r_{ui}$ can indicate the number of times $u$ purchased item $i$ or the time $u$ spent on webpage $i$.&lt;/p&gt;
&lt;h1 id="previous-work"&gt;previous work
&lt;/h1&gt;&lt;h2 id="neighborhood-models"&gt;Neighborhood models
&lt;/h2&gt;&lt;p&gt;Its original form is user-oriented, see [1] for a good analysis.
Later, an analogous item-oriented approach [2,3] became popular. In those methods, a rating is estimated using known ratings made by the same user on similar items. In addition, item-oriented methods are more amenable to explaining the reasoning behind predictions. This is because users are familiar with items previously preferred by them, but usually do not know those allegedly like minded users.
Central to most item-oriented approaches is a similarity measure between items, where $s_{ij}$ denotes the similarity of $i$ and $j$. Frequently, it is based on the Pearson correlation coeffcient. Our goal is to predict $r_{ui}$--the unobserved value by user $u$ for item $i$. Using the similarity maesure, we identify the $k$ items rated by $u$, which are most similar to $i$. This set of $k$ neighbors is denoted by $S^k(i;u)$. The predicted value of $r_{ui}$ is taken as a weighted average of the ratings for neighboring items:
&lt;/p&gt;
$$\hat{r}\_{ui} = \frac{\sum\_{j\in S^k(i;u)}s\_{ij}r\_{uj}}{\sum\_{j\in S^k(i;u)}s\_{ij}}$$&lt;p&gt;
Some enhancements of this scheme are well practiced for explicit feedback, such as correcting for biases caused by varying mean ratings of different users and items.
All item-oriented models share a disadvantage in regards to implicit feedback - they do not provide the flexibility to make a distinction between user preferences and thhe confidence we might have in those preferences.&lt;/p&gt;
&lt;h2 id="latent-factor-models"&gt;Latent factor models
&lt;/h2&gt;&lt;p&gt;Latent factor models comprise an alternative approach to CF with the more holistic goal to uncover latent features that explain observed ratings; example include pLSA\cite{ref4}, neural networks\cite{ref5}, and Latent Dirichlet Allocation\cite{ref6}. We will focus on models that are induced by Singular Value Decomposition(SVD) of the user-item observations matrix. Many of the recent works, applied to explicit feedback datasets, suggested modeling directly only the observed ratings, while avoiding overfitting through an adequate regularized model, such as:
&lt;/p&gt;
$$\min \limits\_{x\_*,y\_*} \sum \limits\_{r\_{w,i}is known} (r\_{ui}-x^T\_uy\_i)^2+\lambda (\lVert x\_u\rVert^2+\lVert y\_i \rVert^2)$$&lt;p&gt;
Here, $\lambda$ is used for regularizing the model. Parameters are often learnt by stochastic gradient descent;&lt;/p&gt;
&lt;h1 id="our-model"&gt;Our model
&lt;/h1&gt;&lt;p&gt;First, we need to formalize the notion of confidence which the $r_{ui}$ variables measure. To this end, let us introduce a set of binary variables $p_{ui}$, which indicates the preference of user $u$ to item $i$. The $p_{ui}$ values are derived by binarizing the $r_{ui}$ values:
&lt;/p&gt;
$$p\_{ui}=
\begin{cases}
1 &amp; r\_{ui}&gt;0\\
0 &amp; r\_{ui}=0
\end{cases}$$&lt;p&gt;
In other words, if a user $u$ consumed item $i$($r_{ui}&amp;gt;0$), then we have an indication that $u$ likes $i$($p_{ui}=1$). On the other hand, if $u$ never comsumed $i$, we believe no preference($p_{ui}=0$).
We will have different confidence levels also among items that are indicated to be preferred by the user. In general, as $r_{ui}$ grows, we have a stronger indication that the user indeed like thhe item. Consequently, we introduce a set of variables, $c_{ui}$, which measure our confidence in observing $p_{ui}$. A plausible choice for $c_{ui}$ would be:
&lt;/p&gt;
$$c\_{ui} = 1 + \alpha r\_{ui}$$&lt;p&gt;
This way, we have some minimal confidence in $p_{ui}$ for every user-item pair, but as we observe more evidence for positive preference, our confidence in $p_{ui}=1$ increases accordingly. The rate of increase is controlled by the constant $\alpha$. In our experiments, setting $\alpha = 40$ was found to produce good results.
Our goal is to find a vector $x_u\in \mathbb{R}^f$ for each user $u$, and a vector $y_i\in \mathbb{R}^f$ for each item $i$ that will factor user preferences. These vectors will be known as the user-factors and the item-factors, respectively. Preferences are assumed to be the inner products: $p_{ui}=x^T_uy_i$. Essentially, the vectors strive to map users and items into a common latent vector space where they can be directly compared. This is similar to matrix factorization techniques which are popular for explicit feedback data, with two important distinction: (1) We need to account for the varying confidence levels, (2) Optimization should account for all possible $u, i$ pairs, rather than only these corresponding to observed data. Accordingly, factors are computed by minimizing the following cost function:
&lt;/p&gt;
$$\min \limits\_{x\_*, y\_*}\sum \limits\_{u,i}c\_{ui}(p\_{ui}-x^T\_uy\_i)^2+\lambda(\sum\limits\_{u}\lVert x\_u\rVert^2+\sum\limits\_{i}\lVert y\_i\rVert^2)$$&lt;p&gt;
The $\lambda(\sum\limits_{u}\lVert x_u\rVert^2+\sum\limits_{i}\lVert y_i\rVert^2)$ term is necessary for regularizing the model such that it will not overfit the training data.&lt;/p&gt;
&lt;p&gt;[1]. Herlocker J L, Konstan J A, Borchers A, et al. An algorithmic framework for performing collaborative filtering[C]. international acm sigir conference on research and development in information retrieval, 1999: 230-237.
[2]. Linden G, Smith B, York J C, et al. Amazon.com recommendations: item-to-item collaborative filtering[J]. IEEE Internet Computing, 2003, 7(1): 76-80.
[3]. Sarwar B M, Karypis G, Konstan J A, et al. Item-based collaborative filtering recommendation algorithms[J]. international world wide web conferences, 2001: 285-295.
[4]. Hofmann T. Latent semantic models for collaborative filtering[J]. ACM Transactions on Information Systems, 2004, 22(1): 89-115.
[5]. Salakhutdinov R, Mnih A, Hinton G E, et al. Restricted Boltzmann machines for collaborative filtering[C]. international conference on machine learning, 2007: 791-798.
[6]. Blei D M, Ng A Y, Jordan M I, et al. Latent Dirichlet Allocation[C]. neural information processing systems, 2002, 3(0): 601-608.&lt;/p&gt;</description></item><item><title>Hadoop HAå®‰è£…ä¸‰ï¼šzookeeperçš„å®‰è£…</title><link>https://davidham3.github.io/blog/p/hadoop-ha%E5%AE%89%E8%A3%85%E4%B8%89zookeeper%E7%9A%84%E5%AE%89%E8%A3%85/</link><pubDate>Mon, 21 Aug 2017 16:13:59 +0000</pubDate><guid>https://davidham3.github.io/blog/p/hadoop-ha%E5%AE%89%E8%A3%85%E4%B8%89zookeeper%E7%9A%84%E5%AE%89%E8%A3%85/</guid><description>&lt;p&gt;zookeeperé€šå¸¸ä»¥â€œå¤åˆ¶æ¨¡å¼â€è¿è¡Œäºä¸€ä¸ªè®¡ç®—æœºé›†ç¾¤ä¸Šï¼Œè¿™ä¸ªè®¡ç®—æœºé›†ç¾¤è¢«ç§°ä¸ºä¸€ä¸ªâ€œé›†åˆä½“â€ã€‚zookeeperé€šè¿‡å¤åˆ¶æ¥å®ç°é«˜å¯ç”¨æ€§ï¼Œåªè¦é›†åˆä½“ä¸­åŠæ•°ä»¥ä¸Šçš„æœºå™¨å¤„äºå¯ç”¨çŠ¶æ€ï¼Œå®ƒå°±å¯ä»¥æä¾›æœåŠ¡ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œä¸€ä¸ªé›†åˆä½“é€šå¸¸åŒ…å«å¥‡æ•°å°æœºå™¨ã€‚&lt;/p&gt;
&lt;h1 id="zookeeperçš„å®‰è£…"&gt;zookeeperçš„å®‰è£…
&lt;/h1&gt;&lt;p&gt;zookeeperé€šå¸¸ä»¥â€œå¤åˆ¶æ¨¡å¼â€è¿è¡Œäºä¸€ä¸ªè®¡ç®—æœºé›†ç¾¤ä¸Šï¼Œè¿™ä¸ªè®¡ç®—æœºé›†ç¾¤è¢«ç§°ä¸ºä¸€ä¸ªâ€œé›†åˆä½“â€ã€‚zookeeperé€šè¿‡å¤åˆ¶æ¥å®ç°é«˜å¯ç”¨æ€§ï¼Œåªè¦é›†åˆä½“ä¸­åŠæ•°ä»¥ä¸Šçš„æœºå™¨å¤„äºå¯ç”¨çŠ¶æ€ï¼Œå®ƒå°±å¯ä»¥æä¾›æœåŠ¡ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œä¸€ä¸ªé›†åˆä½“é€šå¸¸åŒ…å«å¥‡æ•°å°æœºå™¨ã€‚&lt;/p&gt;
&lt;h2 id="å®‰è£…"&gt;å®‰è£…
&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡é€‰æ‹©äº†åœ¨cluster2ï¼Œcluster3å’Œcluster4ä¸‰å°æœºå™¨ä¸Šå®‰è£…
å°†zookeeperè§£å‹åˆ°/usr/localç›®å½•ä¸‹ï¼Œå¹¶é…ç½®ç¯å¢ƒå˜é‡
&lt;code&gt;# vi /etc/profile&lt;/code&gt;
åœ¨æœ€ä¸‹é¢åŠ ä¸Š2è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-gdscript3" data-lang="gdscript3"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="n"&gt;ZOOKEEPER_HOME&lt;/span&gt;&lt;span class="o"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;zookeeper&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.4&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="n"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=$&lt;/span&gt;&lt;span class="n"&gt;ZOOKEEPER&lt;/span&gt;\&lt;span class="n"&gt;_HOME&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;PATH&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶ååœ¨confä¸­æ–°å»ºzoo.cfgæ–‡ä»¶ï¼Œè¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# å®¢æˆ·ç«¯å¿ƒè·³æ—¶é—´(æ¯«ç§’)
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;tickTime=2000
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# å…è®¸å¿ƒè·³é—´éš”çš„æœ€å¤§æ—¶é—´
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;initLimit=10
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# åŒæ­¥æ—¶é™
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;syncLimit=5
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# æ•°æ®å­˜å‚¨ç›®å½•
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;dataDir=/home/hadoop_files/hadoop_data/zookeeper
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# æ•°æ®æ—¥å¿—å­˜å‚¨ç›®å½•
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;dataLogDir=/home/hadoop_files/hadoop_logs/zookeeper/dataLog
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# ç«¯å£å·
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;clientPort=2181
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# é›†ç¾¤èŠ‚ç‚¹å’ŒæœåŠ¡ç«¯å£é…ç½®
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;server.1=hadoop-cluster2:2888:3888
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;server.2=hadoop-cluster3:2888:3888
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;server.3=hadoop-cluster4:2888:3888
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åˆ›å»ºzookeeperçš„æ•°æ®å­˜å‚¨ç›®å½•å’Œæ—¥å¿—å­˜å‚¨ç›®å½•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# mkdir -p /home/hadoop_files/hadoop_data/zookeeper
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# mkdir -p /home/hadoop_files/hadoop_logs/zookeeper/dataLog
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# mkdir -p /home/hadoop_files/hadoop_logs/zookeeper/logs
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¿®æ”¹æ–‡ä»¶å¤¹çš„æƒé™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# chown -R hadoop:hadoop /home/hadoop_files
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# chown -R hadoop:hadoop /usr/local/zookeeper-3.4.6
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åœ¨cluster2å·æœåŠ¡å™¨çš„dataç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶myidï¼Œè¾“å…¥å†…å®¹ä¸º1ï¼Œmyidåº”ä¸zoo.cfgä¸­çš„é›†ç¾¤èŠ‚ç‚¹ç›¸åŒ¹é…&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# echo &amp;#34;1&amp;#34; &amp;gt;&amp;gt; /home/hadoop_files/hadoop_data/zookeeper/myid
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¿®æ”¹zookeeperçš„æ—¥å¿—è¾“å‡ºè·¯å¾„
&lt;code&gt;# vi bin/zkEnv.sh&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;if [ &amp;#34;x${ZOO\_LOG\_DIR}&amp;#34; = &amp;#34;x&amp;#34; ]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;then
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ZOO\_LOG\_DIR=&amp;#34;/home/hadoop\_files/hadoop\_logs/zookeeper/logs&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;fi
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;if [ &amp;#34;x${ZOO_LOG4J_PROP}&amp;#34; = &amp;#34;x&amp;#34; ]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;then
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ZOO_LOG4J_PROP=&amp;#34;INFO,ROLLINGFILE&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;fi
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¿®æ”¹zookeeperçš„æ—¥å¿—é…ç½®æ–‡ä»¶
&lt;code&gt;# vi conf/log4j.properties&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;zookeeper.root.logger=INFO,ROLLINGFILE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;log4j.appender.ROLLINGFILE=org.apache.log4j.DailyRollingFileAppender
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å°†è¿™ä¸ªzookeeper-3.4.6çš„ç›®å½•å¤åˆ¶åˆ°å…¶ä»–çš„ä¸¤ä¸ªèŠ‚ç‚¹ä¸Š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# scp -r /usr/local/zookeeper-3.4.6 cluster3:/usr/local/
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# scp -r /usr/local/zookeeper-3.4.6 cluster4:/usr/local/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¤åˆ¶ååœ¨é‚£ä¸¤å°æœºå™¨ä¸Šä½¿ç”¨rootç”¨æˆ·ä¿®æ”¹ç›®å½•æ‰€æœ‰è€…ä¸ºhadoopç”¨æˆ·ï¼Œå¹¶ä¿®æ”¹ä»–ä»¬çš„myidä¸º2å’Œ3ã€‚&lt;/p&gt;
&lt;p&gt;é€€å›hadoopç”¨æˆ·&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# exit
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶åä½¿ç”¨hadoopç”¨æˆ·ï¼Œä½¿ç”¨&lt;code&gt;zkServer.sh start&lt;/code&gt;åˆ†åˆ«å¯åŠ¨ä¸‰ä¸ªzookeeperï¼Œé¡ºåºæ— æ‰€è°“ã€‚ä¸‰ä¸ªéƒ½å¯åŠ¨åï¼Œä½¿ç”¨&lt;code&gt;jps&lt;/code&gt;å‘½ä»¤æŸ¥çœ‹ï¼Œè‹¥æœ‰QuorumPeerMainåˆ™è¯´æ˜æœåŠ¡æ­£å¸¸å¯åŠ¨ï¼Œæ²¡æœ‰çš„è¯ï¼Œä½¿ç”¨&lt;code&gt;zkServer.sh start-foreground&lt;/code&gt;æŸ¥çœ‹ä¸€ä¸‹å“ªé‡Œå‡ºäº†é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id="å®‰è£…ä¸­é‡åˆ°çš„é—®é¢˜"&gt;å®‰è£…ä¸­é‡åˆ°çš„é—®é¢˜
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;zookeeperå¯åŠ¨ä¸äº†
ä½¿ç”¨&lt;code&gt;zkServer.sh start-foreground&lt;/code&gt;è¿è¡Œzookeeperï¼Œæ˜¾ç¤º&lt;code&gt;line 131:exec java: not found&lt;/code&gt;
è§£å†³åŠæ³•ï¼š
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# cd /usr/local
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# chown â€“R hadoop:hadoop zookeeper-3.4.6
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;æ”¹ä¸€ä¸‹ç”¨æˆ·æƒé™å³å¯&lt;/li&gt;
&lt;li&gt;æ‰“å¼€logsæ–‡ä»¶å¤¹é‡Œé¢çš„zookeeper.logæ˜¾ç¤ºconnection refusedé”™è¯¯
åŸå› ï¼šä¸€èˆ¬æ¥è¯´è¿™æ˜¯é…ç½®çš„é—®é¢˜ï¼Œæˆ‘å‡ºç°è¿™ä¸ªé—®é¢˜çš„ä¸»è¦åŸå› æ˜¯ï¼Œæˆ‘åœ¨zoo.cfgä¸­å†™äº†ä¸‰ä¸ªserverï¼Œä½†æ˜¯åªåœ¨server1ä¸Šå¯åŠ¨zkServer.shæ‰€ä»¥ä¼šå‡ºç°connection refusedã€‚
äº‹å®ä¸Šåªåœ¨ä¸€ä¸ªæœºå™¨ä¸Šå¯åŠ¨zookeeperæ—¶ï¼Œä½¿ç”¨&lt;code&gt;zkServer.sh status&lt;/code&gt;æŸ¥çœ‹çŠ¶æ€æ—¶ï¼Œä¼šæ˜¾ç¤ºzkå¯èƒ½æ²¡æœ‰è¿è¡Œï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯è¯´æ˜ä½ çš„zookeeperæœ‰é—®é¢˜ï¼Œåªæ˜¯é‚£ä¸¤ä¸ªè¿˜æ²¡å¯åŠ¨å¥½è€Œå·²ï¼Œå½“3å°æœºå™¨çš„zookeeperéƒ½å¯åŠ¨åï¼Œ3å°æœºå™¨ä¼šè‡ªåŠ¨è¿›è¡ŒæŠ•ç¥¨ï¼Œé€‰å‡ºä¸€ä¸ªleaderä¸¤ä¸ªfollowerï¼Œæ­¤æ—¶å†ç”¨&lt;code&gt;zkServer.sh status&lt;/code&gt;æŸ¥çœ‹çŠ¶æ€çš„æ—¶å€™å°±å¯ä»¥çœ‹åˆ°è¿™å°æœºå™¨æ˜¯leaderè¿˜æ˜¯followeräº†ã€‚&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>Hadoop HAå®‰è£…äºŒï¼šMySQLåŒæœºçƒ­å¤‡</title><link>https://davidham3.github.io/blog/p/hadoop-ha%E5%AE%89%E8%A3%85%E4%BA%8Cmysql%E5%8F%8C%E6%9C%BA%E7%83%AD%E5%A4%87/</link><pubDate>Mon, 21 Aug 2017 16:13:31 +0000</pubDate><guid>https://davidham3.github.io/blog/p/hadoop-ha%E5%AE%89%E8%A3%85%E4%BA%8Cmysql%E5%8F%8C%E6%9C%BA%E7%83%AD%E5%A4%87/</guid><description>&lt;p&gt;Hadoop HAå®‰è£…äºŒï¼šMySQLåŒæœºçƒ­å¤‡&lt;/p&gt;
&lt;h2 id="å®‰è£…mysql"&gt;å®‰è£…MySQL
&lt;/h2&gt;&lt;p&gt;å®‰è£…å‰å…ˆå®‰è£…ä¸€ä¸‹MySQLçš„ä¾èµ–
ubuntu:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# apt-get install libaio-dev
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;CentOS:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# yum install libaio
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;çœ‹äº†å¾ˆå¤šæ•™ç¨‹éƒ½ä¸é è°±ã€‚ã€‚ã€‚è¿˜æ˜¯å®˜æ–¹æ•™ç¨‹æœ€é è°±ï¼š
&lt;a class="link" href="https://dev.mysql.com/doc/refman/5.6/en/binary-installation.html" target="_blank" rel="noopener"
&gt;Installing MySQL on Unix/Linux Using Generic Binaries&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹è½½mysql-5.6.37-linux-glibc2.12-x86_64
&lt;code&gt;# cp mysql-5.6.37-linux-glibc2.12-x86_64.tar.gz /usr/local/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è§£å‹åˆ°/usr/local/
&lt;code&gt;# tar -zxvf mysql-5.6.37-linux-glibc2.12-x86_64.tar.gz&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ”¹åä¸ºmysql
&lt;code&gt;# mv mysql-5.6.37-linux-glibc2.12-x86_64 mysql&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åˆ é™¤å®‰è£…åŒ…
&lt;code&gt;# rm mysql-5.6.37-linux-glibc2.12-x86_64.tar.gz&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ç¯å¢ƒå˜é‡
&lt;code&gt;# vi /etc/profile&lt;/code&gt;
åœ¨æœ€ä¸‹é¢æ·»åŠ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-gdscript3" data-lang="gdscript3"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="n"&gt;MYSQL_HOME&lt;/span&gt;&lt;span class="o"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mysql&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="n"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=$&lt;/span&gt;&lt;span class="n"&gt;MYSQL_HOME&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;PATH&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ–°å»ºç”¨æˆ·å’Œç”¨æˆ·ç»„ï¼šmysql
&lt;code&gt;# groupadd mysql&lt;/code&gt;
&lt;code&gt;# useradd -r -g mysql -s /bin/false mysql&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;# cd /usr/local/mysql&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ç›®å½•çš„æ‹¥æœ‰è€…
&lt;code&gt;# chown -R mysql .&lt;/code&gt;(&lt;strong&gt;é‡è¦ï¼&lt;/strong&gt;)
&lt;code&gt;# chgrp -R mysql .&lt;/code&gt;(&lt;strong&gt;é‡è¦ï¼&lt;/strong&gt;)&lt;/p&gt;
&lt;p&gt;å®‰è£…MySQL
&lt;code&gt;# scripts/mysql_install_db --user=mysql&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹å½“å‰ç›®å½•æ‹¥æœ‰è€…ä¸ºrootç”¨æˆ·
&lt;code&gt;# chown -R root .&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹å½“å‰dataç›®å½•æ‹¥æœ‰è€…ä¸ºmysqlç”¨æˆ·
&lt;code&gt;# chown -R mysql data&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¯åŠ¨MySQLè¿›ç¨‹
&lt;code&gt;# bin/mysqld_safe --user=mysql &amp;amp;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶è¿™ä¸ªçª—å£ä¼šå¡ä½ï¼Œæ–°å»ºä¸€ä¸ªterminalï¼Œè¿›å…¥/usr/local/mysqlä¸­&lt;/p&gt;
&lt;p&gt;è¿›å…¥mysqlæ§åˆ¶å°
&lt;code&gt;# bin/mysql&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;é€€å‡º
&lt;code&gt;exit;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿›è¡ŒMySQLçš„rootç”¨æˆ·å¯†ç çš„ä¿®æ”¹ç­‰æ“ä½œ
&lt;code&gt;# ./bin/mysql_secure_installation&lt;/code&gt;
é¦–å…ˆè¦æ±‚è¾“å…¥rootå¯†ç ï¼Œç”±äºæˆ‘ä»¬æ²¡æœ‰è®¾ç½®è¿‡rootå¯†ç ï¼Œæ‹¬å·é‡Œé¢è¯´äº†ï¼Œå¦‚æœæ²¡æœ‰rootå¯†ç å°±ç›´æ¥æŒ‰å›è½¦ã€‚æ˜¯å¦è®¾å®šrootå¯†ç ï¼Œé€‰yï¼Œè®¾å®šå¯†ç ä¸ºclusterï¼Œæ˜¯å¦ç§»é™¤åŒ¿åç”¨æˆ·ï¼šyã€‚ç„¶åæœ‰ä¸ªæ˜¯å¦å…³é—­rootè´¦æˆ·çš„è¿œç¨‹ç™»å½•ï¼Œé€‰nï¼Œåˆ é™¤testè¿™ä¸ªæ•°æ®åº“ï¼Ÿyï¼Œæ›´æ–°æƒé™ï¼Ÿyï¼Œç„¶åokã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;# cp support-files/mysql.server /etc/init.d/mysql.server&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹MySQLçš„è¿›ç¨‹å·
&lt;code&gt;# ps -ef | grep mysql&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰çš„è¯å°±killæ‰ï¼Œä¿è¯MySQLå·²ç»ä¸­æ–­è¿è¡Œäº†ï¼Œä¸€èˆ¬killæ‰/usr/local/mysql/bin/mysqldå¼€å¤´çš„å³å¯
&lt;code&gt;# kill è¿›ç¨‹å·&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¯åŠ¨MySQL
&lt;code&gt;# /etc/init.d/mysql.server start -user=mysql&lt;/code&gt;
&lt;code&gt;# exit&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿˜éœ€è¦é…ç½®ä¸€ä¸‹è®¿é—®æƒé™ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$ mysql -u root -p
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mysql&amp;gt; GRANT ALL PRIVILEGES ON *.* TO &amp;#39;root&amp;#39;@&amp;#39;%&amp;#39; IDENTIFIED BY &amp;#39;cluster&amp;#39; WITH GRANT OPTION;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mysql&amp;gt; FLUSH PRIVILEGES;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™æ ·å°±å¯ä»¥ä½¿ç”¨rootç”¨æˆ·åœ¨ä»»æ„åœ°ç‚¹ç™»é™†ï¼Œè€Œä¸å†é™äºlocalhostäº†
å…³äºæœåŠ¡çš„ä¸‰ä¸ªå‘½ä»¤ã€‚
å¯åŠ¨mysqlï¼š&lt;code&gt;# /etc/init.d/mysql.server start -user=mysql&lt;/code&gt;
åœæ­¢mysqlï¼š&lt;code&gt;# mysqladmin -u root -p shutdown&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="ä¿®æ”¹mysqlçš„æ•°æ®å­˜å‚¨ä½ç½®"&gt;ä¿®æ”¹MySQLçš„æ•°æ®å­˜å‚¨ä½ç½®
&lt;/h2&gt;&lt;p&gt;åœ¨è£…ç³»ç»Ÿè¿›è¡Œåˆ†åŒºçš„æ—¶å€™ï¼Œæœ‰äº›æ—¶å€™ä¼šåˆ›å»ºæ¯”è¾ƒå¤§çš„åˆ†åŒºå¼€å­˜æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥å°†MySQLçš„æ•°æ®å­˜æ”¾åˆ°è¿™ä¸ªåŒºå†…ï¼Œå‡è®¾è¿™ä¸ªåŒºä¸º/file0&lt;/p&gt;
&lt;p&gt;&lt;code&gt;$ su root&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æŠŠMySQLæœåŠ¡è¿›ç¨‹åœæ‰ï¼š
&lt;code&gt;# mysqladmin -u root -p shutdown&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ–°å»ºæ–°çš„dataDir
&lt;code&gt;# mkdir /file0/mysql_data&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æŠŠ/usr/local/mysql/dataé‡Œé¢çš„ä¸œè¥¿ç§»åˆ°/file0/mysql_dataä¸‹
&lt;code&gt;# cp /usr/local/mysql/data/* /file0/mysql_data&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç¼–è¾‘MySQLçš„é…ç½®æ–‡ä»¶/etc/my.cnf
å¦‚æœæ²¡æœ‰çš„è¯ï¼Œå°±æŠŠ/usr/local/mysqlé‡Œé¢çš„my.cnfå¤åˆ¶è¿‡å»
&lt;code&gt;# cp /usr/local/mysql/my.cnf /etc/&lt;/code&gt;
&lt;code&gt;# vi /etc/my.cnf&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æŠŠé‡Œé¢çš„basedir, datadir, portä¿®æ”¹æˆä¸‹é¢çš„å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;basedir=/usr/local/mysql
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;datadir=/file0/mysql_data
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;port=3306
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¿®æ”¹MySQLå¯åŠ¨è„šæœ¬/etc/init.d/mysql.server
&lt;code&gt;# vi /etc/init.d/mysql.server&lt;/code&gt;
æŠŠé‡Œé¢çš„basedirå’Œdatadirä½œå¦‚ä¸Šä¿®æ”¹&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹æ–°ç›®å½•çš„æƒé™ï¼š
&lt;code&gt;# chown â€“R mysql /file0/mysql_data&lt;/code&gt;
&lt;code&gt;# chgrp â€“R mysql /file0/mysql_data&lt;/code&gt;
é€€å‡ºrootç”¨æˆ·
é‡æ–°å¯åŠ¨MySQLæœåŠ¡
&lt;code&gt;$ /etc/init.d/mysql.server start â€“user=mysql&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿›å…¥mysql
&lt;code&gt;$ mysql â€“u root -p&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹ç›®å½•æ˜¯å¦å·²ç»æ›´æ”¹
&lt;code&gt;mysql&amp;gt; show variables like â€œdatadirâ€;&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="é«˜å¯ç”¨çš„mysqlåŒæœºçƒ­å¤‡å®‰è£…æ•™ç¨‹"&gt;é«˜å¯ç”¨çš„MySQLåŒæœºçƒ­å¤‡å®‰è£…æ•™ç¨‹
&lt;/h2&gt;&lt;p&gt;å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—ï¼Œè®¾ç½®id
&lt;code&gt;# vi /etc/my.cnf&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;[mysqld]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;server-id = 1 #backupè¿™å°è®¾ç½®2
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;log-bin = mysql-bin
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;binlog-ignore-db = mysql,information_schema #å¿½ç•¥å†™å…¥binlogæ—¥å¿—çš„åº“
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;auto-increment-increment = 2 #å­—æ®µå˜åŒ–å¢é‡å€¼
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;auto-increment-offset = 1 #åˆå§‹å­—æ®µIDä¸º1
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;slave-skip-errors = all #å¿½ç•¥æ‰€æœ‰å¤åˆ¶äº§ç”Ÿçš„é”™è¯¯
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;é‡å¯MySQLæœåŠ¡
&lt;code&gt;# mysqladmin -u root -p shutdown&lt;/code&gt;
&lt;code&gt;# /etc/init.d/mysql.server start â€“user=mysql&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å…ˆæŸ¥çœ‹ä¸‹log binæ—¥å¿—å’Œposå€¼ä½ç½®
é‡Œé¢æœ‰ä¸ªFileå’ŒPositionï¼Œåˆ†åˆ«æ˜¯log_fileå’Œlog_posçš„å€¼ï¼Œä¸€ä¼šå„¿è¦å¡«
&lt;code&gt;mysql&amp;gt; show master status;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;masteré…ç½®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;span class="lnt"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mysql&amp;gt; GRANT REPLICATION SLAVE ON *.* TO &amp;#39;replication&amp;#39;@&amp;#39;192.168.1.%&amp;#39; IDENTIFIED BY &amp;#39;replication&amp;#39;;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mysql&amp;gt; flush privileges;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mysql&amp;gt; change master to
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -&amp;gt; master_host=&amp;#39;192.168.1.212&amp;#39;, # æ­¤å¤„è¾“å…¥slaveçš„ipåœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -&amp;gt; master_user=&amp;#39;replication&amp;#39;,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -&amp;gt; master_password=&amp;#39;replication&amp;#39;,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -&amp;gt; master_log_file=&amp;#39;mysql-bin.000001&amp;#39;,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -&amp;gt; master_log_pos=120; #å¯¹ç«¯çŠ¶æ€æ˜¾ç¤ºçš„å€¼
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mysql&amp;gt; start slave; #å¯åŠ¨åŒæ­¥
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;backupé…ç½®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;span class="lnt"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mysql&amp;gt; GRANT REPLICATION SLAVE ON *.* TO &amp;#39;replication&amp;#39;@&amp;#39;192.168.1.%&amp;#39; IDENTIFIED BY &amp;#39;replication&amp;#39;;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mysql&amp;gt; flush privileges;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mysql&amp;gt; change master to
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -&amp;gt; master_host=&amp;#39;192.168.1.211&amp;#39;, # æ­¤å¤„è¾“å…¥masterçš„ipåœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -&amp;gt; master_user=&amp;#39;replication&amp;#39;,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -&amp;gt; master_password=&amp;#39;replication&amp;#39;,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -&amp;gt; master_log_file=&amp;#39;mysql-bin.000001&amp;#39;,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -&amp;gt; master_log_pos=120;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mysql&amp;gt; start slave;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;MySQLåŒå‡»çƒ­å¤‡å®‰è£…å®Œæˆ&lt;/p&gt;
&lt;h2 id="æµ‹è¯•"&gt;æµ‹è¯•
&lt;/h2&gt;&lt;p&gt;åœ¨ä¸€å°æœºå™¨ä¸Šå»ºç«‹ä¸€ä¸ªæ•°æ®åº“ï¼Œåˆ›å»ºä¸€ä¸ªè¡¨ï¼Œåœ¨å¦ä¸€å°æœºå™¨ä¸ŠæŸ¥è¯¢æ˜¯æœ‰ç»“æœçš„ï¼Œè¯´æ˜å®‰è£…æˆåŠŸã€‚&lt;/p&gt;</description></item><item><title>Hadoop HAå®‰è£…ä¸€ï¼šåœ¨Linuxä¸­å®‰è£…å’Œé…ç½®ntpï¼Œsshå’Œjdk</title><link>https://davidham3.github.io/blog/p/hadoop-ha%E5%AE%89%E8%A3%85%E4%B8%80%E5%9C%A8linux%E4%B8%AD%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AEntpssh%E5%92%8Cjdk/</link><pubDate>Mon, 21 Aug 2017 16:13:25 +0000</pubDate><guid>https://davidham3.github.io/blog/p/hadoop-ha%E5%AE%89%E8%A3%85%E4%B8%80%E5%9C%A8linux%E4%B8%AD%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AEntpssh%E5%92%8Cjdk/</guid><description>&lt;p&gt;Hadoop HAå®‰è£…ä¸€ï¼šå®‰è£…å’Œé…ç½®ntpï¼Œsshå’Œjdk&lt;/p&gt;
&lt;p&gt;è®°å½•ä¸€ä¸‹å®‰è£…5èŠ‚ç‚¹çš„é«˜å¯ç”¨Hadoopé›†ç¾¤çš„å®‰è£…è¿‡ç¨‹ã€‚High availabilityè¡¨ç¤ºé«˜å¯ç”¨ï¼Œåœ¨Hadoopé›†ç¾¤ä¸­ï¼Œè¡¨ç¤ºä¸¤ä¸ªä¸»èŠ‚ç‚¹ã€‚HDFSä¸­æ˜¯ä¸¤ä¸ªNamenodeï¼ŒYarnä¸­æ˜¯ä¸¤ä¸ªResourceManagerã€‚æœ¬æ•™ç¨‹ä¸­çš„Hadoopå’ŒHBaseå‡ä¸ºHAï¼ŒMySQLä¸ºåŒæœºçƒ­å¤‡ã€‚&lt;/p&gt;
&lt;p&gt;æ“ä½œç³»ç»Ÿï¼šCentOS 7.&lt;/p&gt;
&lt;p&gt;è½¯ä»¶æœåŠ¡å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è½¯ä»¶&lt;/th&gt;
&lt;th&gt;ç‰ˆæœ¬&lt;/th&gt;
&lt;th&gt;è·¯å¾„&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;JDK&lt;/td&gt;
&lt;td&gt;1.7.80&lt;/td&gt;
&lt;td&gt;/usr/local/jdk1.7.0_80&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;MySQL&lt;/td&gt;
&lt;td&gt;5.6.37&lt;/td&gt;
&lt;td&gt;/usr/local/mysql&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Zookeeper&lt;/td&gt;
&lt;td&gt;3.4.6&lt;/td&gt;
&lt;td&gt;/usr/local/zookeeper-3.4.6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Kafka&lt;/td&gt;
&lt;td&gt;0.8.2.1&lt;/td&gt;
&lt;td&gt;/usr/local/kafka_2.10.-0.8.2.1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Hadoop&lt;/td&gt;
&lt;td&gt;2.6.5&lt;/td&gt;
&lt;td&gt;/usr/local/hadoop-2.6.5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;HBase&lt;/td&gt;
&lt;td&gt;1.2.6&lt;/td&gt;
&lt;td&gt;/usr/local/hbase-1.2.6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Hive&lt;/td&gt;
&lt;td&gt;1.1.0&lt;/td&gt;
&lt;td&gt;/usr/local/apache-hive-1.1.0-bin&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;MySQL JDBC&lt;/td&gt;
&lt;td&gt;5.1.43&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Scala&lt;/td&gt;
&lt;td&gt;2.10.6&lt;/td&gt;
&lt;td&gt;/usr/local/scala-2.10.6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Spark&lt;/td&gt;
&lt;td&gt;1.6.3&lt;/td&gt;
&lt;td&gt;/usr/local/spark-1.6.3-bin-hadoop2.6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Storm&lt;/td&gt;
&lt;td&gt;1.1.1&lt;/td&gt;
&lt;td&gt;/usr/local/apache-storm-1.1.1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Sqoop&lt;/td&gt;
&lt;td&gt;1.4.6&lt;/td&gt;
&lt;td&gt;/usr/local/sqoop-1.4.6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Pig&lt;/td&gt;
&lt;td&gt;0.16.0&lt;/td&gt;
&lt;td&gt;/usr/local/pig-0.16.0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å„èŠ‚ç‚¹æ­è½½çš„æœåŠ¡ä¸ºï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Hostname&lt;/th&gt;
&lt;th&gt;Services&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;cluster1&lt;/td&gt;
&lt;td&gt;NameNode, DataNode, ZKFC, ResourceManager, NodeManager, HMaster, HRegionServer, Master, Worker, MySQL&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cluster2&lt;/td&gt;
&lt;td&gt;QuorumPeerMain, NameNode, DataNode, ZKFC, ResourceManager, NodeManager, HMaster, HRegionServer, Worker, MySQL&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cluster3&lt;/td&gt;
&lt;td&gt;QuorumPeerMain, DataNode, NodeManager, HRegionServer, Worker, Kafka, nimbus, core, logviewer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cluster4&lt;/td&gt;
&lt;td&gt;QuorumPeerMain, DataNode, NodeManager, HRegionServer, Worker, Kafka, Supervisor, logviewer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cluster5&lt;/td&gt;
&lt;td&gt;DataNode, NodeManager, HRegionServer, Worker, Kafka, Supervisor, logviewer&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;æœ¬ç³»åˆ—æ•™ç¨‹ä¸­ï¼Œå‘½ä»¤ä»¥#å¼€å¤´çš„æ˜¯éœ€è¦ä½¿ç”¨rootç”¨æˆ·æ‰§è¡Œï¼Œ$å¼€å¤´çš„ä½¿ç”¨æ™®é€šç”¨æˆ·ï¼ˆä¸€èˆ¬ä¸ºhadoopç”¨æˆ·ï¼‰ã€‚è€Œä¸”æœ¬æ•™ç¨‹çš„æ“ä½œç³»ç»Ÿæ˜¯CentOS7ï¼Œæœ‰äº›é…ç½®æ–‡ä»¶å†…çš„å†…å®¹å¯èƒ½ä¸Ubuntuç­‰ç³»ç»Ÿä¸ç¬¦ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id="å…³é—­é˜²ç«å¢™å’Œselinux"&gt;å…³é—­é˜²ç«å¢™å’ŒSelinux
&lt;/h1&gt;&lt;p&gt;// å…³é—­é˜²ç«å¢™å’Œselinux
&lt;code&gt;# systemctl stop firewalld.service&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;// ç¦æ­¢firewall å¼€æœºå¯åŠ¨
&lt;code&gt;# systemctl disable firewalld.service&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;// å¼€æœºå…³é—­Selinuxï¼Œç¼–è¾‘Selinuxé…ç½®æ–‡ä»¶
&lt;code&gt;# vi /etc/selinux/config&lt;/code&gt;
å°†SELINUXè®¾ç½®ä¸ºdisabled
å¦‚ä¸‹:
&lt;code&gt;SELINUX=disabled&lt;/code&gt;
&lt;strong&gt;åƒä¸‡åˆ«æŠŠSELINUXTYPEæ”¹äº†ï¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;// é‡å¯
&lt;code&gt;# reboot&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;// é‡å¯æœºå™¨årootç”¨æˆ·æŸ¥çœ‹SelinuxçŠ¶æ€
&lt;code&gt;# getenforce&lt;/code&gt;&lt;/p&gt;
&lt;h1 id="ä¿®æ”¹hostsæ–‡ä»¶"&gt;ä¿®æ”¹hostsæ–‡ä»¶
&lt;/h1&gt;&lt;p&gt;å‡è®¾5å°æœºå™¨çš„IPåœ°å€åˆ†åˆ«ä¸º192.168.1.211-192.168.1.215
æ¯å°æœºå™¨éƒ½è¦åšå¦‚ä¸‹ä¿®æ”¹ï¼š
// ä¿®æ”¹hosts
&lt;code&gt;# vi /etc/hosts&lt;/code&gt;
// åœ¨æœ€ä¸‹é¢æ·»åŠ ä»¥ä¸‹å‡ è¡Œå†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;192.168.1.211 cluster1
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;192.168.1.212 cluster2
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;192.168.1.213 cluster3
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;192.168.1.214 cluster4
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;192.168.1.215 cluster5
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¿®æ”¹æˆè¿™ä¸ªæ ·å­åï¼Œå¯¹äºè¿™å°æœºå™¨æ¥è¯´ï¼Œcluster1å°±ä»£è¡¨äº†192.168.1.211ï¼Œå…¶ä»–çš„ä¹ŸåŒç†ã€‚&lt;/p&gt;
&lt;h1 id="ntpçš„å®‰è£…ä¸é…ç½®"&gt;ntpçš„å®‰è£…ä¸é…ç½®
&lt;/h1&gt;&lt;p&gt;ä¸€ä¸ªé›†ç¾¤å†…éœ€è¦æœ‰ä¸€ä¸ªæœºå™¨è¿è¡Œntp serverï¼Œå…¶ä»–æœºå™¨ç”¨ntpdateå‘å®ƒåŒæ­¥æ—¶é—´ã€‚Hbaseå’ŒSparkéƒ½è¦æ±‚æ—¶é—´æ˜¯ä¸¥æ ¼åŒæ­¥çš„ï¼Œæ‰€ä»¥ntpæ˜¯å¿…éœ€çš„ã€‚
æˆ‘ä»¬å°†ntp serverè®¾ç½®åœ¨cluster1ä¸Šï¼Œæ‰€ä»¥åªåœ¨cluster1ä¸Šé¢å®‰è£…ntpserverï¼Œåœ¨å…¶ä»–æœºå™¨ä¸Šå®‰è£…ntpdateã€‚&lt;/p&gt;
&lt;p&gt;ubuntuä¸‹ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# apt-get install ntp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# apt-get install ntpdate
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;CentOSä½¿ç”¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# yum install ntp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# yum install ntpdate
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;é…ç½®æ—¶é—´æœåŠ¡å™¨ï¼š&lt;/p&gt;
&lt;p&gt;// cluster1ä¸Šæ‰§è¡Œä»¥ä¸‹æ“ä½œ
&lt;code&gt;# vi /etc/ntp.conf&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ³¨é‡Šæ‰ä»¥ä¸‹4è¡Œï¼Œä¹Ÿå°±æ˜¯åœ¨è¿™4è¡Œå‰é¢åŠ #&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;server 0.centos.pool.ntp.org iburst
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;server 1.centos.pool.ntp.org iburst
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;server 2.centos.pool.ntp.org iburst
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;server 3.centos.pool.ntp.org iburst
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æœ€ä¸‹é¢åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼Œ192.168.1.1å’Œ255.255.255.0åˆ†åˆ«ä¸ºç½‘å…³å’Œæ©ç ï¼Œ127.127.1.0è¡¨ç¤ºä»¥æœ¬æœºæ—¶é—´ä¸ºæ ‡å‡†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;restrict default ignore
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;restrict 192.168.1.1 mask 255.255.255.0 nomodify notrap
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;server 127.127.1.0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¿å­˜åubuntuä½¿ç”¨&lt;code&gt;# /etc/init.d/ntp restart&lt;/code&gt;é‡å¯ntpæœåŠ¡ï¼ŒCentOSä½¿ç”¨&lt;code&gt;# service ntpd restart&lt;/code&gt;
é™¤äº†æ­è½½ntp serverçš„ä¸»æœºï¼Œå…¶ä»–æ‰€æœ‰æœºå™¨ï¼Œè®¾å®šæ¯å¤©00:00å‘ntp serveråŒæ­¥æ—¶é—´ï¼Œå¹¶å†™å…¥æ—¥å¿—
&lt;code&gt;# crontab â€“e&lt;/code&gt;
æ·»åŠ ä»¥ä¸‹å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;0 0 * * * /usr/sbin/ntpdate cluster1&amp;gt;&amp;gt; /home/hadoop/ntpd.log
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™æ ·å°±å®Œæˆäº†ntpçš„é…ç½®&lt;/p&gt;
&lt;p&gt;// æ‰‹åŠ¨åŒæ­¥æ—¶é—´ï¼Œéœ€è¦åœ¨æ¯å°æœºå™¨ä¸Šï¼ˆé™¤ntp serverï¼‰ï¼Œä½¿ç”¨&lt;code&gt;ntpdate cluster1&lt;/code&gt;åŒæ­¥æ—¶é—´
&lt;code&gt;# ntpdate cluster1&lt;/code&gt;&lt;/p&gt;
&lt;h1 id="æ–°å»ºhadoopç”¨æˆ·"&gt;æ–°å»ºhadoopç”¨æˆ·
&lt;/h1&gt;&lt;p&gt;æ¯å°æœºå™¨ä¸Šéƒ½è¦æ–°å»ºhadoopç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·ä¸“é—¨ç”¨æ¥ç»´æŠ¤é›†ç¾¤ï¼Œå› ä¸ºå®é™…ä¸­ä½¿ç”¨rootç”¨æˆ·çš„æœºä¼šå¾ˆå°‘ï¼Œè€Œä¸”ä¸å®‰å…¨ã€‚
// æ–°å»ºhadoopç»„
&lt;code&gt;# groupadd hadoop&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;// æ–°å»ºhadoopç”¨æˆ·
&lt;code&gt;# useradd -s /bin/bash -g hadoop -d /home/hadoop -m hadoop&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;// ä¿®æ”¹hadoopè¿™ä¸ªç”¨æˆ·çš„å¯†ç 
&lt;code&gt;# passwd hadoop&lt;/code&gt;&lt;/p&gt;
&lt;h1 id="sshå¯†é’¥çš„ç”Ÿæˆä¸åˆ†å‘"&gt;sshå¯†é’¥çš„ç”Ÿæˆä¸åˆ†å‘
&lt;/h1&gt;&lt;p&gt;sshæ˜¯Linuxè‡ªå¸¦çš„æœåŠ¡ï¼Œä¸éœ€è¦å®‰è£…ã€‚è¿™é‡Œçš„ç›®çš„æ˜¯è®©èŠ‚ç‚¹é—´å®ç°æ— å¯†ç ç™»é™†ã€‚å…¶å®å°±æ˜¯å½“å‰æœºå™¨ç”Ÿæˆå¯†é’¥ï¼Œç„¶åç”¨&lt;code&gt;ssh-copy-id&lt;/code&gt;å¤åˆ¶åˆ°å…¶ä»–æœºå™¨ä¸Šï¼Œè¿™æ ·è¿™å°æœºå™¨å°±å¯ä»¥æ— å¯†ç ç›´æ¥ç™»é™†é‚£å°æœºå™¨äº†ã€‚Hadoopä¸»èŠ‚ç‚¹éœ€è¦èƒ½æ— å¯†ç è¿æ¥åˆ°å…¶ä»–çš„æœºå™¨ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;åœ¨cluster1ä¸Šï¼Œä½¿ç”¨hadoopç”¨æˆ·&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;// ä½¿ç”¨hadoopç”¨æˆ·
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;# su hadoop
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;// åˆ‡åˆ°homeç›®å½•
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$ cd ~/
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;// ç”Ÿæˆå¯†é’¥
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;ssh-keygen -t rsa
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;// ä¸€è·¯å›è½¦
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;//å¤åˆ¶å¯†é’¥
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$ ssh-copy-id cluster1
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;yes
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;è¾“å…¥clusterçš„å¯†ç 
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$ ssh-copy-id cluster2
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;åŒä¸Š
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$ ssh-copy-id cluster3
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;åŒä¸Š
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$ ssh-copy-id cluster4
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;åŒä¸Š
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$ ssh-copy-id cluster5
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;åŒä¸Š
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;// ç„¶åæµ‹è¯•èƒ½å¦æ— å¯†ç ç™»é™†
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$ ssh cluster1
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$ ssh cluster2
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$ ssh cluster3
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$ ssh cluster4
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$ ssh cluster5
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æŸ¥çœ‹ç™»é™†æ—¶æ˜¯å¦æœ‰å¯†ç ï¼Œè‹¥æ— å¯†ç ï¼Œåˆ™é…ç½®æˆåŠŸã€‚
ä»¥ä¸Šæ­¥éª¤éœ€è¦åœ¨cluster2ä¸Šä¹Ÿæ‰§è¡Œä¸€éï¼Œä¸ºäº†è®©cluster2ä¹Ÿå¯ä»¥æ— å¯†ç ç™»é™†åˆ°å…¶ä»–æœºå™¨ä¸Šï¼Œå› ä¸ºcluster2ä¹Ÿæ˜¯ä¸»èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;h1 id="jdkçš„å®‰è£…ä¸é…ç½®"&gt;jdkçš„å®‰è£…ä¸é…ç½®
&lt;/h1&gt;&lt;p&gt;å®‰è£…hadoopé›†ç¾¤ï¼Œjdkæ˜¯å¿…é¡»è¦è£…çš„ï¼Œ1.7å’Œ1.8éƒ½å¯ä»¥ï¼Œä¸è¿‡ä»Hadoop3å¼€å§‹ï¼Œå¥½åƒåªæ”¯æŒ1.8+äº†ï¼Œä½†æ˜¯æ¢æˆ1.9å’Œ1.10ä¼šå‡ºé—®é¢˜ï¼Œæ‰€ä»¥æ¨èç”¨1.8ï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯1.7ã€‚&lt;/p&gt;
&lt;p&gt;å°†ä¸‹è½½å¥½åçš„jdkè§£å‹åˆ°/usr/local/ä¸‹
&lt;code&gt;# vi /etc/profile&lt;/code&gt;
å°†ä¸‹é¢4è¡Œæ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-gdscript3" data-lang="gdscript3"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="n"&gt;JAVA_HOME&lt;/span&gt;&lt;span class="o"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jdk1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;7.0&lt;/span&gt;&lt;span class="n"&gt;_80&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="n"&gt;JRE_HOME&lt;/span&gt;&lt;span class="o"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jdk1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;7.0&lt;/span&gt;&lt;span class="n"&gt;_80&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jre&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="n"&gt;CLASSPATH&lt;/span&gt;&lt;span class="o"&gt;=.&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;JAVA&lt;/span&gt;\&lt;span class="n"&gt;_HOME&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;JRE_HOME&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;CLASSPATH&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="n"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=$&lt;/span&gt;&lt;span class="n"&gt;JAVA_HOME&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;JRE&lt;/span&gt;\&lt;span class="n"&gt;_HOME&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;JAVA_HOME&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;PATH&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä½¿ç”¨&lt;code&gt;# source /etc/profile&lt;/code&gt;åˆ·æ–°ç¯å¢ƒå˜é‡
ä½¿ç”¨&lt;code&gt;# java -version&lt;/code&gt;æŸ¥çœ‹javaç‰ˆæœ¬éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼Œå¦‚æœèƒ½çœ‹åˆ°Javaçš„ç‰ˆæœ¬ï¼Œè¯´æ˜å®‰è£…æˆåŠŸï¼Œæ²¡æœ‰é—®é¢˜ã€‚&lt;/p&gt;</description></item><item><title>Links</title><link>https://davidham3.github.io/blog/links/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://davidham3.github.io/blog/links/</guid><description>&lt;p&gt;To use this feature, add &lt;code&gt;links&lt;/code&gt; section to frontmatter.&lt;/p&gt;
&lt;p&gt;This page&amp;rsquo;s frontmatter:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;span class="lnt"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-yaml" data-lang="yaml"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nt"&gt;links&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;- &lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l"&gt;GitHub&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;description&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l"&gt;GitHub is the world&amp;#39;s largest software development platform.&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;website&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l"&gt;https://github.com&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l"&gt;https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;- &lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l"&gt;TypeScript&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;description&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l"&gt;TypeScript is a typed superset of JavaScript that compiles to plain JavaScript.&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;website&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l"&gt;https://www.typescriptlang.org&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l"&gt;ts-logo-128.jpg&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;image&lt;/code&gt; field accepts both local and external images.&lt;/p&gt;</description></item><item><title>Search</title><link>https://davidham3.github.io/blog/search/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://davidham3.github.io/blog/search/</guid><description/></item></channel></rss>